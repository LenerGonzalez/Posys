var Yde=Object.defineProperty;var Jde=(t,e,r)=>e in t?Yde(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Tr=(t,e,r)=>Jde(t,typeof e!="symbol"?e+"":e,r);function Zde(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in t)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(t,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var Kit=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function PA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var hW={exports:{}},ej={},AW={exports:{}},ca={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fw=Symbol.for("react.element"),efe=Symbol.for("react.portal"),tfe=Symbol.for("react.fragment"),rfe=Symbol.for("react.strict_mode"),nfe=Symbol.for("react.profiler"),afe=Symbol.for("react.provider"),sfe=Symbol.for("react.context"),ife=Symbol.for("react.forward_ref"),ofe=Symbol.for("react.suspense"),lfe=Symbol.for("react.memo"),cfe=Symbol.for("react.lazy"),jL=Symbol.iterator;function ufe(t){return t===null||typeof t!="object"?null:(t=jL&&t[jL]||t["@@iterator"],typeof t=="function"?t:null)}var mW={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pW=Object.assign,gW={};function t1(t,e,r){this.props=t,this.context=e,this.refs=gW,this.updater=r||mW}t1.prototype.isReactComponent={};t1.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};t1.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function xW(){}xW.prototype=t1.prototype;function SO(t,e,r){this.props=t,this.context=e,this.refs=gW,this.updater=r||mW}var IO=SO.prototype=new xW;IO.constructor=SO;pW(IO,t1.prototype);IO.isPureReactComponent=!0;var PL=Array.isArray,vW=Object.prototype.hasOwnProperty,jO={current:null},yW={key:!0,ref:!0,__self:!0,__source:!0};function bW(t,e,r){var n,a={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)vW.call(e,n)&&!yW.hasOwnProperty(n)&&(a[n]=e[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:fw,type:t,key:s,ref:o,props:a,_owner:jO.current}}function dfe(t,e){return{$$typeof:fw,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function PO(t){return typeof t=="object"&&t!==null&&t.$$typeof===fw}function ffe(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var TL=/\/+/g;function K4(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ffe(""+t.key):e.toString(36)}function L_(t,e,r,n,a){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case fw:case efe:o=!0}}if(o)return o=t,a=a(o),t=n===""?"."+K4(o,0):n,PL(a)?(r="",t!=null&&(r=t.replace(TL,"$&/")+"/"),L_(a,e,r,"",function(u){return u})):a!=null&&(PO(a)&&(a=dfe(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(TL,"$&/")+"/")+t)),e.push(a)),1;if(o=0,n=n===""?".":n+":",PL(t))for(var l=0;l<t.length;l++){s=t[l];var c=n+K4(s,l);o+=L_(s,e,r,c,a)}else if(c=ufe(t),typeof c=="function")for(t=c.call(t),l=0;!(s=t.next()).done;)s=s.value,c=n+K4(s,l++),o+=L_(s,e,r,c,a);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function RN(t,e,r){if(t==null)return t;var n=[],a=0;return L_(t,n,"","",function(s){return e.call(r,s,a++)}),n}function hfe(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Oc={current:null},U_={transition:null},Afe={ReactCurrentDispatcher:Oc,ReactCurrentBatchConfig:U_,ReactCurrentOwner:jO};function wW(){throw Error("act(...) is not supported in production builds of React.")}ca.Children={map:RN,forEach:function(t,e,r){RN(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return RN(t,function(){e++}),e},toArray:function(t){return RN(t,function(e){return e})||[]},only:function(t){if(!PO(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ca.Component=t1;ca.Fragment=tfe;ca.Profiler=nfe;ca.PureComponent=SO;ca.StrictMode=rfe;ca.Suspense=ofe;ca.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Afe;ca.act=wW;ca.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=pW({},t.props),a=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=jO.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)vW.call(e,c)&&!yW.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:fw,type:t.type,key:a,ref:s,props:n,_owner:o}};ca.createContext=function(t){return t={$$typeof:sfe,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:afe,_context:t},t.Consumer=t};ca.createElement=bW;ca.createFactory=function(t){var e=bW.bind(null,t);return e.type=t,e};ca.createRef=function(){return{current:null}};ca.forwardRef=function(t){return{$$typeof:ife,render:t}};ca.isValidElement=PO;ca.lazy=function(t){return{$$typeof:cfe,_payload:{_status:-1,_result:t},_init:hfe}};ca.memo=function(t,e){return{$$typeof:lfe,type:t,compare:e===void 0?null:e}};ca.startTransition=function(t){var e=U_.transition;U_.transition={};try{t()}finally{U_.transition=e}};ca.unstable_act=wW;ca.useCallback=function(t,e){return Oc.current.useCallback(t,e)};ca.useContext=function(t){return Oc.current.useContext(t)};ca.useDebugValue=function(){};ca.useDeferredValue=function(t){return Oc.current.useDeferredValue(t)};ca.useEffect=function(t,e){return Oc.current.useEffect(t,e)};ca.useId=function(){return Oc.current.useId()};ca.useImperativeHandle=function(t,e,r){return Oc.current.useImperativeHandle(t,e,r)};ca.useInsertionEffect=function(t,e){return Oc.current.useInsertionEffect(t,e)};ca.useLayoutEffect=function(t,e){return Oc.current.useLayoutEffect(t,e)};ca.useMemo=function(t,e){return Oc.current.useMemo(t,e)};ca.useReducer=function(t,e,r){return Oc.current.useReducer(t,e,r)};ca.useRef=function(t){return Oc.current.useRef(t)};ca.useState=function(t){return Oc.current.useState(t)};ca.useSyncExternalStore=function(t,e,r){return Oc.current.useSyncExternalStore(t,e,r)};ca.useTransition=function(){return Oc.current.useTransition()};ca.version="18.3.1";AW.exports=ca;var g=AW.exports;const oi=PA(g),mfe=Zde({__proto__:null,default:oi},[g]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pfe=g,gfe=Symbol.for("react.element"),xfe=Symbol.for("react.fragment"),vfe=Object.prototype.hasOwnProperty,yfe=pfe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bfe={key:!0,ref:!0,__self:!0,__source:!0};function NW(t,e,r){var n,a={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)vfe.call(e,n)&&!bfe.hasOwnProperty(n)&&(a[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)a[n]===void 0&&(a[n]=e[n]);return{$$typeof:gfe,type:t,key:s,ref:o,props:a,_owner:yfe.current}}ej.Fragment=xfe;ej.jsx=NW;ej.jsxs=NW;hW.exports=ej;var i=hW.exports,QT={},CW={exports:{}},Ku={},_W={exports:{}},EW={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ae,te){var Te=Ae.length;Ae.push(te);e:for(;0<Te;){var Ue=Te-1>>>1,O=Ae[Ue];if(0<a(O,te))Ae[Ue]=te,Ae[Te]=O,Te=Ue;else break e}}function r(Ae){return Ae.length===0?null:Ae[0]}function n(Ae){if(Ae.length===0)return null;var te=Ae[0],Te=Ae.pop();if(Te!==te){Ae[0]=Te;e:for(var Ue=0,O=Ae.length,H=O>>>1;Ue<H;){var G=2*(Ue+1)-1,L=Ae[G],W=G+1,X=Ae[W];if(0>a(L,Te))W<O&&0>a(X,L)?(Ae[Ue]=X,Ae[W]=Te,Ue=W):(Ae[Ue]=L,Ae[G]=Te,Ue=G);else if(W<O&&0>a(X,Te))Ae[Ue]=X,Ae[W]=Te,Ue=W;else break e}}return te}function a(Ae,te){var Te=Ae.sortIndex-te.sortIndex;return Te!==0?Te:Ae.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,A=3,h=!1,m=!1,p=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(Ae){for(var te=r(u);te!==null;){if(te.callback===null)n(u);else if(te.startTime<=Ae)n(u),te.sortIndex=te.expirationTime,e(c,te);else break;te=r(u)}}function w(Ae){if(p=!1,b(Ae),!m)if(r(c)!==null)m=!0,oe(j);else{var te=r(u);te!==null&&ie(w,te.startTime-Ae)}}function j(Ae,te){m=!1,p&&(p=!1,v(S),S=-1),h=!0;var Te=A;try{for(b(te),f=r(c);f!==null&&(!(f.expirationTime>te)||Ae&&!k());){var Ue=f.callback;if(typeof Ue=="function"){f.callback=null,A=f.priorityLevel;var O=Ue(f.expirationTime<=te);te=t.unstable_now(),typeof O=="function"?f.callback=O:f===r(c)&&n(c),b(te)}else n(c);f=r(c)}if(f!==null)var H=!0;else{var G=r(u);G!==null&&ie(w,G.startTime-te),H=!1}return H}finally{f=null,A=Te,h=!1}}var I=!1,C=null,S=-1,E=5,B=-1;function k(){return!(t.unstable_now()-B<E)}function T(){if(C!==null){var Ae=t.unstable_now();B=Ae;var te=!0;try{te=C(!0,Ae)}finally{te?P():(I=!1,C=null)}}else I=!1}var P;if(typeof y=="function")P=function(){y(T)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,le=K.port2;K.port1.onmessage=T,P=function(){le.postMessage(null)}}else P=function(){x(T,0)};function oe(Ae){C=Ae,I||(I=!0,P())}function ie(Ae,te){S=x(function(){Ae(t.unstable_now())},te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ae){Ae.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,oe(j))},t.unstable_forceFrameRate=function(Ae){0>Ae||125<Ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<Ae?Math.floor(1e3/Ae):5},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(Ae){switch(A){case 1:case 2:case 3:var te=3;break;default:te=A}var Te=A;A=te;try{return Ae()}finally{A=Te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ae,te){switch(Ae){case 1:case 2:case 3:case 4:case 5:break;default:Ae=3}var Te=A;A=Ae;try{return te()}finally{A=Te}},t.unstable_scheduleCallback=function(Ae,te,Te){var Ue=t.unstable_now();switch(typeof Te=="object"&&Te!==null?(Te=Te.delay,Te=typeof Te=="number"&&0<Te?Ue+Te:Ue):Te=Ue,Ae){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=Te+O,Ae={id:d++,callback:te,priorityLevel:Ae,startTime:Te,expirationTime:O,sortIndex:-1},Te>Ue?(Ae.sortIndex=Te,e(u,Ae),r(c)===null&&Ae===r(u)&&(p?(v(S),S=-1):p=!0,ie(w,Te-Ue))):(Ae.sortIndex=O,e(c,Ae),m||h||(m=!0,oe(j))),Ae},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(Ae){var te=A;return function(){var Te=A;A=te;try{return Ae.apply(this,arguments)}finally{A=Te}}}})(EW);_W.exports=EW;var wfe=_W.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nfe=g,Qu=wfe;function Dr(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var SW=new Set,$b={};function Tg(t,e){Nv(t,e),Nv(t+"Capture",e)}function Nv(t,e){for($b[t]=e,t=0;t<e.length;t++)SW.add(e[t])}var fA=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),VT=Object.prototype.hasOwnProperty,Cfe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,BL={},kL={};function _fe(t){return VT.call(kL,t)?!0:VT.call(BL,t)?!1:Cfe.test(t)?kL[t]=!0:(BL[t]=!0,!1)}function Efe(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Sfe(t,e,r,n){if(e===null||typeof e>"u"||Efe(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Dc(t,e,r,n,a,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var kl={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){kl[t]=new Dc(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];kl[e]=new Dc(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){kl[t]=new Dc(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){kl[t]=new Dc(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){kl[t]=new Dc(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){kl[t]=new Dc(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){kl[t]=new Dc(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){kl[t]=new Dc(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){kl[t]=new Dc(t,5,!1,t.toLowerCase(),null,!1,!1)});var TO=/[\-:]([a-z])/g;function BO(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(TO,BO);kl[e]=new Dc(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(TO,BO);kl[e]=new Dc(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(TO,BO);kl[e]=new Dc(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){kl[t]=new Dc(t,1,!1,t.toLowerCase(),null,!1,!1)});kl.xlinkHref=new Dc("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){kl[t]=new Dc(t,1,!1,t.toLowerCase(),null,!0,!0)});function kO(t,e,r,n){var a=kl.hasOwnProperty(e)?kl[e]:null;(a!==null?a.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Sfe(e,r,a,n)&&(r=null),n||a===null?_fe(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):a.mustUseProperty?t[a.propertyName]=r===null?a.type===3?!1:"":r:(e=a.attributeName,n=a.attributeNamespace,r===null?t.removeAttribute(e):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var TA=Nfe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,MN=Symbol.for("react.element"),Rx=Symbol.for("react.portal"),Mx=Symbol.for("react.fragment"),FO=Symbol.for("react.strict_mode"),HT=Symbol.for("react.profiler"),IW=Symbol.for("react.provider"),jW=Symbol.for("react.context"),OO=Symbol.for("react.forward_ref"),$T=Symbol.for("react.suspense"),GT=Symbol.for("react.suspense_list"),DO=Symbol.for("react.memo"),S0=Symbol.for("react.lazy"),PW=Symbol.for("react.offscreen"),FL=Symbol.iterator;function W1(t){return t===null||typeof t!="object"?null:(t=FL&&t[FL]||t["@@iterator"],typeof t=="function"?t:null)}var hi=Object.assign,q4;function ky(t){if(q4===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);q4=e&&e[1]||""}return`
`+q4+t}var z4=!1;function W4(t,e){if(!t||z4)return"";z4=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),o=a.length-1,l=s.length-1;1<=o&&0<=l&&a[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==s[l]){var c=`
`+a[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{z4=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?ky(t):""}function Ife(t){switch(t.tag){case 5:return ky(t.type);case 16:return ky("Lazy");case 13:return ky("Suspense");case 19:return ky("SuspenseList");case 0:case 2:case 15:return t=W4(t.type,!1),t;case 11:return t=W4(t.type.render,!1),t;case 1:return t=W4(t.type,!0),t;default:return""}}function KT(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Mx:return"Fragment";case Rx:return"Portal";case HT:return"Profiler";case FO:return"StrictMode";case $T:return"Suspense";case GT:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case jW:return(t.displayName||"Context")+".Consumer";case IW:return(t._context.displayName||"Context")+".Provider";case OO:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case DO:return e=t.displayName||null,e!==null?e:KT(t.type)||"Memo";case S0:e=t._payload,t=t._init;try{return KT(t(e))}catch{}}return null}function jfe(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return KT(e);case 8:return e===FO?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function xm(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function TW(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Pfe(t){var e=TW(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function LN(t){t._valueTracker||(t._valueTracker=Pfe(t))}function BW(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=TW(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function jE(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function qT(t,e){var r=e.checked;return hi({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function OL(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=xm(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function kW(t,e){e=e.checked,e!=null&&kO(t,"checked",e,!1)}function zT(t,e){kW(t,e);var r=xm(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?WT(t,e.type,r):e.hasOwnProperty("defaultValue")&&WT(t,e.type,xm(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function DL(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function WT(t,e,r){(e!=="number"||jE(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Fy=Array.isArray;function sv(t,e,r,n){if(t=t.options,e){e={};for(var a=0;a<r.length;a++)e["$"+r[a]]=!0;for(r=0;r<t.length;r++)a=e.hasOwnProperty("$"+t[r].value),t[r].selected!==a&&(t[r].selected=a),a&&n&&(t[r].defaultSelected=!0)}else{for(r=""+xm(r),e=null,a=0;a<t.length;a++){if(t[a].value===r){t[a].selected=!0,n&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function XT(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Dr(91));return hi({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function RL(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Dr(92));if(Fy(r)){if(1<r.length)throw Error(Dr(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:xm(r)}}function FW(t,e){var r=xm(e.value),n=xm(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function ML(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function OW(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function YT(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?OW(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var UN,DW=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,a){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(UN=UN||document.createElement("div"),UN.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=UN.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Gb(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var sb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Tfe=["Webkit","ms","Moz","O"];Object.keys(sb).forEach(function(t){Tfe.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),sb[e]=sb[t]})});function RW(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||sb.hasOwnProperty(t)&&sb[t]?(""+e).trim():e+"px"}function MW(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=RW(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,a):t[r]=a}}var Bfe=hi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function JT(t,e){if(e){if(Bfe[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Dr(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Dr(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Dr(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Dr(62))}}function ZT(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eB=null;function RO(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var tB=null,iv=null,ov=null;function LL(t){if(t=mw(t)){if(typeof tB!="function")throw Error(Dr(280));var e=t.stateNode;e&&(e=sj(e),tB(t.stateNode,t.type,e))}}function LW(t){iv?ov?ov.push(t):ov=[t]:iv=t}function UW(){if(iv){var t=iv,e=ov;if(ov=iv=null,LL(t),e)for(t=0;t<e.length;t++)LL(e[t])}}function QW(t,e){return t(e)}function VW(){}var X4=!1;function HW(t,e,r){if(X4)return t(e,r);X4=!0;try{return QW(t,e,r)}finally{X4=!1,(iv!==null||ov!==null)&&(VW(),UW())}}function Kb(t,e){var r=t.stateNode;if(r===null)return null;var n=sj(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Dr(231,e,typeof r));return r}var rB=!1;if(fA)try{var X1={};Object.defineProperty(X1,"passive",{get:function(){rB=!0}}),window.addEventListener("test",X1,X1),window.removeEventListener("test",X1,X1)}catch{rB=!1}function kfe(t,e,r,n,a,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var ib=!1,PE=null,TE=!1,nB=null,Ffe={onError:function(t){ib=!0,PE=t}};function Ofe(t,e,r,n,a,s,o,l,c){ib=!1,PE=null,kfe.apply(Ffe,arguments)}function Dfe(t,e,r,n,a,s,o,l,c){if(Ofe.apply(this,arguments),ib){if(ib){var u=PE;ib=!1,PE=null}else throw Error(Dr(198));TE||(TE=!0,nB=u)}}function Bg(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function $W(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function UL(t){if(Bg(t)!==t)throw Error(Dr(188))}function Rfe(t){var e=t.alternate;if(!e){if(e=Bg(t),e===null)throw Error(Dr(188));return e!==t?null:t}for(var r=t,n=e;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return UL(a),t;if(s===n)return UL(a),e;s=s.sibling}throw Error(Dr(188))}if(r.return!==n.return)r=a,n=s;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o)throw Error(Dr(189))}}if(r.alternate!==n)throw Error(Dr(190))}if(r.tag!==3)throw Error(Dr(188));return r.stateNode.current===r?t:e}function GW(t){return t=Rfe(t),t!==null?KW(t):null}function KW(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=KW(t);if(e!==null)return e;t=t.sibling}return null}var qW=Qu.unstable_scheduleCallback,QL=Qu.unstable_cancelCallback,Mfe=Qu.unstable_shouldYield,Lfe=Qu.unstable_requestPaint,Hi=Qu.unstable_now,Ufe=Qu.unstable_getCurrentPriorityLevel,MO=Qu.unstable_ImmediatePriority,zW=Qu.unstable_UserBlockingPriority,BE=Qu.unstable_NormalPriority,Qfe=Qu.unstable_LowPriority,WW=Qu.unstable_IdlePriority,tj=null,nh=null;function Vfe(t){if(nh&&typeof nh.onCommitFiberRoot=="function")try{nh.onCommitFiberRoot(tj,t,void 0,(t.current.flags&128)===128)}catch{}}var mf=Math.clz32?Math.clz32:Gfe,Hfe=Math.log,$fe=Math.LN2;function Gfe(t){return t>>>=0,t===0?32:31-(Hfe(t)/$fe|0)|0}var QN=64,VN=4194304;function Oy(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function kE(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,a=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=Oy(l):(s&=o,s!==0&&(n=Oy(s)))}else o=r&~a,o!==0?n=Oy(o):s!==0&&(n=Oy(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&a)&&(a=n&-n,s=e&-e,a>=s||a===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-mf(e),a=1<<r,n|=t[r],e&=~a;return n}function Kfe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qfe(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,a=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-mf(s),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=Kfe(l,e)):c<=e&&(t.expiredLanes|=l),s&=~l}}function aB(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function XW(){var t=QN;return QN<<=1,!(QN&4194240)&&(QN=64),t}function Y4(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function hw(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-mf(e),t[e]=r}function zfe(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var a=31-mf(r),s=1<<a;e[a]=0,n[a]=-1,t[a]=-1,r&=~s}}function LO(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-mf(r),a=1<<n;a&e|t[n]&e&&(t[n]|=e),r&=~a}}var ns=0;function YW(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var JW,UO,ZW,eX,tX,sB=!1,HN=[],em=null,tm=null,rm=null,qb=new Map,zb=new Map,k0=[],Wfe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function VL(t,e){switch(t){case"focusin":case"focusout":em=null;break;case"dragenter":case"dragleave":tm=null;break;case"mouseover":case"mouseout":rm=null;break;case"pointerover":case"pointerout":qb.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":zb.delete(e.pointerId)}}function Y1(t,e,r,n,a,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},e!==null&&(e=mw(e),e!==null&&UO(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function Xfe(t,e,r,n,a){switch(e){case"focusin":return em=Y1(em,t,e,r,n,a),!0;case"dragenter":return tm=Y1(tm,t,e,r,n,a),!0;case"mouseover":return rm=Y1(rm,t,e,r,n,a),!0;case"pointerover":var s=a.pointerId;return qb.set(s,Y1(qb.get(s)||null,t,e,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,zb.set(s,Y1(zb.get(s)||null,t,e,r,n,a)),!0}return!1}function rX(t){var e=Cp(t.target);if(e!==null){var r=Bg(e);if(r!==null){if(e=r.tag,e===13){if(e=$W(r),e!==null){t.blockedOn=e,tX(t.priority,function(){ZW(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Q_(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=iB(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);eB=n,r.target.dispatchEvent(n),eB=null}else return e=mw(r),e!==null&&UO(e),t.blockedOn=r,!1;e.shift()}return!0}function HL(t,e,r){Q_(t)&&r.delete(e)}function Yfe(){sB=!1,em!==null&&Q_(em)&&(em=null),tm!==null&&Q_(tm)&&(tm=null),rm!==null&&Q_(rm)&&(rm=null),qb.forEach(HL),zb.forEach(HL)}function J1(t,e){t.blockedOn===e&&(t.blockedOn=null,sB||(sB=!0,Qu.unstable_scheduleCallback(Qu.unstable_NormalPriority,Yfe)))}function Wb(t){function e(a){return J1(a,t)}if(0<HN.length){J1(HN[0],t);for(var r=1;r<HN.length;r++){var n=HN[r];n.blockedOn===t&&(n.blockedOn=null)}}for(em!==null&&J1(em,t),tm!==null&&J1(tm,t),rm!==null&&J1(rm,t),qb.forEach(e),zb.forEach(e),r=0;r<k0.length;r++)n=k0[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<k0.length&&(r=k0[0],r.blockedOn===null);)rX(r),r.blockedOn===null&&k0.shift()}var lv=TA.ReactCurrentBatchConfig,FE=!0;function Jfe(t,e,r,n){var a=ns,s=lv.transition;lv.transition=null;try{ns=1,QO(t,e,r,n)}finally{ns=a,lv.transition=s}}function Zfe(t,e,r,n){var a=ns,s=lv.transition;lv.transition=null;try{ns=4,QO(t,e,r,n)}finally{ns=a,lv.transition=s}}function QO(t,e,r,n){if(FE){var a=iB(t,e,r,n);if(a===null)o3(t,e,n,OE,r),VL(t,n);else if(Xfe(a,t,e,r,n))n.stopPropagation();else if(VL(t,n),e&4&&-1<Wfe.indexOf(t)){for(;a!==null;){var s=mw(a);if(s!==null&&JW(s),s=iB(t,e,r,n),s===null&&o3(t,e,n,OE,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else o3(t,e,n,null,r)}}var OE=null;function iB(t,e,r,n){if(OE=null,t=RO(n),t=Cp(t),t!==null)if(e=Bg(t),e===null)t=null;else if(r=e.tag,r===13){if(t=$W(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return OE=t,null}function nX(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ufe()){case MO:return 1;case zW:return 4;case BE:case Qfe:return 16;case WW:return 536870912;default:return 16}default:return 16}}var $0=null,VO=null,V_=null;function aX(){if(V_)return V_;var t,e=VO,r=e.length,n,a="value"in $0?$0.value:$0.textContent,s=a.length;for(t=0;t<r&&e[t]===a[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===a[s-n];n++);return V_=a.slice(t,1<n?1-n:void 0)}function H_(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function $N(){return!0}function $L(){return!1}function qu(t){function e(r,n,a,s,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?$N:$L,this.isPropagationStopped=$L,this}return hi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=$N)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=$N)},persist:function(){},isPersistent:$N}),e}var r1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},HO=qu(r1),Aw=hi({},r1,{view:0,detail:0}),ehe=qu(Aw),J4,Z4,Z1,rj=hi({},Aw,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$O,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Z1&&(Z1&&t.type==="mousemove"?(J4=t.screenX-Z1.screenX,Z4=t.screenY-Z1.screenY):Z4=J4=0,Z1=t),J4)},movementY:function(t){return"movementY"in t?t.movementY:Z4}}),GL=qu(rj),the=hi({},rj,{dataTransfer:0}),rhe=qu(the),nhe=hi({},Aw,{relatedTarget:0}),e3=qu(nhe),ahe=hi({},r1,{animationName:0,elapsedTime:0,pseudoElement:0}),she=qu(ahe),ihe=hi({},r1,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ohe=qu(ihe),lhe=hi({},r1,{data:0}),KL=qu(lhe),che={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uhe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dhe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fhe(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=dhe[t])?!!e[t]:!1}function $O(){return fhe}var hhe=hi({},Aw,{key:function(t){if(t.key){var e=che[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=H_(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?uhe[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$O,charCode:function(t){return t.type==="keypress"?H_(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?H_(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Ahe=qu(hhe),mhe=hi({},rj,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qL=qu(mhe),phe=hi({},Aw,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$O}),ghe=qu(phe),xhe=hi({},r1,{propertyName:0,elapsedTime:0,pseudoElement:0}),vhe=qu(xhe),yhe=hi({},rj,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),bhe=qu(yhe),whe=[9,13,27,32],GO=fA&&"CompositionEvent"in window,ob=null;fA&&"documentMode"in document&&(ob=document.documentMode);var Nhe=fA&&"TextEvent"in window&&!ob,sX=fA&&(!GO||ob&&8<ob&&11>=ob),zL=" ",WL=!1;function iX(t,e){switch(t){case"keyup":return whe.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function oX(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Lx=!1;function Che(t,e){switch(t){case"compositionend":return oX(e);case"keypress":return e.which!==32?null:(WL=!0,zL);case"textInput":return t=e.data,t===zL&&WL?null:t;default:return null}}function _he(t,e){if(Lx)return t==="compositionend"||!GO&&iX(t,e)?(t=aX(),V_=VO=$0=null,Lx=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return sX&&e.locale!=="ko"?null:e.data;default:return null}}var Ehe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function XL(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Ehe[t.type]:e==="textarea"}function lX(t,e,r,n){LW(n),e=DE(e,"onChange"),0<e.length&&(r=new HO("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var lb=null,Xb=null;function She(t){vX(t,0)}function nj(t){var e=Vx(t);if(BW(e))return t}function Ihe(t,e){if(t==="change")return e}var cX=!1;if(fA){var t3;if(fA){var r3="oninput"in document;if(!r3){var YL=document.createElement("div");YL.setAttribute("oninput","return;"),r3=typeof YL.oninput=="function"}t3=r3}else t3=!1;cX=t3&&(!document.documentMode||9<document.documentMode)}function JL(){lb&&(lb.detachEvent("onpropertychange",uX),Xb=lb=null)}function uX(t){if(t.propertyName==="value"&&nj(Xb)){var e=[];lX(e,Xb,t,RO(t)),HW(She,e)}}function jhe(t,e,r){t==="focusin"?(JL(),lb=e,Xb=r,lb.attachEvent("onpropertychange",uX)):t==="focusout"&&JL()}function Phe(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return nj(Xb)}function The(t,e){if(t==="click")return nj(e)}function Bhe(t,e){if(t==="input"||t==="change")return nj(e)}function khe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var bf=typeof Object.is=="function"?Object.is:khe;function Yb(t,e){if(bf(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!VT.call(e,a)||!bf(t[a],e[a]))return!1}return!0}function ZL(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function eU(t,e){var r=ZL(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ZL(r)}}function dX(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?dX(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function fX(){for(var t=window,e=jE();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=jE(t.document)}return e}function KO(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Fhe(t){var e=fX(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&dX(r.ownerDocument.documentElement,r)){if(n!==null&&KO(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!t.extend&&s>n&&(a=n,n=s,s=a),a=eU(r,s);var o=eU(r,n);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Ohe=fA&&"documentMode"in document&&11>=document.documentMode,Ux=null,oB=null,cb=null,lB=!1;function tU(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;lB||Ux==null||Ux!==jE(n)||(n=Ux,"selectionStart"in n&&KO(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),cb&&Yb(cb,n)||(cb=n,n=DE(oB,"onSelect"),0<n.length&&(e=new HO("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Ux)))}function GN(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Qx={animationend:GN("Animation","AnimationEnd"),animationiteration:GN("Animation","AnimationIteration"),animationstart:GN("Animation","AnimationStart"),transitionend:GN("Transition","TransitionEnd")},n3={},hX={};fA&&(hX=document.createElement("div").style,"AnimationEvent"in window||(delete Qx.animationend.animation,delete Qx.animationiteration.animation,delete Qx.animationstart.animation),"TransitionEvent"in window||delete Qx.transitionend.transition);function aj(t){if(n3[t])return n3[t];if(!Qx[t])return t;var e=Qx[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in hX)return n3[t]=e[r];return t}var AX=aj("animationend"),mX=aj("animationiteration"),pX=aj("animationstart"),gX=aj("transitionend"),xX=new Map,rU="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dm(t,e){xX.set(t,e),Tg(e,[t])}for(var a3=0;a3<rU.length;a3++){var s3=rU[a3],Dhe=s3.toLowerCase(),Rhe=s3[0].toUpperCase()+s3.slice(1);Dm(Dhe,"on"+Rhe)}Dm(AX,"onAnimationEnd");Dm(mX,"onAnimationIteration");Dm(pX,"onAnimationStart");Dm("dblclick","onDoubleClick");Dm("focusin","onFocus");Dm("focusout","onBlur");Dm(gX,"onTransitionEnd");Nv("onMouseEnter",["mouseout","mouseover"]);Nv("onMouseLeave",["mouseout","mouseover"]);Nv("onPointerEnter",["pointerout","pointerover"]);Nv("onPointerLeave",["pointerout","pointerover"]);Tg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Tg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Tg("onBeforeInput",["compositionend","keypress","textInput","paste"]);Tg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Tg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Tg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mhe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dy));function nU(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Dfe(n,e,void 0,t),t.currentTarget=null}function vX(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],a=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&a.isPropagationStopped())break e;nU(a,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&a.isPropagationStopped())break e;nU(a,l,u),s=c}}}if(TE)throw t=nB,TE=!1,nB=null,t}function Is(t,e){var r=e[hB];r===void 0&&(r=e[hB]=new Set);var n=t+"__bubble";r.has(n)||(yX(e,t,2,!1),r.add(n))}function i3(t,e,r){var n=0;e&&(n|=4),yX(r,t,n,e)}var KN="_reactListening"+Math.random().toString(36).slice(2);function Jb(t){if(!t[KN]){t[KN]=!0,SW.forEach(function(r){r!=="selectionchange"&&(Mhe.has(r)||i3(r,!1,t),i3(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[KN]||(e[KN]=!0,i3("selectionchange",!1,e))}}function yX(t,e,r,n){switch(nX(e)){case 1:var a=Jfe;break;case 4:a=Zfe;break;default:a=QO}r=a.bind(null,e,r,t),a=void 0,!rB||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),n?a!==void 0?t.addEventListener(e,r,{capture:!0,passive:a}):t.addEventListener(e,r,!0):a!==void 0?t.addEventListener(e,r,{passive:a}):t.addEventListener(e,r,!1)}function o3(t,e,r,n,a){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=Cp(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}HW(function(){var u=s,d=RO(r),f=[];e:{var A=xX.get(t);if(A!==void 0){var h=HO,m=t;switch(t){case"keypress":if(H_(r)===0)break e;case"keydown":case"keyup":h=Ahe;break;case"focusin":m="focus",h=e3;break;case"focusout":m="blur",h=e3;break;case"beforeblur":case"afterblur":h=e3;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=GL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=rhe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=ghe;break;case AX:case mX:case pX:h=she;break;case gX:h=vhe;break;case"scroll":h=ehe;break;case"wheel":h=bhe;break;case"copy":case"cut":case"paste":h=ohe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=qL}var p=(e&4)!==0,x=!p&&t==="scroll",v=p?A!==null?A+"Capture":null:A;p=[];for(var y=u,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=Kb(y,v),w!=null&&p.push(Zb(y,w,b)))),x)break;y=y.return}0<p.length&&(A=new h(A,m,null,r,d),f.push({event:A,listeners:p}))}}if(!(e&7)){e:{if(A=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",A&&r!==eB&&(m=r.relatedTarget||r.fromElement)&&(Cp(m)||m[hA]))break e;if((h||A)&&(A=d.window===d?d:(A=d.ownerDocument)?A.defaultView||A.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=u,m=m?Cp(m):null,m!==null&&(x=Bg(m),m!==x||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=u),h!==m)){if(p=GL,w="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(p=qL,w="onPointerLeave",v="onPointerEnter",y="pointer"),x=h==null?A:Vx(h),b=m==null?A:Vx(m),A=new p(w,y+"leave",h,r,d),A.target=x,A.relatedTarget=b,w=null,Cp(d)===u&&(p=new p(v,y+"enter",m,r,d),p.target=b,p.relatedTarget=x,w=p),x=w,h&&m)t:{for(p=h,v=m,y=0,b=p;b;b=ex(b))y++;for(b=0,w=v;w;w=ex(w))b++;for(;0<y-b;)p=ex(p),y--;for(;0<b-y;)v=ex(v),b--;for(;y--;){if(p===v||v!==null&&p===v.alternate)break t;p=ex(p),v=ex(v)}p=null}else p=null;h!==null&&aU(f,A,h,p,!1),m!==null&&x!==null&&aU(f,x,m,p,!0)}}e:{if(A=u?Vx(u):window,h=A.nodeName&&A.nodeName.toLowerCase(),h==="select"||h==="input"&&A.type==="file")var j=Ihe;else if(XL(A))if(cX)j=Bhe;else{j=Phe;var I=jhe}else(h=A.nodeName)&&h.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(j=The);if(j&&(j=j(t,u))){lX(f,j,r,d);break e}I&&I(t,A,u),t==="focusout"&&(I=A._wrapperState)&&I.controlled&&A.type==="number"&&WT(A,"number",A.value)}switch(I=u?Vx(u):window,t){case"focusin":(XL(I)||I.contentEditable==="true")&&(Ux=I,oB=u,cb=null);break;case"focusout":cb=oB=Ux=null;break;case"mousedown":lB=!0;break;case"contextmenu":case"mouseup":case"dragend":lB=!1,tU(f,r,d);break;case"selectionchange":if(Ohe)break;case"keydown":case"keyup":tU(f,r,d)}var C;if(GO)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Lx?iX(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(sX&&r.locale!=="ko"&&(Lx||S!=="onCompositionStart"?S==="onCompositionEnd"&&Lx&&(C=aX()):($0=d,VO="value"in $0?$0.value:$0.textContent,Lx=!0)),I=DE(u,S),0<I.length&&(S=new KL(S,t,null,r,d),f.push({event:S,listeners:I}),C?S.data=C:(C=oX(r),C!==null&&(S.data=C)))),(C=Nhe?Che(t,r):_he(t,r))&&(u=DE(u,"onBeforeInput"),0<u.length&&(d=new KL("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=C))}vX(f,e)})}function Zb(t,e,r){return{instance:t,listener:e,currentTarget:r}}function DE(t,e){for(var r=e+"Capture",n=[];t!==null;){var a=t,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Kb(t,r),s!=null&&n.unshift(Zb(t,s,a)),s=Kb(t,e),s!=null&&n.push(Zb(t,s,a))),t=t.return}return n}function ex(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function aU(t,e,r,n,a){for(var s=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,a?(c=Kb(r,s),c!=null&&o.unshift(Zb(r,c,l))):a||(c=Kb(r,s),c!=null&&o.push(Zb(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var Lhe=/\r\n?/g,Uhe=/\u0000|\uFFFD/g;function sU(t){return(typeof t=="string"?t:""+t).replace(Lhe,`
`).replace(Uhe,"")}function qN(t,e,r){if(e=sU(e),sU(t)!==e&&r)throw Error(Dr(425))}function RE(){}var cB=null,uB=null;function dB(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var fB=typeof setTimeout=="function"?setTimeout:void 0,Qhe=typeof clearTimeout=="function"?clearTimeout:void 0,iU=typeof Promise=="function"?Promise:void 0,Vhe=typeof queueMicrotask=="function"?queueMicrotask:typeof iU<"u"?function(t){return iU.resolve(null).then(t).catch(Hhe)}:fB;function Hhe(t){setTimeout(function(){throw t})}function l3(t,e){var r=e,n=0;do{var a=r.nextSibling;if(t.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){t.removeChild(a),Wb(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Wb(e)}function nm(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function oU(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var n1=Math.random().toString(36).slice(2),qf="__reactFiber$"+n1,e2="__reactProps$"+n1,hA="__reactContainer$"+n1,hB="__reactEvents$"+n1,$he="__reactListeners$"+n1,Ghe="__reactHandles$"+n1;function Cp(t){var e=t[qf];if(e)return e;for(var r=t.parentNode;r;){if(e=r[hA]||r[qf]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=oU(t);t!==null;){if(r=t[qf])return r;t=oU(t)}return e}t=r,r=t.parentNode}return null}function mw(t){return t=t[qf]||t[hA],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Vx(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Dr(33))}function sj(t){return t[e2]||null}var AB=[],Hx=-1;function Rm(t){return{current:t}}function Fs(t){0>Hx||(t.current=AB[Hx],AB[Hx]=null,Hx--)}function bs(t,e){Hx++,AB[Hx]=t.current,t.current=e}var vm={},lc=Rm(vm),su=Rm(!1),Zp=vm;function Cv(t,e){var r=t.type.contextTypes;if(!r)return vm;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function iu(t){return t=t.childContextTypes,t!=null}function ME(){Fs(su),Fs(lc)}function lU(t,e,r){if(lc.current!==vm)throw Error(Dr(168));bs(lc,e),bs(su,r)}function bX(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in e))throw Error(Dr(108,jfe(t)||"Unknown",a));return hi({},r,n)}function LE(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||vm,Zp=lc.current,bs(lc,t),bs(su,su.current),!0}function cU(t,e,r){var n=t.stateNode;if(!n)throw Error(Dr(169));r?(t=bX(t,e,Zp),n.__reactInternalMemoizedMergedChildContext=t,Fs(su),Fs(lc),bs(lc,t)):Fs(su),bs(su,r)}var Uh=null,ij=!1,c3=!1;function wX(t){Uh===null?Uh=[t]:Uh.push(t)}function Khe(t){ij=!0,wX(t)}function Mm(){if(!c3&&Uh!==null){c3=!0;var t=0,e=ns;try{var r=Uh;for(ns=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Uh=null,ij=!1}catch(a){throw Uh!==null&&(Uh=Uh.slice(t+1)),qW(MO,Mm),a}finally{ns=e,c3=!1}}return null}var $x=[],Gx=0,UE=null,QE=0,vd=[],yd=0,eg=null,Gh=1,Kh="";function lp(t,e){$x[Gx++]=QE,$x[Gx++]=UE,UE=t,QE=e}function NX(t,e,r){vd[yd++]=Gh,vd[yd++]=Kh,vd[yd++]=eg,eg=t;var n=Gh;t=Kh;var a=32-mf(n)-1;n&=~(1<<a),r+=1;var s=32-mf(e)+a;if(30<s){var o=a-a%5;s=(n&(1<<o)-1).toString(32),n>>=o,a-=o,Gh=1<<32-mf(e)+a|r<<a|n,Kh=s+t}else Gh=1<<s|r<<a|n,Kh=t}function qO(t){t.return!==null&&(lp(t,1),NX(t,1,0))}function zO(t){for(;t===UE;)UE=$x[--Gx],$x[Gx]=null,QE=$x[--Gx],$x[Gx]=null;for(;t===eg;)eg=vd[--yd],vd[yd]=null,Kh=vd[--yd],vd[yd]=null,Gh=vd[--yd],vd[yd]=null}var Mu=null,Fu=null,Hs=!1,of=null;function CX(t,e){var r=wd(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function uU(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Mu=t,Fu=nm(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Mu=t,Fu=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=eg!==null?{id:Gh,overflow:Kh}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=wd(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Mu=t,Fu=null,!0):!1;default:return!1}}function mB(t){return(t.mode&1)!==0&&(t.flags&128)===0}function pB(t){if(Hs){var e=Fu;if(e){var r=e;if(!uU(t,e)){if(mB(t))throw Error(Dr(418));e=nm(r.nextSibling);var n=Mu;e&&uU(t,e)?CX(n,r):(t.flags=t.flags&-4097|2,Hs=!1,Mu=t)}}else{if(mB(t))throw Error(Dr(418));t.flags=t.flags&-4097|2,Hs=!1,Mu=t}}}function dU(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Mu=t}function zN(t){if(t!==Mu)return!1;if(!Hs)return dU(t),Hs=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!dB(t.type,t.memoizedProps)),e&&(e=Fu)){if(mB(t))throw _X(),Error(Dr(418));for(;e;)CX(t,e),e=nm(e.nextSibling)}if(dU(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Dr(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Fu=nm(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Fu=null}}else Fu=Mu?nm(t.stateNode.nextSibling):null;return!0}function _X(){for(var t=Fu;t;)t=nm(t.nextSibling)}function _v(){Fu=Mu=null,Hs=!1}function WO(t){of===null?of=[t]:of.push(t)}var qhe=TA.ReactCurrentBatchConfig;function ey(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Dr(309));var n=r.stateNode}if(!n)throw Error(Dr(147,t));var a=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=a.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Dr(284));if(!r._owner)throw Error(Dr(290,t))}return t}function WN(t,e){throw t=Object.prototype.toString.call(e),Error(Dr(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function fU(t){var e=t._init;return e(t._payload)}function EX(t){function e(v,y){if(t){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function a(v,y){return v=om(v,y),v.index=0,v.sibling=null,v}function s(v,y,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,y,b,w){return y===null||y.tag!==6?(y=p3(b,v.mode,w),y.return=v,y):(y=a(y,b),y.return=v,y)}function c(v,y,b,w){var j=b.type;return j===Mx?d(v,y,b.props.children,w,b.key):y!==null&&(y.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===S0&&fU(j)===y.type)?(w=a(y,b.props),w.ref=ey(v,y,b),w.return=v,w):(w=X_(b.type,b.key,b.props,null,v.mode,w),w.ref=ey(v,y,b),w.return=v,w)}function u(v,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=g3(b,v.mode,w),y.return=v,y):(y=a(y,b.children||[]),y.return=v,y)}function d(v,y,b,w,j){return y===null||y.tag!==7?(y=Dp(b,v.mode,w,j),y.return=v,y):(y=a(y,b),y.return=v,y)}function f(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=p3(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case MN:return b=X_(y.type,y.key,y.props,null,v.mode,b),b.ref=ey(v,null,y),b.return=v,b;case Rx:return y=g3(y,v.mode,b),y.return=v,y;case S0:var w=y._init;return f(v,w(y._payload),b)}if(Fy(y)||W1(y))return y=Dp(y,v.mode,b,null),y.return=v,y;WN(v,y)}return null}function A(v,y,b,w){var j=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return j!==null?null:l(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case MN:return b.key===j?c(v,y,b,w):null;case Rx:return b.key===j?u(v,y,b,w):null;case S0:return j=b._init,A(v,y,j(b._payload),w)}if(Fy(b)||W1(b))return j!==null?null:d(v,y,b,w,null);WN(v,b)}return null}function h(v,y,b,w,j){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,l(y,v,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case MN:return v=v.get(w.key===null?b:w.key)||null,c(y,v,w,j);case Rx:return v=v.get(w.key===null?b:w.key)||null,u(y,v,w,j);case S0:var I=w._init;return h(v,y,b,I(w._payload),j)}if(Fy(w)||W1(w))return v=v.get(b)||null,d(y,v,w,j,null);WN(y,w)}return null}function m(v,y,b,w){for(var j=null,I=null,C=y,S=y=0,E=null;C!==null&&S<b.length;S++){C.index>S?(E=C,C=null):E=C.sibling;var B=A(v,C,b[S],w);if(B===null){C===null&&(C=E);break}t&&C&&B.alternate===null&&e(v,C),y=s(B,y,S),I===null?j=B:I.sibling=B,I=B,C=E}if(S===b.length)return r(v,C),Hs&&lp(v,S),j;if(C===null){for(;S<b.length;S++)C=f(v,b[S],w),C!==null&&(y=s(C,y,S),I===null?j=C:I.sibling=C,I=C);return Hs&&lp(v,S),j}for(C=n(v,C);S<b.length;S++)E=h(C,v,S,b[S],w),E!==null&&(t&&E.alternate!==null&&C.delete(E.key===null?S:E.key),y=s(E,y,S),I===null?j=E:I.sibling=E,I=E);return t&&C.forEach(function(k){return e(v,k)}),Hs&&lp(v,S),j}function p(v,y,b,w){var j=W1(b);if(typeof j!="function")throw Error(Dr(150));if(b=j.call(b),b==null)throw Error(Dr(151));for(var I=j=null,C=y,S=y=0,E=null,B=b.next();C!==null&&!B.done;S++,B=b.next()){C.index>S?(E=C,C=null):E=C.sibling;var k=A(v,C,B.value,w);if(k===null){C===null&&(C=E);break}t&&C&&k.alternate===null&&e(v,C),y=s(k,y,S),I===null?j=k:I.sibling=k,I=k,C=E}if(B.done)return r(v,C),Hs&&lp(v,S),j;if(C===null){for(;!B.done;S++,B=b.next())B=f(v,B.value,w),B!==null&&(y=s(B,y,S),I===null?j=B:I.sibling=B,I=B);return Hs&&lp(v,S),j}for(C=n(v,C);!B.done;S++,B=b.next())B=h(C,v,S,B.value,w),B!==null&&(t&&B.alternate!==null&&C.delete(B.key===null?S:B.key),y=s(B,y,S),I===null?j=B:I.sibling=B,I=B);return t&&C.forEach(function(T){return e(v,T)}),Hs&&lp(v,S),j}function x(v,y,b,w){if(typeof b=="object"&&b!==null&&b.type===Mx&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case MN:e:{for(var j=b.key,I=y;I!==null;){if(I.key===j){if(j=b.type,j===Mx){if(I.tag===7){r(v,I.sibling),y=a(I,b.props.children),y.return=v,v=y;break e}}else if(I.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===S0&&fU(j)===I.type){r(v,I.sibling),y=a(I,b.props),y.ref=ey(v,I,b),y.return=v,v=y;break e}r(v,I);break}else e(v,I);I=I.sibling}b.type===Mx?(y=Dp(b.props.children,v.mode,w,b.key),y.return=v,v=y):(w=X_(b.type,b.key,b.props,null,v.mode,w),w.ref=ey(v,y,b),w.return=v,v=w)}return o(v);case Rx:e:{for(I=b.key;y!==null;){if(y.key===I)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=a(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else e(v,y);y=y.sibling}y=g3(b,v.mode,w),y.return=v,v=y}return o(v);case S0:return I=b._init,x(v,y,I(b._payload),w)}if(Fy(b))return m(v,y,b,w);if(W1(b))return p(v,y,b,w);WN(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=a(y,b),y.return=v,v=y):(r(v,y),y=p3(b,v.mode,w),y.return=v,v=y),o(v)):r(v,y)}return x}var Ev=EX(!0),SX=EX(!1),VE=Rm(null),HE=null,Kx=null,XO=null;function YO(){XO=Kx=HE=null}function JO(t){var e=VE.current;Fs(VE),t._currentValue=e}function gB(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function cv(t,e){HE=t,XO=Kx=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ru=!0),t.firstContext=null)}function kd(t){var e=t._currentValue;if(XO!==t)if(t={context:t,memoizedValue:e,next:null},Kx===null){if(HE===null)throw Error(Dr(308));Kx=t,HE.dependencies={lanes:0,firstContext:t}}else Kx=Kx.next=t;return e}var _p=null;function ZO(t){_p===null?_p=[t]:_p.push(t)}function IX(t,e,r,n){var a=e.interleaved;return a===null?(r.next=r,ZO(e)):(r.next=a.next,a.next=r),e.interleaved=r,AA(t,n)}function AA(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var I0=!1;function eD(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jX(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function tA(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function am(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ca&2){var a=n.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),n.pending=e,AA(t,r)}return a=n.interleaved,a===null?(e.next=e,ZO(n)):(e.next=a.next,a.next=e),n.interleaved=e,AA(t,r)}function $_(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,LO(t,r)}}function hU(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?a=s=e:s=s.next=e}else a=s=e;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function $E(t,e,r,n){var a=t.updateQueue;I0=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=a.baseState;o=0,d=u=c=null,l=s;do{var A=l.lane,h=l.eventTime;if((n&A)===A){d!==null&&(d=d.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,p=l;switch(A=e,h=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){f=m.call(h,f,A);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,A=typeof m=="function"?m.call(h,f,A):m,A==null)break e;f=hi({},f,A);break e;case 2:I0=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,A=a.effects,A===null?a.effects=[l]:A.push(l))}else h={eventTime:h,lane:A,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=h,c=f):d=d.next=h,o|=A;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;A=l,l=A.next,A.next=null,a.lastBaseUpdate=A,a.shared.pending=null}}while(!0);if(d===null&&(c=f),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else s===null&&(a.shared.lanes=0);rg|=o,t.lanes=o,t.memoizedState=f}}function AU(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Dr(191,a));a.call(n)}}}var pw={},ah=Rm(pw),t2=Rm(pw),r2=Rm(pw);function Ep(t){if(t===pw)throw Error(Dr(174));return t}function tD(t,e){switch(bs(r2,e),bs(t2,t),bs(ah,pw),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:YT(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=YT(e,t)}Fs(ah),bs(ah,e)}function Sv(){Fs(ah),Fs(t2),Fs(r2)}function PX(t){Ep(r2.current);var e=Ep(ah.current),r=YT(e,t.type);e!==r&&(bs(t2,t),bs(ah,r))}function rD(t){t2.current===t&&(Fs(ah),Fs(t2))}var li=Rm(0);function GE(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var u3=[];function nD(){for(var t=0;t<u3.length;t++)u3[t]._workInProgressVersionPrimary=null;u3.length=0}var G_=TA.ReactCurrentDispatcher,d3=TA.ReactCurrentBatchConfig,tg=0,fi=null,Co=null,Jo=null,KE=!1,ub=!1,n2=0,zhe=0;function Ll(){throw Error(Dr(321))}function aD(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!bf(t[r],e[r]))return!1;return!0}function sD(t,e,r,n,a,s){if(tg=s,fi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,G_.current=t===null||t.memoizedState===null?Jhe:Zhe,t=r(n,a),ub){s=0;do{if(ub=!1,n2=0,25<=s)throw Error(Dr(301));s+=1,Jo=Co=null,e.updateQueue=null,G_.current=eAe,t=r(n,a)}while(ub)}if(G_.current=qE,e=Co!==null&&Co.next!==null,tg=0,Jo=Co=fi=null,KE=!1,e)throw Error(Dr(300));return t}function iD(){var t=n2!==0;return n2=0,t}function Kf(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jo===null?fi.memoizedState=Jo=t:Jo=Jo.next=t,Jo}function Fd(){if(Co===null){var t=fi.alternate;t=t!==null?t.memoizedState:null}else t=Co.next;var e=Jo===null?fi.memoizedState:Jo.next;if(e!==null)Jo=e,Co=t;else{if(t===null)throw Error(Dr(310));Co=t,t={memoizedState:Co.memoizedState,baseState:Co.baseState,baseQueue:Co.baseQueue,queue:Co.queue,next:null},Jo===null?fi.memoizedState=Jo=t:Jo=Jo.next=t}return Jo}function a2(t,e){return typeof e=="function"?e(t):e}function f3(t){var e=Fd(),r=e.queue;if(r===null)throw Error(Dr(311));r.lastRenderedReducer=t;var n=Co,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var o=a.next;a.next=s.next,s.next=o}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((tg&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,fi.lanes|=d,rg|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,bf(n,e.memoizedState)||(ru=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){a=t;do s=a.lane,fi.lanes|=s,rg|=s,a=a.next;while(a!==t)}else a===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function h3(t){var e=Fd(),r=e.queue;if(r===null)throw Error(Dr(311));r.lastRenderedReducer=t;var n=r.dispatch,a=r.pending,s=e.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do s=t(s,o.action),o=o.next;while(o!==a);bf(s,e.memoizedState)||(ru=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function TX(){}function BX(t,e){var r=fi,n=Fd(),a=e(),s=!bf(n.memoizedState,a);if(s&&(n.memoizedState=a,ru=!0),n=n.queue,oD(OX.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Jo!==null&&Jo.memoizedState.tag&1){if(r.flags|=2048,s2(9,FX.bind(null,r,n,a,e),void 0,null),rl===null)throw Error(Dr(349));tg&30||kX(r,e,a)}return a}function kX(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=fi.updateQueue,e===null?(e={lastEffect:null,stores:null},fi.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function FX(t,e,r,n){e.value=r,e.getSnapshot=n,DX(e)&&RX(t)}function OX(t,e,r){return r(function(){DX(e)&&RX(t)})}function DX(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!bf(t,r)}catch{return!0}}function RX(t){var e=AA(t,1);e!==null&&pf(e,t,1,-1)}function mU(t){var e=Kf();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a2,lastRenderedState:t},e.queue=t,t=t.dispatch=Yhe.bind(null,fi,t),[e.memoizedState,t]}function s2(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=fi.updateQueue,e===null?(e={lastEffect:null,stores:null},fi.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function MX(){return Fd().memoizedState}function K_(t,e,r,n){var a=Kf();fi.flags|=t,a.memoizedState=s2(1|e,r,void 0,n===void 0?null:n)}function oj(t,e,r,n){var a=Fd();n=n===void 0?null:n;var s=void 0;if(Co!==null){var o=Co.memoizedState;if(s=o.destroy,n!==null&&aD(n,o.deps)){a.memoizedState=s2(e,r,s,n);return}}fi.flags|=t,a.memoizedState=s2(1|e,r,s,n)}function pU(t,e){return K_(8390656,8,t,e)}function oD(t,e){return oj(2048,8,t,e)}function LX(t,e){return oj(4,2,t,e)}function UX(t,e){return oj(4,4,t,e)}function QX(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function VX(t,e,r){return r=r!=null?r.concat([t]):null,oj(4,4,QX.bind(null,e,t),r)}function lD(){}function HX(t,e){var r=Fd();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&aD(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function $X(t,e){var r=Fd();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&aD(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function GX(t,e,r){return tg&21?(bf(r,e)||(r=XW(),fi.lanes|=r,rg|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ru=!0),t.memoizedState=r)}function Whe(t,e){var r=ns;ns=r!==0&&4>r?r:4,t(!0);var n=d3.transition;d3.transition={};try{t(!1),e()}finally{ns=r,d3.transition=n}}function KX(){return Fd().memoizedState}function Xhe(t,e,r){var n=im(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},qX(t))zX(e,r);else if(r=IX(t,e,r,n),r!==null){var a=Pc();pf(r,t,n,a),WX(r,e,n)}}function Yhe(t,e,r){var n=im(t),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(qX(t))zX(e,a);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,r);if(a.hasEagerState=!0,a.eagerState=l,bf(l,o)){var c=e.interleaved;c===null?(a.next=a,ZO(e)):(a.next=c.next,c.next=a),e.interleaved=a;return}}catch{}finally{}r=IX(t,e,a,n),r!==null&&(a=Pc(),pf(r,t,n,a),WX(r,e,n))}}function qX(t){var e=t.alternate;return t===fi||e!==null&&e===fi}function zX(t,e){ub=KE=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function WX(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,LO(t,r)}}var qE={readContext:kd,useCallback:Ll,useContext:Ll,useEffect:Ll,useImperativeHandle:Ll,useInsertionEffect:Ll,useLayoutEffect:Ll,useMemo:Ll,useReducer:Ll,useRef:Ll,useState:Ll,useDebugValue:Ll,useDeferredValue:Ll,useTransition:Ll,useMutableSource:Ll,useSyncExternalStore:Ll,useId:Ll,unstable_isNewReconciler:!1},Jhe={readContext:kd,useCallback:function(t,e){return Kf().memoizedState=[t,e===void 0?null:e],t},useContext:kd,useEffect:pU,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,K_(4194308,4,QX.bind(null,e,t),r)},useLayoutEffect:function(t,e){return K_(4194308,4,t,e)},useInsertionEffect:function(t,e){return K_(4,2,t,e)},useMemo:function(t,e){var r=Kf();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Kf();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Xhe.bind(null,fi,t),[n.memoizedState,t]},useRef:function(t){var e=Kf();return t={current:t},e.memoizedState=t},useState:mU,useDebugValue:lD,useDeferredValue:function(t){return Kf().memoizedState=t},useTransition:function(){var t=mU(!1),e=t[0];return t=Whe.bind(null,t[1]),Kf().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=fi,a=Kf();if(Hs){if(r===void 0)throw Error(Dr(407));r=r()}else{if(r=e(),rl===null)throw Error(Dr(349));tg&30||kX(n,e,r)}a.memoizedState=r;var s={value:r,getSnapshot:e};return a.queue=s,pU(OX.bind(null,n,s,t),[t]),n.flags|=2048,s2(9,FX.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Kf(),e=rl.identifierPrefix;if(Hs){var r=Kh,n=Gh;r=(n&~(1<<32-mf(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=n2++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=zhe++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Zhe={readContext:kd,useCallback:HX,useContext:kd,useEffect:oD,useImperativeHandle:VX,useInsertionEffect:LX,useLayoutEffect:UX,useMemo:$X,useReducer:f3,useRef:MX,useState:function(){return f3(a2)},useDebugValue:lD,useDeferredValue:function(t){var e=Fd();return GX(e,Co.memoizedState,t)},useTransition:function(){var t=f3(a2)[0],e=Fd().memoizedState;return[t,e]},useMutableSource:TX,useSyncExternalStore:BX,useId:KX,unstable_isNewReconciler:!1},eAe={readContext:kd,useCallback:HX,useContext:kd,useEffect:oD,useImperativeHandle:VX,useInsertionEffect:LX,useLayoutEffect:UX,useMemo:$X,useReducer:h3,useRef:MX,useState:function(){return h3(a2)},useDebugValue:lD,useDeferredValue:function(t){var e=Fd();return Co===null?e.memoizedState=t:GX(e,Co.memoizedState,t)},useTransition:function(){var t=h3(a2)[0],e=Fd().memoizedState;return[t,e]},useMutableSource:TX,useSyncExternalStore:BX,useId:KX,unstable_isNewReconciler:!1};function af(t,e){if(t&&t.defaultProps){e=hi({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function xB(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:hi({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var lj={isMounted:function(t){return(t=t._reactInternals)?Bg(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Pc(),a=im(t),s=tA(n,a);s.payload=e,r!=null&&(s.callback=r),e=am(t,s,a),e!==null&&(pf(e,t,a,n),$_(e,t,a))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Pc(),a=im(t),s=tA(n,a);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=am(t,s,a),e!==null&&(pf(e,t,a,n),$_(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Pc(),n=im(t),a=tA(r,n);a.tag=2,e!=null&&(a.callback=e),e=am(t,a,n),e!==null&&(pf(e,t,n,r),$_(e,t,n))}};function gU(t,e,r,n,a,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Yb(r,n)||!Yb(a,s):!0}function XX(t,e,r){var n=!1,a=vm,s=e.contextType;return typeof s=="object"&&s!==null?s=kd(s):(a=iu(e)?Zp:lc.current,n=e.contextTypes,s=(n=n!=null)?Cv(t,a):vm),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=lj,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=s),e}function xU(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&lj.enqueueReplaceState(e,e.state,null)}function vB(t,e,r,n){var a=t.stateNode;a.props=r,a.state=t.memoizedState,a.refs={},eD(t);var s=e.contextType;typeof s=="object"&&s!==null?a.context=kd(s):(s=iu(e)?Zp:lc.current,a.context=Cv(t,s)),a.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(xB(t,e,s,r),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&lj.enqueueReplaceState(a,a.state,null),$E(t,r,a,n),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function Iv(t,e){try{var r="",n=e;do r+=Ife(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:a,digest:null}}function A3(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function yB(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var tAe=typeof WeakMap=="function"?WeakMap:Map;function YX(t,e,r){r=tA(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){WE||(WE=!0,PB=n),yB(t,e)},r}function JX(t,e,r){r=tA(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var a=e.value;r.payload=function(){return n(a)},r.callback=function(){yB(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){yB(t,e),typeof n!="function"&&(sm===null?sm=new Set([this]):sm.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function vU(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new tAe;var a=new Set;n.set(e,a)}else a=n.get(e),a===void 0&&(a=new Set,n.set(e,a));a.has(r)||(a.add(r),t=mAe.bind(null,t,e,r),e.then(t,t))}function yU(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function bU(t,e,r,n,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=tA(-1,1),e.tag=2,am(r,e,1))),r.lanes|=1),t)}var rAe=TA.ReactCurrentOwner,ru=!1;function wc(t,e,r,n){e.child=t===null?SX(e,null,r,n):Ev(e,t.child,r,n)}function wU(t,e,r,n,a){r=r.render;var s=e.ref;return cv(e,a),n=sD(t,e,r,n,s,a),r=iD(),t!==null&&!ru?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,mA(t,e,a)):(Hs&&r&&qO(e),e.flags|=1,wc(t,e,n,a),e.child)}function NU(t,e,r,n,a){if(t===null){var s=r.type;return typeof s=="function"&&!pD(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,ZX(t,e,s,n,a)):(t=X_(r.type,null,n,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&a)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Yb,r(o,n)&&t.ref===e.ref)return mA(t,e,a)}return e.flags|=1,t=om(s,n),t.ref=e.ref,t.return=e,e.child=t}function ZX(t,e,r,n,a){if(t!==null){var s=t.memoizedProps;if(Yb(s,n)&&t.ref===e.ref)if(ru=!1,e.pendingProps=n=s,(t.lanes&a)!==0)t.flags&131072&&(ru=!0);else return e.lanes=t.lanes,mA(t,e,a)}return bB(t,e,r,n,a)}function eY(t,e,r){var n=e.pendingProps,a=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},bs(zx,Su),Su|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,bs(zx,Su),Su|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,bs(zx,Su),Su|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,bs(zx,Su),Su|=n;return wc(t,e,a,r),e.child}function tY(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function bB(t,e,r,n,a){var s=iu(r)?Zp:lc.current;return s=Cv(e,s),cv(e,a),r=sD(t,e,r,n,s,a),n=iD(),t!==null&&!ru?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,mA(t,e,a)):(Hs&&n&&qO(e),e.flags|=1,wc(t,e,r,a),e.child)}function CU(t,e,r,n,a){if(iu(r)){var s=!0;LE(e)}else s=!1;if(cv(e,a),e.stateNode===null)q_(t,e),XX(e,r,n),vB(e,r,n,a),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=kd(u):(u=iu(r)?Zp:lc.current,u=Cv(e,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&xU(e,o,n,u),I0=!1;var A=e.memoizedState;o.state=A,$E(e,n,o,a),c=e.memoizedState,l!==n||A!==c||su.current||I0?(typeof d=="function"&&(xB(e,r,d,n),c=e.memoizedState),(l=I0||gU(e,r,l,n,A,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,jX(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:af(e.type,l),o.props=u,f=e.pendingProps,A=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=kd(c):(c=iu(r)?Zp:lc.current,c=Cv(e,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||A!==c)&&xU(e,o,n,c),I0=!1,A=e.memoizedState,o.state=A,$E(e,n,o,a);var m=e.memoizedState;l!==f||A!==m||su.current||I0?(typeof h=="function"&&(xB(e,r,h,n),m=e.memoizedState),(u=I0||gU(e,r,u,n,A,m,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),n=!1)}return wB(t,e,r,n,s,a)}function wB(t,e,r,n,a,s){tY(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return a&&cU(e,r,!1),mA(t,e,s);n=e.stateNode,rAe.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Ev(e,t.child,null,s),e.child=Ev(e,null,l,s)):wc(t,e,l,s),e.memoizedState=n.state,a&&cU(e,r,!0),e.child}function rY(t){var e=t.stateNode;e.pendingContext?lU(t,e.pendingContext,e.pendingContext!==e.context):e.context&&lU(t,e.context,!1),tD(t,e.containerInfo)}function _U(t,e,r,n,a){return _v(),WO(a),e.flags|=256,wc(t,e,r,n),e.child}var NB={dehydrated:null,treeContext:null,retryLane:0};function CB(t){return{baseLanes:t,cachePool:null,transitions:null}}function nY(t,e,r){var n=e.pendingProps,a=li.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(a&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),bs(li,a&1),t===null)return pB(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=dj(o,n,0,null),t=Dp(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=CB(r),e.memoizedState=NB,t):cD(e,o));if(a=t.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return nAe(t,e,o,n,l,a,r);if(s){s=n.fallback,o=e.mode,a=t.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==a?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=om(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?s=om(l,s):(s=Dp(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?CB(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=NB,n}return s=t.child,t=s.sibling,n=om(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function cD(t,e){return e=dj({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function XN(t,e,r,n){return n!==null&&WO(n),Ev(e,t.child,null,r),t=cD(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function nAe(t,e,r,n,a,s,o){if(r)return e.flags&256?(e.flags&=-257,n=A3(Error(Dr(422))),XN(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,a=e.mode,n=dj({mode:"visible",children:n.children},a,0,null),s=Dp(s,a,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Ev(e,t.child,null,o),e.child.memoizedState=CB(o),e.memoizedState=NB,s);if(!(e.mode&1))return XN(t,e,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Dr(419)),n=A3(s,n,void 0),XN(t,e,o,n)}if(l=(o&t.childLanes)!==0,ru||l){if(n=rl,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,AA(t,a),pf(n,t,a,-1))}return mD(),n=A3(Error(Dr(421))),XN(t,e,o,n)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=pAe.bind(null,t),a._reactRetry=e,null):(t=s.treeContext,Fu=nm(a.nextSibling),Mu=e,Hs=!0,of=null,t!==null&&(vd[yd++]=Gh,vd[yd++]=Kh,vd[yd++]=eg,Gh=t.id,Kh=t.overflow,eg=e),e=cD(e,n.children),e.flags|=4096,e)}function EU(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),gB(t.return,e,r)}function m3(t,e,r,n,a){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function aY(t,e,r){var n=e.pendingProps,a=n.revealOrder,s=n.tail;if(wc(t,e,n.children,r),n=li.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&EU(t,r,e);else if(t.tag===19)EU(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(bs(li,n),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(r=e.child,a=null;r!==null;)t=r.alternate,t!==null&&GE(t)===null&&(a=r),r=r.sibling;r=a,r===null?(a=e.child,e.child=null):(a=r.sibling,r.sibling=null),m3(e,!1,a,r,s);break;case"backwards":for(r=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&GE(t)===null){e.child=a;break}t=a.sibling,a.sibling=r,r=a,a=t}m3(e,!0,r,null,s);break;case"together":m3(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function q_(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function mA(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),rg|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Dr(153));if(e.child!==null){for(t=e.child,r=om(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=om(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function aAe(t,e,r){switch(e.tag){case 3:rY(e),_v();break;case 5:PX(e);break;case 1:iu(e.type)&&LE(e);break;case 4:tD(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,a=e.memoizedProps.value;bs(VE,n._currentValue),n._currentValue=a;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(bs(li,li.current&1),e.flags|=128,null):r&e.child.childLanes?nY(t,e,r):(bs(li,li.current&1),t=mA(t,e,r),t!==null?t.sibling:null);bs(li,li.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return aY(t,e,r);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),bs(li,li.current),n)break;return null;case 22:case 23:return e.lanes=0,eY(t,e,r)}return mA(t,e,r)}var sY,_B,iY,oY;sY=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};_B=function(){};iY=function(t,e,r,n){var a=t.memoizedProps;if(a!==n){t=e.stateNode,Ep(ah.current);var s=null;switch(r){case"input":a=qT(t,a),n=qT(t,n),s=[];break;case"select":a=hi({},a,{value:void 0}),n=hi({},n,{value:void 0}),s=[];break;case"textarea":a=XT(t,a),n=XT(t,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=RE)}JT(r,n);var o;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var l=a[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&($b.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&($b.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Is("scroll",t),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};oY=function(t,e,r,n){r!==n&&(e.flags|=4)};function ty(t,e){if(!Hs)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Ul(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function sAe(t,e,r){var n=e.pendingProps;switch(zO(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ul(e),null;case 1:return iu(e.type)&&ME(),Ul(e),null;case 3:return n=e.stateNode,Sv(),Fs(su),Fs(lc),nD(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(zN(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,of!==null&&(kB(of),of=null))),_B(t,e),Ul(e),null;case 5:rD(e);var a=Ep(r2.current);if(r=e.type,t!==null&&e.stateNode!=null)iY(t,e,r,n,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Dr(166));return Ul(e),null}if(t=Ep(ah.current),zN(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[qf]=e,n[e2]=s,t=(e.mode&1)!==0,r){case"dialog":Is("cancel",n),Is("close",n);break;case"iframe":case"object":case"embed":Is("load",n);break;case"video":case"audio":for(a=0;a<Dy.length;a++)Is(Dy[a],n);break;case"source":Is("error",n);break;case"img":case"image":case"link":Is("error",n),Is("load",n);break;case"details":Is("toggle",n);break;case"input":OL(n,s),Is("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Is("invalid",n);break;case"textarea":RL(n,s),Is("invalid",n)}JT(r,s),a=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&qN(n.textContent,l,t),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&qN(n.textContent,l,t),a=["children",""+l]):$b.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Is("scroll",n)}switch(r){case"input":LN(n),DL(n,s,!0);break;case"textarea":LN(n),ML(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=RE)}n=a,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=OW(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[qf]=e,t[e2]=n,sY(t,e,!1,!1),e.stateNode=t;e:{switch(o=ZT(r,n),r){case"dialog":Is("cancel",t),Is("close",t),a=n;break;case"iframe":case"object":case"embed":Is("load",t),a=n;break;case"video":case"audio":for(a=0;a<Dy.length;a++)Is(Dy[a],t);a=n;break;case"source":Is("error",t),a=n;break;case"img":case"image":case"link":Is("error",t),Is("load",t),a=n;break;case"details":Is("toggle",t),a=n;break;case"input":OL(t,n),a=qT(t,n),Is("invalid",t);break;case"option":a=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},a=hi({},n,{value:void 0}),Is("invalid",t);break;case"textarea":RL(t,n),a=XT(t,n),Is("invalid",t);break;default:a=n}JT(r,a),l=a;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?MW(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&DW(t,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Gb(t,c):typeof c=="number"&&Gb(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&($b.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Is("scroll",t):c!=null&&kO(t,s,c,o))}switch(r){case"input":LN(t),DL(t,n,!1);break;case"textarea":LN(t),ML(t);break;case"option":n.value!=null&&t.setAttribute("value",""+xm(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?sv(t,!!n.multiple,s,!1):n.defaultValue!=null&&sv(t,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=RE)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ul(e),null;case 6:if(t&&e.stateNode!=null)oY(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Dr(166));if(r=Ep(r2.current),Ep(ah.current),zN(e)){if(n=e.stateNode,r=e.memoizedProps,n[qf]=e,(s=n.nodeValue!==r)&&(t=Mu,t!==null))switch(t.tag){case 3:qN(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&qN(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[qf]=e,e.stateNode=n}return Ul(e),null;case 13:if(Fs(li),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Hs&&Fu!==null&&e.mode&1&&!(e.flags&128))_X(),_v(),e.flags|=98560,s=!1;else if(s=zN(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Dr(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Dr(317));s[qf]=e}else _v(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ul(e),s=!1}else of!==null&&(kB(of),of=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||li.current&1?ko===0&&(ko=3):mD())),e.updateQueue!==null&&(e.flags|=4),Ul(e),null);case 4:return Sv(),_B(t,e),t===null&&Jb(e.stateNode.containerInfo),Ul(e),null;case 10:return JO(e.type._context),Ul(e),null;case 17:return iu(e.type)&&ME(),Ul(e),null;case 19:if(Fs(li),s=e.memoizedState,s===null)return Ul(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)ty(s,!1);else{if(ko!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=GE(t),o!==null){for(e.flags|=128,ty(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return bs(li,li.current&1|2),e.child}t=t.sibling}s.tail!==null&&Hi()>jv&&(e.flags|=128,n=!0,ty(s,!1),e.lanes=4194304)}else{if(!n)if(t=GE(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ty(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Hs)return Ul(e),null}else 2*Hi()-s.renderingStartTime>jv&&r!==1073741824&&(e.flags|=128,n=!0,ty(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Hi(),e.sibling=null,r=li.current,bs(li,n?r&1|2:r&1),e):(Ul(e),null);case 22:case 23:return AD(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Su&1073741824&&(Ul(e),e.subtreeFlags&6&&(e.flags|=8192)):Ul(e),null;case 24:return null;case 25:return null}throw Error(Dr(156,e.tag))}function iAe(t,e){switch(zO(e),e.tag){case 1:return iu(e.type)&&ME(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Sv(),Fs(su),Fs(lc),nD(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return rD(e),null;case 13:if(Fs(li),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Dr(340));_v()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Fs(li),null;case 4:return Sv(),null;case 10:return JO(e.type._context),null;case 22:case 23:return AD(),null;case 24:return null;default:return null}}var YN=!1,rc=!1,oAe=typeof WeakSet=="function"?WeakSet:Set,on=null;function qx(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ei(t,e,n)}else r.current=null}function EB(t,e,r){try{r()}catch(n){Ei(t,e,n)}}var SU=!1;function lAe(t,e){if(cB=FE,t=fX(),KO(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=t,A=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(l=o+a),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)A=f,f=h;for(;;){if(f===t)break t;if(A===r&&++u===a&&(l=o),A===s&&++d===n&&(c=o),(h=f.nextSibling)!==null)break;f=A,A=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(uB={focusedElem:t,selectionRange:r},FE=!1,on=e;on!==null;)if(e=on,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,on=t;else for(;on!==null;){e=on;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,x=m.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?p:af(e.type,p),x);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Dr(163))}}catch(w){Ei(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,on=t;break}on=e.return}return m=SU,SU=!1,m}function db(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&t)===t){var s=a.destroy;a.destroy=void 0,s!==void 0&&EB(e,r,s)}a=a.next}while(a!==n)}}function cj(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function SB(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function lY(t){var e=t.alternate;e!==null&&(t.alternate=null,lY(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[qf],delete e[e2],delete e[hB],delete e[$he],delete e[Ghe])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function cY(t){return t.tag===5||t.tag===3||t.tag===4}function IU(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||cY(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function IB(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=RE));else if(n!==4&&(t=t.child,t!==null))for(IB(t,e,r),t=t.sibling;t!==null;)IB(t,e,r),t=t.sibling}function jB(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(jB(t,e,r),t=t.sibling;t!==null;)jB(t,e,r),t=t.sibling}var bl=null,sf=!1;function o0(t,e,r){for(r=r.child;r!==null;)uY(t,e,r),r=r.sibling}function uY(t,e,r){if(nh&&typeof nh.onCommitFiberUnmount=="function")try{nh.onCommitFiberUnmount(tj,r)}catch{}switch(r.tag){case 5:rc||qx(r,e);case 6:var n=bl,a=sf;bl=null,o0(t,e,r),bl=n,sf=a,bl!==null&&(sf?(t=bl,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):bl.removeChild(r.stateNode));break;case 18:bl!==null&&(sf?(t=bl,r=r.stateNode,t.nodeType===8?l3(t.parentNode,r):t.nodeType===1&&l3(t,r),Wb(t)):l3(bl,r.stateNode));break;case 4:n=bl,a=sf,bl=r.stateNode.containerInfo,sf=!0,o0(t,e,r),bl=n,sf=a;break;case 0:case 11:case 14:case 15:if(!rc&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&EB(r,e,o),a=a.next}while(a!==n)}o0(t,e,r);break;case 1:if(!rc&&(qx(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Ei(r,e,l)}o0(t,e,r);break;case 21:o0(t,e,r);break;case 22:r.mode&1?(rc=(n=rc)||r.memoizedState!==null,o0(t,e,r),rc=n):o0(t,e,r);break;default:o0(t,e,r)}}function jU(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new oAe),e.forEach(function(n){var a=gAe.bind(null,t,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Wd(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:bl=l.stateNode,sf=!1;break e;case 3:bl=l.stateNode.containerInfo,sf=!0;break e;case 4:bl=l.stateNode.containerInfo,sf=!0;break e}l=l.return}if(bl===null)throw Error(Dr(160));uY(s,o,a),bl=null,sf=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){Ei(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dY(e,t),e=e.sibling}function dY(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Wd(e,t),Df(t),n&4){try{db(3,t,t.return),cj(3,t)}catch(p){Ei(t,t.return,p)}try{db(5,t,t.return)}catch(p){Ei(t,t.return,p)}}break;case 1:Wd(e,t),Df(t),n&512&&r!==null&&qx(r,r.return);break;case 5:if(Wd(e,t),Df(t),n&512&&r!==null&&qx(r,r.return),t.flags&32){var a=t.stateNode;try{Gb(a,"")}catch(p){Ei(t,t.return,p)}}if(n&4&&(a=t.stateNode,a!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&kW(a,s),ZT(l,o);var u=ZT(l,s);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?MW(a,f):d==="dangerouslySetInnerHTML"?DW(a,f):d==="children"?Gb(a,f):kO(a,d,f,u)}switch(l){case"input":zT(a,s);break;case"textarea":FW(a,s);break;case"select":var A=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?sv(a,!!s.multiple,h,!1):A!==!!s.multiple&&(s.defaultValue!=null?sv(a,!!s.multiple,s.defaultValue,!0):sv(a,!!s.multiple,s.multiple?[]:"",!1))}a[e2]=s}catch(p){Ei(t,t.return,p)}}break;case 6:if(Wd(e,t),Df(t),n&4){if(t.stateNode===null)throw Error(Dr(162));a=t.stateNode,s=t.memoizedProps;try{a.nodeValue=s}catch(p){Ei(t,t.return,p)}}break;case 3:if(Wd(e,t),Df(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Wb(e.containerInfo)}catch(p){Ei(t,t.return,p)}break;case 4:Wd(e,t),Df(t);break;case 13:Wd(e,t),Df(t),a=t.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(fD=Hi())),n&4&&jU(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(rc=(u=rc)||d,Wd(e,t),rc=u):Wd(e,t),Df(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(on=t,d=t.child;d!==null;){for(f=on=d;on!==null;){switch(A=on,h=A.child,A.tag){case 0:case 11:case 14:case 15:db(4,A,A.return);break;case 1:qx(A,A.return);var m=A.stateNode;if(typeof m.componentWillUnmount=="function"){n=A,r=A.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){Ei(n,r,p)}}break;case 5:qx(A,A.return);break;case 22:if(A.memoizedState!==null){TU(f);continue}}h!==null?(h.return=A,on=h):TU(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=RW("display",o))}catch(p){Ei(t,t.return,p)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(p){Ei(t,t.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Wd(e,t),Df(t),n&4&&jU(t);break;case 21:break;default:Wd(e,t),Df(t)}}function Df(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(cY(r)){var n=r;break e}r=r.return}throw Error(Dr(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Gb(a,""),n.flags&=-33);var s=IU(t);jB(t,s,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=IU(t);IB(t,l,o);break;default:throw Error(Dr(161))}}catch(c){Ei(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function cAe(t,e,r){on=t,fY(t)}function fY(t,e,r){for(var n=(t.mode&1)!==0;on!==null;){var a=on,s=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||YN;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||rc;l=YN;var u=rc;if(YN=o,(rc=c)&&!u)for(on=a;on!==null;)o=on,c=o.child,o.tag===22&&o.memoizedState!==null?BU(a):c!==null?(c.return=o,on=c):BU(a);for(;s!==null;)on=s,fY(s),s=s.sibling;on=a,YN=l,rc=u}PU(t)}else a.subtreeFlags&8772&&s!==null?(s.return=a,on=s):PU(t)}}function PU(t){for(;on!==null;){var e=on;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:rc||cj(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!rc)if(r===null)n.componentDidMount();else{var a=e.elementType===e.type?r.memoizedProps:af(e.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&AU(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}AU(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Wb(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Dr(163))}rc||e.flags&512&&SB(e)}catch(A){Ei(e,e.return,A)}}if(e===t){on=null;break}if(r=e.sibling,r!==null){r.return=e.return,on=r;break}on=e.return}}function TU(t){for(;on!==null;){var e=on;if(e===t){on=null;break}var r=e.sibling;if(r!==null){r.return=e.return,on=r;break}on=e.return}}function BU(t){for(;on!==null;){var e=on;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{cj(4,e)}catch(c){Ei(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var a=e.return;try{n.componentDidMount()}catch(c){Ei(e,a,c)}}var s=e.return;try{SB(e)}catch(c){Ei(e,s,c)}break;case 5:var o=e.return;try{SB(e)}catch(c){Ei(e,o,c)}}}catch(c){Ei(e,e.return,c)}if(e===t){on=null;break}var l=e.sibling;if(l!==null){l.return=e.return,on=l;break}on=e.return}}var uAe=Math.ceil,zE=TA.ReactCurrentDispatcher,uD=TA.ReactCurrentOwner,Id=TA.ReactCurrentBatchConfig,Ca=0,rl=null,oo=null,Bl=0,Su=0,zx=Rm(0),ko=0,i2=null,rg=0,uj=0,dD=0,fb=null,eu=null,fD=0,jv=1/0,Lh=null,WE=!1,PB=null,sm=null,JN=!1,G0=null,XE=0,hb=0,TB=null,z_=-1,W_=0;function Pc(){return Ca&6?Hi():z_!==-1?z_:z_=Hi()}function im(t){return t.mode&1?Ca&2&&Bl!==0?Bl&-Bl:qhe.transition!==null?(W_===0&&(W_=XW()),W_):(t=ns,t!==0||(t=window.event,t=t===void 0?16:nX(t.type)),t):1}function pf(t,e,r,n){if(50<hb)throw hb=0,TB=null,Error(Dr(185));hw(t,r,n),(!(Ca&2)||t!==rl)&&(t===rl&&(!(Ca&2)&&(uj|=r),ko===4&&F0(t,Bl)),ou(t,n),r===1&&Ca===0&&!(e.mode&1)&&(jv=Hi()+500,ij&&Mm()))}function ou(t,e){var r=t.callbackNode;qfe(t,e);var n=kE(t,t===rl?Bl:0);if(n===0)r!==null&&QL(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&QL(r),e===1)t.tag===0?Khe(kU.bind(null,t)):wX(kU.bind(null,t)),Vhe(function(){!(Ca&6)&&Mm()}),r=null;else{switch(YW(n)){case 1:r=MO;break;case 4:r=zW;break;case 16:r=BE;break;case 536870912:r=WW;break;default:r=BE}r=yY(r,hY.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function hY(t,e){if(z_=-1,W_=0,Ca&6)throw Error(Dr(327));var r=t.callbackNode;if(uv()&&t.callbackNode!==r)return null;var n=kE(t,t===rl?Bl:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=YE(t,n);else{e=n;var a=Ca;Ca|=2;var s=mY();(rl!==t||Bl!==e)&&(Lh=null,jv=Hi()+500,Op(t,e));do try{hAe();break}catch(l){AY(t,l)}while(!0);YO(),zE.current=s,Ca=a,oo!==null?e=0:(rl=null,Bl=0,e=ko)}if(e!==0){if(e===2&&(a=aB(t),a!==0&&(n=a,e=BB(t,a))),e===1)throw r=i2,Op(t,0),F0(t,n),ou(t,Hi()),r;if(e===6)F0(t,n);else{if(a=t.current.alternate,!(n&30)&&!dAe(a)&&(e=YE(t,n),e===2&&(s=aB(t),s!==0&&(n=s,e=BB(t,s))),e===1))throw r=i2,Op(t,0),F0(t,n),ou(t,Hi()),r;switch(t.finishedWork=a,t.finishedLanes=n,e){case 0:case 1:throw Error(Dr(345));case 2:cp(t,eu,Lh);break;case 3:if(F0(t,n),(n&130023424)===n&&(e=fD+500-Hi(),10<e)){if(kE(t,0)!==0)break;if(a=t.suspendedLanes,(a&n)!==n){Pc(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=fB(cp.bind(null,t,eu,Lh),e);break}cp(t,eu,Lh);break;case 4:if(F0(t,n),(n&4194240)===n)break;for(e=t.eventTimes,a=-1;0<n;){var o=31-mf(n);s=1<<o,o=e[o],o>a&&(a=o),n&=~s}if(n=a,n=Hi()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*uAe(n/1960))-n,10<n){t.timeoutHandle=fB(cp.bind(null,t,eu,Lh),n);break}cp(t,eu,Lh);break;case 5:cp(t,eu,Lh);break;default:throw Error(Dr(329))}}}return ou(t,Hi()),t.callbackNode===r?hY.bind(null,t):null}function BB(t,e){var r=fb;return t.current.memoizedState.isDehydrated&&(Op(t,e).flags|=256),t=YE(t,e),t!==2&&(e=eu,eu=r,e!==null&&kB(e)),t}function kB(t){eu===null?eu=t:eu.push.apply(eu,t)}function dAe(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!bf(s(),a))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function F0(t,e){for(e&=~dD,e&=~uj,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-mf(e),n=1<<r;t[r]=-1,e&=~n}}function kU(t){if(Ca&6)throw Error(Dr(327));uv();var e=kE(t,0);if(!(e&1))return ou(t,Hi()),null;var r=YE(t,e);if(t.tag!==0&&r===2){var n=aB(t);n!==0&&(e=n,r=BB(t,n))}if(r===1)throw r=i2,Op(t,0),F0(t,e),ou(t,Hi()),r;if(r===6)throw Error(Dr(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,cp(t,eu,Lh),ou(t,Hi()),null}function hD(t,e){var r=Ca;Ca|=1;try{return t(e)}finally{Ca=r,Ca===0&&(jv=Hi()+500,ij&&Mm())}}function ng(t){G0!==null&&G0.tag===0&&!(Ca&6)&&uv();var e=Ca;Ca|=1;var r=Id.transition,n=ns;try{if(Id.transition=null,ns=1,t)return t()}finally{ns=n,Id.transition=r,Ca=e,!(Ca&6)&&Mm()}}function AD(){Su=zx.current,Fs(zx)}function Op(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Qhe(r)),oo!==null)for(r=oo.return;r!==null;){var n=r;switch(zO(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ME();break;case 3:Sv(),Fs(su),Fs(lc),nD();break;case 5:rD(n);break;case 4:Sv();break;case 13:Fs(li);break;case 19:Fs(li);break;case 10:JO(n.type._context);break;case 22:case 23:AD()}r=r.return}if(rl=t,oo=t=om(t.current,null),Bl=Su=e,ko=0,i2=null,dD=uj=rg=0,eu=fb=null,_p!==null){for(e=0;e<_p.length;e++)if(r=_p[e],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=a,n.next=o}r.pending=n}_p=null}return t}function AY(t,e){do{var r=oo;try{if(YO(),G_.current=qE,KE){for(var n=fi.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}KE=!1}if(tg=0,Jo=Co=fi=null,ub=!1,n2=0,uD.current=null,r===null||r.return===null){ko=1,i2=e,oo=null;break}e:{var s=t,o=r.return,l=r,c=e;if(e=Bl,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var A=d.alternate;A?(d.updateQueue=A.updateQueue,d.memoizedState=A.memoizedState,d.lanes=A.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=yU(o);if(h!==null){h.flags&=-257,bU(h,o,l,s,e),h.mode&1&&vU(s,u,e),e=h,c=u;var m=e.updateQueue;if(m===null){var p=new Set;p.add(c),e.updateQueue=p}else m.add(c);break e}else{if(!(e&1)){vU(s,u,e),mD();break e}c=Error(Dr(426))}}else if(Hs&&l.mode&1){var x=yU(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),bU(x,o,l,s,e),WO(Iv(c,l));break e}}s=c=Iv(c,l),ko!==4&&(ko=2),fb===null?fb=[s]:fb.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=YX(s,c,e);hU(s,v);break e;case 1:l=c;var y=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(sm===null||!sm.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=JX(s,l,e);hU(s,w);break e}}s=s.return}while(s!==null)}gY(r)}catch(j){e=j,oo===r&&r!==null&&(oo=r=r.return);continue}break}while(!0)}function mY(){var t=zE.current;return zE.current=qE,t===null?qE:t}function mD(){(ko===0||ko===3||ko===2)&&(ko=4),rl===null||!(rg&268435455)&&!(uj&268435455)||F0(rl,Bl)}function YE(t,e){var r=Ca;Ca|=2;var n=mY();(rl!==t||Bl!==e)&&(Lh=null,Op(t,e));do try{fAe();break}catch(a){AY(t,a)}while(!0);if(YO(),Ca=r,zE.current=n,oo!==null)throw Error(Dr(261));return rl=null,Bl=0,ko}function fAe(){for(;oo!==null;)pY(oo)}function hAe(){for(;oo!==null&&!Mfe();)pY(oo)}function pY(t){var e=vY(t.alternate,t,Su);t.memoizedProps=t.pendingProps,e===null?gY(t):oo=e,uD.current=null}function gY(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=iAe(r,e),r!==null){r.flags&=32767,oo=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ko=6,oo=null;return}}else if(r=sAe(r,e,Su),r!==null){oo=r;return}if(e=e.sibling,e!==null){oo=e;return}oo=e=t}while(e!==null);ko===0&&(ko=5)}function cp(t,e,r){var n=ns,a=Id.transition;try{Id.transition=null,ns=1,AAe(t,e,r,n)}finally{Id.transition=a,ns=n}return null}function AAe(t,e,r,n){do uv();while(G0!==null);if(Ca&6)throw Error(Dr(327));r=t.finishedWork;var a=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Dr(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(zfe(t,s),t===rl&&(oo=rl=null,Bl=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||JN||(JN=!0,yY(BE,function(){return uv(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Id.transition,Id.transition=null;var o=ns;ns=1;var l=Ca;Ca|=4,uD.current=null,lAe(t,r),dY(r,t),Fhe(uB),FE=!!cB,uB=cB=null,t.current=r,cAe(r),Lfe(),Ca=l,ns=o,Id.transition=s}else t.current=r;if(JN&&(JN=!1,G0=t,XE=a),s=t.pendingLanes,s===0&&(sm=null),Vfe(r.stateNode),ou(t,Hi()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)a=e[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(WE)throw WE=!1,t=PB,PB=null,t;return XE&1&&t.tag!==0&&uv(),s=t.pendingLanes,s&1?t===TB?hb++:(hb=0,TB=t):hb=0,Mm(),null}function uv(){if(G0!==null){var t=YW(XE),e=Id.transition,r=ns;try{if(Id.transition=null,ns=16>t?16:t,G0===null)var n=!1;else{if(t=G0,G0=null,XE=0,Ca&6)throw Error(Dr(331));var a=Ca;for(Ca|=4,on=t.current;on!==null;){var s=on,o=s.child;if(on.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(on=u;on!==null;){var d=on;switch(d.tag){case 0:case 11:case 15:db(8,d,s)}var f=d.child;if(f!==null)f.return=d,on=f;else for(;on!==null;){d=on;var A=d.sibling,h=d.return;if(lY(d),d===u){on=null;break}if(A!==null){A.return=h,on=A;break}on=h}}}var m=s.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var x=p.sibling;p.sibling=null,p=x}while(p!==null)}}on=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,on=o;else e:for(;on!==null;){if(s=on,s.flags&2048)switch(s.tag){case 0:case 11:case 15:db(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,on=v;break e}on=s.return}}var y=t.current;for(on=y;on!==null;){o=on;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,on=b;else e:for(o=y;on!==null;){if(l=on,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:cj(9,l)}}catch(j){Ei(l,l.return,j)}if(l===o){on=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,on=w;break e}on=l.return}}if(Ca=a,Mm(),nh&&typeof nh.onPostCommitFiberRoot=="function")try{nh.onPostCommitFiberRoot(tj,t)}catch{}n=!0}return n}finally{ns=r,Id.transition=e}}return!1}function FU(t,e,r){e=Iv(r,e),e=YX(t,e,1),t=am(t,e,1),e=Pc(),t!==null&&(hw(t,1,e),ou(t,e))}function Ei(t,e,r){if(t.tag===3)FU(t,t,r);else for(;e!==null;){if(e.tag===3){FU(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(sm===null||!sm.has(n))){t=Iv(r,t),t=JX(e,t,1),e=am(e,t,1),t=Pc(),e!==null&&(hw(e,1,t),ou(e,t));break}}e=e.return}}function mAe(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Pc(),t.pingedLanes|=t.suspendedLanes&r,rl===t&&(Bl&r)===r&&(ko===4||ko===3&&(Bl&130023424)===Bl&&500>Hi()-fD?Op(t,0):dD|=r),ou(t,e)}function xY(t,e){e===0&&(t.mode&1?(e=VN,VN<<=1,!(VN&130023424)&&(VN=4194304)):e=1);var r=Pc();t=AA(t,e),t!==null&&(hw(t,e,r),ou(t,r))}function pAe(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),xY(t,r)}function gAe(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,a=t.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Dr(314))}n!==null&&n.delete(e),xY(t,r)}var vY;vY=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||su.current)ru=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return ru=!1,aAe(t,e,r);ru=!!(t.flags&131072)}else ru=!1,Hs&&e.flags&1048576&&NX(e,QE,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;q_(t,e),t=e.pendingProps;var a=Cv(e,lc.current);cv(e,r),a=sD(null,e,n,t,a,r);var s=iD();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,iu(n)?(s=!0,LE(e)):s=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,eD(e),a.updater=lj,e.stateNode=a,a._reactInternals=e,vB(e,n,t,r),e=wB(null,e,n,!0,s,r)):(e.tag=0,Hs&&s&&qO(e),wc(null,e,a,r),e=e.child),e;case 16:n=e.elementType;e:{switch(q_(t,e),t=e.pendingProps,a=n._init,n=a(n._payload),e.type=n,a=e.tag=vAe(n),t=af(n,t),a){case 0:e=bB(null,e,n,t,r);break e;case 1:e=CU(null,e,n,t,r);break e;case 11:e=wU(null,e,n,t,r);break e;case 14:e=NU(null,e,n,af(n.type,t),r);break e}throw Error(Dr(306,n,""))}return e;case 0:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:af(n,a),bB(t,e,n,a,r);case 1:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:af(n,a),CU(t,e,n,a,r);case 3:e:{if(rY(e),t===null)throw Error(Dr(387));n=e.pendingProps,s=e.memoizedState,a=s.element,jX(t,e),$E(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){a=Iv(Error(Dr(423)),e),e=_U(t,e,n,r,a);break e}else if(n!==a){a=Iv(Error(Dr(424)),e),e=_U(t,e,n,r,a);break e}else for(Fu=nm(e.stateNode.containerInfo.firstChild),Mu=e,Hs=!0,of=null,r=SX(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(_v(),n===a){e=mA(t,e,r);break e}wc(t,e,n,r)}e=e.child}return e;case 5:return PX(e),t===null&&pB(e),n=e.type,a=e.pendingProps,s=t!==null?t.memoizedProps:null,o=a.children,dB(n,a)?o=null:s!==null&&dB(n,s)&&(e.flags|=32),tY(t,e),wc(t,e,o,r),e.child;case 6:return t===null&&pB(e),null;case 13:return nY(t,e,r);case 4:return tD(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Ev(e,null,n,r):wc(t,e,n,r),e.child;case 11:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:af(n,a),wU(t,e,n,a,r);case 7:return wc(t,e,e.pendingProps,r),e.child;case 8:return wc(t,e,e.pendingProps.children,r),e.child;case 12:return wc(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,a=e.pendingProps,s=e.memoizedProps,o=a.value,bs(VE,n._currentValue),n._currentValue=o,s!==null)if(bf(s.value,o)){if(s.children===a.children&&!su.current){e=mA(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=tA(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),gB(s.return,r,e),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Dr(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),gB(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}wc(t,e,a.children,r),e=e.child}return e;case 9:return a=e.type,n=e.pendingProps.children,cv(e,r),a=kd(a),n=n(a),e.flags|=1,wc(t,e,n,r),e.child;case 14:return n=e.type,a=af(n,e.pendingProps),a=af(n.type,a),NU(t,e,n,a,r);case 15:return ZX(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:af(n,a),q_(t,e),e.tag=1,iu(n)?(t=!0,LE(e)):t=!1,cv(e,r),XX(e,n,a),vB(e,n,a,r),wB(null,e,n,!0,t,r);case 19:return aY(t,e,r);case 22:return eY(t,e,r)}throw Error(Dr(156,e.tag))};function yY(t,e){return qW(t,e)}function xAe(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wd(t,e,r,n){return new xAe(t,e,r,n)}function pD(t){return t=t.prototype,!(!t||!t.isReactComponent)}function vAe(t){if(typeof t=="function")return pD(t)?1:0;if(t!=null){if(t=t.$$typeof,t===OO)return 11;if(t===DO)return 14}return 2}function om(t,e){var r=t.alternate;return r===null?(r=wd(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function X_(t,e,r,n,a,s){var o=2;if(n=t,typeof t=="function")pD(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Mx:return Dp(r.children,a,s,e);case FO:o=8,a|=8;break;case HT:return t=wd(12,r,e,a|2),t.elementType=HT,t.lanes=s,t;case $T:return t=wd(13,r,e,a),t.elementType=$T,t.lanes=s,t;case GT:return t=wd(19,r,e,a),t.elementType=GT,t.lanes=s,t;case PW:return dj(r,a,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case IW:o=10;break e;case jW:o=9;break e;case OO:o=11;break e;case DO:o=14;break e;case S0:o=16,n=null;break e}throw Error(Dr(130,t==null?t:typeof t,""))}return e=wd(o,r,e,a),e.elementType=t,e.type=n,e.lanes=s,e}function Dp(t,e,r,n){return t=wd(7,t,n,e),t.lanes=r,t}function dj(t,e,r,n){return t=wd(22,t,n,e),t.elementType=PW,t.lanes=r,t.stateNode={isHidden:!1},t}function p3(t,e,r){return t=wd(6,t,null,e),t.lanes=r,t}function g3(t,e,r){return e=wd(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function yAe(t,e,r,n,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Y4(0),this.expirationTimes=Y4(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Y4(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function gD(t,e,r,n,a,s,o,l,c){return t=new yAe(t,e,r,l,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=wd(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},eD(s),t}function bAe(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Rx,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function bY(t){if(!t)return vm;t=t._reactInternals;e:{if(Bg(t)!==t||t.tag!==1)throw Error(Dr(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(iu(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Dr(171))}if(t.tag===1){var r=t.type;if(iu(r))return bX(t,r,e)}return e}function wY(t,e,r,n,a,s,o,l,c){return t=gD(r,n,!0,t,a,s,o,l,c),t.context=bY(null),r=t.current,n=Pc(),a=im(r),s=tA(n,a),s.callback=e??null,am(r,s,a),t.current.lanes=a,hw(t,a,n),ou(t,n),t}function fj(t,e,r,n){var a=e.current,s=Pc(),o=im(a);return r=bY(r),e.context===null?e.context=r:e.pendingContext=r,e=tA(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=am(a,e,o),t!==null&&(pf(t,a,o,s),$_(t,a,o)),o}function JE(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function OU(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function xD(t,e){OU(t,e),(t=t.alternate)&&OU(t,e)}function wAe(){return null}var NY=typeof reportError=="function"?reportError:function(t){console.error(t)};function vD(t){this._internalRoot=t}hj.prototype.render=vD.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Dr(409));fj(t,e,null,null)};hj.prototype.unmount=vD.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ng(function(){fj(null,t,null,null)}),e[hA]=null}};function hj(t){this._internalRoot=t}hj.prototype.unstable_scheduleHydration=function(t){if(t){var e=eX();t={blockedOn:null,target:t,priority:e};for(var r=0;r<k0.length&&e!==0&&e<k0[r].priority;r++);k0.splice(r,0,t),r===0&&rX(t)}};function yD(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Aj(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function DU(){}function NAe(t,e,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=JE(o);s.call(u)}}var o=wY(e,n,t,0,null,!1,!1,"",DU);return t._reactRootContainer=o,t[hA]=o.current,Jb(t.nodeType===8?t.parentNode:t),ng(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var u=JE(c);l.call(u)}}var c=gD(t,0,!1,null,null,!1,!1,"",DU);return t._reactRootContainer=c,t[hA]=c.current,Jb(t.nodeType===8?t.parentNode:t),ng(function(){fj(e,c,r,n)}),c}function mj(t,e,r,n,a){var s=r._reactRootContainer;if(s){var o=s;if(typeof a=="function"){var l=a;a=function(){var c=JE(o);l.call(c)}}fj(e,o,t,a)}else o=NAe(r,e,t,a,n);return JE(o)}JW=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Oy(e.pendingLanes);r!==0&&(LO(e,r|1),ou(e,Hi()),!(Ca&6)&&(jv=Hi()+500,Mm()))}break;case 13:ng(function(){var n=AA(t,1);if(n!==null){var a=Pc();pf(n,t,1,a)}}),xD(t,1)}};UO=function(t){if(t.tag===13){var e=AA(t,134217728);if(e!==null){var r=Pc();pf(e,t,134217728,r)}xD(t,134217728)}};ZW=function(t){if(t.tag===13){var e=im(t),r=AA(t,e);if(r!==null){var n=Pc();pf(r,t,e,n)}xD(t,e)}};eX=function(){return ns};tX=function(t,e){var r=ns;try{return ns=t,e()}finally{ns=r}};tB=function(t,e,r){switch(e){case"input":if(zT(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var a=sj(n);if(!a)throw Error(Dr(90));BW(n),zT(n,a)}}}break;case"textarea":FW(t,r);break;case"select":e=r.value,e!=null&&sv(t,!!r.multiple,e,!1)}};QW=hD;VW=ng;var CAe={usingClientEntryPoint:!1,Events:[mw,Vx,sj,LW,UW,hD]},ry={findFiberByHostInstance:Cp,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_Ae={bundleType:ry.bundleType,version:ry.version,rendererPackageName:ry.rendererPackageName,rendererConfig:ry.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:TA.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=GW(t),t===null?null:t.stateNode},findFiberByHostInstance:ry.findFiberByHostInstance||wAe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ZN=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ZN.isDisabled&&ZN.supportsFiber)try{tj=ZN.inject(_Ae),nh=ZN}catch{}}Ku.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CAe;Ku.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!yD(e))throw Error(Dr(200));return bAe(t,e,null,r)};Ku.createRoot=function(t,e){if(!yD(t))throw Error(Dr(299));var r=!1,n="",a=NY;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=gD(t,1,!1,null,null,r,!1,n,a),t[hA]=e.current,Jb(t.nodeType===8?t.parentNode:t),new vD(e)};Ku.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Dr(188)):(t=Object.keys(t).join(","),Error(Dr(268,t)));return t=GW(e),t=t===null?null:t.stateNode,t};Ku.flushSync=function(t){return ng(t)};Ku.hydrate=function(t,e,r){if(!Aj(e))throw Error(Dr(200));return mj(null,t,e,!0,r)};Ku.hydrateRoot=function(t,e,r){if(!yD(t))throw Error(Dr(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",o=NY;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=wY(e,null,t,1,r??null,a,!1,s,o),t[hA]=e.current,Jb(t),n)for(t=0;t<n.length;t++)r=n[t],a=r._getVersion,a=a(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,a]:e.mutableSourceEagerHydrationData.push(r,a);return new hj(e)};Ku.render=function(t,e,r){if(!Aj(e))throw Error(Dr(200));return mj(null,t,e,!1,r)};Ku.unmountComponentAtNode=function(t){if(!Aj(t))throw Error(Dr(40));return t._reactRootContainer?(ng(function(){mj(null,null,t,!1,function(){t._reactRootContainer=null,t[hA]=null})}),!0):!1};Ku.unstable_batchedUpdates=hD;Ku.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Aj(r))throw Error(Dr(200));if(t==null||t._reactInternals===void 0)throw Error(Dr(38));return mj(t,e,r,!1,n)};Ku.version="18.3.1-next-f1338f8080-20240426";function CY(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(CY)}catch(t){console.error(t)}}CY(),CW.exports=Ku;var Lu=CW.exports,RU=Lu;QT.createRoot=RU.createRoot,QT.hydrateRoot=RU.hydrateRoot;/**
 * react-router v7.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var MU="popstate";function EAe(t={}){function e(n,a){let{pathname:s,search:o,hash:l}=n.location;return FB("",{pathname:s,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:o2(a)}return IAe(e,r,null,t)}function Ws(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function wf(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function SAe(){return Math.random().toString(36).substring(2,10)}function LU(t,e){return{usr:t.state,key:t.key,idx:e}}function FB(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?a1(e):e,state:r,key:e&&e.key||n||SAe()}}function o2({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function a1(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function IAe(t,e,r,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,o=a.history,l="POP",c=null,u=d();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function d(){return(o.state||{idx:null}).idx}function f(){l="POP";let x=d(),v=x==null?null:x-u;u=x,c&&c({action:l,location:p.location,delta:v})}function A(x,v){l="PUSH";let y=FB(p.location,x,v);u=d()+1;let b=LU(y,u),w=p.createHref(y);try{o.pushState(b,"",w)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;a.location.assign(w)}s&&c&&c({action:l,location:p.location,delta:1})}function h(x,v){l="REPLACE";let y=FB(p.location,x,v);u=d();let b=LU(y,u),w=p.createHref(y);o.replaceState(b,"",w),s&&c&&c({action:l,location:p.location,delta:0})}function m(x){return jAe(x)}let p={get action(){return l},get location(){return t(a,o)},listen(x){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(MU,f),c=x,()=>{a.removeEventListener(MU,f),c=null}},createHref(x){return e(a,x)},createURL:m,encodeLocation(x){let v=m(x);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:A,replace:h,go(x){return o.go(x)}};return p}function jAe(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Ws(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:o2(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function _Y(t,e,r="/"){return PAe(t,e,r,!1)}function PAe(t,e,r,n){let a=typeof e=="string"?a1(e):e,s=pA(a.pathname||"/",r);if(s==null)return null;let o=EY(t);TAe(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=VAe(s);l=UAe(o[c],u,n)}return l}function EY(t,e=[],r=[],n="",a=!1){let s=(o,l,c=a,u)=>{let d={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(n)&&c)return;Ws(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length)}let f=rA([n,d.relativePath]),A=r.concat(d);o.children&&o.children.length>0&&(Ws(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),EY(o.children,e,A,f,c)),!(o.path==null&&!o.index)&&e.push({path:f,score:MAe(f,o.index),routesMeta:A})};return t.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))s(o,l);else for(let u of SY(o.path))s(o,l,!0,u)}),e}function SY(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let o=SY(n.join("/")),l=[];return l.push(...o.map(c=>c===""?s:[s,c].join("/"))),a&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function TAe(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:LAe(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var BAe=/^:[\w-]+$/,kAe=3,FAe=2,OAe=1,DAe=10,RAe=-2,UU=t=>t==="*";function MAe(t,e){let r=t.split("/"),n=r.length;return r.some(UU)&&(n+=RAe),e&&(n+=FAe),r.filter(a=>!UU(a)).reduce((a,s)=>a+(BAe.test(s)?kAe:s===""?OAe:DAe),n)}function LAe(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function UAe(t,e,r=!1){let{routesMeta:n}=t,a={},s="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=s==="/"?e:e.slice(s.length)||"/",f=ZE({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),A=c.route;if(!f&&u&&r&&!n[n.length-1].route.index&&(f=ZE({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!f)return null;Object.assign(a,f.params),o.push({params:a,pathname:rA([s,f.pathname]),pathnameBase:KAe(rA([s,f.pathnameBase])),route:A}),f.pathnameBase!=="/"&&(s=rA([s,f.pathnameBase]))}return o}function ZE(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=QAe(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let s=a[0],o=s.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((u,{paramName:d,isOptional:f},A)=>{if(d==="*"){let m=l[A]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const h=l[A];return f&&!h?u[d]=void 0:u[d]=(h||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function QAe(t,e=!1,r=!0){wf(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function VAe(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return wf(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function pA(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function HAe(t,e="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?a1(t):t;return{pathname:r?r.startsWith("/")?r:$Ae(r,e):e,search:qAe(n),hash:zAe(a)}}function $Ae(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function x3(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function GAe(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function bD(t){let e=GAe(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function wD(t,e,r,n=!1){let a;typeof t=="string"?a=a1(t):(a={...t},Ws(!a.pathname||!a.pathname.includes("?"),x3("?","pathname","search",a)),Ws(!a.pathname||!a.pathname.includes("#"),x3("#","pathname","hash",a)),Ws(!a.search||!a.search.includes("#"),x3("#","search","hash",a)));let s=t===""||a.pathname==="",o=s?"/":a.pathname,l;if(o==null)l=r;else{let f=e.length-1;if(!n&&o.startsWith("..")){let A=o.split("/");for(;A[0]==="..";)A.shift(),f-=1;a.pathname=A.join("/")}l=f>=0?e[f]:"/"}let c=HAe(a,l),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var rA=t=>t.join("/").replace(/\/\/+/g,"/"),KAe=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),qAe=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,zAe=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function WAe(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var IY=["POST","PUT","PATCH","DELETE"];new Set(IY);var XAe=["GET",...IY];new Set(XAe);var s1=g.createContext(null);s1.displayName="DataRouter";var pj=g.createContext(null);pj.displayName="DataRouterState";g.createContext(!1);var jY=g.createContext({isTransitioning:!1});jY.displayName="ViewTransition";var YAe=g.createContext(new Map);YAe.displayName="Fetchers";var JAe=g.createContext(null);JAe.displayName="Await";var Ef=g.createContext(null);Ef.displayName="Navigation";var gw=g.createContext(null);gw.displayName="Location";var Sf=g.createContext({outlet:null,matches:[],isDataRoute:!1});Sf.displayName="Route";var ND=g.createContext(null);ND.displayName="RouteError";function ZAe(t,{relative:e}={}){Ws(i1(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=g.useContext(Ef),{hash:a,pathname:s,search:o}=vw(t,{relative:e}),l=s;return r!=="/"&&(l=s==="/"?r:rA([r,s])),n.createHref({pathname:l,search:o,hash:a})}function i1(){return g.useContext(gw)!=null}function BA(){return Ws(i1(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(gw).location}var PY="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function TY(t){g.useContext(Ef).static||g.useLayoutEffect(t)}function xw(){let{isDataRoute:t}=g.useContext(Sf);return t?A0e():e0e()}function e0e(){Ws(i1(),"useNavigate() may be used only in the context of a <Router> component.");let t=g.useContext(s1),{basename:e,navigator:r}=g.useContext(Ef),{matches:n}=g.useContext(Sf),{pathname:a}=BA(),s=JSON.stringify(bD(n)),o=g.useRef(!1);return TY(()=>{o.current=!0}),g.useCallback((c,u={})=>{if(wf(o.current,PY),!o.current)return;if(typeof c=="number"){r.go(c);return}let d=wD(c,JSON.parse(s),a,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:rA([e,d.pathname])),(u.replace?r.replace:r.push)(d,u.state,u)},[e,r,s,a,t])}var t0e=g.createContext(null);function r0e(t){let e=g.useContext(Sf).outlet;return e&&g.createElement(t0e.Provider,{value:t},e)}function vw(t,{relative:e}={}){let{matches:r}=g.useContext(Sf),{pathname:n}=BA(),a=JSON.stringify(bD(r));return g.useMemo(()=>wD(t,JSON.parse(a),n,e==="path"),[t,a,n,e])}function n0e(t,e){return BY(t,e)}function BY(t,e,r,n){var v;Ws(i1(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=g.useContext(Ef),{matches:s}=g.useContext(Sf),o=s[s.length-1],l=o?o.params:{},c=o?o.pathname:"/",u=o?o.pathnameBase:"/",d=o&&o.route;{let y=d&&d.path||"";kY(c,!d||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let f=BA(),A;if(e){let y=typeof e=="string"?a1(e):e;Ws(u==="/"||((v=y.pathname)==null?void 0:v.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${y.pathname}" was given in the \`location\` prop.`),A=y}else A=f;let h=A.pathname||"/",m=h;if(u!=="/"){let y=u.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=_Y(t,{pathname:m});wf(d||p!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),wf(p==null||p[p.length-1].route.element!==void 0||p[p.length-1].route.Component!==void 0||p[p.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=l0e(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:rA([u,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?u:rA([u,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return e&&x?g.createElement(gw.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...A},navigationType:"POP"}},x):x}function a0e(){let t=h0e(),e=WAe(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=g.createElement(g.Fragment,null,g.createElement("p",null," Hey developer "),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:s},"ErrorBoundary")," or"," ",g.createElement("code",{style:s},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},e),r?g.createElement("pre",{style:a},r):null,o)}var s0e=g.createElement(a0e,null),i0e=class extends g.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?g.createElement(Sf.Provider,{value:this.props.routeContext},g.createElement(ND.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function o0e({routeContext:t,match:e,children:r}){let n=g.useContext(s1);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),g.createElement(Sf.Provider,{value:t},r)}function l0e(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,s=r==null?void 0:r.errors;if(s!=null){let c=a.findIndex(u=>u.route.id&&(s==null?void 0:s[u.route.id])!==void 0);Ws(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let o=!1,l=-1;if(r)for(let c=0;c<a.length;c++){let u=a[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(l=c),u.route.id){let{loaderData:d,errors:f}=r,A=u.route.loader&&!d.hasOwnProperty(u.route.id)&&(!f||f[u.route.id]===void 0);if(u.route.lazy||A){o=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,u,d)=>{let f,A=!1,h=null,m=null;r&&(f=s&&u.route.id?s[u.route.id]:void 0,h=u.route.errorElement||s0e,o&&(l<0&&d===0?(kY("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,m=null):l===d&&(A=!0,m=u.route.hydrateFallbackElement||null)));let p=e.concat(a.slice(0,d+1)),x=()=>{let v;return f?v=h:A?v=m:u.route.Component?v=g.createElement(u.route.Component,null):u.route.element?v=u.route.element:v=c,g.createElement(o0e,{match:u,routeContext:{outlet:c,matches:p,isDataRoute:r!=null},children:v})};return r&&(u.route.ErrorBoundary||u.route.errorElement||d===0)?g.createElement(i0e,{location:r.location,revalidation:r.revalidation,component:h,error:f,children:x(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):x()},null)}function CD(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function c0e(t){let e=g.useContext(s1);return Ws(e,CD(t)),e}function u0e(t){let e=g.useContext(pj);return Ws(e,CD(t)),e}function d0e(t){let e=g.useContext(Sf);return Ws(e,CD(t)),e}function _D(t){let e=d0e(t),r=e.matches[e.matches.length-1];return Ws(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function f0e(){return _D("useRouteId")}function h0e(){var n;let t=g.useContext(ND),e=u0e("useRouteError"),r=_D("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function A0e(){let{router:t}=c0e("useNavigate"),e=_D("useNavigate"),r=g.useRef(!1);return TY(()=>{r.current=!0}),g.useCallback(async(a,s={})=>{wf(r.current,PY),r.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...s}))},[t,e])}var QU={};function kY(t,e,r){!e&&!QU[t]&&(QU[t]=!0,wf(!1,r))}g.memo(m0e);function m0e({routes:t,future:e,state:r}){return BY(t,void 0,r,e)}function Rh({to:t,replace:e,state:r,relative:n}){Ws(i1(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=g.useContext(Ef);wf(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=g.useContext(Sf),{pathname:o}=BA(),l=xw(),c=wD(t,bD(s),o,n==="path"),u=JSON.stringify(c);return g.useEffect(()=>{l(JSON.parse(u),{replace:e,state:r,relative:n})},[l,u,n,e,r]),null}function FY(t){return r0e(t.context)}function Mn(t){Ws(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function p0e({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:a,static:s=!1}){Ws(!i1(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=g.useMemo(()=>({basename:o,navigator:a,static:s,future:{}}),[o,a,s]);typeof r=="string"&&(r=a1(r));let{pathname:c="/",search:u="",hash:d="",state:f=null,key:A="default"}=r,h=g.useMemo(()=>{let m=pA(c,o);return m==null?null:{location:{pathname:m,search:u,hash:d,state:f,key:A},navigationType:n}},[o,c,u,d,f,A,n]);return wf(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:g.createElement(Ef.Provider,{value:l},g.createElement(gw.Provider,{children:e,value:h}))}function g0e({children:t,location:e}){return n0e(OB(t),e)}function OB(t,e=[]){let r=[];return g.Children.forEach(t,(n,a)=>{if(!g.isValidElement(n))return;let s=[...e,a];if(n.type===g.Fragment){r.push.apply(r,OB(n.props.children,s));return}Ws(n.type===Mn,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ws(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=OB(n.props.children,s)),r.push(o)}),r}var Y_="get",J_="application/x-www-form-urlencoded";function gj(t){return t!=null&&typeof t.tagName=="string"}function x0e(t){return gj(t)&&t.tagName.toLowerCase()==="button"}function v0e(t){return gj(t)&&t.tagName.toLowerCase()==="form"}function y0e(t){return gj(t)&&t.tagName.toLowerCase()==="input"}function b0e(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function w0e(t,e){return t.button===0&&(!e||e==="_self")&&!b0e(t)}var eC=null;function N0e(){if(eC===null)try{new FormData(document.createElement("form"),0),eC=!1}catch{eC=!0}return eC}var C0e=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function v3(t){return t!=null&&!C0e.has(t)?(wf(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${J_}"`),null):t}function _0e(t,e){let r,n,a,s,o;if(v0e(t)){let l=t.getAttribute("action");n=l?pA(l,e):null,r=t.getAttribute("method")||Y_,a=v3(t.getAttribute("enctype"))||J_,s=new FormData(t)}else if(x0e(t)||y0e(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?pA(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||Y_,a=v3(t.getAttribute("formenctype"))||v3(l.getAttribute("enctype"))||J_,s=new FormData(l,t),!N0e()){let{name:u,type:d,value:f}=t;if(d==="image"){let A=u?`${u}.`:"";s.append(`${A}x`,"0"),s.append(`${A}y`,"0")}else u&&s.append(u,f)}}else{if(gj(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Y_,n=null,a=J_,o=t}return s&&a==="text/plain"&&(o=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ED(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function E0e(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&pA(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function S0e(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function I0e(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function j0e(t,e,r){let n=await Promise.all(t.map(async a=>{let s=e.routes[a.route.id];if(s){let o=await S0e(s,r);return o.links?o.links():[]}return[]}));return k0e(n.flat(1).filter(I0e).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function VU(t,e,r,n,a,s){let o=(c,u)=>r[u]?c.route.id!==r[u].route.id:!0,l=(c,u)=>{var d;return r[u].pathname!==c.pathname||((d=r[u].route.path)==null?void 0:d.endsWith("*"))&&r[u].params["*"]!==c.params["*"]};return s==="assets"?e.filter((c,u)=>o(c,u)||l(c,u)):s==="data"?e.filter((c,u)=>{var f;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let A=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((f=r[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof A=="boolean")return A}return!0}):[]}function P0e(t,e,{includeHydrateFallback:r}={}){return T0e(t.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function T0e(t){return[...new Set(t)]}function B0e(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function k0e(t,e){let r=new Set;return new Set(e),t.reduce((n,a)=>{let s=JSON.stringify(B0e(a));return r.has(s)||(r.add(s),n.push({key:s,link:a})),n},[])}function OY(){let t=g.useContext(s1);return ED(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function F0e(){let t=g.useContext(pj);return ED(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var SD=g.createContext(void 0);SD.displayName="FrameworkContext";function DY(){let t=g.useContext(SD);return ED(t,"You must render this element inside a <HydratedRouter> element"),t}function O0e(t,e){let r=g.useContext(SD),[n,a]=g.useState(!1),[s,o]=g.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:f}=e,A=g.useRef(null);g.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let p=v=>{v.forEach(y=>{o(y.isIntersecting)})},x=new IntersectionObserver(p,{threshold:.5});return A.current&&x.observe(A.current),()=>{x.disconnect()}}},[t]),g.useEffect(()=>{if(n){let p=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(p)}}},[n]);let h=()=>{a(!0)},m=()=>{a(!1),o(!1)};return r?t!=="intent"?[s,A,{}]:[s,A,{onFocus:ny(l,h),onBlur:ny(c,m),onMouseEnter:ny(u,h),onMouseLeave:ny(d,m),onTouchStart:ny(f,h)}]:[!1,A,{}]}function ny(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function D0e({page:t,...e}){let{router:r}=OY(),n=g.useMemo(()=>_Y(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?g.createElement(M0e,{page:t,matches:n,...e}):null}function R0e(t){let{manifest:e,routeModules:r}=DY(),[n,a]=g.useState([]);return g.useEffect(()=>{let s=!1;return j0e(t,e,r).then(o=>{s||a(o)}),()=>{s=!0}},[t,e,r]),n}function M0e({page:t,matches:e,...r}){let n=BA(),{manifest:a,routeModules:s}=DY(),{basename:o}=OY(),{loaderData:l,matches:c}=F0e(),u=g.useMemo(()=>VU(t,e,c,a,n,"data"),[t,e,c,a,n]),d=g.useMemo(()=>VU(t,e,c,a,n,"assets"),[t,e,c,a,n]),f=g.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let m=new Set,p=!1;if(e.forEach(v=>{var b;let y=a.routes[v.route.id];!y||!y.hasLoader||(!u.some(w=>w.route.id===v.route.id)&&v.route.id in l&&((b=s[v.route.id])!=null&&b.shouldRevalidate)||y.hasClientLoader?p=!0:m.add(v.route.id))}),m.size===0)return[];let x=E0e(t,o,"data");return p&&m.size>0&&x.searchParams.set("_routes",e.filter(v=>m.has(v.route.id)).map(v=>v.route.id).join(",")),[x.pathname+x.search]},[o,l,n,a,u,e,t,s]),A=g.useMemo(()=>P0e(d,a),[d,a]),h=R0e(d);return g.createElement(g.Fragment,null,f.map(m=>g.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...r})),A.map(m=>g.createElement("link",{key:m,rel:"modulepreload",href:m,...r})),h.map(({key:m,link:p})=>g.createElement("link",{key:m,nonce:r.nonce,...p})))}function L0e(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var RY=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{RY&&(window.__reactRouterVersion="7.8.1")}catch{}function U0e({basename:t,children:e,window:r}){let n=g.useRef();n.current==null&&(n.current=EAe({window:r,v5Compat:!0}));let a=n.current,[s,o]=g.useState({action:a.action,location:a.location}),l=g.useCallback(c=>{g.startTransition(()=>o(c))},[o]);return g.useLayoutEffect(()=>a.listen(l),[a,l]),g.createElement(p0e,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:a})}var MY=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LY=g.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:a,reloadDocument:s,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f,...A},h){let{basename:m}=g.useContext(Ef),p=typeof u=="string"&&MY.test(u),x,v=!1;if(typeof u=="string"&&p&&(x=u,RY))try{let E=new URL(window.location.href),B=u.startsWith("//")?new URL(E.protocol+u):new URL(u),k=pA(B.pathname,m);B.origin===E.origin&&k!=null?u=k+B.search+B.hash:v=!0}catch{wf(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=ZAe(u,{relative:a}),[b,w,j]=O0e(n,A),I=H0e(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:a,viewTransition:f});function C(E){e&&e(E),E.defaultPrevented||I(E)}let S=g.createElement("a",{...A,...j,href:x||y,onClick:v||s?e:C,ref:L0e(h,w),target:c,"data-discover":!p&&r==="render"?"true":void 0});return b&&!p?g.createElement(g.Fragment,null,S,g.createElement(D0e,{page:y})):S});LY.displayName="Link";var vn=g.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:a=!1,style:s,to:o,viewTransition:l,children:c,...u},d){let f=vw(o,{relative:u.relative}),A=BA(),h=g.useContext(pj),{navigator:m,basename:p}=g.useContext(Ef),x=h!=null&&z0e(f)&&l===!0,v=m.encodeLocation?m.encodeLocation(f).pathname:f.pathname,y=A.pathname,b=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(y=y.toLowerCase(),b=b?b.toLowerCase():null,v=v.toLowerCase()),b&&p&&(b=pA(b,p)||b);const w=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let j=y===v||!a&&y.startsWith(v)&&y.charAt(w)==="/",I=b!=null&&(b===v||!a&&b.startsWith(v)&&b.charAt(v.length)==="/"),C={isActive:j,isPending:I,isTransitioning:x},S=j?e:void 0,E;typeof n=="function"?E=n(C):E=[n,j?"active":null,I?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let B=typeof s=="function"?s(C):s;return g.createElement(LY,{...u,"aria-current":S,className:E,ref:d,style:B,to:o,viewTransition:l},typeof c=="function"?c(C):c)});vn.displayName="NavLink";var Q0e=g.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:a,state:s,method:o=Y_,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:f,...A},h)=>{let m=K0e(),p=q0e(l,{relative:u}),x=o.toLowerCase()==="get"?"get":"post",v=typeof l=="string"&&MY.test(l),y=b=>{if(c&&c(b),b.defaultPrevented)return;b.preventDefault();let w=b.nativeEvent.submitter,j=(w==null?void 0:w.getAttribute("formmethod"))||o;m(w||b.currentTarget,{fetcherKey:e,method:j,navigate:r,replace:a,state:s,relative:u,preventScrollReset:d,viewTransition:f})};return g.createElement("form",{ref:h,method:x,action:p,onSubmit:n?c:y,...A,"data-discover":!v&&t==="render"?"true":void 0})});Q0e.displayName="Form";function V0e(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function UY(t){let e=g.useContext(s1);return Ws(e,V0e(t)),e}function H0e(t,{target:e,replace:r,state:n,preventScrollReset:a,relative:s,viewTransition:o}={}){let l=xw(),c=BA(),u=vw(t,{relative:s});return g.useCallback(d=>{if(w0e(d,e)){d.preventDefault();let f=r!==void 0?r:o2(c)===o2(u);l(t,{replace:f,state:n,preventScrollReset:a,relative:s,viewTransition:o})}},[c,l,u,r,n,e,t,a,s,o])}var $0e=0,G0e=()=>`__${String(++$0e)}__`;function K0e(){let{router:t}=UY("useSubmit"),{basename:e}=g.useContext(Ef),r=f0e();return g.useCallback(async(n,a={})=>{let{action:s,method:o,encType:l,formData:c,body:u}=_0e(n,e);if(a.navigate===!1){let d=a.fetcherKey||G0e();await t.fetch(d,r,a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||o,formEncType:a.encType||l,flushSync:a.flushSync})}else await t.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:u,formMethod:a.method||o,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,r])}function q0e(t,{relative:e}={}){let{basename:r}=g.useContext(Ef),n=g.useContext(Sf);Ws(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...vw(t||".",{relative:e})},o=BA();if(t==null){s.search=o.search;let l=new URLSearchParams(s.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(f=>f).forEach(f=>l.append("index",f));let d=l.toString();s.search=d?`?${d}`:""}}return(!t||t===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:rA([r,s.pathname])),o2(s)}function z0e(t,{relative:e}={}){let r=g.useContext(jY);Ws(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=UY("useViewTransitionState"),a=vw(t,{relative:e});if(!r.isTransitioning)return!1;let s=pA(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=pA(r.nextLocation.pathname,n)||r.nextLocation.pathname;return ZE(a.pathname,o)!=null||ZE(a.pathname,s)!=null}function Sn(t,e){if(!t)return!1;const r=String(e);if(Array.isArray(t))return t.map(String).includes(r);const n=String(t);return n===r||n==="vendedor"&&r==="vendedor_pollo"}var HU={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QY=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},W0e=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const s=t[r++];e[n++]=String.fromCharCode((a&31)<<6|s&63)}else if(a>239&&a<365){const s=t[r++],o=t[r++],l=t[r++],c=((a&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=t[r++],o=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(s&63)<<6|o&63)}}return e.join("")},VY={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const s=t[a],o=a+1<t.length,l=o?t[a+1]:0,c=a+2<t.length,u=c?t[a+2]:0,d=s>>2,f=(s&3)<<4|l>>4;let A=(l&15)<<2|u>>6,h=u&63;c||(h=64,o||(A=64)),n.push(r[d],r[f],r[A],r[h])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(QY(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):W0e(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const s=r[t.charAt(a++)],l=a<t.length?r[t.charAt(a)]:0;++a;const u=a<t.length?r[t.charAt(a)]:64;++a;const f=a<t.length?r[t.charAt(a)]:64;if(++a,s==null||l==null||u==null||f==null)throw new X0e;const A=s<<2|l>>4;if(n.push(A),u!==64){const h=l<<4&240|u>>2;if(n.push(h),f!==64){const m=u<<6&192|f;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class X0e extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Y0e=function(t){const e=QY(t);return VY.encodeByteArray(e,!0)},eS=function(t){return Y0e(t).replace(/\./g,"")},HY=function(t){try{return VY.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J0e(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0e=()=>J0e().__FIREBASE_DEFAULTS__,eme=()=>{if(typeof process>"u"||typeof HU>"u")return;const t=HU.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},tme=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&HY(t[1]);return e&&JSON.parse(e)},xj=()=>{try{return Z0e()||eme()||tme()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},$Y=t=>{var e,r;return(r=(e=xj())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},rme=t=>{const e=$Y(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},GY=()=>{var t;return(t=xj())===null||t===void 0?void 0:t.config},KY=t=>{var e;return(e=xj())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nme{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ame(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[eS(JSON.stringify(r)),eS(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oo(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function sme(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Oo())}function ime(){var t;const e=(t=xj())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ome(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function lme(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function cme(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ume(){const t=Oo();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function qY(){return!ime()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function zY(){try{return typeof indexedDB=="object"}catch{return!1}}function dme(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var s;e(((s=a.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fme="FirebaseError";class kA extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=fme,Object.setPrototypeOf(this,kA.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yw.prototype.create)}}class yw{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,s=this.errors[e],o=s?hme(s,n):"Error",l=`${this.serviceName}: ${o} (${a}).`;return new kA(a,l,n)}}function hme(t,e){return t.replace(Ame,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const Ame=/\{\$([^}]+)}/g;function mme(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function l2(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const s=t[a],o=e[a];if($U(s)&&$U(o)){if(!l2(s,o))return!1}else if(s!==o)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function $U(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bw(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Ry(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[a,s]=n.split("=");e[decodeURIComponent(a)]=decodeURIComponent(s)}}),e}function My(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function pme(t,e){const r=new gme(t,e);return r.subscribe.bind(r)}class gme{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");xme(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=y3),a.error===void 0&&(a.error=y3),a.complete===void 0&&(a.complete=y3);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function xme(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function y3(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ai(t){return t&&t._delegate?t._delegate:t}class ag{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vme=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new nme;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(a)return null;throw s}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(bme(e))try{this.getOrInitializeService({instanceIdentifier:up})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:a});n.resolve(s)}catch{}}}}clearInstance(e=up){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=up){return this.instances.has(e)}getOptions(e=up){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);n===l&&o.resolve(a)}return a}onInit(e,r){var n;const a=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(a))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(a,s);const o=this.instances.get(a);return o&&e(o,a),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:yme(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=up){return this.component?this.component.multipleInstances?e:up:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function yme(t){return t===up?void 0:t}function bme(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wme{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new vme(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ha;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ha||(ha={}));const Nme={debug:ha.DEBUG,verbose:ha.VERBOSE,info:ha.INFO,warn:ha.WARN,error:ha.ERROR,silent:ha.SILENT},Cme=ha.INFO,_me={[ha.DEBUG]:"log",[ha.VERBOSE]:"log",[ha.INFO]:"info",[ha.WARN]:"warn",[ha.ERROR]:"error"},Eme=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=_me[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let ID=class{constructor(e){this.name=e,this._logLevel=Cme,this._logHandler=Eme,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ha))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Nme[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ha.DEBUG,...e),this._logHandler(this,ha.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ha.VERBOSE,...e),this._logHandler(this,ha.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ha.INFO,...e),this._logHandler(this,ha.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ha.WARN,...e),this._logHandler(this,ha.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ha.ERROR,...e),this._logHandler(this,ha.ERROR,...e)}};const Sme=(t,e)=>e.some(r=>t instanceof r);let GU,KU;function Ime(){return GU||(GU=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function jme(){return KU||(KU=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const WY=new WeakMap,DB=new WeakMap,XY=new WeakMap,b3=new WeakMap,jD=new WeakMap;function Pme(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{r(lm(t.result)),a()},o=()=>{n(t.error),a()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&WY.set(r,t)}).catch(()=>{}),jD.set(e,t),e}function Tme(t){if(DB.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{r(),a()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});DB.set(t,e)}let RB={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return DB.get(t);if(e==="objectStoreNames")return t.objectStoreNames||XY.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return lm(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Bme(t){RB=t(RB)}function kme(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(w3(this),e,...r);return XY.set(n,e.sort?e.sort():[e]),lm(n)}:jme().includes(t)?function(...e){return t.apply(w3(this),e),lm(WY.get(this))}:function(...e){return lm(t.apply(w3(this),e))}}function Fme(t){return typeof t=="function"?kme(t):(t instanceof IDBTransaction&&Tme(t),Sme(t,Ime())?new Proxy(t,RB):t)}function lm(t){if(t instanceof IDBRequest)return Pme(t);if(b3.has(t))return b3.get(t);const e=Fme(t);return e!==t&&(b3.set(t,e),jD.set(e,t)),e}const w3=t=>jD.get(t);function Ome(t,e,{blocked:r,upgrade:n,blocking:a,terminated:s}={}){const o=indexedDB.open(t,e),l=lm(o);return n&&o.addEventListener("upgradeneeded",c=>{n(lm(o.result),c.oldVersion,c.newVersion,lm(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),a&&c.addEventListener("versionchange",u=>a(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const Dme=["get","getKey","getAll","getAllKeys","count"],Rme=["put","add","delete","clear"],N3=new Map;function qU(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(N3.get(e))return N3.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=Rme.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||Dme.includes(r)))return;const s=async function(o,...l){const c=this.transaction(o,a?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),a&&c.done]))[0]};return N3.set(e,s),s}Bme(t=>({...t,get:(e,r,n)=>qU(e,r)||t.get(e,r,n),has:(e,r)=>!!qU(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mme{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Lme(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Lme(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const MB="@firebase/app",zU="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gA=new ID("@firebase/app"),Ume="@firebase/app-compat",Qme="@firebase/analytics-compat",Vme="@firebase/analytics",Hme="@firebase/app-check-compat",$me="@firebase/app-check",Gme="@firebase/auth",Kme="@firebase/auth-compat",qme="@firebase/database",zme="@firebase/data-connect",Wme="@firebase/database-compat",Xme="@firebase/functions",Yme="@firebase/functions-compat",Jme="@firebase/installations",Zme="@firebase/installations-compat",epe="@firebase/messaging",tpe="@firebase/messaging-compat",rpe="@firebase/performance",npe="@firebase/performance-compat",ape="@firebase/remote-config",spe="@firebase/remote-config-compat",ipe="@firebase/storage",ope="@firebase/storage-compat",lpe="@firebase/firestore",cpe="@firebase/vertexai-preview",upe="@firebase/firestore-compat",dpe="firebase",fpe="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LB="[DEFAULT]",hpe={[MB]:"fire-core",[Ume]:"fire-core-compat",[Vme]:"fire-analytics",[Qme]:"fire-analytics-compat",[$me]:"fire-app-check",[Hme]:"fire-app-check-compat",[Gme]:"fire-auth",[Kme]:"fire-auth-compat",[qme]:"fire-rtdb",[zme]:"fire-data-connect",[Wme]:"fire-rtdb-compat",[Xme]:"fire-fn",[Yme]:"fire-fn-compat",[Jme]:"fire-iid",[Zme]:"fire-iid-compat",[epe]:"fire-fcm",[tpe]:"fire-fcm-compat",[rpe]:"fire-perf",[npe]:"fire-perf-compat",[ape]:"fire-rc",[spe]:"fire-rc-compat",[ipe]:"fire-gcs",[ope]:"fire-gcs-compat",[lpe]:"fire-fst",[upe]:"fire-fst-compat",[cpe]:"fire-vertex","fire-js":"fire-js",[dpe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv=new Map,UB=new Map,QB=new Map;function WU(t,e){try{t.container.addComponent(e)}catch(r){gA.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Tv(t){const e=t.name;if(QB.has(e))return gA.debug(`There were multiple attempts to register component ${e}.`),!1;QB.set(e,t);for(const r of Pv.values())WU(r,t);for(const r of UB.values())WU(r,t);return!0}function PD(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Xf(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ape={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cm=new yw("app","Firebase",Ape);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mpe{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ag("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cm.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1=fpe;function TD(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:LB,automaticDataCollectionEnabled:!1},e),a=n.name;if(typeof a!="string"||!a)throw cm.create("bad-app-name",{appName:String(a)});if(r||(r=GY()),!r)throw cm.create("no-options");const s=Pv.get(a);if(s){if(l2(r,s.options)&&l2(n,s.config))return s;throw cm.create("duplicate-app",{appName:a})}const o=new wme(a);for(const c of QB.values())o.addComponent(c);const l=new mpe(r,n,o);return Pv.set(a,l),l}function BD(t=LB){const e=Pv.get(t);if(!e&&t===LB&&GY())return TD();if(!e)throw cm.create("no-app",{appName:t});return e}async function ppe(t){let e=!1;const r=t.name;Pv.has(r)?(e=!0,Pv.delete(r)):UB.has(r)&&t.decRefCount()<=0&&(UB.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function um(t,e,r){var n;let a=(n=hpe[t])!==null&&n!==void 0?n:t;r&&(a+=`-${r}`);const s=a.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${a}" with version "${e}":`];s&&l.push(`library name "${a}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),gA.warn(l.join(" "));return}Tv(new ag(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gpe="firebase-heartbeat-database",xpe=1,c2="firebase-heartbeat-store";let C3=null;function YY(){return C3||(C3=Ome(gpe,xpe,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(c2)}catch(r){console.warn(r)}}}}).catch(t=>{throw cm.create("idb-open",{originalErrorMessage:t.message})})),C3}async function vpe(t){try{const r=(await YY()).transaction(c2),n=await r.objectStore(c2).get(JY(t));return await r.done,n}catch(e){if(e instanceof kA)gA.warn(e.message);else{const r=cm.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});gA.warn(r.message)}}}async function XU(t,e){try{const n=(await YY()).transaction(c2,"readwrite");await n.objectStore(c2).put(e,JY(t)),await n.done}catch(r){if(r instanceof kA)gA.warn(r.message);else{const n=cm.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});gA.warn(n.message)}}}function JY(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ype=1024,bpe=30*24*60*60*1e3;class wpe{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Cpe(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=YU();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:a}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=bpe}),this._storage.overwrite(this._heartbeatsCache))}catch(n){gA.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=YU(),{heartbeatsToSend:n,unsentEntries:a}=Npe(this._heartbeatsCache.heartbeats),s=eS(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return gA.warn(r),""}}}function YU(){return new Date().toISOString().substring(0,10)}function Npe(t,e=ype){const r=[];let n=t.slice();for(const a of t){const s=r.find(o=>o.agent===a.agent);if(s){if(s.dates.push(a.date),JU(r)>e){s.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),JU(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Cpe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zY()?dme().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await vpe(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return XU(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return XU(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function JU(t){return eS(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _pe(t){Tv(new ag("platform-logger",e=>new Mme(e),"PRIVATE")),Tv(new ag("heartbeat",e=>new wpe(e),"PRIVATE")),um(MB,zU,t),um(MB,zU,"esm2017"),um("fire-js","")}_pe("");function kD(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function ZY(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Epe=ZY,eJ=new yw("auth","Firebase",ZY());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS=new ID("@firebase/auth");function Spe(t,...e){tS.logLevel<=ha.WARN&&tS.warn(`Auth (${o1}): ${t}`,...e)}function Z_(t,...e){tS.logLevel<=ha.ERROR&&tS.error(`Auth (${o1}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nf(t,...e){throw FD(t,...e)}function sh(t,...e){return FD(t,...e)}function tJ(t,e,r){const n=Object.assign(Object.assign({},Epe()),{[e]:r});return new yw("auth","Firebase",n).create(e,{appName:t.name})}function nA(t){return tJ(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function FD(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return eJ.create(t,...e)}function Rn(t,e,...r){if(!t)throw FD(e,...r)}function qh(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Z_(e),new Error(e)}function xA(t,e){t||qh(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VB(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Ipe(){return ZU()==="http:"||ZU()==="https:"}function ZU(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jpe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Ipe()||lme()||"connection"in navigator)?navigator.onLine:!0}function Ppe(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(e,r){this.shortDelay=e,this.longDelay=r,xA(r>e,"Short delay should be less than long delay!"),this.isMobile=sme()||cme()}get(){return jpe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OD(t,e){xA(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rJ{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tpe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bpe=new ww(3e4,6e4);function FA(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function OA(t,e,r,n,a={}){return nJ(t,a,async()=>{let s={},o={};n&&(e==="GET"?o=n:s={body:JSON.stringify(n)});const l=bw(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},s);return ome()||(u.referrerPolicy="no-referrer"),rJ.fetch()(aJ(t,t.config.apiHost,r,l),u)})}async function nJ(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},Tpe),e);try{const a=new Fpe(t),s=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw tC(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw tC(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw tC(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw tC(t,"user-disabled",o);const d=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw tJ(t,d,u);Nf(t,d)}}catch(a){if(a instanceof kA)throw a;Nf(t,"network-request-failed",{message:String(a)})}}async function Nw(t,e,r,n,a={}){const s=await OA(t,e,r,n,a);return"mfaPendingCredential"in s&&Nf(t,"multi-factor-auth-required",{_serverResponse:s}),s}function aJ(t,e,r,n){const a=`${e}${r}?${n}`;return t.config.emulator?OD(t.config,a):`${t.config.apiScheme}://${a}`}function kpe(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Fpe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(sh(this.auth,"network-request-failed")),Bpe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function tC(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=sh(t,e,n);return a.customData._tokenResponse=r,a}function e7(t){return t!==void 0&&t.enterprise!==void 0}class Ope{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return kpe(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function Dpe(t,e){return OA(t,"GET","/v2/recaptchaConfig",FA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rpe(t,e){return OA(t,"POST","/v1/accounts:delete",e)}async function sJ(t,e){return OA(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ab(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Mpe(t,e=!1){const r=Ai(t),n=await r.getIdToken(e),a=DD(n);Rn(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const s=typeof a.firebase=="object"?a.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:a,token:n,authTime:Ab(_3(a.auth_time)),issuedAtTime:Ab(_3(a.iat)),expirationTime:Ab(_3(a.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function _3(t){return Number(t)*1e3}function DD(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Z_("JWT malformed, contained fewer than 3 sections"),null;try{const a=HY(r);return a?JSON.parse(a):(Z_("Failed to decode base64 JWT payload"),null)}catch(a){return Z_("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function t7(t){const e=DD(t);return Rn(e,"internal-error"),Rn(typeof e.exp<"u","internal-error"),Rn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u2(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof kA&&Lpe(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Lpe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Upe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const a=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HB{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ab(this.lastLoginAt),this.creationTime=Ab(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rS(t){var e;const r=t.auth,n=await t.getIdToken(),a=await u2(t,sJ(r,{idToken:n}));Rn(a==null?void 0:a.users.length,r,"internal-error");const s=a.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?iJ(s.providerUserInfo):[],l=Vpe(t.providerData,o),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new HB(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function Qpe(t){const e=Ai(t);await rS(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Vpe(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function iJ(t){return t.map(e=>{var{providerId:r}=e,n=kD(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hpe(t,e){const r=await nJ(t,{},async()=>{const n=bw({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:s}=t.config,o=aJ(t,a,"/v1/token",`key=${s}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",rJ.fetch()(o,{method:"POST",headers:l,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function $pe(t,e){return OA(t,"POST","/v2/accounts:revokeToken",FA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Rn(e.idToken,"internal-error"),Rn(typeof e.idToken<"u","internal-error"),Rn(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):t7(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Rn(e.length!==0,"internal-error");const r=t7(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Rn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:s}=await Hpe(e,r);this.updateTokensAndExpiration(n,a,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:s}=r,o=new dv;return n&&(Rn(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),a&&(Rn(typeof a=="string","internal-error",{appName:e}),o.accessToken=a),s&&(Rn(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new dv,this.toJSON())}_performRefresh(){return qh("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l0(t,e){Rn(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class zh{constructor(e){var{uid:r,auth:n,stsTokenManager:a}=e,s=kD(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Upe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new HB(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await u2(this,this.stsTokenManager.getToken(this.auth,e));return Rn(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Mpe(this,e)}reload(){return Qpe(this)}_assign(e){this!==e&&(Rn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new zh(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Rn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await rS(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Xf(this.auth.app))return Promise.reject(nA(this.auth));const e=await this.getIdToken();return await u2(this,Rpe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,a,s,o,l,c,u,d;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,A=(a=r.email)!==null&&a!==void 0?a:void 0,h=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,m=(o=r.photoURL)!==null&&o!==void 0?o:void 0,p=(l=r.tenantId)!==null&&l!==void 0?l:void 0,x=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,v=(u=r.createdAt)!==null&&u!==void 0?u:void 0,y=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:b,emailVerified:w,isAnonymous:j,providerData:I,stsTokenManager:C}=r;Rn(b&&C,e,"internal-error");const S=dv.fromJSON(this.name,C);Rn(typeof b=="string",e,"internal-error"),l0(f,e.name),l0(A,e.name),Rn(typeof w=="boolean",e,"internal-error"),Rn(typeof j=="boolean",e,"internal-error"),l0(h,e.name),l0(m,e.name),l0(p,e.name),l0(x,e.name),l0(v,e.name),l0(y,e.name);const E=new zh({uid:b,auth:e,email:A,emailVerified:w,displayName:f,isAnonymous:j,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:S,createdAt:v,lastLoginAt:y});return I&&Array.isArray(I)&&(E.providerData=I.map(B=>Object.assign({},B))),x&&(E._redirectEventId=x),E}static async _fromIdTokenResponse(e,r,n=!1){const a=new dv;a.updateFromServerResponse(r);const s=new zh({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await rS(s),s}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];Rn(a.localId!==void 0,"internal-error");const s=a.providerUserInfo!==void 0?iJ(a.providerUserInfo):[],o=!(a.email&&a.passwordHash)&&!(s!=null&&s.length),l=new dv;l.updateFromIdToken(n);const c=new zh({uid:a.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:s,metadata:new HB(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r7=new Map;function Wh(t){xA(t instanceof Function,"Expected a class definition");let e=r7.get(t);return e?(xA(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,r7.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oJ{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}oJ.type="NONE";const n7=oJ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eE(t,e,r){return`firebase:${t}:${e}:${r}`}class fv{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:s}=this.auth;this.fullUserKey=eE(this.userKey,a.apiKey,s),this.fullPersistenceKey=eE("persistence",a.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?zh._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new fv(Wh(n7),e,n);const a=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=a[0]||Wh(n7);const o=eE(n,e.config.apiKey,e.name);let l=null;for(const u of r)try{const d=await u._get(o);if(d){const f=zh._fromJSON(e,d);u!==s&&(l=f),s=u;break}}catch{}const c=a.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new fv(s,e,n):(s=c[0],l&&await s._set(o,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new fv(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a7(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(dJ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(lJ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(hJ(e))return"Blackberry";if(AJ(e))return"Webos";if(cJ(e))return"Safari";if((e.includes("chrome/")||uJ(e))&&!e.includes("edge/"))return"Chrome";if(fJ(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function lJ(t=Oo()){return/firefox\//i.test(t)}function cJ(t=Oo()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function uJ(t=Oo()){return/crios\//i.test(t)}function dJ(t=Oo()){return/iemobile/i.test(t)}function fJ(t=Oo()){return/android/i.test(t)}function hJ(t=Oo()){return/blackberry/i.test(t)}function AJ(t=Oo()){return/webos/i.test(t)}function RD(t=Oo()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Gpe(t=Oo()){var e;return RD(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Kpe(){return ume()&&document.documentMode===10}function mJ(t=Oo()){return RD(t)||fJ(t)||AJ(t)||hJ(t)||/windows phone/i.test(t)||dJ(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pJ(t,e=[]){let r;switch(t){case"Browser":r=a7(Oo());break;case"Worker":r=`${a7(Oo())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${o1}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qpe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((o,l)=>{try{const c=e(s);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zpe(t,e={}){return OA(t,"GET","/v2/passwordPolicy",FA(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wpe=6;class Xpe{constructor(e){var r,n,a,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:Wpe,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,a,s,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(a=c.containsLowercaseLetter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ype{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new s7(this),this.idTokenSubscription=new s7(this),this.beforeStateQueue=new qpe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=eJ,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Wh(r)),this._initializationPromise=this.queue(async()=>{var n,a;if(!this._deleted&&(this.persistenceManager=await fv.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await sJ(this,{idToken:e}),n=await zh._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Xf(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let a=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=a==null?void 0:a._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(a=c.user,s=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(a)}catch(o){a=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Rn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await rS(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Ppe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Xf(this.app))return Promise.reject(nA(this));const r=e?Ai(e):null;return r&&Rn(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Rn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Xf(this.app)?Promise.reject(nA(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Xf(this.app)?Promise.reject(nA(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wh(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await zpe(this),r=new Xpe(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new yw("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await $pe(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Wh(e)||this._popupRedirectResolver;Rn(r,this,"argument-error"),this.redirectPersistenceManager=await fv.create(this,[Wh(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Rn(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,a);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Rn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=pJ(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const a=await this._getAppCheckToken();return a&&(r["X-Firebase-AppCheck"]=a),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&Spe(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Lm(t){return Ai(t)}class s7{constructor(e){this.auth=e,this.observer=null,this.addObserver=pme(r=>this.observer=r)}get next(){return Rn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vj={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Jpe(t){vj=t}function gJ(t){return vj.loadJS(t)}function Zpe(){return vj.recaptchaEnterpriseScript}function ege(){return vj.gapiScript}function tge(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const rge="recaptcha-enterprise",nge="NO_RECAPTCHA";class age{constructor(e){this.type=rge,this.auth=Lm(e)}async verify(e="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{Dpe(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new Ope(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function a(s,o,l){const c=window.grecaptcha;e7(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(nge)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{n(this.auth).then(l=>{if(!r&&e7(window.grecaptcha))a(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=Zpe();c.length!==0&&(c+=l),gJ(c).then(()=>{a(l,s,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function i7(t,e,r,n=!1){const a=new age(t);let s;try{s=await a.verify(r)}catch{s=await a.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function nS(t,e,r,n){var a;if(!((a=t._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await i7(t,e,r,r==="getOobCode");return n(t,s)}else return n(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await i7(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sge(t,e){const r=PD(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),s=r.getOptions();if(l2(s,e??{}))return a;Nf(a,"already-initialized")}return r.initialize({options:e})}function ige(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Wh);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function oge(t,e,r){const n=Lm(t);Rn(n._canInitEmulator,n,"emulator-config-failed"),Rn(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,s=xJ(e),{host:o,port:l}=lge(e),c=l===null?"":`:${l}`;n.config.emulator={url:`${s}//${o}${c}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:a})}),cge()}function xJ(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function lge(t){const e=xJ(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const s=a[1];return{host:s,port:o7(n.substr(s.length+1))}}else{const[s,o]=n.split(":");return{host:s,port:o7(o)}}}function o7(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function cge(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return qh("not implemented")}_getIdTokenResponse(e){return qh("not implemented")}_linkToIdToken(e,r){return qh("not implemented")}_getReauthenticationResolver(e){return qh("not implemented")}}async function uge(t,e){return OA(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dge(t,e){return Nw(t,"POST","/v1/accounts:signInWithPassword",FA(t,e))}async function fge(t,e){return OA(t,"POST","/v1/accounts:sendOobCode",FA(t,e))}async function hge(t,e){return fge(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Age(t,e){return Nw(t,"POST","/v1/accounts:signInWithEmailLink",FA(t,e))}async function mge(t,e){return Nw(t,"POST","/v1/accounts:signInWithEmailLink",FA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2 extends MD{constructor(e,r,n,a=null){super("password",n),this._email=e,this._password=r,this._tenantId=a}static _fromEmailAndPassword(e,r){return new d2(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new d2(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return nS(e,r,"signInWithPassword",dge);case"emailLink":return Age(e,{email:this._email,oobCode:this._password});default:Nf(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return nS(e,n,"signUpPassword",uge);case"emailLink":return mge(e,{idToken:r,email:this._email,oobCode:this._password});default:Nf(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hv(t,e){return Nw(t,"POST","/v1/accounts:signInWithIdp",FA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pge="http://localhost";class sg extends MD{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new sg(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Nf("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a}=r,s=kD(r,["providerId","signInMethod"]);if(!n||!a)return null;const o=new sg(n,a);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return hv(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,hv(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,hv(e,r)}buildRequest(){const e={requestUri:pge,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=bw(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gge(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function xge(t){const e=Ry(My(t)).link,r=e?Ry(My(e)).deep_link_id:null,n=Ry(My(t)).deep_link_id;return(n?Ry(My(n)).link:null)||n||r||e||t}class LD{constructor(e){var r,n,a,s,o,l;const c=Ry(My(e)),u=(r=c.apiKey)!==null&&r!==void 0?r:null,d=(n=c.oobCode)!==null&&n!==void 0?n:null,f=gge((a=c.mode)!==null&&a!==void 0?a:null);Rn(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=xge(e);try{return new LD(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(){this.providerId=l1.PROVIDER_ID}static credential(e,r){return d2._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=LD.parseLink(r);return Rn(n,"argument-error"),d2._fromEmailAndCode(e,n.code,n.tenantId)}}l1.PROVIDER_ID="password";l1.EMAIL_PASSWORD_SIGN_IN_METHOD="password";l1.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vJ{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cw extends vJ{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0 extends Cw{constructor(){super("facebook.com")}static credential(e){return sg._fromParams({providerId:O0.PROVIDER_ID,signInMethod:O0.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return O0.credentialFromTaggedObject(e)}static credentialFromError(e){return O0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return O0.credential(e.oauthAccessToken)}catch{return null}}}O0.FACEBOOK_SIGN_IN_METHOD="facebook.com";O0.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0 extends Cw{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return sg._fromParams({providerId:D0.PROVIDER_ID,signInMethod:D0.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return D0.credentialFromTaggedObject(e)}static credentialFromError(e){return D0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return D0.credential(r,n)}catch{return null}}}D0.GOOGLE_SIGN_IN_METHOD="google.com";D0.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0 extends Cw{constructor(){super("github.com")}static credential(e){return sg._fromParams({providerId:R0.PROVIDER_ID,signInMethod:R0.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return R0.credentialFromTaggedObject(e)}static credentialFromError(e){return R0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return R0.credential(e.oauthAccessToken)}catch{return null}}}R0.GITHUB_SIGN_IN_METHOD="github.com";R0.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0 extends Cw{constructor(){super("twitter.com")}static credential(e,r){return sg._fromParams({providerId:M0.PROVIDER_ID,signInMethod:M0.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return M0.credentialFromTaggedObject(e)}static credentialFromError(e){return M0.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return M0.credential(r,n)}catch{return null}}}M0.TWITTER_SIGN_IN_METHOD="twitter.com";M0.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vge(t,e){return Nw(t,"POST","/v1/accounts:signUp",FA(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const s=await zh._fromIdTokenResponse(e,n,a),o=l7(n);return new ig({user:s,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=l7(n);return new ig({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function l7(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS extends kA{constructor(e,r,n,a){var s;super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,aS.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new aS(e,r,n,a)}}function yJ(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?aS._fromErrorAndOperation(t,s,e,n):s})}async function yge(t,e,r=!1){const n=await u2(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return ig._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bge(t,e,r=!1){const{auth:n}=t;if(Xf(n.app))return Promise.reject(nA(n));const a="reauthenticate";try{const s=await u2(t,yJ(n,a,e,t),r);Rn(s.idToken,n,"internal-error");const o=DD(s.idToken);Rn(o,n,"internal-error");const{sub:l}=o;return Rn(t.uid===l,n,"user-mismatch"),ig._forOperation(t,a,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Nf(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bJ(t,e,r=!1){if(Xf(t.app))return Promise.reject(nA(t));const n="signIn",a=await yJ(t,n,e),s=await ig._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(s.user),s}async function wge(t,e){return bJ(Lm(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wJ(t){const e=Lm(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Nge(t,e,r){const n=Lm(t);await nS(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",hge)}async function Cge(t,e,r){if(Xf(t.app))return Promise.reject(nA(t));const n=Lm(t),o=await nS(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",vge).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&wJ(t),c}),l=await ig._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function _ge(t,e,r){return Xf(t.app)?Promise.reject(nA(t)):wge(Ai(t),l1.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&wJ(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tE(t,e){return Ai(t).setPersistence(e)}function Ege(t,e,r,n){return Ai(t).onIdTokenChanged(e,r,n)}function Sge(t,e,r){return Ai(t).beforeAuthStateChanged(e,r)}function yj(t,e,r,n){return Ai(t).onAuthStateChanged(e,r,n)}function UD(t){return Ai(t).signOut()}const sS="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NJ{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(sS,"1"),this.storage.removeItem(sS),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ige=1e3,jge=10;class CJ extends NJ{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=mJ(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},s=this.storage.getItem(n);Kpe()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,jge):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Ige)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}CJ.type="LOCAL";const QD=CJ;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _J extends NJ{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}_J.type="SESSION";const VD=_J;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pge(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new bj(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:s}=r.data,o=this.handlersMap[a];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const l=Array.from(o).map(async u=>u(r.origin,s)),c=await Pge(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}bj.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HD(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tge{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let s,o;return new Promise((l,c)=>{const u=HD("",20);a.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:a,onMessage(f){const A=f;if(A.data.eventId===u)switch(A.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(A.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),a.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[a.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ih(){return window}function Bge(t){ih().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EJ(){return typeof ih().WorkerGlobalScope<"u"&&typeof ih().importScripts=="function"}async function kge(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Fge(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Oge(){return EJ()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SJ="firebaseLocalStorageDb",Dge=1,iS="firebaseLocalStorage",IJ="fbase_key";class _w{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function wj(t,e){return t.transaction([iS],e?"readwrite":"readonly").objectStore(iS)}function Rge(){const t=indexedDB.deleteDatabase(SJ);return new _w(t).toPromise()}function $B(){const t=indexedDB.open(SJ,Dge);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(iS,{keyPath:IJ})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(iS)?e(n):(n.close(),await Rge(),e(await $B()))})})}async function c7(t,e,r){const n=wj(t,!0).put({[IJ]:e,value:r});return new _w(n).toPromise()}async function Mge(t,e){const r=wj(t,!1).get(e),n=await new _w(r).toPromise();return n===void 0?null:n.value}function u7(t,e){const r=wj(t,!0).delete(e);return new _w(r).toPromise()}const Lge=800,Uge=3;class jJ{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await $B(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Uge)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return EJ()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=bj._getInstance(Oge()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await kge(),!this.activeServiceWorker)return;this.sender=new Tge(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Fge()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await $B();return await c7(e,sS,"1"),await u7(e,sS),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>c7(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>Mge(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>u7(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const s=wj(a,!1).getAll();return new _w(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:s}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(s)&&(this.notifyListeners(a,s),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Lge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}jJ.type="LOCAL";const PJ=jJ;new ww(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qge(t,e){return e?Wh(e):(Rn(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D extends MD{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return hv(e,this._buildIdpRequest())}_linkToIdToken(e,r){return hv(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return hv(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function Vge(t){return bJ(t.auth,new $D(t),t.bypassAuthState)}function Hge(t){const{auth:e,user:r}=t;return Rn(r,e,"internal-error"),bge(r,new $D(t),t.bypassAuthState)}async function $ge(t){const{auth:e,user:r}=t;return Rn(r,e,"internal-error"),yge(r,new $D(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TJ{constructor(e,r,n,a,s=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Vge;case"linkViaPopup":case"linkViaRedirect":return $ge;case"reauthViaPopup":case"reauthViaRedirect":return Hge;default:Nf(this.auth,"internal-error")}}resolve(e){xA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){xA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gge=new ww(2e3,1e4);class Wx extends TJ{constructor(e,r,n,a,s){super(e,r,a,s),this.provider=n,this.authWindow=null,this.pollId=null,Wx.currentPopupAction&&Wx.currentPopupAction.cancel(),Wx.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Rn(e,this.auth,"internal-error"),e}async onExecution(){xA(this.filter.length===1,"Popup operations only handle one event");const e=HD();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(sh(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(sh(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Wx.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(sh(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Gge.get())};e()}}Wx.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kge="pendingRedirect",rE=new Map;class qge extends TJ{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=rE.get(this.auth._key());if(!e){try{const n=await zge(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}rE.set(this.auth._key(),e)}return this.bypassAuthState||rE.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function zge(t,e){const r=Yge(e),n=Xge(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function Wge(t,e){rE.set(t._key(),e)}function Xge(t){return Wh(t._redirectPersistence)}function Yge(t){return eE(Kge,t.config.apiKey,t.name)}async function Jge(t,e,r=!1){if(Xf(t.app))return Promise.reject(nA(t));const n=Lm(t),a=Qge(n,e),o=await new qge(n,a,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zge=10*60*1e3;class exe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!txe(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!BJ(e)){const a=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(sh(this.auth,a))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Zge&&this.cachedEventUids.clear(),this.cachedEventUids.has(d7(e))}saveEventToCache(e){this.cachedEventUids.add(d7(e)),this.lastProcessedEventTime=Date.now()}}function d7(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function BJ({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function txe(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return BJ(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rxe(t,e={}){return OA(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nxe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,axe=/^https?/;async function sxe(t){if(t.config.emulator)return;const{authorizedDomains:e}=await rxe(t);for(const r of e)try{if(ixe(r))return}catch{}Nf(t,"unauthorized-domain")}function ixe(t){const e=VB(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!axe.test(r))return!1;if(nxe.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oxe=new ww(3e4,6e4);function f7(){const t=ih().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function lxe(t){return new Promise((e,r)=>{var n,a,s;function o(){f7(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{f7(),r(sh(t,"network-request-failed"))},timeout:oxe.get()})}if(!((a=(n=ih().gapi)===null||n===void 0?void 0:n.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((s=ih().gapi)===null||s===void 0)&&s.load)o();else{const l=tge("iframefcb");return ih()[l]=()=>{gapi.load?o():r(sh(t,"network-request-failed"))},gJ(`${ege()}?onload=${l}`).catch(c=>r(c))}}).catch(e=>{throw nE=null,e})}let nE=null;function cxe(t){return nE=nE||lxe(t),nE}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uxe=new ww(5e3,15e3),dxe="__/auth/iframe",fxe="emulator/auth/iframe",hxe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Axe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mxe(t){const e=t.config;Rn(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?OD(e,fxe):`https://${t.config.authDomain}/${dxe}`,n={apiKey:e.apiKey,appName:t.name,v:o1},a=Axe.get(t.config.apiHost);a&&(n.eid=a);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${bw(n).slice(1)}`}async function pxe(t){const e=await cxe(t),r=ih().gapi;return Rn(r,t,"internal-error"),e.open({where:document.body,url:mxe(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hxe,dontclear:!0},n=>new Promise(async(a,s)=>{await n.restyle({setHideOnLeave:!1});const o=sh(t,"network-request-failed"),l=ih().setTimeout(()=>{s(o)},uxe.get());function c(){ih().clearTimeout(l),a(n)}n.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gxe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},xxe=500,vxe=600,yxe="_blank",bxe="http://localhost";class h7{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function wxe(t,e,r,n=xxe,a=vxe){const s=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c=Object.assign(Object.assign({},gxe),{width:n.toString(),height:a.toString(),top:s,left:o}),u=Oo().toLowerCase();r&&(l=uJ(u)?yxe:r),lJ(u)&&(e=e||bxe,c.scrollbars="yes");const d=Object.entries(c).reduce((A,[h,m])=>`${A}${h}=${m},`,"");if(Gpe(u)&&l!=="_self")return Nxe(e||"",l),new h7(null);const f=window.open(e||"",l,d);Rn(f,t,"popup-blocked");try{f.focus()}catch{}return new h7(f)}function Nxe(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cxe="__/auth/handler",_xe="emulator/auth/handler",Exe=encodeURIComponent("fac");async function A7(t,e,r,n,a,s){Rn(t.config.authDomain,t,"auth-domain-config-required"),Rn(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:o1,eventId:a};if(e instanceof vJ){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",mme(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))o[d]=f}if(e instanceof Cw){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${Exe}=${encodeURIComponent(c)}`:"";return`${Sxe(t)}?${bw(l).slice(1)}${u}`}function Sxe({config:t}){return t.emulator?OD(t,_xe):`https://${t.authDomain}/${Cxe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E3="webStorageSupport";class Ixe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=VD,this._completeRedirectFn=Jge,this._overrideRedirectResult=Wge}async _openPopup(e,r,n,a){var s;xA((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await A7(e,r,n,VB(),a);return wxe(e,o,HD())}async _openRedirect(e,r,n,a){await this._originValidation(e);const s=await A7(e,r,n,VB(),a);return Bge(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:s}=this.eventManagers[r];return a?Promise.resolve(a):(xA(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await pxe(e),n=new exe(e);return r.register("authEvent",a=>(Rn(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(E3,{type:E3},a=>{var s;const o=(s=a==null?void 0:a[0])===null||s===void 0?void 0:s[E3];o!==void 0&&r(!!o),Nf(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=sxe(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return mJ()||cJ()||RD()}}const jxe=Ixe;var m7="@firebase/auth",p7="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pxe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Rn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Txe(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Bxe(t){Tv(new ag("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;Rn(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:pJ(t)},u=new Ype(n,a,s,c);return ige(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Tv(new ag("auth-internal",e=>{const r=Lm(e.getProvider("auth").getImmediate());return(n=>new Pxe(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),um(m7,p7,Txe(t)),um(m7,p7,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kxe=5*60,Fxe=KY("authIdTokenMaxAge")||kxe;let g7=null;const Oxe=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>Fxe)return;const a=r==null?void 0:r.token;g7!==a&&(g7=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function GB(t=BD()){const e=PD(t,"auth");if(e.isInitialized())return e.getImmediate();const r=sge(t,{popupRedirectResolver:jxe,persistence:[PJ,QD,VD]}),n=KY("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const o=Oxe(s.toString());Sge(r,o,()=>o(r.currentUser)),Ege(r,l=>o(l))}}const a=$Y("auth");return a&&oge(r,`http://${a}`),r}function Dxe(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}Jpe({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const s=sh("internal-error");s.customData=a,r(s)},n.type="text/javascript",n.charset="UTF-8",Dxe().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Bxe("Browser");var Rxe="firebase",Mxe="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */um(Rxe,Mxe,"app");var x7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Rp,kJ;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,S){function E(){}E.prototype=S.prototype,C.D=S.prototype,C.prototype=new E,C.prototype.constructor=C,C.C=function(B,k,T){for(var P=Array(arguments.length-2),K=2;K<arguments.length;K++)P[K-2]=arguments[K];return S.prototype[k].apply(B,P)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(C,S,E){E||(E=0);var B=Array(16);if(typeof S=="string")for(var k=0;16>k;++k)B[k]=S.charCodeAt(E++)|S.charCodeAt(E++)<<8|S.charCodeAt(E++)<<16|S.charCodeAt(E++)<<24;else for(k=0;16>k;++k)B[k]=S[E++]|S[E++]<<8|S[E++]<<16|S[E++]<<24;S=C.g[0],E=C.g[1],k=C.g[2];var T=C.g[3],P=S+(T^E&(k^T))+B[0]+3614090360&4294967295;S=E+(P<<7&4294967295|P>>>25),P=T+(k^S&(E^k))+B[1]+3905402710&4294967295,T=S+(P<<12&4294967295|P>>>20),P=k+(E^T&(S^E))+B[2]+606105819&4294967295,k=T+(P<<17&4294967295|P>>>15),P=E+(S^k&(T^S))+B[3]+3250441966&4294967295,E=k+(P<<22&4294967295|P>>>10),P=S+(T^E&(k^T))+B[4]+4118548399&4294967295,S=E+(P<<7&4294967295|P>>>25),P=T+(k^S&(E^k))+B[5]+1200080426&4294967295,T=S+(P<<12&4294967295|P>>>20),P=k+(E^T&(S^E))+B[6]+2821735955&4294967295,k=T+(P<<17&4294967295|P>>>15),P=E+(S^k&(T^S))+B[7]+4249261313&4294967295,E=k+(P<<22&4294967295|P>>>10),P=S+(T^E&(k^T))+B[8]+1770035416&4294967295,S=E+(P<<7&4294967295|P>>>25),P=T+(k^S&(E^k))+B[9]+2336552879&4294967295,T=S+(P<<12&4294967295|P>>>20),P=k+(E^T&(S^E))+B[10]+4294925233&4294967295,k=T+(P<<17&4294967295|P>>>15),P=E+(S^k&(T^S))+B[11]+2304563134&4294967295,E=k+(P<<22&4294967295|P>>>10),P=S+(T^E&(k^T))+B[12]+1804603682&4294967295,S=E+(P<<7&4294967295|P>>>25),P=T+(k^S&(E^k))+B[13]+4254626195&4294967295,T=S+(P<<12&4294967295|P>>>20),P=k+(E^T&(S^E))+B[14]+2792965006&4294967295,k=T+(P<<17&4294967295|P>>>15),P=E+(S^k&(T^S))+B[15]+1236535329&4294967295,E=k+(P<<22&4294967295|P>>>10),P=S+(k^T&(E^k))+B[1]+4129170786&4294967295,S=E+(P<<5&4294967295|P>>>27),P=T+(E^k&(S^E))+B[6]+3225465664&4294967295,T=S+(P<<9&4294967295|P>>>23),P=k+(S^E&(T^S))+B[11]+643717713&4294967295,k=T+(P<<14&4294967295|P>>>18),P=E+(T^S&(k^T))+B[0]+3921069994&4294967295,E=k+(P<<20&4294967295|P>>>12),P=S+(k^T&(E^k))+B[5]+3593408605&4294967295,S=E+(P<<5&4294967295|P>>>27),P=T+(E^k&(S^E))+B[10]+38016083&4294967295,T=S+(P<<9&4294967295|P>>>23),P=k+(S^E&(T^S))+B[15]+3634488961&4294967295,k=T+(P<<14&4294967295|P>>>18),P=E+(T^S&(k^T))+B[4]+3889429448&4294967295,E=k+(P<<20&4294967295|P>>>12),P=S+(k^T&(E^k))+B[9]+568446438&4294967295,S=E+(P<<5&4294967295|P>>>27),P=T+(E^k&(S^E))+B[14]+3275163606&4294967295,T=S+(P<<9&4294967295|P>>>23),P=k+(S^E&(T^S))+B[3]+4107603335&4294967295,k=T+(P<<14&4294967295|P>>>18),P=E+(T^S&(k^T))+B[8]+1163531501&4294967295,E=k+(P<<20&4294967295|P>>>12),P=S+(k^T&(E^k))+B[13]+2850285829&4294967295,S=E+(P<<5&4294967295|P>>>27),P=T+(E^k&(S^E))+B[2]+4243563512&4294967295,T=S+(P<<9&4294967295|P>>>23),P=k+(S^E&(T^S))+B[7]+1735328473&4294967295,k=T+(P<<14&4294967295|P>>>18),P=E+(T^S&(k^T))+B[12]+2368359562&4294967295,E=k+(P<<20&4294967295|P>>>12),P=S+(E^k^T)+B[5]+4294588738&4294967295,S=E+(P<<4&4294967295|P>>>28),P=T+(S^E^k)+B[8]+2272392833&4294967295,T=S+(P<<11&4294967295|P>>>21),P=k+(T^S^E)+B[11]+1839030562&4294967295,k=T+(P<<16&4294967295|P>>>16),P=E+(k^T^S)+B[14]+4259657740&4294967295,E=k+(P<<23&4294967295|P>>>9),P=S+(E^k^T)+B[1]+2763975236&4294967295,S=E+(P<<4&4294967295|P>>>28),P=T+(S^E^k)+B[4]+1272893353&4294967295,T=S+(P<<11&4294967295|P>>>21),P=k+(T^S^E)+B[7]+4139469664&4294967295,k=T+(P<<16&4294967295|P>>>16),P=E+(k^T^S)+B[10]+3200236656&4294967295,E=k+(P<<23&4294967295|P>>>9),P=S+(E^k^T)+B[13]+681279174&4294967295,S=E+(P<<4&4294967295|P>>>28),P=T+(S^E^k)+B[0]+3936430074&4294967295,T=S+(P<<11&4294967295|P>>>21),P=k+(T^S^E)+B[3]+3572445317&4294967295,k=T+(P<<16&4294967295|P>>>16),P=E+(k^T^S)+B[6]+76029189&4294967295,E=k+(P<<23&4294967295|P>>>9),P=S+(E^k^T)+B[9]+3654602809&4294967295,S=E+(P<<4&4294967295|P>>>28),P=T+(S^E^k)+B[12]+3873151461&4294967295,T=S+(P<<11&4294967295|P>>>21),P=k+(T^S^E)+B[15]+530742520&4294967295,k=T+(P<<16&4294967295|P>>>16),P=E+(k^T^S)+B[2]+3299628645&4294967295,E=k+(P<<23&4294967295|P>>>9),P=S+(k^(E|~T))+B[0]+4096336452&4294967295,S=E+(P<<6&4294967295|P>>>26),P=T+(E^(S|~k))+B[7]+1126891415&4294967295,T=S+(P<<10&4294967295|P>>>22),P=k+(S^(T|~E))+B[14]+2878612391&4294967295,k=T+(P<<15&4294967295|P>>>17),P=E+(T^(k|~S))+B[5]+4237533241&4294967295,E=k+(P<<21&4294967295|P>>>11),P=S+(k^(E|~T))+B[12]+1700485571&4294967295,S=E+(P<<6&4294967295|P>>>26),P=T+(E^(S|~k))+B[3]+2399980690&4294967295,T=S+(P<<10&4294967295|P>>>22),P=k+(S^(T|~E))+B[10]+4293915773&4294967295,k=T+(P<<15&4294967295|P>>>17),P=E+(T^(k|~S))+B[1]+2240044497&4294967295,E=k+(P<<21&4294967295|P>>>11),P=S+(k^(E|~T))+B[8]+1873313359&4294967295,S=E+(P<<6&4294967295|P>>>26),P=T+(E^(S|~k))+B[15]+4264355552&4294967295,T=S+(P<<10&4294967295|P>>>22),P=k+(S^(T|~E))+B[6]+2734768916&4294967295,k=T+(P<<15&4294967295|P>>>17),P=E+(T^(k|~S))+B[13]+1309151649&4294967295,E=k+(P<<21&4294967295|P>>>11),P=S+(k^(E|~T))+B[4]+4149444226&4294967295,S=E+(P<<6&4294967295|P>>>26),P=T+(E^(S|~k))+B[11]+3174756917&4294967295,T=S+(P<<10&4294967295|P>>>22),P=k+(S^(T|~E))+B[2]+718787259&4294967295,k=T+(P<<15&4294967295|P>>>17),P=E+(T^(k|~S))+B[9]+3951481745&4294967295,C.g[0]=C.g[0]+S&4294967295,C.g[1]=C.g[1]+(k+(P<<21&4294967295|P>>>11))&4294967295,C.g[2]=C.g[2]+k&4294967295,C.g[3]=C.g[3]+T&4294967295}n.prototype.u=function(C,S){S===void 0&&(S=C.length);for(var E=S-this.blockSize,B=this.B,k=this.h,T=0;T<S;){if(k==0)for(;T<=E;)a(this,C,T),T+=this.blockSize;if(typeof C=="string"){for(;T<S;)if(B[k++]=C.charCodeAt(T++),k==this.blockSize){a(this,B),k=0;break}}else for(;T<S;)if(B[k++]=C[T++],k==this.blockSize){a(this,B),k=0;break}}this.h=k,this.o+=S},n.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var S=1;S<C.length-8;++S)C[S]=0;var E=8*this.o;for(S=C.length-8;S<C.length;++S)C[S]=E&255,E/=256;for(this.u(C),C=Array(16),S=E=0;4>S;++S)for(var B=0;32>B;B+=8)C[E++]=this.g[S]>>>B&255;return C};function s(C,S){var E=l;return Object.prototype.hasOwnProperty.call(E,C)?E[C]:E[C]=S(C)}function o(C,S){this.h=S;for(var E=[],B=!0,k=C.length-1;0<=k;k--){var T=C[k]|0;B&&T==S||(E[k]=T,B=!1)}this.g=E}var l={};function c(C){return-128<=C&&128>C?s(C,function(S){return new o([S|0],0>S?-1:0)}):new o([C|0],0>C?-1:0)}function u(C){if(isNaN(C)||!isFinite(C))return f;if(0>C)return x(u(-C));for(var S=[],E=1,B=0;C>=E;B++)S[B]=C/E|0,E*=4294967296;return new o(S,0)}function d(C,S){if(C.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(C.charAt(0)=="-")return x(d(C.substring(1),S));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=u(Math.pow(S,8)),B=f,k=0;k<C.length;k+=8){var T=Math.min(8,C.length-k),P=parseInt(C.substring(k,k+T),S);8>T?(T=u(Math.pow(S,T)),B=B.j(T).add(u(P))):(B=B.j(E),B=B.add(u(P)))}return B}var f=c(0),A=c(1),h=c(16777216);t=o.prototype,t.m=function(){if(p(this))return-x(this).m();for(var C=0,S=1,E=0;E<this.g.length;E++){var B=this.i(E);C+=(0<=B?B:4294967296+B)*S,S*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(m(this))return"0";if(p(this))return"-"+x(this).toString(C);for(var S=u(Math.pow(C,6)),E=this,B="";;){var k=w(E,S).g;E=v(E,k.j(S));var T=((0<E.g.length?E.g[0]:E.h)>>>0).toString(C);if(E=k,m(E))return T+B;for(;6>T.length;)T="0"+T;B=T+B}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function m(C){if(C.h!=0)return!1;for(var S=0;S<C.g.length;S++)if(C.g[S]!=0)return!1;return!0}function p(C){return C.h==-1}t.l=function(C){return C=v(this,C),p(C)?-1:m(C)?0:1};function x(C){for(var S=C.g.length,E=[],B=0;B<S;B++)E[B]=~C.g[B];return new o(E,~C.h).add(A)}t.abs=function(){return p(this)?x(this):this},t.add=function(C){for(var S=Math.max(this.g.length,C.g.length),E=[],B=0,k=0;k<=S;k++){var T=B+(this.i(k)&65535)+(C.i(k)&65535),P=(T>>>16)+(this.i(k)>>>16)+(C.i(k)>>>16);B=P>>>16,T&=65535,P&=65535,E[k]=P<<16|T}return new o(E,E[E.length-1]&-2147483648?-1:0)};function v(C,S){return C.add(x(S))}t.j=function(C){if(m(this)||m(C))return f;if(p(this))return p(C)?x(this).j(x(C)):x(x(this).j(C));if(p(C))return x(this.j(x(C)));if(0>this.l(h)&&0>C.l(h))return u(this.m()*C.m());for(var S=this.g.length+C.g.length,E=[],B=0;B<2*S;B++)E[B]=0;for(B=0;B<this.g.length;B++)for(var k=0;k<C.g.length;k++){var T=this.i(B)>>>16,P=this.i(B)&65535,K=C.i(k)>>>16,le=C.i(k)&65535;E[2*B+2*k]+=P*le,y(E,2*B+2*k),E[2*B+2*k+1]+=T*le,y(E,2*B+2*k+1),E[2*B+2*k+1]+=P*K,y(E,2*B+2*k+1),E[2*B+2*k+2]+=T*K,y(E,2*B+2*k+2)}for(B=0;B<S;B++)E[B]=E[2*B+1]<<16|E[2*B];for(B=S;B<2*S;B++)E[B]=0;return new o(E,0)};function y(C,S){for(;(C[S]&65535)!=C[S];)C[S+1]+=C[S]>>>16,C[S]&=65535,S++}function b(C,S){this.g=C,this.h=S}function w(C,S){if(m(S))throw Error("division by zero");if(m(C))return new b(f,f);if(p(C))return S=w(x(C),S),new b(x(S.g),x(S.h));if(p(S))return S=w(C,x(S)),new b(x(S.g),S.h);if(30<C.g.length){if(p(C)||p(S))throw Error("slowDivide_ only works with positive integers.");for(var E=A,B=S;0>=B.l(C);)E=j(E),B=j(B);var k=I(E,1),T=I(B,1);for(B=I(B,2),E=I(E,2);!m(B);){var P=T.add(B);0>=P.l(C)&&(k=k.add(E),T=P),B=I(B,1),E=I(E,1)}return S=v(C,k.j(S)),new b(k,S)}for(k=f;0<=C.l(S);){for(E=Math.max(1,Math.floor(C.m()/S.m())),B=Math.ceil(Math.log(E)/Math.LN2),B=48>=B?1:Math.pow(2,B-48),T=u(E),P=T.j(S);p(P)||0<P.l(C);)E-=B,T=u(E),P=T.j(S);m(T)&&(T=A),k=k.add(T),C=v(C,P)}return new b(k,C)}t.A=function(C){return w(this,C).h},t.and=function(C){for(var S=Math.max(this.g.length,C.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)&C.i(B);return new o(E,this.h&C.h)},t.or=function(C){for(var S=Math.max(this.g.length,C.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)|C.i(B);return new o(E,this.h|C.h)},t.xor=function(C){for(var S=Math.max(this.g.length,C.g.length),E=[],B=0;B<S;B++)E[B]=this.i(B)^C.i(B);return new o(E,this.h^C.h)};function j(C){for(var S=C.g.length+1,E=[],B=0;B<S;B++)E[B]=C.i(B)<<1|C.i(B-1)>>>31;return new o(E,C.h)}function I(C,S){var E=S>>5;S%=32;for(var B=C.g.length-E,k=[],T=0;T<B;T++)k[T]=0<S?C.i(T+E)>>>S|C.i(T+E+1)<<32-S:C.i(T+E);return new o(k,C.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,kJ=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Rp=o}).apply(typeof x7<"u"?x7:typeof self<"u"?self:typeof window<"u"?window:{});var rC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var FJ,Ly,OJ,aE,KB,DJ,RJ,MJ;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(_,Y,xe){return _==Array.prototype||_==Object.prototype||(_[Y]=xe.value),_};function r(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof rC=="object"&&rC];for(var Y=0;Y<_.length;++Y){var xe=_[Y];if(xe&&xe.Math==Math)return xe}throw Error("Cannot find global object")}var n=r(this);function a(_,Y){if(Y)e:{var xe=n;_=_.split(".");for(var Ze=0;Ze<_.length-1;Ze++){var Gt=_[Ze];if(!(Gt in xe))break e;xe=xe[Gt]}_=_[_.length-1],Ze=xe[_],Y=Y(Ze),Y!=Ze&&Y!=null&&e(xe,_,{configurable:!0,writable:!0,value:Y})}}function s(_,Y){_ instanceof String&&(_+="");var xe=0,Ze=!1,Gt={next:function(){if(!Ze&&xe<_.length){var rr=xe++;return{value:Y(rr,_[rr]),done:!1}}return Ze=!0,{done:!0,value:void 0}}};return Gt[Symbol.iterator]=function(){return Gt},Gt}a("Array.prototype.values",function(_){return _||function(){return s(this,function(Y,xe){return xe})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(_){var Y=typeof _;return Y=Y!="object"?Y:_?Array.isArray(_)?"array":Y:"null",Y=="array"||Y=="object"&&typeof _.length=="number"}function u(_){var Y=typeof _;return Y=="object"&&_!=null||Y=="function"}function d(_,Y,xe){return _.call.apply(_.bind,arguments)}function f(_,Y,xe){if(!_)throw Error();if(2<arguments.length){var Ze=Array.prototype.slice.call(arguments,2);return function(){var Gt=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Gt,Ze),_.apply(Y,Gt)}}return function(){return _.apply(Y,arguments)}}function A(_,Y,xe){return A=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,A.apply(null,arguments)}function h(_,Y){var xe=Array.prototype.slice.call(arguments,1);return function(){var Ze=xe.slice();return Ze.push.apply(Ze,arguments),_.apply(this,Ze)}}function m(_,Y){function xe(){}xe.prototype=Y.prototype,_.aa=Y.prototype,_.prototype=new xe,_.prototype.constructor=_,_.Qb=function(Ze,Gt,rr){for(var Lr=Array(arguments.length-2),ma=2;ma<arguments.length;ma++)Lr[ma-2]=arguments[ma];return Y.prototype[Gt].apply(Ze,Lr)}}function p(_){const Y=_.length;if(0<Y){const xe=Array(Y);for(let Ze=0;Ze<Y;Ze++)xe[Ze]=_[Ze];return xe}return[]}function x(_,Y){for(let xe=1;xe<arguments.length;xe++){const Ze=arguments[xe];if(c(Ze)){const Gt=_.length||0,rr=Ze.length||0;_.length=Gt+rr;for(let Lr=0;Lr<rr;Lr++)_[Gt+Lr]=Ze[Lr]}else _.push(Ze)}}class v{constructor(Y,xe){this.i=Y,this.j=xe,this.h=0,this.g=null}get(){let Y;return 0<this.h?(this.h--,Y=this.g,this.g=Y.next,Y.next=null):Y=this.i(),Y}}function y(_){return/^[\s\xa0]*$/.test(_)}function b(){var _=l.navigator;return _&&(_=_.userAgent)?_:""}function w(_){return w[" "](_),_}w[" "]=function(){};var j=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function I(_,Y,xe){for(const Ze in _)Y.call(xe,_[Ze],Ze,_)}function C(_,Y){for(const xe in _)Y.call(void 0,_[xe],xe,_)}function S(_){const Y={};for(const xe in _)Y[xe]=_[xe];return Y}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function B(_,Y){let xe,Ze;for(let Gt=1;Gt<arguments.length;Gt++){Ze=arguments[Gt];for(xe in Ze)_[xe]=Ze[xe];for(let rr=0;rr<E.length;rr++)xe=E[rr],Object.prototype.hasOwnProperty.call(Ze,xe)&&(_[xe]=Ze[xe])}}function k(_){var Y=1;_=_.split(":");const xe=[];for(;0<Y&&_.length;)xe.push(_.shift()),Y--;return _.length&&xe.push(_.join(":")),xe}function T(_){l.setTimeout(()=>{throw _},0)}function P(){var _=te;let Y=null;return _.g&&(Y=_.g,_.g=_.g.next,_.g||(_.h=null),Y.next=null),Y}class K{constructor(){this.h=this.g=null}add(Y,xe){const Ze=le.get();Ze.set(Y,xe),this.h?this.h.next=Ze:this.g=Ze,this.h=Ze}}var le=new v(()=>new oe,_=>_.reset());class oe{constructor(){this.next=this.g=this.h=null}set(Y,xe){this.h=Y,this.g=xe,this.next=null}reset(){this.next=this.g=this.h=null}}let ie,Ae=!1,te=new K,Te=()=>{const _=l.Promise.resolve(void 0);ie=()=>{_.then(Ue)}};var Ue=()=>{for(var _;_=P();){try{_.h.call(_.g)}catch(xe){T(xe)}var Y=le;Y.j(_),100>Y.h&&(Y.h++,_.next=Y.g,Y.g=_)}Ae=!1};function O(){this.s=this.s,this.C=this.C}O.prototype.s=!1,O.prototype.ma=function(){this.s||(this.s=!0,this.N())},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(_,Y){this.type=_,this.g=this.target=Y,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var G=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var _=!1,Y=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const xe=()=>{};l.addEventListener("test",xe,Y),l.removeEventListener("test",xe,Y)}catch{}return _}();function L(_,Y){if(H.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_){var xe=this.type=_.type,Ze=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;if(this.target=_.target||_.srcElement,this.g=Y,Y=_.relatedTarget){if(j){e:{try{w(Y.nodeName);var Gt=!0;break e}catch{}Gt=!1}Gt||(Y=null)}}else xe=="mouseover"?Y=_.fromElement:xe=="mouseout"&&(Y=_.toElement);this.relatedTarget=Y,Ze?(this.clientX=Ze.clientX!==void 0?Ze.clientX:Ze.pageX,this.clientY=Ze.clientY!==void 0?Ze.clientY:Ze.pageY,this.screenX=Ze.screenX||0,this.screenY=Ze.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=typeof _.pointerType=="string"?_.pointerType:W[_.pointerType]||"",this.state=_.state,this.i=_,_.defaultPrevented&&L.aa.h.call(this)}}m(L,H);var W={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var X="closure_listenable_"+(1e6*Math.random()|0),D=0;function Q(_,Y,xe,Ze,Gt){this.listener=_,this.proxy=null,this.src=Y,this.type=xe,this.capture=!!Ze,this.ha=Gt,this.key=++D,this.da=this.fa=!1}function Z(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function be(_){this.src=_,this.g={},this.h=0}be.prototype.add=function(_,Y,xe,Ze,Gt){var rr=_.toString();_=this.g[rr],_||(_=this.g[rr]=[],this.h++);var Lr=ze(_,Y,Ze,Gt);return-1<Lr?(Y=_[Lr],xe||(Y.fa=!1)):(Y=new Q(Y,this.src,rr,!!Ze,Gt),Y.fa=xe,_.push(Y)),Y};function U(_,Y){var xe=Y.type;if(xe in _.g){var Ze=_.g[xe],Gt=Array.prototype.indexOf.call(Ze,Y,void 0),rr;(rr=0<=Gt)&&Array.prototype.splice.call(Ze,Gt,1),rr&&(Z(Y),_.g[xe].length==0&&(delete _.g[xe],_.h--))}}function ze(_,Y,xe,Ze){for(var Gt=0;Gt<_.length;++Gt){var rr=_[Gt];if(!rr.da&&rr.listener==Y&&rr.capture==!!xe&&rr.ha==Ze)return Gt}return-1}var re="closure_lm_"+(1e6*Math.random()|0),J={};function Re(_,Y,xe,Ze,Gt){if(Array.isArray(Y)){for(var rr=0;rr<Y.length;rr++)Re(_,Y[rr],xe,Ze,Gt);return null}return xe=Qt(xe),_&&_[X]?_.K(Y,xe,u(Ze)?!!Ze.capture:!1,Gt):ke(_,Y,xe,!1,Ze,Gt)}function ke(_,Y,xe,Ze,Gt,rr){if(!Y)throw Error("Invalid event type");var Lr=u(Gt)?!!Gt.capture:!!Gt,ma=Ot(_);if(ma||(_[re]=ma=new be(_)),xe=ma.add(Y,xe,Ze,Lr,rr),xe.proxy)return xe;if(Ze=Be(),xe.proxy=Ze,Ze.src=_,Ze.listener=xe,_.addEventListener)G||(Gt=Lr),Gt===void 0&&(Gt=!1),_.addEventListener(Y.toString(),Ze,Gt);else if(_.attachEvent)_.attachEvent(Ct(Y.toString()),Ze);else if(_.addListener&&_.removeListener)_.addListener(Ze);else throw Error("addEventListener and attachEvent are unavailable.");return xe}function Be(){function _(xe){return Y.call(_.src,_.listener,xe)}const Y=jt;return _}function Ye(_,Y,xe,Ze,Gt){if(Array.isArray(Y))for(var rr=0;rr<Y.length;rr++)Ye(_,Y[rr],xe,Ze,Gt);else Ze=u(Ze)?!!Ze.capture:!!Ze,xe=Qt(xe),_&&_[X]?(_=_.i,Y=String(Y).toString(),Y in _.g&&(rr=_.g[Y],xe=ze(rr,xe,Ze,Gt),-1<xe&&(Z(rr[xe]),Array.prototype.splice.call(rr,xe,1),rr.length==0&&(delete _.g[Y],_.h--)))):_&&(_=Ot(_))&&(Y=_.g[Y.toString()],_=-1,Y&&(_=ze(Y,xe,Ze,Gt)),(xe=-1<_?Y[_]:null)&&ot(xe))}function ot(_){if(typeof _!="number"&&_&&!_.da){var Y=_.src;if(Y&&Y[X])U(Y.i,_);else{var xe=_.type,Ze=_.proxy;Y.removeEventListener?Y.removeEventListener(xe,Ze,_.capture):Y.detachEvent?Y.detachEvent(Ct(xe),Ze):Y.addListener&&Y.removeListener&&Y.removeListener(Ze),(xe=Ot(Y))?(U(xe,_),xe.h==0&&(xe.src=null,Y[re]=null)):Z(_)}}}function Ct(_){return _ in J?J[_]:J[_]="on"+_}function jt(_,Y){if(_.da)_=!0;else{Y=new L(Y,this);var xe=_.listener,Ze=_.ha||_.src;_.fa&&ot(_),_=xe.call(Ze,Y)}return _}function Ot(_){return _=_[re],_ instanceof be?_:null}var Tt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Qt(_){return typeof _=="function"?_:(_[Tt]||(_[Tt]=function(Y){return _.handleEvent(Y)}),_[Tt])}function Ft(){O.call(this),this.i=new be(this),this.M=this,this.F=null}m(Ft,O),Ft.prototype[X]=!0,Ft.prototype.removeEventListener=function(_,Y,xe,Ze){Ye(this,_,Y,xe,Ze)};function Qe(_,Y){var xe,Ze=_.F;if(Ze)for(xe=[];Ze;Ze=Ze.F)xe.push(Ze);if(_=_.M,Ze=Y.type||Y,typeof Y=="string")Y=new H(Y,_);else if(Y instanceof H)Y.target=Y.target||_;else{var Gt=Y;Y=new H(Ze,_),B(Y,Gt)}if(Gt=!0,xe)for(var rr=xe.length-1;0<=rr;rr--){var Lr=Y.g=xe[rr];Gt=De(Lr,Ze,!0,Y)&&Gt}if(Lr=Y.g=_,Gt=De(Lr,Ze,!0,Y)&&Gt,Gt=De(Lr,Ze,!1,Y)&&Gt,xe)for(rr=0;rr<xe.length;rr++)Lr=Y.g=xe[rr],Gt=De(Lr,Ze,!1,Y)&&Gt}Ft.prototype.N=function(){if(Ft.aa.N.call(this),this.i){var _=this.i,Y;for(Y in _.g){for(var xe=_.g[Y],Ze=0;Ze<xe.length;Ze++)Z(xe[Ze]);delete _.g[Y],_.h--}}this.F=null},Ft.prototype.K=function(_,Y,xe,Ze){return this.i.add(String(_),Y,!1,xe,Ze)},Ft.prototype.L=function(_,Y,xe,Ze){return this.i.add(String(_),Y,!0,xe,Ze)};function De(_,Y,xe,Ze){if(Y=_.i.g[String(Y)],!Y)return!0;Y=Y.concat();for(var Gt=!0,rr=0;rr<Y.length;++rr){var Lr=Y[rr];if(Lr&&!Lr.da&&Lr.capture==xe){var ma=Lr.listener,ti=Lr.ha||Lr.src;Lr.fa&&U(_.i,Lr),Gt=ma.call(ti,Ze)!==!1&&Gt}}return Gt&&!Ze.defaultPrevented}function Je(_,Y,xe){if(typeof _=="function")xe&&(_=A(_,xe));else if(_&&typeof _.handleEvent=="function")_=A(_.handleEvent,_);else throw Error("Invalid listener argument");return 2147483647<Number(Y)?-1:l.setTimeout(_,Y||0)}function dt(_){_.g=Je(()=>{_.g=null,_.i&&(_.i=!1,dt(_))},_.l);const Y=_.h;_.h=null,_.m.apply(null,Y)}class ce extends O{constructor(Y,xe){super(),this.m=Y,this.l=xe,this.h=null,this.i=!1,this.g=null}j(Y){this.h=arguments,this.g?this.i=!0:dt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function we(_){O.call(this),this.h=_,this.g={}}m(we,O);var ue=[];function ne(_){I(_.g,function(Y,xe){this.g.hasOwnProperty(xe)&&ot(Y)},_),_.g={}}we.prototype.N=function(){we.aa.N.call(this),ne(this)},we.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ve=l.JSON.stringify,it=l.JSON.parse,vt=class{stringify(_){return l.JSON.stringify(_,void 0)}parse(_){return l.JSON.parse(_,void 0)}};function me(){}me.prototype.h=null;function Ee(_){return _.h||(_.h=_.i())}function ye(){}var We={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ge(){H.call(this,"d")}m(ge,H);function Ie(){H.call(this,"c")}m(Ie,H);var xt={},Pt=null;function It(){return Pt=Pt||new Ft}xt.La="serverreachability";function Ut(_){H.call(this,xt.La,_)}m(Ut,H);function $t(_){const Y=It();Qe(Y,new Ut(Y))}xt.STAT_EVENT="statevent";function Le(_,Y){H.call(this,xt.STAT_EVENT,_),this.stat=Y}m(Le,H);function Ce(_){const Y=It();Qe(Y,new Le(Y,_))}xt.Ma="timingevent";function pe(_,Y){H.call(this,xt.Ma,_),this.size=Y}m(pe,H);function He(_,Y){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){_()},Y)}function he(){this.g=!0}he.prototype.xa=function(){this.g=!1};function ee(_,Y,xe,Ze,Gt,rr){_.info(function(){if(_.g)if(rr)for(var Lr="",ma=rr.split("&"),ti=0;ti<ma.length;ti++){var aa=ma[ti].split("=");if(1<aa.length){var Sa=aa[0];aa=aa[1];var gs=Sa.split("_");Lr=2<=gs.length&&gs[1]=="type"?Lr+(Sa+"="+aa+"&"):Lr+(Sa+"=redacted&")}}else Lr=null;else Lr=rr;return"XMLHTTP REQ ("+Ze+") [attempt "+Gt+"]: "+Y+`
`+xe+`
`+Lr})}function _e(_,Y,xe,Ze,Gt,rr,Lr){_.info(function(){return"XMLHTTP RESP ("+Ze+") [ attempt "+Gt+"]: "+Y+`
`+xe+`
`+rr+" "+Lr})}function R(_,Y,xe,Ze){_.info(function(){return"XMLHTTP TEXT ("+Y+"): "+q(_,xe)+(Ze?" "+Ze:"")})}function V(_,Y){_.info(function(){return"TIMEOUT: "+Y})}he.prototype.info=function(){};function q(_,Y){if(!_.g)return Y;if(!Y)return null;try{var xe=JSON.parse(Y);if(xe){for(_=0;_<xe.length;_++)if(Array.isArray(xe[_])){var Ze=xe[_];if(!(2>Ze.length)){var Gt=Ze[1];if(Array.isArray(Gt)&&!(1>Gt.length)){var rr=Gt[0];if(rr!="noop"&&rr!="stop"&&rr!="close")for(var Lr=1;Lr<Gt.length;Lr++)Gt[Lr]=""}}}}return Ve(xe)}catch{return Y}}var se={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ne={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Me;function Ke(){}m(Ke,me),Ke.prototype.g=function(){return new XMLHttpRequest},Ke.prototype.i=function(){return{}},Me=new Ke;function Pe(_,Y,xe,Ze){this.j=_,this.i=Y,this.l=xe,this.R=Ze||1,this.U=new we(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new rt}function rt(){this.i=null,this.g="",this.h=!1}var lt={},ht={};function kt(_,Y,xe){_.L=1,_.v=nt(Ir(Y)),_.m=xe,_.P=!0,de(_,null)}function de(_,Y){_.F=Date.now(),st(_),_.A=Ir(_.v);var xe=_.A,Ze=_.R;Array.isArray(Ze)||(Ze=[String(Ze)]),ur(xe.i,"t",Ze),_.C=0,xe=_.j.J,_.h=new rt,_.g=xi(_.j,xe?Y:null,!_.m),0<_.O&&(_.M=new ce(A(_.Y,_,_.g),_.O)),Y=_.U,xe=_.g,Ze=_.ca;var Gt="readystatechange";Array.isArray(Gt)||(Gt&&(ue[0]=Gt.toString()),Gt=ue);for(var rr=0;rr<Gt.length;rr++){var Lr=Re(xe,Gt[rr],Ze||Y.handleEvent,!1,Y.h||Y);if(!Lr)break;Y.g[Lr.key]=Lr}Y=_.H?S(_.H):{},_.m?(_.u||(_.u="POST"),Y["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.A,_.u,_.m,Y)):(_.u="GET",_.g.ea(_.A,_.u,null,Y)),$t(),ee(_.i,_.u,_.A,_.l,_.R,_.m)}Pe.prototype.ca=function(_){_=_.target;const Y=this.M;Y&&ll(_)==3?Y.j():this.Y(_)},Pe.prototype.Y=function(_){try{if(_==this.g)e:{const gs=ll(this.g);var Y=this.g.Ba();const mu=this.g.Z();if(!(3>gs)&&(gs!=3||this.g&&(this.h.h||this.g.oa()||Au(this.g)))){this.J||gs!=4||Y==7||(Y==8||0>=mu?$t(3):$t(2)),Rt(this);var xe=this.g.Z();this.X=xe;t:if(qe(this)){var Ze=Au(this.g);_="";var Gt=Ze.length,rr=ll(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){_r(this),nr(this);var Lr="";break t}this.h.i=new l.TextDecoder}for(Y=0;Y<Gt;Y++)this.h.h=!0,_+=this.h.i.decode(Ze[Y],{stream:!(rr&&Y==Gt-1)});Ze.length=0,this.h.g+=_,this.C=0,Lr=this.h.g}else Lr=this.g.oa();if(this.o=xe==200,_e(this.i,this.u,this.A,this.l,this.R,gs,xe),this.o){if(this.T&&!this.K){t:{if(this.g){var ma,ti=this.g;if((ma=ti.g?ti.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(ma)){var aa=ma;break t}}aa=null}if(xe=aa)R(this.i,this.l,xe,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$r(this,xe);else{this.o=!1,this.s=3,Ce(12),_r(this),nr(this);break e}}if(this.P){xe=!0;let Rl;for(;!this.J&&this.C<Lr.length;)if(Rl=at(this,Lr),Rl==ht){gs==4&&(this.s=4,Ce(14),xe=!1),R(this.i,this.l,null,"[Incomplete Response]");break}else if(Rl==lt){this.s=4,Ce(15),R(this.i,this.l,Lr,"[Invalid Chunk]"),xe=!1;break}else R(this.i,this.l,Rl,null),$r(this,Rl);if(qe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gs!=4||Lr.length!=0||this.h.h||(this.s=1,Ce(16),xe=!1),this.o=this.o&&xe,!xe)R(this.i,this.l,Lr,"[Invalid Chunked Response]"),_r(this),nr(this);else if(0<Lr.length&&!this.W){this.W=!0;var Sa=this.j;Sa.g==this&&Sa.ba&&!Sa.M&&(Sa.j.info("Great, no buffering proxy detected. Bytes received: "+Lr.length),sn(Sa),Sa.M=!0,Ce(11))}}else R(this.i,this.l,Lr,null),$r(this,Lr);gs==4&&_r(this),this.o&&!this.J&&(gs==4?Vn(this.j,this):(this.o=!1,st(this)))}else qA(this.g),xe==400&&0<Lr.indexOf("Unknown SID")?(this.s=3,Ce(12)):(this.s=0,Ce(13)),_r(this),nr(this)}}}catch{}finally{}};function qe(_){return _.g?_.u=="GET"&&_.L!=2&&_.j.Ca:!1}function at(_,Y){var xe=_.C,Ze=Y.indexOf(`
`,xe);return Ze==-1?ht:(xe=Number(Y.substring(xe,Ze)),isNaN(xe)?lt:(Ze+=1,Ze+xe>Y.length?ht:(Y=Y.slice(Ze,Ze+xe),_.C=Ze+xe,Y)))}Pe.prototype.cancel=function(){this.J=!0,_r(this)};function st(_){_.S=Date.now()+_.I,Nt(_,_.I)}function Nt(_,Y){if(_.B!=null)throw Error("WatchDog timer not null");_.B=He(A(_.ba,_),Y)}function Rt(_){_.B&&(l.clearTimeout(_.B),_.B=null)}Pe.prototype.ba=function(){this.B=null;const _=Date.now();0<=_-this.S?(V(this.i,this.A),this.L!=2&&($t(),Ce(17)),_r(this),this.s=2,nr(this)):Nt(this,this.S-_)};function nr(_){_.j.G==0||_.J||Vn(_.j,_)}function _r(_){Rt(_);var Y=_.M;Y&&typeof Y.ma=="function"&&Y.ma(),_.M=null,ne(_.U),_.g&&(Y=_.g,_.g=null,Y.abort(),Y.ma())}function $r(_,Y){try{var xe=_.j;if(xe.G!=0&&(xe.g==_||Er(xe.h,_))){if(!_.K&&Er(xe.h,_)&&xe.G==3){try{var Ze=xe.Da.g.parse(Y)}catch{Ze=null}if(Array.isArray(Ze)&&Ze.length==3){var Gt=Ze;if(Gt[0]==0){e:if(!xe.u){if(xe.g)if(xe.g.F+3e3<_.F)Bn(xe),ho(xe);else break e;yr(xe),Ce(18)}}else xe.za=Gt[1],0<xe.za-xe.T&&37500>Gt[2]&&xe.F&&xe.v==0&&!xe.C&&(xe.C=He(A(xe.Za,xe),6e3));if(1>=rn(xe.h)&&xe.ca){try{xe.ca()}catch{}xe.ca=void 0}}else ka(xe,11)}else if((_.K||xe.g==_)&&Bn(xe),!y(Y))for(Gt=xe.Da.g.parse(Y),Y=0;Y<Gt.length;Y++){let aa=Gt[Y];if(xe.T=aa[0],aa=aa[1],xe.G==2)if(aa[0]=="c"){xe.K=aa[1],xe.ia=aa[2];const Sa=aa[3];Sa!=null&&(xe.la=Sa,xe.j.info("VER="+xe.la));const gs=aa[4];gs!=null&&(xe.Aa=gs,xe.j.info("SVER="+xe.Aa));const mu=aa[5];mu!=null&&typeof mu=="number"&&0<mu&&(Ze=1.5*mu,xe.L=Ze,xe.j.info("backChannelRequestTimeoutMs_="+Ze)),Ze=xe;const Rl=_.g;if(Rl){const ul=Rl.g?Rl.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ul){var rr=Ze.h;rr.g||ul.indexOf("spdy")==-1&&ul.indexOf("quic")==-1&&ul.indexOf("h2")==-1||(rr.j=rr.l,rr.g=new Set,rr.h&&(Se(rr,rr.h),rr.h=null))}if(Ze.D){const Gd=Rl.g?Rl.g.getResponseHeader("X-HTTP-Session-Id"):null;Gd&&(Ze.ya=Gd,et(Ze.I,Ze.D,Gd))}}xe.G=3,xe.l&&xe.l.ua(),xe.ba&&(xe.R=Date.now()-_.F,xe.j.info("Handshake RTT: "+xe.R+"ms")),Ze=xe;var Lr=_;if(Ze.qa=Va(Ze,Ze.J?Ze.ia:null,Ze.W),Lr.K){gt(Ze.h,Lr);var ma=Lr,ti=Ze.L;ti&&(ma.I=ti),ma.B&&(Rt(ma),st(ma)),Ze.g=Lr}else hr(Ze);0<xe.i.length&&M(xe)}else aa[0]!="stop"&&aa[0]!="close"||ka(xe,7);else xe.G==3&&(aa[0]=="stop"||aa[0]=="close"?aa[0]=="stop"?ka(xe,7):Bf(xe):aa[0]!="noop"&&xe.l&&xe.l.ta(aa),xe.v=0)}}$t(4)}catch{}}var or=class{constructor(_,Y){this.g=_,this.map=Y}};function kr(_){this.l=_||10,l.PerformanceNavigationTiming?(_=l.performance.getEntriesByType("navigation"),_=0<_.length&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function en(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function rn(_){return _.h?1:_.g?_.g.size:0}function Er(_,Y){return _.h?_.h==Y:_.g?_.g.has(Y):!1}function Se(_,Y){_.g?_.g.add(Y):_.h=Y}function gt(_,Y){_.h&&_.h==Y?_.h=null:_.g&&_.g.has(Y)&&_.g.delete(Y)}kr.prototype.cancel=function(){if(this.i=er(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function er(_){if(_.h!=null)return _.i.concat(_.h.D);if(_.g!=null&&_.g.size!==0){let Y=_.i;for(const xe of _.g.values())Y=Y.concat(xe.D);return Y}return p(_.i)}function Mr(_){if(_.V&&typeof _.V=="function")return _.V();if(typeof Map<"u"&&_ instanceof Map||typeof Set<"u"&&_ instanceof Set)return Array.from(_.values());if(typeof _=="string")return _.split("");if(c(_)){for(var Y=[],xe=_.length,Ze=0;Ze<xe;Ze++)Y.push(_[Ze]);return Y}Y=[],xe=0;for(Ze in _)Y[xe++]=_[Ze];return Y}function Or(_){if(_.na&&typeof _.na=="function")return _.na();if(!_.V||typeof _.V!="function"){if(typeof Map<"u"&&_ instanceof Map)return Array.from(_.keys());if(!(typeof Set<"u"&&_ instanceof Set)){if(c(_)||typeof _=="string"){var Y=[];_=_.length;for(var xe=0;xe<_;xe++)Y.push(xe);return Y}Y=[],xe=0;for(const Ze in _)Y[xe++]=Ze;return Y}}}function ir(_,Y){if(_.forEach&&typeof _.forEach=="function")_.forEach(Y,void 0);else if(c(_)||typeof _=="string")Array.prototype.forEach.call(_,Y,void 0);else for(var xe=Or(_),Ze=Mr(_),Gt=Ze.length,rr=0;rr<Gt;rr++)Y.call(void 0,Ze[rr],xe&&xe[rr],_)}var br=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wr(_,Y){if(_){_=_.split("&");for(var xe=0;xe<_.length;xe++){var Ze=_[xe].indexOf("="),Gt=null;if(0<=Ze){var rr=_[xe].substring(0,Ze);Gt=_[xe].substring(Ze+1)}else rr=_[xe];Y(rr,Gt?decodeURIComponent(Gt.replace(/\+/g," ")):"")}}}function Xr(_){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,_ instanceof Xr){this.h=_.h,Pr(this,_.j),this.o=_.o,this.g=_.g,fn(this,_.s),this.l=_.l;var Y=_.i,xe=new Mt;xe.i=Y.i,Y.g&&(xe.g=new Map(Y.g),xe.h=Y.h),fe(this,xe),this.m=_.m}else _&&(Y=String(_).match(br))?(this.h=!1,Pr(this,Y[1]||"",!0),this.o=ct(Y[2]||""),this.g=ct(Y[3]||"",!0),fn(this,Y[4]),this.l=ct(Y[5]||"",!0),fe(this,Y[6]||"",!0),this.m=ct(Y[7]||"")):(this.h=!1,this.i=new Mt(null,this.h))}Xr.prototype.toString=function(){var _=[],Y=this.j;Y&&_.push(ve(Y,St,!0),":");var xe=this.g;return(xe||Y=="file")&&(_.push("//"),(Y=this.o)&&_.push(ve(Y,St,!0),"@"),_.push(encodeURIComponent(String(xe)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),xe=this.s,xe!=null&&_.push(":",String(xe))),(xe=this.l)&&(this.g&&xe.charAt(0)!="/"&&_.push("/"),_.push(ve(xe,xe.charAt(0)=="/"?yt:wt,!0))),(xe=this.i.toString())&&_.push("?",xe),(xe=this.m)&&_.push("#",ve(xe,qt)),_.join("")};function Ir(_){return new Xr(_)}function Pr(_,Y,xe){_.j=xe?ct(Y,!0):Y,_.j&&(_.j=_.j.replace(/:$/,""))}function fn(_,Y){if(Y){if(Y=Number(Y),isNaN(Y)||0>Y)throw Error("Bad port number "+Y);_.s=Y}else _.s=null}function fe(_,Y,xe){Y instanceof Mt?(_.i=Y,Yr(_.i,_.h)):(xe||(Y=ve(Y,Et)),_.i=new Mt(Y,_.h))}function et(_,Y,xe){_.i.set(Y,xe)}function nt(_){return et(_,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),_}function ct(_,Y){return _?Y?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function ve(_,Y,xe){return typeof _=="string"?(_=encodeURI(_).replace(Y,ft),xe&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function ft(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var St=/[#\/\?@]/g,wt=/[#\?:]/g,yt=/[#\?]/g,Et=/[#\?@]/g,qt=/#/g;function Mt(_,Y){this.h=this.g=null,this.i=_||null,this.j=!!Y}function Yt(_){_.g||(_.g=new Map,_.h=0,_.i&&wr(_.i,function(Y,xe){_.add(decodeURIComponent(Y.replace(/\+/g," ")),xe)}))}t=Mt.prototype,t.add=function(_,Y){Yt(this),this.i=null,_=Dt(this,_);var xe=this.g.get(_);return xe||this.g.set(_,xe=[]),xe.push(Y),this.h+=1,this};function ar(_,Y){Yt(_),Y=Dt(_,Y),_.g.has(Y)&&(_.i=null,_.h-=_.g.get(Y).length,_.g.delete(Y))}function vr(_,Y){return Yt(_),Y=Dt(_,Y),_.g.has(Y)}t.forEach=function(_,Y){Yt(this),this.g.forEach(function(xe,Ze){xe.forEach(function(Gt){_.call(Y,Gt,Ze,this)},this)},this)},t.na=function(){Yt(this);const _=Array.from(this.g.values()),Y=Array.from(this.g.keys()),xe=[];for(let Ze=0;Ze<Y.length;Ze++){const Gt=_[Ze];for(let rr=0;rr<Gt.length;rr++)xe.push(Y[Ze])}return xe},t.V=function(_){Yt(this);let Y=[];if(typeof _=="string")vr(this,_)&&(Y=Y.concat(this.g.get(Dt(this,_))));else{_=Array.from(this.g.values());for(let xe=0;xe<_.length;xe++)Y=Y.concat(_[xe])}return Y},t.set=function(_,Y){return Yt(this),this.i=null,_=Dt(this,_),vr(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[Y]),this.h+=1,this},t.get=function(_,Y){return _?(_=this.V(_),0<_.length?String(_[0]):Y):Y};function ur(_,Y,xe){ar(_,Y),0<xe.length&&(_.i=null,_.g.set(Dt(_,Y),p(xe)),_.h+=xe.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],Y=Array.from(this.g.keys());for(var xe=0;xe<Y.length;xe++){var Ze=Y[xe];const rr=encodeURIComponent(String(Ze)),Lr=this.V(Ze);for(Ze=0;Ze<Lr.length;Ze++){var Gt=rr;Lr[Ze]!==""&&(Gt+="="+encodeURIComponent(String(Lr[Ze]))),_.push(Gt)}}return this.i=_.join("&")};function Dt(_,Y){return Y=String(Y),_.j&&(Y=Y.toLowerCase()),Y}function Yr(_,Y){Y&&!_.j&&(Yt(_),_.i=null,_.g.forEach(function(xe,Ze){var Gt=Ze.toLowerCase();Ze!=Gt&&(ar(this,Ze),ur(this,Gt,xe))},_)),_.j=Y}function Vr(_,Y){const xe=new he;if(l.Image){const Ze=new Image;Ze.onload=h(pr,xe,"TestLoadImage: loaded",!0,Y,Ze),Ze.onerror=h(pr,xe,"TestLoadImage: error",!1,Y,Ze),Ze.onabort=h(pr,xe,"TestLoadImage: abort",!1,Y,Ze),Ze.ontimeout=h(pr,xe,"TestLoadImage: timeout",!1,Y,Ze),l.setTimeout(function(){Ze.ontimeout&&Ze.ontimeout()},1e4),Ze.src=_}else Y(!1)}function Sr(_,Y){const xe=new he,Ze=new AbortController,Gt=setTimeout(()=>{Ze.abort(),pr(xe,"TestPingServer: timeout",!1,Y)},1e4);fetch(_,{signal:Ze.signal}).then(rr=>{clearTimeout(Gt),rr.ok?pr(xe,"TestPingServer: ok",!0,Y):pr(xe,"TestPingServer: server error",!1,Y)}).catch(()=>{clearTimeout(Gt),pr(xe,"TestPingServer: error",!1,Y)})}function pr(_,Y,xe,Ze,Gt){try{Gt&&(Gt.onload=null,Gt.onerror=null,Gt.onabort=null,Gt.ontimeout=null),Ze(xe)}catch{}}function jr(){this.g=new vt}function Tn(_,Y,xe){const Ze=xe||"";try{ir(_,function(Gt,rr){let Lr=Gt;u(Gt)&&(Lr=Ve(Gt)),Y.push(Ze+rr+"="+encodeURIComponent(Lr))})}catch(Gt){throw Y.push(Ze+"type="+encodeURIComponent("_badmap")),Gt}}function Nn(_){this.l=_.Ub||null,this.j=_.eb||!1}m(Nn,me),Nn.prototype.g=function(){return new xn(this.l,this.j)},Nn.prototype.i=function(_){return function(){return _}}({});function xn(_,Y){Ft.call(this),this.D=_,this.o=Y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(xn,Ft),t=xn.prototype,t.open=function(_,Y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=_,this.A=Y,this.readyState=1,Ji(this)},t.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const Y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};_&&(Y.body=_),(this.D||l).fetch(new Request(this.A,Y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ga(this)),this.readyState=0},t.Sa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,Ji(this)),this.g&&(this.readyState=3,Ji(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ua(this)}else _.text().then(this.Ra.bind(this),this.ga.bind(this))};function ua(_){_.j.read().then(_.Pa.bind(_)).catch(_.ga.bind(_))}t.Pa=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var Y=_.value?_.value:new Uint8Array(0);(Y=this.v.decode(Y,{stream:!_.done}))&&(this.response=this.responseText+=Y)}_.done?ga(this):Ji(this),this.readyState==3&&ua(this)}},t.Ra=function(_){this.g&&(this.response=this.responseText=_,ga(this))},t.Qa=function(_){this.g&&(this.response=_,ga(this))},t.ga=function(){this.g&&ga(this)};function ga(_){_.readyState=4,_.l=null,_.j=null,_.v=null,Ji(_)}t.setRequestHeader=function(_,Y){this.u.append(_,Y)},t.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],Y=this.h.entries();for(var xe=Y.next();!xe.done;)xe=xe.value,_.push(xe[0]+": "+xe[1]),xe=Y.next();return _.join(`\r
`)};function Ji(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(xn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function Zi(_){let Y="";return I(_,function(xe,Ze){Y+=Ze,Y+=":",Y+=xe,Y+=`\r
`}),Y}function Ol(_,Y,xe){e:{for(Ze in xe){var Ze=!1;break e}Ze=!0}Ze||(xe=Zi(xe),typeof _=="string"?xe!=null&&encodeURIComponent(String(xe)):et(_,Y,xe))}function xa(_){Ft.call(this),this.headers=new Map,this.o=_||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(xa,Ft);var Qn=/^https?$/i,hu=["POST","PUT"];t=xa.prototype,t.Ha=function(_){this.J=_},t.ea=function(_,Y,xe,Ze){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);Y=Y?Y.toUpperCase():"GET",this.D=_,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Me.g(),this.v=this.o?Ee(this.o):Ee(Me),this.g.onreadystatechange=A(this.Ea,this);try{this.B=!0,this.g.open(Y,String(_),!0),this.B=!1}catch(rr){Dl(this,rr);return}if(_=xe||"",xe=new Map(this.headers),Ze)if(Object.getPrototypeOf(Ze)===Object.prototype)for(var Gt in Ze)xe.set(Gt,Ze[Gt]);else if(typeof Ze.keys=="function"&&typeof Ze.get=="function")for(const rr of Ze.keys())xe.set(rr,Ze.get(rr));else throw Error("Unknown input type for opt_headers: "+String(Ze));Ze=Array.from(xe.keys()).find(rr=>rr.toLowerCase()=="content-type"),Gt=l.FormData&&_ instanceof l.FormData,!(0<=Array.prototype.indexOf.call(hu,Y,void 0))||Ze||Gt||xe.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[rr,Lr]of xe)this.g.setRequestHeader(rr,Lr);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{fc(this),this.u=!0,this.g.send(_),this.u=!1}catch(rr){Dl(this,rr)}};function Dl(_,Y){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=Y,_.m=5,eo(_),Uc(_)}function eo(_){_.A||(_.A=!0,Qe(_,"complete"),Qe(_,"error"))}t.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=_||7,Qe(this,"complete"),Qe(this,"abort"),Uc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Uc(this,!0)),xa.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Lc(this):this.bb())},t.bb=function(){Lc(this)};function Lc(_){if(_.h&&typeof o<"u"&&(!_.v[1]||ll(_)!=4||_.Z()!=2)){if(_.u&&ll(_)==4)Je(_.Ea,0,_);else if(Qe(_,"readystatechange"),ll(_)==4){_.h=!1;try{const Lr=_.Z();e:switch(Lr){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var Y=!0;break e;default:Y=!1}var xe;if(!(xe=Y)){var Ze;if(Ze=Lr===0){var Gt=String(_.D).match(br)[1]||null;!Gt&&l.self&&l.self.location&&(Gt=l.self.location.protocol.slice(0,-1)),Ze=!Qn.test(Gt?Gt.toLowerCase():"")}xe=Ze}if(xe)Qe(_,"complete"),Qe(_,"success");else{_.m=6;try{var rr=2<ll(_)?_.g.statusText:""}catch{rr=""}_.l=rr+" ["+_.Z()+"]",eo(_)}}finally{Uc(_)}}}}function Uc(_,Y){if(_.g){fc(_);const xe=_.g,Ze=_.v[0]?()=>{}:null;_.g=null,_.v=null,Y||Qe(_,"ready");try{xe.onreadystatechange=Ze}catch{}}}function fc(_){_.I&&(l.clearTimeout(_.I),_.I=null)}t.isActive=function(){return!!this.g};function ll(_){return _.g?_.g.readyState:0}t.Z=function(){try{return 2<ll(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(_){if(this.g){var Y=this.g.responseText;return _&&Y.indexOf(_)==0&&(Y=Y.substring(_.length)),it(Y)}};function Au(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.H){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function qA(_){const Y={};_=(_.g&&2<=ll(_)&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let Ze=0;Ze<_.length;Ze++){if(y(_[Ze]))continue;var xe=k(_[Ze]);const Gt=xe[0];if(xe=xe[1],typeof xe!="string")continue;xe=xe.trim();const rr=Y[Gt]||[];Y[Gt]=rr,rr.push(xe)}C(Y,function(Ze){return Ze.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function cl(_,Y,xe){return xe&&xe.internalChannelParams&&xe.internalChannelParams[_]||Y}function Qc(_){this.Aa=0,this.i=[],this.j=new he,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=cl("failFast",!1,_),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=cl("baseRetryDelayMs",5e3,_),this.cb=cl("retryDelaySeedMs",1e4,_),this.Wa=cl("forwardChannelMaxRetries",2,_),this.wa=cl("forwardChannelRequestTimeoutMs",2e4,_),this.pa=_&&_.xmlHttpFactory||void 0,this.Xa=_&&_.Tb||void 0,this.Ca=_&&_.useFetchStreams||!1,this.L=void 0,this.J=_&&_.supportsCrossDomainXhr||!1,this.K="",this.h=new kr(_&&_.concurrentRequestLimit),this.Da=new jr,this.P=_&&_.fastHandshake||!1,this.O=_&&_.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=_&&_.Rb||!1,_&&_.xa&&this.j.xa(),_&&_.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&_&&_.detectBufferingProxy||!1,this.ja=void 0,_&&_.longPollingTimeout&&0<_.longPollingTimeout&&(this.ja=_.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Qc.prototype,t.la=8,t.G=1,t.connect=function(_,Y,xe,Ze){Ce(0),this.W=_,this.H=Y||{},xe&&Ze!==void 0&&(this.H.OSID=xe,this.H.OAID=Ze),this.F=this.X,this.I=Va(this,null,this.W),M(this)};function Bf(_){if(Wu(_),_.G==3){var Y=_.U++,xe=Ir(_.I);if(et(xe,"SID",_.K),et(xe,"RID",Y),et(xe,"TYPE","terminate"),_t(_,xe),Y=new Pe(_,_.j,Y),Y.L=2,Y.v=nt(Ir(xe)),xe=!1,l.navigator&&l.navigator.sendBeacon)try{xe=l.navigator.sendBeacon(Y.v.toString(),"")}catch{}!xe&&l.Image&&(new Image().src=Y.v,xe=!0),xe||(Y.g=xi(Y.j,null),Y.g.ea(Y.v)),Y.F=Date.now(),st(Y)}Js(_)}function ho(_){_.g&&(sn(_),_.g.cancel(),_.g=null)}function Wu(_){ho(_),_.u&&(l.clearTimeout(_.u),_.u=null),Bn(_),_.h.cancel(),_.s&&(typeof _.s=="number"&&l.clearTimeout(_.s),_.s=null)}function M(_){if(!en(_.h)&&!_.s){_.s=!0;var Y=_.Ga;ie||Te(),Ae||(ie(),Ae=!0),te.add(Y,_),_.B=0}}function Fe(_,Y){return rn(_.h)>=_.h.j-(_.s?1:0)?!1:_.s?(_.i=Y.D.concat(_.i),!0):_.G==1||_.G==2||_.B>=(_.Va?0:_.Wa)?!1:(_.s=He(A(_.Ga,_,Y),da(_,_.B)),_.B++,!0)}t.Ga=function(_){if(this.s)if(this.s=null,this.G==1){if(!_){this.U=Math.floor(1e5*Math.random()),_=this.U++;const Gt=new Pe(this,this.j,_);let rr=this.o;if(this.S&&(rr?(rr=S(rr),B(rr,this.S)):rr=this.S),this.m!==null||this.O||(Gt.H=rr,rr=null),this.P)e:{for(var Y=0,xe=0;xe<this.i.length;xe++){t:{var Ze=this.i[xe];if("__data__"in Ze.map&&(Ze=Ze.map.__data__,typeof Ze=="string")){Ze=Ze.length;break t}Ze=void 0}if(Ze===void 0)break;if(Y+=Ze,4096<Y){Y=xe;break e}if(Y===4096||xe===this.i.length-1){Y=xe+1;break e}}Y=1e3}else Y=1e3;Y=Vt(this,Gt,Y),xe=Ir(this.I),et(xe,"RID",_),et(xe,"CVER",22),this.D&&et(xe,"X-HTTP-Session-Id",this.D),_t(this,xe),rr&&(this.O?Y="headers="+encodeURIComponent(String(Zi(rr)))+"&"+Y:this.m&&Ol(xe,this.m,rr)),Se(this.h,Gt),this.Ua&&et(xe,"TYPE","init"),this.P?(et(xe,"$req",Y),et(xe,"SID","null"),Gt.T=!0,kt(Gt,xe,null)):kt(Gt,xe,Y),this.G=2}}else this.G==3&&(_?At(this,_):this.i.length==0||en(this.h)||At(this))};function At(_,Y){var xe;Y?xe=Y.l:xe=_.U++;const Ze=Ir(_.I);et(Ze,"SID",_.K),et(Ze,"RID",xe),et(Ze,"AID",_.T),_t(_,Ze),_.m&&_.o&&Ol(Ze,_.m,_.o),xe=new Pe(_,_.j,xe,_.B+1),_.m===null&&(xe.H=_.o),Y&&(_.i=Y.D.concat(_.i)),Y=Vt(_,xe,1e3),xe.I=Math.round(.5*_.wa)+Math.round(.5*_.wa*Math.random()),Se(_.h,xe),kt(xe,Ze,Y)}function _t(_,Y){_.H&&I(_.H,function(xe,Ze){et(Y,Ze,xe)}),_.l&&ir({},function(xe,Ze){et(Y,Ze,xe)})}function Vt(_,Y,xe){xe=Math.min(_.i.length,xe);var Ze=_.l?A(_.l.Na,_.l,_):null;e:{var Gt=_.i;let rr=-1;for(;;){const Lr=["count="+xe];rr==-1?0<xe?(rr=Gt[0].g,Lr.push("ofs="+rr)):rr=0:Lr.push("ofs="+rr);let ma=!0;for(let ti=0;ti<xe;ti++){let aa=Gt[ti].g;const Sa=Gt[ti].map;if(aa-=rr,0>aa)rr=Math.max(0,Gt[ti].g-100),ma=!1;else try{Tn(Sa,Lr,"req"+aa+"_")}catch{Ze&&Ze(Sa)}}if(ma){Ze=Lr.join("&");break e}}}return _=_.i.splice(0,xe),Y.D=_,Ze}function hr(_){if(!_.g&&!_.u){_.Y=1;var Y=_.Fa;ie||Te(),Ae||(ie(),Ae=!0),te.add(Y,_),_.v=0}}function yr(_){return _.g||_.u||3<=_.v?!1:(_.Y++,_.u=He(A(_.Fa,_),da(_,_.v)),_.v++,!0)}t.Fa=function(){if(this.u=null,hn(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var _=2*this.R;this.j.info("BP detection timer enabled: "+_),this.A=He(A(this.ab,this),_)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ce(10),ho(this),hn(this))};function sn(_){_.A!=null&&(l.clearTimeout(_.A),_.A=null)}function hn(_){_.g=new Pe(_,_.j,"rpc",_.Y),_.m===null&&(_.g.H=_.o),_.g.O=0;var Y=Ir(_.qa);et(Y,"RID","rpc"),et(Y,"SID",_.K),et(Y,"AID",_.T),et(Y,"CI",_.F?"0":"1"),!_.F&&_.ja&&et(Y,"TO",_.ja),et(Y,"TYPE","xmlhttp"),_t(_,Y),_.m&&_.o&&Ol(Y,_.m,_.o),_.L&&(_.g.I=_.L);var xe=_.g;_=_.ia,xe.L=1,xe.v=nt(Ir(Y)),xe.m=null,xe.P=!0,de(xe,_)}t.Za=function(){this.C!=null&&(this.C=null,ho(this),yr(this),Ce(19))};function Bn(_){_.C!=null&&(l.clearTimeout(_.C),_.C=null)}function Vn(_,Y){var xe=null;if(_.g==Y){Bn(_),sn(_),_.g=null;var Ze=2}else if(Er(_.h,Y))xe=Y.D,gt(_.h,Y),Ze=1;else return;if(_.G!=0){if(Y.o)if(Ze==1){xe=Y.m?Y.m.length:0,Y=Date.now()-Y.F;var Gt=_.B;Ze=It(),Qe(Ze,new pe(Ze,xe)),M(_)}else hr(_);else if(Gt=Y.s,Gt==3||Gt==0&&0<Y.X||!(Ze==1&&Fe(_,Y)||Ze==2&&yr(_)))switch(xe&&0<xe.length&&(Y=_.h,Y.i=Y.i.concat(xe)),Gt){case 1:ka(_,5);break;case 4:ka(_,10);break;case 3:ka(_,6);break;default:ka(_,2)}}}function da(_,Y){let xe=_.Ta+Math.floor(Math.random()*_.cb);return _.isActive()||(xe*=2),xe*Y}function ka(_,Y){if(_.j.info("Error code "+Y),Y==2){var xe=A(_.fb,_),Ze=_.Xa;const Gt=!Ze;Ze=new Xr(Ze||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Pr(Ze,"https"),nt(Ze),Gt?Vr(Ze.toString(),xe):Sr(Ze.toString(),xe)}else Ce(2);_.G=0,_.l&&_.l.sa(Y),Js(_),Wu(_)}t.fb=function(_){_?(this.j.info("Successfully pinged google.com"),Ce(2)):(this.j.info("Failed to ping google.com"),Ce(1))};function Js(_){if(_.G=0,_.ka=[],_.l){const Y=er(_.h);(Y.length!=0||_.i.length!=0)&&(x(_.ka,Y),x(_.ka,_.i),_.h.i.length=0,p(_.i),_.i.length=0),_.l.ra()}}function Va(_,Y,xe){var Ze=xe instanceof Xr?Ir(xe):new Xr(xe);if(Ze.g!="")Y&&(Ze.g=Y+"."+Ze.g),fn(Ze,Ze.s);else{var Gt=l.location;Ze=Gt.protocol,Y=Y?Y+"."+Gt.hostname:Gt.hostname,Gt=+Gt.port;var rr=new Xr(null);Ze&&Pr(rr,Ze),Y&&(rr.g=Y),Gt&&fn(rr,Gt),xe&&(rr.l=xe),Ze=rr}return xe=_.D,Y=_.ya,xe&&Y&&et(Ze,xe,Y),et(Ze,"VER",_.la),_t(_,Ze),Ze}function xi(_,Y,xe){if(Y&&!_.J)throw Error("Can't create secondary domain capable XhrIo object.");return Y=_.Ca&&!_.pa?new xa(new Nn({eb:xe})):new xa(_.pa),Y.Ha(_.J),Y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zs(){}t=Zs.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function vi(){}vi.prototype.g=function(_,Y){return new ei(_,Y)};function ei(_,Y){Ft.call(this),this.g=new Qc(Y),this.l=_,this.h=Y&&Y.messageUrlParams||null,_=Y&&Y.messageHeaders||null,Y&&Y.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=Y&&Y.initMessageHeaders||null,Y&&Y.messageContentType&&(_?_["X-WebChannel-Content-Type"]=Y.messageContentType:_={"X-WebChannel-Content-Type":Y.messageContentType}),Y&&Y.va&&(_?_["X-WebChannel-Client-Profile"]=Y.va:_={"X-WebChannel-Client-Profile":Y.va}),this.g.S=_,(_=Y&&Y.Sb)&&!y(_)&&(this.g.m=_),this.v=Y&&Y.supportsCrossDomainXhr||!1,this.u=Y&&Y.sendRawJson||!1,(Y=Y&&Y.httpSessionIdParam)&&!y(Y)&&(this.g.D=Y,_=this.h,_!==null&&Y in _&&(_=this.h,Y in _&&delete _[Y])),this.j=new Yu(this)}m(ei,Ft),ei.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ei.prototype.close=function(){Bf(this.g)},ei.prototype.o=function(_){var Y=this.g;if(typeof _=="string"){var xe={};xe.__data__=_,_=xe}else this.u&&(xe={},xe.__data__=Ve(_),_=xe);Y.i.push(new or(Y.Ya++,_)),Y.G==3&&M(Y)},ei.prototype.N=function(){this.g.l=null,delete this.j,Bf(this.g),delete this.g,ei.aa.N.call(this)};function Vc(_){ge.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var Y=_.__sm__;if(Y){e:{for(const xe in Y){_=xe;break e}_=void 0}(this.i=_)&&(_=this.i,Y=Y!==null&&_ in Y?Y[_]:void 0),this.data=Y}else this.data=_}m(Vc,ge);function Xu(){Ie.call(this),this.status=1}m(Xu,Ie);function Yu(_){this.g=_}m(Yu,Zs),Yu.prototype.ua=function(){Qe(this.g,"a")},Yu.prototype.ta=function(_){Qe(this.g,new Vc(_))},Yu.prototype.sa=function(_){Qe(this.g,new Xu)},Yu.prototype.ra=function(){Qe(this.g,"b")},vi.prototype.createWebChannel=vi.prototype.g,ei.prototype.send=ei.prototype.o,ei.prototype.open=ei.prototype.m,ei.prototype.close=ei.prototype.close,MJ=function(){return new vi},RJ=function(){return It()},DJ=xt,KB={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},se.NO_ERROR=0,se.TIMEOUT=8,se.HTTP_ERROR=6,aE=se,Ne.COMPLETE="complete",OJ=Ne,ye.EventType=We,We.OPEN="a",We.CLOSE="b",We.ERROR="c",We.MESSAGE="d",Ft.prototype.listen=Ft.prototype.K,Ly=ye,xa.prototype.listenOnce=xa.prototype.L,xa.prototype.getLastError=xa.prototype.Ka,xa.prototype.getLastErrorCode=xa.prototype.Ba,xa.prototype.getStatus=xa.prototype.Z,xa.prototype.getResponseJson=xa.prototype.Oa,xa.prototype.getResponseText=xa.prototype.oa,xa.prototype.send=xa.prototype.ea,xa.prototype.setWithCredentials=xa.prototype.Ha,FJ=xa}).apply(typeof rC<"u"?rC:typeof self<"u"?self:typeof window<"u"?window:{});const v7="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Cl.UNAUTHENTICATED=new Cl(null),Cl.GOOGLE_CREDENTIALS=new Cl("google-credentials-uid"),Cl.FIRST_PARTY=new Cl("first-party-uid"),Cl.MOCK_USER=new Cl("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let c1="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og=new ID("@firebase/firestore");function Ex(){return og.logLevel}function Fr(t,...e){if(og.logLevel<=ha.DEBUG){const r=e.map(GD);og.debug(`Firestore (${c1}): ${t}`,...r)}}function Ec(t,...e){if(og.logLevel<=ha.ERROR){const r=e.map(GD);og.error(`Firestore (${c1}): ${t}`,...r)}}function ym(t,...e){if(og.logLevel<=ha.WARN){const r=e.map(GD);og.warn(`Firestore (${c1}): ${t}`,...r)}}function GD(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(t="Unexpected state"){const e=`FIRESTORE (${c1}) INTERNAL ASSERTION FAILED: `+t;throw Ec(e),new Error(e)}function gn(t,e){t||dn()}function Un(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Hr extends kA{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LJ{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class UJ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Cl.UNAUTHENTICATED))}shutdown(){}}class Lxe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Uxe{constructor(e){this.t=e,this.currentUser=Cl.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){gn(this.o===void 0);let n=this.i;const a=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let s=new gf;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new gf,e.enqueueRetryable(()=>a(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await a(this.currentUser)})},l=c=>{Fr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Fr("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new gf)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Fr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(gn(typeof n.accessToken=="string"),new LJ(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return gn(e===null||typeof e=="string"),new Cl(e)}}class Qxe{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Cl.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Vxe{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Qxe(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Cl.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Hxe{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $xe{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){gn(this.o===void 0);const n=s=>{s.error!=null&&Fr("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Fr("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const a=s=>{Fr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>a(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?a(s):Fr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(gn(typeof r.token=="string"),this.R=r.token,new Hxe(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gxe(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const a=Gxe(40);for(let s=0;s<a.length;++s)n.length<20&&a[s]<r&&(n+=e.charAt(a[s]%e.length))}return n}}function qn(t,e){return t<e?-1:t>e?1:0}function Bv(t,e,r){return t.length===e.length&&t.every((n,a)=>r(n,e[a]))}function QJ(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Hr(fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Hr(fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Hr(fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Hr(fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return xr.fromMillis(Date.now())}static fromDate(e){return xr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new xr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?qn(this.nanoseconds,e.nanoseconds):qn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Cn(e)}static min(){return new Cn(new xr(0,0))}static max(){return new Cn(new xr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(e,r,n){r===void 0?r=0:r>e.length&&dn(),n===void 0?n=e.length-r:n>e.length-r&&dn(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return f2.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof f2?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const s=e.get(a),o=r.get(a);if(s<o)return-1;if(s>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Pa extends f2{construct(e,r,n){return new Pa(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Hr(fr.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(a=>a.length>0))}return new Pa(r)}static emptyPath(){return new Pa([])}}const Kxe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Gs extends f2{construct(e,r,n){return new Gs(e,r,n)}static isValidIdentifier(e){return Kxe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Gs.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Gs(["__name__"])}static fromServerFormat(e){const r=[];let n="",a=0;const s=()=>{if(n.length===0)throw new Hr(fr.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;a<e.length;){const l=e[a];if(l==="\\"){if(a+1===e.length)throw new Hr(fr.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[a+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Hr(fr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,a+=2}else l==="`"?(o=!o,a++):l!=="."||o?(n+=l,a++):(s(),a++)}if(s(),o)throw new Hr(fr.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Gs(r)}static emptyPath(){return new Gs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr{constructor(e){this.path=e}static fromPath(e){return new Jr(Pa.fromString(e))}static fromName(e){return new Jr(Pa.fromString(e).popFirst(5))}static empty(){return new Jr(Pa.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pa.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Pa.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Jr(new Pa(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{constructor(e,r,n,a){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=a}}function qB(t){return t.fields.find(e=>e.kind===2)}function dp(t){return t.fields.filter(e=>e.kind!==2)}oS.UNKNOWN_ID=-1;class sE{constructor(e,r){this.fieldPath=e,this.kind=r}}class h2{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new h2(0,Vu.min())}}function qxe(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=Cn.fromTimestamp(n===1e9?new xr(r+1,0):new xr(r,n));return new Vu(a,Jr.empty(),e)}function VJ(t){return new Vu(t.readTime,t.key,-1)}class Vu{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Vu(Cn.min(),Jr.empty(),-1)}static max(){return new Vu(Cn.max(),Jr.empty(),-1)}}function qD(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Jr.comparator(t.documentKey,e.documentKey),r!==0?r:qn(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HJ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $J{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kg(t){if(t.code!==fr.FAILED_PRECONDITION||t.message!==HJ)throw t;Fr("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&dn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Zt((n,a)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,a)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,a)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Zt?r:Zt.resolve(r)}catch(r){return Zt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Zt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Zt.reject(r)}static resolve(e){return new Zt((r,n)=>{r(e)})}static reject(e){return new Zt((r,n)=>{n(e)})}static waitFor(e){return new Zt((r,n)=>{let a=0,s=0,o=!1;e.forEach(l=>{++a,l.next(()=>{++s,o&&s===a&&r()},c=>n(c))}),o=!0,s===a&&r()})}static or(e){let r=Zt.resolve(!1);for(const n of e)r=r.next(a=>a?Zt.resolve(a):n());return r}static forEach(e,r){const n=[];return e.forEach((a,s)=>{n.push(r.call(this,a,s))}),this.waitFor(n)}static mapArray(e,r){return new Zt((n,a)=>{const s=e.length,o=new Array(s);let l=0;for(let c=0;c<s;c++){const u=c;r(e[u]).next(d=>{o[u]=d,++l,l===s&&n(o)},d=>a(d))}})}static doWhile(e,r){return new Zt((n,a)=>{const s=()=>{e()===!0?r().next(()=>{s()},a):n()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nj{constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.V=new gf,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{r.error?this.V.reject(new mb(e,r.error)):this.V.resolve()},this.transaction.onerror=n=>{const a=zD(n.target.error);this.V.reject(new mb(e,a))}}static open(e,r,n,a){try{return new Nj(r,e.transaction(a,n))}catch(s){throw new mb(r,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Fr("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new Wxe(r)}}class dm{constructor(e,r,n){this.name=e,this.version=r,this.p=n,dm.S(Oo())===12.2&&Ec("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Fr("SimpleDb","Removing database:",e),xp(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!zY())return!1;if(dm.v())return!0;const e=Oo(),r=dm.S(e),n=0<r&&r<10,a=GJ(e),s=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,r){return e.store(r)}static S(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(Fr("SimpleDb","Opening database:",this.name),this.db=await new Promise((r,n)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=s=>{const o=s.target.result;r(o)},a.onblocked=()=>{n(new mb(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=s=>{const o=s.target.error;o.name==="VersionError"?n(new Hr(fr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new Hr(fr.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new mb(e,o))},a.onupgradeneeded=s=>{Fr("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,a.transaction,s.oldVersion,this.version).next(()=>{Fr("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=r=>this.N(r)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,n,a){const s=r==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=Nj.open(this.db,e,s?"readonly":"readwrite",n),c=a(l).next(u=>(l.g(),u)).catch(u=>(l.abort(u),Zt.reject(u))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(Fr("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function GJ(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class zxe{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return xp(this.B.delete())}}class mb extends Hr{constructor(e,r){super(fr.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function Um(t){return t.name==="IndexedDbTransactionError"}class Wxe{constructor(e){this.store=e}put(e,r){let n;return r!==void 0?(Fr("SimpleDb","PUT",this.store.name,e,r),n=this.store.put(r,e)):(Fr("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),xp(n)}add(e){return Fr("SimpleDb","ADD",this.store.name,e,e),xp(this.store.add(e))}get(e){return xp(this.store.get(e)).next(r=>(r===void 0&&(r=null),Fr("SimpleDb","GET",this.store.name,e,r),r))}delete(e){return Fr("SimpleDb","DELETE",this.store.name,e),xp(this.store.delete(e))}count(){return Fr("SimpleDb","COUNT",this.store.name),xp(this.store.count())}U(e,r){const n=this.options(e,r),a=n.index?this.store.index(n.index):this.store;if(typeof a.getAll=="function"){const s=a.getAll(n.range);return new Zt((o,l)=>{s.onerror=c=>{l(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{const s=this.cursor(n),o=[];return this.W(s,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,r){const n=this.store.getAll(e,r===null?void 0:r);return new Zt((a,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{a(o.target.result)}})}j(e,r){Fr("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,r);n.H=!1;const a=this.cursor(n);return this.W(a,(s,o,l)=>l.delete())}J(e,r){let n;r?n=e:(n={},r=e);const a=this.cursor(n);return this.W(a,r)}Y(e){const r=this.cursor({});return new Zt((n,a)=>{r.onerror=s=>{const o=zD(s.target.error);a(o)},r.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():n()}):n()}})}W(e,r){const n=[];return new Zt((a,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void a();const c=new zxe(l),u=r(l.primaryKey,l.value,c);if(u instanceof Zt){const d=u.catch(f=>(c.done(),Zt.reject(f)));n.push(d)}c.isDone?a():c.K===null?l.continue():l.continue(c.K)}}).next(()=>Zt.waitFor(n))}options(e,r){let n;return e!==void 0&&(typeof e=="string"?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function xp(t){return new Zt((e,r)=>{t.onsuccess=n=>{const a=n.target.result;e(a)},t.onerror=n=>{const a=zD(n.target.error);r(a)}})}let y7=!1;function zD(t){const e=dm.S(Oo());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const n=new Hr("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return y7||(y7=!0,setTimeout(()=>{throw n},0)),n}}return t}class Xxe{constructor(e,r){this.asyncQueue=e,this.Z=r,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){Fr("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Fr("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(r){Um(r)?Fr("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",r):await kg(r)}await this.X(6e4)})}}class Yxe{constructor(e,r){this.localStore=e,this.persistence=r}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.te(r,e))}te(e,r){const n=new Set;let a=r,s=!0;return Zt.doWhile(()=>s===!0&&a>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return Fr("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,a).next(l=>{a-=l,n.add(o)});s=!1})).next(()=>r-a)}ne(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next(a=>this.localStore.localDocuments.getNextDocuments(e,r,a,n).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(a,s)).next(l=>(Fr("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,r,l))).next(()=>o.size)}))}re(e,r){let n=e;return r.changes.forEach((a,s)=>{const o=VJ(s);qD(o,n)>0&&(n=o)}),new Vu(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Nd.oe=-1;function Ew(t){return t==null}function A2(t){return t===0&&1/t==-1/0}function Jxe(t){return typeof t=="number"&&Number.isInteger(t)&&!A2(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tc(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=b7(e)),e=Zxe(t.get(r),e);return b7(e)}function Zxe(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const s=t.charAt(a);switch(s){case"\0":r+="";break;case"":r+="";break;default:r+=s}}return r}function b7(t){return t+""}function Yf(t){const e=t.length;if(gn(e>=2),e===2)return gn(t.charAt(0)===""&&t.charAt(1)===""),Pa.emptyPath();const r=e-2,n=[];let a="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>r)&&dn(),t.charAt(o+1)){case"":const l=t.substring(s,o);let c;a.length===0?c=l:(a+=l,c=a,a=""),n.push(c);break;case"":a+=t.substring(s,o),a+="\0";break;case"":a+=t.substring(s,o+1);break;default:dn()}s=o+2}return new Pa(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w7=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(t,e){return[t,Tc(e)]}function KJ(t,e,r){return[t,Tc(e),r]}const eve={},tve=["prefixPath","collectionGroup","readTime","documentId"],rve=["prefixPath","collectionGroup","documentId"],nve=["collectionGroup","readTime","prefixPath","documentId"],ave=["canonicalId","targetId"],sve=["targetId","path"],ive=["path","targetId"],ove=["collectionId","parent"],lve=["indexId","uid"],cve=["uid","sequenceNumber"],uve=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],dve=["indexId","uid","orderedDocumentKey"],fve=["userId","collectionPath","documentId"],hve=["userId","collectionPath","largestBatchId"],Ave=["userId","collectionGroup","largestBatchId"],qJ=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],mve=[...qJ,"documentOverlays"],zJ=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],WJ=zJ,WD=[...WJ,"indexConfiguration","indexState","indexEntries"],pve=WD,gve=[...WD,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zB extends $J{constructor(e,r){super(),this._e=e,this.currentSequenceNumber=r}}function Ro(t,e){const r=Un(t);return dm.F(r._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N7(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Fg(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function XJ(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e,r){this.comparator=e,this.root=r||_l.EMPTY}insert(e,r){return new Xs(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,_l.BLACK,null,null))}remove(e){return new Xs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_l.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nC(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nC(this.root,e,this.comparator,!1)}getReverseIterator(){return new nC(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nC(this.root,e,this.comparator,!0)}}class nC{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&a&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _l{constructor(e,r,n,a,s){this.key=e,this.value=r,this.color=n??_l.RED,this.left=a??_l.EMPTY,this.right=s??_l.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,s){return new _l(e??this.key,r??this.value,n??this.color,a??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const s=n(e,a.key);return a=s<0?a.copy(null,null,null,a.left.insert(e,r,n),null):s===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return _l.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return _l.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_l.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_l.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw dn();const e=this.left.check();if(e!==this.right.check())throw dn();return e+(this.isRed()?0:1)}}_l.EMPTY=null,_l.RED=!0,_l.BLACK=!1;_l.EMPTY=new class{constructor(){this.size=0}get key(){throw dn()}get value(){throw dn()}get color(){throw dn()}get left(){throw dn()}get right(){throw dn()}copy(e,r,n,a,s){return this}insert(e,r,n){return new _l(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e){this.comparator=e,this.data=new Xs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new C7(this.data.getIterator())}getIteratorFrom(e){return new C7(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof us)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(this.comparator(a,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new us(this.comparator);return r.data=e,r}}class C7{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function tx(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e){this.fields=e,e.sort(Gs.comparator)}static empty(){return new nu([])}unionWith(e){let r=new us(Gs.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new nu(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Bv(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YJ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(a){try{return atob(a)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new YJ("Invalid base64 string: "+s):s}}(e);return new Xi(r)}static fromUint8Array(e){const r=function(a){let s="";for(let o=0;o<a.length;++o)s+=String.fromCharCode(a[o]);return s}(e);return new Xi(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xi.EMPTY_BYTE_STRING=new Xi("");const xve=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vA(t){if(gn(!!t),typeof t=="string"){let e=0;const r=xve.exec(t);if(gn(!!r),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Vs(t.seconds),nanos:Vs(t.nanos)}}function Vs(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function bm(t){return typeof t=="string"?Xi.fromBase64String(t):Xi.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XD(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function YD(t){const e=t.mapValue.fields.__previous_value__;return XD(e)?YD(e):e}function m2(t){const e=vA(t.mapValue.fields.__local_write_time__.timestampValue);return new xr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vve{constructor(e,r,n,a,s,o,l,c,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class wm{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new wm("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof wm&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K0={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},oE={nullValue:"NULL_VALUE"};function lg(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?XD(t)?4:JJ(t)?9007199254740991:Cj(t)?10:11:dn()}function lh(t,e){if(t===e)return!0;const r=lg(t);if(r!==lg(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return m2(t).isEqual(m2(e));case 3:return function(a,s){if(typeof a.timestampValue=="string"&&typeof s.timestampValue=="string"&&a.timestampValue.length===s.timestampValue.length)return a.timestampValue===s.timestampValue;const o=vA(a.timestampValue),l=vA(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,s){return bm(a.bytesValue).isEqual(bm(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,s){return Vs(a.geoPointValue.latitude)===Vs(s.geoPointValue.latitude)&&Vs(a.geoPointValue.longitude)===Vs(s.geoPointValue.longitude)}(t,e);case 2:return function(a,s){if("integerValue"in a&&"integerValue"in s)return Vs(a.integerValue)===Vs(s.integerValue);if("doubleValue"in a&&"doubleValue"in s){const o=Vs(a.doubleValue),l=Vs(s.doubleValue);return o===l?A2(o)===A2(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Bv(t.arrayValue.values||[],e.arrayValue.values||[],lh);case 10:case 11:return function(a,s){const o=a.mapValue.fields||{},l=s.mapValue.fields||{};if(N7(o)!==N7(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!lh(o[c],l[c])))return!1;return!0}(t,e);default:return dn()}}function p2(t,e){return(t.values||[]).find(r=>lh(r,e))!==void 0}function Nm(t,e){if(t===e)return 0;const r=lg(t),n=lg(e);if(r!==n)return qn(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return qn(t.booleanValue,e.booleanValue);case 2:return function(s,o){const l=Vs(s.integerValue||s.doubleValue),c=Vs(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return _7(t.timestampValue,e.timestampValue);case 4:return _7(m2(t),m2(e));case 5:return qn(t.stringValue,e.stringValue);case 6:return function(s,o){const l=bm(s),c=bm(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=qn(l[u],c[u]);if(d!==0)return d}return qn(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const l=qn(Vs(s.latitude),Vs(o.latitude));return l!==0?l:qn(Vs(s.longitude),Vs(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return E7(t.arrayValue,e.arrayValue);case 10:return function(s,o){var l,c,u,d;const f=s.fields||{},A=o.fields||{},h=(l=f.value)===null||l===void 0?void 0:l.arrayValue,m=(c=A.value)===null||c===void 0?void 0:c.arrayValue,p=qn(((u=h==null?void 0:h.values)===null||u===void 0?void 0:u.length)||0,((d=m==null?void 0:m.values)===null||d===void 0?void 0:d.length)||0);return p!==0?p:E7(h,m)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===K0.mapValue&&o===K0.mapValue)return 0;if(s===K0.mapValue)return 1;if(o===K0.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){const A=qn(c[f],d[f]);if(A!==0)return A;const h=Nm(l[c[f]],u[d[f]]);if(h!==0)return h}return qn(c.length,d.length)}(t.mapValue,e.mapValue);default:throw dn()}}function _7(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return qn(t,e);const r=vA(t),n=vA(e),a=qn(r.seconds,n.seconds);return a!==0?a:qn(r.nanos,n.nanos)}function E7(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const s=Nm(r[a],n[a]);if(s)return s}return qn(r.length,n.length)}function kv(t){return WB(t)}function WB(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=vA(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return bm(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Jr.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",a=!0;for(const s of r.values||[])a?a=!1:n+=",",n+=WB(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let a="{",s=!0;for(const o of n)s?s=!1:a+=",",a+=`${o}:${WB(r.fields[o])}`;return a+"}"}(t.mapValue):dn()}function g2(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function XB(t){return!!t&&"integerValue"in t}function x2(t){return!!t&&"arrayValue"in t}function S7(t){return!!t&&"nullValue"in t}function I7(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function lE(t){return!!t&&"mapValue"in t}function Cj(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function pb(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Fg(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=pb(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=pb(t.arrayValue.values[r]);return e}return Object.assign({},t)}function JJ(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const ZJ={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function yve(t){return"nullValue"in t?oE:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?g2(wm.empty(),Jr.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Cj(t)?ZJ:{mapValue:{}}:dn()}function bve(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?g2(wm.empty(),Jr.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?ZJ:"mapValue"in t?Cj(t)?{mapValue:{}}:K0:dn()}function j7(t,e){const r=Nm(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function P7(t,e){const r=Nm(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e){this.value=e}static empty(){return new Sl({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!lE(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=pb(r)}setAll(e){let r=Gs.emptyPath(),n={},a=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,a),n={},a=[],r=l.popLast()}o?n[l.lastSegment()]=pb(o):a.push(l.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,a)}delete(e){const r=this.field(e.popLast());lE(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return lh(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];lE(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){Fg(r,(a,s)=>e[a]=s);for(const a of n)delete e[a]}clone(){return new Sl(pb(this.value))}}function eZ(t){const e=[];return Fg(t.fields,(r,n)=>{const a=new Gs([r]);if(lE(n)){const s=eZ(n.mapValue).fields;if(s.length===0)e.push(a);else for(const o of s)e.push(a.child(o))}else e.push(a)}),new nu(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e,r,n,a,s,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new $s(e,0,Cn.min(),Cn.min(),Cn.min(),Sl.empty(),0)}static newFoundDocument(e,r,n,a){return new $s(e,1,r,Cn.min(),n,a,0)}static newNoDocument(e,r){return new $s(e,2,r,Cn.min(),Cn.min(),Sl.empty(),0)}static newUnknownDocument(e,r){return new $s(e,3,r,Cn.min(),Cn.min(),Sl.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Cn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Sl.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Sl.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Cn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof $s&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $s(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e,r){this.position=e,this.inclusive=r}}function T7(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const s=e[a],o=t.position[a];if(s.field.isKeyField()?n=Jr.comparator(Jr.fromName(o.referenceValue),r.key):n=Nm(o,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function B7(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!lh(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{constructor(e,r="asc"){this.field=e,this.dir=r}}function wve(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tZ{}class Aa extends tZ{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Nve(e,r,n):r==="array-contains"?new Eve(e,n):r==="in"?new oZ(e,n):r==="not-in"?new Sve(e,n):r==="array-contains-any"?new Ive(e,n):new Aa(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new Cve(e,n):new _ve(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Nm(r,this.value)):r!==null&&lg(this.value)===lg(r)&&this.matchesComparison(Nm(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return dn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ts extends tZ{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new ts(e,r)}matches(e){return Ov(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ov(t){return t.op==="and"}function YB(t){return t.op==="or"}function JD(t){return rZ(t)&&Ov(t)}function rZ(t){for(const e of t.filters)if(e instanceof ts)return!1;return!0}function JB(t){if(t instanceof Aa)return t.field.canonicalString()+t.op.toString()+kv(t.value);if(JD(t))return t.filters.map(e=>JB(e)).join(",");{const e=t.filters.map(r=>JB(r)).join(",");return`${t.op}(${e})`}}function nZ(t,e){return t instanceof Aa?function(n,a){return a instanceof Aa&&n.op===a.op&&n.field.isEqual(a.field)&&lh(n.value,a.value)}(t,e):t instanceof ts?function(n,a){return a instanceof ts&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce((s,o,l)=>s&&nZ(o,a.filters[l]),!0):!1}(t,e):void dn()}function aZ(t,e){const r=t.filters.concat(e);return ts.create(r,t.op)}function sZ(t){return t instanceof Aa?function(r){return`${r.field.canonicalString()} ${r.op} ${kv(r.value)}`}(t):t instanceof ts?function(r){return r.op.toString()+" {"+r.getFilters().map(sZ).join(" ,")+"}"}(t):"Filter"}class Nve extends Aa{constructor(e,r,n){super(e,r,n),this.key=Jr.fromName(n.referenceValue)}matches(e){const r=Jr.comparator(e.key,this.key);return this.matchesComparison(r)}}class Cve extends Aa{constructor(e,r){super(e,"in",r),this.keys=iZ("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class _ve extends Aa{constructor(e,r){super(e,"not-in",r),this.keys=iZ("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function iZ(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Jr.fromName(n.referenceValue))}class Eve extends Aa{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return x2(r)&&p2(r.arrayValue,this.value)}}class oZ extends Aa{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&p2(this.value.arrayValue,r)}}class Sve extends Aa{constructor(e,r){super(e,"not-in",r)}matches(e){if(p2(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!p2(this.value.arrayValue,r)}}class Ive extends Aa{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!x2(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>p2(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jve{constructor(e,r=null,n=[],a=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function ZB(t,e=null,r=[],n=[],a=null,s=null,o=null){return new jve(t,e,r,n,a,s,o)}function cg(t){const e=Un(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>JB(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Ew(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>kv(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>kv(n)).join(",")),e.ue=r}return e.ue}function Sw(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!wve(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!nZ(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!B7(t.startAt,e.startAt)&&B7(t.endAt,e.endAt)}function lS(t){return Jr.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function cS(t,e){return t.filters.filter(r=>r instanceof Aa&&r.field.isEqual(e))}function k7(t,e,r){let n=oE,a=!0;for(const s of cS(t,e)){let o=oE,l=!0;switch(s.op){case"<":case"<=":o=yve(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=oE}j7({value:n,inclusive:a},{value:o,inclusive:l})<0&&(n=o,a=l)}if(r!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=r.position[s];j7({value:n,inclusive:a},{value:o,inclusive:r.inclusive})<0&&(n=o,a=r.inclusive);break}}return{value:n,inclusive:a}}function F7(t,e,r){let n=K0,a=!0;for(const s of cS(t,e)){let o=K0,l=!0;switch(s.op){case">=":case">":o=bve(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=K0}P7({value:n,inclusive:a},{value:o,inclusive:l})>0&&(n=o,a=l)}if(r!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=r.position[s];P7({value:n,inclusive:a},{value:o,inclusive:r.inclusive})>0&&(n=o,a=r.inclusive);break}}return{value:n,inclusive:a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(e,r=null,n=[],a=[],s=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Pve(t,e,r,n,a,s,o,l){return new u1(t,e,r,n,a,s,o,l)}function Iw(t){return new u1(t)}function O7(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function lZ(t){return t.collectionGroup!==null}function gb(t){const e=Un(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new us(Gs.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new v2(s,n))}),r.has(Gs.keyField().canonicalString())||e.ce.push(new v2(Gs.keyField(),n))}return e.ce}function jd(t){const e=Un(t);return e.le||(e.le=Tve(e,gb(t))),e.le}function Tve(t,e){if(t.limitType==="F")return ZB(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const s=a.dir==="desc"?"asc":"desc";return new v2(a.field,s)});const r=t.endAt?new Fv(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Fv(t.startAt.position,t.startAt.inclusive):null;return ZB(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function ek(t,e){const r=t.filters.concat([e]);return new u1(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function uS(t,e,r){return new u1(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function _j(t,e){return Sw(jd(t),jd(e))&&t.limitType===e.limitType}function cZ(t){return`${cg(jd(t))}|lt:${t.limitType}`}function Sx(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(a=>sZ(a)).join(", ")}]`),Ew(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(a=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(a)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(a=>kv(a)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(a=>kv(a)).join(",")),`Target(${n})`}(jd(t))}; limitType=${t.limitType})`}function jw(t,e){return e.isFoundDocument()&&function(n,a){const s=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Jr.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,a){for(const s of gb(n))if(!s.field.isKeyField()&&a.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,a){for(const s of n.filters)if(!s.matches(a))return!1;return!0}(t,e)&&function(n,a){return!(n.startAt&&!function(o,l,c){const u=T7(o,l,c);return o.inclusive?u<=0:u<0}(n.startAt,gb(n),a)||n.endAt&&!function(o,l,c){const u=T7(o,l,c);return o.inclusive?u>=0:u>0}(n.endAt,gb(n),a))}(t,e)}function Bve(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function uZ(t){return(e,r)=>{let n=!1;for(const a of gb(t)){const s=kve(a,e,r);if(s!==0)return s;n=n||a.field.isKeyField()}return 0}}function kve(t,e,r){const n=t.field.isKeyField()?Jr.comparator(e.key,r.key):function(s,o,l){const c=o.data.field(s),u=l.data.field(s);return c!==null&&u!==null?Nm(c,u):dn()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return dn()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,s]of n)if(this.equalsFn(a,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<a.length;s++)if(this.equalsFn(a[s][0],e))return void(a[s]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Fg(this.inner,(r,n)=>{for(const[a,s]of n)e(a,s)})}isEmpty(){return XJ(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fve=new Xs(Jr.comparator);function Ou(){return Fve}const dZ=new Xs(Jr.comparator);function Uy(...t){let e=dZ;for(const r of t)e=e.insert(r.key,r);return e}function fZ(t){let e=dZ;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Jf(){return xb()}function hZ(){return xb()}function xb(){return new Qm(t=>t.toString(),(t,e)=>t.isEqual(e))}const Ove=new Xs(Jr.comparator),Dve=new us(Jr.comparator);function na(...t){let e=Dve;for(const r of t)e=e.add(r);return e}const Rve=new us(qn);function Mve(){return Rve}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZD(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:A2(e)?"-0":e}}function AZ(t){return{integerValue:""+t}}function Lve(t,e){return Jxe(e)?AZ(e):ZD(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(){this._=void 0}}function Uve(t,e,r){return t instanceof y2?function(a,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return s&&XD(s)&&(s=YD(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(r,e):t instanceof ug?pZ(t,e):t instanceof Dv?gZ(t,e):function(a,s){const o=mZ(a,s),l=D7(o)+D7(a.Pe);return XB(o)&&XB(a.Pe)?AZ(l):ZD(a.serializer,l)}(t,e)}function Qve(t,e,r){return t instanceof ug?pZ(t,e):t instanceof Dv?gZ(t,e):r}function mZ(t,e){return t instanceof b2?function(n){return XB(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class y2 extends Ej{}class ug extends Ej{constructor(e){super(),this.elements=e}}function pZ(t,e){const r=xZ(e);for(const n of t.elements)r.some(a=>lh(a,n))||r.push(n);return{arrayValue:{values:r}}}class Dv extends Ej{constructor(e){super(),this.elements=e}}function gZ(t,e){let r=xZ(e);for(const n of t.elements)r=r.filter(a=>!lh(a,n));return{arrayValue:{values:r}}}class b2 extends Ej{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function D7(t){return Vs(t.integerValue||t.doubleValue)}function xZ(t){return x2(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vZ{constructor(e,r){this.field=e,this.transform=r}}function Vve(t,e){return t.field.isEqual(e.field)&&function(n,a){return n instanceof ug&&a instanceof ug||n instanceof Dv&&a instanceof Dv?Bv(n.elements,a.elements,lh):n instanceof b2&&a instanceof b2?lh(n.Pe,a.Pe):n instanceof y2&&a instanceof y2}(t.transform,e.transform)}class Hve{constructor(e,r){this.version=e,this.transformResults=r}}class Ks{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Ks}static exists(e){return new Ks(void 0,e)}static updateTime(e){return new Ks(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function cE(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Sj{}function yZ(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new f1(t.key,Ks.none()):new d1(t.key,t.data,Ks.none());{const r=t.data,n=Sl.empty();let a=new us(Gs.comparator);for(let s of e.fields)if(!a.has(s)){let o=r.field(s);o===null&&s.length>1&&(s=s.popLast(),o=r.field(s)),o===null?n.delete(s):n.set(s,o),a=a.add(s)}return new DA(t.key,n,new nu(a.toArray()),Ks.none())}}function $ve(t,e,r){t instanceof d1?function(a,s,o){const l=a.value.clone(),c=M7(a.fieldTransforms,s,o.transformResults);l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof DA?function(a,s,o){if(!cE(a.precondition,s))return void s.convertToUnknownDocument(o.version);const l=M7(a.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(bZ(a)),c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):function(a,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function vb(t,e,r,n){return t instanceof d1?function(s,o,l,c){if(!cE(s.precondition,o))return l;const u=s.value.clone(),d=L7(s.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof DA?function(s,o,l,c){if(!cE(s.precondition,o))return l;const u=L7(s.fieldTransforms,c,o),d=o.data;return d.setAll(bZ(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(s,o,l){return cE(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function Gve(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),s=mZ(n.transform,a||null);s!=null&&(r===null&&(r=Sl.empty()),r.set(n.field,s))}return r||null}function R7(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&Bv(n,a,(s,o)=>Vve(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class d1 extends Sj{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class DA extends Sj{constructor(e,r,n,a,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function bZ(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function M7(t,e,r){const n=new Map;gn(t.length===r.length);for(let a=0;a<r.length;a++){const s=t[a],o=s.transform,l=e.data.field(s.field);n.set(s.field,Qve(o,l,r[a]))}return n}function L7(t,e,r){const n=new Map;for(const a of t){const s=a.transform,o=r.data.field(a.field);n.set(a.field,Uve(s,o,e))}return n}class f1 extends Sj{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class e6 extends Sj{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const s=this.mutations[a];s.key.isEqual(e.key)&&$ve(s,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=vb(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=vb(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=hZ();return this.mutations.forEach(a=>{const s=e.get(a.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=r.has(a.key)?null:l;const c=yZ(o,l);c!==null&&n.set(a.key,c),o.isValidDocument()||o.convertToNoDocument(Cn.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),na())}isEqual(e){return this.batchId===e.batchId&&Bv(this.mutations,e.mutations,(r,n)=>R7(r,n))&&Bv(this.baseMutations,e.baseMutations,(r,n)=>R7(r,n))}}class r6{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){gn(e.mutations.length===n.length);let a=function(){return Ove}();const s=e.mutations;for(let o=0;o<s.length;o++)a=a.insert(s[o].key,n[o].version);return new r6(e,r,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n6{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kve{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ro,ya;function wZ(t){switch(t){default:return dn();case fr.CANCELLED:case fr.UNKNOWN:case fr.DEADLINE_EXCEEDED:case fr.RESOURCE_EXHAUSTED:case fr.INTERNAL:case fr.UNAVAILABLE:case fr.UNAUTHENTICATED:return!1;case fr.INVALID_ARGUMENT:case fr.NOT_FOUND:case fr.ALREADY_EXISTS:case fr.PERMISSION_DENIED:case fr.FAILED_PRECONDITION:case fr.ABORTED:case fr.OUT_OF_RANGE:case fr.UNIMPLEMENTED:case fr.DATA_LOSS:return!0}}function NZ(t){if(t===void 0)return Ec("GRPC error has no .code"),fr.UNKNOWN;switch(t){case ro.OK:return fr.OK;case ro.CANCELLED:return fr.CANCELLED;case ro.UNKNOWN:return fr.UNKNOWN;case ro.DEADLINE_EXCEEDED:return fr.DEADLINE_EXCEEDED;case ro.RESOURCE_EXHAUSTED:return fr.RESOURCE_EXHAUSTED;case ro.INTERNAL:return fr.INTERNAL;case ro.UNAVAILABLE:return fr.UNAVAILABLE;case ro.UNAUTHENTICATED:return fr.UNAUTHENTICATED;case ro.INVALID_ARGUMENT:return fr.INVALID_ARGUMENT;case ro.NOT_FOUND:return fr.NOT_FOUND;case ro.ALREADY_EXISTS:return fr.ALREADY_EXISTS;case ro.PERMISSION_DENIED:return fr.PERMISSION_DENIED;case ro.FAILED_PRECONDITION:return fr.FAILED_PRECONDITION;case ro.ABORTED:return fr.ABORTED;case ro.OUT_OF_RANGE:return fr.OUT_OF_RANGE;case ro.UNIMPLEMENTED:return fr.UNIMPLEMENTED;case ro.DATA_LOSS:return fr.DATA_LOSS;default:return dn()}}(ya=ro||(ro={}))[ya.OK=0]="OK",ya[ya.CANCELLED=1]="CANCELLED",ya[ya.UNKNOWN=2]="UNKNOWN",ya[ya.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ya[ya.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ya[ya.NOT_FOUND=5]="NOT_FOUND",ya[ya.ALREADY_EXISTS=6]="ALREADY_EXISTS",ya[ya.PERMISSION_DENIED=7]="PERMISSION_DENIED",ya[ya.UNAUTHENTICATED=16]="UNAUTHENTICATED",ya[ya.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ya[ya.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ya[ya.ABORTED=10]="ABORTED",ya[ya.OUT_OF_RANGE=11]="OUT_OF_RANGE",ya[ya.UNIMPLEMENTED=12]="UNIMPLEMENTED",ya[ya.INTERNAL=13]="INTERNAL",ya[ya.UNAVAILABLE=14]="UNAVAILABLE",ya[ya.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qve(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zve=new Rp([4294967295,4294967295],0);function U7(t){const e=qve().encode(t),r=new kJ;return r.update(e),new Uint8Array(r.digest())}function Q7(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Rp([r,n],0),new Rp([a,s],0)]}class a6{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Qy(`Invalid padding: ${r}`);if(n<0)throw new Qy(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Qy(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Qy(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Rp.fromNumber(this.Ie)}Ee(e,r,n){let a=e.add(r.multiply(Rp.fromNumber(n)));return a.compare(zve)===1&&(a=new Rp([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=U7(e),[n,a]=Q7(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,a,s);if(!this.de(o))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new a6(s,a,r);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const r=U7(e),[n,a]=Q7(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,a,s);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Qy extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ij{constructor(e,r,n,a,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,Pw.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Ij(Cn.min(),a,new Xs(qn),Ou(),na())}}class Pw{constructor(e,r,n,a,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Pw(n,r,na(),na(),na())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(e,r,n,a){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=a}}class CZ{constructor(e,r){this.targetId=e,this.me=r}}class _Z{constructor(e,r,n=Xi.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class V7{constructor(){this.fe=0,this.ge=$7(),this.pe=Xi.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=na(),r=na(),n=na();return this.ge.forEach((a,s)=>{switch(s){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:dn()}}),new Pw(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=$7()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,gn(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Wve{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ou(),this.qe=H7(),this.Qe=new Xs(qn)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:dn()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,a)=>{this.ze(a)&&r(a)})}He(e){const r=e.targetId,n=e.me.count,a=this.Je(r);if(a){const s=a.target;if(lS(s))if(n===0){const o=new Jr(s.path);this.Ue(r,o,$s.newNoDocument(o,Cn.min()))}else gn(n===1);else{const o=this.Ye(r);if(o!==n){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:s=0}=r;let o,l;try{o=bm(n).toUint8Array()}catch(c){if(c instanceof YJ)return ym("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new a6(o,a,s)}catch(c){return ym(c instanceof Qy?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let a=0;return n.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(r,s,null),a++)}),a}rt(e){const r=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&lS(l.target)){const c=new Jr(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,$s.newNoDocument(c,e))}s.be&&(r.set(o,s.ve()),s.Ce())}});let n=na();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const a=new Ij(e,r,this.Qe,this.ke,n);return this.ke=Ou(),this.qe=H7(),this.Qe=new Xs(qn),a}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const a=this.Ge(e);this.it(e,r)?a.Fe(r,1):a.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new V7,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new us(qn),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Fr("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new V7),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function H7(){return new Xs(Jr.comparator)}function $7(){return new Xs(Jr.comparator)}const Xve={asc:"ASCENDING",desc:"DESCENDING"},Yve={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Jve={and:"AND",or:"OR"};class Zve{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function tk(t,e){return t.useProto3Json||Ew(e)?e:{value:e}}function Rv(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function EZ(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function e1e(t,e){return Rv(t,e.toTimestamp())}function nl(t){return gn(!!t),Cn.fromTimestamp(function(r){const n=vA(r);return new xr(n.seconds,n.nanos)}(t))}function s6(t,e){return rk(t,e).canonicalString()}function rk(t,e){const r=function(a){return new Pa(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?r:r.child(e)}function SZ(t){const e=Pa.fromString(t);return gn(DZ(e)),e}function w2(t,e){return s6(t.databaseId,e.path)}function aA(t,e){const r=SZ(e);if(r.get(1)!==t.databaseId.projectId)throw new Hr(fr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Hr(fr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Jr(PZ(r))}function IZ(t,e){return s6(t.databaseId,e)}function jZ(t){const e=SZ(t);return e.length===4?Pa.emptyPath():PZ(e)}function nk(t){return new Pa(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function PZ(t){return gn(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function G7(t,e,r){return{name:w2(t,e),fields:r.value.mapValue.fields}}function t1e(t,e,r){const n=aA(t,e.name),a=nl(e.updateTime),s=e.createTime?nl(e.createTime):Cn.min(),o=new Sl({mapValue:{fields:e.fields}}),l=$s.newFoundDocument(n,a,s,o);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function r1e(t,e){return"found"in e?function(n,a){gn(!!a.found),a.found.name,a.found.updateTime;const s=aA(n,a.found.name),o=nl(a.found.updateTime),l=a.found.createTime?nl(a.found.createTime):Cn.min(),c=new Sl({mapValue:{fields:a.found.fields}});return $s.newFoundDocument(s,o,l,c)}(t,e):"missing"in e?function(n,a){gn(!!a.missing),gn(!!a.readTime);const s=aA(n,a.missing),o=nl(a.readTime);return $s.newNoDocument(s,o)}(t,e):dn()}function n1e(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:dn()}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(gn(d===void 0||typeof d=="string"),Xi.fromBase64String(d||"")):(gn(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Xi.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?fr.UNKNOWN:NZ(u.code);return new Hr(d,u.message||"")}(o);r=new _Z(n,a,s,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=aA(t,n.document.name),s=nl(n.document.updateTime),o=n.document.createTime?nl(n.document.createTime):Cn.min(),l=new Sl({mapValue:{fields:n.document.fields}}),c=$s.newFoundDocument(a,s,o,l),u=n.targetIds||[],d=n.removedTargetIds||[];r=new uE(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=aA(t,n.document),s=n.readTime?nl(n.readTime):Cn.min(),o=$s.newNoDocument(a,s),l=n.removedTargetIds||[];r=new uE([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=aA(t,n.document),s=n.removedTargetIds||[];r=new uE([],s,a,null)}else{if(!("filter"in e))return dn();{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:s}=n,o=new Kve(a,s),l=n.targetId;r=new CZ(l,o)}}return r}function N2(t,e){let r;if(e instanceof d1)r={update:G7(t,e.key,e.value)};else if(e instanceof f1)r={delete:w2(t,e.key)};else if(e instanceof DA)r={update:G7(t,e.key,e.data),updateMask:c1e(e.fieldMask)};else{if(!(e instanceof e6))return dn();r={verify:w2(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const l=o.transform;if(l instanceof y2)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ug)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Dv)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof b2)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw dn()}(0,n))),e.precondition.isNone||(r.currentDocument=function(a,s){return s.updateTime!==void 0?{updateTime:e1e(a,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:dn()}(t,e.precondition)),r}function ak(t,e){const r=e.currentDocument?function(s){return s.updateTime!==void 0?Ks.updateTime(nl(s.updateTime)):s.exists!==void 0?Ks.exists(s.exists):Ks.none()}(e.currentDocument):Ks.none(),n=e.updateTransforms?e.updateTransforms.map(a=>function(o,l){let c=null;if("setToServerValue"in l)gn(l.setToServerValue==="REQUEST_TIME"),c=new y2;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];c=new ug(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];c=new Dv(d)}else"increment"in l?c=new b2(o,l.increment):dn();const u=Gs.fromServerFormat(l.fieldPath);return new vZ(u,c)}(t,a)):[];if(e.update){e.update.name;const a=aA(t,e.update.name),s=new Sl({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new nu(u.map(d=>Gs.fromServerFormat(d)))}(e.updateMask);return new DA(a,s,o,r,n)}return new d1(a,s,r,n)}if(e.delete){const a=aA(t,e.delete);return new f1(a,r)}if(e.verify){const a=aA(t,e.verify);return new e6(a,r)}return dn()}function a1e(t,e){return t&&t.length>0?(gn(e!==void 0),t.map(r=>function(a,s){let o=a.updateTime?nl(a.updateTime):nl(s);return o.isEqual(Cn.min())&&(o=nl(s)),new Hve(o,a.transformResults||[])}(r,e))):[]}function TZ(t,e){return{documents:[IZ(t,e.path)]}}function BZ(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=IZ(t,a);const s=function(u){if(u.length!==0)return OZ(ts.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(d=>function(A){return{field:Ix(A.field),direction:i1e(A.dir)}}(d))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=tk(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:r,parent:a}}function kZ(t){let e=jZ(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){gn(n===1);const d=r.from[0];d.allDescendants?a=d.collectionId:e=e.child(d.collectionId)}let s=[];r.where&&(s=function(f){const A=FZ(f);return A instanceof ts&&JD(A)?A.getFilters():[A]}(r.where));let o=[];r.orderBy&&(o=function(f){return f.map(A=>function(m){return new v2(jx(m.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(A))}(r.orderBy));let l=null;r.limit&&(l=function(f){let A;return A=typeof f=="object"?f.value:f,Ew(A)?null:A}(r.limit));let c=null;r.startAt&&(c=function(f){const A=!!f.before,h=f.values||[];return new Fv(h,A)}(r.startAt));let u=null;return r.endAt&&(u=function(f){const A=!f.before,h=f.values||[];return new Fv(h,A)}(r.endAt)),Pve(e,a,o,s,l,"F",c,u)}function s1e(t,e){const r=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return dn()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function FZ(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=jx(r.unaryFilter.field);return Aa.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=jx(r.unaryFilter.field);return Aa.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=jx(r.unaryFilter.field);return Aa.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=jx(r.unaryFilter.field);return Aa.create(o,"!=",{nullValue:"NULL_VALUE"});default:return dn()}}(t):t.fieldFilter!==void 0?function(r){return Aa.create(jx(r.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return dn()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ts.create(r.compositeFilter.filters.map(n=>FZ(n)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return dn()}}(r.compositeFilter.op))}(t):dn()}function i1e(t){return Xve[t]}function o1e(t){return Yve[t]}function l1e(t){return Jve[t]}function Ix(t){return{fieldPath:t.canonicalString()}}function jx(t){return Gs.fromServerFormat(t.fieldPath)}function OZ(t){return t instanceof Aa?function(r){if(r.op==="=="){if(I7(r.value))return{unaryFilter:{field:Ix(r.field),op:"IS_NAN"}};if(S7(r.value))return{unaryFilter:{field:Ix(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(I7(r.value))return{unaryFilter:{field:Ix(r.field),op:"IS_NOT_NAN"}};if(S7(r.value))return{unaryFilter:{field:Ix(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ix(r.field),op:o1e(r.op),value:r.value}}}(t):t instanceof ts?function(r){const n=r.getFilters().map(a=>OZ(a));return n.length===1?n[0]:{compositeFilter:{op:l1e(r.op),filters:n}}}(t):dn()}function c1e(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function DZ(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,r,n,a,s=Cn.min(),o=Cn.min(),l=Xi.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Xh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Xh(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RZ{constructor(e){this.ct=e}}function u1e(t,e){let r;if(e.document)r=t1e(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=Jr.fromSegments(e.noDocument.path),a=fg(e.noDocument.readTime);r=$s.newNoDocument(n,a),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return dn();{const n=Jr.fromSegments(e.unknownDocument.path),a=fg(e.unknownDocument.version);r=$s.newUnknownDocument(n,a)}}return e.readTime&&r.setReadTime(function(a){const s=new xr(a[0],a[1]);return Cn.fromTimestamp(s)}(e.readTime)),r}function K7(t,e){const r=e.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:dS(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,o){return{name:w2(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Rv(s,o.version.toTimestamp()),createTime:Rv(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:dg(e.version)};else{if(!e.isUnknownDocument())return dn();n.unknownDocument={path:r.path.toArray(),version:dg(e.version)}}return n}function dS(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function dg(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function fg(t){const e=new xr(t.seconds,t.nanoseconds);return Cn.fromTimestamp(e)}function vp(t,e){const r=(e.baseMutations||[]).map(s=>ak(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map(s=>ak(t.ct,s)),a=xr.fromMillis(e.localWriteTimeMs);return new t6(e.batchId,a,r,n)}function Vy(t){const e=fg(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?fg(t.lastLimboFreeSnapshotVersion):Cn.min();let n;return n=function(s){return s.documents!==void 0}(t.query)?function(s){return gn(s.documents.length===1),jd(Iw(jZ(s.documents[0])))}(t.query):function(s){return jd(kZ(s))}(t.query),new Xh(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,Xi.fromBase64String(t.resumeToken))}function MZ(t,e){const r=dg(e.snapshotVersion),n=dg(e.lastLimboFreeSnapshotVersion);let a;a=lS(e.target)?TZ(t.ct,e.target):BZ(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:cg(e.target),readTime:r,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:a}}function LZ(t){const e=kZ({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?uS(e,e.limit,"L"):e}function S3(t,e){return new n6(e.largestBatchId,ak(t.ct,e.overlayMutation))}function q7(t,e){const r=e.path.lastSegment();return[t,Tc(e.path.popLast()),r]}function z7(t,e,r,n){return{indexId:t,uid:e,sequenceNumber:r,readTime:dg(n.readTime),documentKey:Tc(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1e{getBundleMetadata(e,r){return W7(e).get(r).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:fg(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,r){return W7(e).put(function(a){return{bundleId:a.id,createTime:dg(nl(a.createTime)),version:a.version}}(r))}getNamedQuery(e,r){return X7(e).get(r).next(n=>{if(n)return function(s){return{name:s.name,query:LZ(s.bundledQuery),readTime:fg(s.readTime)}}(n)})}saveNamedQuery(e,r){return X7(e).put(function(a){return{name:a.name,readTime:dg(nl(a.readTime)),bundledQuery:a.bundledQuery}}(r))}}function W7(t){return Ro(t,"bundles")}function X7(t){return Ro(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jj{constructor(e,r){this.serializer=e,this.userId=r}static lt(e,r){const n=r.uid||"";return new jj(e,n)}getOverlay(e,r){return ay(e).get(q7(this.userId,r)).next(n=>n?S3(this.serializer,n):null)}getOverlays(e,r){const n=Jf();return Zt.forEach(r,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,r,n){const a=[];return n.forEach((s,o)=>{const l=new n6(r,o);a.push(this.ht(e,l))}),Zt.waitFor(a)}removeOverlaysForBatchId(e,r,n){const a=new Set;r.forEach(o=>a.add(Tc(o.getCollectionPath())));const s=[];return a.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(ay(e).j("collectionPathOverlayIndex",l))}),Zt.waitFor(s)}getOverlaysForCollection(e,r,n){const a=Jf(),s=Tc(r),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ay(e).U("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const u=S3(this.serializer,c);a.set(u.getKey(),u)}return a})}getOverlaysForCollectionGroup(e,r,n,a){const s=Jf();let o;const l=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return ay(e).J({index:"collectionGroupOverlayIndex",range:l},(c,u,d)=>{const f=S3(this.serializer,u);s.size()<a||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>s)}ht(e,r){return ay(e).put(function(a,s,o){const[l,c,u]=q7(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:N2(a.ct,o.mutation)}}(this.serializer,this.userId,r))}}function ay(t){return Ro(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1e{Pt(e){return Ro(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(r=>{const n=r==null?void 0:r.value;return n?Xi.fromUint8Array(n):Xi.EMPTY_BYTE_STRING})}setSessionToken(e,r){return this.Pt(e).put({name:"sessionToken",value:r.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(Vs(e.integerValue));else if("doubleValue"in e){const n=Vs(e.doubleValue);isNaN(n)?this.dt(r,13):(this.dt(r,15),A2(n)?r.At(0):r.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(r,20),typeof n=="string"&&(n=vA(n)),r.Rt(`${n.seconds||""}`),r.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(bm(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(r,45),r.At(n.latitude||0),r.At(n.longitude||0)}else"mapValue"in e?JJ(e)?this.dt(r,Number.MAX_SAFE_INTEGER):Cj(e)?this.wt(e.mapValue,r):(this.St(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.bt(e.arrayValue,r),this.ft(r)):dn()}Vt(e,r){this.dt(r,25),this.Dt(e,r)}Dt(e,r){r.Rt(e)}St(e,r){const n=e.fields||{};this.dt(r,55);for(const a of Object.keys(n))this.Vt(a,r),this.Tt(n[a],r)}wt(e,r){var n,a;const s=e.fields||{};this.dt(r,53);const o="value",l=((a=(n=s[o].arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.length)||0;this.dt(r,15),r.At(Vs(l)),this.Vt(o,r),this.Tt(s[o],r)}bt(e,r){const n=e.values||[];this.dt(r,50);for(const a of n)this.Tt(a,r)}yt(e,r){this.dt(r,37),Jr.fromName(e).path.forEach(n=>{this.dt(r,60),this.Dt(n,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}}yp.vt=new yp;function h1e(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function Y7(t){const e=64-function(n){let a=0;for(let s=0;s<8;++s){const o=h1e(255&n[s]);if(a+=o,o!==8)break}return a}(t);return Math.ceil(e/8)}class A1e{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ft(n.value),n=r.next();this.Mt()}xt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ot(n.value),n=r.next();this.Nt()}Lt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{const a=r.codePointAt(0);this.Ft(240|a>>>18),this.Ft(128|63&a>>>12),this.Ft(128|63&a>>>6),this.Ft(128|63&a)}}this.Mt()}Bt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{const a=r.codePointAt(0);this.Ot(240|a>>>18),this.Ot(128|63&a>>>12),this.Ot(128|63&a>>>6),this.Ot(128|63&a)}}this.Nt()}kt(e){const r=this.qt(e),n=Y7(r);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let a=r.length-n;a<r.length;++a)this.buffer[this.position++]=255&r[a]}Kt(e){const r=this.qt(e),n=Y7(r);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let a=r.length-n;a<r.length;++a)this.buffer[this.position++]=~(255&r[a])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const r=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),n=(128&r[0])!=0;r[0]^=n?255:128;for(let a=1;a<r.length;++a)r[a]^=n?255:0;return r}Ft(e){const r=255&e;r===0?(this.Ut(0),this.Ut(255)):r===255?(this.Ut(255),this.Ut(0)):this.Ut(r)}Ot(e){const r=255&e;r===0?(this.Gt(0),this.Gt(255)):r===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);const a=new Uint8Array(n);a.set(this.buffer),this.buffer=a}}class m1e{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class p1e{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class sy{constructor(){this.jt=new A1e,this.Ht=new m1e(this.jt),this.Jt=new p1e(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e,r,n,a){this.indexId=e,this.documentKey=r,this.arrayValue=n,this.directionalValue=a}Zt(){const e=this.directionalValue.length,r=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(r);return n.set(this.directionalValue,0),r!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new bp(this.indexId,this.documentKey,this.arrayValue,n)}}function c0(t,e){let r=t.indexId-e.indexId;return r!==0?r:(r=J7(t.arrayValue,e.arrayValue),r!==0?r:(r=J7(t.directionalValue,e.directionalValue),r!==0?r:Jr.comparator(t.documentKey,e.documentKey)))}function J7(t,e){for(let r=0;r<t.length&&r<e.length;++r){const n=t[r]-e[r];if(n!==0)return n}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z7{constructor(e){this.Xt=new us((r,n)=>Gs.comparator(r.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const r of e.filters){const n=r;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(gn(e.collectionGroup===this.collectionId),this.nn)return!1;const r=qB(e);if(r!==void 0&&!this.sn(r))return!1;const n=dp(e);let a=new Set,s=0,o=0;for(;s<n.length&&this.sn(n[s]);++s)a=a.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!a.has(l.field.canonicalString())){const c=n[s];if(!this.on(l,c)||!this._n(this.en[o++],c))return!1}++s}for(;s<n.length;++s){const l=n[s];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new us(Gs.comparator);const r=[];for(const n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")r.push(new sE(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new sE(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new sE(n.field,n.dir==="asc"?0:1)));return new oS(oS.UNKNOWN_ID,this.collectionId,r,h2.empty())}sn(e){for(const r of this.tn)if(this.on(r,e))return!0;return!1}on(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===n}_n(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UZ(t){var e,r;if(gn(t instanceof Aa||t instanceof ts),t instanceof Aa){if(t instanceof oZ){const a=((r=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||r===void 0?void 0:r.map(s=>Aa.create(t.field,"==",s)))||[];return ts.create(a,"or")}return t}const n=t.filters.map(a=>UZ(a));return ts.create(n,t.op)}function g1e(t){if(t.getFilters().length===0)return[];const e=ok(UZ(t));return gn(QZ(e)),sk(e)||ik(e)?[e]:e.getFilters()}function sk(t){return t instanceof Aa}function ik(t){return t instanceof ts&&JD(t)}function QZ(t){return sk(t)||ik(t)||function(r){if(r instanceof ts&&YB(r)){for(const n of r.getFilters())if(!sk(n)&&!ik(n))return!1;return!0}return!1}(t)}function ok(t){if(gn(t instanceof Aa||t instanceof ts),t instanceof Aa)return t;if(t.filters.length===1)return ok(t.filters[0]);const e=t.filters.map(n=>ok(n));let r=ts.create(e,t.op);return r=fS(r),QZ(r)?r:(gn(r instanceof ts),gn(Ov(r)),gn(r.filters.length>1),r.filters.reduce((n,a)=>i6(n,a)))}function i6(t,e){let r;return gn(t instanceof Aa||t instanceof ts),gn(e instanceof Aa||e instanceof ts),r=t instanceof Aa?e instanceof Aa?function(a,s){return ts.create([a,s],"and")}(t,e):e9(t,e):e instanceof Aa?e9(e,t):function(a,s){if(gn(a.filters.length>0&&s.filters.length>0),Ov(a)&&Ov(s))return aZ(a,s.getFilters());const o=YB(a)?a:s,l=YB(a)?s:a,c=o.filters.map(u=>i6(u,l));return ts.create(c,"or")}(t,e),fS(r)}function e9(t,e){if(Ov(e))return aZ(e,t.getFilters());{const r=e.filters.map(n=>i6(t,n));return ts.create(r,"or")}}function fS(t){if(gn(t instanceof Aa||t instanceof ts),t instanceof Aa)return t;const e=t.getFilters();if(e.length===1)return fS(e[0]);if(rZ(t))return t;const r=e.map(a=>fS(a)),n=[];return r.forEach(a=>{a instanceof Aa?n.push(a):a instanceof ts&&(a.op===t.op?n.push(...a.filters):n.push(a))}),n.length===1?n[0]:ts.create(n,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1e{constructor(){this.un=new o6}addToCollectionParentIndex(e,r){return this.un.add(r),Zt.resolve()}getCollectionParents(e,r){return Zt.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Zt.resolve()}deleteFieldIndex(e,r){return Zt.resolve()}deleteAllFieldIndexes(e){return Zt.resolve()}createTargetIndexes(e,r){return Zt.resolve()}getDocumentsMatchingTarget(e,r){return Zt.resolve(null)}getIndexType(e,r){return Zt.resolve(0)}getFieldIndexes(e,r){return Zt.resolve([])}getNextCollectionGroupToUpdate(e){return Zt.resolve(null)}getMinOffset(e,r){return Zt.resolve(Vu.min())}getMinOffsetFromCollectionGroup(e,r){return Zt.resolve(Vu.min())}updateCollectionGroup(e,r,n){return Zt.resolve()}updateIndexEntries(e,r){return Zt.resolve()}}class o6{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new us(Pa.comparator),s=!a.has(n);return this.index[r]=a.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new us(Pa.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aC=new Uint8Array(0);class v1e{constructor(e,r){this.databaseId=r,this.cn=new o6,this.ln=new Qm(n=>cg(n),(n,a)=>Sw(n,a)),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.cn.has(r)){const n=r.lastSegment(),a=r.popLast();e.addOnCommittedListener(()=>{this.cn.add(r)});const s={collectionId:n,parent:Tc(a)};return t9(e).put(s)}return Zt.resolve()}getCollectionParents(e,r){const n=[],a=IDBKeyRange.bound([r,""],[QJ(r),""],!1,!0);return t9(e).U(a).next(s=>{for(const o of s){if(o.collectionId!==r)break;n.push(Yf(o.parent))}return n})}addFieldIndex(e,r){const n=iy(e),a=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(r);delete a.indexId;const s=n.add(a);if(r.indexState){const o=nx(e);return s.next(l=>{o.put(z7(l,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return s.next()}deleteFieldIndex(e,r){const n=iy(e),a=nx(e),s=rx(e);return n.delete(r.indexId).next(()=>a.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const r=iy(e),n=rx(e),a=nx(e);return r.j().next(()=>n.j()).next(()=>a.j())}createTargetIndexes(e,r){return Zt.forEach(this.hn(r),n=>this.getIndexType(e,n).next(a=>{if(a===0||a===1){const s=new Z7(n).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,r){const n=rx(e);let a=!0;const s=new Map;return Zt.forEach(this.hn(r),o=>this.Pn(e,o).next(l=>{a&&(a=!!l),s.set(o,l)})).next(()=>{if(a){let o=na();const l=[];return Zt.forEach(s,(c,u)=>{Fr("IndexedDbIndexManager",`Using index ${function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(w=>`${w.fieldPath}:${w.kind}`).join(",")}`}(c)} to execute ${cg(r)}`);const d=function(b,w){const j=qB(w);if(j===void 0)return null;for(const I of cS(b,j.fieldPath))switch(I.op){case"array-contains-any":return I.value.arrayValue.values||[];case"array-contains":return[I.value]}return null}(u,c),f=function(b,w){const j=new Map;for(const I of dp(w))for(const C of cS(b,I.fieldPath))switch(C.op){case"==":case"in":j.set(I.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return j.set(I.fieldPath.canonicalString(),C.value),Array.from(j.values())}return null}(u,c),A=function(b,w){const j=[];let I=!0;for(const C of dp(w)){const S=C.kind===0?k7(b,C.fieldPath,b.startAt):F7(b,C.fieldPath,b.startAt);j.push(S.value),I&&(I=S.inclusive)}return new Fv(j,I)}(u,c),h=function(b,w){const j=[];let I=!0;for(const C of dp(w)){const S=C.kind===0?F7(b,C.fieldPath,b.endAt):k7(b,C.fieldPath,b.endAt);j.push(S.value),I&&(I=S.inclusive)}return new Fv(j,I)}(u,c),m=this.In(c,u,A),p=this.In(c,u,h),x=this.Tn(c,u,f),v=this.En(c.indexId,d,m,A.inclusive,p,h.inclusive,x);return Zt.forEach(v,y=>n.G(y,r.limit).next(b=>{b.forEach(w=>{const j=Jr.fromSegments(w.documentKey);o.has(j)||(o=o.add(j),l.push(j))})}))}).next(()=>l)}return Zt.resolve(null)})}hn(e){let r=this.ln.get(e);return r||(e.filters.length===0?r=[e]:r=g1e(ts.create(e.filters,"and")).map(n=>ZB(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,r),r)}En(e,r,n,a,s,o,l){const c=(r!=null?r.length:1)*Math.max(n.length,s.length),u=c/(r!=null?r.length:1),d=[];for(let f=0;f<c;++f){const A=r?this.dn(r[f/u]):aC,h=this.An(e,A,n[f%u],a),m=this.Rn(e,A,s[f%u],o),p=l.map(x=>this.An(e,A,x,!0));d.push(...this.createRange(h,m,p))}return d}An(e,r,n,a){const s=new bp(e,Jr.empty(),r,n);return a?s:s.Zt()}Rn(e,r,n,a){const s=new bp(e,Jr.empty(),r,n);return a?s.Zt():s}Pn(e,r){const n=new Z7(r),a=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,a).next(s=>{let o=null;for(const l of s)n.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,r){let n=2;const a=this.hn(r);return Zt.forEach(a,s=>this.Pn(e,s).next(o=>{o?n!==0&&o.fields.length<function(c){let u=new us(Gs.comparator),d=!1;for(const f of c.filters)for(const A of f.getFlattenedFilters())A.field.isKeyField()||(A.op==="array-contains"||A.op==="array-contains-any"?d=!0:u=u.add(A.field));for(const f of c.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(d?1:0)}(s)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(r)&&a.length>1&&n===2?1:n)}Vn(e,r){const n=new sy;for(const a of dp(e)){const s=r.data.field(a.fieldPath);if(s==null)return null;const o=n.Yt(a.kind);yp.vt.It(s,o)}return n.zt()}dn(e){const r=new sy;return yp.vt.It(e,r.Yt(0)),r.zt()}mn(e,r){const n=new sy;return yp.vt.It(g2(this.databaseId,r),n.Yt(function(s){const o=dp(s);return o.length===0?0:o[o.length-1].kind}(e))),n.zt()}Tn(e,r,n){if(n===null)return[];let a=[];a.push(new sy);let s=0;for(const o of dp(e)){const l=n[s++];for(const c of a)if(this.fn(r,o.fieldPath)&&x2(l))a=this.gn(a,o,l);else{const u=c.Yt(o.kind);yp.vt.It(l,u)}}return this.pn(a)}In(e,r,n){return this.Tn(e,r,n.position)}pn(e){const r=[];for(let n=0;n<e.length;++n)r[n]=e[n].zt();return r}gn(e,r,n){const a=[...e],s=[];for(const o of n.arrayValue.values||[])for(const l of a){const c=new sy;c.seed(l.zt()),yp.vt.It(o,c.Yt(r.kind)),s.push(c)}return s}fn(e,r){return!!e.filters.find(n=>n instanceof Aa&&n.field.isEqual(r)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,r){const n=iy(e),a=nx(e);return(r?n.U("collectionGroupIndex",IDBKeyRange.bound(r,r)):n.U()).next(s=>{const o=[];return Zt.forEach(s,l=>a.get([l.indexId,this.uid]).next(c=>{o.push(function(d,f){const A=f?new h2(f.sequenceNumber,new Vu(fg(f.readTime),new Jr(Yf(f.documentKey)),f.largestBatchId)):h2.empty(),h=d.fields.map(([m,p])=>new sE(Gs.fromServerFormat(m),p));return new oS(d.indexId,d.collectionGroup,h,A)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(r=>r.length===0?null:(r.sort((n,a)=>{const s=n.indexState.sequenceNumber-a.indexState.sequenceNumber;return s!==0?s:qn(n.collectionGroup,a.collectionGroup)}),r[0].collectionGroup))}updateCollectionGroup(e,r,n){const a=iy(e),s=nx(e);return this.yn(e).next(o=>a.U("collectionGroupIndex",IDBKeyRange.bound(r,r)).next(l=>Zt.forEach(l,c=>s.put(z7(c.indexId,this.uid,o,n)))))}updateIndexEntries(e,r){const n=new Map;return Zt.forEach(r,(a,s)=>{const o=n.get(a.collectionGroup);return(o?Zt.resolve(o):this.getFieldIndexes(e,a.collectionGroup)).next(l=>(n.set(a.collectionGroup,l),Zt.forEach(l,c=>this.wn(e,a,c).next(u=>{const d=this.Sn(s,c);return u.isEqual(d)?Zt.resolve():this.bn(e,s,c,u,d)}))))})}Dn(e,r,n,a){return rx(e).put({indexId:a.indexId,uid:this.uid,arrayValue:a.arrayValue,directionalValue:a.directionalValue,orderedDocumentKey:this.mn(n,r.key),documentKey:r.key.path.toArray()})}vn(e,r,n,a){return rx(e).delete([a.indexId,this.uid,a.arrayValue,a.directionalValue,this.mn(n,r.key),r.key.path.toArray()])}wn(e,r,n){const a=rx(e);let s=new us(c0);return a.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,r)])},(o,l)=>{s=s.add(new bp(n.indexId,r,l.arrayValue,l.directionalValue))}).next(()=>s)}Sn(e,r){let n=new us(c0);const a=this.Vn(r,e);if(a==null)return n;const s=qB(r);if(s!=null){const o=e.data.field(s.fieldPath);if(x2(o))for(const l of o.arrayValue.values||[])n=n.add(new bp(r.indexId,e.key,this.dn(l),a))}else n=n.add(new bp(r.indexId,e.key,aC,a));return n}bn(e,r,n,a,s){Fr("IndexedDbIndexManager","Updating index entries for document '%s'",r.key);const o=[];return function(c,u,d,f,A){const h=c.getIterator(),m=u.getIterator();let p=tx(h),x=tx(m);for(;p||x;){let v=!1,y=!1;if(p&&x){const b=d(p,x);b<0?y=!0:b>0&&(v=!0)}else p!=null?y=!0:v=!0;v?(f(x),x=tx(m)):y?(A(p),p=tx(h)):(p=tx(h),x=tx(m))}}(a,s,c0,l=>{o.push(this.Dn(e,r,n,l))},l=>{o.push(this.vn(e,r,n,l))}),Zt.waitFor(o)}yn(e){let r=1;return nx(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,a,s)=>{s.done(),r=a.sequenceNumber+1}).next(()=>r)}createRange(e,r,n){n=n.sort((o,l)=>c0(o,l)).filter((o,l,c)=>!l||c0(o,c[l-1])!==0);const a=[];a.push(e);for(const o of n){const l=c0(o,e),c=c0(o,r);if(l===0)a[0]=e.Zt();else if(l>0&&c<0)a.push(o),a.push(o.Zt());else if(c>0)break}a.push(r);const s=[];for(let o=0;o<a.length;o+=2){if(this.Cn(a[o],a[o+1]))return[];const l=[a[o].indexId,this.uid,a[o].arrayValue,a[o].directionalValue,aC,[]],c=[a[o+1].indexId,this.uid,a[o+1].arrayValue,a[o+1].directionalValue,aC,[]];s.push(IDBKeyRange.bound(l,c))}return s}Cn(e,r){return c0(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(r9)}getMinOffset(e,r){return Zt.mapArray(this.hn(r),n=>this.Pn(e,n).next(a=>a||dn())).next(r9)}}function t9(t){return Ro(t,"collectionParents")}function rx(t){return Ro(t,"indexEntries")}function iy(t){return Ro(t,"indexConfiguration")}function nx(t){return Ro(t,"indexState")}function r9(t){gn(t.length!==0);let e=t[0].indexState.offset,r=e.largestBatchId;for(let n=1;n<t.length;n++){const a=t[n].indexState.offset;qD(a,e)<0&&(e=a),r<a.largestBatchId&&(r=a.largestBatchId)}return new Vu(e.readTime,e.documentKey,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n9={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Jc{constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Jc(e,Jc.DEFAULT_COLLECTION_PERCENTILE,Jc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VZ(t,e,r){const n=t.store("mutations"),a=t.store("documentMutations"),s=[],o=IDBKeyRange.only(r.batchId);let l=0;const c=n.J({range:o},(d,f,A)=>(l++,A.delete()));s.push(c.next(()=>{gn(l===1)}));const u=[];for(const d of r.mutations){const f=KJ(e,d.key.path,r.batchId);s.push(a.delete(f)),u.push(d.key)}return Zt.waitFor(s).next(()=>u)}function hS(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw dn();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Jc.DEFAULT_COLLECTION_PERCENTILE=10,Jc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jc.DEFAULT=new Jc(41943040,Jc.DEFAULT_COLLECTION_PERCENTILE,Jc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jc.DISABLED=new Jc(-1,0,0);class Pj{constructor(e,r,n,a){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=a,this.Fn={}}static lt(e,r,n,a){gn(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Pj(s,r,n,a)}checkEmpty(e){let r=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return u0(e).J({index:"userMutationsIndex",range:n},(a,s,o)=>{r=!1,o.done()}).next(()=>r)}addMutationBatch(e,r,n,a){const s=Px(e),o=u0(e);return o.add({}).next(l=>{gn(typeof l=="number");const c=new t6(l,r,n,a),u=function(h,m,p){const x=p.baseMutations.map(y=>N2(h.ct,y)),v=p.mutations.map(y=>N2(h.ct,y));return{userId:m,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:x,mutations:v}}(this.serializer,this.userId,c),d=[];let f=new us((A,h)=>qn(A.canonicalString(),h.canonicalString()));for(const A of a){const h=KJ(this.userId,A.key.path,l);f=f.add(A.key.path.popLast()),d.push(o.put(u)),d.push(s.put(h,eve))}return f.forEach(A=>{d.push(this.indexManager.addToCollectionParentIndex(e,A))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),Zt.waitFor(d).next(()=>c)})}lookupMutationBatch(e,r){return u0(e).get(r).next(n=>n?(gn(n.userId===this.userId),vp(this.serializer,n)):null)}Mn(e,r){return this.Fn[r]?Zt.resolve(this.Fn[r]):this.lookupMutationBatch(e,r).next(n=>{if(n){const a=n.keys();return this.Fn[r]=a,a}return null})}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return u0(e).J({index:"userMutationsIndex",range:a},(o,l,c)=>{l.userId===this.userId&&(gn(l.batchId>=n),s=vp(this.serializer,l)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return u0(e).J({index:"userMutationsIndex",range:r,reverse:!0},(a,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return u0(e).U("userMutationsIndex",r).next(n=>n.map(a=>vp(this.serializer,a)))}getAllMutationBatchesAffectingDocumentKey(e,r){const n=iE(this.userId,r.path),a=IDBKeyRange.lowerBound(n),s=[];return Px(e).J({range:a},(o,l,c)=>{const[u,d,f]=o,A=Yf(d);if(u===this.userId&&r.path.isEqual(A))return u0(e).get(f).next(h=>{if(!h)throw dn();gn(h.userId===this.userId),s.push(vp(this.serializer,h))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new us(qn);const a=[];return r.forEach(s=>{const o=iE(this.userId,s.path),l=IDBKeyRange.lowerBound(o),c=Px(e).J({range:l},(u,d,f)=>{const[A,h,m]=u,p=Yf(h);A===this.userId&&s.path.isEqual(p)?n=n.add(m):f.done()});a.push(c)}),Zt.waitFor(a).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1,s=iE(this.userId,n),o=IDBKeyRange.lowerBound(s);let l=new us(qn);return Px(e).J({range:o},(c,u,d)=>{const[f,A,h]=c,m=Yf(A);f===this.userId&&n.isPrefixOf(m)?m.length===a&&(l=l.add(h)):d.done()}).next(()=>this.xn(e,l))}xn(e,r){const n=[],a=[];return r.forEach(s=>{a.push(u0(e).get(s).next(o=>{if(o===null)throw dn();gn(o.userId===this.userId),n.push(vp(this.serializer,o))}))}),Zt.waitFor(a).next(()=>n)}removeMutationBatch(e,r){return VZ(e._e,this.userId,r).next(n=>(e.addOnCommittedListener(()=>{this.On(r.batchId)}),Zt.forEach(n,a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(r=>{if(!r)return Zt.resolve();const n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),a=[];return Px(e).J({range:n},(s,o,l)=>{if(s[0]===this.userId){const c=Yf(s[1]);a.push(c)}else l.done()}).next(()=>{gn(a.length===0)})})}containsKey(e,r){return HZ(e,this.userId,r)}Nn(e){return $Z(e).get(this.userId).next(r=>r||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function HZ(t,e,r){const n=iE(e,r.path),a=n[1],s=IDBKeyRange.lowerBound(n);let o=!1;return Px(t).J({range:s,H:!0},(l,c,u)=>{const[d,f,A]=l;d===e&&f===a&&(o=!0),u.done()}).next(()=>o)}function u0(t){return Ro(t,"mutations")}function Px(t){return Ro(t,"documentMutations")}function $Z(t){return Ro(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new hg(0)}static kn(){return new hg(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1e{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.qn(e).next(r=>{const n=new hg(r.highestTargetId);return r.highestTargetId=n.next(),this.Qn(e,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(r=>Cn.fromTimestamp(new xr(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(e,r,n){return this.qn(e).next(a=>(a.highestListenSequenceNumber=r,n&&(a.lastRemoteSnapshotVersion=n.toTimestamp()),r>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=r),this.Qn(e,a)))}addTargetData(e,r){return this.Kn(e,r).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(r,n),this.Qn(e,n))))}updateTargetData(e,r){return this.Kn(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next(()=>ax(e).delete(r.targetId)).next(()=>this.qn(e)).next(n=>(gn(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,r,n){let a=0;const s=[];return ax(e).J((o,l)=>{const c=Vy(l);c.sequenceNumber<=r&&n.get(c.targetId)===null&&(a++,s.push(this.removeTargetData(e,c)))}).next(()=>Zt.waitFor(s)).next(()=>a)}forEachTarget(e,r){return ax(e).J((n,a)=>{const s=Vy(a);r(s)})}qn(e){return a9(e).get("targetGlobalKey").next(r=>(gn(r!==null),r))}Qn(e,r){return a9(e).put("targetGlobalKey",r)}Kn(e,r){return ax(e).put(MZ(this.serializer,r))}$n(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(r=>r.targetCount)}getTargetData(e,r){const n=cg(r),a=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return ax(e).J({range:a,index:"queryTargetsIndex"},(o,l,c)=>{const u=Vy(l);Sw(r,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,r,n){const a=[],s=L0(e);return r.forEach(o=>{const l=Tc(o.path);a.push(s.put({targetId:n,path:l})),a.push(this.referenceDelegate.addReference(e,n,o))}),Zt.waitFor(a)}removeMatchingKeys(e,r,n){const a=L0(e);return Zt.forEach(r,s=>{const o=Tc(s.path);return Zt.waitFor([a.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,r){const n=L0(e),a=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(a)}getMatchingKeysForTargetId(e,r){const n=IDBKeyRange.bound([r],[r+1],!1,!0),a=L0(e);let s=na();return a.J({range:n,H:!0},(o,l,c)=>{const u=Yf(o[1]),d=new Jr(u);s=s.add(d)}).next(()=>s)}containsKey(e,r){const n=Tc(r.path),a=IDBKeyRange.bound([n],[QJ(n)],!1,!0);let s=0;return L0(e).J({index:"documentTargetsIndex",H:!0,range:a},([o,l],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}ot(e,r){return ax(e).get(r).next(n=>n?Vy(n):null)}}function ax(t){return Ro(t,"targets")}function a9(t){return Ro(t,"targetGlobal")}function L0(t){return Ro(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s9([t,e],[r,n]){const a=qn(t,r);return a===0?qn(e,n):a}class b1e{constructor(e){this.Un=e,this.buffer=new us(s9),this.Wn=0}Gn(){return++this.Wn}zn(e){const r=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();s9(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class w1e{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){Fr("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Um(r)?Fr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await kg(r)}await this.Hn(3e5)})}}class N1e{constructor(e,r){this.Jn=e,this.params=r}calculateTargetCount(e,r){return this.Jn.Yn(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Zt.resolve(Nd.oe);const n=new b1e(r);return this.Jn.forEachTarget(e,a=>n.zn(a.sequenceNumber)).next(()=>this.Jn.Zn(e,a=>n.zn(a))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Jn.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Jn.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Fr("LruGarbageCollector","Garbage collection skipped; disabled"),Zt.resolve(n9)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Fr("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),n9):this.Xn(e,r))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,r){let n,a,s,o,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Fr("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),a=this.params.maximumSequenceNumbersToCollect):a=f,o=Date.now(),this.nthSequenceNumber(e,a))).next(f=>(n=f,l=Date.now(),this.removeTargets(e,n,r))).next(f=>(s=f,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(f=>(u=Date.now(),Ex()<=ha.DEBUG&&Fr("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${a} in `+(l-o)+`ms
	Removed ${s} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),Zt.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:s,documentsRemoved:f})))}}function C1e(t,e){return new N1e(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1e{constructor(e,r){this.db=e,this.garbageCollector=C1e(this,r)}Yn(e){const r=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>r.next(a=>n+a))}er(e){let r=0;return this.Zn(e,n=>{r++}).next(()=>r)}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}Zn(e,r){return this.tr(e,(n,a)=>r(a))}addReference(e,r,n){return sC(e,n)}removeReference(e,r,n){return sC(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return sC(e,r)}nr(e,r){return function(a,s){let o=!1;return $Z(a).Y(l=>HZ(a,l,s).next(c=>(c&&(o=!0),Zt.resolve(!c)))).next(()=>o)}(e,r)}removeOrphanedDocuments(e,r){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let s=0;return this.tr(e,(o,l)=>{if(l<=r){const c=this.nr(e,o).next(u=>{if(!u)return s++,n.getEntry(e,o).next(()=>(n.removeEntry(o,Cn.min()),L0(e).delete(function(f){return[0,Tc(f.path)]}(o))))});a.push(c)}}).next(()=>Zt.waitFor(a)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return sC(e,r)}tr(e,r){const n=L0(e);let a,s=Nd.oe;return n.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:u})=>{o===0?(s!==Nd.oe&&r(new Jr(Yf(a)),s),s=u,a=c):s=Nd.oe}).next(()=>{s!==Nd.oe&&r(new Jr(Yf(a)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function sC(t,e){return L0(t).put(function(n,a){return{targetId:0,path:Tc(n.path),sequenceNumber:a}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GZ{constructor(){this.changes=new Qm(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,$s.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Zt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1e{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return Jm(e).put(n)}removeEntry(e,r,n){return Jm(e).delete(function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],dS(o),l[l.length-1]]}(r,n))}updateMetadata(e,r){return this.getMetadata(e).next(n=>(n.byteSize+=r,this.rr(e,n)))}getEntry(e,r){let n=$s.newInvalidDocument(r);return Jm(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(oy(r))},(a,s)=>{n=this.ir(r,s)}).next(()=>n)}sr(e,r){let n={size:0,document:$s.newInvalidDocument(r)};return Jm(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(oy(r))},(a,s)=>{n={document:this.ir(r,s),size:hS(s)}}).next(()=>n)}getEntries(e,r){let n=Ou();return this._r(e,r,(a,s)=>{const o=this.ir(a,s);n=n.insert(a,o)}).next(()=>n)}ar(e,r){let n=Ou(),a=new Xs(Jr.comparator);return this._r(e,r,(s,o)=>{const l=this.ir(s,o);n=n.insert(s,l),a=a.insert(s,hS(o))}).next(()=>({documents:n,ur:a}))}_r(e,r,n){if(r.isEmpty())return Zt.resolve();let a=new us(l9);r.forEach(c=>a=a.add(c));const s=IDBKeyRange.bound(oy(a.first()),oy(a.last())),o=a.getIterator();let l=o.getNext();return Jm(e).J({index:"documentKeyIndex",range:s},(c,u,d)=>{const f=Jr.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&l9(l,f)<0;)n(l,null),l=o.getNext();l&&l.isEqual(f)&&(n(l,u),l=o.hasNext()?o.getNext():null),l?d.$(oy(l)):d.done()}).next(()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,r,n,a,s){const o=r.path,l=[o.popLast().toArray(),o.lastSegment(),dS(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Jm(e).U(IDBKeyRange.bound(l,c,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let d=Ou();for(const f of u){const A=this.ir(Jr.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);A.isFoundDocument()&&(jw(r,A)||a.has(A.key))&&(d=d.insert(A.key,A))}return d})}getAllFromCollectionGroup(e,r,n,a){let s=Ou();const o=o9(r,n),l=o9(r,Vu.max());return Jm(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,u,d)=>{const f=this.ir(Jr.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(f.key,f),s.size===a&&d.done()}).next(()=>s)}newChangeBuffer(e){return new S1e(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(r=>r.byteSize)}getMetadata(e){return i9(e).get("remoteDocumentGlobalKey").next(r=>(gn(!!r),r))}rr(e,r){return i9(e).put("remoteDocumentGlobalKey",r)}ir(e,r){if(r){const n=u1e(this.serializer,r);if(!(n.isNoDocument()&&n.version.isEqual(Cn.min())))return n}return $s.newInvalidDocument(e)}}function KZ(t){return new E1e(t)}class S1e extends GZ{constructor(e,r){super(),this.cr=e,this.trackRemovals=r,this.lr=new Qm(n=>n.toString(),(n,a)=>n.isEqual(a))}applyChanges(e){const r=[];let n=0,a=new us((s,o)=>qn(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const l=this.lr.get(s);if(r.push(this.cr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const c=K7(this.cr.serializer,o);a=a.add(s.path.popLast());const u=hS(c);n+=u-l.size,r.push(this.cr.addEntry(e,s,c))}else if(n-=l.size,this.trackRemovals){const c=K7(this.cr.serializer,o.convertToNoDocument(Cn.min()));r.push(this.cr.addEntry(e,s,c))}}),a.forEach(s=>{r.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),r.push(this.cr.updateMetadata(e,n)),Zt.waitFor(r)}getFromCache(e,r){return this.cr.sr(e,r).next(n=>(this.lr.set(r,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,r){return this.cr.ar(e,r).next(({documents:n,ur:a})=>(a.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:n.get(s).readTime})}),n))}}function i9(t){return Ro(t,"remoteDocumentGlobal")}function Jm(t){return Ro(t,"remoteDocumentsV14")}function oy(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function o9(t,e){const r=e.documentKey.path.toArray();return[t,dS(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function l9(t,e){const r=t.path.toArray(),n=e.path.toArray();let a=0;for(let s=0;s<r.length-2&&s<n.length-2;++s)if(a=qn(r[s],n[s]),a)return a;return a=qn(r.length,n.length),a||(a=qn(r[r.length-2],n[n.length-2]),a||qn(r[r.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1e{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qZ{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(a=>(n=a,this.remoteDocumentCache.getEntry(e,r))).next(a=>(n!==null&&vb(n.mutation,a,nu.empty(),xr.now()),a))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,na()).next(()=>n))}getLocalViewOfDocuments(e,r,n=na()){const a=Jf();return this.populateOverlays(e,a,r).next(()=>this.computeViews(e,r,a,n).next(s=>{let o=Uy();return s.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=Jf();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,na()))}populateOverlays(e,r,n){const a=[];return n.forEach(s=>{r.has(s)||a.push(s)}),this.documentOverlayCache.getOverlays(e,a).next(s=>{s.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,n,a){let s=Ou();const o=xb(),l=function(){return xb()}();return r.forEach((c,u)=>{const d=n.get(u.key);a.has(u.key)&&(d===void 0||d.mutation instanceof DA)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),vb(d.mutation,u,d.mutation.getFieldMask(),xr.now())):o.set(u.key,nu.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,d)=>o.set(u,d)),r.forEach((u,d)=>{var f;return l.set(u,new I1e(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,r){const n=xb();let a=new Xs((o,l)=>o-l),s=na();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let d=n.get(c)||nu.empty();d=l.applyToLocalView(u,d),n.set(c,d);const f=(a.get(l.batchId)||na()).add(c);a=a.insert(l.batchId,f)})}).next(()=>{const o=[],l=a.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,f=hZ();d.forEach(A=>{if(!s.has(A)){const h=yZ(r.get(A),n.get(A));h!==null&&f.set(A,h),s=s.add(A)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return Zt.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,a){return function(o){return Jr.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):lZ(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next(s=>{const o=a-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-s.size):Zt.resolve(Jf());let l=-1,c=s;return o.next(u=>Zt.forEach(u,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),s.get(d)?Zt.resolve():this.remoteDocumentCache.getEntry(e,d).next(A=>{c=c.insert(d,A)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,na())).next(d=>({batchId:l,changes:fZ(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Jr(r)).next(n=>{let a=Uy();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a})}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const s=r.collectionGroup;let o=Uy();return this.indexManager.getCollectionParents(e,s).next(l=>Zt.forEach(l,c=>{const u=function(f,A){return new u1(A,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,a).next(d=>{d.forEach((f,A)=>{o=o.insert(f,A)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,a){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,a))).next(o=>{s.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,$s.newInvalidDocument(d)))});let l=Uy();return o.forEach((c,u)=>{const d=s.get(c);d!==void 0&&vb(d.mutation,u,nu.empty(),xr.now()),jw(r,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1e{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Zt.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(a){return{id:a.id,version:a.version,createTime:nl(a.createTime)}}(r)),Zt.resolve()}getNamedQuery(e,r){return Zt.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(a){return{name:a.name,query:LZ(a.bundledQuery),readTime:nl(a.readTime)}}(r)),Zt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1e{constructor(){this.overlays=new Xs(Jr.comparator),this.Ir=new Map}getOverlay(e,r){return Zt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Jf();return Zt.forEach(r,a=>this.getOverlay(e,a).next(s=>{s!==null&&n.set(a,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((a,s)=>{this.ht(e,r,s)}),Zt.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.Ir.get(n);return a!==void 0&&(a.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Zt.resolve()}getOverlaysForCollection(e,r,n){const a=Jf(),s=r.length+1,o=new Jr(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>n&&a.set(c.getKey(),c)}return Zt.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let s=new Xs((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let d=s.get(u.largestBatchId);d===null&&(d=Jf(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=Jf(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=a)););return Zt.resolve(l)}ht(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const o=this.Ir.get(a.largestBatchId).delete(n.key);this.Ir.set(a.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new n6(r,n));let s=this.Ir.get(r);s===void 0&&(s=na(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1e{constructor(){this.sessionToken=Xi.EMPTY_BYTE_STRING}getSessionToken(e){return Zt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Zt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(){this.Tr=new us(Wo.Er),this.dr=new us(Wo.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Wo(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Wo(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Jr(new Pa([])),n=new Wo(r,e),a=new Wo(r,e+1),s=[];return this.dr.forEachInRange([n,a],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Jr(new Pa([])),n=new Wo(r,e),a=new Wo(r,e+1);let s=na();return this.dr.forEachInRange([n,a],o=>{s=s.add(o.key)}),s}containsKey(e){const r=new Wo(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Wo{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Jr.comparator(e.key,r.key)||qn(e.wr,r.wr)}static Ar(e,r){return qn(e.wr,r.wr)||Jr.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1e{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new us(Wo.Er)}checkEmpty(e){return Zt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new t6(s,r,n,a);this.mutationQueue.push(o);for(const l of a)this.br=this.br.add(new Wo(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Zt.resolve(o)}lookupMutationBatch(e,r){return Zt.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.vr(n),s=a<0?0:a;return Zt.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Zt.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Zt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Wo(r,0),a=new Wo(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,a],o=>{const l=this.Dr(o.wr);s.push(l)}),Zt.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new us(qn);return r.forEach(a=>{const s=new Wo(a,0),o=new Wo(a,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{n=n.add(l.wr)})}),Zt.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let s=n;Jr.isDocumentKey(s)||(s=s.child(""));const o=new Wo(new Jr(s),0);let l=new us(qn);return this.br.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===a&&(l=l.add(c.wr)),!0)},o),Zt.resolve(this.Cr(l))}Cr(e){const r=[];return e.forEach(n=>{const a=this.Dr(n);a!==null&&r.push(a)}),r}removeMutationBatch(e,r){gn(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Zt.forEach(r.mutations,a=>{const s=new Wo(a.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Wo(r,0),a=this.br.firstAfterOrEqual(n);return Zt.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Zt.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1e{constructor(e){this.Mr=e,this.docs=function(){return new Xs(Jr.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),s=a?a.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Zt.resolve(n?n.document.mutableCopy():$s.newInvalidDocument(r))}getEntries(e,r){let n=Ou();return r.forEach(a=>{const s=this.docs.get(a);n=n.insert(a,s?s.document.mutableCopy():$s.newInvalidDocument(a))}),Zt.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let s=Ou();const o=r.path,l=new Jr(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||qD(VJ(d),n)<=0||(a.has(d.key)||jw(r,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Zt.resolve(s)}getAllFromCollectionGroup(e,r,n,a){dn()}Or(e,r){return Zt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new F1e(this)}getSize(e){return Zt.resolve(this.size)}}class F1e extends GZ{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,a)=>{a.isValidDocument()?r.push(this.cr.addEntry(e,a)):this.cr.removeEntry(n)}),Zt.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1e{constructor(e){this.persistence=e,this.Nr=new Qm(r=>cg(r),Sw),this.lastRemoteSnapshotVersion=Cn.min(),this.highestTargetId=0,this.Lr=0,this.Br=new l6,this.targetCount=0,this.kr=hg.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,a)=>r(a)),Zt.resolve()}getLastRemoteSnapshotVersion(e){return Zt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Zt.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Zt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Zt.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new hg(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Zt.resolve()}updateTargetData(e,r){return this.Kn(r),Zt.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Zt.resolve()}removeTargets(e,r,n){let a=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),a++)}),Zt.waitFor(s).next(()=>a)}getTargetCount(e){return Zt.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Zt.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Zt.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const a=this.persistence.referenceDelegate,s=[];return a&&r.forEach(o=>{s.push(a.markPotentiallyOrphaned(e,o))}),Zt.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Zt.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Zt.resolve(n)}containsKey(e,r){return Zt.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zZ{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Nd(0),this.Kr=!1,this.Kr=!0,this.$r=new T1e,this.referenceDelegate=e(this),this.Ur=new O1e(this),this.indexManager=new x1e,this.remoteDocumentCache=function(a){return new k1e(a)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new RZ(r),this.Gr=new j1e(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new P1e,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new B1e(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Fr("MemoryPersistence","Starting transaction:",e);const a=new D1e(this.Qr.next());return this.referenceDelegate.zr(),n(a).next(s=>this.referenceDelegate.jr(a).next(()=>s)).toPromise().then(s=>(a.raiseOnCommittedEvent(),s))}Hr(e,r){return Zt.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class D1e extends $J{constructor(e){super(),this.currentSequenceNumber=e}}class Tj{constructor(e){this.persistence=e,this.Jr=new l6,this.Yr=null}static Zr(e){return new Tj(e)}get Xr(){if(this.Yr)return this.Yr;throw dn()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Zt.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Zt.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Zt.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(a=>this.Xr.add(a.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(a=>{a.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Zt.forEach(this.Xr,n=>{const a=Jr.fromPath(n);return this.ei(e,a).next(s=>{s||r.removeEntry(a,Cn.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Zt.or([()=>Zt.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1e{constructor(e){this.serializer=e}O(e,r,n,a){const s=new Nj("createOrUpgrade",r);n<1&&a>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",w7,{unique:!0}),c.createObjectStore("documentMutations")}(e),c9(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=Zt.resolve();return n<3&&a>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),c9(e)),o=o.next(()=>function(c){const u=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Cn.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(s))),n<4&&a>=4&&(n!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",w7,{unique:!0});const f=u.store("mutations"),A=d.map(h=>f.put(h));return Zt.waitFor(A)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&a>=5&&(o=o.next(()=>this.ni(s))),n<6&&a>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),n<7&&a>=7&&(o=o.next(()=>this.ii(s))),n<8&&a>=8&&(o=o.next(()=>this.si(e,s))),n<9&&a>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&a>=10&&(o=o.next(()=>this.oi(s))),n<11&&a>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&a>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore("documentOverlays",{keyPath:fve});u.createIndex("collectionPathOverlayIndex",hve,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",Ave,{unique:!1})})(e)})),n<13&&a>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore("remoteDocumentsV14",{keyPath:tve});u.createIndex("documentKeyIndex",rve),u.createIndex("collectionGroupIndex",nve)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&a>=14&&(o=o.next(()=>this.ai(e,s))),n<15&&a>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:lve}).createIndex("sequenceNumberIndex",cve,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:uve}).createIndex("documentKeyIndex",dve,{unique:!1})}(e))),n<16&&a>=16&&(o=o.next(()=>{r.objectStore("indexState").clear()}).next(()=>{r.objectStore("indexEntries").clear()})),n<17&&a>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let r=0;return e.store("remoteDocuments").J((n,a)=>{r+=hS(a)}).next(()=>{const n={byteSize:r};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const r=e.store("mutationQueues"),n=e.store("mutations");return r.U().next(a=>Zt.forEach(a,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",o).next(l=>Zt.forEach(l,c=>{gn(c.userId===s.userId);const u=vp(this.serializer,c);return VZ(e,s.userId,u).next(()=>{})}))}))}ii(e){const r=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(a=>{const s=[];return n.J((o,l)=>{const c=new Pa(o),u=function(f){return[0,Tc(f)]}(c);s.push(r.get(u).next(d=>d?Zt.resolve():(f=>r.put({targetId:0,path:Tc(f),sequenceNumber:a.highestListenSequenceNumber}))(c)))}).next(()=>Zt.waitFor(s))})}si(e,r){e.createObjectStore("collectionParents",{keyPath:ove});const n=r.store("collectionParents"),a=new o6,s=o=>{if(a.add(o)){const l=o.lastSegment(),c=o.popLast();return n.put({collectionId:l,parent:Tc(c)})}};return r.store("remoteDocuments").J({H:!0},(o,l)=>{const c=new Pa(o);return s(c.popLast())}).next(()=>r.store("documentMutations").J({H:!0},([o,l,c],u)=>{const d=Yf(l);return s(d.popLast())}))}oi(e){const r=e.store("targets");return r.J((n,a)=>{const s=Vy(a),o=MZ(this.serializer,s);return r.put(o)})}_i(e,r){const n=r.store("remoteDocuments"),a=[];return n.J((s,o)=>{const l=r.store("remoteDocumentsV14"),c=function(f){return f.document?new Jr(Pa.fromString(f.document.name).popFirst(5)):f.noDocument?Jr.fromSegments(f.noDocument.path):f.unknownDocument?Jr.fromSegments(f.unknownDocument.path):dn()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};a.push(l.put(u))}).next(()=>Zt.waitFor(a))}ai(e,r){const n=r.store("mutations"),a=KZ(this.serializer),s=new zZ(Tj.Zr,this.serializer.ct);return n.U().next(o=>{const l=new Map;return o.forEach(c=>{var u;let d=(u=l.get(c.userId))!==null&&u!==void 0?u:na();vp(this.serializer,c).keys().forEach(f=>d=d.add(f)),l.set(c.userId,d)}),Zt.forEach(l,(c,u)=>{const d=new Cl(u),f=jj.lt(this.serializer,d),A=s.getIndexManager(d),h=Pj.lt(d,this.serializer,A,s.referenceDelegate);return new qZ(a,h,f,A).recalculateAndSaveOverlaysForDocumentKeys(new zB(r,Nd.oe),c).next()})})}}function c9(t){t.createObjectStore("targetDocuments",{keyPath:sve}).createIndex("documentTargetsIndex",ive,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",ave,{unique:!0}),t.createObjectStore("targetGlobal")}const I3="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class c6{constructor(e,r,n,a,s,o,l,c,u,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.ui=s,this.window=o,this.document=l,this.ci=u,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=A=>Promise.resolve(),!c6.D())throw new Hr(fr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new _1e(this,a),this.Ai=r+"main",this.serializer=new RZ(c),this.Ri=new dm(this.Ai,this.hi,new R1e(this.serializer)),this.$r=new f1e,this.Ur=new y1e(this.referenceDelegate,this.serializer),this.remoteDocumentCache=KZ(this.serializer),this.Gr=new d1e,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&Ec("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Hr(fr.FAILED_PRECONDITION,I3);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Nd(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async r=>{r.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>iC(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(r=>{r||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(r=>this.isPrimary&&!r?this.bi(e).next(()=>!1):!!r&&this.Di(e).next(()=>!0))).catch(e=>{if(Um(e))return Fr("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Fr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return ly(e).get("owner").next(r=>Zt.resolve(this.vi(r)))}Ci(e){return iC(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const n=Ro(r,"clientMetadata");return n.U().next(a=>{const s=this.xi(a,18e5),o=a.filter(l=>s.indexOf(l)===-1);return Zt.forEach(o,l=>n.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const r of e)this.Vi.removeItem(this.Oi(r.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?Zt.resolve(!0):ly(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)){if(this.vi(r)&&this.networkEnabled)return!0;if(!this.vi(r)){if(!r.allowTabSynchronization)throw new Hr(fr.FAILED_PRECONDITION,I3);return!1}}return!(!this.networkEnabled||!this.inForeground)||iC(e).U().next(n=>this.xi(n,5e3).find(a=>{if(this.clientId!==a.clientId){const s=!this.networkEnabled&&a.networkEnabled,o=!this.inForeground&&a.inForeground,l=this.networkEnabled===a.networkEnabled;if(s||o&&l)return!0}return!1})===void 0)}).next(r=>(this.isPrimary!==r&&Fr("IndexedDbPersistence",`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const r=new zB(e,Nd.oe);return this.bi(r).next(()=>this.Ci(r))}),this.Ri.close(),this.qi()}xi(e,r){return e.filter(n=>this.Mi(n.updateTimeMs,r)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>iC(e).U().next(r=>this.xi(r,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,r){return Pj.lt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new v1e(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return jj.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,r,n){Fr("IndexedDbPersistence","Starting transaction:",e);const a=r==="readonly"?"readonly":"readwrite",s=function(c){return c===17?gve:c===16?pve:c===15?WD:c===14?WJ:c===13?zJ:c===12?mve:c===11?qJ:void dn()}(this.hi);let o;return this.Ri.runTransaction(e,a,s,l=>(o=new zB(l,this.Qr?this.Qr.next():Nd.oe),r==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw Ec(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Hr(fr.FAILED_PRECONDITION,HJ);return n(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>n(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return ly(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)&&!this.vi(r)&&!(this.li||this.allowTabSynchronization&&r.allowTabSynchronization))throw new Hr(fr.FAILED_PRECONDITION,I3)})}Di(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ly(e).put("owner",r)}static D(){return dm.D()}bi(e){const r=ly(e);return r.get("owner").next(n=>this.vi(n)?(Fr("IndexedDbPersistence","Releasing primary lease."),r.delete("owner")):Zt.resolve())}Mi(e,r){const n=Date.now();return!(e<n-r)&&(!(e>n)||(Ec(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const r=/(?:Version|Mobile)\/1[456]/;qY()&&(navigator.appVersion.match(r)||navigator.userAgent.match(r))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var r;try{const n=((r=this.Vi)===null||r===void 0?void 0:r.getItem(this.Oi(e)))!==null;return Fr("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Ec("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Ec("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ly(t){return Ro(t,"owner")}function iC(t){return Ro(t,"clientMetadata")}function M1e(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=a}static Wi(e,r){let n=na(),a=na();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}return new u6(e,r.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1e{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WZ{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return qY()?8:GJ(Oo())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,a){const s={result:null};return this.Yi(e,r).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,r,a,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new L1e;return this.Xi(e,r,o).next(l=>{if(s.result=l,this.zi)return this.es(e,r,o,l.size)})}).next(()=>s.result)}es(e,r,n,a){return n.documentReadCount<this.ji?(Ex()<=ha.DEBUG&&Fr("QueryEngine","SDK will not create cache indexes for query:",Sx(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Zt.resolve()):(Ex()<=ha.DEBUG&&Fr("QueryEngine","Query:",Sx(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.Hi*a?(Ex()<=ha.DEBUG&&Fr("QueryEngine","The SDK decides to create cache indexes for query:",Sx(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,jd(r))):Zt.resolve())}Yi(e,r){if(O7(r))return Zt.resolve(null);let n=jd(r);return this.indexManager.getIndexType(e,n).next(a=>a===0?null:(r.limit!==null&&a===1&&(r=uS(r,null,"F"),n=jd(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=na(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.ts(r,l);return this.ns(r,u,o,c.readTime)?this.Yi(e,uS(r,null,"F")):this.rs(e,u,r,c)}))})))}Zi(e,r,n,a){return O7(r)||a.isEqual(Cn.min())?Zt.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const o=this.ts(r,s);return this.ns(r,o,n,a)?Zt.resolve(null):(Ex()<=ha.DEBUG&&Fr("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Sx(r)),this.rs(e,o,r,qxe(a,-1)).next(l=>l))})}ts(e,r){let n=new us(uZ(e));return r.forEach((a,s)=>{jw(e,s)&&(n=n.add(s))}),n}ns(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(a)>0)}Xi(e,r,n){return Ex()<=ha.DEBUG&&Fr("QueryEngine","Using full collection scan to execute query:",Sx(r)),this.Ji.getDocumentsMatchingQuery(e,r,Vu.min(),n)}rs(e,r,n,a){return this.Ji.getDocumentsMatchingQuery(e,n,a).next(s=>(r.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1e{constructor(e,r,n,a){this.persistence=e,this.ss=r,this.serializer=a,this.os=new Xs(qn),this._s=new Qm(s=>cg(s),Sw),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qZ(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function XZ(t,e,r,n){return new U1e(t,e,r,n)}async function YZ(t,e){const r=Un(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next(s=>(a=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],l=[];let c=na();for(const u of a){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of s){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return r.localDocuments.getDocuments(n,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function Q1e(t,e){const r=Un(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const a=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const f=u.batch,A=f.keys();let h=Zt.resolve();return A.forEach(m=>{h=h.next(()=>d.getEntry(c,m)).next(p=>{const x=u.docVersions.get(m);gn(x!==null),p.version.compareTo(x)<0&&(f.applyToRemoteDocument(p,u),p.isValidDocument()&&(p.setReadTime(u.commitVersion),d.addEntry(p)))})}),h.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=na();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,a))})}function JZ(t){const e=Un(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function V1e(t,e){const r=Un(t),n=e.snapshotVersion;let a=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});a=r.os;const l=[];e.targetChanges.forEach((d,f)=>{const A=a.get(f);if(!A)return;l.push(r.Ur.removeMatchingKeys(s,d.removedDocuments,f).next(()=>r.Ur.addMatchingKeys(s,d.addedDocuments,f)));let h=A.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?h=h.withResumeToken(Xi.EMPTY_BYTE_STRING,Cn.min()).withLastLimboFreeSnapshotVersion(Cn.min()):d.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(d.resumeToken,n)),a=a.insert(f,h),function(p,x,v){return p.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(A,h,d)&&l.push(r.Ur.updateTargetData(s,h))});let c=Ou(),u=na();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(s,d))}),l.push(H1e(s,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!n.isEqual(Cn.min())){const d=r.Ur.getLastRemoteSnapshotVersion(s).next(f=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(d)}return Zt.waitFor(l).next(()=>o.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(r.os=a,s))}function H1e(t,e,r){let n=na(),a=na();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let o=Ou();return r.forEach((l,c)=>{const u=s.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(a=a.add(l)),c.isNoDocument()&&c.version.isEqual(Cn.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Fr("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:a}})}function $1e(t,e){const r=Un(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function G1e(t,e){const r=Un(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let a;return r.Ur.getTargetData(n,e).next(s=>s?(a=s,Zt.resolve(a)):r.Ur.allocateTargetId(n).next(o=>(a=new Xh(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,a).next(()=>a))))}).then(n=>{const a=r.os.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function lk(t,e,r){const n=Un(t),a=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,a))}catch(o){if(!Um(o))throw o;Fr("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(a.target)}function u9(t,e,r){const n=Un(t);let a=Cn.min(),s=na();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const f=Un(c),A=f._s.get(d);return A!==void 0?Zt.resolve(f.os.get(A)):f.Ur.getTargetData(u,d)}(n,o,jd(e)).next(l=>{if(l)return a=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{s=c})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?a:Cn.min(),r?s:na())).next(l=>(K1e(n,Bve(e),l),{documents:l,Ts:s})))}function K1e(t,e,r){let n=t.us.get(e)||Cn.min();r.forEach((a,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class d9{constructor(){this.activeTargetIds=Mve()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ZZ{constructor(){this.so=new d9,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new d9,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1e{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f9{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Fr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Fr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oC=null;function j3(){return oC===null?oC=function(){return 268435456+Math.round(2147483648*Math.random())}():oC++,"0x"+oC.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z1e={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1e{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ql="WebChannelConnection";class X1e extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${a}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${a}`:`project_id=${a}&database_id=${s}`}get Fo(){return!1}Mo(r,n,a,s,o){const l=j3(),c=this.xo(r,n.toUriEncodedString());Fr("RestConnection",`Sending RPC '${r}' ${l}:`,c,a);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(r,c,u,a).then(d=>(Fr("RestConnection",`Received RPC '${r}' ${l}: `,d),d),d=>{throw ym("RestConnection",`RPC '${r}' ${l} failed with error: `,d,"url: ",c,"request:",a),d})}Lo(r,n,a,s,o,l){return this.Mo(r,n,a,s,o)}Oo(r,n,a){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+c1}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>r[o]=s),a&&a.headers.forEach((s,o)=>r[o]=s)}xo(r,n){const a=z1e[r];return`${this.Do}/v1/${n}:${a}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,a){const s=j3();return new Promise((o,l)=>{const c=new FJ;c.setWithCredentials(!0),c.listenOnce(OJ.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case aE.NO_ERROR:const d=c.getResponseJson();Fr(Ql,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case aE.TIMEOUT:Fr(Ql,`RPC '${e}' ${s} timed out`),l(new Hr(fr.DEADLINE_EXCEEDED,"Request time out"));break;case aE.HTTP_ERROR:const f=c.getStatus();if(Fr(Ql,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let A=c.getResponseJson();Array.isArray(A)&&(A=A[0]);const h=A==null?void 0:A.error;if(h&&h.status&&h.message){const m=function(x){const v=x.toLowerCase().replace(/_/g,"-");return Object.values(fr).indexOf(v)>=0?v:fr.UNKNOWN}(h.status);l(new Hr(m,h.message))}else l(new Hr(fr.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Hr(fr.UNAVAILABLE,"Connection failed."));break;default:dn()}}finally{Fr(Ql,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(a);Fr(Ql,`RPC '${e}' ${s} sending request:`,a),c.send(r,"POST",u,n,15)})}Bo(e,r,n){const a=j3(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=MJ(),l=RJ(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const d=s.join("");Fr(Ql,`Creating RPC '${e}' stream ${a}: ${d}`,c);const f=o.createWebChannel(d,c);let A=!1,h=!1;const m=new W1e({Io:x=>{h?Fr(Ql,`Not sending because RPC '${e}' stream ${a} is closed:`,x):(A||(Fr(Ql,`Opening RPC '${e}' stream ${a} transport.`),f.open(),A=!0),Fr(Ql,`RPC '${e}' stream ${a} sending:`,x),f.send(x))},To:()=>f.close()}),p=(x,v,y)=>{x.listen(v,b=>{try{y(b)}catch(w){setTimeout(()=>{throw w},0)}})};return p(f,Ly.EventType.OPEN,()=>{h||(Fr(Ql,`RPC '${e}' stream ${a} transport opened.`),m.yo())}),p(f,Ly.EventType.CLOSE,()=>{h||(h=!0,Fr(Ql,`RPC '${e}' stream ${a} transport closed`),m.So())}),p(f,Ly.EventType.ERROR,x=>{h||(h=!0,ym(Ql,`RPC '${e}' stream ${a} transport errored:`,x),m.So(new Hr(fr.UNAVAILABLE,"The operation could not be completed")))}),p(f,Ly.EventType.MESSAGE,x=>{var v;if(!h){const y=x.data[0];gn(!!y);const b=y,w=b.error||((v=b[0])===null||v===void 0?void 0:v.error);if(w){Fr(Ql,`RPC '${e}' stream ${a} received error:`,w);const j=w.status;let I=function(E){const B=ro[E];if(B!==void 0)return NZ(B)}(j),C=w.message;I===void 0&&(I=fr.INTERNAL,C="Unknown error status: "+j+" with message "+w.message),h=!0,m.So(new Hr(I,C)),f.close()}else Fr(Ql,`RPC '${e}' stream ${a} received:`,y),m.bo(y)}}),p(l,DJ.STAT_EVENT,x=>{x.stat===KB.PROXY?Fr(Ql,`RPC '${e}' stream ${a} detected buffering proxy`):x.stat===KB.NOPROXY&&Fr(Ql,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{m.wo()},0),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1e(){return typeof window<"u"?window:null}function dE(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bj(t){return new Zve(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(e,r,n=1e3,a=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=a,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),a=Math.max(0,r-n);a>0&&Fr("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,a,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eee{constructor(e,r,n,a,s,o,l,c){this.ui=e,this.Ho=n,this.Jo=a,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new d6(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===fr.RESOURCE_EXHAUSTED?(Ec(r.toString()),Ec("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===fr.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,a])=>{this.Yo===r&&this.P_(n,a)},n=>{e(()=>{const a=new Hr(fr.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(a)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(a=>{n(()=>this.I_(a))}),this.stream.onMessage(a=>{n(()=>++this.e_==1?this.E_(a):this.onNext(a))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Fr("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Fr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class J1e extends eee{constructor(e,r,n,a,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,o),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=n1e(this.serializer,e),n=function(s){if(!("targetChange"in s))return Cn.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Cn.min():o.readTime?nl(o.readTime):Cn.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=nk(this.serializer),r.addTarget=function(s,o){let l;const c=o.target;if(l=lS(c)?{documents:TZ(s,c)}:{query:BZ(s,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=EZ(s,o.resumeToken);const u=tk(s,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(Cn.min())>0){l.readTime=Rv(s,o.snapshotVersion.toTimestamp());const u=tk(s,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const n=s1e(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=nk(this.serializer),r.removeTarget=e,this.a_(r)}}class Z1e extends eee{constructor(e,r,n,a,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return gn(!!e.streamToken),this.lastStreamToken=e.streamToken,gn(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){gn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=a1e(e.writeResults,e.commitTime),n=nl(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=nk(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>N2(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eye extends class{}{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.y_=!1}w_(){if(this.y_)throw new Hr(fr.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,rk(r,n),a,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===fr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Hr(fr.UNKNOWN,s.toString())})}Lo(e,r,n,a,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,rk(r,n),a,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===fr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Hr(fr.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class tye{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ec(r),this.D_=!1):Fr("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rye{constructor(e,r,n,a,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{n.enqueueAndForget(async()=>{Og(this)&&(Fr("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=Un(c);u.L_.add(4),await Tw(u),u.q_.set("Unknown"),u.L_.delete(4),await kj(u)}(this))})}),this.q_=new tye(n,a)}}async function kj(t){if(Og(t))for(const e of t.B_)await e(!0)}async function Tw(t){for(const e of t.B_)await e(!1)}function tee(t,e){const r=Un(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),m6(r)?A6(r):h1(r).r_()&&h6(r,e))}function f6(t,e){const r=Un(t),n=h1(r);r.N_.delete(e),n.r_()&&ree(r,e),r.N_.size===0&&(n.r_()?n.o_():Og(r)&&r.q_.set("Unknown"))}function h6(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Cn.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}h1(t).A_(e)}function ree(t,e){t.Q_.xe(e),h1(t).R_(e)}function A6(t){t.Q_=new Wve({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),h1(t).start(),t.q_.v_()}function m6(t){return Og(t)&&!h1(t).n_()&&t.N_.size>0}function Og(t){return Un(t).L_.size===0}function nee(t){t.Q_=void 0}async function nye(t){t.q_.set("Online")}async function aye(t){t.N_.forEach((e,r)=>{h6(t,e)})}async function sye(t,e){nee(t),m6(t)?(t.q_.M_(e),A6(t)):t.q_.set("Unknown")}async function iye(t,e,r){if(t.q_.set("Online"),e instanceof _Z&&e.state===2&&e.cause)try{await async function(a,s){const o=s.cause;for(const l of s.targetIds)a.N_.has(l)&&(await a.remoteSyncer.rejectListen(l,o),a.N_.delete(l),a.Q_.removeTarget(l))}(t,e)}catch(n){Fr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await AS(t,n)}else if(e instanceof uE?t.Q_.Ke(e):e instanceof CZ?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Cn.min()))try{const n=await JZ(t.localStore);r.compareTo(n)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=s.N_.get(u);d&&s.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=s.N_.get(c);if(!d)return;s.N_.set(c,d.withResumeToken(Xi.EMPTY_BYTE_STRING,d.snapshotVersion)),ree(s,c);const f=new Xh(d.target,c,u,d.sequenceNumber);h6(s,f)}),s.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){Fr("RemoteStore","Failed to raise snapshot:",n),await AS(t,n)}}async function AS(t,e,r){if(!Um(e))throw e;t.L_.add(1),await Tw(t),t.q_.set("Offline"),r||(r=()=>JZ(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Fr("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await kj(t)})}function aee(t,e){return e().catch(r=>AS(t,r,e))}async function Bw(t){const e=Un(t),r=Cm(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;oye(e);)try{const a=await $1e(e.localStore,n);if(a===null){e.O_.length===0&&r.o_();break}n=a.batchId,lye(e,a)}catch(a){await AS(e,a)}see(e)&&iee(e)}function oye(t){return Og(t)&&t.O_.length<10}function lye(t,e){t.O_.push(e);const r=Cm(t);r.r_()&&r.V_&&r.m_(e.mutations)}function see(t){return Og(t)&&!Cm(t).n_()&&t.O_.length>0}function iee(t){Cm(t).start()}async function cye(t){Cm(t).p_()}async function uye(t){const e=Cm(t);for(const r of t.O_)e.m_(r.mutations)}async function dye(t,e,r){const n=t.O_.shift(),a=r6.from(n,e,r);await aee(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await Bw(t)}async function fye(t,e){e&&Cm(t).V_&&await async function(n,a){if(function(o){return wZ(o)&&o!==fr.ABORTED}(a.code)){const s=n.O_.shift();Cm(n).s_(),await aee(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,a)),await Bw(n)}}(t,e),see(t)&&iee(t)}async function h9(t,e){const r=Un(t);r.asyncQueue.verifyOperationInProgress(),Fr("RemoteStore","RemoteStore received new credentials");const n=Og(r);r.L_.add(3),await Tw(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await kj(r)}async function hye(t,e){const r=Un(t);e?(r.L_.delete(2),await kj(r)):e||(r.L_.add(2),await Tw(r),r.q_.set("Unknown"))}function h1(t){return t.K_||(t.K_=function(r,n,a){const s=Un(r);return s.w_(),new J1e(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(t.datastore,t.asyncQueue,{Eo:nye.bind(null,t),Ro:aye.bind(null,t),mo:sye.bind(null,t),d_:iye.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),m6(t)?A6(t):t.q_.set("Unknown")):(await t.K_.stop(),nee(t))})),t.K_}function Cm(t){return t.U_||(t.U_=function(r,n,a){const s=Un(r);return s.w_(),new Z1e(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:cye.bind(null,t),mo:fye.bind(null,t),f_:uye.bind(null,t),g_:dye.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Bw(t)):(await t.U_.stop(),t.O_.length>0&&(Fr("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e,r,n,a,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=s,this.deferred=new gf,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,s){const o=Date.now()+n,l=new p6(e,r,o,a,s);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Hr(fr.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function g6(t,e){if(Ec("AsyncQueue",`${e}: ${t}`),Um(t))return new Hr(fr.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Jr.comparator(r.key,n.key):(r,n)=>Jr.comparator(r.key,n.key),this.keyedMap=Uy(),this.sortedSet=new Xs(this.comparator)}static emptySet(e){return new Av(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Av)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,s=n.getNext().key;if(!a.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Av;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A9{constructor(){this.W_=new Xs(Jr.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):dn():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Mv{constructor(e,r,n,a,s,o,l,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,a,s){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new Mv(e,r,Av.emptySet(r),o,n,a,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_j(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aye{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class mye{constructor(){this.queries=m9(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const a=Un(r),s=a.queries;a.queries=m9(),s.forEach((o,l)=>{for(const c of l.j_)c.onError(n)})})(this,new Hr(fr.ABORTED,"Firestore shutting down"))}}function m9(){return new Qm(t=>cZ(t),_j)}async function x6(t,e){const r=Un(t);let n=3;const a=e.query;let s=r.queries.get(a);s?!s.H_()&&e.J_()&&(n=2):(s=new Aye,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(a,!0);break;case 1:s.z_=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(o){const l=g6(o,`Initialization of query '${Sx(e.query)}' failed`);return void e.onError(l)}r.queries.set(a,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&y6(r)}async function v6(t,e){const r=Un(t),n=e.query;let a=3;const s=r.queries.get(n);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?a=e.J_()?0:1:!s.H_()&&e.J_()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function pye(t,e){const r=Un(t);let n=!1;for(const a of e){const s=a.query,o=r.queries.get(s);if(o){for(const l of o.j_)l.X_(a)&&(n=!0);o.z_=a}}n&&y6(r)}function gye(t,e,r){const n=Un(t),a=n.queries.get(e);if(a)for(const s of a.j_)s.onError(r);n.queries.delete(e)}function y6(t){t.Y_.forEach(e=>{e.next()})}var ck,p9;(p9=ck||(ck={})).ea="default",p9.Cache="cache";class b6{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new Mv(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Mv.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ck.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oee{constructor(e){this.key=e}}class lee{constructor(e){this.key=e}}class xye{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=na(),this.mutatedKeys=na(),this.Aa=uZ(e),this.Ra=new Av(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new A9,a=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,o=a,l=!1;const c=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,u=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((d,f)=>{const A=a.get(d),h=jw(this.query,f)?f:null,m=!!A&&this.mutatedKeys.has(A.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let x=!1;A&&h?A.data.isEqual(h.data)?m!==p&&(n.track({type:3,doc:h}),x=!0):this.ga(A,h)||(n.track({type:2,doc:h}),x=!0,(c&&this.Aa(h,c)>0||u&&this.Aa(h,u)<0)&&(l=!0)):!A&&h?(n.track({type:0,doc:h}),x=!0):A&&!h&&(n.track({type:1,doc:A}),x=!0,(c||u)&&(l=!0)),x&&(h?(o=o.add(h),s=p?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),n.track({type:1,doc:d})}return{Ra:o,fa:n,ns:l,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(h,m){const p=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return dn()}};return p(h)-p(m)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(n),a=a!=null&&a;const l=r&&!a?this.ya():[],c=this.da.size===0&&this.current&&!a?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new Mv(this.query,e.Ra,s,o,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new A9,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=na(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new lee(n))}),this.da.forEach(n=>{e.has(n)||r.push(new oee(n))}),r}ba(e){this.Ta=e.Ts,this.da=na();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Mv.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class vye{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class yye{constructor(e){this.key=e,this.va=!1}}class bye{constructor(e,r,n,a,s,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Qm(l=>cZ(l),_j),this.Ma=new Map,this.xa=new Set,this.Oa=new Xs(Jr.comparator),this.Na=new Map,this.La=new l6,this.Ba={},this.ka=new Map,this.qa=hg.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function wye(t,e,r=!0){const n=Aee(t);let a;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),a=s.view.Da()):a=await cee(n,e,r,!0),a}async function Nye(t,e){const r=Aee(t);await cee(r,e,!0,!1)}async function cee(t,e,r,n){const a=await G1e(t.localStore,jd(e)),s=a.targetId,o=t.sharedClientState.addLocalQueryTarget(s,r);let l;return n&&(l=await Cye(t,e,s,o==="current",a.resumeToken)),t.isPrimaryClient&&r&&tee(t.remoteStore,a),l}async function Cye(t,e,r,n,a){t.Ka=(f,A,h)=>async function(p,x,v,y){let b=x.view.ma(v);b.ns&&(b=await u9(p.localStore,x.query,!1).then(({documents:C})=>x.view.ma(C,b)));const w=y&&y.targetChanges.get(x.targetId),j=y&&y.targetMismatches.get(x.targetId)!=null,I=x.view.applyChanges(b,p.isPrimaryClient,w,j);return x9(p,x.targetId,I.wa),I.snapshot}(t,f,A,h);const s=await u9(t.localStore,e,!0),o=new xye(e,s.Ts),l=o.ma(s.documents),c=Pw.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),u=o.applyChanges(l,t.isPrimaryClient,c);x9(t,r,u.wa);const d=new vye(e,r,o);return t.Fa.set(e,d),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),u.snapshot}async function _ye(t,e,r){const n=Un(t),a=n.Fa.get(e),s=n.Ma.get(a.targetId);if(s.length>1)return n.Ma.set(a.targetId,s.filter(o=>!_j(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await lk(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),r&&f6(n.remoteStore,a.targetId),uk(n,a.targetId)}).catch(kg)):(uk(n,a.targetId),await lk(n.localStore,a.targetId,!0))}async function Eye(t,e){const r=Un(t),n=r.Fa.get(e),a=r.Ma.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),f6(r.remoteStore,n.targetId))}async function Sye(t,e,r){const n=mee(t);try{const a=await function(o,l){const c=Un(o),u=xr.now(),d=l.reduce((h,m)=>h.add(m.key),na());let f,A;return c.persistence.runTransaction("Locally write mutations","readwrite",h=>{let m=Ou(),p=na();return c.cs.getEntries(h,d).next(x=>{m=x,m.forEach((v,y)=>{y.isValidDocument()||(p=p.add(v))})}).next(()=>c.localDocuments.getOverlayedDocuments(h,m)).next(x=>{f=x;const v=[];for(const y of l){const b=Gve(y,f.get(y.key).overlayedDocument);b!=null&&v.push(new DA(y.key,b,eZ(b.value.mapValue),Ks.exists(!0)))}return c.mutationQueue.addMutationBatch(h,u,v,l)}).next(x=>{A=x;const v=x.applyToLocalDocumentSet(f,p);return c.documentOverlayCache.saveOverlays(h,x.batchId,v)})}).then(()=>({batchId:A.batchId,changes:fZ(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new Xs(qn)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(n,a.batchId,r),await kw(n,a.changes),await Bw(n.remoteStore)}catch(a){const s=g6(a,"Failed to persist write");r.reject(s)}}async function uee(t,e){const r=Un(t);try{const n=await V1e(r.localStore,e);e.targetChanges.forEach((a,s)=>{const o=r.Na.get(s);o&&(gn(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?o.va=!0:a.modifiedDocuments.size>0?gn(o.va):a.removedDocuments.size>0&&(gn(o.va),o.va=!1))}),await kw(r,n,e)}catch(n){await kg(n)}}function g9(t,e,r){const n=Un(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&a.push(l.snapshot)}),function(o,l){const c=Un(o);c.onlineState=l;let u=!1;c.queries.forEach((d,f)=>{for(const A of f.j_)A.Z_(l)&&(u=!0)}),u&&y6(c)}(n.eventManager,e),a.length&&n.Ca.d_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Iye(t,e,r){const n=Un(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Na.get(e),s=a&&a.key;if(s){let o=new Xs(Jr.comparator);o=o.insert(s,$s.newNoDocument(s,Cn.min()));const l=na().add(s),c=new Ij(Cn.min(),new Map,new Xs(qn),o,l);await uee(n,c),n.Oa=n.Oa.remove(s),n.Na.delete(e),w6(n)}else await lk(n.localStore,e,!1).then(()=>uk(n,e,r)).catch(kg)}async function jye(t,e){const r=Un(t),n=e.batch.batchId;try{const a=await Q1e(r.localStore,e);fee(r,n,null),dee(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await kw(r,a)}catch(a){await kg(a)}}async function Pye(t,e,r){const n=Un(t);try{const a=await function(o,l){const c=Un(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(f=>(gn(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(n.localStore,e);fee(n,e,r),dee(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await kw(n,a)}catch(a){await kg(a)}}function dee(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function fee(t,e,r){const n=Un(t);let a=n.Ba[n.currentUser.toKey()];if(a){const s=a.get(e);s&&(r?s.reject(r):s.resolve(),a=a.remove(e)),n.Ba[n.currentUser.toKey()]=a}}function uk(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||hee(t,n)})}function hee(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(f6(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),w6(t))}function x9(t,e,r){for(const n of r)n instanceof oee?(t.La.addReference(n.key,e),Tye(t,n)):n instanceof lee?(Fr("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||hee(t,n.key)):dn()}function Tye(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Fr("SyncEngine","New document in limbo: "+r),t.xa.add(n),w6(t))}function w6(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Jr(Pa.fromString(e)),n=t.qa.next();t.Na.set(n,new yye(r)),t.Oa=t.Oa.insert(r,n),tee(t.remoteStore,new Xh(jd(Iw(r.path)),n,"TargetPurposeLimboResolution",Nd.oe))}}async function kw(t,e,r){const n=Un(t),a=[],s=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((l,c)=>{o.push(n.Ka(c,e,r).then(u=>{var d;if((u||r)&&n.isPrimaryClient){const f=u?!u.fromCache:(d=r==null?void 0:r.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){a.push(u);const f=u6.Wi(c.targetId,u);s.push(f)}}))}),await Promise.all(o),n.Ca.d_(a),await async function(c,u){const d=Un(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Zt.forEach(u,A=>Zt.forEach(A.$i,h=>d.persistence.referenceDelegate.addReference(f,A.targetId,h)).next(()=>Zt.forEach(A.Ui,h=>d.persistence.referenceDelegate.removeReference(f,A.targetId,h)))))}catch(f){if(!Um(f))throw f;Fr("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const A=f.targetId;if(!f.fromCache){const h=d.os.get(A),m=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(m);d.os=d.os.insert(A,p)}}}(n.localStore,s))}async function Bye(t,e){const r=Un(t);if(!r.currentUser.isEqual(e)){Fr("SyncEngine","User change. New user:",e.toKey());const n=await YZ(r.localStore,e);r.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(c=>{c.reject(new Hr(fr.CANCELLED,o))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await kw(r,n.hs)}}function kye(t,e){const r=Un(t),n=r.Na.get(e);if(n&&n.va)return na().add(n.key);{let a=na();const s=r.Ma.get(e);if(!s)return a;for(const o of s){const l=r.Fa.get(o);a=a.unionWith(l.view.Va)}return a}}function Aee(t){const e=Un(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=uee.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=kye.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Iye.bind(null,e),e.Ca.d_=pye.bind(null,e.eventManager),e.Ca.$a=gye.bind(null,e.eventManager),e}function mee(t){const e=Un(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=jye.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Pye.bind(null,e),e}class C2{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Bj(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return XZ(this.persistence,new WZ,e.initialUser,this.serializer)}Ga(e){return new zZ(Tj.Zr,this.serializer)}Wa(e){return new ZZ}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}C2.provider={build:()=>new C2};class Fye extends C2{constructor(e,r,n){super(),this.Ja=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await mee(this.Ja.syncEngine),await Bw(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return XZ(this.persistence,new WZ,e.initialUser,this.serializer)}ja(e,r){const n=this.persistence.referenceDelegate.garbageCollector;return new w1e(n,e.asyncQueue,r)}Ha(e,r){const n=new Yxe(r,this.persistence);return new Xxe(e.asyncQueue,n)}Ga(e){const r=M1e(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Jc.withCacheSize(this.cacheSizeBytes):Jc.DEFAULT;return new c6(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,Y1e(),dE(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new ZZ}}class mS{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>g9(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Bye.bind(null,this.syncEngine),await hye(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new mye}()}createDatastore(e){const r=Bj(e.databaseInfo.databaseId),n=function(s){return new X1e(s)}(e.databaseInfo);return function(s,o,l,c){return new eye(s,o,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,a,s,o,l){return new rye(n,a,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>g9(this.syncEngine,r,0),function(){return f9.D()?new f9:new q1e}())}createSyncEngine(e,r){return function(a,s,o,l,c,u,d){const f=new bye(a,s,o,l,c,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(a){const s=Un(a);Fr("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Tw(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}mS.provider={build:()=>new mS};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ec("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oye{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Hr(fr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const r=await async function(a,s){const o=Un(a),l={documents:s.map(f=>w2(o.serializer,f))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,Pa.emptyPath(),l,s.length),u=new Map;c.forEach(f=>{const A=r1e(o.serializer,f);u.set(A.key.toString(),A)});const d=[];return s.forEach(f=>{const A=u.get(f.toString());gn(!!A),d.push(A)}),d}(this.datastore,e);return r.forEach(n=>this.recordVersion(n)),r}set(e,r){this.write(r.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,r){try{this.write(r.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new f1(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((r,n)=>{const a=Jr.fromPath(n);this.mutations.push(new e6(a,this.precondition(a)))}),await async function(n,a){const s=Un(n),o={writes:a.map(l=>N2(s.serializer,l))};await s.Mo("Commit",s.serializer.databaseId,Pa.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let r;if(e.isFoundDocument())r=e.version;else{if(!e.isNoDocument())throw dn();r=Cn.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!r.isEqual(n))throw new Hr(fr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),r)}precondition(e){const r=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&r?r.isEqual(Cn.min())?Ks.exists(!1):Ks.updateTime(r):Ks.none()}preconditionForUpdate(e){const r=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&r){if(r.isEqual(Cn.min()))throw new Hr(fr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ks.updateTime(r)}return Ks.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dye{constructor(e,r,n,a,s){this.asyncQueue=e,this.datastore=r,this.options=n,this.updateFunction=a,this.deferred=s,this._u=n.maxAttempts,this.t_=new d6(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new Oye(this.datastore),r=this.cu(e);r&&r.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(a=>{this.lu(a)}))}).catch(n=>{this.lu(n)})})}cu(e){try{const r=this.updateFunction(e);return!Ew(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const r=e.code;return r==="aborted"||r==="failed-precondition"||r==="already-exists"||!wZ(r)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rye{constructor(e,r,n,a,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=Cl.UNAUTHENTICATED,this.clientId=KD.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{Fr("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Fr("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new gf;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=g6(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function P3(t,e){t.asyncQueue.verifyOperationInProgress(),Fr("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async a=>{n.isEqual(a)||(await YZ(e.localStore,a),n=a)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function v9(t,e){t.asyncQueue.verifyOperationInProgress();const r=await Mye(t);Fr("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>h9(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,a)=>h9(e.remoteStore,a)),t._onlineComponents=e}async function Mye(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Fr("FirestoreClient","Using user provided OfflineComponentProvider");try{await P3(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(a){return a.name==="FirebaseError"?a.code===fr.FAILED_PRECONDITION||a.code===fr.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(r))throw r;ym("Error using user provided cache. Falling back to memory cache: "+r),await P3(t,new C2)}}else Fr("FirestoreClient","Using default OfflineComponentProvider"),await P3(t,new C2);return t._offlineComponents}async function C6(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Fr("FirestoreClient","Using user provided OnlineComponentProvider"),await v9(t,t._uninitializedComponentsProvider._online)):(Fr("FirestoreClient","Using default OnlineComponentProvider"),await v9(t,new mS))),t._onlineComponents}function Lye(t){return C6(t).then(e=>e.syncEngine)}function Uye(t){return C6(t).then(e=>e.datastore)}async function pS(t){const e=await C6(t),r=e.eventManager;return r.onListen=wye.bind(null,e.syncEngine),r.onUnlisten=_ye.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=Nye.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=Eye.bind(null,e.syncEngine),r}function Qye(t,e,r={}){const n=new gf;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const d=new N6({next:A=>{d.Za(),o.enqueueAndForget(()=>v6(s,f));const h=A.docs.has(l);!h&&A.fromCache?u.reject(new Hr(fr.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&A.fromCache&&c&&c.source==="server"?u.reject(new Hr(fr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(A)},error:A=>u.reject(A)}),f=new b6(Iw(l.path),d,{includeMetadataChanges:!0,_a:!0});return x6(s,f)}(await pS(t),t.asyncQueue,e,r,n)),n.promise}function Vye(t,e,r={}){const n=new gf;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,c,u){const d=new N6({next:A=>{d.Za(),o.enqueueAndForget(()=>v6(s,f)),A.fromCache&&c.source==="server"?u.reject(new Hr(fr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(A)},error:A=>u.reject(A)}),f=new b6(l,d,{includeMetadataChanges:!0,_a:!0});return x6(s,f)}(await pS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pee(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y9=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gee(t,e,r){if(!r)throw new Hr(fr.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function xee(t,e,r,n){if(e===!0&&n===!0)throw new Hr(fr.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function b9(t){if(!Jr.isDocumentKey(t))throw new Hr(fr.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function w9(t){if(Jr.isDocumentKey(t))throw new Hr(fr.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Fj(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":dn()}function al(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Hr(fr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Fj(t);throw new Hr(fr.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N9{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Hr(fr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Hr(fr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}xee("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=pee((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Hr(fr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Hr(fr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Hr(fr.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,a){return n.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Oj{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new N9({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Hr(fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Hr(fr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new N9(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new UJ;switch(n.type){case"firstParty":return new Vxe(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Hr(fr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=y9.get(r);n&&(Fr("ComponentProvider","Removing Datastore"),y9.delete(r),n.terminate())}(this),Promise.resolve()}}function vee(t,e,r,n={}){var a;const s=(t=al(t,Oj))._getSettings(),o=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&ym("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let l,c;if(typeof n.mockUserToken=="string")l=n.mockUserToken,c=Cl.MOCK_USER;else{l=ame(n.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new Hr(fr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Cl(u)}t._authCredentials=new Lxe(new LJ(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ah(this.firestore,e,this._query)}}class sl{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new sA(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new sl(this.firestore,e,this._key)}}class sA extends Ah{constructor(e,r,n){super(e,r,Iw(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new sl(this.firestore,null,new Jr(e))}withConverter(e){return new sA(this.firestore,e,this._path)}}function bt(t,e,...r){if(t=Ai(t),gee("collection","path",e),t instanceof Oj){const n=Pa.fromString(e,...r);return w9(n),new sA(t,null,n)}{if(!(t instanceof sl||t instanceof sA))throw new Hr(fr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Pa.fromString(e,...r));return w9(n),new sA(t.firestore,null,n)}}function Xt(t,e,...r){if(t=Ai(t),arguments.length===1&&(e=KD.newId()),gee("doc","path",e),t instanceof Oj){const n=Pa.fromString(e,...r);return b9(n),new sl(t,null,new Jr(n))}{if(!(t instanceof sl||t instanceof sA))throw new Hr(fr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Pa.fromString(e,...r));return b9(n),new sl(t.firestore,t instanceof sA?t.converter:null,new Jr(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C9{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new d6(this,"async_queue_retry"),this.Vu=()=>{const n=dE();n&&Fr("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=dE();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=dE();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new gf;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Um(e))throw e;Fr("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const a=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw Ec("INTERNAL UNHANDLED ERROR: ",a),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const a=p6.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(a),a}fu(){this.Eu&&dn()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function _9(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const a=r;for(const s of n)if(s in a&&typeof a[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Hu extends Oj{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new C9,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new C9(e),this._firestoreClient=void 0,await e}}}function yee(t,e){const r=typeof t=="object"?t:BD(),n=typeof t=="string"?t:"(default)",a=PD(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const s=rme("firestore");s&&vee(a,...s)}return a}function Dg(t){if(t._terminated)throw new Hr(fr.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||bee(t),t._firestoreClient}function bee(t){var e,r,n;const a=t._freezeSettings(),s=function(l,c,u,d){return new vve(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,pee(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((r=a.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=a.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new Rye(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function wee(t,e){ym("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings();return Hye(t,mS.provider,{build:n=>new Fye(n,r.cacheSizeBytes,void 0)}),Promise.resolve()}function Hye(t,e,r){if((t=al(t,Hu))._firestoreClient||t._terminated)throw new Hr(fr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Hr(fr.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},bee(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _m(Xi.fromBase64String(e))}catch(r){throw new Hr(fr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new _m(Xi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Hr(fr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dj{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Hr(fr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Hr(fr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return qn(this._lat,e._lat)||qn(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,a){if(n.length!==a.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==a[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $ye=/^__.*__$/;class Gye{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new DA(e,this.data,this.fieldMask,r,this.fieldTransforms):new d1(e,this.data,r,this.fieldTransforms)}}class Nee{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new DA(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Cee(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw dn()}}class Mj{constructor(e,r,n,a,s,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Mj(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Fu({path:n,xu:!1});return a.Ou(e),a}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Fu({path:n,xu:!1});return a.vu(),a}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return gS(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Cee(this.Cu)&&$ye.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Kye{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Bj(e)}Qu(e,r,n,a=!1){return new Mj({Cu:e,methodName:r,qu:n,path:Gs.emptyPath(),xu:!1,ku:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function A1(t){const e=t._freezeSettings(),r=Bj(t._databaseId);return new Kye(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Lj(t,e,r,n,a,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,r,a);I6("Data must be an object, but it was:",o,n);const l=_ee(n,o);let c,u;if(s.merge)c=new nu(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const f of s.mergeFields){const A=dk(e,f,r);if(!o.contains(A))throw new Hr(fr.INVALID_ARGUMENT,`Field '${A}' is specified in your field mask but missing from your input data.`);See(d,A)||d.push(A)}c=new nu(d),u=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=o.fieldTransforms;return new Gye(new Sl(l),c,u)}class Uj extends Fw{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Uj}}function qye(t,e,r){return new Mj({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:r},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class _6 extends Fw{constructor(e,r){super(e),this.Ku=r}_toFieldTransform(e){const r=qye(this,e,!0),n=this.Ku.map(s=>m1(s,r)),a=new ug(n);return new vZ(e.path,a)}isEqual(e){return e instanceof _6&&l2(this.Ku,e.Ku)}}function E6(t,e,r,n){const a=t.Qu(1,e,r);I6("Data must be an object, but it was:",a,n);const s=[],o=Sl.empty();Fg(n,(c,u)=>{const d=j6(e,c,r);u=Ai(u);const f=a.Nu(d);if(u instanceof Uj)s.push(d);else{const A=m1(u,f);A!=null&&(s.push(d),o.set(d,A))}});const l=new nu(s);return new Nee(o,l,a.fieldTransforms)}function S6(t,e,r,n,a,s){const o=t.Qu(1,e,r),l=[dk(e,n,r)],c=[a];if(s.length%2!=0)throw new Hr(fr.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let A=0;A<s.length;A+=2)l.push(dk(e,s[A])),c.push(s[A+1]);const u=[],d=Sl.empty();for(let A=l.length-1;A>=0;--A)if(!See(u,l[A])){const h=l[A];let m=c[A];m=Ai(m);const p=o.Nu(h);if(m instanceof Uj)u.push(h);else{const x=m1(m,p);x!=null&&(u.push(h),d.set(h,x))}}const f=new nu(u);return new Nee(d,f,o.fieldTransforms)}function zye(t,e,r,n=!1){return m1(r,t.Qu(n?4:3,e))}function m1(t,e){if(Eee(t=Ai(t)))return I6("Unsupported field value:",e,t),_ee(t,e);if(t instanceof Fw)return function(n,a){if(!Cee(a.Cu))throw a.Bu(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(a);s&&a.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,a){const s=[];let o=0;for(const l of n){let c=m1(l,a.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(n,a){if((n=Ai(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Lve(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=xr.fromDate(n);return{timestampValue:Rv(a.serializer,s)}}if(n instanceof xr){const s=new xr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Rv(a.serializer,s)}}if(n instanceof Dj)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof _m)return{bytesValue:EZ(a.serializer,n._byteString)};if(n instanceof sl){const s=a.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw a.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:s6(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof Rj)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return ZD(l.serializer,c)})}}}}}}(n,a);throw a.Bu(`Unsupported field value: ${Fj(n)}`)}(t,e)}function _ee(t,e){const r={};return XJ(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fg(t,(n,a)=>{const s=m1(a,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function Eee(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof xr||t instanceof Dj||t instanceof _m||t instanceof sl||t instanceof Fw||t instanceof Rj)}function I6(t,e,r){if(!Eee(r)||!function(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)}(r)){const n=Fj(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function dk(t,e,r){if((e=Ai(e))instanceof Rg)return e._internalPath;if(typeof e=="string")return j6(t,e);throw gS("Field path arguments must be of type string or ",t,!1,void 0,r)}const Wye=new RegExp("[~\\*/\\[\\]]");function j6(t,e,r){if(e.search(Wye)>=0)throw gS(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Rg(...e.split("."))._internalPath}catch{throw gS(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function gS(t,e,r,n,a){const s=n&&!n.isEmpty(),o=a!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${n}`),o&&(c+=` in document ${a}`),c+=")"),new Hr(fr.INVALID_ARGUMENT,l+t+c)}function See(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,r,n,a,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new sl(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Xye(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Qj("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Xye extends xS{data(){return super.data()}}function Qj(t,e){return typeof e=="string"?j6(t,e):e instanceof Rg?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iee(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Hr(fr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class P6{}class Vj extends P6{}function sr(t,e,...r){let n=[];e instanceof P6&&n.push(e),n=n.concat(r),function(s){const o=s.filter(c=>c instanceof Hj).length,l=s.filter(c=>c instanceof Ow).length;if(o>1||o>0&&l>0)throw new Hr(fr.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)t=a._apply(t);return t}class Ow extends Vj{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Ow(e,r,n)}_apply(e){const r=this._parse(e);return jee(e._query,r),new Ah(e.firestore,e.converter,ek(e._query,r))}_parse(e){const r=A1(e.firestore);return function(s,o,l,c,u,d,f){let A;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Hr(fr.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){S9(f,d);const h=[];for(const m of f)h.push(E9(c,s,m));A={arrayValue:{values:h}}}else A=E9(c,s,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||S9(f,d),A=zye(l,o,f,d==="in"||d==="not-in");return Aa.create(u,d,A)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Ar(t,e,r){const n=e,a=Qj("where",t);return Ow._create(a,n,r)}class Hj extends P6{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Hj(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ts.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(a,s){let o=a;const l=s.getFlattenedFilters();for(const c of l)jee(o,c),o=ek(o,c)}(e._query,r),new Ah(e.firestore,e.converter,ek(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class $j extends Vj{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new $j(e,r)}_apply(e){const r=function(a,s,o){if(a.startAt!==null)throw new Hr(fr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Hr(fr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new v2(s,o)}(e._query,this._field,this._direction);return new Ah(e.firestore,e.converter,function(a,s){const o=a.explicitOrderBy.concat([s]);return new u1(a.path,a.collectionGroup,o,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}(e._query,r))}}function In(t,e="asc"){const r=e,n=Qj("orderBy",t);return $j._create(n,r)}class Gj extends Vj{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new Gj(e,r,n)}_apply(e){return new Ah(e.firestore,e.converter,uS(e._query,this._limit,this._limitType))}}function vS(t){return Gj._create("limit",t,"F")}function E9(t,e,r){if(typeof(r=Ai(r))=="string"){if(r==="")throw new Hr(fr.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lZ(e)&&r.indexOf("/")!==-1)throw new Hr(fr.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Pa.fromString(r));if(!Jr.isDocumentKey(n))throw new Hr(fr.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return g2(t,new Jr(n))}if(r instanceof sl)return g2(t,r._key);throw new Hr(fr.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Fj(r)}.`)}function S9(t,e){if(!Array.isArray(t)||t.length===0)throw new Hr(fr.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function jee(t,e){const r=function(a,s){for(const o of a)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Hr(fr.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Hr(fr.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class T6{convertValue(e,r="none"){switch(lg(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(bm(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw dn()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Fg(e,(a,s)=>{n[a]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,a;const s=(a=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.map(o=>Vs(o.doubleValue));return new Rj(s)}convertGeoPoint(e){return new Dj(Vs(e.latitude),Vs(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=YD(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(m2(e));default:return null}}convertTimestamp(e){const r=vA(e);return new xr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Pa.fromString(e);gn(DZ(n));const a=new wm(n.get(1),n.get(3)),s=new Jr(n.popFirst(5));return a.isEqual(r)||Ec(`Document ${s} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kj(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Yye extends T6{constructor(e){super(),this.firestore=e}convertBytes(e){return new _m(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new sl(this.firestore,null,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class qj extends xS{constructor(e,r,n,a,s,o){super(e,r,n,a,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new yb(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Qj("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class yb extends qj{data(e={}){return super.data(e)}}class B6{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new Sp(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new yb(this._firestore,this._userDataWriter,n.key,n,new Sp(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Hr(fr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(a,s){if(a._snapshot.oldDocs.isEmpty()){let o=0;return a._snapshot.docChanges.map(l=>{const c=new yb(a._firestore,a._userDataWriter,l.doc.key,l.doc,new Sp(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const c=new yb(a._firestore,a._userDataWriter,l.doc.key,l.doc,new Sp(a._snapshot.mutatedKeys.has(l.doc.key),a._snapshot.fromCache),a.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:Jye(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function Jye(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return dn()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cs(t){t=al(t,sl);const e=al(t.firestore,Hu);return Qye(Dg(e),t._key).then(r=>Tee(e,t,r))}class zj extends T6{constructor(e){super(),this.firestore=e}convertBytes(e){return new _m(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new sl(this.firestore,null,r)}}function Ht(t){t=al(t,Ah);const e=al(t.firestore,Hu),r=Dg(e),n=new zj(e);return Iee(t._query),Vye(r,t._query).then(a=>new B6(e,n,t,a))}function Pee(t,e,r){t=al(t,sl);const n=al(t.firestore,Hu),a=Kj(t.converter,e,r);return p1(n,[Lj(A1(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,Ks.none())])}function kn(t,e,r,...n){t=al(t,sl);const a=al(t.firestore,Hu),s=A1(a);let o;return o=typeof(e=Ai(e))=="string"||e instanceof Rg?S6(s,"updateDoc",t._key,e,r,n):E6(s,"updateDoc",t._key,e),p1(a,[o.toMutation(t._key,Ks.exists(!0))])}function zn(t){return p1(al(t.firestore,Hu),[new f1(t._key,Ks.none())])}function Wn(t,e){const r=al(t.firestore,Hu),n=Xt(t),a=Kj(t.converter,e);return p1(r,[Lj(A1(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,Ks.exists(!1))]).then(()=>n)}function Pd(t,...e){var r,n,a;t=Ai(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||_9(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(_9(e[o])){const f=e[o];e[o]=(r=f.next)===null||r===void 0?void 0:r.bind(f),e[o+1]=(n=f.error)===null||n===void 0?void 0:n.bind(f),e[o+2]=(a=f.complete)===null||a===void 0?void 0:a.bind(f)}let c,u,d;if(t instanceof sl)u=al(t.firestore,Hu),d=Iw(t._key.path),c={next:f=>{e[o]&&e[o](Tee(u,t,f))},error:e[o+1],complete:e[o+2]};else{const f=al(t,Ah);u=al(f.firestore,Hu),d=f._query;const A=new zj(u);c={next:h=>{e[o]&&e[o](new B6(u,A,f,h))},error:e[o+1],complete:e[o+2]},Iee(t._query)}return function(A,h,m,p){const x=new N6(p),v=new b6(h,x,m);return A.asyncQueue.enqueueAndForget(async()=>x6(await pS(A),v)),()=>{x.Za(),A.asyncQueue.enqueueAndForget(async()=>v6(await pS(A),v))}}(Dg(u),d,l,c)}function p1(t,e){return function(n,a){const s=new gf;return n.asyncQueue.enqueueAndForget(async()=>Sye(await Lye(n),a,s)),s.promise}(Dg(t),e)}function Tee(t,e,r){const n=r.docs.get(e._key),a=new zj(t);return new qj(t,a,e._key,n,new Sp(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zye={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bee{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=A1(e)}set(e,r,n){this._verifyNotCommitted();const a=U0(e,this._firestore),s=Kj(a.converter,r,n),o=Lj(this._dataReader,"WriteBatch.set",a._key,s,a.converter!==null,n);return this._mutations.push(o.toMutation(a._key,Ks.none())),this}update(e,r,n,...a){this._verifyNotCommitted();const s=U0(e,this._firestore);let o;return o=typeof(r=Ai(r))=="string"||r instanceof Rg?S6(this._dataReader,"WriteBatch.update",s._key,r,n,a):E6(this._dataReader,"WriteBatch.update",s._key,r),this._mutations.push(o.toMutation(s._key,Ks.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=U0(e,this._firestore);return this._mutations=this._mutations.concat(new f1(r._key,Ks.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Hr(fr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function U0(t,e){if((t=Ai(t)).firestore!==e)throw new Hr(fr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kee extends class{constructor(r,n){this._firestore=r,this._transaction=n,this._dataReader=A1(r)}get(r){const n=U0(r,this._firestore),a=new Yye(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return dn();const o=s[0];if(o.isFoundDocument())return new xS(this._firestore,a,o.key,o,n.converter);if(o.isNoDocument())return new xS(this._firestore,a,n._key,null,n.converter);throw dn()})}set(r,n,a){const s=U0(r,this._firestore),o=Kj(s.converter,n,a),l=Lj(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,a);return this._transaction.set(s._key,l),this}update(r,n,a,...s){const o=U0(r,this._firestore);let l;return l=typeof(n=Ai(n))=="string"||n instanceof Rg?S6(this._dataReader,"Transaction.update",o._key,n,a,s):E6(this._dataReader,"Transaction.update",o._key,n),this._transaction.update(o._key,l),this}delete(r){const n=U0(r,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,r){super(e,r),this._firestore=e}get(e){const r=U0(e,this._firestore),n=new zj(this._firestore);return super.get(e).then(a=>new qj(this._firestore,n,r._key,a._document,new Sp(!1,!1),r.converter))}}function qs(t,e,r){t=al(t,Hu);const n=Object.assign(Object.assign({},Zye),r);return function(s){if(s.maxAttempts<1)throw new Hr(fr.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,o,l){const c=new gf;return s.asyncQueue.enqueueAndForget(async()=>{const u=await Uye(s);new Dye(s.asyncQueue,u,l,o,c).au()}),c.promise}(Dg(t),a=>e(new kee(t,a)),n)}function Fee(...t){return new _6("arrayUnion",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sc(t){return Dg(t=al(t,Hu)),new Bee(t,e=>p1(t,e))}(function(e,r=!0){(function(a){c1=a})(o1),Tv(new ag("firestore",(n,{instanceIdentifier:a,options:s})=>{const o=n.getProvider("app").getImmediate(),l=new Hu(new Uxe(n.getProvider("auth-internal")),new $xe(n.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Hr(fr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wm(u.options.projectId,d)}(o,a),o);return s=Object.assign({useFetchStreams:r},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),um(v7,"4.7.3",e),um(v7,"4.7.3","esm2017")})();const ebe=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:T6,Bytes:_m,CollectionReference:sA,DocumentReference:sl,DocumentSnapshot:qj,FieldPath:Rg,FieldValue:Fw,Firestore:Hu,FirestoreError:Hr,GeoPoint:Dj,Query:Ah,QueryCompositeFilterConstraint:Hj,QueryConstraint:Vj,QueryDocumentSnapshot:yb,QueryFieldFilterConstraint:Ow,QueryLimitConstraint:Gj,QueryOrderByConstraint:$j,QuerySnapshot:B6,SnapshotMetadata:Sp,Timestamp:xr,Transaction:kee,VectorValue:Rj,WriteBatch:Bee,_AutoId:KD,_ByteString:Xi,_DatabaseId:wm,_DocumentKey:Jr,_EmptyAuthCredentialsProvider:UJ,_FieldPath:Gs,_cast:al,_logWarn:ym,_validateIsNotUsedTogether:xee,addDoc:Wn,arrayUnion:Fee,collection:bt,connectFirestoreEmulator:vee,deleteDoc:zn,doc:Xt,enableIndexedDbPersistence:wee,ensureFirestoreConfigured:Dg,executeWrite:p1,getDoc:Cs,getDocs:Ht,getFirestore:yee,limit:vS,onSnapshot:Pd,orderBy:In,query:sr,runTransaction:qs,setDoc:Pee,updateDoc:kn,where:Ar,writeBatch:Sc},Symbol.toStringTag,{value:"Module"})),tbe={apiKey:"AIzaSyA_ZzeP_DAoXeRuallrOaJ4xFaxjnuhw-8",authDomain:"posys-103de.firebaseapp.com",projectId:"posys-103de",storageBucket:"posys-103de.firebasestorage.app",messagingSenderId:"401054148688",appId:"1:401054148688:web:1c2aea9e8b40958b514955",measurementId:"G-Q2GWQXMFLX"},Oee=TD(tbe),je=yee(Oee),Ic=GB(Oee),rbe=(async()=>{try{return await tE(Ic,QD),console.info(" Auth persistence: browserLocalPersistence enabled"),"local"}catch(t){console.warn(" browserLocalPersistence failed:",(t==null?void 0:t.code)||t)}try{return await tE(Ic,PJ),console.info(" Auth persistence: indexedDBLocalPersistence enabled"),"indexeddb"}catch(t){console.warn(" indexedDBLocalPersistence failed:",(t==null?void 0:t.code)||t)}try{return await tE(Ic,VD),console.info(" Auth persistence: browserSessionPersistence enabled (session only)"),"session"}catch(t){console.warn(" browserSessionPersistence failed:",(t==null?void 0:t.code)||t)}return console.warn(" No se pudo establecer ninguna persistencia para Auth."),"none"})();wee(je).catch(t=>{t.code==="failed-precondition"?console.warn(" Ya hay otra pestaa usando persistencia."):t.code==="unimplemented"?console.warn(" El navegador no soporta persistencia offline."):console.error(" Error en persistencia offline:",t)});function nbe(){const[t,e]=g.useState(""),[r,n]=g.useState(""),[a,s]=g.useState(!1),[o,l]=g.useState(""),[c,u]=g.useState(!1),d=xw();g.useEffect(()=>{let h=!0;const m=yj(Ic,async p=>{if(!(!p||!h))try{const x=await Cs(Xt(je,"users",p.uid));if(!x.exists())return;const v=x.data(),y=Array.isArray(v.roles)?v.roles:v.role?[v.role]:[],b=y[0]||"",w=v.name||"";localStorage.setItem("user_email",p.email||""),w&&localStorage.setItem("user_name",w),localStorage.setItem("roles",JSON.stringify(y)),y.length===1?f(b):d("/admin",{replace:!0})}catch{}});return()=>{h=!1,m()}},[d]);const f=h=>{if(Array.isArray(h)){if(h.length!==1)return localStorage.setItem("role",h[0]||""),d("/admin");h=h[0]||""}const m=String(h||"");if(localStorage.setItem("role",m),Sn(m,"admin"))return d("/admin");if(Sn(m,"vendedor_pollo"))return d("/admin/salesV2");if(Sn(m,"vendedor_ropa"))return d("/admin/salesClothes");if(Sn(m,"vendedor_dulces"))return d("/admin/salesCandies");if(Sn(m,"supervisor_pollo")||Sn(m,"contador"))return d("/admin/batches")},A=async h=>{if(h.preventDefault(),l(""),!t.trim()){l("Ingresa el correo.");return}if(r.length<6){l("La contrasea debe tener al menos 6 caracteres.");return}try{u(!0),console.info&&console.info("[Login] attempting signIn",{email:t}),await tE(Ic,QD);const m=await _ge(Ic,t,r);console.info&&console.info("[Login] signInWithEmailAndPassword success",{uid:m.user.uid,email:m.user.email});const p=m.user.uid;localStorage.setItem("POSYS_LOGIN_AT",String(Date.now()));const x=await Cs(Xt(je,"users",p));if(console.info&&console.info("[Login] firestore users doc snap: exists=",x.exists()),!x.exists()){console.warn&&console.warn("[Login] user doc missing for uid",p),l("Tu usuario no tiene perfil en la base de datos.");return}const v=x.data();console.info&&console.info("[Login] user profile:",v);const y=Array.isArray(v.roles)?v.roles:v.role?[v.role]:[],b=y[0]||"",w=v.name||"",j=["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces","supervisor_pollo","contador"];if(!y.some(I=>j.includes(I))){l("Rol no vlido. Consulta al administrador.");return}localStorage.setItem("user_email",m.user.email||""),w&&localStorage.setItem("user_name",w),localStorage.setItem("roles",JSON.stringify(y)),y.length===1?f(b):d("/admin")}catch(m){console.error&&console.error("[Login] sign-in error:",m);const p=String((m==null?void 0:m.code)||"");l(p==="auth/invalid-credential"||p==="auth/wrong-password"?"Credenciales incorrectas. ("+p+")":p==="auth/user-not-found"?"Usuario no encontrado. ("+p+")":p==="auth/too-many-requests"?"Demasiados intentos. Intenta ms tarde. ("+p+")":((m==null?void 0:m.message)||"Error al iniciar sesin.")+(p?` (${p})`:""))}finally{u(!1)}};return i.jsx("div",{className:"min-h-screen grid place-items-center ",children:i.jsxs("form",{onSubmit:A,className:"w-[92%] max-w-md bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Iniciar Sesin"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border rounded-2xl px-3 py-2 mb-3 shadow-2xl",value:t,onChange:h=>e(h.target.value),autoComplete:"username"}),i.jsx("label",{className:"block text-sm font-semibold",children:"Contrasea"}),i.jsxs("div",{className:"flex gap-2 mb-2",children:[i.jsx("input",{type:a?"text":"password",className:"flex-1 border rounded-2xl px-3 py-2 shadow-2xl",value:r,onChange:h=>n(h.target.value),minLength:6,autoComplete:"current-password"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-2xl shadow-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>s(h=>!h),children:a?"Ocultar":"Mostrar"})]}),i.jsx("div",{className:"text-xs text-gray-600 mb-3",children:"Mnimo 6 caracteres (requisito de Firebase)."}),i.jsx("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded-2xl shadow-2xl hover:bg-blue-700 disabled:opacity-60",disabled:c,children:c?"Entrando...":"Entrar"}),o&&i.jsx("p",{className:`mt-3 text-sm ${o.startsWith("Error")||o.includes("no vlido")?"text-red-600":"text-gray-700"}`,children:o})]})})}function Kn({children:t,allowedRoles:e}){const[r,n]=g.useState(!0),[a,s]=g.useState(!1);return g.useEffect(()=>{const o=yj(Ic,async l=>{if(l){const c=Xt(je,"users",l.uid),u=await Cs(c);if(u.exists()){const d=u.data(),f=Array.isArray(d.roles)?d.roles:d.role?[d.role]:[];try{typeof window<"u"&&window.location&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?console.info&&console.info("[PrivateRoute] uid:",l.uid,"roleFromDoc:",role,"allowedRoles:",e):console.debug&&console.debug("[PrivateRoute] uid:",l.uid,"roleFromDoc:",role,"allowedRoles:",e)}catch{}let A=!1;for(const h of e)if(Sn(f,h)){A=!0;break}s(A)}else try{typeof window<"u"&&window.location&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?console.info&&console.info("[PrivateRoute] no user doc for uid:",l.uid):console.debug&&console.debug("[PrivateRoute] no user doc for uid:",l.uid)}catch{}}n(!1)});return()=>o()},[e]),r?i.jsx("div",{className:"p-4",children:"Cargando..."}):a?t:i.jsx(Rh,{to:"/"})}const abe={admin:{billing:{view:!0,edit:!0}},supervisor_pollo:{bills:{view:!0,edit:!1},expenses:{view:!0,edit:!1},customersPollo:{view:!0,edit:!1},transactionsPollo:{view:!0,edit:!1},batches:{view:!0,edit:!1}},contador:{billing:{view:!0,edit:!0},salesV2:{view:!0,edit:!0},customersPollo:{view:!0,edit:!0},batches:{view:!0,edit:!0},transactionsPollo:{view:!0,edit:!1},bills:{view:!0,edit:!1},expenses:{view:!0,edit:!0},financialDashboard:{view:!0,edit:!1},polloCashAudits:{view:!0,edit:!0}},vendedor_pollo:{salesV2:{view:!0,edit:!0},transactionsPollo:{view:!0,edit:!1},bills:{view:!0,edit:!1},customersPollo:{view:!0,edit:!0}},vendedor_dulces:{salesCandies:{view:!0,edit:!0},productsVendorsCandies:{view:!0,edit:!1},productsPricesCandies:{view:!0,edit:!1},transactionCandies:{view:!0,edit:!1},cierreVentasCandies:{view:!0,edit:!1},customersCandies:{view:!0,edit:!0}},vendedor_ropa:{}};function Dee(t){return t?Array.isArray(t)?t.filter(Boolean):[t].filter(Boolean):[]}function ea(t,e,r="view"){const n=Dee(t);return n.some(a=>a==="admin")?!0:n.some(a=>{var s,o;return!!((o=(s=abe[a])==null?void 0:s[e])!=null&&o[r])})}const sbe={admin:{},supervisor_pollo:{bills:{cerrarVentas:!1},batches:{create:!1,update:!1,delete:!1,export:!1}},contador:{batches:{create:!0,update:!1,delete:!1,export:!0},bills:{cerrarVentas:!1}},vendedor_pollo:{salesV2:{create:!0,update:!0},customersPollo:{update:!0},bills:{cerrarVentas:!0}},vendedor_dulces:{salesCandies:{create:!0,update:!0},productsVendorsCandies:{create:!0,update:!1,delete:!1},customersCandies:{update:!0},productsPricesCandies:{price_edit:!1}},vendedor_ropa:{}};function ibe(t,e,r){const n=Dee(t);return n.some(a=>a==="admin")?!0:ea(t,e,"view")?n.some(a=>{var o;const s=(o=sbe[a])==null?void 0:o[e];return!!(s!=null&&s[r])}):!1}function obe({role:t,roles:e}){const r="/admin",n=({isActive:re})=>`block rounded px-3 py-2 text-sm ${re?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"}`,a=xw(),[s,o]=g.useState(!1),[l,c]=g.useState(!1),[u,d]=g.useState(!1),[f,A]=g.useState(!1),[h,m]=g.useState(!1),[p,x]=g.useState(!1),[v,y]=g.useState(!1),[b,w]=g.useState(!1),[j,I]=g.useState(!1),[C,S]=g.useState(!1),[E,B]=g.useState(!1),[k,T]=g.useState(!1),[P,K]=g.useState(!1),[le,oe]=g.useState(!1),[ie,Ae]=g.useState(!1),[te,Te]=g.useState(!1),[Ue,O]=g.useState(!1),[H,G]=g.useState(!1),L=async()=>{G(!0)},W=async()=>{try{await UD(Ic)}catch(re){console.error("signOut error:",re)}finally{try{localStorage.removeItem("user_name"),localStorage.removeItem("user_email"),localStorage.removeItem("roles"),localStorage.removeItem("role")}catch{}G(!1),a("/")}},X=({open:re,onClick:J,children:Re})=>i.jsxs("button",{type:"button",onClick:J,className:"w-full flex items-center justify-between px-3 py-2 text-left text-sm font-semibold rounded hover:bg-gray-100",children:[i.jsx("span",{children:Re}),i.jsx("span",{className:"text-xs",children:re?"":""})]}),D=({open:re,onClick:J,title:Re})=>i.jsxs("button",{type:"button",onClick:J,className:"ml-2 w-[calc(100%-0.5rem)] flex items-center justify-between px-3 py-2 text-left text-sm rounded hover:bg-gray-100",children:[i.jsx("span",{className:"text-blue-500 font-medium ",children:Re}),i.jsx("span",{className:"text-xs",children:re?"":""})]}),Q=e&&e.length?e:t,Z=Sn(Q,"admin");Sn(Q,"vendedor_pollo");const be=Sn(Q,"vendedor_ropa");Sn(Q,"vendedor_dulces"),Sn(Q,"supervisor_pollo")||Sn(Q,"contador"),Sn(Q,"contador");const U=ea(Q,"salesV2","view")||ea(Q,"customersPollo","view")||ea(Q,"transactionsPollo","view")||ea(Q,"bills","view")||ea(Q,"expenses","view")||ea(Q,"batches","view"),ze=ea(Q,"salesCandies","view")||ea(Q,"productsVendorsCandies","view")||ea(Q,"customersCandies","view")||ea(Q,"productsPricesCandies","view")||ea(Q,"transactionCandies","view")||ea(Q,"cierreVentasCandies","view");return i.jsxs("div",{className:"min-h-screen flex",children:[i.jsxs("aside",{className:`${s?"w-15 bg-gray-50 border-r p-3 transition-all duration-300 flex flex-col items-center":"w-55"} bg-[#f1f3f7] border-r p-3 transition-all duration-300 flex flex-col`,children:[i.jsx("button",{onClick:()=>o(!s),className:"mb-2 p-2 rounded-2xl shadow-2xl bg-gray-300 hover:bg-gray-400","aria-label":s?"Expandir men":"Colapsar men",children:s?i.jsx("span",{title:"Expandir men",children:"Menu "}):i.jsx("span",{title:"Colapsar men",children:"Cerrar "})}),!s&&i.jsxs(i.Fragment,{children:[i.jsxs("nav",{className:"space-y-1",children:[Z&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(X,{open:l,onClick:()=>c(re=>!re),children:"Pollos Bea"}),l&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:p,onClick:()=>x(re=>!re),title:"Operaciones"}),p&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(vn,{to:`${r}/salesV2`,className:n,children:"Vender"}),i.jsx(vn,{to:`${r}/customersPollo`,className:n,children:"Saldo Pendientes"}),i.jsx(vn,{to:`${r}/transactionsPollo`,className:n,children:"Transacciones"}),i.jsx(vn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"})]}),i.jsx(D,{open:u,onClick:()=>d(re=>!re),title:"Inventarios"}),u&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(vn,{to:`${r}/batches`,className:n,children:"Inventario Pollo"}),i.jsx(vn,{to:`${r}/paidBatches`,className:n,children:"Inventarios Pagados"}),i.jsx(vn,{to:`${r}/billing`,className:n,children:"Facturacion"})]}),i.jsx(D,{open:f,onClick:()=>A(re=>!re),title:"Finanzas"}),f&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(vn,{to:`${r}/financialDashboard`,className:n,children:"Dashboard"}),i.jsx(vn,{to:`${r}/billing`,className:n,children:"Facturacion"}),i.jsx(vn,{to:`${r}/expenses`,className:n,children:"Gastos"}),i.jsx(vn,{to:`${r}/polloCashAudits`,className:n,children:"Arqueos Caja"}),i.jsx(vn,{to:`${r}/salesV2`,className:n,children:"Venta"}),i.jsx(vn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"}),i.jsx(vn,{to:`${r}/billhistoric`,className:n,children:"Historial de Cierres"})]}),i.jsx(D,{open:h,onClick:()=>m(re=>!re),title:"Productos"}),h&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/products`,className:n,children:"Productos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(X,{open:v,onClick:()=>y(re=>!re),children:"Gonper"}),v&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:b,onClick:()=>w(re=>!re),title:"Inventarios"}),b&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/notebooksInventory`,className:n,children:"Productos y Precios"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(X,{open:P,onClick:()=>K(re=>!re),children:"CandyShop"}),P&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:ie,onClick:()=>Ae(re=>!re),title:"Vendedores"}),ie&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/salesCandies`,className:n,children:"Venta"})}),ie&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/productsVendorsCandies`,className:n,children:"Sub ordenes"})}),ie&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/productsPricesCandies`,className:n,children:"Precios Venta"})}),i.jsx(D,{open:le,onClick:()=>oe(re=>!re),title:"Inventario"}),le&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/mainordersCandies`,className:n,children:"Ordenes Maestras"})}),le&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/inventoryMainOrderCandies`,className:n,children:"Lista de Ordenes"})}),le&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/inventoryCandies`,className:n,children:"Lista Productos"})}),le&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/productsCandies`,className:n,children:"Productos"})}),i.jsx(D,{open:te,onClick:()=>Te(re=>!re),title:"Finanzas"}),te&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/datacenter`,className:n,children:"Data Center"})}),te&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/cashDeliveries`,className:n,children:"Entregas Cash"})}),te&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/transactionCandies`,className:n,children:"Transacciones"})}),te&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/cierreVentasCandies`,className:n,children:"Cierres"})}),te&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/reporteCierresCandies`,className:n,children:"Reporte Cierres"})}),te&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/billingsCandies`,className:n,children:"Facturas"})}),te&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/consolidatedVendors`,className:n,children:"Consolidado Vendedores"})}),te&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/dashboardCandies`,className:n,children:"Dashboard"})}),te&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/customersCandies`,className:n,children:"Clientes"})}),te&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/vendorsCandies`,className:n,children:"Vendedores"})}),te&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/expensesCandies`,className:n,children:"Gastos"})})]})]}),i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(X,{open:Ue,onClick:()=>O(re=>!re),children:"Operaciones Otras"}),Ue&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[i.jsx(vn,{to:`${r}/users`,className:n,children:"Usuarios"}),i.jsx(vn,{to:`${r}/fix`,className:n,children:"Fix de lotes"}),i.jsx(vn,{to:`${r}/transactionclose`,className:n,children:"Liquidaciones"})]})]})]}),!Z&&U&&i.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[i.jsx(X,{open:l,onClick:()=>c(re=>!re),children:"Pollos Bea"}),l&&i.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[ea(Q,"salesV2")&&i.jsx(vn,{to:`${r}/salesV2`,className:n,children:"Vender"}),ea(Q,"financialDashboard")&&i.jsx(vn,{to:`${r}/financialDashboard`,className:n,children:"Dashboard"}),ea(Q,"batches")&&i.jsx(vn,{to:`${r}/batches`,className:n,children:"Inventario Pollo"}),ea(Q,"bills")&&i.jsx(vn,{to:`${r}/bills`,className:n,children:"Cierre Ventas"}),ea(Q,"transactionsPollo")&&i.jsx(vn,{to:`${r}/transactionsPollo`,className:n,children:"Transacciones"}),ea(Q,"billing")&&i.jsx(vn,{to:`${r}/billing`,className:n,children:"Facturacion"}),ea(Q,"expenses")&&i.jsx(vn,{to:`${r}/expenses`,className:n,children:"Gastos"}),Sn(Q,"contador")&&i.jsx(vn,{to:`${r}/polloCashAudits`,className:n,children:"Arqueos Caja"}),ea(Q,"customersPollo")&&i.jsx(vn,{to:`${r}/customersPollo`,className:n,children:"Saldos Pendientes"})]})]}),!Z&&ze&&i.jsxs("div",{className:"border rounded",children:[i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:ea(Q,"salesCandies")&&i.jsx(vn,{to:`${r}/salesCandies`,className:n,children:"Venta"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:ea(Q,"transactionCandies")&&i.jsx(vn,{to:`${r}/transactionCandies`,className:n,children:"Ventas del dia"})}),i.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:ea(Q,"cierreVentasCandies")&&i.jsx(vn,{to:`${r}/cierreVentasCandies`,className:n,children:"Cierre de Ventas"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:ea(Q,"productsVendorsCandies")&&i.jsx(vn,{to:`${r}/productsVendorsCandies`,className:n,children:"Pedidos"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:ea(Q,"customersCandies")&&i.jsx(vn,{to:`${r}/customersCandies`,className:n,children:"Clientes"})}),i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:ea(Q,"productsPricesCandies")&&i.jsx(vn,{to:`${r}/productsPricesCandies`,className:n,children:"Precios Venta"})})]}),be&&i.jsxs("div",{className:"border rounded",children:[i.jsx(X,{open:v,onClick:()=>y(re=>!re),children:"Operaciones Ropa"}),v&&i.jsxs("div",{className:"pb-2",children:[i.jsx(D,{open:E,onClick:()=>B(re=>!re),title:"Ventas"}),E&&i.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[i.jsx(vn,{to:`${r}/salesClothes`,className:n,children:"Venta Ropa"}),i.jsx(vn,{to:`${r}/TransactionsReportClothes`,className:n,children:"Transacciones"})]}),i.jsx(D,{open:j,onClick:()=>I(re=>!re),title:"Productos"}),j&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/productsClothes`,className:n,children:"Agregar Productos"})}),i.jsx(D,{open:C,onClick:()=>S(re=>!re),title:"Clientes"}),C&&i.jsx("div",{className:"ml-4 mt-1 space-y-1",children:i.jsx(vn,{to:`${r}/CustomersClothes`,className:n,children:"Listado de Clientes"})})]})]})]}),i.jsx("button",{onClick:L,className:"mt-4 bg-red-500 text-white px-3 py-2 rounded-2xl shadow-2xl hover:bg-red-600",children:"Cerrar sesin"}),i.jsx("div",{className:"mt-2 text-[20px] text-gray-700",children:typeof window<"u"&&(localStorage.getItem("user_name")||localStorage.getItem("user_email"))}),H&&i.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/20",onClick:()=>G(!1)}),i.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-lg z-[130] w-[90%] max-w-sm",children:[i.jsx("div",{className:"font-semibold mb-3",children:"Ests seguro de cerrar sesin?"}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>G(!1),className:"px-3 py-2 rounded bg-gray-200",children:"No"}),i.jsx("button",{onClick:W,className:"px-3 py-2 rounded bg-red-500 text-white",children:"SI"})]})]})]})]})]}),i.jsx("main",{className:"flex-1 p-6",children:i.jsx(FY,{})})]})}function cy(...t){return t.filter(Boolean).join(" ")}function lbe({role:t,roles:e}){const r=xw(),n=BA(),a="/admin",s=e&&e.length?e:t,o=Sn(s,"admin"),l=Sn(s,"vendedor_pollo"),c=Sn(s,"vendedor_dulces"),u=Sn(s,"supervisor_pollo")||Sn(s,"contador"),d=Sn(s,"contador"),f=ea(s,"salesV2","view")||ea(s,"batches","view")||ea(s,"bills","view")||ea(s,"transactionsPollo","view")||ea(s,"customersPollo","view");ea(s,"billing","view");const A=ea(s,"salesCandies","view")||ea(s,"productsVendorsCandies","view")||ea(s,"customersCandies","view")||ea(s,"productsPricesCandies","view")||ea(s,"transactionCandies","view")||ea(s,"cierreVentasCandies","view"),h=f&&A,[m,p]=g.useState(()=>{try{const B=typeof window<"u"?localStorage.getItem("rubro"):null;if(B==="POLLO"||B==="DULCES")return B}catch{}return f?"POLLO":A?"DULCES":"POLLO"}),[x,v]=g.useState(!1),[y,b]=g.useState(!1),w=g.useMemo(()=>{let B=[];if(o||h){if(m==="POLLO")if(o)B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"invPag",label:"Factura",to:`${a}/paidBatches`},{key:"gastos",label:"Gastos",to:`${a}/expenses`},{key:"arqueos",label:"Arqueos Caja",to:`${a}/polloCashAudits`}];else if(u){const P=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"facturacion",label:"Facturacin",to:`${a}/billing`}];Sn(s,"contador")&&(B=P)}else l?B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:d?B=[{key:"venta",label:"Vender",to:`${a}/salesV2`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"cierre",label:"Cierre Ventas",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"bills",label:"Facturacin",to:`${a}/billing`}]:B=[{key:"home",label:"Inicio",to:`${a}`}];m==="DULCES"&&(o?B=[{key:"dc",label:"Data Center Reporte",to:`${a}/datacenter`},{key:"maes",label:"Inventario Maestro",to:`${a}/mainordersCandies`},{key:"ord",label:"Inventario Vendedor",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas del dia",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre de ventas",to:`${a}/cierreVentasCandies`},{key:"cash",label:"Entregas Efectivo ",to:`${a}/cashDeliveries`},{key:"items",label:"Productos",to:`${a}/productsCandies`},{key:"precios",label:"Precio Ventas",to:`${a}/productsPricesCandies`},{key:"gonper",label:"Productos Gonper",to:`${a}/notebooksInventory`}]:c?B=[{key:"venta",label:"Vender",to:`${a}/salesCandies`},{key:"precios",label:"Precios",to:`${a}/productsPricesCandies`},{key:"ped",label:"Inventario",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre",to:`${a}/cierreVentasCandies`}]:B=[{key:"home",label:"Inicio",to:`${a}`}])}else if(u){const P=[{key:"venta",label:"Venta",to:`${a}/salesV2`},{key:"dash",label:"Dashboard",to:`${a}/financialDashboard`},{key:"inv",label:"Inventario",to:`${a}/batches`},{key:"clientes",label:"Saldos Pendientes",to:`${a}/customersPollo`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`},{key:"cierre",label:"Cierre",to:`${a}/bills`},{key:"facturacion",label:"Facturacin",to:`${a}/billing`}];Sn(s,"contador")?B=[...P,{key:"arqueos",label:"Arqueos Caja",to:`${a}/polloCashAudits`}]:B=P}else l?B=[{key:"venta",label:"Venta",to:`${a}/salesV2`},{key:"cierre",label:"Cierre",to:`${a}/bills`},{key:"trxs",label:"Transacciones",to:`${a}/transactionsPollo`}]:c?B=[{key:"venta",label:"Vender",to:`${a}/salesCandies`},{key:"precios",label:"Precios",to:`${a}/productsPricesCandies`},{key:"ped",label:"Inventario",to:`${a}/productsVendorsCandies`},{key:"cli",label:"Saldos Pendientes",to:`${a}/customersCandies`},{key:"trx",label:"Ventas",to:`${a}/transactionCandies`},{key:"cier",label:"Cierre",to:`${a}/cierreVentasCandies`}]:B=[{key:"home",label:"Inicio",to:`${a}`}];const k=new Set(["bills","customersPollo","transactionsPollo","batches","salesV2","financialDashboard","polloCashAudits","billing","salesCandies","productsVendorsCandies","productsPricesCandies","transactionCandies","cierreVentasCandies","customersCandies"]);return B.filter(P=>{const le=P.to.replace(`${a}/`,"");return k.has(le)?ea(s,le,"view"):!0})},[a,m,o,h,u,l,c,d,s]);g.useEffect(()=>{if((o||h)&&w.length){try{localStorage.setItem("rubro",m)}catch{}r(w[0].to,{replace:!0})}},[m]),g.useEffect(()=>{x&&v(!1)},[n.pathname]),g.useEffect(()=>{const B=k=>{k.key==="Escape"&&v(!1)};return x&&window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[x]);const j=async()=>{b(!0)},I=async()=>{try{await UD(Ic)}catch(B){console.error("signOut error:",B)}finally{try{localStorage.removeItem("user_name"),localStorage.removeItem("user_email"),localStorage.removeItem("roles"),localStorage.removeItem("role")}catch{}b(!1),v(!1),r("/")}},C=({isActive:B})=>cy("flex-1 text-center text-[11px] py-1.5 rounded-lg","leading-none select-none",B?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),S=w.length<=2,E=({isActive:B})=>cy("w-full flex items-center justify-between px-4 py-3 rounded-xl border",B?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50");return i.jsxs("div",{className:"min-h-screen bg-[#f1f3f7] flex flex-col",children:[i.jsx("header",{className:"sticky top-0 z-50 bg-white border-b shadow-sm",children:i.jsxs("div",{className:"px-3 py-3 flex items-center gap-2",children:[o||h?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",onClick:()=>p("POLLO"),className:cy("px-3 py-2 rounded-2xl text-sm font-semibold",m==="POLLO"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Carniceria"}),i.jsx("button",{type:"button",onClick:()=>p("DULCES"),className:cy("px-3 py-2 rounded-2xl text-sm font-semibold",m==="DULCES"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Mr. Candy"})]}):i.jsx("div",{className:"text-sm font-semibold text-gray-800",children:l?"Pollos Bea":c?"CandyShop":"Posys"}),i.jsx("div",{className:"ml-auto flex items-center gap-2",children:i.jsx("button",{type:"button",onClick:()=>v(!0),className:"px-3 py-2 rounded-2xl bg-gray-100 text-gray-800 text-sm font-bold shadow hover:bg-gray-200","aria-label":"Abrir men",title:"Men",children:""})})]})}),x&&i.jsxs("div",{className:"fixed inset-0 z-[80]",children:[i.jsx("button",{type:"button",className:"absolute inset-0 bg-black/40",onClick:()=>v(!1),"aria-label":"Cerrar men"}),i.jsxs("aside",{className:"absolute right-0 top-0 h-full w-[86%] max-w-sm bg-white shadow-2xl border-l flex flex-col",children:[i.jsxs("div",{className:"p-4 border-b",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"font-bold text-gray-900",children:"Men"}),i.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200",children:""})]}),i.jsx("div",{className:"mt-2 text-[20px] text-gray-600",children:typeof window<"u"&&(localStorage.getItem("user_name")||localStorage.getItem("user_email"))})]}),i.jsx("div",{className:"p-3 flex-1 overflow-y-auto space-y-2",children:w.map(B=>i.jsxs(vn,{to:B.to,className:E,children:[i.jsx("span",{className:"font-semibold",children:B.label}),i.jsx("span",{className:"text-sm opacity-80",children:""})]},B.key))}),i.jsxs("div",{className:"p-3 border-t space-y-2 pb-[calc(12px+env(safe-area-inset-bottom))]",children:[i.jsx("button",{onClick:j,className:"w-full px-4 py-3 rounded-xl bg-red-500 text-white font-semibold shadow hover:bg-red-600",children:"Cerrar sesin"}),y&&i.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/20",onClick:()=>b(!1)}),i.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-lg z-[130] w-[90%] max-w-sm",children:[i.jsx("div",{className:"font-semibold mb-3",children:"Ests seguro de cerrar sesin?"}),i.jsxs("div",{className:"flex gap-2 justify-end",children:[i.jsx("button",{onClick:()=>b(!1),className:"px-3 py-2 rounded bg-gray-200",children:"No"}),i.jsx("button",{onClick:I,className:"px-3 py-2 rounded bg-red-500 text-white",children:"SI"})]})]})]})]})]})]}),i.jsx("main",{className:cy("flex-1 overflow-y-auto px-3 pt-3",S?"pb-[calc(92px+env(safe-area-inset-bottom))]":"pb-[calc(16px+env(safe-area-inset-bottom))]"),children:i.jsx(FY,{})}),S&&i.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white border-t shadow-md pb-[env(safe-area-inset-bottom)]",children:i.jsx("div",{className:"max-w-3xl mx-auto px-2 py-1.5 flex gap-1.5",children:w.map(B=>i.jsx(vn,{to:B.to,className:C,children:B.label},B.key))})})]})}const Ree=6048e5,cbe=864e5,ube=6e4,dbe=36e5,fbe=1e3,I9=Symbol.for("constructDateFrom");function fo(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&I9 in t?t[I9](e):t instanceof Date?new t.constructor(e):new Date(e)}function mi(t,e){return fo(e||t,t)}function k6(t,e,r){const n=mi(t,r==null?void 0:r.in);return isNaN(e)?fo((r==null?void 0:r.in)||t,NaN):(e&&n.setDate(n.getDate()+e),n)}function hbe(t,e,r){const n=mi(t,r==null?void 0:r.in);if(isNaN(e))return fo(t,NaN);const a=n.getDate(),s=fo(t,n.getTime());s.setMonth(n.getMonth()+e+1,0);const o=s.getDate();return a>=o?s:(n.setFullYear(s.getFullYear(),s.getMonth(),a),n)}let Abe={};function g1(){return Abe}function Em(t,e){var l,c,u,d;const r=g1(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,a=mi(t,e==null?void 0:e.in),s=a.getDay(),o=(s<n?7:0)+s-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Lv(t,e){return Em(t,{...e,weekStartsOn:1})}function Mee(t,e){const r=mi(t,e==null?void 0:e.in),n=r.getFullYear(),a=fo(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const s=Lv(a),o=fo(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=Lv(o);return r.getTime()>=s.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function yS(t){const e=mi(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function mbe(t,...e){const r=fo.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function j9(t,e){const r=mi(t,e==null?void 0:e.in);return r.setHours(0,0,0,0),r}function pbe(t,e,r){const[n,a]=mbe(r==null?void 0:r.in,t,e),s=j9(n),o=j9(a),l=+s-yS(s),c=+o-yS(o);return Math.round((l-c)/cbe)}function gbe(t,e){const r=Mee(t,e),n=fo(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Lv(n)}function xbe(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function F6(t){return!(!xbe(t)&&typeof t!="number"||isNaN(+mi(t)))}function Ud(t,e){const r=mi(t,e==null?void 0:e.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function Qd(t,e){const r=mi(t,e==null?void 0:e.in);return r.setDate(1),r.setHours(0,0,0,0),r}function vbe(t,e){const r=mi(t,e==null?void 0:e.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const ybe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},bbe=(t,e,r)=>{let n;const a=ybe[t];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function T3(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const wbe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Nbe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Cbe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},_be={date:T3({formats:wbe,defaultWidth:"full"}),time:T3({formats:Nbe,defaultWidth:"full"}),dateTime:T3({formats:Cbe,defaultWidth:"full"})},Ebe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Sbe=(t,e,r,n)=>Ebe[t];function uy(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;a=t.values[l]||t.values[o]}const s=t.argumentCallback?t.argumentCallback(e):e;return a[s]}}const Ibe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},jbe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Pbe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Tbe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Bbe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},kbe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Fbe=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Obe={ordinalNumber:Fbe,era:uy({values:Ibe,defaultWidth:"wide"}),quarter:uy({values:jbe,defaultWidth:"wide",argumentCallback:t=>t-1}),month:uy({values:Pbe,defaultWidth:"wide"}),day:uy({values:Tbe,defaultWidth:"wide"}),dayPeriod:uy({values:Bbe,defaultWidth:"wide",formattingValues:kbe,defaultFormattingWidth:"wide"})};function dy(t){return(e,r={})=>{const n=r.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],s=e.match(a);if(!s)return null;const o=s[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?Rbe(l,f=>f.test(o)):Dbe(l,f=>f.test(o));let u;u=t.valueCallback?t.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=e.slice(o.length);return{value:u,rest:d}}}function Dbe(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function Rbe(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function Mbe(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const a=n[0],s=e.match(t.parsePattern);if(!s)return null;let o=t.valueCallback?t.valueCallback(s[0]):s[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(a.length);return{value:o,rest:l}}}const Lbe=/^(\d+)(th|st|nd|rd)?/i,Ube=/\d+/i,Qbe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Vbe={any:[/^b/i,/^(a|c)/i]},Hbe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},$be={any:[/1/i,/2/i,/3/i,/4/i]},Gbe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Kbe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},qbe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},zbe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Wbe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Xbe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Ybe={ordinalNumber:Mbe({matchPattern:Lbe,parsePattern:Ube,valueCallback:t=>parseInt(t,10)}),era:dy({matchPatterns:Qbe,defaultMatchWidth:"wide",parsePatterns:Vbe,defaultParseWidth:"any"}),quarter:dy({matchPatterns:Hbe,defaultMatchWidth:"wide",parsePatterns:$be,defaultParseWidth:"any",valueCallback:t=>t+1}),month:dy({matchPatterns:Gbe,defaultMatchWidth:"wide",parsePatterns:Kbe,defaultParseWidth:"any"}),day:dy({matchPatterns:qbe,defaultMatchWidth:"wide",parsePatterns:zbe,defaultParseWidth:"any"}),dayPeriod:dy({matchPatterns:Wbe,defaultMatchWidth:"any",parsePatterns:Xbe,defaultParseWidth:"any"})},Lee={code:"en-US",formatDistance:bbe,formatLong:_be,formatRelative:Sbe,localize:Obe,match:Ybe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Jbe(t,e){const r=mi(t,e==null?void 0:e.in);return pbe(r,vbe(r))+1}function Uee(t,e){const r=mi(t,e==null?void 0:e.in),n=+Lv(r)-+gbe(r);return Math.round(n/Ree)+1}function O6(t,e){var d,f,A,h;const r=mi(t,e==null?void 0:e.in),n=r.getFullYear(),a=g1(),s=(e==null?void 0:e.firstWeekContainsDate)??((f=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(A=a.locale)==null?void 0:A.options)==null?void 0:h.firstWeekContainsDate)??1,o=fo((e==null?void 0:e.in)||t,0);o.setFullYear(n+1,0,s),o.setHours(0,0,0,0);const l=Em(o,e),c=fo((e==null?void 0:e.in)||t,0);c.setFullYear(n,0,s),c.setHours(0,0,0,0);const u=Em(c,e);return+r>=+l?n+1:+r>=+u?n:n-1}function Zbe(t,e){var l,c,u,d;const r=g1(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,a=O6(t,e),s=fo((e==null?void 0:e.in)||t,0);return s.setFullYear(a,0,n),s.setHours(0,0,0,0),Em(s,e)}function Qee(t,e){const r=mi(t,e==null?void 0:e.in),n=+Em(r,e)-+Zbe(r,e);return Math.round(n/Ree)+1}function Ya(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const d0={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return Ya(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):Ya(r+1,2)},d(t,e){return Ya(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return Ya(t.getHours()%12||12,e.length)},H(t,e){return Ya(t.getHours(),e.length)},m(t,e){return Ya(t.getMinutes(),e.length)},s(t,e){return Ya(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Ya(a,e.length)}},sx={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},P9={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return d0.y(t,e)},Y:function(t,e,r,n){const a=O6(t,n),s=a>0?a:1-a;if(e==="YY"){const o=s%100;return Ya(o,2)}return e==="Yo"?r.ordinalNumber(s,{unit:"year"}):Ya(s,e.length)},R:function(t,e){const r=Mee(t);return Ya(r,e.length)},u:function(t,e){const r=t.getFullYear();return Ya(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return Ya(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return Ya(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return d0.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return Ya(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const a=Qee(t,n);return e==="wo"?r.ordinalNumber(a,{unit:"week"}):Ya(a,e.length)},I:function(t,e,r){const n=Uee(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):Ya(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):d0.d(t,e)},D:function(t,e,r){const n=Jbe(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Ya(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const a=t.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return Ya(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const a=t.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return Ya(s,e.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),a=n===0?7:n;switch(e){case"i":return String(a);case"ii":return Ya(a,e.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let a;switch(n===12?a=sx.noon:n===0?a=sx.midnight:a=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let a;switch(n>=17?a=sx.evening:n>=12?a=sx.afternoon:n>=4?a=sx.morning:a=sx.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return d0.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):d0.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Ya(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):Ya(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):d0.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):d0.s(t,e)},S:function(t,e){return d0.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return B9(n);case"XXXX":case"XX":return fp(n);case"XXXXX":case"XXX":default:return fp(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return B9(n);case"xxxx":case"xx":return fp(n);case"xxxxx":case"xxx":default:return fp(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+T9(n,":");case"OOOO":default:return"GMT"+fp(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+T9(n,":");case"zzzz":default:return"GMT"+fp(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return Ya(n,e.length)},T:function(t,e,r){return Ya(+t,e.length)}};function T9(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),s=n%60;return s===0?r+String(a):r+String(a)+e+Ya(s,2)}function B9(t,e){return t%60===0?(t>0?"-":"+")+Ya(Math.abs(t)/60,2):fp(t,e)}function fp(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=Ya(Math.trunc(n/60),2),s=Ya(n%60,2);return r+a+e+s}const k9=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Vee=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},e2e=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return k9(t,e);let s;switch(n){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",k9(n,e)).replace("{{time}}",Vee(a,e))},fk={p:Vee,P:e2e},t2e=/^D+$/,r2e=/^Y+$/,n2e=["D","DD","YY","YYYY"];function Hee(t){return t2e.test(t)}function $ee(t){return r2e.test(t)}function hk(t,e,r){const n=a2e(t,e,r);if(console.warn(n),n2e.includes(t))throw new RangeError(n)}function a2e(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const s2e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,i2e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,o2e=/^'([^]*?)'?$/,l2e=/''/g,c2e=/[a-zA-Z]/;function Ur(t,e,r){var d,f,A,h;const n=g1(),a=n.locale??Lee,s=n.firstWeekContainsDate??((f=(d=n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,o=n.weekStartsOn??((h=(A=n.locale)==null?void 0:A.options)==null?void 0:h.weekStartsOn)??0,l=mi(t,r==null?void 0:r.in);if(!F6(l))throw new RangeError("Invalid time value");let c=e.match(i2e).map(m=>{const p=m[0];if(p==="p"||p==="P"){const x=fk[p];return x(m,a.formatLong)}return m}).join("").match(s2e).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const p=m[0];if(p==="'")return{isToken:!1,value:u2e(m)};if(P9[p])return{isToken:!0,value:m};if(p.match(c2e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:m}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const u={firstWeekContainsDate:s,weekStartsOn:o,locale:a};return c.map(m=>{if(!m.isToken)return m.value;const p=m.value;($ee(p)||Hee(p))&&hk(p,e,String(t));const x=P9[p[0]];return x(l,p,a.localize,u)}).join("")}function u2e(t){const e=t.match(o2e);return e?e[1].replace(l2e,"'"):t}function d2e(){return Object.assign({},g1())}function f2e(t,e){const r=mi(t,e==null?void 0:e.in).getDay();return r===0?7:r}function h2e(t,e){const r=A2e(e)?new e(0):fo(e,0);return r.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),r.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),r}function A2e(t){var e;return typeof t=="function"&&((e=t.prototype)==null?void 0:e.constructor)===t}const m2e=10;class Gee{constructor(){Tr(this,"subPriority",0)}validate(e,r){return!0}}class p2e extends Gee{constructor(e,r,n,a,s){super(),this.value=e,this.validateValue=r,this.setValue=n,this.priority=a,s&&(this.subPriority=s)}validate(e,r){return this.validateValue(e,this.value,r)}set(e,r,n){return this.setValue(e,r,this.value,n)}}class g2e extends Gee{constructor(r,n){super();Tr(this,"priority",m2e);Tr(this,"subPriority",-1);this.context=r||(a=>fo(n,a))}set(r,n){return n.timestampIsSet?r:fo(r,h2e(r,this.context))}}let Ra=class{run(e,r,n,a){const s=this.parse(e,r,n,a);return s?{setter:new p2e(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(e,r,n){return!0}};class x2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",140);Tr(this,"incompatibleTokens",["R","u","t","T"])}parse(r,n,a){switch(n){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})||a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"})}}set(r,n,a){return n.era=a,r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}}const qi={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},zf={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function zi(t,e){return t&&{value:e(t.value),rest:t.rest}}function ci(t,e){const r=e.match(t);return r?{value:parseInt(r[0],10),rest:e.slice(r[0].length)}:null}function Wf(t,e){const r=e.match(t);if(!r)return null;if(r[0]==="Z")return{value:0,rest:e.slice(1)};const n=r[1]==="+"?1:-1,a=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,o=r[5]?parseInt(r[5],10):0;return{value:n*(a*dbe+s*ube+o*fbe),rest:e.slice(r[0].length)}}function Kee(t){return ci(qi.anyDigitsSigned,t)}function Pi(t,e){switch(t){case 1:return ci(qi.singleDigit,e);case 2:return ci(qi.twoDigits,e);case 3:return ci(qi.threeDigits,e);case 4:return ci(qi.fourDigits,e);default:return ci(new RegExp("^\\d{1,"+t+"}"),e)}}function bS(t,e){switch(t){case 1:return ci(qi.singleDigitSigned,e);case 2:return ci(qi.twoDigitsSigned,e);case 3:return ci(qi.threeDigitsSigned,e);case 4:return ci(qi.fourDigitsSigned,e);default:return ci(new RegExp("^-?\\d{1,"+t+"}"),e)}}function D6(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function qee(t,e){const r=e>0,n=r?e:1-e;let a;if(n<=50)a=t||100;else{const s=n+50,o=Math.trunc(s/100)*100,l=t>=s%100;a=t+o-(l?100:0)}return r?a:1-a}function zee(t){return t%400===0||t%4===0&&t%100!==0}class v2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",130);Tr(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(r,n,a){const s=o=>({year:o,isTwoDigitYear:n==="yy"});switch(n){case"y":return zi(Pi(4,r),s);case"yo":return zi(a.ordinalNumber(r,{unit:"year"}),s);default:return zi(Pi(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,a){const s=r.getFullYear();if(a.isTwoDigitYear){const l=qee(a.year,s);return r.setFullYear(l,0,1),r.setHours(0,0,0,0),r}const o=!("era"in n)||n.era===1?a.year:1-a.year;return r.setFullYear(o,0,1),r.setHours(0,0,0,0),r}}class y2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",130);Tr(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(r,n,a){const s=o=>({year:o,isTwoDigitYear:n==="YY"});switch(n){case"Y":return zi(Pi(4,r),s);case"Yo":return zi(a.ordinalNumber(r,{unit:"year"}),s);default:return zi(Pi(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,a,s){const o=O6(r,s);if(a.isTwoDigitYear){const c=qee(a.year,o);return r.setFullYear(c,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),Em(r,s)}const l=!("era"in n)||n.era===1?a.year:1-a.year;return r.setFullYear(l,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),Em(r,s)}}class b2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",130);Tr(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(r,n){return bS(n==="R"?4:n.length,r)}set(r,n,a){const s=fo(r,0);return s.setFullYear(a,0,4),s.setHours(0,0,0,0),Lv(s)}}class w2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",130);Tr(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(r,n){return bS(n==="u"?4:n.length,r)}set(r,n,a){return r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}}class N2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",120);Tr(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"Q":case"QQ":return Pi(n.length,r);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"})||a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(r,{width:"wide",context:"formatting"})||a.quarter(r,{width:"abbreviated",context:"formatting"})||a.quarter(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=1&&n<=4}set(r,n,a){return r.setMonth((a-1)*3,1),r.setHours(0,0,0,0),r}}class C2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",120);Tr(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"q":case"qq":return Pi(n.length,r);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"})||a.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(r,{width:"wide",context:"standalone"})||a.quarter(r,{width:"abbreviated",context:"standalone"})||a.quarter(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=1&&n<=4}set(r,n,a){return r.setMonth((a-1)*3,1),r.setHours(0,0,0,0),r}}class _2e extends Ra{constructor(){super(...arguments);Tr(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);Tr(this,"priority",110)}parse(r,n,a){const s=o=>o-1;switch(n){case"M":return zi(ci(qi.month,r),s);case"MM":return zi(Pi(2,r),s);case"Mo":return zi(a.ordinalNumber(r,{unit:"month"}),s);case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"})||a.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(r,{width:"wide",context:"formatting"})||a.month(r,{width:"abbreviated",context:"formatting"})||a.month(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.setMonth(a,1),r.setHours(0,0,0,0),r}}class E2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",110);Tr(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(r,n,a){const s=o=>o-1;switch(n){case"L":return zi(ci(qi.month,r),s);case"LL":return zi(Pi(2,r),s);case"Lo":return zi(a.ordinalNumber(r,{unit:"month"}),s);case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"})||a.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(r,{width:"wide",context:"standalone"})||a.month(r,{width:"abbreviated",context:"standalone"})||a.month(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.setMonth(a,1),r.setHours(0,0,0,0),r}}function S2e(t,e,r){const n=mi(t,r==null?void 0:r.in),a=Qee(n,r)-e;return n.setDate(n.getDate()-a*7),mi(n,r==null?void 0:r.in)}class I2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",100);Tr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(r,n,a){switch(n){case"w":return ci(qi.week,r);case"wo":return a.ordinalNumber(r,{unit:"week"});default:return Pi(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,a,s){return Em(S2e(r,a,s),s)}}function j2e(t,e,r){const n=mi(t,r==null?void 0:r.in),a=Uee(n,r)-e;return n.setDate(n.getDate()-a*7),n}class P2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",100);Tr(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(r,n,a){switch(n){case"I":return ci(qi.week,r);case"Io":return a.ordinalNumber(r,{unit:"week"});default:return Pi(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,a){return Lv(j2e(r,a))}}const T2e=[31,28,31,30,31,30,31,31,30,31,30,31],B2e=[31,29,31,30,31,30,31,31,30,31,30,31];class k2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",90);Tr(this,"subPriority",1);Tr(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"d":return ci(qi.date,r);case"do":return a.ordinalNumber(r,{unit:"date"});default:return Pi(n.length,r)}}validate(r,n){const a=r.getFullYear(),s=zee(a),o=r.getMonth();return s?n>=1&&n<=B2e[o]:n>=1&&n<=T2e[o]}set(r,n,a){return r.setDate(a),r.setHours(0,0,0,0),r}}class F2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",90);Tr(this,"subpriority",1);Tr(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(r,n,a){switch(n){case"D":case"DD":return ci(qi.dayOfYear,r);case"Do":return a.ordinalNumber(r,{unit:"date"});default:return Pi(n.length,r)}}validate(r,n){const a=r.getFullYear();return zee(a)?n>=1&&n<=366:n>=1&&n<=365}set(r,n,a){return r.setMonth(0,a),r.setHours(0,0,0,0),r}}function R6(t,e,r){var f,A,h,m;const n=g1(),a=(r==null?void 0:r.weekStartsOn)??((A=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:A.weekStartsOn)??n.weekStartsOn??((m=(h=n.locale)==null?void 0:h.options)==null?void 0:m.weekStartsOn)??0,s=mi(t,r==null?void 0:r.in),o=s.getDay(),c=(e%7+7)%7,u=7-a,d=e<0||e>6?e-(o+u)%7:(c+u)%7-(o+u)%7;return k6(s,d,r)}class O2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",90);Tr(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(r,n,a){switch(n){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=R6(r,a,s),r.setHours(0,0,0,0),r}}class D2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",90);Tr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(r,n,a,s){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+s.weekStartsOn+6)%7+c};switch(n){case"e":case"ee":return zi(Pi(n.length,r),o);case"eo":return zi(a.ordinalNumber(r,{unit:"day"}),o);case"eee":return a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"eeeee":return a.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=R6(r,a,s),r.setHours(0,0,0,0),r}}class R2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",90);Tr(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(r,n,a,s){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+s.weekStartsOn+6)%7+c};switch(n){case"c":case"cc":return zi(Pi(n.length,r),o);case"co":return zi(a.ordinalNumber(r,{unit:"day"}),o);case"ccc":return a.day(r,{width:"abbreviated",context:"standalone"})||a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"});case"ccccc":return a.day(r,{width:"narrow",context:"standalone"});case"cccccc":return a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return a.day(r,{width:"wide",context:"standalone"})||a.day(r,{width:"abbreviated",context:"standalone"})||a.day(r,{width:"short",context:"standalone"})||a.day(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=6}set(r,n,a,s){return r=R6(r,a,s),r.setHours(0,0,0,0),r}}function M2e(t,e,r){const n=mi(t,r==null?void 0:r.in),a=f2e(n,r),s=e-a;return k6(n,s,r)}class L2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",90);Tr(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(r,n,a){const s=o=>o===0?7:o;switch(n){case"i":case"ii":return Pi(n.length,r);case"io":return a.ordinalNumber(r,{unit:"day"});case"iii":return zi(a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s);case"iiiii":return zi(a.day(r,{width:"narrow",context:"formatting"}),s);case"iiiiii":return zi(a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s);case"iiii":default:return zi(a.day(r,{width:"wide",context:"formatting"})||a.day(r,{width:"abbreviated",context:"formatting"})||a.day(r,{width:"short",context:"formatting"})||a.day(r,{width:"narrow",context:"formatting"}),s)}}validate(r,n){return n>=1&&n<=7}set(r,n,a){return r=M2e(r,a),r.setHours(0,0,0,0),r}}class U2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",80);Tr(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(r,n,a){switch(n){case"a":case"aa":case"aaa":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(D6(a),0,0,0),r}}class Q2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",80);Tr(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(r,n,a){switch(n){case"b":case"bb":case"bbb":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(D6(a),0,0,0),r}}class V2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",80);Tr(this,"incompatibleTokens",["a","b","t","T"])}parse(r,n,a){switch(n){case"B":case"BB":case"BBB":return a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(r,{width:"wide",context:"formatting"})||a.dayPeriod(r,{width:"abbreviated",context:"formatting"})||a.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,a){return r.setHours(D6(a),0,0,0),r}}class H2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",70);Tr(this,"incompatibleTokens",["H","K","k","t","T"])}parse(r,n,a){switch(n){case"h":return ci(qi.hour12h,r);case"ho":return a.ordinalNumber(r,{unit:"hour"});default:return Pi(n.length,r)}}validate(r,n){return n>=1&&n<=12}set(r,n,a){const s=r.getHours()>=12;return s&&a<12?r.setHours(a+12,0,0,0):!s&&a===12?r.setHours(0,0,0,0):r.setHours(a,0,0,0),r}}class $2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",70);Tr(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(r,n,a){switch(n){case"H":return ci(qi.hour23h,r);case"Ho":return a.ordinalNumber(r,{unit:"hour"});default:return Pi(n.length,r)}}validate(r,n){return n>=0&&n<=23}set(r,n,a){return r.setHours(a,0,0,0),r}}class G2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",70);Tr(this,"incompatibleTokens",["h","H","k","t","T"])}parse(r,n,a){switch(n){case"K":return ci(qi.hour11h,r);case"Ko":return a.ordinalNumber(r,{unit:"hour"});default:return Pi(n.length,r)}}validate(r,n){return n>=0&&n<=11}set(r,n,a){return r.getHours()>=12&&a<12?r.setHours(a+12,0,0,0):r.setHours(a,0,0,0),r}}class K2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",70);Tr(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(r,n,a){switch(n){case"k":return ci(qi.hour24h,r);case"ko":return a.ordinalNumber(r,{unit:"hour"});default:return Pi(n.length,r)}}validate(r,n){return n>=1&&n<=24}set(r,n,a){const s=a<=24?a%24:a;return r.setHours(s,0,0,0),r}}class q2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",60);Tr(this,"incompatibleTokens",["t","T"])}parse(r,n,a){switch(n){case"m":return ci(qi.minute,r);case"mo":return a.ordinalNumber(r,{unit:"minute"});default:return Pi(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,a){return r.setMinutes(a,0,0),r}}class z2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",50);Tr(this,"incompatibleTokens",["t","T"])}parse(r,n,a){switch(n){case"s":return ci(qi.second,r);case"so":return a.ordinalNumber(r,{unit:"second"});default:return Pi(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,a){return r.setSeconds(a,0),r}}class W2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",30);Tr(this,"incompatibleTokens",["t","T"])}parse(r,n){const a=s=>Math.trunc(s*Math.pow(10,-n.length+3));return zi(Pi(n.length,r),a)}set(r,n,a){return r.setMilliseconds(a),r}}class X2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",10);Tr(this,"incompatibleTokens",["t","T","x"])}parse(r,n){switch(n){case"X":return Wf(zf.basicOptionalMinutes,r);case"XX":return Wf(zf.basic,r);case"XXXX":return Wf(zf.basicOptionalSeconds,r);case"XXXXX":return Wf(zf.extendedOptionalSeconds,r);case"XXX":default:return Wf(zf.extended,r)}}set(r,n,a){return n.timestampIsSet?r:fo(r,r.getTime()-yS(r)-a)}}class Y2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",10);Tr(this,"incompatibleTokens",["t","T","X"])}parse(r,n){switch(n){case"x":return Wf(zf.basicOptionalMinutes,r);case"xx":return Wf(zf.basic,r);case"xxxx":return Wf(zf.basicOptionalSeconds,r);case"xxxxx":return Wf(zf.extendedOptionalSeconds,r);case"xxx":default:return Wf(zf.extended,r)}}set(r,n,a){return n.timestampIsSet?r:fo(r,r.getTime()-yS(r)-a)}}class J2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",40);Tr(this,"incompatibleTokens","*")}parse(r){return Kee(r)}set(r,n,a){return[fo(r,a*1e3),{timestampIsSet:!0}]}}class Z2e extends Ra{constructor(){super(...arguments);Tr(this,"priority",20);Tr(this,"incompatibleTokens","*")}parse(r){return Kee(r)}set(r,n,a){return[fo(r,a),{timestampIsSet:!0}]}}const ewe={G:new x2e,y:new v2e,Y:new y2e,R:new b2e,u:new w2e,Q:new N2e,q:new C2e,M:new _2e,L:new E2e,w:new I2e,I:new P2e,d:new k2e,D:new F2e,E:new O2e,e:new D2e,c:new R2e,i:new L2e,a:new U2e,b:new Q2e,B:new V2e,h:new H2e,H:new $2e,K:new G2e,k:new K2e,m:new q2e,s:new z2e,S:new W2e,X:new X2e,x:new Y2e,t:new J2e,T:new Z2e},twe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,rwe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,nwe=/^'([^]*?)'?$/,awe=/''/g,swe=/\S/,iwe=/[a-zA-Z]/;function wS(t,e,r,n){var x,v,y,b;const a=()=>fo(r,NaN),s=d2e(),o=s.locale??Lee,l=s.firstWeekContainsDate??((v=(x=s.locale)==null?void 0:x.options)==null?void 0:v.firstWeekContainsDate)??1,c=s.weekStartsOn??((b=(y=s.locale)==null?void 0:y.options)==null?void 0:b.weekStartsOn)??0;if(!e)return t?a():mi(r,n==null?void 0:n.in);const u={firstWeekContainsDate:l,weekStartsOn:c,locale:o},d=[new g2e(n==null?void 0:n.in,r)],f=e.match(rwe).map(w=>{const j=w[0];if(j in fk){const I=fk[j];return I(w,o.formatLong)}return w}).join("").match(twe),A=[];for(let w of f){$ee(w)&&hk(w,e,t),Hee(w)&&hk(w,e,t);const j=w[0],I=ewe[j];if(I){const{incompatibleTokens:C}=I;if(Array.isArray(C)){const E=A.find(B=>C.includes(B.token)||B.token===j);if(E)throw new RangeError(`The format string mustn't contain \`${E.fullToken}\` and \`${w}\` at the same time`)}else if(I.incompatibleTokens==="*"&&A.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);A.push({token:j,fullToken:w});const S=I.run(t,w,o.match,u);if(!S)return a();d.push(S.setter),t=S.rest}else{if(j.match(iwe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");if(w==="''"?w="'":j==="'"&&(w=owe(w)),t.indexOf(w)===0)t=t.slice(w.length);else return a()}}if(t.length>0&&swe.test(t))return a();const h=d.map(w=>w.priority).sort((w,j)=>j-w).filter((w,j,I)=>I.indexOf(w)===j).map(w=>d.filter(j=>j.priority===w).sort((j,I)=>I.subPriority-j.subPriority)).map(w=>w[0]);let m=mi(r,n==null?void 0:n.in);if(isNaN(+m))return a();const p={};for(const w of h){if(!w.validate(m,u))return a();const j=w.set(m,p,u);Array.isArray(j)?(m=j[0],Object.assign(p,j[1])):m=j}return m}function owe(t){return t.match(nwe)[1].replace(awe,"'")}function Wee(t,e,r){return k6(t,-14,r)}function lwe(t,e,r){return hbe(t,-1,r)}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ak=function(t,e){return Ak=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},Ak(t,e)};function If(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ak(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var mk=function(){return mk=Object.assign||function(e){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},mk.apply(this,arguments)};function yc(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,[])).next())})}function Yl(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function lC(t,e,r){if(arguments.length===2)for(var n=0,a=e.length,s;n<a;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||e)}var yA=function(){function t(e,r,n,a){this.left=e,this.top=r,this.width=n,this.height=a}return t.prototype.add=function(e,r,n,a){return new t(this.left+e,this.top+r,this.width+n,this.height+a)},t.fromClientRect=function(e,r){return new t(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height)},t.fromDOMRectList=function(e,r){var n=Array.from(r).find(function(a){return a.width!==0});return n?new t(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),Wj=function(t,e){return yA.fromClientRect(t,e.getBoundingClientRect())},cwe=function(t){var e=t.body,r=t.documentElement;if(!e||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(e.scrollWidth,r.scrollWidth),Math.max(e.offsetWidth,r.offsetWidth),Math.max(e.clientWidth,r.clientWidth)),a=Math.max(Math.max(e.scrollHeight,r.scrollHeight),Math.max(e.offsetHeight,r.offsetHeight),Math.max(e.clientHeight,r.clientHeight));return new yA(0,0,n,a)},Xj=function(t){for(var e=[],r=0,n=t.length;r<n;){var a=t.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=t.charCodeAt(r++);(s&64512)===56320?e.push(((a&1023)<<10)+(s&1023)+65536):(e.push(a),r--)}else e.push(a)}return e},Qi=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var o=t[a];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},F9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",uwe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var cC=0;cC<F9.length;cC++)uwe[F9.charCodeAt(cC)]=cC;var O9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Hy=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var uC=0;uC<O9.length;uC++)Hy[O9.charCodeAt(uC)]=uC;var dwe=function(t){var e=t.length*.75,r=t.length,n,a=0,s,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),d=Array.isArray(u)?u:new Uint8Array(u);for(n=0;n<r;n+=4)s=Hy[t.charCodeAt(n)],o=Hy[t.charCodeAt(n+1)],l=Hy[t.charCodeAt(n+2)],c=Hy[t.charCodeAt(n+3)],d[a++]=s<<2|o>>4,d[a++]=(o&15)<<4|l>>2,d[a++]=(l&3)<<6|c&63;return u},fwe=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},hwe=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},Mp=5,M6=11,B3=2,Awe=M6-Mp,Xee=65536>>Mp,mwe=1<<Mp,k3=mwe-1,pwe=1024>>Mp,gwe=Xee+pwe,xwe=gwe,vwe=32,ywe=xwe+vwe,bwe=65536>>M6,wwe=1<<Awe,Nwe=wwe-1,D9=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},Cwe=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},_we=function(t,e){var r=dwe(t),n=Array.isArray(r)?hwe(r):new Uint32Array(r),a=Array.isArray(r)?fwe(r):new Uint16Array(r),s=24,o=D9(a,s/2,n[4]/2),l=n[5]===2?D9(a,(s+n[4])/2):Cwe(n,Math.ceil((s+n[4])/4));return new Ewe(n[0],n[1],n[2],n[3],o,l)},Ewe=function(){function t(e,r,n,a,s,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>Mp],r=(r<<B3)+(e&k3),this.data[r];if(e<=65535)return r=this.index[Xee+(e-55296>>Mp)],r=(r<<B3)+(e&k3),this.data[r];if(e<this.highStart)return r=ywe-bwe+(e>>M6),r=this.index[r],r+=e>>Mp&Nwe,r=this.index[r],r=(r<<B3)+(e&k3),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),R9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Swe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var dC=0;dC<R9.length;dC++)Swe[R9.charCodeAt(dC)]=dC;var Iwe="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",M9=50,jwe=1,Yee=2,Jee=3,Pwe=4,Twe=5,L9=7,Zee=8,U9=9,q0=10,pk=11,Q9=12,gk=13,Bwe=14,$y=15,xk=16,fC=17,fy=18,kwe=19,V9=20,vk=21,hy=22,F3=23,ix=24,Eu=25,Gy=26,Ky=27,ox=28,Fwe=29,wp=30,Owe=31,hC=32,AC=33,yk=34,bk=35,wk=36,_2=37,Nk=38,fE=39,hE=40,O3=41,ete=42,Dwe=43,Rwe=[9001,65288],tte="!",fa="",mC="",Ck=_we(Iwe),Eh=[wp,wk],_k=[jwe,Yee,Jee,Twe],rte=[q0,Zee],H9=[Ky,Gy],Mwe=_k.concat(rte),$9=[Nk,fE,hE,yk,bk],Lwe=[$y,gk],Uwe=function(t,e){e===void 0&&(e="strict");var r=[],n=[],a=[];return t.forEach(function(s,o){var l=Ck.get(s);if(l>M9?(a.push(!0),l-=M9):a.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return n.push(o),r.push(xk);if(l===Pwe||l===pk){if(o===0)return n.push(o),r.push(wp);var c=r[o-1];return Mwe.indexOf(c)===-1?(n.push(n[o-1]),r.push(c)):(n.push(o),r.push(wp))}if(n.push(o),l===Owe)return r.push(e==="strict"?vk:_2);if(l===ete||l===Fwe)return r.push(wp);if(l===Dwe)return s>=131072&&s<=196605||s>=196608&&s<=262141?r.push(_2):r.push(wp);r.push(l)}),[n,r,a]},D3=function(t,e,r,n){var a=n[r];if(Array.isArray(t)?t.indexOf(a)!==-1:t===a)for(var s=r;s<=n.length;){s++;var o=n[s];if(o===e)return!0;if(o!==q0)break}if(a===q0)for(var s=r;s>0;){s--;var l=n[s];if(Array.isArray(t)?t.indexOf(l)!==-1:t===l)for(var c=r;c<=n.length;){c++;var o=n[c];if(o===e)return!0;if(o!==q0)break}if(l!==q0)break}return!1},G9=function(t,e){for(var r=t;r>=0;){var n=e[r];if(n===q0)r--;else return n}return 0},Qwe=function(t,e,r,n,a){if(r[n]===0)return fa;var s=n-1;if(Array.isArray(a)&&a[s]===!0)return fa;var o=s-1,l=s+1,c=e[s],u=o>=0?e[o]:0,d=e[l];if(c===Yee&&d===Jee)return fa;if(_k.indexOf(c)!==-1)return tte;if(_k.indexOf(d)!==-1||rte.indexOf(d)!==-1)return fa;if(G9(s,e)===Zee)return mC;if(Ck.get(t[s])===pk||(c===hC||c===AC)&&Ck.get(t[l])===pk||c===L9||d===L9||c===U9||[q0,gk,$y].indexOf(c)===-1&&d===U9||[fC,fy,kwe,ix,ox].indexOf(d)!==-1||G9(s,e)===hy||D3(F3,hy,s,e)||D3([fC,fy],vk,s,e)||D3(Q9,Q9,s,e))return fa;if(c===q0)return mC;if(c===F3||d===F3)return fa;if(d===xk||c===xk)return mC;if([gk,$y,vk].indexOf(d)!==-1||c===Bwe||u===wk&&Lwe.indexOf(c)!==-1||c===ox&&d===wk||d===V9||Eh.indexOf(d)!==-1&&c===Eu||Eh.indexOf(c)!==-1&&d===Eu||c===Ky&&[_2,hC,AC].indexOf(d)!==-1||[_2,hC,AC].indexOf(c)!==-1&&d===Gy||Eh.indexOf(c)!==-1&&H9.indexOf(d)!==-1||H9.indexOf(c)!==-1&&Eh.indexOf(d)!==-1||[Ky,Gy].indexOf(c)!==-1&&(d===Eu||[hy,$y].indexOf(d)!==-1&&e[l+1]===Eu)||[hy,$y].indexOf(c)!==-1&&d===Eu||c===Eu&&[Eu,ox,ix].indexOf(d)!==-1)return fa;if([Eu,ox,ix,fC,fy].indexOf(d)!==-1)for(var f=s;f>=0;){var A=e[f];if(A===Eu)return fa;if([ox,ix].indexOf(A)!==-1)f--;else break}if([Ky,Gy].indexOf(d)!==-1)for(var f=[fC,fy].indexOf(c)!==-1?o:s;f>=0;){var A=e[f];if(A===Eu)return fa;if([ox,ix].indexOf(A)!==-1)f--;else break}if(Nk===c&&[Nk,fE,yk,bk].indexOf(d)!==-1||[fE,yk].indexOf(c)!==-1&&[fE,hE].indexOf(d)!==-1||[hE,bk].indexOf(c)!==-1&&d===hE||$9.indexOf(c)!==-1&&[V9,Gy].indexOf(d)!==-1||$9.indexOf(d)!==-1&&c===Ky||Eh.indexOf(c)!==-1&&Eh.indexOf(d)!==-1||c===ix&&Eh.indexOf(d)!==-1||Eh.concat(Eu).indexOf(c)!==-1&&d===hy&&Rwe.indexOf(t[l])===-1||Eh.concat(Eu).indexOf(d)!==-1&&c===fy)return fa;if(c===O3&&d===O3){for(var h=r[s],m=1;h>0&&(h--,e[h]===O3);)m++;if(m%2!==0)return fa}return c===hC&&d===AC?fa:mC},Vwe=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var r=Uwe(t,e.lineBreak),n=r[0],a=r[1],s=r[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(a=a.map(function(l){return[Eu,wp,ete].indexOf(l)!==-1?_2:l}));var o=e.wordBreak==="keep-all"?s.map(function(l,c){return l&&t[c]>=19968&&t[c]<=40959}):void 0;return[n,a,o]},Hwe=function(){function t(e,r,n,a){this.codePoints=e,this.required=r===tte,this.start=n,this.end=a}return t.prototype.slice=function(){return Qi.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),$we=function(t,e){var r=Xj(t),n=Vwe(r,e),a=n[0],s=n[1],o=n[2],l=r.length,c=0,u=0;return{next:function(){if(u>=l)return{done:!0,value:null};for(var d=fa;u<l&&(d=Qwe(r,s,a,++u,o))===fa;);if(d!==fa||u===l){var f=new Hwe(r,d,c,u);return c=u,{value:f,done:!1}}return{done:!0,value:null}}}},Gwe=1,Kwe=2,Dw=4,K9=8,NS=10,q9=47,bb=92,qwe=9,zwe=32,pC=34,Ay=61,Wwe=35,Xwe=36,Ywe=37,gC=39,xC=40,my=41,Jwe=95,Zc=45,Zwe=33,eNe=60,tNe=62,rNe=64,nNe=91,aNe=93,sNe=61,iNe=123,vC=63,oNe=125,z9=124,lNe=126,cNe=128,W9=65533,R3=42,Ip=43,uNe=44,dNe=58,fNe=59,E2=46,hNe=0,ANe=8,mNe=11,pNe=14,gNe=31,xNe=127,Rf=-1,nte=48,ate=97,ste=101,vNe=102,yNe=117,bNe=122,ite=65,ote=69,lte=70,wNe=85,NNe=90,ec=function(t){return t>=nte&&t<=57},CNe=function(t){return t>=55296&&t<=57343},lx=function(t){return ec(t)||t>=ite&&t<=lte||t>=ate&&t<=vNe},_Ne=function(t){return t>=ate&&t<=bNe},ENe=function(t){return t>=ite&&t<=NNe},SNe=function(t){return _Ne(t)||ENe(t)},INe=function(t){return t>=cNe},yC=function(t){return t===NS||t===qwe||t===zwe},CS=function(t){return SNe(t)||INe(t)||t===Jwe},X9=function(t){return CS(t)||ec(t)||t===Zc},jNe=function(t){return t>=hNe&&t<=ANe||t===mNe||t>=pNe&&t<=gNe||t===xNe},j0=function(t,e){return t!==bb?!1:e!==NS},bC=function(t,e,r){return t===Zc?CS(e)||j0(e,r):CS(t)?!0:!!(t===bb&&j0(t,e))},M3=function(t,e,r){return t===Ip||t===Zc?ec(e)?!0:e===E2&&ec(r):ec(t===E2?e:t)},PNe=function(t){var e=0,r=1;(t[e]===Ip||t[e]===Zc)&&(t[e]===Zc&&(r=-1),e++);for(var n=[];ec(t[e]);)n.push(t[e++]);var a=n.length?parseInt(Qi.apply(void 0,n),10):0;t[e]===E2&&e++;for(var s=[];ec(t[e]);)s.push(t[e++]);var o=s.length,l=o?parseInt(Qi.apply(void 0,s),10):0;(t[e]===ote||t[e]===ste)&&e++;var c=1;(t[e]===Ip||t[e]===Zc)&&(t[e]===Zc&&(c=-1),e++);for(var u=[];ec(t[e]);)u.push(t[e++]);var d=u.length?parseInt(Qi.apply(void 0,u),10):0;return r*(a+l*Math.pow(10,-o))*Math.pow(10,c*d)},TNe={type:2},BNe={type:3},kNe={type:4},FNe={type:13},ONe={type:8},DNe={type:21},RNe={type:9},MNe={type:10},LNe={type:11},UNe={type:12},QNe={type:14},wC={type:23},VNe={type:1},HNe={type:25},$Ne={type:24},GNe={type:26},KNe={type:27},qNe={type:28},zNe={type:29},WNe={type:31},Ek={type:32},cte=function(){function t(){this._value=[]}return t.prototype.write=function(e){this._value=this._value.concat(Xj(e))},t.prototype.read=function(){for(var e=[],r=this.consumeToken();r!==Ek;)e.push(r),r=this.consumeToken();return e},t.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case pC:return this.consumeStringToken(pC);case Wwe:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),a=this.peekCodePoint(2);if(X9(r)||j0(n,a)){var s=bC(r,n,a)?Kwe:Gwe,o=this.consumeName();return{type:5,value:o,flags:s}}break;case Xwe:if(this.peekCodePoint(0)===Ay)return this.consumeCodePoint(),FNe;break;case gC:return this.consumeStringToken(gC);case xC:return TNe;case my:return BNe;case R3:if(this.peekCodePoint(0)===Ay)return this.consumeCodePoint(),QNe;break;case Ip:if(M3(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case uNe:return kNe;case Zc:var l=e,c=this.peekCodePoint(0),u=this.peekCodePoint(1);if(M3(l,c,u))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(bC(l,c,u))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(c===Zc&&u===tNe)return this.consumeCodePoint(),this.consumeCodePoint(),$Ne;break;case E2:if(M3(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case q9:if(this.peekCodePoint(0)===R3)for(this.consumeCodePoint();;){var d=this.consumeCodePoint();if(d===R3&&(d=this.consumeCodePoint(),d===q9))return this.consumeToken();if(d===Rf)return this.consumeToken()}break;case dNe:return GNe;case fNe:return KNe;case eNe:if(this.peekCodePoint(0)===Zwe&&this.peekCodePoint(1)===Zc&&this.peekCodePoint(2)===Zc)return this.consumeCodePoint(),this.consumeCodePoint(),HNe;break;case rNe:var f=this.peekCodePoint(0),A=this.peekCodePoint(1),h=this.peekCodePoint(2);if(bC(f,A,h)){var o=this.consumeName();return{type:7,value:o}}break;case nNe:return qNe;case bb:if(j0(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case aNe:return zNe;case sNe:if(this.peekCodePoint(0)===Ay)return this.consumeCodePoint(),ONe;break;case iNe:return LNe;case oNe:return UNe;case yNe:case wNe:var m=this.peekCodePoint(0),p=this.peekCodePoint(1);return m===Ip&&(lx(p)||p===vC)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case z9:if(this.peekCodePoint(0)===Ay)return this.consumeCodePoint(),RNe;if(this.peekCodePoint(0)===z9)return this.consumeCodePoint(),DNe;break;case lNe:if(this.peekCodePoint(0)===Ay)return this.consumeCodePoint(),MNe;break;case Rf:return Ek}return yC(e)?(this.consumeWhiteSpace(),WNe):ec(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):CS(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:Qi(e)}},t.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},t.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},t.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},t.prototype.consumeUnicodeRangeToken=function(){for(var e=[],r=this.consumeCodePoint();lx(r)&&e.length<6;)e.push(r),r=this.consumeCodePoint();for(var n=!1;r===vC&&e.length<6;)e.push(r),r=this.consumeCodePoint(),n=!0;if(n){var a=parseInt(Qi.apply(void 0,e.map(function(c){return c===vC?nte:c})),16),s=parseInt(Qi.apply(void 0,e.map(function(c){return c===vC?lte:c})),16);return{type:30,start:a,end:s}}var o=parseInt(Qi.apply(void 0,e),16);if(this.peekCodePoint(0)===Zc&&lx(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];lx(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var s=parseInt(Qi.apply(void 0,l),16);return{type:30,start:o,end:s}}else return{type:30,start:o,end:o}},t.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===xC?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===xC?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},t.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Rf)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===gC||r===pC){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Rf||this.peekCodePoint(0)===my)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),wC)}for(;;){var a=this.consumeCodePoint();if(a===Rf||a===my)return{type:22,value:Qi.apply(void 0,e)};if(yC(a))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Rf||this.peekCodePoint(0)===my?(this.consumeCodePoint(),{type:22,value:Qi.apply(void 0,e)}):(this.consumeBadUrlRemnants(),wC);if(a===pC||a===gC||a===xC||jNe(a))return this.consumeBadUrlRemnants(),wC;if(a===bb)if(j0(a,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),wC;else e.push(a)}},t.prototype.consumeWhiteSpace=function(){for(;yC(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===my||e===Rf)return;j0(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(e){for(var r=5e4,n="";e>0;){var a=Math.min(r,e);n+=Qi.apply(void 0,this._value.splice(0,a)),e-=a}return this._value.shift(),n},t.prototype.consumeStringToken=function(e){var r="",n=0;do{var a=this._value[n];if(a===Rf||a===void 0||a===e)return r+=this.consumeStringSlice(n),{type:0,value:r};if(a===NS)return this._value.splice(0,n),VNe;if(a===bb){var s=this._value[n+1];s!==Rf&&s!==void 0&&(s===NS?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):j0(a,s)&&(r+=this.consumeStringSlice(n),r+=Qi(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},t.prototype.consumeNumber=function(){var e=[],r=Dw,n=this.peekCodePoint(0);for((n===Ip||n===Zc)&&e.push(this.consumeCodePoint());ec(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var a=this.peekCodePoint(1);if(n===E2&&ec(a))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=K9;ec(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),a=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((n===ote||n===ste)&&((a===Ip||a===Zc)&&ec(s)||ec(a)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=K9;ec(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[PNe(e),r]},t.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),r=e[0],n=e[1],a=this.peekCodePoint(0),s=this.peekCodePoint(1),o=this.peekCodePoint(2);if(bC(a,s,o)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return a===Ywe?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},t.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(lx(e)){for(var r=Qi(e);lx(this.peekCodePoint(0))&&r.length<6;)r+=Qi(this.consumeCodePoint());yC(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||CNe(n)||n>1114111?W9:n}return e===Rf?W9:e},t.prototype.consumeName=function(){for(var e="";;){var r=this.consumeCodePoint();if(X9(r))e+=Qi(r);else if(j0(r,this.peekCodePoint(0)))e+=Qi(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),e}},t}(),ute=function(){function t(e){this._tokens=e}return t.create=function(e){var r=new cte;return r.write(e),new t(r.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var r=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var e=[];;){var r=this.consumeComponentValue();if(r.type===32)return e;e.push(r),e.push()}},t.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},t.prototype.consumeSimpleBlock=function(e){for(var r={type:e,values:[]},n=this.consumeToken();;){if(n.type===32||YNe(n,e))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},t.prototype.consumeFunction=function(e){for(var r={name:e.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?Ek:e},t.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},t}(),Rw=function(t){return t.type===15},x1=function(t){return t.type===17},ls=function(t){return t.type===20},XNe=function(t){return t.type===0},Sk=function(t,e){return ls(t)&&t.value===e},dte=function(t){return t.type!==31},Uv=function(t){return t.type!==31&&t.type!==4},mh=function(t){var e=[],r=[];return t.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&e.push(r),e},YNe=function(t,e){return e===11&&t.type===12||e===28&&t.type===29?!0:e===2&&t.type===3},Sm=function(t){return t.type===17||t.type===15},io=function(t){return t.type===16||Sm(t)},fte=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},jl={type:17,number:0,flags:Dw},L6={type:16,number:50,flags:Dw},z0={type:16,number:100,flags:Dw},qy=function(t,e,r){var n=t[0],a=t[1];return[ys(n,e),ys(typeof a<"u"?a:n,r)]},ys=function(t,e){if(t.type===16)return t.number/100*e;if(Rw(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},hte="deg",Ate="grad",mte="rad",pte="turn",Yj={name:"angle",parse:function(t,e){if(e.type===15)switch(e.unit){case hte:return Math.PI*e.number/180;case Ate:return Math.PI/200*e.number;case mte:return e.number;case pte:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},gte=function(t){return t.type===15&&(t.unit===hte||t.unit===Ate||t.unit===mte||t.unit===pte)},xte=function(t){var e=t.filter(ls).map(function(r){return r.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[jl,jl];case"to top":case"bottom":return Cd(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[jl,z0];case"to right":case"left":return Cd(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[z0,z0];case"to bottom":case"top":return Cd(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[z0,jl];case"to left":case"right":return Cd(270)}return 0},Cd=function(t){return Math.PI*t/180},fm={name:"color",parse:function(t,e){if(e.type===18){var r=JNe[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return r(t,e.values)}if(e.type===5){if(e.value.length===3){var n=e.value.substring(0,1),a=e.value.substring(1,2),s=e.value.substring(2,3);return W0(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),1)}if(e.value.length===4){var n=e.value.substring(0,1),a=e.value.substring(1,2),s=e.value.substring(2,3),o=e.value.substring(3,4);return W0(parseInt(n+n,16),parseInt(a+a,16),parseInt(s+s,16),parseInt(o+o,16)/255)}if(e.value.length===6){var n=e.value.substring(0,2),a=e.value.substring(2,4),s=e.value.substring(4,6);return W0(parseInt(n,16),parseInt(a,16),parseInt(s,16),1)}if(e.value.length===8){var n=e.value.substring(0,2),a=e.value.substring(2,4),s=e.value.substring(4,6),o=e.value.substring(6,8);return W0(parseInt(n,16),parseInt(a,16),parseInt(s,16),parseInt(o,16)/255)}}if(e.type===20){var l=iA[e.value.toUpperCase()];if(typeof l<"u")return l}return iA.TRANSPARENT}},hm=function(t){return(255&t)===0},$o=function(t){var e=255&t,r=255&t>>8,n=255&t>>16,a=255&t>>24;return e<255?"rgba("+a+","+n+","+r+","+e/255+")":"rgb("+a+","+n+","+r+")"},W0=function(t,e,r,n){return(t<<24|e<<16|r<<8|Math.round(n*255)<<0)>>>0},Y9=function(t,e){if(t.type===17)return t.number;if(t.type===16){var r=e===3?1:255;return e===3?t.number/100*r:Math.round(t.number/100*r)}return 0},J9=function(t,e){var r=e.filter(Uv);if(r.length===3){var n=r.map(Y9),a=n[0],s=n[1],o=n[2];return W0(a,s,o,1)}if(r.length===4){var l=r.map(Y9),a=l[0],s=l[1],o=l[2],c=l[3];return W0(a,s,o,c)}return 0};function L3(t,e,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(e-t)*r*6+t:r<1/2?e:r<2/3?(e-t)*6*(2/3-r)+t:t}var Z9=function(t,e){var r=e.filter(Uv),n=r[0],a=r[1],s=r[2],o=r[3],l=(n.type===17?Cd(n.number):Yj.parse(t,n))/(Math.PI*2),c=io(a)?a.number/100:0,u=io(s)?s.number/100:0,d=typeof o<"u"&&io(o)?ys(o,1):1;if(c===0)return W0(u*255,u*255,u*255,1);var f=u<=.5?u*(c+1):u+c-u*c,A=u*2-f,h=L3(A,f,l+1/3),m=L3(A,f,l),p=L3(A,f,l-1/3);return W0(h*255,m*255,p*255,d)},JNe={hsl:Z9,hsla:Z9,rgb:J9,rgba:J9},wb=function(t,e){return fm.parse(t,ute.create(e).parseComponentValue())},iA={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},ZNe={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(ls(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},eCe={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Jj=function(t,e){var r=fm.parse(t,e[0]),n=e[1];return n&&io(n)?{color:r,stop:n}:{color:r,stop:null}},eQ=function(t,e){var r=t[0],n=t[t.length-1];r.stop===null&&(r.stop=jl),n.stop===null&&(n.stop=z0);for(var a=[],s=0,o=0;o<t.length;o++){var l=t[o].stop;if(l!==null){var c=ys(l,e);c>s?a.push(c):a.push(s),s=c}else a.push(null)}for(var u=null,o=0;o<a.length;o++){var d=a[o];if(d===null)u===null&&(u=o);else if(u!==null){for(var f=o-u,A=a[u-1],h=(d-A)/(f+1),m=1;m<=f;m++)a[u+m-1]=h*m;u=null}}return t.map(function(p,x){var v=p.color;return{color:v,stop:Math.max(Math.min(1,a[x]/e),0)}})},tCe=function(t,e,r){var n=e/2,a=r/2,s=ys(t[0],e)-n,o=a-ys(t[1],r);return(Math.atan2(o,s)+Math.PI*2)%(Math.PI*2)},rCe=function(t,e,r){var n=typeof t=="number"?t:tCe(t,e,r),a=Math.abs(e*Math.sin(n))+Math.abs(r*Math.cos(n)),s=e/2,o=r/2,l=a/2,c=Math.sin(n-Math.PI/2)*l,u=Math.cos(n-Math.PI/2)*l;return[a,s-u,s+u,o-c,o+c]},rf=function(t,e){return Math.sqrt(t*t+e*e)},tQ=function(t,e,r,n,a){var s=[[0,0],[0,e],[t,0],[t,e]];return s.reduce(function(o,l){var c=l[0],u=l[1],d=rf(r-c,n-u);return(a?d<o.optimumDistance:d>o.optimumDistance)?{optimumCorner:l,optimumDistance:d}:o},{optimumDistance:a?1/0:-1/0,optimumCorner:null}).optimumCorner},nCe=function(t,e,r,n,a){var s=0,o=0;switch(t.size){case 0:t.shape===0?s=o=Math.min(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-a)):t.shape===1&&(s=Math.min(Math.abs(e),Math.abs(e-n)),o=Math.min(Math.abs(r),Math.abs(r-a)));break;case 2:if(t.shape===0)s=o=Math.min(rf(e,r),rf(e,r-a),rf(e-n,r),rf(e-n,r-a));else if(t.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-a))/Math.min(Math.abs(e),Math.abs(e-n)),c=tQ(n,a,e,r,!0),u=c[0],d=c[1];s=rf(u-e,(d-r)/l),o=l*s}break;case 1:t.shape===0?s=o=Math.max(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-a)):t.shape===1&&(s=Math.max(Math.abs(e),Math.abs(e-n)),o=Math.max(Math.abs(r),Math.abs(r-a)));break;case 3:if(t.shape===0)s=o=Math.max(rf(e,r),rf(e,r-a),rf(e-n,r),rf(e-n,r-a));else if(t.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-a))/Math.max(Math.abs(e),Math.abs(e-n)),f=tQ(n,a,e,r,!1),u=f[0],d=f[1];s=rf(u-e,(d-r)/l),o=l*s}break}return Array.isArray(t.size)&&(s=ys(t.size[0],n),o=t.size.length===2?ys(t.size[1],a):s),[s,o]},aCe=function(t,e){var r=Cd(180),n=[];return mh(e).forEach(function(a,s){if(s===0){var o=a[0];if(o.type===20&&o.value==="to"){r=xte(a);return}else if(gte(o)){r=Yj.parse(t,o);return}}var l=Jj(t,a);n.push(l)}),{angle:r,stops:n,type:1}},NC=function(t,e){var r=Cd(180),n=[];return mh(e).forEach(function(a,s){if(s===0){var o=a[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=xte(a);return}else if(gte(o)){r=(Yj.parse(t,o)+Cd(270))%Cd(360);return}}var l=Jj(t,a);n.push(l)}),{angle:r,stops:n,type:1}},sCe=function(t,e){var r=Cd(180),n=[],a=1,s=0,o=3,l=[];return mh(e).forEach(function(c,u){var d=c[0];if(u===0){if(ls(d)&&d.value==="linear"){a=1;return}else if(ls(d)&&d.value==="radial"){a=2;return}}if(d.type===18){if(d.name==="from"){var f=fm.parse(t,d.values[0]);n.push({stop:jl,color:f})}else if(d.name==="to"){var f=fm.parse(t,d.values[0]);n.push({stop:z0,color:f})}else if(d.name==="color-stop"){var A=d.values.filter(Uv);if(A.length===2){var f=fm.parse(t,A[1]),h=A[0];x1(h)&&n.push({stop:{type:16,number:h.number*100,flags:h.flags},color:f})}}}}),a===1?{angle:(r+Cd(180))%Cd(360),stops:n,type:a}:{size:o,shape:s,stops:n,position:l,type:a}},vte="closest-side",yte="farthest-side",bte="closest-corner",wte="farthest-corner",Nte="circle",Cte="ellipse",_te="cover",Ete="contain",iCe=function(t,e){var r=0,n=3,a=[],s=[];return mh(e).forEach(function(o,l){var c=!0;if(l===0){var u=!1;c=o.reduce(function(f,A){if(u)if(ls(A))switch(A.value){case"center":return s.push(L6),f;case"top":case"left":return s.push(jl),f;case"right":case"bottom":return s.push(z0),f}else(io(A)||Sm(A))&&s.push(A);else if(ls(A))switch(A.value){case Nte:return r=0,!1;case Cte:return r=1,!1;case"at":return u=!0,!1;case vte:return n=0,!1;case _te:case yte:return n=1,!1;case Ete:case bte:return n=2,!1;case wte:return n=3,!1}else if(Sm(A)||io(A))return Array.isArray(n)||(n=[]),n.push(A),!1;return f},c)}if(c){var d=Jj(t,o);a.push(d)}}),{size:n,shape:r,stops:a,position:s,type:2}},CC=function(t,e){var r=0,n=3,a=[],s=[];return mh(e).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(d,f){if(ls(f))switch(f.value){case"center":return s.push(L6),!1;case"top":case"left":return s.push(jl),!1;case"right":case"bottom":return s.push(z0),!1}else if(io(f)||Sm(f))return s.push(f),!1;return d},c):l===1&&(c=o.reduce(function(d,f){if(ls(f))switch(f.value){case Nte:return r=0,!1;case Cte:return r=1,!1;case Ete:case vte:return n=0,!1;case yte:return n=1,!1;case bte:return n=2,!1;case _te:case wte:return n=3,!1}else if(Sm(f)||io(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return d},c)),c){var u=Jj(t,o);a.push(u)}}),{size:n,shape:r,stops:a,position:s,type:2}},oCe=function(t){return t.type===1},lCe=function(t){return t.type===2},U6={name:"image",parse:function(t,e){if(e.type===22){var r={url:e.value,type:0};return t.cache.addImage(e.value),r}if(e.type===18){var n=Ste[e.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(t,e.values)}throw new Error("Unsupported image type "+e.type)}};function cCe(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!Ste[t.name])}var Ste={"linear-gradient":aCe,"-moz-linear-gradient":NC,"-ms-linear-gradient":NC,"-o-linear-gradient":NC,"-webkit-linear-gradient":NC,"radial-gradient":iCe,"-moz-radial-gradient":CC,"-ms-radial-gradient":CC,"-o-radial-gradient":CC,"-webkit-radial-gradient":CC,"-webkit-gradient":sCe},uCe={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e.filter(function(n){return Uv(n)&&cCe(n)}).map(function(n){return U6.parse(t,n)})}},dCe={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(ls(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},fCe={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return mh(e).map(function(r){return r.filter(io)}).map(fte)}},hCe={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return mh(e).map(function(r){return r.filter(ls).map(function(n){return n.value}).join(" ")}).map(ACe)}},ACe=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},mv;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(mv||(mv={}));var mCe={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return mh(e).map(function(r){return r.filter(pCe)})}},pCe=function(t){return ls(t)||io(t)},Zj=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},gCe=Zj("top"),xCe=Zj("right"),vCe=Zj("bottom"),yCe=Zj("left"),eP=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(e,r){return fte(r.filter(io))}}},bCe=eP("top-left"),wCe=eP("top-right"),NCe=eP("bottom-right"),CCe=eP("bottom-left"),tP=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},_Ce=tP("top"),ECe=tP("right"),SCe=tP("bottom"),ICe=tP("left"),rP=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,r){return Rw(r)?r.number:0}}},jCe=rP("top"),PCe=rP("right"),TCe=rP("bottom"),BCe=rP("left"),kCe={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},FCe={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},OCe={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter(ls).reduce(function(r,n){return r|DCe(n.value)},0)}},DCe=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},RCe={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},MCe={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},_S;(function(t){t.NORMAL="normal",t.STRICT="strict"})(_S||(_S={}));var LCe={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"strict":return _S.STRICT;case"normal":default:return _S.NORMAL}}},UCe={name:"line-height",initialValue:"normal",prefix:!1,type:4},rQ=function(t,e){return ls(t)&&t.value==="normal"?1.2*e:t.type===17?e*t.number:io(t)?ys(t,e):e},QCe={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return e.type===20&&e.value==="none"?null:U6.parse(t,e)}},VCe={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},Ik={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},nP=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},HCe=nP("top"),$Ce=nP("right"),GCe=nP("bottom"),KCe=nP("left"),qCe={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter(ls).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},zCe={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},aP=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},WCe=aP("top"),XCe=aP("right"),YCe=aP("bottom"),JCe=aP("left"),ZCe={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},e_e={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},t_e={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&Sk(e[0],"none")?[]:mh(e).map(function(r){for(var n={color:iA.TRANSPARENT,offsetX:jl,offsetY:jl,blur:jl},a=0,s=0;s<r.length;s++){var o=r[s];Sm(o)?(a===0?n.offsetX=o:a===1?n.offsetY=o:n.blur=o,a++):n.color=fm.parse(t,o)}return n})}},r_e={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},n_e={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var r=i_e[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return r(e.values)}return null}},a_e=function(t){var e=t.filter(function(r){return r.type===17}).map(function(r){return r.number});return e.length===6?e:null},s_e=function(t){var e=t.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=e[0],n=e[1];e[2],e[3];var a=e[4],s=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var o=e[12],l=e[13];return e[14],e[15],e.length===16?[r,n,a,s,o,l]:null},i_e={matrix:a_e,matrix3d:s_e},nQ={type:16,number:50,flags:Dw},o_e=[nQ,nQ],l_e={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var r=e.filter(io);return r.length!==2?o_e:[r[0],r[1]]}},c_e={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Nb;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(Nb||(Nb={}));var u_e={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return Nb.BREAK_ALL;case"keep-all":return Nb.KEEP_ALL;case"normal":default:return Nb.NORMAL}}},d_e={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(e.type===20)return{auto:!0,order:0};if(x1(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},Ite={name:"time",parse:function(t,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},f_e={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return x1(e)?e.number:1}},h_e={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},A_e={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter(ls).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},m_e={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var r=[],n=[];return e.forEach(function(a){switch(a.type){case 20:case 0:r.push(a.value);break;case 17:r.push(a.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(a){return a.indexOf(" ")===-1?a:"'"+a+"'"})}},p_e={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},g_e={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){if(x1(e))return e.number;if(ls(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},x_e={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter(ls).map(function(r){return r.value})}},v_e={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},jo=function(t,e){return(t&e)!==0},y_e={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e}},b_e={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;for(var n=[],a=e.filter(dte),s=0;s<a.length;s++){var o=a[s],l=a[s+1];if(o.type===20){var c=l&&x1(l)?l.number:1;n.push({counter:o.value,increment:c})}}return n}},w_e={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return[];for(var r=[],n=e.filter(dte),a=0;a<n.length;a++){var s=n[a],o=n[a+1];if(ls(s)&&s.value!=="none"){var l=o&&x1(o)?o.number:0;r.push({counter:s.value,reset:l})}}return r}},N_e={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(Rw).map(function(r){return Ite.parse(t,r)})}},C_e={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;var n=[],a=e.filter(XNe);if(a.length%2!==0)return null;for(var s=0;s<a.length;s+=2){var o=a[s].value,l=a[s+1].value;n.push({open:o,close:l})}return n}},aQ=function(t,e,r){if(!t)return"";var n=t[Math.min(e,t.length-1)];return n?r?n.open:n.close:""},__e={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&Sk(e[0],"none")?[]:mh(e).map(function(r){for(var n={color:255,offsetX:jl,offsetY:jl,blur:jl,spread:jl,inset:!1},a=0,s=0;s<r.length;s++){var o=r[s];Sk(o,"inset")?n.inset=!0:Sm(o)?(a===0?n.offsetX=o:a===1?n.offsetY=o:a===2?n.blur=o:n.spread=o,a++):n.color=fm.parse(t,o)}return n})}},E_e={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var r=[0,1,2],n=[];return e.filter(ls).forEach(function(a){switch(a.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(a){n.indexOf(a)===-1&&n.push(a)}),n}},S_e={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},I_e={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Rw(e)?e.number:0}},j_e=function(){function t(e,r){var n,a;this.animationDuration=nn(e,N_e,r.animationDuration),this.backgroundClip=nn(e,ZNe,r.backgroundClip),this.backgroundColor=nn(e,eCe,r.backgroundColor),this.backgroundImage=nn(e,uCe,r.backgroundImage),this.backgroundOrigin=nn(e,dCe,r.backgroundOrigin),this.backgroundPosition=nn(e,fCe,r.backgroundPosition),this.backgroundRepeat=nn(e,hCe,r.backgroundRepeat),this.backgroundSize=nn(e,mCe,r.backgroundSize),this.borderTopColor=nn(e,gCe,r.borderTopColor),this.borderRightColor=nn(e,xCe,r.borderRightColor),this.borderBottomColor=nn(e,vCe,r.borderBottomColor),this.borderLeftColor=nn(e,yCe,r.borderLeftColor),this.borderTopLeftRadius=nn(e,bCe,r.borderTopLeftRadius),this.borderTopRightRadius=nn(e,wCe,r.borderTopRightRadius),this.borderBottomRightRadius=nn(e,NCe,r.borderBottomRightRadius),this.borderBottomLeftRadius=nn(e,CCe,r.borderBottomLeftRadius),this.borderTopStyle=nn(e,_Ce,r.borderTopStyle),this.borderRightStyle=nn(e,ECe,r.borderRightStyle),this.borderBottomStyle=nn(e,SCe,r.borderBottomStyle),this.borderLeftStyle=nn(e,ICe,r.borderLeftStyle),this.borderTopWidth=nn(e,jCe,r.borderTopWidth),this.borderRightWidth=nn(e,PCe,r.borderRightWidth),this.borderBottomWidth=nn(e,TCe,r.borderBottomWidth),this.borderLeftWidth=nn(e,BCe,r.borderLeftWidth),this.boxShadow=nn(e,__e,r.boxShadow),this.color=nn(e,kCe,r.color),this.direction=nn(e,FCe,r.direction),this.display=nn(e,OCe,r.display),this.float=nn(e,RCe,r.cssFloat),this.fontFamily=nn(e,m_e,r.fontFamily),this.fontSize=nn(e,p_e,r.fontSize),this.fontStyle=nn(e,v_e,r.fontStyle),this.fontVariant=nn(e,x_e,r.fontVariant),this.fontWeight=nn(e,g_e,r.fontWeight),this.letterSpacing=nn(e,MCe,r.letterSpacing),this.lineBreak=nn(e,LCe,r.lineBreak),this.lineHeight=nn(e,UCe,r.lineHeight),this.listStyleImage=nn(e,QCe,r.listStyleImage),this.listStylePosition=nn(e,VCe,r.listStylePosition),this.listStyleType=nn(e,Ik,r.listStyleType),this.marginTop=nn(e,HCe,r.marginTop),this.marginRight=nn(e,$Ce,r.marginRight),this.marginBottom=nn(e,GCe,r.marginBottom),this.marginLeft=nn(e,KCe,r.marginLeft),this.opacity=nn(e,f_e,r.opacity);var s=nn(e,qCe,r.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=nn(e,zCe,r.overflowWrap),this.paddingTop=nn(e,WCe,r.paddingTop),this.paddingRight=nn(e,XCe,r.paddingRight),this.paddingBottom=nn(e,YCe,r.paddingBottom),this.paddingLeft=nn(e,JCe,r.paddingLeft),this.paintOrder=nn(e,E_e,r.paintOrder),this.position=nn(e,e_e,r.position),this.textAlign=nn(e,ZCe,r.textAlign),this.textDecorationColor=nn(e,h_e,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=nn(e,A_e,(a=r.textDecorationLine)!==null&&a!==void 0?a:r.textDecoration),this.textShadow=nn(e,t_e,r.textShadow),this.textTransform=nn(e,r_e,r.textTransform),this.transform=nn(e,n_e,r.transform),this.transformOrigin=nn(e,l_e,r.transformOrigin),this.visibility=nn(e,c_e,r.visibility),this.webkitTextStrokeColor=nn(e,S_e,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=nn(e,I_e,r.webkitTextStrokeWidth),this.wordBreak=nn(e,u_e,r.wordBreak),this.zIndex=nn(e,d_e,r.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return hm(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return jo(this.display,4)||jo(this.display,33554432)||jo(this.display,268435456)||jo(this.display,536870912)||jo(this.display,67108864)||jo(this.display,134217728)},t}(),P_e=function(){function t(e,r){this.content=nn(e,y_e,r.content),this.quotes=nn(e,C_e,r.quotes)}return t}(),sQ=function(){function t(e,r){this.counterIncrement=nn(e,b_e,r.counterIncrement),this.counterReset=nn(e,w_e,r.counterReset)}return t}(),nn=function(t,e,r){var n=new cte,a=r!==null&&typeof r<"u"?r.toString():e.initialValue;n.write(a);var s=new ute(n.read());switch(e.type){case 2:var o=s.parseComponentValue();return e.parse(t,ls(o)?o.value:e.initialValue);case 0:return e.parse(t,s.parseComponentValue());case 1:return e.parse(t,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(e.format){case"angle":return Yj.parse(t,s.parseComponentValue());case"color":return fm.parse(t,s.parseComponentValue());case"image":return U6.parse(t,s.parseComponentValue());case"length":var l=s.parseComponentValue();return Sm(l)?l:jl;case"length-percentage":var c=s.parseComponentValue();return io(c)?c:jl;case"time":return Ite.parse(t,s.parseComponentValue())}break}},T_e="data-html2canvas-debug",B_e=function(t){var e=t.getAttribute(T_e);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},jk=function(t,e){var r=B_e(t);return r===1||e===r},ph=function(){function t(e,r){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,jk(r,3))debugger;this.styles=new j_e(e,window.getComputedStyle(r,null)),Bk(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=Wj(this.context,r),jk(r,4)&&(this.flags|=16)}return t}(),k_e="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",iQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",zy=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var _C=0;_C<iQ.length;_C++)zy[iQ.charCodeAt(_C)]=_C;var F_e=function(t){var e=t.length*.75,r=t.length,n,a=0,s,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),d=Array.isArray(u)?u:new Uint8Array(u);for(n=0;n<r;n+=4)s=zy[t.charCodeAt(n)],o=zy[t.charCodeAt(n+1)],l=zy[t.charCodeAt(n+2)],c=zy[t.charCodeAt(n+3)],d[a++]=s<<2|o>>4,d[a++]=(o&15)<<4|l>>2,d[a++]=(l&3)<<6|c&63;return u},O_e=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},D_e=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},Lp=5,Q6=11,U3=2,R_e=Q6-Lp,jte=65536>>Lp,M_e=1<<Lp,Q3=M_e-1,L_e=1024>>Lp,U_e=jte+L_e,Q_e=U_e,V_e=32,H_e=Q_e+V_e,$_e=65536>>Q6,G_e=1<<R_e,K_e=G_e-1,oQ=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},q_e=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},z_e=function(t,e){var r=F_e(t),n=Array.isArray(r)?D_e(r):new Uint32Array(r),a=Array.isArray(r)?O_e(r):new Uint16Array(r),s=24,o=oQ(a,s/2,n[4]/2),l=n[5]===2?oQ(a,(s+n[4])/2):q_e(n,Math.ceil((s+n[4])/4));return new W_e(n[0],n[1],n[2],n[3],o,l)},W_e=function(){function t(e,r,n,a,s,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=a,this.index=s,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>Lp],r=(r<<U3)+(e&Q3),this.data[r];if(e<=65535)return r=this.index[jte+(e-55296>>Lp)],r=(r<<U3)+(e&Q3),this.data[r];if(e<this.highStart)return r=H_e-$_e+(e>>Q6),r=this.index[r],r+=e>>Lp&K_e,r=this.index[r],r=(r<<U3)+(e&Q3),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),lQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",X_e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var EC=0;EC<lQ.length;EC++)X_e[lQ.charCodeAt(EC)]=EC;var Y_e=1,V3=2,H3=3,cQ=4,uQ=5,J_e=7,dQ=8,$3=9,G3=10,fQ=11,hQ=12,AQ=13,mQ=14,K3=15,Z_e=function(t){for(var e=[],r=0,n=t.length;r<n;){var a=t.charCodeAt(r++);if(a>=55296&&a<=56319&&r<n){var s=t.charCodeAt(r++);(s&64512)===56320?e.push(((a&1023)<<10)+(s&1023)+65536):(e.push(a),r--)}else e.push(a)}return e},eEe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],a=-1,s="";++a<r;){var o=t[a];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(a+1===r||n.length>16384)&&(s+=String.fromCharCode.apply(String,n),n.length=0)}return s},tEe=z_e(k_e),pd="",q3="",rEe=function(t){return tEe.get(t)},nEe=function(t,e,r){var n=r-2,a=e[n],s=e[r-1],o=e[r];if(s===V3&&o===H3)return pd;if(s===V3||s===H3||s===cQ||o===V3||o===H3||o===cQ)return q3;if(s===dQ&&[dQ,$3,fQ,hQ].indexOf(o)!==-1||(s===fQ||s===$3)&&(o===$3||o===G3)||(s===hQ||s===G3)&&o===G3||o===AQ||o===uQ||o===J_e||s===Y_e)return pd;if(s===AQ&&o===mQ){for(;a===uQ;)a=e[--n];if(a===mQ)return pd}if(s===K3&&o===K3){for(var l=0;a===K3;)l++,a=e[--n];if(l%2===0)return pd}return q3},aEe=function(t){var e=Z_e(t),r=e.length,n=0,a=0,s=e.map(rEe);return{next:function(){if(n>=r)return{done:!0,value:null};for(var o=pd;n<r&&(o=nEe(e,s,++n))===pd;);if(o!==pd||n===r){var l=eEe.apply(null,e.slice(a,n));return a=n,{value:l,done:!1}}return{done:!0,value:null}}}},sEe=function(t){for(var e=aEe(t),r=[],n;!(n=e.next()).done;)n.value&&r.push(n.value.slice());return r},iEe=function(t){var e=123;if(t.createRange){var r=t.createRange();if(r.getBoundingClientRect){var n=t.createElement("boundtest");n.style.height=e+"px",n.style.display="block",t.body.appendChild(n),r.selectNode(n);var a=r.getBoundingClientRect(),s=Math.round(a.height);if(t.body.removeChild(n),s===e)return!0}}return!1},oEe=function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var r=t.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=e.firstChild,a=Xj(n.data).map(function(c){return Qi(c)}),s=0,o={},l=a.every(function(c,u){r.setStart(n,s),r.setEnd(n,s+c.length);var d=r.getBoundingClientRect();s+=c.length;var f=d.x>o.x||d.y>o.y;return o=d,u===0?!0:f});return t.body.removeChild(e),l},lEe=function(){return typeof new Image().crossOrigin<"u"},cEe=function(){return typeof new XMLHttpRequest().responseType=="string"},uEe=function(t){var e=new Image,r=t.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),r.toDataURL()}catch{return!1}return!0},pQ=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},dEe=function(t){var e=t.createElement("canvas"),r=100;e.width=r,e.height=r;var n=e.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var a=new Image,s=e.toDataURL();a.src=s;var o=Pk(r,r,0,0,a);return n.fillStyle="red",n.fillRect(0,0,r,r),gQ(o).then(function(l){n.drawImage(l,0,0);var c=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var u=t.createElement("div");return u.style.backgroundImage="url("+s+")",u.style.height=r+"px",pQ(c)?gQ(Pk(r,r,0,0,u)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),pQ(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},Pk=function(t,e,r,n,a){var s="http://www.w3.org/2000/svg",o=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject");return o.setAttributeNS(null,"width",t.toString()),o.setAttributeNS(null,"height",e.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(a),o},gQ=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){return e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Nl={get SUPPORT_RANGE_BOUNDS(){var t=iEe(document);return Object.defineProperty(Nl,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=Nl.SUPPORT_RANGE_BOUNDS&&oEe(document);return Object.defineProperty(Nl,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=uEe(document);return Object.defineProperty(Nl,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?dEe(document):Promise.resolve(!1);return Object.defineProperty(Nl,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=lEe();return Object.defineProperty(Nl,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=cEe();return Object.defineProperty(Nl,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Nl,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Nl,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},Cb=function(){function t(e,r){this.text=e,this.bounds=r}return t}(),fEe=function(t,e,r,n){var a=mEe(e,r),s=[],o=0;return a.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(Nl.SUPPORT_RANGE_BOUNDS){var c=xQ(n,o,l.length).getClientRects();if(c.length>1){var u=V6(l),d=0;u.forEach(function(A){s.push(new Cb(A,yA.fromDOMRectList(t,xQ(n,d+o,A.length).getClientRects()))),d+=A.length})}else s.push(new Cb(l,yA.fromDOMRectList(t,c)))}else{var f=n.splitText(l.length);s.push(new Cb(l,hEe(t,n))),n=f}else Nl.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));o+=l.length}),s},hEe=function(t,e){var r=e.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(e.cloneNode(!0));var a=e.parentNode;if(a){a.replaceChild(n,e);var s=Wj(t,n);return n.firstChild&&a.replaceChild(n.firstChild,n),s}}return yA.EMPTY},xQ=function(t,e,r){var n=t.ownerDocument;if(!n)throw new Error("Node has no owner document");var a=n.createRange();return a.setStart(t,e),a.setEnd(t,e+r),a},V6=function(t){if(Nl.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map(function(r){return r.segment})}return sEe(t)},AEe=function(t,e){if(Nl.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(t)).map(function(n){return n.segment})}return gEe(t,e)},mEe=function(t,e){return e.letterSpacing!==0?V6(t):AEe(t,e)},pEe=[32,160,4961,65792,65793,4153,4241],gEe=function(t,e){for(var r=$we(t,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),n=[],a,s=function(){if(a.value){var o=a.value.slice(),l=Xj(o),c="";l.forEach(function(u){pEe.indexOf(u)===-1?c+=Qi(u):(c.length&&n.push(c),n.push(Qi(u)),c="")}),c.length&&n.push(c)}};!(a=r.next()).done;)s();return n},xEe=function(){function t(e,r,n){this.text=vEe(r.data,n.textTransform),this.textBounds=fEe(e,this.text,n,r)}return t}(),vEe=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(yEe,bEe);case 2:return t.toUpperCase();default:return t}},yEe=/(^|\s|:|-|\(|\))([a-z])/g,bEe=function(t,e,r){return t.length>0?e+r.toUpperCase():t},Pte=function(t){If(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.src=n.currentSrc||n.src,a.intrinsicWidth=n.naturalWidth,a.intrinsicHeight=n.naturalHeight,a.context.cache.addImage(a.src),a}return e}(ph),Tte=function(t){If(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.canvas=n,a.intrinsicWidth=n.width,a.intrinsicHeight=n.height,a}return e}(ph),Bte=function(t){If(e,t);function e(r,n){var a=t.call(this,r,n)||this,s=new XMLSerializer,o=Wj(r,n);return n.setAttribute("width",o.width+"px"),n.setAttribute("height",o.height+"px"),a.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(n)),a.intrinsicWidth=n.width.baseVal.value,a.intrinsicHeight=n.height.baseVal.value,a.context.cache.addImage(a.svg),a}return e}(ph),kte=function(t){If(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.value=n.value,a}return e}(ph),Tk=function(t){If(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.start=n.start,a.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,a}return e}(ph),wEe=[{type:15,flags:0,unit:"px",number:3}],NEe=[{type:16,flags:0,number:50}],CEe=function(t){return t.width>t.height?new yA(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new yA(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},_Ee=function(t){var e=t.type===EEe?new Array(t.value.length+1).join(""):t.value;return e.length===0?t.placeholder||"":e},ES="checkbox",SS="radio",EEe="password",vQ=707406591,H6=function(t){If(e,t);function e(r,n){var a=t.call(this,r,n)||this;switch(a.type=n.type.toLowerCase(),a.checked=n.checked,a.value=_Ee(n),(a.type===ES||a.type===SS)&&(a.styles.backgroundColor=3739148031,a.styles.borderTopColor=a.styles.borderRightColor=a.styles.borderBottomColor=a.styles.borderLeftColor=2779096575,a.styles.borderTopWidth=a.styles.borderRightWidth=a.styles.borderBottomWidth=a.styles.borderLeftWidth=1,a.styles.borderTopStyle=a.styles.borderRightStyle=a.styles.borderBottomStyle=a.styles.borderLeftStyle=1,a.styles.backgroundClip=[0],a.styles.backgroundOrigin=[0],a.bounds=CEe(a.bounds)),a.type){case ES:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=wEe;break;case SS:a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=NEe;break}return a}return e}(ph),Fte=function(t){If(e,t);function e(r,n){var a=t.call(this,r,n)||this,s=n.options[n.selectedIndex||0];return a.value=s&&s.text||"",a}return e}(ph),Ote=function(t){If(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.value=n.value,a}return e}(ph),Dte=function(t){If(e,t);function e(r,n){var a=t.call(this,r,n)||this;a.src=n.src,a.width=parseInt(n.width,10)||0,a.height=parseInt(n.height,10)||0,a.backgroundColor=a.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){a.tree=Mte(r,n.contentWindow.document.documentElement);var s=n.contentWindow.document.documentElement?wb(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):iA.TRANSPARENT,o=n.contentWindow.document.body?wb(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):iA.TRANSPARENT;a.backgroundColor=hm(s)?hm(o)?a.styles.backgroundColor:o:s}}catch{}return a}return e}(ph),SEe=["OL","UL","MENU"],AE=function(t,e,r,n){for(var a=e.firstChild,s=void 0;a;a=s)if(s=a.nextSibling,Lte(a)&&a.data.trim().length>0)r.textNodes.push(new xEe(t,a,r.styles));else if(Xx(a))if(Hte(a)&&a.assignedNodes)a.assignedNodes().forEach(function(l){return AE(t,l,r,n)});else{var o=Rte(t,a);o.styles.isVisible()&&(IEe(a,o,n)?o.flags|=4:jEe(o.styles)&&(o.flags|=2),SEe.indexOf(a.tagName)!==-1&&(o.flags|=8),r.elements.push(o),a.slot,a.shadowRoot?AE(t,a.shadowRoot,o,n):!IS(a)&&!Ute(a)&&!jS(a)&&AE(t,a,o,n))}},Rte=function(t,e){return kk(e)?new Pte(t,e):Qte(e)?new Tte(t,e):Ute(e)?new Bte(t,e):PEe(e)?new kte(t,e):TEe(e)?new Tk(t,e):BEe(e)?new H6(t,e):jS(e)?new Fte(t,e):IS(e)?new Ote(t,e):Vte(e)?new Dte(t,e):new ph(t,e)},Mte=function(t,e){var r=Rte(t,e);return r.flags|=4,AE(t,e,r,r),r},IEe=function(t,e,r){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||$6(t)&&r.styles.isTransparent()},jEe=function(t){return t.isPositioned()||t.isFloating()},Lte=function(t){return t.nodeType===Node.TEXT_NODE},Xx=function(t){return t.nodeType===Node.ELEMENT_NODE},Bk=function(t){return Xx(t)&&typeof t.style<"u"&&!mE(t)},mE=function(t){return typeof t.className=="object"},PEe=function(t){return t.tagName==="LI"},TEe=function(t){return t.tagName==="OL"},BEe=function(t){return t.tagName==="INPUT"},kEe=function(t){return t.tagName==="HTML"},Ute=function(t){return t.tagName==="svg"},$6=function(t){return t.tagName==="BODY"},Qte=function(t){return t.tagName==="CANVAS"},yQ=function(t){return t.tagName==="VIDEO"},kk=function(t){return t.tagName==="IMG"},Vte=function(t){return t.tagName==="IFRAME"},bQ=function(t){return t.tagName==="STYLE"},FEe=function(t){return t.tagName==="SCRIPT"},IS=function(t){return t.tagName==="TEXTAREA"},jS=function(t){return t.tagName==="SELECT"},Hte=function(t){return t.tagName==="SLOT"},wQ=function(t){return t.tagName.indexOf("-")>0},OEe=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(e){var r=this.counters[e];return r&&r.length?r[r.length-1]:1},t.prototype.getCounterValues=function(e){var r=this.counters[e];return r||[]},t.prototype.pop=function(e){var r=this;e.forEach(function(n){return r.counters[n].pop()})},t.prototype.parse=function(e){var r=this,n=e.counterIncrement,a=e.counterReset,s=!0;n!==null&&n.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(s=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return s&&a.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},t}(),NQ={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},CQ={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},DEe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},REe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},cx=function(t,e,r,n,a,s){return t<e||t>r?S2(t,a,s.length>0):n.integers.reduce(function(o,l,c){for(;t>=l;)t-=l,o+=n.values[c];return o},"")+s},$te=function(t,e,r,n){var a="";do r||t--,a=n(t)+a,t/=e;while(t*e>=e);return a},Di=function(t,e,r,n,a){var s=r-e+1;return(t<0?"-":"")+($te(Math.abs(t),s,n,function(o){return Qi(Math.floor(o%s)+e)})+a)},Zm=function(t,e,r){r===void 0&&(r=". ");var n=e.length;return $te(Math.abs(t),n,!1,function(a){return e[Math.floor(a%n)]})+r},Tx=1,_0=2,E0=4,Wy=8,Sh=function(t,e,r,n,a,s){if(t<-9999||t>9999)return S2(t,4,a.length>0);var o=Math.abs(t),l=a;if(o===0)return e[0]+l;for(var c=0;o>0&&c<=4;c++){var u=o%10;u===0&&jo(s,Tx)&&l!==""?l=e[u]+l:u>1||u===1&&c===0||u===1&&c===1&&jo(s,_0)||u===1&&c===1&&jo(s,E0)&&t>100||u===1&&c>1&&jo(s,Wy)?l=e[u]+(c>0?r[c-1]:"")+l:u===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(t<0?n:"")+l},_Q="",EQ="",SQ="",z3="",S2=function(t,e,r){var n=r?". ":"",a=r?"":"",s=r?", ":"",o=r?" ":"";switch(e){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=Di(t,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return Zm(t,"",a);case 6:return cx(t,1,3999,NQ,3,n).toLowerCase();case 7:return cx(t,1,3999,NQ,3,n);case 8:return Di(t,945,969,!1,n);case 9:return Di(t,97,122,!1,n);case 10:return Di(t,65,90,!1,n);case 11:return Di(t,1632,1641,!0,n);case 12:case 49:return cx(t,1,9999,CQ,3,n);case 35:return cx(t,1,9999,CQ,3,n).toLowerCase();case 13:return Di(t,2534,2543,!0,n);case 14:case 30:return Di(t,6112,6121,!0,n);case 15:return Zm(t,"",a);case 16:return Zm(t,"",a);case 17:case 48:return Sh(t,"",_Q,"",a,_0|E0|Wy);case 47:return Sh(t,"",EQ,"",a,Tx|_0|E0|Wy);case 42:return Sh(t,"",_Q,"",a,_0|E0|Wy);case 41:return Sh(t,"",EQ,"",a,Tx|_0|E0|Wy);case 26:return Sh(t,"","",SQ,a,0);case 25:return Sh(t,"","",SQ,a,Tx|_0|E0);case 31:return Sh(t,"","",z3,s,Tx|_0|E0);case 33:return Sh(t,"","",z3,s,0);case 32:return Sh(t,"","",z3,s,Tx|_0|E0);case 18:return Di(t,2406,2415,!0,n);case 20:return cx(t,1,19999,REe,3,n);case 21:return Di(t,2790,2799,!0,n);case 22:return Di(t,2662,2671,!0,n);case 22:return cx(t,1,10999,DEe,3,n);case 23:return Zm(t,"");case 24:return Zm(t,"");case 27:return Di(t,3302,3311,!0,n);case 28:return Zm(t,"",a);case 29:return Zm(t,"",a);case 34:return Di(t,3792,3801,!0,n);case 37:return Di(t,6160,6169,!0,n);case 38:return Di(t,4160,4169,!0,n);case 39:return Di(t,2918,2927,!0,n);case 40:return Di(t,1776,1785,!0,n);case 43:return Di(t,3046,3055,!0,n);case 44:return Di(t,3174,3183,!0,n);case 45:return Di(t,3664,3673,!0,n);case 46:return Di(t,3872,3881,!0,n);case 3:default:return Di(t,48,57,!0,n)}},Gte="data-html2canvas-ignore",IQ=function(){function t(e,r,n){if(this.context=e,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new OEe,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(e,r){var n=this,a=MEe(e,r);if(!a.contentWindow)return Promise.reject("Unable to find iframe window");var s=e.defaultView.pageXOffset,o=e.defaultView.pageYOffset,l=a.contentWindow,c=l.document,u=QEe(a).then(function(){return yc(n,void 0,void 0,function(){var d,f;return Yl(this,function(A){switch(A.label){case 0:return this.scrolledElements.forEach(GEe),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),d=this.options.onclone,f=this.clonedReferenceElement,typeof f>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:A.sent(),A.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,UEe(c)]:[3,4];case 3:A.sent(),A.label=4;case 4:return typeof d=="function"?[2,Promise.resolve().then(function(){return d(c,f)}).then(function(){return a})]:[2,a]}})})});return c.open(),c.write(HEe(document.doctype)+"<html></html>"),$Ee(this.referenceElement.ownerDocument,s,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),u},t.prototype.createElementClone=function(e){if(jk(e,2))debugger;if(Qte(e))return this.createCanvasClone(e);if(yQ(e))return this.createVideoClone(e);if(bQ(e))return this.createStyleClone(e);var r=e.cloneNode(!1);return kk(r)&&(kk(e)&&e.currentSrc&&e.currentSrc!==e.src&&(r.src=e.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),wQ(r)?this.createCustomElementClone(r):r},t.prototype.createCustomElementClone=function(e){var r=document.createElement("html2canvascustomelement");return W3(e.style,r),r},t.prototype.createStyleClone=function(e){try{var r=e.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(s,o){return o&&typeof o.cssText=="string"?s+o.cssText:s},""),a=e.cloneNode(!1);return a.textContent=n,a}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return e.cloneNode(!1)},t.prototype.createCanvasClone=function(e){var r;if(this.options.inlineImages&&e.ownerDocument){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var a=e.cloneNode(!1);try{a.width=e.width,a.height=e.height;var s=e.getContext("2d"),o=a.getContext("2d");if(o)if(!this.options.allowTaint&&s)o.putImageData(s.getImageData(0,0,e.width,e.height),0,0);else{var l=(r=e.getContext("webgl2"))!==null&&r!==void 0?r:e.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}o.drawImage(e,0,0)}return a}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return a},t.prototype.createVideoClone=function(e){var r=e.ownerDocument.createElement("canvas");r.width=e.offsetWidth,r.height=e.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(e,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var a=e.ownerDocument.createElement("canvas");return a.width=e.offsetWidth,a.height=e.offsetHeight,a},t.prototype.appendChildNode=function(e,r,n){(!Xx(r)||!FEe(r)&&!r.hasAttribute(Gte)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!Xx(r)||!bQ(r))&&e.appendChild(this.cloneNode(r,n))},t.prototype.cloneChildNodes=function(e,r,n){for(var a=this,s=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;s;s=s.nextSibling)if(Xx(s)&&Hte(s)&&typeof s.assignedNodes=="function"){var o=s.assignedNodes();o.length&&o.forEach(function(l){return a.appendChildNode(r,l,n)})}else this.appendChildNode(r,s,n)},t.prototype.cloneNode=function(e,r){if(Lte(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var n=e.ownerDocument.defaultView;if(n&&Xx(e)&&(Bk(e)||mE(e))){var a=this.createElementClone(e);a.style.transitionProperty="none";var s=n.getComputedStyle(e),o=n.getComputedStyle(e,":before"),l=n.getComputedStyle(e,":after");this.referenceElement===e&&Bk(a)&&(this.clonedReferenceElement=a),$6(a)&&zEe(a);var c=this.counters.parse(new sQ(this.context,s)),u=this.resolvePseudoContent(e,a,o,_b.BEFORE);wQ(e)&&(r=!0),yQ(e)||this.cloneChildNodes(e,a,r),u&&a.insertBefore(u,a.firstChild);var d=this.resolvePseudoContent(e,a,l,_b.AFTER);return d&&a.appendChild(d),this.counters.pop(c),(s&&(this.options.copyStyles||mE(e))&&!Vte(e)||r)&&W3(s,a),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([a,e.scrollLeft,e.scrollTop]),(IS(e)||jS(e))&&(IS(a)||jS(a))&&(a.value=e.value),a}return e.cloneNode(!1)},t.prototype.resolvePseudoContent=function(e,r,n,a){var s=this;if(n){var o=n.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||n.display==="none")){this.counters.parse(new sQ(this.context,n));var c=new P_e(this.context,n),u=l.createElement("html2canvaspseudoelement");W3(n,u),c.content.forEach(function(f){if(f.type===0)u.appendChild(l.createTextNode(f.value));else if(f.type===22){var A=l.createElement("img");A.src=f.value,A.style.opacity="1",u.appendChild(A)}else if(f.type===18){if(f.name==="attr"){var h=f.values.filter(ls);h.length&&u.appendChild(l.createTextNode(e.getAttribute(h[0].value)||""))}else if(f.name==="counter"){var m=f.values.filter(Uv),p=m[0],x=m[1];if(p&&ls(p)){var v=s.counters.getCounterValue(p.value),y=x&&ls(x)?Ik.parse(s.context,x.value):3;u.appendChild(l.createTextNode(S2(v,y,!1)))}}else if(f.name==="counters"){var b=f.values.filter(Uv),p=b[0],w=b[1],x=b[2];if(p&&ls(p)){var j=s.counters.getCounterValues(p.value),I=x&&ls(x)?Ik.parse(s.context,x.value):3,C=w&&w.type===0?w.value:"",S=j.map(function(k){return S2(k,I,!1)}).join(C);u.appendChild(l.createTextNode(S))}}}else if(f.type===20)switch(f.value){case"open-quote":u.appendChild(l.createTextNode(aQ(c.quotes,s.quoteDepth++,!0)));break;case"close-quote":u.appendChild(l.createTextNode(aQ(c.quotes,--s.quoteDepth,!1)));break;default:u.appendChild(l.createTextNode(f.value))}}),u.className=Fk+" "+Ok;var d=a===_b.BEFORE?" "+Fk:" "+Ok;return mE(r)?r.className.baseValue+=d:r.className+=d,u}}},t.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},t}(),_b;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(_b||(_b={}));var MEe=function(t,e){var r=t.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=e.width.toString(),r.height=e.height.toString(),r.scrolling="no",r.setAttribute(Gte,"true"),t.body.appendChild(r),r},LEe=function(t){return new Promise(function(e){if(t.complete){e();return}if(!t.src){e();return}t.onload=e,t.onerror=e})},UEe=function(t){return Promise.all([].slice.call(t.images,0).map(LEe))},QEe=function(t){return new Promise(function(e,r){var n=t.contentWindow;if(!n)return r("No window assigned for iframe");var a=n.document;n.onload=t.onload=function(){n.onload=t.onload=null;var s=setInterval(function(){a.body.childNodes.length>0&&a.readyState==="complete"&&(clearInterval(s),e(t))},50)}})},VEe=["all","d","content"],W3=function(t,e){for(var r=t.length-1;r>=0;r--){var n=t.item(r);VEe.indexOf(n)===-1&&e.style.setProperty(n,t.getPropertyValue(n))}return e},HEe=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},$Ee=function(t,e,r){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||r!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,r)},GEe=function(t){var e=t[0],r=t[1],n=t[2];e.scrollLeft=r,e.scrollTop=n},KEe=":before",qEe=":after",Fk="___html2canvas___pseudoelement_before",Ok="___html2canvas___pseudoelement_after",jQ=`{
    content: "" !important;
    display: none !important;
}`,zEe=function(t){WEe(t,"."+Fk+KEe+jQ+`
         .`+Ok+qEe+jQ)},WEe=function(t,e){var r=t.ownerDocument;if(r){var n=r.createElement("style");n.textContent=e,t.appendChild(n)}},Kte=function(){function t(){}return t.getOrigin=function(e){var r=t._link;return r?(r.href=e,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),XEe=function(){function t(e,r){this.context=e,this._options=r,this._cache={}}return t.prototype.addImage=function(e){var r=Promise.resolve();return this.has(e)||(Y3(e)||eSe(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),r},t.prototype.match=function(e){return this._cache[e]},t.prototype.loadImage=function(e){return yc(this,void 0,void 0,function(){var r,n,a,s,o=this;return Yl(this,function(l){switch(l.label){case 0:return r=Kte.isSameOrigin(e),n=!X3(e)&&this._options.useCORS===!0&&Nl.SUPPORT_CORS_IMAGES&&!r,a=!X3(e)&&!r&&!Y3(e)&&typeof this._options.proxy=="string"&&Nl.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!X3(e)&&!Y3(e)&&!a&&!n?[2]:(s=e,a?[4,this.proxy(s)]:[3,2]);case 1:s=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(c,u){var d=new Image;d.onload=function(){return c(d)},d.onerror=u,(tSe(s)||n)&&(d.crossOrigin="anonymous"),d.src=s,d.complete===!0&&setTimeout(function(){return c(d)},500),o._options.imageTimeout>0&&setTimeout(function(){return u("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},t.prototype.has=function(e){return typeof this._cache[e]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(e){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var a=e.substring(0,256);return new Promise(function(s,o){var l=Nl.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")s(c.response);else{var f=new FileReader;f.addEventListener("load",function(){return s(f.result)},!1),f.addEventListener("error",function(A){return o(A)},!1),f.readAsDataURL(c.response)}else o("Failed to proxy resource "+a+" with status code "+c.status)},c.onerror=o;var u=n.indexOf("?")>-1?"&":"?";if(c.open("GET",""+n+u+"url="+encodeURIComponent(e)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var d=r._options.imageTimeout;c.timeout=d,c.ontimeout=function(){return o("Timed out ("+d+"ms) proxying "+a)}}c.send()})},t}(),YEe=/^data:image\/svg\+xml/i,JEe=/^data:image\/.*;base64,/i,ZEe=/^data:image\/.*/i,eSe=function(t){return Nl.SUPPORT_SVG_DRAWING||!rSe(t)},X3=function(t){return ZEe.test(t)},tSe=function(t){return JEe.test(t)},Y3=function(t){return t.substr(0,4)==="blob"},rSe=function(t){return t.substr(-3).toLowerCase()==="svg"||YEe.test(t)},tn=function(){function t(e,r){this.type=0,this.x=e,this.y=r}return t.prototype.add=function(e,r){return new t(this.x+e,this.y+r)},t}(),ux=function(t,e,r){return new tn(t.x+(e.x-t.x)*r,t.y+(e.y-t.y)*r)},SC=function(){function t(e,r,n,a){this.type=1,this.start=e,this.startControl=r,this.endControl=n,this.end=a}return t.prototype.subdivide=function(e,r){var n=ux(this.start,this.startControl,e),a=ux(this.startControl,this.endControl,e),s=ux(this.endControl,this.end,e),o=ux(n,a,e),l=ux(a,s,e),c=ux(o,l,e);return r?new t(this.start,n,o,c):new t(c,l,s,this.end)},t.prototype.add=function(e,r){return new t(this.start.add(e,r),this.startControl.add(e,r),this.endControl.add(e,r),this.end.add(e,r))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),bd=function(t){return t.type===1},nSe=function(){function t(e){var r=e.styles,n=e.bounds,a=qy(r.borderTopLeftRadius,n.width,n.height),s=a[0],o=a[1],l=qy(r.borderTopRightRadius,n.width,n.height),c=l[0],u=l[1],d=qy(r.borderBottomRightRadius,n.width,n.height),f=d[0],A=d[1],h=qy(r.borderBottomLeftRadius,n.width,n.height),m=h[0],p=h[1],x=[];x.push((s+c)/n.width),x.push((m+f)/n.width),x.push((o+p)/n.height),x.push((u+A)/n.height);var v=Math.max.apply(Math,x);v>1&&(s/=v,o/=v,c/=v,u/=v,f/=v,A/=v,m/=v,p/=v);var y=n.width-c,b=n.height-A,w=n.width-f,j=n.height-p,I=r.borderTopWidth,C=r.borderRightWidth,S=r.borderBottomWidth,E=r.borderLeftWidth,B=ys(r.paddingTop,e.bounds.width),k=ys(r.paddingRight,e.bounds.width),T=ys(r.paddingBottom,e.bounds.width),P=ys(r.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||o>0?Ms(n.left+E/3,n.top+I/3,s-E/3,o-I/3,Ua.TOP_LEFT):new tn(n.left+E/3,n.top+I/3),this.topRightBorderDoubleOuterBox=s>0||o>0?Ms(n.left+y,n.top+I/3,c-C/3,u-I/3,Ua.TOP_RIGHT):new tn(n.left+n.width-C/3,n.top+I/3),this.bottomRightBorderDoubleOuterBox=f>0||A>0?Ms(n.left+w,n.top+b,f-C/3,A-S/3,Ua.BOTTOM_RIGHT):new tn(n.left+n.width-C/3,n.top+n.height-S/3),this.bottomLeftBorderDoubleOuterBox=m>0||p>0?Ms(n.left+E/3,n.top+j,m-E/3,p-S/3,Ua.BOTTOM_LEFT):new tn(n.left+E/3,n.top+n.height-S/3),this.topLeftBorderDoubleInnerBox=s>0||o>0?Ms(n.left+E*2/3,n.top+I*2/3,s-E*2/3,o-I*2/3,Ua.TOP_LEFT):new tn(n.left+E*2/3,n.top+I*2/3),this.topRightBorderDoubleInnerBox=s>0||o>0?Ms(n.left+y,n.top+I*2/3,c-C*2/3,u-I*2/3,Ua.TOP_RIGHT):new tn(n.left+n.width-C*2/3,n.top+I*2/3),this.bottomRightBorderDoubleInnerBox=f>0||A>0?Ms(n.left+w,n.top+b,f-C*2/3,A-S*2/3,Ua.BOTTOM_RIGHT):new tn(n.left+n.width-C*2/3,n.top+n.height-S*2/3),this.bottomLeftBorderDoubleInnerBox=m>0||p>0?Ms(n.left+E*2/3,n.top+j,m-E*2/3,p-S*2/3,Ua.BOTTOM_LEFT):new tn(n.left+E*2/3,n.top+n.height-S*2/3),this.topLeftBorderStroke=s>0||o>0?Ms(n.left+E/2,n.top+I/2,s-E/2,o-I/2,Ua.TOP_LEFT):new tn(n.left+E/2,n.top+I/2),this.topRightBorderStroke=s>0||o>0?Ms(n.left+y,n.top+I/2,c-C/2,u-I/2,Ua.TOP_RIGHT):new tn(n.left+n.width-C/2,n.top+I/2),this.bottomRightBorderStroke=f>0||A>0?Ms(n.left+w,n.top+b,f-C/2,A-S/2,Ua.BOTTOM_RIGHT):new tn(n.left+n.width-C/2,n.top+n.height-S/2),this.bottomLeftBorderStroke=m>0||p>0?Ms(n.left+E/2,n.top+j,m-E/2,p-S/2,Ua.BOTTOM_LEFT):new tn(n.left+E/2,n.top+n.height-S/2),this.topLeftBorderBox=s>0||o>0?Ms(n.left,n.top,s,o,Ua.TOP_LEFT):new tn(n.left,n.top),this.topRightBorderBox=c>0||u>0?Ms(n.left+y,n.top,c,u,Ua.TOP_RIGHT):new tn(n.left+n.width,n.top),this.bottomRightBorderBox=f>0||A>0?Ms(n.left+w,n.top+b,f,A,Ua.BOTTOM_RIGHT):new tn(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=m>0||p>0?Ms(n.left,n.top+j,m,p,Ua.BOTTOM_LEFT):new tn(n.left,n.top+n.height),this.topLeftPaddingBox=s>0||o>0?Ms(n.left+E,n.top+I,Math.max(0,s-E),Math.max(0,o-I),Ua.TOP_LEFT):new tn(n.left+E,n.top+I),this.topRightPaddingBox=c>0||u>0?Ms(n.left+Math.min(y,n.width-C),n.top+I,y>n.width+C?0:Math.max(0,c-C),Math.max(0,u-I),Ua.TOP_RIGHT):new tn(n.left+n.width-C,n.top+I),this.bottomRightPaddingBox=f>0||A>0?Ms(n.left+Math.min(w,n.width-E),n.top+Math.min(b,n.height-S),Math.max(0,f-C),Math.max(0,A-S),Ua.BOTTOM_RIGHT):new tn(n.left+n.width-C,n.top+n.height-S),this.bottomLeftPaddingBox=m>0||p>0?Ms(n.left+E,n.top+Math.min(j,n.height-S),Math.max(0,m-E),Math.max(0,p-S),Ua.BOTTOM_LEFT):new tn(n.left+E,n.top+n.height-S),this.topLeftContentBox=s>0||o>0?Ms(n.left+E+P,n.top+I+B,Math.max(0,s-(E+P)),Math.max(0,o-(I+B)),Ua.TOP_LEFT):new tn(n.left+E+P,n.top+I+B),this.topRightContentBox=c>0||u>0?Ms(n.left+Math.min(y,n.width+E+P),n.top+I+B,y>n.width+E+P?0:c-E+P,u-(I+B),Ua.TOP_RIGHT):new tn(n.left+n.width-(C+k),n.top+I+B),this.bottomRightContentBox=f>0||A>0?Ms(n.left+Math.min(w,n.width-(E+P)),n.top+Math.min(b,n.height+I+B),Math.max(0,f-(C+k)),A-(S+T),Ua.BOTTOM_RIGHT):new tn(n.left+n.width-(C+k),n.top+n.height-(S+T)),this.bottomLeftContentBox=m>0||p>0?Ms(n.left+E+P,n.top+j,Math.max(0,m-(E+P)),p-(S+T),Ua.BOTTOM_LEFT):new tn(n.left+E+P,n.top+n.height-(S+T))}return t}(),Ua;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Ua||(Ua={}));var Ms=function(t,e,r,n,a){var s=4*((Math.sqrt(2)-1)/3),o=r*s,l=n*s,c=t+r,u=e+n;switch(a){case Ua.TOP_LEFT:return new SC(new tn(t,u),new tn(t,u-l),new tn(c-o,e),new tn(c,e));case Ua.TOP_RIGHT:return new SC(new tn(t,e),new tn(t+o,e),new tn(c,u-l),new tn(c,u));case Ua.BOTTOM_RIGHT:return new SC(new tn(c,e),new tn(c,e+l),new tn(t+o,u),new tn(t,u));case Ua.BOTTOM_LEFT:default:return new SC(new tn(c,u),new tn(c-o,u),new tn(t,e+l),new tn(t,e))}},PS=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},aSe=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},TS=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},sSe=function(){function t(e,r,n){this.offsetX=e,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return t}(),IC=function(){function t(e,r){this.path=e,this.target=r,this.type=1}return t}(),iSe=function(){function t(e){this.opacity=e,this.type=2,this.target=6}return t}(),oSe=function(t){return t.type===0},qte=function(t){return t.type===1},lSe=function(t){return t.type===2},PQ=function(t,e){return t.length===e.length?t.some(function(r,n){return r===e[n]}):!1},cSe=function(t,e,r,n,a){return t.map(function(s,o){switch(o){case 0:return s.add(e,r);case 1:return s.add(e+n,r);case 2:return s.add(e+n,r+a);case 3:return s.add(e,r+a)}return s})},zte=function(){function t(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t}(),Wte=function(){function t(e,r){if(this.container=e,this.parent=r,this.effects=[],this.curves=new nSe(this.container),this.container.styles.opacity<1&&this.effects.push(new iSe(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,a=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new sSe(n,a,s))}if(this.container.styles.overflowX!==0){var o=PS(this.curves),l=TS(this.curves);PQ(o,l)?this.effects.push(new IC(o,6)):(this.effects.push(new IC(o,2)),this.effects.push(new IC(l,4)))}}return t.prototype.getEffects=function(e){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,a=this.effects.slice(0);n;){var s=n.effects.filter(function(c){return!qte(c)});if(r||n.container.styles.position!==0||!n.parent){if(a.unshift.apply(a,s),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var o=PS(n.curves),l=TS(n.curves);PQ(o,l)||a.unshift(new IC(l,6))}}else a.unshift.apply(a,s);n=n.parent}return a.filter(function(c){return jo(c.target,e)})},t}(),Dk=function(t,e,r,n){t.container.elements.forEach(function(a){var s=jo(a.flags,4),o=jo(a.flags,2),l=new Wte(a,t);jo(a.styles.display,2048)&&n.push(l);var c=jo(a.flags,8)?[]:n;if(s||o){var u=s||a.styles.isPositioned()?r:e,d=new zte(l);if(a.styles.isPositioned()||a.styles.opacity<1||a.styles.isTransformed()){var f=a.styles.zIndex.order;if(f<0){var A=0;u.negativeZIndex.some(function(m,p){return f>m.element.container.styles.zIndex.order?(A=p,!1):A>0}),u.negativeZIndex.splice(A,0,d)}else if(f>0){var h=0;u.positiveZIndex.some(function(m,p){return f>=m.element.container.styles.zIndex.order?(h=p+1,!1):h>0}),u.positiveZIndex.splice(h,0,d)}else u.zeroOrAutoZIndexOrTransformedOrOpacity.push(d)}else a.styles.isFloating()?u.nonPositionedFloats.push(d):u.nonPositionedInlineLevel.push(d);Dk(l,d,s?d:r,c)}else a.styles.isInlineLevel()?e.inlineLevel.push(l):e.nonInlineLevel.push(l),Dk(l,e,r,c);jo(a.flags,8)&&Xte(a,c)})},Xte=function(t,e){for(var r=t instanceof Tk?t.start:1,n=t instanceof Tk?t.reversed:!1,a=0;a<e.length;a++){var s=e[a];s.container instanceof kte&&typeof s.container.value=="number"&&s.container.value!==0&&(r=s.container.value),s.listValue=S2(r,s.container.styles.listStyleType,!0),r+=n?-1:1}},uSe=function(t){var e=new Wte(t,null),r=new zte(e),n=[];return Dk(e,r,r,n),Xte(e.container,n),r},TQ=function(t,e){switch(e){case 0:return _d(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return _d(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return _d(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return _d(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},dSe=function(t,e){switch(e){case 0:return _d(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return _d(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return _d(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return _d(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},fSe=function(t,e){switch(e){case 0:return _d(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return _d(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return _d(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return _d(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},hSe=function(t,e){switch(e){case 0:return jC(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return jC(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return jC(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return jC(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},jC=function(t,e){var r=[];return bd(t)?r.push(t.subdivide(.5,!1)):r.push(t),bd(e)?r.push(e.subdivide(.5,!0)):r.push(e),r},_d=function(t,e,r,n){var a=[];return bd(t)?a.push(t.subdivide(.5,!1)):a.push(t),bd(r)?a.push(r.subdivide(.5,!0)):a.push(r),bd(n)?a.push(n.subdivide(.5,!0).reverse()):a.push(n),bd(e)?a.push(e.subdivide(.5,!1).reverse()):a.push(e),a},Yte=function(t){var e=t.bounds,r=t.styles;return e.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},BS=function(t){var e=t.styles,r=t.bounds,n=ys(e.paddingLeft,r.width),a=ys(e.paddingRight,r.width),s=ys(e.paddingTop,r.width),o=ys(e.paddingBottom,r.width);return r.add(n+e.borderLeftWidth,s+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+n+a),-(e.borderTopWidth+e.borderBottomWidth+s+o))},ASe=function(t,e){return t===0?e.bounds:t===2?BS(e):Yte(e)},mSe=function(t,e){return t===0?e.bounds:t===2?BS(e):Yte(e)},J3=function(t,e,r){var n=ASe(Bx(t.styles.backgroundOrigin,e),t),a=mSe(Bx(t.styles.backgroundClip,e),t),s=pSe(Bx(t.styles.backgroundSize,e),r,n),o=s[0],l=s[1],c=qy(Bx(t.styles.backgroundPosition,e),n.width-o,n.height-l),u=gSe(Bx(t.styles.backgroundRepeat,e),c,s,n,a),d=Math.round(n.left+c[0]),f=Math.round(n.top+c[1]);return[u,d,f,o,l]},dx=function(t){return ls(t)&&t.value===mv.AUTO},PC=function(t){return typeof t=="number"},pSe=function(t,e,r){var n=e[0],a=e[1],s=e[2],o=t[0],l=t[1];if(!o)return[0,0];if(io(o)&&l&&io(l))return[ys(o,r.width),ys(l,r.height)];var c=PC(s);if(ls(o)&&(o.value===mv.CONTAIN||o.value===mv.COVER)){if(PC(s)){var u=r.width/r.height;return u<s!=(o.value===mv.COVER)?[r.width,r.width/s]:[r.height*s,r.height]}return[r.width,r.height]}var d=PC(n),f=PC(a),A=d||f;if(dx(o)&&(!l||dx(l))){if(d&&f)return[n,a];if(!c&&!A)return[r.width,r.height];if(A&&c){var h=d?n:a*s,m=f?a:n/s;return[h,m]}var p=d?n:r.width,x=f?a:r.height;return[p,x]}if(c){var v=0,y=0;return io(o)?v=ys(o,r.width):io(l)&&(y=ys(l,r.height)),dx(o)?v=y*s:(!l||dx(l))&&(y=v/s),[v,y]}var b=null,w=null;if(io(o)?b=ys(o,r.width):l&&io(l)&&(w=ys(l,r.height)),b!==null&&(!l||dx(l))&&(w=d&&f?b/n*a:r.height),w!==null&&dx(o)&&(b=d&&f?w/a*n:r.width),b!==null&&w!==null)return[b,w];throw new Error("Unable to calculate background-size for element")},Bx=function(t,e){var r=t[e];return typeof r>"u"?t[0]:r},gSe=function(t,e,r,n,a){var s=e[0],o=e[1],l=r[0],c=r[1];switch(t){case 2:return[new tn(Math.round(n.left),Math.round(n.top+o)),new tn(Math.round(n.left+n.width),Math.round(n.top+o)),new tn(Math.round(n.left+n.width),Math.round(c+n.top+o)),new tn(Math.round(n.left),Math.round(c+n.top+o))];case 3:return[new tn(Math.round(n.left+s),Math.round(n.top)),new tn(Math.round(n.left+s+l),Math.round(n.top)),new tn(Math.round(n.left+s+l),Math.round(n.height+n.top)),new tn(Math.round(n.left+s),Math.round(n.height+n.top))];case 1:return[new tn(Math.round(n.left+s),Math.round(n.top+o)),new tn(Math.round(n.left+s+l),Math.round(n.top+o)),new tn(Math.round(n.left+s+l),Math.round(n.top+o+c)),new tn(Math.round(n.left+s),Math.round(n.top+o+c))];default:return[new tn(Math.round(a.left),Math.round(a.top)),new tn(Math.round(a.left+a.width),Math.round(a.top)),new tn(Math.round(a.left+a.width),Math.round(a.height+a.top)),new tn(Math.round(a.left),Math.round(a.height+a.top))]}},xSe="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",BQ="Hidden Text",vSe=function(){function t(e){this._data={},this._document=e}return t.prototype.parseMetrics=function(e,r){var n=this._document.createElement("div"),a=this._document.createElement("img"),s=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),a.src=xSe,a.width=1,a.height=1,a.style.margin="0",a.style.padding="0",a.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=r,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(BQ)),n.appendChild(s),n.appendChild(a);var l=a.offsetTop-s.offsetTop+2;n.removeChild(s),n.appendChild(this._document.createTextNode(BQ)),n.style.lineHeight="normal",a.style.verticalAlign="super";var c=a.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:l,middle:c}},t.prototype.getMetrics=function(e,r){var n=e+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(e,r)),this._data[n]},t}(),Jte=function(){function t(e,r){this.context=e,this.options=r}return t}(),ySe=1e4,bSe=function(t){If(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a._activeEffects=[],a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),n.canvas||(a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px"),a.fontMetrics=new vSe(document),a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.ctx.textBaseline="bottom",a._activeEffects=[],a.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),a}return e.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(a){return n.applyEffect(a)})},e.prototype.applyEffect=function(r){this.ctx.save(),lSe(r)&&(this.ctx.globalAlpha=r.opacity),oSe(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),qte(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(r){return yc(this,void 0,void 0,function(){var n;return Yl(this,function(a){switch(a.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(r){return yc(this,void 0,void 0,function(){return Yl(this,function(n){switch(n.label){case 0:if(jo(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(r,n,a){var s=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+a);else{var o=V6(r.text);o.reduce(function(l,c){return s.ctx.fillText(c,l,r.bounds.top+a),l+s.ctx.measureText(c).width},r.bounds.left)}},e.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),a=ESe(r.fontFamily).join(", "),s=Rw(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,s,a].join(" "),a,s]},e.prototype.renderTextNode=function(r,n){return yc(this,void 0,void 0,function(){var a,s,o,l,c,u,d,f,A=this;return Yl(this,function(h){return a=this.createFontStyle(n),s=a[0],o=a[1],l=a[2],this.ctx.font=s,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),u=c.baseline,d=c.middle,f=n.paintOrder,r.textBounds.forEach(function(m){f.forEach(function(p){switch(p){case 0:A.ctx.fillStyle=$o(n.color),A.renderTextWithLetterSpacing(m,n.letterSpacing,u);var x=n.textShadow;x.length&&m.text.trim().length&&(x.slice(0).reverse().forEach(function(v){A.ctx.shadowColor=$o(v.color),A.ctx.shadowOffsetX=v.offsetX.number*A.options.scale,A.ctx.shadowOffsetY=v.offsetY.number*A.options.scale,A.ctx.shadowBlur=v.blur.number,A.renderTextWithLetterSpacing(m,n.letterSpacing,u)}),A.ctx.shadowColor="",A.ctx.shadowOffsetX=0,A.ctx.shadowOffsetY=0,A.ctx.shadowBlur=0),n.textDecorationLine.length&&(A.ctx.fillStyle=$o(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(v){switch(v){case 1:A.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top+u),m.bounds.width,1);break;case 2:A.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top),m.bounds.width,1);break;case 3:A.ctx.fillRect(m.bounds.left,Math.ceil(m.bounds.top+d),m.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&m.text.trim().length&&(A.ctx.strokeStyle=$o(n.webkitTextStrokeColor),A.ctx.lineWidth=n.webkitTextStrokeWidth,A.ctx.lineJoin=window.chrome?"miter":"round",A.ctx.strokeText(m.text,m.bounds.left,m.bounds.top+u)),A.ctx.strokeStyle="",A.ctx.lineWidth=0,A.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(r,n,a){if(a&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var s=BS(r),o=TS(n);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(a,0,0,r.intrinsicWidth,r.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(r){return yc(this,void 0,void 0,function(){var n,a,s,o,l,c,y,y,u,d,f,A,w,h,m,j,p,x,v,y,b,w,j;return Yl(this,function(I){switch(I.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,a=r.curves,s=n.styles,o=0,l=n.textNodes,I.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,s)]):[3,4];case 2:I.sent(),I.label=3;case 3:return o++,[3,1];case 4:if(!(n instanceof Pte))return[3,8];I.label=5;case 5:return I.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return y=I.sent(),this.renderReplacedElement(n,a,y),[3,8];case 7:return I.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof Tte&&this.renderReplacedElement(n,a,n.canvas),!(n instanceof Bte))return[3,12];I.label=9;case 9:return I.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return y=I.sent(),this.renderReplacedElement(n,a,y),[3,12];case 11:return I.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof Dte&&n.tree?(u=new e(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,u.render(n.tree)]):[3,14];case 13:d=I.sent(),n.width&&n.height&&this.ctx.drawImage(d,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),I.label=14;case 14:if(n instanceof H6&&(f=Math.min(n.bounds.width,n.bounds.height),n.type===ES?n.checked&&(this.ctx.save(),this.path([new tn(n.bounds.left+f*.39363,n.bounds.top+f*.79),new tn(n.bounds.left+f*.16,n.bounds.top+f*.5549),new tn(n.bounds.left+f*.27347,n.bounds.top+f*.44071),new tn(n.bounds.left+f*.39694,n.bounds.top+f*.5649),new tn(n.bounds.left+f*.72983,n.bounds.top+f*.23),new tn(n.bounds.left+f*.84,n.bounds.top+f*.34085),new tn(n.bounds.left+f*.39363,n.bounds.top+f*.79)]),this.ctx.fillStyle=$o(vQ),this.ctx.fill(),this.ctx.restore()):n.type===SS&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+f/2,n.bounds.top+f/2,f/4,0,Math.PI*2,!0),this.ctx.fillStyle=$o(vQ),this.ctx.fill(),this.ctx.restore())),wSe(n)&&n.value.length){switch(A=this.createFontStyle(s),w=A[0],h=A[1],m=this.fontMetrics.getMetrics(w,h).baseline,this.ctx.font=w,this.ctx.fillStyle=$o(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=CSe(n.styles.textAlign),j=BS(n),p=0,n.styles.textAlign){case 1:p+=j.width/2;break;case 2:p+=j.width;break}x=j.add(p,0,0,-j.height/2+1),this.ctx.save(),this.path([new tn(j.left,j.top),new tn(j.left+j.width,j.top),new tn(j.left+j.width,j.top+j.height),new tn(j.left,j.top+j.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Cb(n.value,x),s.letterSpacing,m),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!jo(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(v=n.styles.listStyleImage,v.type!==0)return[3,18];y=void 0,b=v.url,I.label=15;case 15:return I.trys.push([15,17,,18]),[4,this.context.cache.match(b)];case 16:return y=I.sent(),this.ctx.drawImage(y,n.bounds.left-(y.width+10),n.bounds.top),[3,18];case 17:return I.sent(),this.context.logger.error("Error loading list-style-image "+b),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(w=this.createFontStyle(s)[0],this.ctx.font=w,this.ctx.fillStyle=$o(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",j=new yA(n.bounds.left,n.bounds.top+ys(n.styles.paddingTop,n.bounds.width),n.bounds.width,rQ(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Cb(r.listValue,j),s.letterSpacing,rQ(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),I.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(r){return yc(this,void 0,void 0,function(){var n,a,v,s,o,v,l,c,v,u,d,v,f,A,v,h,m,v,p,x,v;return Yl(this,function(y){switch(y.label){case 0:if(jo(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:y.sent(),n=0,a=r.negativeZIndex,y.label=2;case 2:return n<a.length?(v=a[n],[4,this.renderStack(v)]):[3,5];case 3:y.sent(),y.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:y.sent(),s=0,o=r.nonInlineLevel,y.label=7;case 7:return s<o.length?(v=o[s],[4,this.renderNode(v)]):[3,10];case 8:y.sent(),y.label=9;case 9:return s++,[3,7];case 10:l=0,c=r.nonPositionedFloats,y.label=11;case 11:return l<c.length?(v=c[l],[4,this.renderStack(v)]):[3,14];case 12:y.sent(),y.label=13;case 13:return l++,[3,11];case 14:u=0,d=r.nonPositionedInlineLevel,y.label=15;case 15:return u<d.length?(v=d[u],[4,this.renderStack(v)]):[3,18];case 16:y.sent(),y.label=17;case 17:return u++,[3,15];case 18:f=0,A=r.inlineLevel,y.label=19;case 19:return f<A.length?(v=A[f],[4,this.renderNode(v)]):[3,22];case 20:y.sent(),y.label=21;case 21:return f++,[3,19];case 22:h=0,m=r.zeroOrAutoZIndexOrTransformedOrOpacity,y.label=23;case 23:return h<m.length?(v=m[h],[4,this.renderStack(v)]):[3,26];case 24:y.sent(),y.label=25;case 25:return h++,[3,23];case 26:p=0,x=r.positiveZIndex,y.label=27;case 27:return p<x.length?(v=x[p],[4,this.renderStack(v)]):[3,30];case 28:y.sent(),y.label=29;case 29:return p++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},e.prototype.formatPath=function(r){var n=this;r.forEach(function(a,s){var o=bd(a)?a.start:a;s===0?n.ctx.moveTo(o.x,o.y):n.ctx.lineTo(o.x,o.y),bd(a)&&n.ctx.bezierCurveTo(a.startControl.x,a.startControl.y,a.endControl.x,a.endControl.y,a.end.x,a.end.y)})},e.prototype.renderRepeat=function(r,n,a,s){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},e.prototype.resizeImage=function(r,n,a){var s;if(r.width===n&&r.height===a)return r;var o=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,l=o.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,a);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,n,a),l},e.prototype.renderBackgroundImage=function(r){return yc(this,void 0,void 0,function(){var n,a,s,o,l,c;return Yl(this,function(u){switch(u.label){case 0:n=r.styles.backgroundImage.length-1,a=function(d){var f,A,h,B,oe,ie,P,K,S,m,B,oe,ie,P,K,p,x,v,y,b,w,j,I,C,S,E,B,k,T,P,K,le,oe,ie,Ae,te,Te,Ue,O,H,G,L;return Yl(this,function(W){switch(W.label){case 0:if(d.type!==0)return[3,5];f=void 0,A=d.url,W.label=1;case 1:return W.trys.push([1,3,,4]),[4,s.context.cache.match(A)];case 2:return f=W.sent(),[3,4];case 3:return W.sent(),s.context.logger.error("Error loading background-image "+A),[3,4];case 4:return f&&(h=J3(r,n,[f.width,f.height,f.width/f.height]),B=h[0],oe=h[1],ie=h[2],P=h[3],K=h[4],S=s.ctx.createPattern(s.resizeImage(f,P,K),"repeat"),s.renderRepeat(B,S,oe,ie)),[3,6];case 5:oCe(d)?(m=J3(r,n,[null,null,null]),B=m[0],oe=m[1],ie=m[2],P=m[3],K=m[4],p=rCe(d.angle,P,K),x=p[0],v=p[1],y=p[2],b=p[3],w=p[4],j=document.createElement("canvas"),j.width=P,j.height=K,I=j.getContext("2d"),C=I.createLinearGradient(v,b,y,w),eQ(d.stops,x).forEach(function(X){return C.addColorStop(X.stop,$o(X.color))}),I.fillStyle=C,I.fillRect(0,0,P,K),P>0&&K>0&&(S=s.ctx.createPattern(j,"repeat"),s.renderRepeat(B,S,oe,ie))):lCe(d)&&(E=J3(r,n,[null,null,null]),B=E[0],k=E[1],T=E[2],P=E[3],K=E[4],le=d.position.length===0?[L6]:d.position,oe=ys(le[0],P),ie=ys(le[le.length-1],K),Ae=nCe(d,oe,ie,P,K),te=Ae[0],Te=Ae[1],te>0&&Te>0&&(Ue=s.ctx.createRadialGradient(k+oe,T+ie,0,k+oe,T+ie,te),eQ(d.stops,te*2).forEach(function(X){return Ue.addColorStop(X.stop,$o(X.color))}),s.path(B),s.ctx.fillStyle=Ue,te!==Te?(O=r.bounds.left+.5*r.bounds.width,H=r.bounds.top+.5*r.bounds.height,G=Te/te,L=1/G,s.ctx.save(),s.ctx.translate(O,H),s.ctx.transform(1,0,0,G,0,0),s.ctx.translate(-O,-H),s.ctx.fillRect(k,L*(T-H)+H,P,K*L),s.ctx.restore()):s.ctx.fill())),W.label=6;case 6:return n--,[2]}})},s=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),u.label=1;case 1:return o<l.length?(c=l[o],[5,a(c)]):[3,4];case 2:u.sent(),u.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(r,n,a){return yc(this,void 0,void 0,function(){return Yl(this,function(s){return this.path(TQ(a,n)),this.ctx.fillStyle=$o(r),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(r,n,a,s){return yc(this,void 0,void 0,function(){var o,l;return Yl(this,function(c){switch(c.label){case 0:return n<3?[4,this.renderSolidBorder(r,a,s)]:[3,2];case 1:return c.sent(),[2];case 2:return o=dSe(s,a),this.path(o),this.ctx.fillStyle=$o(r),this.ctx.fill(),l=fSe(s,a),this.path(l),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(r){return yc(this,void 0,void 0,function(){var n,a,s,o,l,c,u,d,f=this;return Yl(this,function(A){switch(A.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,a=!hm(n.backgroundColor)||n.backgroundImage.length,s=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],o=NSe(Bx(n.backgroundClip,0),r.curves),a||n.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),hm(n.backgroundColor)||(this.ctx.fillStyle=$o(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:A.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(h){f.ctx.save();var m=PS(r.curves),p=h.inset?0:ySe,x=cSe(m,-p+(h.inset?1:-1)*h.spread.number,(h.inset?1:-1)*h.spread.number,h.spread.number*(h.inset?-2:2),h.spread.number*(h.inset?-2:2));h.inset?(f.path(m),f.ctx.clip(),f.mask(x)):(f.mask(m),f.ctx.clip(),f.path(x)),f.ctx.shadowOffsetX=h.offsetX.number+p,f.ctx.shadowOffsetY=h.offsetY.number,f.ctx.shadowColor=$o(h.color),f.ctx.shadowBlur=h.blur.number,f.ctx.fillStyle=h.inset?$o(h.color):"rgba(0,0,0,1)",f.ctx.fill(),f.ctx.restore()}),A.label=2;case 2:l=0,c=0,u=s,A.label=3;case 3:return c<u.length?(d=u[c],d.style!==0&&!hm(d.color)&&d.width>0?d.style!==2?[3,5]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return A.sent(),[3,11];case 5:return d.style!==3?[3,7]:[4,this.renderDashedDottedBorder(d.color,d.width,l,r.curves,3)];case 6:return A.sent(),[3,11];case 7:return d.style!==4?[3,9]:[4,this.renderDoubleBorder(d.color,d.width,l,r.curves)];case 8:return A.sent(),[3,11];case 9:return[4,this.renderSolidBorder(d.color,l,r.curves)];case 10:A.sent(),A.label=11;case 11:l++,A.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(r,n,a,s,o){return yc(this,void 0,void 0,function(){var l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,I,j,I;return Yl(this,function(C){return this.ctx.save(),l=hSe(s,a),c=TQ(s,a),o===2&&(this.path(c),this.ctx.clip()),bd(c[0])?(u=c[0].start.x,d=c[0].start.y):(u=c[0].x,d=c[0].y),bd(c[1])?(f=c[1].end.x,A=c[1].end.y):(f=c[1].x,A=c[1].y),a===0||a===2?h=Math.abs(u-f):h=Math.abs(d-A),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),m=n<3?n*3:n*2,p=n<3?n*2:n,o===3&&(m=n,p=n),x=!0,h<=m*2?x=!1:h<=m*2+p?(v=h/(2*m+p),m*=v,p*=v):(y=Math.floor((h+p)/(m+p)),b=(h-y*m)/(y-1),w=(h-(y+1)*m)/y,p=w<=0||Math.abs(p-b)<Math.abs(p-w)?b:w),x&&(o===3?this.ctx.setLineDash([0,m+p]):this.ctx.setLineDash([m,p])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=$o(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(bd(c[0])&&(j=c[3],I=c[0],this.ctx.beginPath(),this.formatPath([new tn(j.end.x,j.end.y),new tn(I.start.x,I.start.y)]),this.ctx.stroke()),bd(c[1])&&(j=c[1],I=c[2],this.ctx.beginPath(),this.formatPath([new tn(j.end.x,j.end.y),new tn(I.start.x,I.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(r){return yc(this,void 0,void 0,function(){var n;return Yl(this,function(a){switch(a.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=$o(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=uSe(r),[4,this.renderStack(n)];case 1:return a.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(Jte),wSe=function(t){return t instanceof Ote||t instanceof Fte?!0:t instanceof H6&&t.type!==SS&&t.type!==ES},NSe=function(t,e){switch(t){case 0:return PS(e);case 2:return aSe(e);case 1:default:return TS(e)}},CSe=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},_Se=["-apple-system","system-ui"],ESe=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(e){return _Se.indexOf(e)===-1}):t},SSe=function(t){If(e,t);function e(r,n){var a=t.call(this,r,n)||this;return a.canvas=n.canvas?n.canvas:document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),a.options=n,a.canvas.width=Math.floor(n.width*n.scale),a.canvas.height=Math.floor(n.height*n.scale),a.canvas.style.width=n.width+"px",a.canvas.style.height=n.height+"px",a.ctx.scale(a.options.scale,a.options.scale),a.ctx.translate(-n.x,-n.y),a.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),a}return e.prototype.render=function(r){return yc(this,void 0,void 0,function(){var n,a;return Yl(this,function(s){switch(s.label){case 0:return n=Pk(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,ISe(n)];case 1:return a=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=$o(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(a,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(Jte),ISe=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},jSe=function(){function t(e){var r=e.id,n=e.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,lC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,lC([this.id,this.getTime()+"ms"],e))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,lC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,lC([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.instances={},t}(),PSe=function(){function t(e,r){var n;this.windowBounds=r,this.instanceName="#"+t.instanceCount++,this.logger=new jSe({id:this.instanceName,enabled:e.logging}),this.cache=(n=e.cache)!==null&&n!==void 0?n:new XEe(this,e)}return t.instanceCount=1,t}(),Vm=function(t,e){return e===void 0&&(e={}),TSe(t,e)};typeof window<"u"&&Kte.setContext(window);var TSe=function(t,e){return yc(void 0,void 0,void 0,function(){var r,n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,C,I,C,S,E,B,k,T,P,K,le,oe,ie,Ae,te,Te,Ue,O,H,G;return Yl(this,function(L){switch(L.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=t.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return a={allowTaint:(S=e.allowTaint)!==null&&S!==void 0?S:!1,imageTimeout:(E=e.imageTimeout)!==null&&E!==void 0?E:15e3,proxy:e.proxy,useCORS:(B=e.useCORS)!==null&&B!==void 0?B:!1},s=mk({logging:(k=e.logging)!==null&&k!==void 0?k:!0,cache:e.cache},a),o={windowWidth:(T=e.windowWidth)!==null&&T!==void 0?T:n.innerWidth,windowHeight:(P=e.windowHeight)!==null&&P!==void 0?P:n.innerHeight,scrollX:(K=e.scrollX)!==null&&K!==void 0?K:n.pageXOffset,scrollY:(le=e.scrollY)!==null&&le!==void 0?le:n.pageYOffset},l=new yA(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new PSe(s,l),u=(oe=e.foreignObjectRendering)!==null&&oe!==void 0?oe:!1,d={allowTaint:(ie=e.allowTaint)!==null&&ie!==void 0?ie:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:u,copyStyles:u},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),f=new IQ(c,t,d),A=f.clonedReferenceElement,A?[4,f.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return h=L.sent(),m=$6(A)||kEe(A)?cwe(A.ownerDocument):Wj(c,A),p=m.width,x=m.height,v=m.left,y=m.top,b=BSe(c,A,e.backgroundColor),w={canvas:e.canvas,backgroundColor:b,scale:(te=(Ae=e.scale)!==null&&Ae!==void 0?Ae:n.devicePixelRatio)!==null&&te!==void 0?te:1,x:((Te=e.x)!==null&&Te!==void 0?Te:0)+v,y:((Ue=e.y)!==null&&Ue!==void 0?Ue:0)+y,width:(O=e.width)!==null&&O!==void 0?O:Math.ceil(p),height:(H=e.height)!==null&&H!==void 0?H:Math.ceil(x)},u?(c.logger.debug("Document cloned, using foreign object rendering"),C=new SSe(c,w),[4,C.render(A)]):[3,3];case 2:return j=L.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+v+","+y+" with size "+p+"x"+x+" using computed rendering"),c.logger.debug("Starting DOM parsing"),I=Mte(c,A),b===I.styles.backgroundColor&&(I.styles.backgroundColor=iA.TRANSPARENT),c.logger.debug("Starting renderer for element at "+w.x+","+w.y+" with size "+w.width+"x"+w.height),C=new bSe(c,w),[4,C.render(I)];case 4:j=L.sent(),L.label=5;case 5:return(!((G=e.removeContainer)!==null&&G!==void 0)||G)&&(IQ.destroy(h)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,j]}})})},BSe=function(t,e,r){var n=e.ownerDocument,a=n.documentElement?wb(t,getComputedStyle(n.documentElement).backgroundColor):iA.TRANSPARENT,s=n.body?wb(t,getComputedStyle(n.body).backgroundColor):iA.TRANSPARENT,o=typeof r=="string"?wb(t,r):r===null?iA.TRANSPARENT:4294967295;return e===n.documentElement?hm(a)?hm(s)?o:s:a:o};const G6=Object.freeze(Object.defineProperty({__proto__:null,default:Vm},Symbol.toStringTag,{value:"Module"})),kSe="modulepreload",FSe=function(t){return"/"+t},kQ={},oA=function(e,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=FSe(c),c in kQ)return;kQ[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":kSe,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((A,h)=>{f.addEventListener("load",A),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};function es(t){"@babel/helpers - typeof";return es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},es(t)}var Cf=Uint8Array,Du=Uint16Array,K6=Int32Array,q6=new Cf([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),z6=new Cf([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),FQ=new Cf([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Zte=function(t,e){for(var r=new Du(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var a=new K6(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)a[s]=s-r[n]<<5|n;return{b:r,r:a}},ere=Zte(q6,2),OSe=ere.b,Rk=ere.r;OSe[28]=258,Rk[258]=28;var DSe=Zte(z6,0),OQ=DSe.r,Mk=new Du(32768);for(var ks=0;ks<32768;++ks){var f0=(ks&43690)>>1|(ks&21845)<<1;f0=(f0&52428)>>2|(f0&13107)<<2,f0=(f0&61680)>>4|(f0&3855)<<4,Mk[ks]=((f0&65280)>>8|(f0&255)<<8)>>1}var Eb=function(t,e,r){for(var n=t.length,a=0,s=new Du(e);a<n;++a)t[a]&&++s[t[a]-1];var o=new Du(e);for(a=1;a<e;++a)o[a]=o[a-1]+s[a-1]<<1;var l;if(r){l=new Du(1<<e);var c=15-e;for(a=0;a<n;++a)if(t[a])for(var u=a<<4|t[a],d=e-t[a],f=o[t[a]-1]++<<d,A=f|(1<<d)-1;f<=A;++f)l[Mk[f]>>c]=u}else for(l=new Du(n),a=0;a<n;++a)t[a]&&(l[a]=Mk[o[t[a]-1]++]>>15-t[a]);return l},Ag=new Cf(288);for(var ks=0;ks<144;++ks)Ag[ks]=8;for(var ks=144;ks<256;++ks)Ag[ks]=9;for(var ks=256;ks<280;++ks)Ag[ks]=7;for(var ks=280;ks<288;++ks)Ag[ks]=8;var kS=new Cf(32);for(var ks=0;ks<32;++ks)kS[ks]=5;var RSe=Eb(Ag,9,0),MSe=Eb(kS,5,0),tre=function(t){return(t+7)/8|0},LSe=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Cf(t.subarray(e,r))},Ih=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},py=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},Z3=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var a=r.length,s=r.slice();if(!a)return{t:nre,l:0};if(a==1){var o=new Cf(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(j,I){return j.f-I.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=a-1;)l=r[r[u].f<r[f].f?u++:f++],c=r[u!=d&&r[u].f<r[f].f?u++:f++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var A=s[0].s,n=1;n<a;++n)s[n].s>A&&(A=s[n].s);var h=new Du(A+1),m=Lk(r[d-1],h,0);if(m>e){var n=0,p=0,x=m-e,v=1<<x;for(s.sort(function(I,C){return h[C.s]-h[I.s]||I.f-C.f});n<a;++n){var y=s[n].s;if(h[y]>e)p+=v-(1<<m-h[y]),h[y]=e;else break}for(p>>=x;p>0;){var b=s[n].s;h[b]<e?p-=1<<e-h[b]++-1:++n}for(;n>=0&&p;--n){var w=s[n].s;h[w]==e&&(--h[w],++p)}m=e}return{t:new Cf(h),l:m}},Lk=function(t,e,r){return t.s==-1?Math.max(Lk(t.l,e,r+1),Lk(t.r,e,r+1)):e[t.s]=r},DQ=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Du(++e),n=0,a=t[0],s=1,o=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==a&&l!=e)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[l]}return{c:r.subarray(0,n),n:e}},gy=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},rre=function(t,e,r){var n=r.length,a=tre(e+2);t[a]=n&255,t[a+1]=n>>8,t[a+2]=t[a]^255,t[a+3]=t[a+1]^255;for(var s=0;s<n;++s)t[a+s+4]=r[s];return(a+4+n)*8},RQ=function(t,e,r,n,a,s,o,l,c,u,d){Ih(e,d++,r),++a[256];for(var f=Z3(a,15),A=f.t,h=f.l,m=Z3(s,15),p=m.t,x=m.l,v=DQ(A),y=v.c,b=v.n,w=DQ(p),j=w.c,I=w.n,C=new Du(19),S=0;S<y.length;++S)++C[y[S]&31];for(var S=0;S<j.length;++S)++C[j[S]&31];for(var E=Z3(C,7),B=E.t,k=E.l,T=19;T>4&&!B[FQ[T-1]];--T);var P=u+5<<3,K=gy(a,Ag)+gy(s,kS)+o,le=gy(a,A)+gy(s,p)+o+14+3*T+gy(C,B)+2*C[16]+3*C[17]+7*C[18];if(c>=0&&P<=K&&P<=le)return rre(e,d,t.subarray(c,c+u));var oe,ie,Ae,te;if(Ih(e,d,1+(le<K)),d+=2,le<K){oe=Eb(A,h,0),ie=A,Ae=Eb(p,x,0),te=p;var Te=Eb(B,k,0);Ih(e,d,b-257),Ih(e,d+5,I-1),Ih(e,d+10,T-4),d+=14;for(var S=0;S<T;++S)Ih(e,d+3*S,B[FQ[S]]);d+=3*T;for(var Ue=[y,j],O=0;O<2;++O)for(var H=Ue[O],S=0;S<H.length;++S){var G=H[S]&31;Ih(e,d,Te[G]),d+=B[G],G>15&&(Ih(e,d,H[S]>>5&127),d+=H[S]>>12)}}else oe=RSe,ie=Ag,Ae=MSe,te=kS;for(var S=0;S<l;++S){var L=n[S];if(L>255){var G=L>>18&31;py(e,d,oe[G+257]),d+=ie[G+257],G>7&&(Ih(e,d,L>>23&31),d+=q6[G]);var W=L&31;py(e,d,Ae[W]),d+=te[W],W>3&&(py(e,d,L>>5&8191),d+=z6[W])}else py(e,d,oe[L]),d+=ie[L]}return py(e,d,oe[256]),d+ie[256]},USe=new K6([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),nre=new Cf(0),QSe=function(t,e,r,n,a,s){var o=s.z||t.length,l=new Cf(n+o+5*(1+Math.ceil(o/7e3))+a),c=l.subarray(n,l.length-a),u=s.l,d=(s.r||0)&7;if(e){d&&(c[0]=s.r>>3);for(var f=USe[e-1],A=f>>13,h=f&8191,m=(1<<r)-1,p=s.p||new Du(32768),x=s.h||new Du(m+1),v=Math.ceil(r/3),y=2*v,b=function(re){return(t[re]^t[re+1]<<v^t[re+2]<<y)&m},w=new K6(25e3),j=new Du(288),I=new Du(32),C=0,S=0,E=s.i||0,B=0,k=s.w||0,T=0;E+2<o;++E){var P=b(E),K=E&32767,le=x[P];if(p[K]=le,x[P]=K,k<=E){var oe=o-E;if((C>7e3||B>24576)&&(oe>423||!u)){d=RQ(t,c,0,w,j,I,S,B,T,E-T,d),B=C=S=0,T=E;for(var ie=0;ie<286;++ie)j[ie]=0;for(var ie=0;ie<30;++ie)I[ie]=0}var Ae=2,te=0,Te=h,Ue=K-le&32767;if(oe>2&&P==b(E-Ue))for(var O=Math.min(A,oe)-1,H=Math.min(32767,E),G=Math.min(258,oe);Ue<=H&&--Te&&K!=le;){if(t[E+Ae]==t[E+Ae-Ue]){for(var L=0;L<G&&t[E+L]==t[E+L-Ue];++L);if(L>Ae){if(Ae=L,te=Ue,L>O)break;for(var W=Math.min(Ue,L-2),X=0,ie=0;ie<W;++ie){var D=E-Ue+ie&32767,Q=p[D],Z=D-Q&32767;Z>X&&(X=Z,le=D)}}}K=le,le=p[K],Ue+=K-le&32767}if(te){w[B++]=268435456|Rk[Ae]<<18|OQ[te];var be=Rk[Ae]&31,U=OQ[te]&31;S+=q6[be]+z6[U],++j[257+be],++I[U],k=E+Ae,++C}else w[B++]=t[E],++j[t[E]]}}for(E=Math.max(E,k);E<o;++E)w[B++]=t[E],++j[t[E]];d=RQ(t,c,u,w,j,I,S,B,T,E-T,d),u||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=x,s.p=p,s.i=E,s.w=k)}else{for(var E=s.w||0;E<o+u;E+=65535){var ze=E+65535;ze>=o&&(c[d/8|0]=u,ze=o),d=rre(c,d+1,t.subarray(E,ze))}s.i=o}return LSe(l,0,n+tre(d)+a)},are=function(){var t=1,e=0;return{p:function(r){for(var n=t,a=e,s=r.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)a+=n+=r[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}t=n,e=a},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},VSe=function(t,e,r,n,a){if(!a&&(a={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new Cf(s.length+t.length);o.set(s),o.set(t,s.length),t=o,a.w=s.length}return QSe(t,e.level==null?6:e.level,e.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,a)},sre=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},HSe=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var a=are();a.p(e.dictionary),sre(t,2,a.d())}};function Uk(t,e){e||(e={});var r=are();r.p(t);var n=VSe(t,e,e.dictionary?6:2,4);return HSe(n,e),sre(n,n.length-4,r.d()),n}var $Se=typeof TextDecoder<"u"&&new TextDecoder,GSe=0;try{$Se.decode(nre,{stream:!0}),GSe=1}catch{}function KSe(t){if(Array.isArray(t))return t}function qSe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,s,o,l=[],c=!0,u=!1;try{if(s=(r=r.call(t)).next,e!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function MQ(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function zSe(t,e){if(t){if(typeof t=="string")return MQ(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?MQ(t,e):void 0}}function WSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LQ(t,e){return KSe(t)||qSe(t,e)||zSe(t,e)||WSe()}function UQ(t,e="utf8"){return new TextDecoder(e).decode(t)}const XSe=new TextEncoder;function YSe(t){return XSe.encode(t)}const JSe=1024*8,ZSe=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),e5={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class W6{constructor(e=JSe,r={}){Tr(this,"buffer");Tr(this,"byteLength");Tr(this,"byteOffset");Tr(this,"length");Tr(this,"offset");Tr(this,"lastWrittenByte");Tr(this,"littleEndian");Tr(this,"_data");Tr(this,"_mark");Tr(this,"_marks");let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const a=r.offset?r.offset>>>0:0,s=e.byteLength-a;let o=a;(ArrayBuffer.isView(e)||e instanceof W6)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+a),e=e.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=e5[r].BYTES_PER_ELEMENT*e,a=this.byteOffset+this.offset,s=this.buffer.slice(a,a+n);if(this.littleEndian===ZSe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+n));l.reverse();const c=new e5[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new e5[r](s);return this.offset+=n,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return UQ(this.readBytes(e))}decodeText(e=1,r="utf8"){return UQ(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(YSe(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function v1(t){let e=t.length;for(;--e>=0;)t[e]=0}const eIe=3,tIe=258,ire=29,rIe=256,nIe=rIe+1+ire,ore=30,aIe=512,sIe=new Array((nIe+2)*2);v1(sIe);const iIe=new Array(ore*2);v1(iIe);const oIe=new Array(aIe);v1(oIe);const lIe=new Array(tIe-eIe+1);v1(lIe);const cIe=new Array(ire);v1(cIe);const uIe=new Array(ore);v1(uIe);const dIe=(t,e,r,n)=>{let a=t&65535|0,s=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do a=a+e[n++]|0,s=s+a|0;while(--o);a%=65521,s%=65521}return a|s<<16|0};var Qk=dIe;const fIe=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},hIe=new Uint32Array(fIe()),AIe=(t,e,r,n)=>{const a=hIe,s=n+r;t^=-1;for(let o=n;o<s;o++)t=t>>>8^a[(t^e[o])&255];return t^-1};var Mf=AIe,Vk={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},lre={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const mIe=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var pIe=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)mIe(r,n)&&(t[n]=r[n])}}return t},gIe=t=>{let e=0;for(let n=0,a=t.length;n<a;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,a=0,s=t.length;n<s;n++){let o=t[n];r.set(o,a),a+=o.length}return r},cre={assign:pIe,flattenChunks:gIe};let ure=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ure=!1}const I2=new Uint8Array(256);for(let t=0;t<256;t++)I2[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;I2[254]=I2[254]=1;var xIe=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,a,s,o=t.length,l=0;for(a=0;a<o;a++)r=t.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=t.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),s=0,a=0;s<l;a++)r=t.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=t.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};const vIe=(t,e)=>{if(e<65534&&t.subarray&&ure)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var yIe=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,a;const s=new Array(r*2);for(a=0,n=0;n<r;){let o=t[n++];if(o<128){s[a++]=o;continue}let l=I2[o];if(l>4){s[a++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|t[n++]&63,l--;if(l>1){s[a++]=65533;continue}o<65536?s[a++]=o:(o-=65536,s[a++]=55296|o>>10&1023,s[a++]=56320|o&1023)}return vIe(s,a)},bIe=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+I2[t[r]]>e?r:e},Hk={string2buf:xIe,buf2string:yIe,utf8border:bIe};function wIe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var NIe=wIe;const TC=16209,CIe=16191;var _Ie=function(e,r){let n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,I,C,S,E,B;const k=e.state;n=e.next_in,E=e.input,a=n+(e.avail_in-5),s=e.next_out,B=e.output,o=s-(r-e.avail_out),l=s+(e.avail_out-257),c=k.dmax,u=k.wsize,d=k.whave,f=k.wnext,A=k.window,h=k.hold,m=k.bits,p=k.lencode,x=k.distcode,v=(1<<k.lenbits)-1,y=(1<<k.distbits)-1;e:do{m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=p[h&v];t:for(;;){if(w=b>>>24,h>>>=w,m-=w,w=b>>>16&255,w===0)B[s++]=b&65535;else if(w&16){j=b&65535,w&=15,w&&(m<w&&(h+=E[n++]<<m,m+=8),j+=h&(1<<w)-1,h>>>=w,m-=w),m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=x[h&y];r:for(;;){if(w=b>>>24,h>>>=w,m-=w,w=b>>>16&255,w&16){if(I=b&65535,w&=15,m<w&&(h+=E[n++]<<m,m+=8,m<w&&(h+=E[n++]<<m,m+=8)),I+=h&(1<<w)-1,I>c){e.msg="invalid distance too far back",k.mode=TC;break e}if(h>>>=w,m-=w,w=s-o,I>w){if(w=I-w,w>d&&k.sane){e.msg="invalid distance too far back",k.mode=TC;break e}if(C=0,S=A,f===0){if(C+=u-w,w<j){j-=w;do B[s++]=A[C++];while(--w);C=s-I,S=B}}else if(f<w){if(C+=u+f-w,w-=f,w<j){j-=w;do B[s++]=A[C++];while(--w);if(C=0,f<j){w=f,j-=w;do B[s++]=A[C++];while(--w);C=s-I,S=B}}}else if(C+=f-w,w<j){j-=w;do B[s++]=A[C++];while(--w);C=s-I,S=B}for(;j>2;)B[s++]=S[C++],B[s++]=S[C++],B[s++]=S[C++],j-=3;j&&(B[s++]=S[C++],j>1&&(B[s++]=S[C++]))}else{C=s-I;do B[s++]=B[C++],B[s++]=B[C++],B[s++]=B[C++],j-=3;while(j>2);j&&(B[s++]=B[C++],j>1&&(B[s++]=B[C++]))}}else if(w&64){e.msg="invalid distance code",k.mode=TC;break e}else{b=x[(b&65535)+(h&(1<<w)-1)];continue r}break}}else if(w&64)if(w&32){k.mode=CIe;break e}else{e.msg="invalid literal/length code",k.mode=TC;break e}else{b=p[(b&65535)+(h&(1<<w)-1)];continue t}break}}while(n<a&&s<l);j=m>>3,n-=j,m-=j<<3,h&=(1<<m)-1,e.next_in=n,e.next_out=s,e.avail_in=n<a?5+(a-n):5-(n-a),e.avail_out=s<l?257+(l-s):257-(s-l),k.hold=h,k.bits=m};const fx=15,QQ=852,VQ=592,HQ=0,t5=1,$Q=2,EIe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),SIe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),IIe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),jIe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),PIe=(t,e,r,n,a,s,o,l)=>{const c=l.bits;let u=0,d=0,f=0,A=0,h=0,m=0,p=0,x=0,v=0,y=0,b,w,j,I,C,S=null,E;const B=new Uint16Array(fx+1),k=new Uint16Array(fx+1);let T=null,P,K,le;for(u=0;u<=fx;u++)B[u]=0;for(d=0;d<n;d++)B[e[r+d]]++;for(h=c,A=fx;A>=1&&B[A]===0;A--);if(h>A&&(h=A),A===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<A&&B[f]===0;f++);for(h<f&&(h=f),x=1,u=1;u<=fx;u++)if(x<<=1,x-=B[u],x<0)return-1;if(x>0&&(t===HQ||A!==1))return-1;for(k[1]=0,u=1;u<fx;u++)k[u+1]=k[u]+B[u];for(d=0;d<n;d++)e[r+d]!==0&&(o[k[e[r+d]]++]=d);if(t===HQ?(S=T=o,E=20):t===t5?(S=EIe,T=SIe,E=257):(S=IIe,T=jIe,E=0),y=0,d=0,u=f,C=s,m=h,p=0,j=-1,v=1<<h,I=v-1,t===t5&&v>QQ||t===$Q&&v>VQ)return 1;for(;;){P=u-p,o[d]+1<E?(K=0,le=o[d]):o[d]>=E?(K=T[o[d]-E],le=S[o[d]-E]):(K=96,le=0),b=1<<u-p,w=1<<m,f=w;do w-=b,a[C+(y>>p)+w]=P<<24|K<<16|le|0;while(w!==0);for(b=1<<u-1;y&b;)b>>=1;if(b!==0?(y&=b-1,y+=b):y=0,d++,--B[u]===0){if(u===A)break;u=e[r+o[d]]}if(u>h&&(y&I)!==j){for(p===0&&(p=h),C+=f,m=u-p,x=1<<m;m+p<A&&(x-=B[m+p],!(x<=0));)m++,x<<=1;if(v+=1<<m,t===t5&&v>QQ||t===$Q&&v>VQ)return 1;j=y&I,a[j]=h<<24|m<<16|C-s|0}}return y!==0&&(a[C+y]=u-p<<24|64<<16|0),l.bits=h,0};var Sb=PIe;const TIe=0,dre=1,fre=2,{Z_FINISH:GQ,Z_BLOCK:BIe,Z_TREES:BC,Z_OK:mg,Z_STREAM_END:kIe,Z_NEED_DICT:FIe,Z_STREAM_ERROR:Od,Z_DATA_ERROR:hre,Z_MEM_ERROR:Are,Z_BUF_ERROR:OIe,Z_DEFLATED:KQ}=lre,sP=16180,qQ=16181,zQ=16182,WQ=16183,XQ=16184,YQ=16185,JQ=16186,ZQ=16187,eV=16188,tV=16189,FS=16190,jh=16191,r5=16192,rV=16193,n5=16194,nV=16195,aV=16196,sV=16197,iV=16198,kC=16199,FC=16200,oV=16201,lV=16202,cV=16203,uV=16204,dV=16205,a5=16206,fV=16207,hV=16208,Ls=16209,mre=16210,pre=16211,DIe=852,RIe=592,MIe=15,LIe=MIe,AV=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function UIe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Mg=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<sP||e.mode>pre?1:0},gre=t=>{if(Mg(t))return Od;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=sP,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(DIe),e.distcode=e.distdyn=new Int32Array(RIe),e.sane=1,e.back=-1,mg},xre=t=>{if(Mg(t))return Od;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,gre(t)},vre=(t,e)=>{let r;if(Mg(t))return Od;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Od:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,xre(t))},yre=(t,e)=>{if(!t)return Od;const r=new UIe;t.state=r,r.strm=t,r.window=null,r.mode=sP;const n=vre(t,e);return n!==mg&&(t.state=null),n},QIe=t=>yre(t,LIe);let mV=!0,s5,i5;const VIe=t=>{if(mV){s5=new Int32Array(512),i5=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Sb(dre,t.lens,0,288,s5,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Sb(fre,t.lens,0,32,i5,0,t.work,{bits:5}),mV=!1}t.lencode=s5,t.lenbits=9,t.distcode=i5,t.distbits=5},bre=(t,e,r,n)=>{let a;const s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(a=s.wsize-s.wnext,a>n&&(a=n),s.window.set(e.subarray(r-n,r-n+a),s.wnext),n-=a,n?(s.window.set(e.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0},HIe=(t,e)=>{let r,n,a,s,o,l,c,u,d,f,A,h,m,p,x=0,v,y,b,w,j,I,C,S;const E=new Uint8Array(4);let B,k;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Mg(t)||!t.output||!t.input&&t.avail_in!==0)return Od;r=t.state,r.mode===jh&&(r.mode=r5),o=t.next_out,a=t.output,c=t.avail_out,s=t.next_in,n=t.input,l=t.avail_in,u=r.hold,d=r.bits,f=l,A=c,S=mg;e:for(;;)switch(r.mode){case sP:if(r.wrap===0){r.mode=r5;break}for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,E[0]=u&255,E[1]=u>>>8&255,r.check=Mf(r.check,E,2,0),u=0,d=0,r.mode=qQ;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=Ls;break}if((u&15)!==KQ){t.msg="unknown compression method",r.mode=Ls;break}if(u>>>=4,d-=4,C=(u&15)+8,r.wbits===0&&(r.wbits=C),C>15||C>r.wbits){t.msg="invalid window size",r.mode=Ls;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=u&512?tV:jh,u=0,d=0;break;case qQ:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==KQ){t.msg="unknown compression method",r.mode=Ls;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=Ls;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Mf(r.check,E,2,0)),u=0,d=0,r.mode=zQ;case zQ:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,E[2]=u>>>16&255,E[3]=u>>>24&255,r.check=Mf(r.check,E,4,0)),u=0,d=0,r.mode=WQ;case WQ:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Mf(r.check,E,2,0)),u=0,d=0,r.mode=XQ;case XQ:if(r.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Mf(r.check,E,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=YQ;case YQ:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(C=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+h),C)),r.flags&512&&r.wrap&4&&(r.check=Mf(r.check,n,h,s)),l-=h,s+=h,r.length-=h),r.length))break e;r.length=0,r.mode=JQ;case JQ:if(r.flags&2048){if(l===0)break e;h=0;do C=n[s+h++],r.head&&C&&r.length<65536&&(r.head.name+=String.fromCharCode(C));while(C&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Mf(r.check,n,h,s)),l-=h,s+=h,C)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=ZQ;case ZQ:if(r.flags&4096){if(l===0)break e;h=0;do C=n[s+h++],r.head&&C&&r.length<65536&&(r.head.comment+=String.fromCharCode(C));while(C&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Mf(r.check,n,h,s)),l-=h,s+=h,C)break e}else r.head&&(r.head.comment=null);r.mode=eV;case eV:if(r.flags&512){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=Ls;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=jh;break;case tV:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}t.adler=r.check=AV(u),u=0,d=0,r.mode=FS;case FS:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,FIe;t.adler=r.check=1,r.mode=jh;case jh:if(e===BIe||e===BC)break e;case r5:if(r.last){u>>>=d&7,d-=d&7,r.mode=a5;break}for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=rV;break;case 1:if(VIe(r),r.mode=kC,e===BC){u>>>=2,d-=2;break e}break;case 2:r.mode=aV;break;case 3:t.msg="invalid block type",r.mode=Ls}u>>>=2,d-=2;break;case rV:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Ls;break}if(r.length=u&65535,u=0,d=0,r.mode=n5,e===BC)break e;case n5:r.mode=nV;case nV:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;a.set(n.subarray(s,s+h),o),l-=h,s+=h,c-=h,o+=h,r.length-=h;break}r.mode=jh;break;case aV:for(;d<14;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Ls;break}r.have=0,r.mode=sV;case sV:for(;r.have<r.ncode;){for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.lens[T[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,B={bits:r.lenbits},S=Sb(TIe,r.lens,0,19,r.lencode,0,r.work,B),r.lenbits=B.bits,S){t.msg="invalid code lengths set",r.mode=Ls;break}r.have=0,r.mode=iV;case iV:for(;r.have<r.nlen+r.ndist;){for(;x=r.lencode[u&(1<<r.lenbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(b<16)u>>>=v,d-=v,r.lens[r.have++]=b;else{if(b===16){for(k=v+2;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(u>>>=v,d-=v,r.have===0){t.msg="invalid bit length repeat",r.mode=Ls;break}C=r.lens[r.have-1],h=3+(u&3),u>>>=2,d-=2}else if(b===17){for(k=v+3;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=v,d-=v,C=0,h=3+(u&7),u>>>=3,d-=3}else{for(k=v+7;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=v,d-=v,C=0,h=11+(u&127),u>>>=7,d-=7}if(r.have+h>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Ls;break}for(;h--;)r.lens[r.have++]=C}}if(r.mode===Ls)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=Ls;break}if(r.lenbits=9,B={bits:r.lenbits},S=Sb(dre,r.lens,0,r.nlen,r.lencode,0,r.work,B),r.lenbits=B.bits,S){t.msg="invalid literal/lengths set",r.mode=Ls;break}if(r.distbits=6,r.distcode=r.distdyn,B={bits:r.distbits},S=Sb(fre,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,B),r.distbits=B.bits,S){t.msg="invalid distances set",r.mode=Ls;break}if(r.mode=kC,e===BC)break e;case kC:r.mode=FC;case FC:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,_Ie(t,A),o=t.next_out,a=t.output,c=t.avail_out,s=t.next_in,n=t.input,l=t.avail_in,u=r.hold,d=r.bits,r.mode===jh&&(r.back=-1);break}for(r.back=0;x=r.lencode[u&(1<<r.lenbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(y&&!(y&240)){for(w=v,j=y,I=b;x=r.lencode[I+((u&(1<<w+j)-1)>>w)],v=x>>>24,y=x>>>16&255,b=x&65535,!(w+v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=w,d-=w,r.back+=w}if(u>>>=v,d-=v,r.back+=v,r.length=b,y===0){r.mode=dV;break}if(y&32){r.back=-1,r.mode=jh;break}if(y&64){t.msg="invalid literal/length code",r.mode=Ls;break}r.extra=y&15,r.mode=oV;case oV:if(r.extra){for(k=r.extra;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=lV;case lV:for(;x=r.distcode[u&(1<<r.distbits)-1],v=x>>>24,y=x>>>16&255,b=x&65535,!(v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(!(y&240)){for(w=v,j=y,I=b;x=r.distcode[I+((u&(1<<w+j)-1)>>w)],v=x>>>24,y=x>>>16&255,b=x&65535,!(w+v<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=w,d-=w,r.back+=w}if(u>>>=v,d-=v,r.back+=v,y&64){t.msg="invalid distance code",r.mode=Ls;break}r.offset=b,r.extra=y&15,r.mode=cV;case cV:if(r.extra){for(k=r.extra;d<k;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Ls;break}r.mode=uV;case uV:if(c===0)break e;if(h=A-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Ls;break}h>r.wnext?(h-=r.wnext,m=r.wsize-h):m=r.wnext-h,h>r.length&&(h=r.length),p=r.window}else p=a,m=o-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do a[o++]=p[m++];while(--h);r.length===0&&(r.mode=FC);break;case dV:if(c===0)break e;a[o++]=r.length,c--,r.mode=FC;break;case a5:if(r.wrap){for(;d<32;){if(l===0)break e;l--,u|=n[s++]<<d,d+=8}if(A-=c,t.total_out+=A,r.total+=A,r.wrap&4&&A&&(t.adler=r.check=r.flags?Mf(r.check,a,A,o-A):Qk(r.check,a,A,o-A)),A=c,r.wrap&4&&(r.flags?u:AV(u))!==r.check){t.msg="incorrect data check",r.mode=Ls;break}u=0,d=0}r.mode=fV;case fV:if(r.wrap&&r.flags){for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=Ls;break}u=0,d=0}r.mode=hV;case hV:S=kIe;break e;case Ls:S=hre;break e;case mre:return Are;case pre:default:return Od}return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=l,r.hold=u,r.bits=d,(r.wsize||A!==t.avail_out&&r.mode<Ls&&(r.mode<a5||e!==GQ))&&bre(t,t.output,t.next_out,A-t.avail_out),f-=t.avail_in,A-=t.avail_out,t.total_in+=f,t.total_out+=A,r.total+=A,r.wrap&4&&A&&(t.adler=r.check=r.flags?Mf(r.check,a,A,t.next_out-A):Qk(r.check,a,A,t.next_out-A)),t.data_type=r.bits+(r.last?64:0)+(r.mode===jh?128:0)+(r.mode===kC||r.mode===n5?256:0),(f===0&&A===0||e===GQ)&&S===mg&&(S=OIe),S},$Ie=t=>{if(Mg(t))return Od;let e=t.state;return e.window&&(e.window=null),t.state=null,mg},GIe=(t,e)=>{if(Mg(t))return Od;const r=t.state;return r.wrap&2?(r.head=e,e.done=!1,mg):Od},KIe=(t,e)=>{const r=e.length;let n,a,s;return Mg(t)||(n=t.state,n.wrap!==0&&n.mode!==FS)?Od:n.mode===FS&&(a=1,a=Qk(a,e,r,0),a!==n.check)?hre:(s=bre(t,e,r,r),s?(n.mode=mre,Are):(n.havedict=1,mg))};var qIe=xre,zIe=vre,WIe=gre,XIe=QIe,YIe=yre,JIe=HIe,ZIe=$Ie,eje=GIe,tje=KIe,rje="pako inflate (from Nodeca project)",Qh={inflateReset:qIe,inflateReset2:zIe,inflateResetKeep:WIe,inflateInit:XIe,inflateInit2:YIe,inflate:JIe,inflateEnd:ZIe,inflateGetHeader:eje,inflateSetDictionary:tje,inflateInfo:rje};function nje(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var aje=nje;const wre=Object.prototype.toString,{Z_NO_FLUSH:sje,Z_FINISH:ije,Z_OK:j2,Z_STREAM_END:o5,Z_NEED_DICT:l5,Z_STREAM_ERROR:oje,Z_DATA_ERROR:pV,Z_MEM_ERROR:lje}=lre;function Mw(t){this.options=cre.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new NIe,this.strm.avail_out=0;let r=Qh.inflateInit2(this.strm,e.windowBits);if(r!==j2)throw new Error(Vk[r]);if(this.header=new aje,Qh.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Hk.string2buf(e.dictionary):wre.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Qh.inflateSetDictionary(this.strm,e.dictionary),r!==j2)))throw new Error(Vk[r])}Mw.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?ije:sje,wre.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=Qh.inflate(r,o),s===l5&&a&&(s=Qh.inflateSetDictionary(r,a),s===j2?s=Qh.inflate(r,o):s===pV&&(s=l5));r.avail_in>0&&s===o5&&r.state.wrap>0&&t[r.next_in]!==0;)Qh.inflateReset(r),s=Qh.inflate(r,o);switch(s){case oje:case pV:case l5:case lje:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||s===o5))if(this.options.to==="string"){let c=Hk.utf8border(r.output,r.next_out),u=r.next_out-c,d=Hk.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===j2&&l===0)){if(s===o5)return s=Qh.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Mw.prototype.onData=function(t){this.chunks.push(t)};Mw.prototype.onEnd=function(t){t===j2&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=cre.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function cje(t,e){const r=new Mw(e);if(r.push(t),r.err)throw r.msg||Vk[r.err];return r.result}var uje=Mw,dje=cje,fje={Inflate:uje,inflate:dje};const{Inflate:hje,inflate:Aje}=fje;var gV=hje,mje=Aje;const Nre=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;Nre[t]=e}const xV=4294967295;function pje(t,e,r){let n=t;for(let a=0;a<r;a++)n=Nre[(n^e[a])&255]^n>>>8;return n}function gje(t,e){return(pje(xV,t,e)^xV)>>>0}function vV(t,e,r){const n=t.readUint32(),a=gje(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function Cre(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function _re(t,e,r,n){let a=0;for(;a<n;a++)e[a]=t[a];for(;a<r;a++)e[a]=t[a]+e[a-n]&255}function Ere(t,e,r,n){let a=0;if(r.length===0)for(;a<n;a++)e[a]=t[a];else for(;a<n;a++)e[a]=t[a]+r[a]&255}function Sre(t,e,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+(e[s-a]>>1)&255}else{for(;s<a;s++)e[s]=t[s]+(r[s]>>1)&255;for(;s<n;s++)e[s]=t[s]+(e[s-a]+r[s]>>1)&255}}function Ire(t,e,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+e[s-a]&255}else{for(;s<a;s++)e[s]=t[s]+r[s]&255;for(;s<n;s++)e[s]=t[s]+xje(e[s-a],r[s],r[s-a])&255}}function xje(t,e,r){const n=t+e-r,a=Math.abs(n-t),s=Math.abs(n-e),o=Math.abs(n-r);return a<=s&&a<=o?t:s<=o?e:r}function vje(t,e,r,n,a,s){switch(t){case 0:Cre(e,r,a);break;case 1:_re(e,r,a,s);break;case 2:Ere(e,r,n,a);break;case 3:Sre(e,r,n,a,s);break;case 4:Ire(e,r,n,a,s);break;default:throw new Error(`Unsupported filter: ${t}`)}}const yje=new Uint16Array([255]),bje=new Uint8Array(yje.buffer),wje=bje[0]===255;function Nje(t){const{data:e,width:r,height:n,channels:a,depth:s}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*a,c=new Uint8Array(n*r*l);let u=0;for(let d=0;d<7;d++){const f=o[d],A=Math.ceil((r-f.x)/f.xStep),h=Math.ceil((n-f.y)/f.yStep);if(A<=0||h<=0)continue;const m=A*l,p=new Uint8Array(m);for(let x=0;x<h;x++){const v=e[u++],y=e.subarray(u,u+m);u+=m;const b=new Uint8Array(m);vje(v,y,b,p,m,l),p.set(b);for(let w=0;w<A;w++){const j=f.x+w*f.xStep,I=f.y+x*f.yStep;if(!(j>=r||I>=n))for(let C=0;C<l;C++)c[(I*r+j)*l+C]=b[w*l+C]}}}if(s===16){const d=new Uint16Array(c.buffer);if(wje)for(let f=0;f<d.length;f++)d[f]=Cje(d[f]);return d}else return c}function Cje(t){return(t&255)<<8|t>>8&255}const _je=new Uint16Array([255]),Eje=new Uint8Array(_je.buffer),Sje=Eje[0]===255,Ije=new Uint8Array(0);function yV(t){const{data:e,width:r,height:n,channels:a,depth:s}=t,o=Math.ceil(s/8)*a,l=Math.ceil(s/8*a*r),c=new Uint8Array(n*l);let u=Ije,d=0,f,A;for(let h=0;h<n;h++){switch(f=e.subarray(d+1,d+1+l),A=c.subarray(h*l,(h+1)*l),e[d]){case 0:Cre(f,A,l);break;case 1:_re(f,A,l,o);break;case 2:Ere(f,A,u,l);break;case 3:Sre(f,A,u,l,o);break;case 4:Ire(f,A,u,l,o);break;default:throw new Error(`Unsupported filter: ${e[d]}`)}u=A,d+=l+1}if(s===16){const h=new Uint16Array(c.buffer);if(Sje)for(let m=0;m<h.length;m++)h[m]=jje(h[m]);return h}else return c}function jje(t){return(t&255)<<8|t>>8&255}const pE=Uint8Array.of(137,80,78,71,13,10,26,10);function bV(t){if(!Pje(t.readBytes(pE.length)))throw new Error("wrong PNG signature")}function Pje(t){if(t.length<pE.length)return!1;for(let e=0;e<pE.length;e++)if(t[e]!==pE[e])return!1;return!0}const Tje="tEXt",Bje=0,jre=new TextDecoder("latin1");function kje(t){if(Oje(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const Fje=/^[\u0000-\u00FF]*$/;function Oje(t){if(!Fje.test(t))throw new Error("invalid latin1 text")}function Dje(t,e,r){const n=Pre(e);t[n]=Rje(e,r-n.length-1)}function Pre(t){for(t.mark();t.readByte()!==Bje;);const e=t.offset;t.reset();const r=jre.decode(t.readBytes(e-t.offset-1));return t.skip(1),kje(r),r}function Rje(t,e){return jre.decode(t.readBytes(e))}const Cu={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},c5={UNKNOWN:-1,DEFLATE:0},wV={UNKNOWN:-1,ADAPTIVE:0},u5={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},OC={NONE:0,BACKGROUND:1,PREVIOUS:2},d5={SOURCE:0,OVER:1};class Mje extends W6{constructor(r,n={}){super(r);Tr(this,"_checkCrc");Tr(this,"_inflator");Tr(this,"_png");Tr(this,"_apng");Tr(this,"_end");Tr(this,"_hasPalette");Tr(this,"_palette");Tr(this,"_hasTransparency");Tr(this,"_transparency");Tr(this,"_compressionMethod");Tr(this,"_filterMethod");Tr(this,"_interlaceMethod");Tr(this,"_colorType");Tr(this,"_isAnimated");Tr(this,"_numberOfFrames");Tr(this,"_numberOfPlays");Tr(this,"_frames");Tr(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new gV,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=c5.UNKNOWN,this._filterMethod=wV.UNKNOWN,this._interlaceMethod=u5.UNKNOWN,this._colorType=Cu.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(bV(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(bV(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case Tje:Dje(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?vV(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?vV(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=Lje(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case Cu.GREYSCALE:a=1;break;case Cu.TRUECOLOUR:a=3;break;case Cu.INDEXED_COLOUR:a=1;break;case Cu.GREYSCALE_ALPHA:a=2;break;case Cu.TRUECOLOUR_ALPHA:a=4;break;case Cu.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==c5.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let s=0;s<n;s++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Cu.GREYSCALE:case Cu.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Cu.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Cu.UNKNOWN:case Cu.GREYSCALE_ALPHA:case Cu.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=Pre(this),a=this.readUint8();if(a!==c5.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:mje(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=yV({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(a,s,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case OC.NONE:break;case OC.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case OC.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,s=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,u=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case d5.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++)r.data[c+d]=n.data[u+d]}break;case d5.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++){const f=n.data[u+this._png.channels-1]/a,A=d%(this._png.channels-1)===0?1:n.data[u+d],h=Math.floor(f*A+(1-f)*r.data[c+d]);r.data[c+d]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==wV.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===u5.NO_INTERLACE)this._png.data=yV({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===u5.ADAM7)this._png.data=Nje({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:OC.NONE,blendOp:d5.SOURCE,data:r}),this._inflator=new gV,this._writingDataChunks=!1}}function Lje(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var NV;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(NV||(NV={}));function Uje(t,e){return new Mje(t,e).decode()}var Ln=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function f5(){Ln.console&&typeof Ln.console.log=="function"&&Ln.console.log.apply(Ln.console,arguments)}var hs={log:f5,warn:function(t){Ln.console&&(typeof Ln.console.warn=="function"?Ln.console.warn.apply(Ln.console,arguments):f5.call(null,arguments))},error:function(t){Ln.console&&(typeof Ln.console.error=="function"?Ln.console.error.apply(Ln.console,arguments):f5(t))}};function h5(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){hp(n.response,e,r)},n.onerror=function(){hs.error("could not download file")},n.send()}function CV(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function DC(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var hp=Ln.saveAs||((typeof window>"u"?"undefined":es(window))!=="object"||window!==Ln?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=Ln.URL||Ln.webkitURL,a=document.createElement("a");e=e||t.name||"download",a.download=e,a.rel="noopener",typeof t=="string"?(a.href=t,a.origin!==location.origin?CV(a.href)?h5(t,e,r):DC(a,a.target="_blank"):DC(a)):(a.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){DC(a)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(CV(t))h5(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){DC(n)})}else navigator.msSaveOrOpenBlob(function(a,s){return s===void 0?s={autoBom:!1}:es(s)!=="object"&&(hs.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return h5(t,e,r);var a=t.type==="application/octet-stream",s=/constructor/i.test(Ln.HTMLElement)||Ln.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&s)&&(typeof FileReader>"u"?"undefined":es(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(t)}else{var c=Ln.URL||Ln.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Tre(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,s=r[n].process,o=a.exec(t);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var gE=Ln.atob.bind(Ln),_V=Ln.btoa.bind(Ln);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function A5(t,e){var r=t[0],n=t[1],a=t[2],s=t[3];r=Vl(r,n,a,s,e[0],7,-680876936),s=Vl(s,r,n,a,e[1],12,-389564586),a=Vl(a,s,r,n,e[2],17,606105819),n=Vl(n,a,s,r,e[3],22,-1044525330),r=Vl(r,n,a,s,e[4],7,-176418897),s=Vl(s,r,n,a,e[5],12,1200080426),a=Vl(a,s,r,n,e[6],17,-1473231341),n=Vl(n,a,s,r,e[7],22,-45705983),r=Vl(r,n,a,s,e[8],7,1770035416),s=Vl(s,r,n,a,e[9],12,-1958414417),a=Vl(a,s,r,n,e[10],17,-42063),n=Vl(n,a,s,r,e[11],22,-1990404162),r=Vl(r,n,a,s,e[12],7,1804603682),s=Vl(s,r,n,a,e[13],12,-40341101),a=Vl(a,s,r,n,e[14],17,-1502002290),r=Hl(r,n=Vl(n,a,s,r,e[15],22,1236535329),a,s,e[1],5,-165796510),s=Hl(s,r,n,a,e[6],9,-1069501632),a=Hl(a,s,r,n,e[11],14,643717713),n=Hl(n,a,s,r,e[0],20,-373897302),r=Hl(r,n,a,s,e[5],5,-701558691),s=Hl(s,r,n,a,e[10],9,38016083),a=Hl(a,s,r,n,e[15],14,-660478335),n=Hl(n,a,s,r,e[4],20,-405537848),r=Hl(r,n,a,s,e[9],5,568446438),s=Hl(s,r,n,a,e[14],9,-1019803690),a=Hl(a,s,r,n,e[3],14,-187363961),n=Hl(n,a,s,r,e[8],20,1163531501),r=Hl(r,n,a,s,e[13],5,-1444681467),s=Hl(s,r,n,a,e[2],9,-51403784),a=Hl(a,s,r,n,e[7],14,1735328473),r=$l(r,n=Hl(n,a,s,r,e[12],20,-1926607734),a,s,e[5],4,-378558),s=$l(s,r,n,a,e[8],11,-2022574463),a=$l(a,s,r,n,e[11],16,1839030562),n=$l(n,a,s,r,e[14],23,-35309556),r=$l(r,n,a,s,e[1],4,-1530992060),s=$l(s,r,n,a,e[4],11,1272893353),a=$l(a,s,r,n,e[7],16,-155497632),n=$l(n,a,s,r,e[10],23,-1094730640),r=$l(r,n,a,s,e[13],4,681279174),s=$l(s,r,n,a,e[0],11,-358537222),a=$l(a,s,r,n,e[3],16,-722521979),n=$l(n,a,s,r,e[6],23,76029189),r=$l(r,n,a,s,e[9],4,-640364487),s=$l(s,r,n,a,e[12],11,-421815835),a=$l(a,s,r,n,e[15],16,530742520),r=Gl(r,n=$l(n,a,s,r,e[2],23,-995338651),a,s,e[0],6,-198630844),s=Gl(s,r,n,a,e[7],10,1126891415),a=Gl(a,s,r,n,e[14],15,-1416354905),n=Gl(n,a,s,r,e[5],21,-57434055),r=Gl(r,n,a,s,e[12],6,1700485571),s=Gl(s,r,n,a,e[3],10,-1894986606),a=Gl(a,s,r,n,e[10],15,-1051523),n=Gl(n,a,s,r,e[1],21,-2054922799),r=Gl(r,n,a,s,e[8],6,1873313359),s=Gl(s,r,n,a,e[15],10,-30611744),a=Gl(a,s,r,n,e[6],15,-1560198380),n=Gl(n,a,s,r,e[13],21,1309151649),r=Gl(r,n,a,s,e[4],6,-145523070),s=Gl(s,r,n,a,e[11],10,-1120210379),a=Gl(a,s,r,n,e[2],15,718787259),n=Gl(n,a,s,r,e[9],21,-343485551),t[0]=X0(r,t[0]),t[1]=X0(n,t[1]),t[2]=X0(a,t[2]),t[3]=X0(s,t[3])}function iP(t,e,r,n,a,s){return e=X0(X0(e,t),X0(n,s)),X0(e<<a|e>>>32-a,r)}function Vl(t,e,r,n,a,s,o){return iP(e&r|~e&n,t,e,a,s,o)}function Hl(t,e,r,n,a,s,o){return iP(e&n|r&~n,t,e,a,s,o)}function $l(t,e,r,n,a,s,o){return iP(e^r^n,t,e,a,s,o)}function Gl(t,e,r,n,a,s,o){return iP(r^(e|~n),t,e,a,s,o)}function Bre(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)A5(n,Qje(t.substring(e-64,e)));t=t.substring(e-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)a[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(A5(n,a),e=0;e<16;e++)a[e]=0;return a[14]=8*r,A5(n,a),n}function Qje(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var EV="0123456789abcdef".split("");function Vje(t){for(var e="",r=0;r<4;r++)e+=EV[t>>8*r+4&15]+EV[t>>8*r&15];return e}function Hje(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function $k(t){return Bre(t).map(Hje).join("")}var $je=function(t){for(var e=0;e<t.length;e++)t[e]=Vje(t[e]);return t.join("")}(Bre("hello"))!="5d41402abc4b2a76b9719d911017c592";function X0(t,e){if($je){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Gk(t,e){var r,n,a,s;if(t!==r){for(var o=(a=t,s=1+(256/t.length|0),new Array(s+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=t,n=l}else l=n;var f=e.length,A=0,h=0,m="";for(c=0;c<f;c++)h=(h+(d=l[A=(A+1)%256]))%256,l[A]=l[h],l[h]=d,o=l[(l[A]+l[h])%256],m+=String.fromCharCode(e.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var SV={print:4,modify:8,copy:16,"annot-forms":32};function kx(t,e,r,n){this.v=1,this.r=2;var a=192;t.forEach(function(l){if(SV.perm!==void 0)throw new Error("Invalid permission: "+l);a+=SV[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^a)),this.encryptionKey=$k(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Gk(this.encryptionKey,this.padding)}function Fx(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var a=t.charCodeAt(n);e+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):t[n]}return e}function IV(t){if(es(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var s=Math.random().toString(35);return e[r][s]=[n,!!a],s},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var s in e[r]){var o=e[r][s];try{o[0].apply(t,n)}catch(l){Ln.console&&hs.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function P2(t){if(!(this instanceof P2))return new P2(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function kre(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Q0(t,e,r,n,a){if(!(this instanceof Q0))return new Q0(t,e,r,n,a);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,kre.call(this,n,a)}function jp(t,e,r,n,a){if(!(this instanceof jp))return new jp(t,e,r,n,a);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,kre.call(this,n,a)}function an(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",d=null;es(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,a=t.format||a,s=t.compress||t.compressPdf||s,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),o=t.filters||(s===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=t.putOnlyUsedFonts||!1,A={},h={internal:{},__private__:{}};h.__private__.PubSub=IV;var m="1.3",p=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(M){m=M};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return x};var v=h.__private__.getPageFormat=function(M){return x[M]};a=a||"a4";var y="compat",b="advanced",w=y;function j(){this.saveGraphicsState(),J(new Le(dt,0,0,-dt,0,ho()*dt).toString()+" cm"),this.setFontSize(this.getFontSize()/dt),u="n",w=b}function I(){this.restoreGraphicsState(),u="S",w=y}var C=h.__private__.combineFontStyleAndFontWeight=function(M,Fe){if(M=="bold"&&Fe=="normal"||M=="bold"&&Fe==400||M=="normal"&&Fe=="italic"||M=="bold"&&Fe=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Fe&&(M=Fe==400||Fe==="normal"?M==="italic"?"italic":"normal":Fe!=700&&Fe!=="bold"||M!=="normal"?(Fe==700?"bold":Fe)+""+M:"bold"),M};h.advancedAPI=function(M){var Fe=w===y;return Fe&&j.call(this),typeof M!="function"||(M(this),Fe&&I.call(this)),this},h.compatAPI=function(M){var Fe=w===b;return Fe&&I.call(this),typeof M!="function"||(M(this),Fe&&j.call(this)),this},h.isAdvancedAPI=function(){return w===b};var S,E=function(M){if(w!==b)throw new Error(M+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=h.roundToPrecision=h.__private__.roundToPrecision=function(M,Fe){var At=e||Fe;if(isNaN(M)||isNaN(At))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return M.toFixed(At).replace(/0+$/,"")};S=h.hpf=h.__private__.hpf=typeof c=="number"?function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return B(M,c)}:c==="smart"?function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return B(M,M>-1&&M<1?16:5)}:function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return B(M,16)};var k=h.f2=h.__private__.f2=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.f2");return B(M,2)},T=h.__private__.f3=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.f3");return B(M,3)},P=h.scale=h.__private__.scale=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.scale");return w===y?M*dt:w===b?M:void 0},K=function(M){return P(function(Fe){return w===y?ho()-Fe:w===b?Fe:void 0}(M))};h.__private__.setPrecision=h.setPrecision=function(M){typeof parseInt(M,10)=="number"&&(e=parseInt(M,10))};var le,oe="00000000000000000000000000000000",ie=h.__private__.getFileId=function(){return oe},Ae=h.__private__.setFileId=function(M){return oe=M!==void 0&&/^[a-fA-F0-9]{32}$/.test(M)?M.toUpperCase():oe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Xr=new kx(d.userPermissions,d.userPassword,d.ownerPassword,oe)),oe};h.setFileId=function(M){return Ae(M),this},h.getFileId=function(){return ie()};var te=h.__private__.convertDateToPDFDate=function(M){var Fe=M.getTimezoneOffset(),At=Fe<0?"+":"-",_t=Math.floor(Math.abs(Fe/60)),Vt=Math.abs(Fe%60),hr=[At,G(_t),"'",G(Vt),"'"].join("");return["D:",M.getFullYear(),G(M.getMonth()+1),G(M.getDate()),G(M.getHours()),G(M.getMinutes()),G(M.getSeconds()),hr].join("")},Te=h.__private__.convertPDFDateToDate=function(M){var Fe=parseInt(M.substr(2,4),10),At=parseInt(M.substr(6,2),10)-1,_t=parseInt(M.substr(8,2),10),Vt=parseInt(M.substr(10,2),10),hr=parseInt(M.substr(12,2),10),yr=parseInt(M.substr(14,2),10);return new Date(Fe,At,_t,Vt,hr,yr,0)},Ue=h.__private__.setCreationDate=function(M){var Fe;if(M===void 0&&(M=new Date),M instanceof Date)Fe=te(M);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(M))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Fe=M}return le=Fe},O=h.__private__.getCreationDate=function(M){var Fe=le;return M==="jsDate"&&(Fe=Te(le)),Fe};h.setCreationDate=function(M){return Ue(M),this},h.getCreationDate=function(M){return O(M)};var H,G=h.__private__.padd2=function(M){return("0"+parseInt(M)).slice(-2)},L=h.__private__.padd2Hex=function(M){return("00"+(M=M.toString())).substr(M.length)},W=0,X=[],D=[],Q=0,Z=[],be=[],U=!1,ze=D;h.__private__.setCustomOutputDestination=function(M){U=!0,ze=M};var re=function(M){U||(ze=M)};h.__private__.resetCustomOutputDestination=function(){U=!1,ze=D};var J=h.__private__.out=function(M){return M=M.toString(),Q+=M.length+1,ze.push(M),ze},Re=h.__private__.write=function(M){return J(arguments.length===1?M.toString():Array.prototype.join.call(arguments," "))},ke=h.__private__.getArrayBuffer=function(M){for(var Fe=M.length,At=new ArrayBuffer(Fe),_t=new Uint8Array(At);Fe--;)_t[Fe]=M.charCodeAt(Fe);return At},Be=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return Be};var Ye=t.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(M){return Ye=w===b?M/dt:M,this};var ot,Ct=h.__private__.getFontSize=h.getFontSize=function(){return w===y?Ye:Ye*dt},jt=t.R2L||!1;h.__private__.setR2L=h.setR2L=function(M){return jt=M,this},h.__private__.getR2L=h.getR2L=function(){return jt};var Ot,Tt=h.__private__.setZoomMode=function(M){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(M))ot=M;else if(isNaN(M)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(M)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+M+'" is not recognized.');ot=M}else ot=parseInt(M,10)};h.__private__.getZoomMode=function(){return ot};var Qt,Ft=h.__private__.setPageMode=function(M){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(M)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+M+'" is not recognized.');Ot=M};h.__private__.getPageMode=function(){return Ot};var Qe=h.__private__.setLayoutMode=function(M){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(M)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+M+'" is not recognized.');Qt=M};h.__private__.getLayoutMode=function(){return Qt},h.__private__.setDisplayMode=h.setDisplayMode=function(M,Fe,At){return Tt(M),Qe(Fe),Ft(At),this};var De={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(M){if(Object.keys(De).indexOf(M)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return De[M]},h.__private__.getDocumentProperties=function(){return De},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(M){for(var Fe in De)De.hasOwnProperty(Fe)&&M[Fe]&&(De[Fe]=M[Fe]);return this},h.__private__.setDocumentProperty=function(M,Fe){if(Object.keys(De).indexOf(M)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return De[M]=Fe};var Je,dt,ce,we,ue,ne={},Ve={},it=[],vt={},me={},Ee={},ye={},We=null,ge=0,Ie=[],xt=new IV(h),Pt=t.hotfixes||[],It={},Ut={},$t=[],Le=function M(Fe,At,_t,Vt,hr,yr){if(!(this instanceof M))return new M(Fe,At,_t,Vt,hr,yr);isNaN(Fe)&&(Fe=1),isNaN(At)&&(At=0),isNaN(_t)&&(_t=0),isNaN(Vt)&&(Vt=1),isNaN(hr)&&(hr=0),isNaN(yr)&&(yr=0),this._matrix=[Fe,At,_t,Vt,hr,yr]};Object.defineProperty(Le.prototype,"sx",{get:function(){return this._matrix[0]},set:function(M){this._matrix[0]=M}}),Object.defineProperty(Le.prototype,"shy",{get:function(){return this._matrix[1]},set:function(M){this._matrix[1]=M}}),Object.defineProperty(Le.prototype,"shx",{get:function(){return this._matrix[2]},set:function(M){this._matrix[2]=M}}),Object.defineProperty(Le.prototype,"sy",{get:function(){return this._matrix[3]},set:function(M){this._matrix[3]=M}}),Object.defineProperty(Le.prototype,"tx",{get:function(){return this._matrix[4]},set:function(M){this._matrix[4]=M}}),Object.defineProperty(Le.prototype,"ty",{get:function(){return this._matrix[5]},set:function(M){this._matrix[5]=M}}),Object.defineProperty(Le.prototype,"a",{get:function(){return this._matrix[0]},set:function(M){this._matrix[0]=M}}),Object.defineProperty(Le.prototype,"b",{get:function(){return this._matrix[1]},set:function(M){this._matrix[1]=M}}),Object.defineProperty(Le.prototype,"c",{get:function(){return this._matrix[2]},set:function(M){this._matrix[2]=M}}),Object.defineProperty(Le.prototype,"d",{get:function(){return this._matrix[3]},set:function(M){this._matrix[3]=M}}),Object.defineProperty(Le.prototype,"e",{get:function(){return this._matrix[4]},set:function(M){this._matrix[4]=M}}),Object.defineProperty(Le.prototype,"f",{get:function(){return this._matrix[5]},set:function(M){this._matrix[5]=M}}),Object.defineProperty(Le.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Le.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Le.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Le.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Le.prototype.join=function(M){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(S).join(M)},Le.prototype.multiply=function(M){var Fe=M.sx*this.sx+M.shy*this.shx,At=M.sx*this.shy+M.shy*this.sy,_t=M.shx*this.sx+M.sy*this.shx,Vt=M.shx*this.shy+M.sy*this.sy,hr=M.tx*this.sx+M.ty*this.shx+this.tx,yr=M.tx*this.shy+M.ty*this.sy+this.ty;return new Le(Fe,At,_t,Vt,hr,yr)},Le.prototype.decompose=function(){var M=this.sx,Fe=this.shy,At=this.shx,_t=this.sy,Vt=this.tx,hr=this.ty,yr=Math.sqrt(M*M+Fe*Fe),sn=(M/=yr)*At+(Fe/=yr)*_t;At-=M*sn,_t-=Fe*sn;var hn=Math.sqrt(At*At+_t*_t);return sn/=hn,M*(_t/=hn)<Fe*(At/=hn)&&(M=-M,Fe=-Fe,sn=-sn,yr=-yr),{scale:new Le(yr,0,0,hn,0,0),translate:new Le(1,0,0,1,Vt,hr),rotate:new Le(M,Fe,-Fe,M,0,0),skew:new Le(1,0,sn,1,0,0)}},Le.prototype.toString=function(M){return this.join(" ")},Le.prototype.inversed=function(){var M=this.sx,Fe=this.shy,At=this.shx,_t=this.sy,Vt=this.tx,hr=this.ty,yr=1/(M*_t-Fe*At),sn=_t*yr,hn=-Fe*yr,Bn=-At*yr,Vn=M*yr;return new Le(sn,hn,Bn,Vn,-sn*Vt-Bn*hr,-hn*Vt-Vn*hr)},Le.prototype.applyToPoint=function(M){var Fe=M.x*this.sx+M.y*this.shx+this.tx,At=M.x*this.shy+M.y*this.sy+this.ty;return new Dl(Fe,At)},Le.prototype.applyToRectangle=function(M){var Fe=this.applyToPoint(M),At=this.applyToPoint(new Dl(M.x+M.w,M.y+M.h));return new eo(Fe.x,Fe.y,At.x-Fe.x,At.y-Fe.y)},Le.prototype.clone=function(){var M=this.sx,Fe=this.shy,At=this.shx,_t=this.sy,Vt=this.tx,hr=this.ty;return new Le(M,Fe,At,_t,Vt,hr)},h.Matrix=Le;var Ce=h.matrixMult=function(M,Fe){return Fe.multiply(M)},pe=new Le(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=pe;var He=function(M,Fe){if(!me[M]){var At=(Fe instanceof Q0?"Sh":"P")+(Object.keys(vt).length+1).toString(10);Fe.id=At,me[M]=At,vt[At]=Fe,xt.publish("addPattern",Fe)}};h.ShadingPattern=Q0,h.TilingPattern=jp,h.addShadingPattern=function(M,Fe){return E("addShadingPattern()"),He(M,Fe),this},h.beginTilingPattern=function(M){E("beginTilingPattern()"),Uc(M.boundingBox[0],M.boundingBox[1],M.boundingBox[2]-M.boundingBox[0],M.boundingBox[3]-M.boundingBox[1],M.matrix)},h.endTilingPattern=function(M,Fe){E("endTilingPattern()"),Fe.stream=be[H].join(`
`),He(M,Fe),xt.publish("endTilingPattern",Fe),$t.pop().restore()};var he,ee=h.__private__.newObject=function(){var M=_e();return R(M,!0),M},_e=h.__private__.newObjectDeferred=function(){return W++,X[W]=function(){return Q},W},R=function(M,Fe){return Fe=typeof Fe=="boolean"&&Fe,X[M]=Q,Fe&&J(M+" 0 obj"),M},V=h.__private__.newAdditionalObject=function(){var M={objId:_e(),content:""};return Z.push(M),M},q=_e(),se=_e(),Ne=h.__private__.decodeColorString=function(M){var Fe=M.split(" ");if(Fe.length!==2||Fe[1]!=="g"&&Fe[1]!=="G")Fe.length!==5||Fe[4]!=="k"&&Fe[4]!=="K"||(Fe=[(1-Fe[0])*(1-Fe[3]),(1-Fe[1])*(1-Fe[3]),(1-Fe[2])*(1-Fe[3]),"r"]);else{var At=parseFloat(Fe[0]);Fe=[At,At,At,"r"]}for(var _t="#",Vt=0;Vt<3;Vt++)_t+=("0"+Math.floor(255*parseFloat(Fe[Vt])).toString(16)).slice(-2);return _t},Me=h.__private__.encodeColorString=function(M){var Fe;typeof M=="string"&&(M={ch1:M});var At=M.ch1,_t=M.ch2,Vt=M.ch3,hr=M.ch4,yr=M.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof At=="string"&&At.charAt(0)!=="#"){var sn=new Tre(At);if(sn.ok)At=sn.toHex();else if(!/^\d*\.?\d*$/.test(At))throw new Error('Invalid color "'+At+'" passed to jsPDF.encodeColorString.')}if(typeof At=="string"&&/^#[0-9A-Fa-f]{3}$/.test(At)&&(At="#"+At[1]+At[1]+At[2]+At[2]+At[3]+At[3]),typeof At=="string"&&/^#[0-9A-Fa-f]{6}$/.test(At)){var hn=parseInt(At.substr(1),16);At=hn>>16&255,_t=hn>>8&255,Vt=255&hn}if(_t===void 0||hr===void 0&&At===_t&&_t===Vt)Fe=typeof At=="string"?At+" "+yr[0]:M.precision===2?k(At/255)+" "+yr[0]:T(At/255)+" "+yr[0];else if(hr===void 0||es(hr)==="object"){if(hr&&!isNaN(hr.a)&&hr.a===0)return["1.","1.","1.",yr[1]].join(" ");Fe=typeof At=="string"?[At,_t,Vt,yr[1]].join(" "):M.precision===2?[k(At/255),k(_t/255),k(Vt/255),yr[1]].join(" "):[T(At/255),T(_t/255),T(Vt/255),yr[1]].join(" ")}else Fe=typeof At=="string"?[At,_t,Vt,hr,yr[2]].join(" "):M.precision===2?[k(At),k(_t),k(Vt),k(hr),yr[2]].join(" "):[T(At),T(_t),T(Vt),T(hr),yr[2]].join(" ");return Fe},Ke=h.__private__.getFilters=function(){return o},Pe=h.__private__.putStream=function(M){var Fe=(M=M||{}).data||"",At=M.filters||Ke(),_t=M.alreadyAppliedFilters||[],Vt=M.addLength1||!1,hr=Fe.length,yr=M.objectId,sn=function(xi){return xi};if(d!==null&&yr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(sn=Xr.encryptor(yr,0));var hn={};At===!0&&(At=["FlateEncode"]);var Bn=M.additionalKeyValues||[],Vn=(hn=an.API.processDataByFilters!==void 0?an.API.processDataByFilters(Fe,At):{data:Fe,reverseChain:[]}).reverseChain+(Array.isArray(_t)?_t.join(" "):_t.toString());if(hn.data.length!==0&&(Bn.push({key:"Length",value:hn.data.length}),Vt===!0&&Bn.push({key:"Length1",value:hr})),Vn.length!=0)if(Vn.split("/").length-1==1)Bn.push({key:"Filter",value:Vn});else{Bn.push({key:"Filter",value:"["+Vn+"]"});for(var da=0;da<Bn.length;da+=1)if(Bn[da].key==="DecodeParms"){for(var ka=[],Js=0;Js<hn.reverseChain.split("/").length-1;Js+=1)ka.push("null");ka.push(Bn[da].value),Bn[da].value="["+ka.join(" ")+"]"}}J("<<");for(var Va=0;Va<Bn.length;Va++)J("/"+Bn[Va].key+" "+Bn[Va].value);J(">>"),hn.data.length!==0&&(J("stream"),J(sn(hn.data)),J("endstream"))},rt=h.__private__.putPage=function(M){var Fe=M.number,At=M.data,_t=M.objId,Vt=M.contentsObjId;R(_t,!0),J("<</Type /Page"),J("/Parent "+M.rootDictionaryObjId+" 0 R"),J("/Resources "+M.resourceDictionaryObjId+" 0 R"),J("/MediaBox ["+parseFloat(S(M.mediaBox.bottomLeftX))+" "+parseFloat(S(M.mediaBox.bottomLeftY))+" "+S(M.mediaBox.topRightX)+" "+S(M.mediaBox.topRightY)+"]"),M.cropBox!==null&&J("/CropBox ["+S(M.cropBox.bottomLeftX)+" "+S(M.cropBox.bottomLeftY)+" "+S(M.cropBox.topRightX)+" "+S(M.cropBox.topRightY)+"]"),M.bleedBox!==null&&J("/BleedBox ["+S(M.bleedBox.bottomLeftX)+" "+S(M.bleedBox.bottomLeftY)+" "+S(M.bleedBox.topRightX)+" "+S(M.bleedBox.topRightY)+"]"),M.trimBox!==null&&J("/TrimBox ["+S(M.trimBox.bottomLeftX)+" "+S(M.trimBox.bottomLeftY)+" "+S(M.trimBox.topRightX)+" "+S(M.trimBox.topRightY)+"]"),M.artBox!==null&&J("/ArtBox ["+S(M.artBox.bottomLeftX)+" "+S(M.artBox.bottomLeftY)+" "+S(M.artBox.topRightX)+" "+S(M.artBox.topRightY)+"]"),typeof M.userUnit=="number"&&M.userUnit!==1&&J("/UserUnit "+M.userUnit),xt.publish("putPage",{objId:_t,pageContext:Ie[Fe],pageNumber:Fe,page:At}),J("/Contents "+Vt+" 0 R"),J(">>"),J("endobj");var hr=At.join(`
`);return w===b&&(hr+=`
Q`),R(Vt,!0),Pe({data:hr,filters:Ke(),objectId:Vt}),J("endobj"),_t},lt=h.__private__.putPages=function(){var M,Fe,At=[];for(M=1;M<=ge;M++)Ie[M].objId=_e(),Ie[M].contentsObjId=_e();for(M=1;M<=ge;M++)At.push(rt({number:M,data:be[M],objId:Ie[M].objId,contentsObjId:Ie[M].contentsObjId,mediaBox:Ie[M].mediaBox,cropBox:Ie[M].cropBox,bleedBox:Ie[M].bleedBox,trimBox:Ie[M].trimBox,artBox:Ie[M].artBox,userUnit:Ie[M].userUnit,rootDictionaryObjId:q,resourceDictionaryObjId:se}));R(q,!0),J("<</Type /Pages");var _t="/Kids [";for(Fe=0;Fe<ge;Fe++)_t+=At[Fe]+" 0 R ";J(_t+"]"),J("/Count "+ge),J(">>"),J("endobj"),xt.publish("postPutPages")},ht=function(M){xt.publish("putFont",{font:M,out:J,newObject:ee,putStream:Pe}),M.isAlreadyPutted!==!0&&(M.objectNumber=ee(),J("<<"),J("/Type /Font"),J("/BaseFont /"+Fx(M.postScriptName)),J("/Subtype /Type1"),typeof M.encoding=="string"&&J("/Encoding /"+M.encoding),J("/FirstChar 32"),J("/LastChar 255"),J(">>"),J("endobj"))},kt=function(M){M.objectNumber=ee();var Fe=[];Fe.push({key:"Type",value:"/XObject"}),Fe.push({key:"Subtype",value:"/Form"}),Fe.push({key:"BBox",value:"["+[S(M.x),S(M.y),S(M.x+M.width),S(M.y+M.height)].join(" ")+"]"}),Fe.push({key:"Matrix",value:"["+M.matrix.toString()+"]"});var At=M.pages[1].join(`
`);Pe({data:At,additionalKeyValues:Fe,objectId:M.objectNumber}),J("endobj")},de=function(M,Fe){Fe||(Fe=21);var At=ee(),_t=function(yr,sn){var hn,Bn=[],Vn=1/(sn-1);for(hn=0;hn<1;hn+=Vn)Bn.push(hn);if(Bn.push(1),yr[0].offset!=0){var da={offset:0,color:yr[0].color};yr.unshift(da)}if(yr[yr.length-1].offset!=1){var ka={offset:1,color:yr[yr.length-1].color};yr.push(ka)}for(var Js="",Va=0,xi=0;xi<Bn.length;xi++){for(hn=Bn[xi];hn>yr[Va+1].offset;)Va++;var Zs=yr[Va].offset,vi=(hn-Zs)/(yr[Va+1].offset-Zs),ei=yr[Va].color,Vc=yr[Va+1].color;Js+=L(Math.round((1-vi)*ei[0]+vi*Vc[0]).toString(16))+L(Math.round((1-vi)*ei[1]+vi*Vc[1]).toString(16))+L(Math.round((1-vi)*ei[2]+vi*Vc[2]).toString(16))}return Js.trim()}(M.colors,Fe),Vt=[];Vt.push({key:"FunctionType",value:"0"}),Vt.push({key:"Domain",value:"[0.0 1.0]"}),Vt.push({key:"Size",value:"["+Fe+"]"}),Vt.push({key:"BitsPerSample",value:"8"}),Vt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Vt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Pe({data:_t,additionalKeyValues:Vt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:At}),J("endobj"),M.objectNumber=ee(),J("<< /ShadingType "+M.type),J("/ColorSpace /DeviceRGB");var hr="/Coords ["+S(parseFloat(M.coords[0]))+" "+S(parseFloat(M.coords[1]))+" ";M.type===2?hr+=S(parseFloat(M.coords[2]))+" "+S(parseFloat(M.coords[3])):hr+=S(parseFloat(M.coords[2]))+" "+S(parseFloat(M.coords[3]))+" "+S(parseFloat(M.coords[4]))+" "+S(parseFloat(M.coords[5])),J(hr+="]"),M.matrix&&J("/Matrix ["+M.matrix.toString()+"]"),J("/Function "+At+" 0 R"),J("/Extend [true true]"),J(">>"),J("endobj")},qe=function(M,Fe){var At=_e(),_t=ee();Fe.push({resourcesOid:At,objectOid:_t}),M.objectNumber=_t;var Vt=[];Vt.push({key:"Type",value:"/Pattern"}),Vt.push({key:"PatternType",value:"1"}),Vt.push({key:"PaintType",value:"1"}),Vt.push({key:"TilingType",value:"1"}),Vt.push({key:"BBox",value:"["+M.boundingBox.map(S).join(" ")+"]"}),Vt.push({key:"XStep",value:S(M.xStep)}),Vt.push({key:"YStep",value:S(M.yStep)}),Vt.push({key:"Resources",value:At+" 0 R"}),M.matrix&&Vt.push({key:"Matrix",value:"["+M.matrix.toString()+"]"}),Pe({data:M.stream,additionalKeyValues:Vt,objectId:M.objectNumber}),J("endobj")},at=function(M){for(var Fe in M.objectNumber=ee(),J("<<"),M)switch(Fe){case"opacity":J("/ca "+k(M[Fe]));break;case"stroke-opacity":J("/CA "+k(M[Fe]))}J(">>"),J("endobj")},st=function(M){R(M.resourcesOid,!0),J("<<"),J("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var Fe in J("/Font <<"),ne)ne.hasOwnProperty(Fe)&&(f===!1||f===!0&&A.hasOwnProperty(Fe))&&J("/"+Fe+" "+ne[Fe].objectNumber+" 0 R");J(">>")}(),function(){if(Object.keys(vt).length>0){for(var Fe in J("/Shading <<"),vt)vt.hasOwnProperty(Fe)&&vt[Fe]instanceof Q0&&vt[Fe].objectNumber>=0&&J("/"+Fe+" "+vt[Fe].objectNumber+" 0 R");xt.publish("putShadingPatternDict"),J(">>")}}(),function(Fe){if(Object.keys(vt).length>0){for(var At in J("/Pattern <<"),vt)vt.hasOwnProperty(At)&&vt[At]instanceof h.TilingPattern&&vt[At].objectNumber>=0&&vt[At].objectNumber<Fe&&J("/"+At+" "+vt[At].objectNumber+" 0 R");xt.publish("putTilingPatternDict"),J(">>")}}(M.objectOid),function(){if(Object.keys(Ee).length>0){var Fe;for(Fe in J("/ExtGState <<"),Ee)Ee.hasOwnProperty(Fe)&&Ee[Fe].objectNumber>=0&&J("/"+Fe+" "+Ee[Fe].objectNumber+" 0 R");xt.publish("putGStateDict"),J(">>")}}(),function(){for(var Fe in J("/XObject <<"),It)It.hasOwnProperty(Fe)&&It[Fe].objectNumber>=0&&J("/"+Fe+" "+It[Fe].objectNumber+" 0 R");xt.publish("putXobjectDict"),J(">>")}(),J(">>"),J("endobj")},Nt=function(M){Ve[M.fontName]=Ve[M.fontName]||{},Ve[M.fontName][M.fontStyle]=M.id},Rt=function(M,Fe,At,_t,Vt){var hr={id:"F"+(Object.keys(ne).length+1).toString(10),postScriptName:M,fontName:Fe,fontStyle:At,encoding:_t,isStandardFont:Vt||!1,metadata:{}};return xt.publish("addFont",{font:hr,instance:this}),ne[hr.id]=hr,Nt(hr),hr.id},nr=h.__private__.pdfEscape=h.pdfEscape=function(M,Fe){return function(At,_t){var Vt,hr,yr,sn,hn,Bn,Vn,da,ka;if(yr=(_t=_t||{}).sourceEncoding||"Unicode",hn=_t.outputEncoding,(_t.autoencode||hn)&&ne[Je].metadata&&ne[Je].metadata[yr]&&ne[Je].metadata[yr].encoding&&(sn=ne[Je].metadata[yr].encoding,!hn&&ne[Je].encoding&&(hn=ne[Je].encoding),!hn&&sn.codePages&&(hn=sn.codePages[0]),typeof hn=="string"&&(hn=sn[hn]),hn)){for(Vn=!1,Bn=[],Vt=0,hr=At.length;Vt<hr;Vt++)(da=hn[At.charCodeAt(Vt)])?Bn.push(String.fromCharCode(da)):Bn.push(At[Vt]),Bn[Vt].charCodeAt(0)>>8&&(Vn=!0);At=Bn.join("")}for(Vt=At.length;Vn===void 0&&Vt!==0;)At.charCodeAt(Vt-1)>>8&&(Vn=!0),Vt--;if(!Vn)return At;for(Bn=_t.noBOM?[]:[254,255],Vt=0,hr=At.length;Vt<hr;Vt++){if((ka=(da=At.charCodeAt(Vt))>>8)>>8)throw new Error("Character at position "+Vt+" of string '"+At+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Bn.push(ka),Bn.push(da-(ka<<8))}return String.fromCharCode.apply(void 0,Bn)}(M,Fe).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},_r=h.__private__.beginPage=function(M){be[++ge]=[],Ie[ge]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(M[0]),topRightY:Number(M[1])}},kr(ge),re(be[H])},$r=function(M,Fe){var At,_t,Vt;switch(r=Fe||r,typeof M=="string"&&(At=v(M.toLowerCase()),Array.isArray(At)&&(_t=At[0],Vt=At[1])),Array.isArray(M)&&(_t=M[0]*dt,Vt=M[1]*dt),isNaN(_t)&&(_t=a[0],Vt=a[1]),(_t>14400||Vt>14400)&&(hs.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),_t=Math.min(14400,_t),Vt=Math.min(14400,Vt)),a=[_t,Vt],r.substr(0,1)){case"l":Vt>_t&&(a=[Vt,_t]);break;case"p":_t>Vt&&(a=[Vt,_t])}_r(a),Dt(vr),J(xn),xa!==0&&J(xa+" J"),Qn!==0&&J(Qn+" j"),xt.publish("addPage",{pageNumber:ge})},or=function(M){M>0&&M<=ge&&(be.splice(M,1),Ie.splice(M,1),ge--,H>ge&&(H=ge),this.setPage(H))},kr=function(M){M>0&&M<=ge&&(H=M)},en=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return be.length-1},rn=function(M,Fe,At){var _t,Vt=void 0;return At=At||{},M=M!==void 0?M:ne[Je].fontName,Fe=Fe!==void 0?Fe:ne[Je].fontStyle,_t=M.toLowerCase(),Ve[_t]!==void 0&&Ve[_t][Fe]!==void 0?Vt=Ve[_t][Fe]:Ve[M]!==void 0&&Ve[M][Fe]!==void 0?Vt=Ve[M][Fe]:At.disableWarning===!1&&hs.warn("Unable to look up font label for font '"+M+"', '"+Fe+"'. Refer to getFontList() for available fonts."),Vt||At.noFallback||(Vt=Ve.times[Fe])==null&&(Vt=Ve.times.normal),Vt},Er=h.__private__.putInfo=function(){var M=ee(),Fe=function(_t){return _t};for(var At in d!==null&&(Fe=Xr.encryptor(M,0)),J("<<"),J("/Producer ("+nr(Fe("jsPDF "+an.version))+")"),De)De.hasOwnProperty(At)&&De[At]&&J("/"+At.substr(0,1).toUpperCase()+At.substr(1)+" ("+nr(Fe(De[At]))+")");J("/CreationDate ("+nr(Fe(le))+")"),J(">>"),J("endobj")},Se=h.__private__.putCatalog=function(M){var Fe=(M=M||{}).rootDictionaryObjId||q;switch(ee(),J("<<"),J("/Type /Catalog"),J("/Pages "+Fe+" 0 R"),ot||(ot="fullwidth"),ot){case"fullwidth":J("/OpenAction [3 0 R /FitH null]");break;case"fullheight":J("/OpenAction [3 0 R /FitV null]");break;case"fullpage":J("/OpenAction [3 0 R /Fit]");break;case"original":J("/OpenAction [3 0 R /XYZ null null 1]");break;default:var At=""+ot;At.substr(At.length-1)==="%"&&(ot=parseInt(ot)/100),typeof ot=="number"&&J("/OpenAction [3 0 R /XYZ null null "+k(ot)+"]")}switch(Qt||(Qt="continuous"),Qt){case"continuous":J("/PageLayout /OneColumn");break;case"single":J("/PageLayout /SinglePage");break;case"two":case"twoleft":J("/PageLayout /TwoColumnLeft");break;case"tworight":J("/PageLayout /TwoColumnRight")}Ot&&J("/PageMode /"+Ot),xt.publish("putCatalog"),J(">>"),J("endobj")},gt=h.__private__.putTrailer=function(){J("trailer"),J("<<"),J("/Size "+(W+1)),J("/Root "+W+" 0 R"),J("/Info "+(W-1)+" 0 R"),d!==null&&J("/Encrypt "+Xr.oid+" 0 R"),J("/ID [ <"+oe+"> <"+oe+"> ]"),J(">>")},er=h.__private__.putHeader=function(){J("%PDF-"+m),J("%")},Mr=h.__private__.putXRef=function(){var M="0000000000";J("xref"),J("0 "+(W+1)),J("0000000000 65535 f ");for(var Fe=1;Fe<=W;Fe++)typeof X[Fe]=="function"?J((M+X[Fe]()).slice(-10)+" 00000 n "):X[Fe]!==void 0?J((M+X[Fe]).slice(-10)+" 00000 n "):J("0000000000 00000 n ")},Or=h.__private__.buildDocument=function(){var M;W=0,Q=0,D=[],X=[],Z=[],q=_e(),se=_e(),re(D),xt.publish("buildDocument"),er(),lt(),function(){xt.publish("putAdditionalObjects");for(var At=0;At<Z.length;At++){var _t=Z[At];R(_t.objId,!0),J(_t.content),J("endobj")}xt.publish("postPutAdditionalObjects")}(),M=[],function(){for(var At in ne)ne.hasOwnProperty(At)&&(f===!1||f===!0&&A.hasOwnProperty(At))&&ht(ne[At])}(),function(){var At;for(At in Ee)Ee.hasOwnProperty(At)&&at(Ee[At])}(),function(){for(var At in It)It.hasOwnProperty(At)&&kt(It[At])}(),function(At){var _t;for(_t in vt)vt.hasOwnProperty(_t)&&(vt[_t]instanceof Q0?de(vt[_t]):vt[_t]instanceof jp&&qe(vt[_t],At))}(M),xt.publish("putResources"),M.forEach(st),st({resourcesOid:se,objectOid:Number.MAX_SAFE_INTEGER}),xt.publish("postPutResources"),d!==null&&(Xr.oid=ee(),J("<<"),J("/Filter /Standard"),J("/V "+Xr.v),J("/R "+Xr.r),J("/U <"+Xr.toHexString(Xr.U)+">"),J("/O <"+Xr.toHexString(Xr.O)+">"),J("/P "+Xr.P),J(">>"),J("endobj")),Er(),Se();var Fe=Q;return Mr(),gt(),J("startxref"),J(""+Fe),J("%%EOF"),re(be[H]),D.join(`
`)},ir=h.__private__.getBlob=function(M){return new Blob([ke(M)],{type:"application/pdf"})},br=h.output=h.__private__.output=(he=function(M,Fe){switch(typeof(Fe=Fe||{})=="string"?Fe={filename:Fe}:Fe.filename=Fe.filename||"generated.pdf",M){case void 0:return Or();case"save":h.save(Fe.filename);break;case"arraybuffer":return ke(Or());case"blob":return ir(Or());case"bloburi":case"bloburl":if(Ln.URL!==void 0&&typeof Ln.URL.createObjectURL=="function")return Ln.URL&&Ln.URL.createObjectURL(ir(Or()))||void 0;hs.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var At="",_t=Or();try{At=_V(_t)}catch{At=_V(unescape(encodeURIComponent(_t)))}return"data:application/pdf;filename="+Fe.filename+";base64,"+At;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ln)==="[object Window]"){var Vt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",hr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Fe.pdfObjectUrl&&(Vt=Fe.pdfObjectUrl,hr="");var yr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Vt+'"'+hr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Fe)+");<\/script></body></html>",sn=Ln.open();return sn!==null&&sn.document.write(yr),sn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ln)==="[object Window]"){var hn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Fe.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Fe.filename+'" width="500px" height="400px" /></body></html>',Bn=Ln.open();if(Bn!==null){Bn.document.write(hn);var Vn=this;Bn.document.documentElement.querySelector("#pdfViewer").onload=function(){Bn.document.title=Fe.filename,Bn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Vn.output("bloburl"))}}return Bn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ln)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var da='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Fe)+'"></iframe></body></html>',ka=Ln.open();if(ka!==null&&(ka.document.write(da),ka.document.title=Fe.filename),ka||typeof safari>"u")return ka;break;case"datauri":case"dataurl":return Ln.document.location.href=this.output("datauristring",Fe);default:return null}},he.foo=function(){try{return he.apply(this,arguments)}catch(At){var M=At.stack||"";~M.indexOf(" at ")&&(M=M.split(" at ")[1]);var Fe="Error in function "+M.split(`
`)[0].split("<")[0]+": "+At.message;if(!Ln.console)throw new Error(Fe);Ln.console.error(Fe,At),Ln.alert&&alert(Fe)}},he.foo.bar=he,he.foo),wr=function(M){return Array.isArray(Pt)===!0&&Pt.indexOf(M)>-1};switch(n){case"pt":dt=1;break;case"mm":dt=72/25.4;break;case"cm":dt=72/2.54;break;case"in":dt=72;break;case"px":dt=wr("px_scaling")==1?.75:96/72;break;case"pc":case"em":dt=12;break;case"ex":dt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);dt=n}var Xr=null;Ue(),Ae();var Ir=h.__private__.getPageInfo=h.getPageInfo=function(M){if(isNaN(M)||M%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ie[M].objId,pageNumber:M,pageContext:Ie[M]}},Pr=h.__private__.getPageInfoByObjId=function(M){if(isNaN(M)||M%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Fe in Ie)if(Ie[Fe].objId===M)break;return Ir(Fe)},fn=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:Ie[H].objId,pageNumber:H,pageContext:Ie[H]}};h.addPage=function(){return $r.apply(this,arguments),this},h.setPage=function(){return kr.apply(this,arguments),re.call(this,be[H]),this},h.insertPage=function(M){return this.addPage(),this.movePage(H,M),this},h.movePage=function(M,Fe){var At,_t;if(M>Fe){At=be[M],_t=Ie[M];for(var Vt=M;Vt>Fe;Vt--)be[Vt]=be[Vt-1],Ie[Vt]=Ie[Vt-1];be[Fe]=At,Ie[Fe]=_t,this.setPage(Fe)}else if(M<Fe){At=be[M],_t=Ie[M];for(var hr=M;hr<Fe;hr++)be[hr]=be[hr+1],Ie[hr]=Ie[hr+1];be[Fe]=At,Ie[Fe]=_t,this.setPage(Fe)}return this},h.deletePage=function(){return or.apply(this,arguments),this},h.__private__.text=h.text=function(M,Fe,At,_t,Vt){var hr,yr,sn,hn,Bn,Vn,da,ka,Js,Va=(_t=_t||{}).scope||this;if(typeof M=="number"&&typeof Fe=="number"&&(typeof At=="string"||Array.isArray(At))){var xi=At;At=Fe,Fe=M,M=xi}if(arguments[3]instanceof Le==0?(sn=arguments[4],hn=arguments[5],es(da=arguments[3])==="object"&&da!==null||(typeof sn=="string"&&(hn=sn,sn=null),typeof da=="string"&&(hn=da,da=null),typeof da=="number"&&(sn=da,da=null),_t={flags:da,angle:sn,align:hn})):(E("The transform parameter of text() with a Matrix value"),Js=Vt),isNaN(Fe)||isNaN(At)||M==null)throw new Error("Invalid arguments passed to jsPDF.text");if(M.length===0)return Va;var Zs,vi="",ei=typeof _t.lineHeightFactor=="number"?_t.lineHeightFactor:ar,Vc=Va.internal.scaleFactor;function Xu(Ma){return Ma=Ma.split("	").join(Array(_t.TabLen||9).join(" ")),nr(Ma,da)}function Yu(Ma){for(var ds,ki=Ma.concat(),Ao=[],wh=ki.length;wh--;)typeof(ds=ki.shift())=="string"?Ao.push(ds):Array.isArray(Ma)&&(ds.length===1||ds[1]===void 0&&ds[2]===void 0)?Ao.push(ds[0]):Ao.push([ds[0],ds[1],ds[2]]);return Ao}function _(Ma,ds){var ki;if(typeof Ma=="string")ki=ds(Ma)[0];else if(Array.isArray(Ma)){for(var Ao,wh,V1=Ma.concat(),Jg=[],yN=V1.length;yN--;)typeof(Ao=V1.shift())=="string"?Jg.push(ds(Ao)[0]):Array.isArray(Ao)&&typeof Ao[0]=="string"&&(wh=ds(Ao[0],Ao[1],Ao[2]),Jg.push([wh[0],wh[1],wh[2]]));ki=Jg}return ki}var Y=!1,xe=!0;if(typeof M=="string")Y=!0;else if(Array.isArray(M)){var Ze=M.concat();yr=[];for(var Gt,rr=Ze.length;rr--;)(typeof(Gt=Ze.shift())!="string"||Array.isArray(Gt)&&typeof Gt[0]!="string")&&(xe=!1);Y=xe}if(Y===!1)throw new Error('Type of text must be string or Array. "'+M+'" is not recognized.');typeof M=="string"&&(M=M.match(/[\r?\n]/)?M.split(/\r\n|\r|\n/g):[M]);var Lr=Ye/Va.internal.scaleFactor,ma=Lr*(ei-1);switch(_t.baseline){case"bottom":At-=ma;break;case"top":At+=Lr-ma;break;case"hanging":At+=Lr-2*ma;break;case"middle":At+=Lr/2-ma}if((Vn=_t.maxWidth||0)>0&&(typeof M=="string"?M=Va.splitTextToSize(M,Vn):Object.prototype.toString.call(M)==="[object Array]"&&(M=M.reduce(function(Ma,ds){return Ma.concat(Va.splitTextToSize(ds,Vn))},[]))),hr={text:M,x:Fe,y:At,options:_t,mutex:{pdfEscape:nr,activeFontKey:Je,fonts:ne,activeFontSize:Ye}},xt.publish("preProcessText",hr),M=hr.text,sn=(_t=hr.options).angle,Js instanceof Le==0&&sn&&typeof sn=="number"){sn*=Math.PI/180,_t.rotationDirection===0&&(sn=-sn),w===b&&(sn=-sn);var ti=Math.cos(sn),aa=Math.sin(sn);Js=new Le(ti,aa,-aa,ti,0,0)}else sn&&sn instanceof Le&&(Js=sn);w!==b||Js||(Js=pe),(Bn=_t.charSpace||Zi)!==void 0&&(vi+=S(P(Bn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ka=_t.horizontalScale)!==void 0&&(vi+=S(100*ka)+` Tz
`),_t.lang;var Sa=-1,gs=_t.renderingMode!==void 0?_t.renderingMode:_t.stroke,mu=Va.internal.getCurrentPageInfo().pageContext;switch(gs){case 0:case!1:case"fill":Sa=0;break;case 1:case!0:case"stroke":Sa=1;break;case 2:case"fillThenStroke":Sa=2;break;case 3:case"invisible":Sa=3;break;case 4:case"fillAndAddForClipping":Sa=4;break;case 5:case"strokeAndAddPathForClipping":Sa=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Sa=6;break;case 7:case"addToPathForClipping":Sa=7}var Rl=mu.usedRenderingMode!==void 0?mu.usedRenderingMode:-1;Sa!==-1?vi+=Sa+` Tr
`:Rl!==-1&&(vi+=`0 Tr
`),Sa!==-1&&(mu.usedRenderingMode=Sa),hn=_t.align||"left";var ul,Gd=Ye*ei,O1=Va.internal.pageSize.getWidth(),D1=ne[Je];Bn=_t.charSpace||Zi,Vn=_t.maxWidth||0,da=Object.assign({autoencode:!0,noBOM:!0},_t.flags);var zA=[],zm=function(Ma){return Va.getStringUnitWidth(Ma,{font:D1,charSpace:Bn,fontSize:Ye,doKerning:!1})*Ye/Vc};if(Object.prototype.toString.call(M)==="[object Array]"){var pu;yr=Yu(M),hn!=="left"&&(ul=yr.map(zm));var gu,WA=0;if(hn==="right"){Fe-=ul[0],M=[],rr=yr.length;for(var bh=0;bh<rr;bh++)bh===0?(gu=pr(Fe),pu=jr(At)):(gu=P(WA-ul[bh]),pu=-Gd),M.push([yr[bh],gu,pu]),WA=ul[bh]}else if(hn==="center"){Fe-=ul[0]/2,M=[],rr=yr.length;for(var XA=0;XA<rr;XA++)XA===0?(gu=pr(Fe),pu=jr(At)):(gu=P((WA-ul[XA])/2),pu=-Gd),M.push([yr[XA],gu,pu]),WA=ul[XA]}else if(hn==="left"){M=[],rr=yr.length;for(var R1=0;R1<rr;R1++)M.push(yr[R1])}else if(hn==="justify"&&D1.encoding==="Identity-H"){M=[],rr=yr.length,Vn=Vn!==0?Vn:O1;for(var Yg=0,Bi=0;Bi<rr;Bi++)if(pu=Bi===0?jr(At):-Gd,gu=Bi===0?pr(Fe):Yg,Bi<rr-1){var vN=P((Vn-ul[Bi])/(yr[Bi].split(" ").length-1)),kf=yr[Bi].split(" ");M.push([kf[0]+" ",gu,pu]),Yg=0;for(var Ff=1;Ff<kf.length;Ff++){var M1=(zm(kf[Ff-1]+" "+kf[Ff])-zm(kf[Ff]))*Vc+vN;Ff==kf.length-1?M.push([kf[Ff],M1,0]):M.push([kf[Ff]+" ",M1,0]),Yg-=M1}}else M.push([yr[Bi],gu,pu]);M.push(["",Yg,0])}else{if(hn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(M=[],rr=yr.length,Vn=Vn!==0?Vn:O1,Bi=0;Bi<rr;Bi++){pu=Bi===0?jr(At):-Gd,gu=Bi===0?pr(Fe):0;var L1=yr[Bi].split(" ").length-1,U1=L1>0?(Vn-ul[Bi])/L1:0;Bi<rr-1?zA.push(S(P(U1))):zA.push(0),M.push([yr[Bi],gu,pu])}}}(typeof _t.R2L=="boolean"?_t.R2L:jt)===!0&&(M=_(M,function(Ma,ds,ki){return[Ma.split("").reverse().join(""),ds,ki]})),hr={text:M,x:Fe,y:At,options:_t,mutex:{pdfEscape:nr,activeFontKey:Je,fonts:ne,activeFontSize:Ye}},xt.publish("postProcessText",hr),M=hr.text,Zs=hr.mutex.isHex||!1;var Q1=ne[Je].encoding;Q1!=="WinAnsiEncoding"&&Q1!=="StandardEncoding"||(M=_(M,function(Ma,ds,ki){return[Xu(Ma),ds,ki]})),yr=Yu(M),M=[];for(var YA,JA,ZA,Wm=Array.isArray(yr[0])?1:0,e0="",Xm=function(Ma,ds,ki){var Ao="";return ki instanceof Le?(ki=typeof _t.angle=="number"?Ce(ki,new Le(1,0,0,1,Ma,ds)):Ce(new Le(1,0,0,1,Ma,ds),ki),w===b&&(ki=Ce(new Le(1,0,0,-1,0,0),ki)),Ao=ki.join(" ")+` Tm
`):Ao=S(Ma)+" "+S(ds)+` Td
`,Ao},Ju=0;Ju<yr.length;Ju++){switch(e0="",Wm){case 1:ZA=(Zs?"<":"(")+yr[Ju][0]+(Zs?">":")"),YA=parseFloat(yr[Ju][1]),JA=parseFloat(yr[Ju][2]);break;case 0:ZA=(Zs?"<":"(")+yr[Ju]+(Zs?">":")"),YA=pr(Fe),JA=jr(At)}zA!==void 0&&zA[Ju]!==void 0&&(e0=zA[Ju]+` Tw
`),Ju===0?M.push(e0+Xm(YA,JA,Js)+ZA):Wm===0?M.push(e0+ZA):Wm===1&&M.push(e0+Xm(YA,JA,Js)+ZA)}M=Wm===0?M.join(` Tj
T* `):M.join(` Tj
`),M+=` Tj
`;var Of=`BT
/`;return Of+=Je+" "+Ye+` Tf
`,Of+=S(Ye*ei)+` TL
`,Of+=ga+`
`,Of+=vi,Of+=M,J(Of+="ET"),A[Je]=!0,Va};var fe=h.__private__.clip=h.clip=function(M){return J(M==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return fe("evenodd")},h.__private__.discardPath=h.discardPath=function(){return J("n"),this};var et=h.__private__.isValidStyle=function(M){var Fe=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(M)!==-1&&(Fe=!0),Fe};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(M){return et(M)&&(u=M),this};var nt=h.__private__.getStyle=h.getStyle=function(M){var Fe=u;switch(M){case"D":case"S":Fe="S";break;case"F":Fe="f";break;case"FD":case"DF":Fe="B";break;case"f":case"f*":case"B":case"B*":Fe=M}return Fe},ct=h.close=function(){return J("h"),this};h.stroke=function(){return J("S"),this},h.fill=function(M){return ve("f",M),this},h.fillEvenOdd=function(M){return ve("f*",M),this},h.fillStroke=function(M){return ve("B",M),this},h.fillStrokeEvenOdd=function(M){return ve("B*",M),this};var ve=function(M,Fe){es(Fe)==="object"?wt(Fe,M):J(M)},ft=function(M){M===null||w===b&&M===void 0||(M=nt(M),J(M))};function St(M,Fe,At,_t,Vt){var hr=new jp(Fe||this.boundingBox,At||this.xStep,_t||this.yStep,this.gState,Vt||this.matrix);hr.stream=this.stream;var yr=M+"$$"+this.cloneIndex+++"$$";return He(yr,hr),hr}var wt=function(M,Fe){var At=me[M.key],_t=vt[At];if(_t instanceof Q0)J("q"),J(yt(Fe)),_t.gState&&h.setGState(_t.gState),J(M.matrix.toString()+" cm"),J("/"+At+" sh"),J("Q");else if(_t instanceof jp){var Vt=new Le(1,0,0,-1,0,ho());M.matrix&&(Vt=Vt.multiply(M.matrix||pe),At=St.call(_t,M.key,M.boundingBox,M.xStep,M.yStep,Vt).id),J("q"),J("/Pattern cs"),J("/"+At+" scn"),_t.gState&&h.setGState(_t.gState),J(Fe),J("Q")}},yt=function(M){switch(M){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Et=h.moveTo=function(M,Fe){return J(S(P(M))+" "+S(K(Fe))+" m"),this},qt=h.lineTo=function(M,Fe){return J(S(P(M))+" "+S(K(Fe))+" l"),this},Mt=h.curveTo=function(M,Fe,At,_t,Vt,hr){return J([S(P(M)),S(K(Fe)),S(P(At)),S(K(_t)),S(P(Vt)),S(K(hr)),"c"].join(" ")),this};h.__private__.line=h.line=function(M,Fe,At,_t,Vt){if(isNaN(M)||isNaN(Fe)||isNaN(At)||isNaN(_t)||!et(Vt))throw new Error("Invalid arguments passed to jsPDF.line");return w===y?this.lines([[At-M,_t-Fe]],M,Fe,[1,1],Vt||"S"):this.lines([[At-M,_t-Fe]],M,Fe,[1,1]).stroke()},h.__private__.lines=h.lines=function(M,Fe,At,_t,Vt,hr){var yr,sn,hn,Bn,Vn,da,ka,Js,Va,xi,Zs,vi;if(typeof M=="number"&&(vi=At,At=Fe,Fe=M,M=vi),_t=_t||[1,1],hr=hr||!1,isNaN(Fe)||isNaN(At)||!Array.isArray(M)||!Array.isArray(_t)||!et(Vt)||typeof hr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Et(Fe,At),yr=_t[0],sn=_t[1],Bn=M.length,xi=Fe,Zs=At,hn=0;hn<Bn;hn++)(Vn=M[hn]).length===2?(xi=Vn[0]*yr+xi,Zs=Vn[1]*sn+Zs,qt(xi,Zs)):(da=Vn[0]*yr+xi,ka=Vn[1]*sn+Zs,Js=Vn[2]*yr+xi,Va=Vn[3]*sn+Zs,xi=Vn[4]*yr+xi,Zs=Vn[5]*sn+Zs,Mt(da,ka,Js,Va,xi,Zs));return hr&&ct(),ft(Vt),this},h.path=function(M){for(var Fe=0;Fe<M.length;Fe++){var At=M[Fe],_t=At.c;switch(At.op){case"m":Et(_t[0],_t[1]);break;case"l":qt(_t[0],_t[1]);break;case"c":Mt.apply(this,_t);break;case"h":ct()}}return this},h.__private__.rect=h.rect=function(M,Fe,At,_t,Vt){if(isNaN(M)||isNaN(Fe)||isNaN(At)||isNaN(_t)||!et(Vt))throw new Error("Invalid arguments passed to jsPDF.rect");return w===y&&(_t=-_t),J([S(P(M)),S(K(Fe)),S(P(At)),S(P(_t)),"re"].join(" ")),ft(Vt),this},h.__private__.triangle=h.triangle=function(M,Fe,At,_t,Vt,hr,yr){if(isNaN(M)||isNaN(Fe)||isNaN(At)||isNaN(_t)||isNaN(Vt)||isNaN(hr)||!et(yr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[At-M,_t-Fe],[Vt-At,hr-_t],[M-Vt,Fe-hr]],M,Fe,[1,1],yr,!0),this},h.__private__.roundedRect=h.roundedRect=function(M,Fe,At,_t,Vt,hr,yr){if(isNaN(M)||isNaN(Fe)||isNaN(At)||isNaN(_t)||isNaN(Vt)||isNaN(hr)||!et(yr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var sn=4/3*(Math.SQRT2-1);return Vt=Math.min(Vt,.5*At),hr=Math.min(hr,.5*_t),this.lines([[At-2*Vt,0],[Vt*sn,0,Vt,hr-hr*sn,Vt,hr],[0,_t-2*hr],[0,hr*sn,-Vt*sn,hr,-Vt,hr],[2*Vt-At,0],[-Vt*sn,0,-Vt,-hr*sn,-Vt,-hr],[0,2*hr-_t],[0,-hr*sn,Vt*sn,-hr,Vt,-hr]],M+Vt,Fe,[1,1],yr,!0),this},h.__private__.ellipse=h.ellipse=function(M,Fe,At,_t,Vt){if(isNaN(M)||isNaN(Fe)||isNaN(At)||isNaN(_t)||!et(Vt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var hr=4/3*(Math.SQRT2-1)*At,yr=4/3*(Math.SQRT2-1)*_t;return Et(M+At,Fe),Mt(M+At,Fe-yr,M+hr,Fe-_t,M,Fe-_t),Mt(M-hr,Fe-_t,M-At,Fe-yr,M-At,Fe),Mt(M-At,Fe+yr,M-hr,Fe+_t,M,Fe+_t),Mt(M+hr,Fe+_t,M+At,Fe+yr,M+At,Fe),ft(Vt),this},h.__private__.circle=h.circle=function(M,Fe,At,_t){if(isNaN(M)||isNaN(Fe)||isNaN(At)||!et(_t))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(M,Fe,At,At,_t)},h.setFont=function(M,Fe,At){return At&&(Fe=C(Fe,At)),Je=rn(M,Fe,{disableWarning:!1}),this};var Yt=h.__private__.getFont=h.getFont=function(){return ne[rn.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var M,Fe,At={};for(M in Ve)if(Ve.hasOwnProperty(M))for(Fe in At[M]=[],Ve[M])Ve[M].hasOwnProperty(Fe)&&At[M].push(Fe);return At},h.addFont=function(M,Fe,At,_t,Vt){var hr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&hr.indexOf(arguments[3])!==-1?Vt=arguments[3]:arguments[3]&&hr.indexOf(arguments[3])==-1&&(At=C(At,_t)),Rt.call(this,M,Fe,At,Vt=Vt||"Identity-H")};var ar,vr=t.lineWidth||.200025,ur=h.__private__.getLineWidth=h.getLineWidth=function(){return vr},Dt=h.__private__.setLineWidth=h.setLineWidth=function(M){return vr=M,J(S(P(M))+" w"),this};h.__private__.setLineDash=an.API.setLineDash=an.API.setLineDashPattern=function(M,Fe){if(M=M||[],Fe=Fe||0,isNaN(Fe)||!Array.isArray(M))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return M=M.map(function(At){return S(P(At))}).join(" "),Fe=S(P(Fe)),J("["+M+"] "+Fe+" d"),this};var Yr=h.__private__.getLineHeight=h.getLineHeight=function(){return Ye*ar};h.__private__.getLineHeight=h.getLineHeight=function(){return Ye*ar};var Vr=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(M){return typeof(M=M||1.15)=="number"&&(ar=M),this},Sr=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return ar};Vr(t.lineHeight);var pr=h.__private__.getHorizontalCoordinate=function(M){return P(M)},jr=h.__private__.getVerticalCoordinate=function(M){return w===b?M:Ie[H].mediaBox.topRightY-Ie[H].mediaBox.bottomLeftY-P(M)},Tn=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(M){return S(pr(M))},Nn=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(M){return S(jr(M))},xn=t.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return Ne(xn)},h.__private__.setStrokeColor=h.setDrawColor=function(M,Fe,At,_t){return xn=Me({ch1:M,ch2:Fe,ch3:At,ch4:_t,pdfColorType:"draw",precision:2}),J(xn),this};var ua=t.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return Ne(ua)},h.__private__.setFillColor=h.setFillColor=function(M,Fe,At,_t){return ua=Me({ch1:M,ch2:Fe,ch3:At,ch4:_t,pdfColorType:"fill",precision:2}),J(ua),this};var ga=t.textColor||"0 g",Ji=h.__private__.getTextColor=h.getTextColor=function(){return Ne(ga)};h.__private__.setTextColor=h.setTextColor=function(M,Fe,At,_t){return ga=Me({ch1:M,ch2:Fe,ch3:At,ch4:_t,pdfColorType:"text",precision:3}),this};var Zi=t.charSpace,Ol=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Zi||0)};h.__private__.setCharSpace=h.setCharSpace=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Zi=M,this};var xa=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(M){var Fe=h.CapJoinStyles[M];if(Fe===void 0)throw new Error("Line cap style of '"+M+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return xa=Fe,J(Fe+" J"),this};var Qn=0;h.__private__.setLineJoin=h.setLineJoin=function(M){var Fe=h.CapJoinStyles[M];if(Fe===void 0)throw new Error("Line join style of '"+M+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qn=Fe,J(Fe+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(M){if(M=M||0,isNaN(M))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return J(S(P(M))+" M"),this},h.GState=P2,h.setGState=function(M){(M=typeof M=="string"?Ee[ye[M]]:hu(null,M)).equals(We)||(J("/"+M.id+" gs"),We=M)};var hu=function(M,Fe){if(!M||!ye[M]){var At=!1;for(var _t in Ee)if(Ee.hasOwnProperty(_t)&&Ee[_t].equals(Fe)){At=!0;break}if(At)Fe=Ee[_t];else{var Vt="GS"+(Object.keys(Ee).length+1).toString(10);Ee[Vt]=Fe,Fe.id=Vt}return M&&(ye[M]=Fe.id),xt.publish("addGState",Fe),Fe}};h.addGState=function(M,Fe){return hu(M,Fe),this},h.saveGraphicsState=function(){return J("q"),it.push({key:Je,size:Ye,color:ga}),this},h.restoreGraphicsState=function(){J("Q");var M=it.pop();return Je=M.key,Ye=M.size,ga=M.color,We=null,this},h.setCurrentTransformationMatrix=function(M){return J(M.toString()+" cm"),this},h.comment=function(M){return J("#"+M),this};var Dl=function(M,Fe){var At=M||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return At},set:function(hr){isNaN(hr)||(At=parseFloat(hr))}});var _t=Fe||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return _t},set:function(hr){isNaN(hr)||(_t=parseFloat(hr))}});var Vt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Vt},set:function(hr){Vt=hr.toString()}}),this},eo=function(M,Fe,At,_t){Dl.call(this,M,Fe),this.type="rect";var Vt=At||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Vt},set:function(yr){isNaN(yr)||(Vt=parseFloat(yr))}});var hr=_t||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return hr},set:function(yr){isNaN(yr)||(hr=parseFloat(yr))}}),this},Lc=function(){this.page=ge,this.currentPage=H,this.pages=be.slice(0),this.pagesContext=Ie.slice(0),this.x=ce,this.y=we,this.matrix=ue,this.width=ll(H),this.height=qA(H),this.outputDestination=ze,this.id="",this.objectNumber=-1};Lc.prototype.restore=function(){ge=this.page,H=this.currentPage,Ie=this.pagesContext,be=this.pages,ce=this.x,we=this.y,ue=this.matrix,Au(H,this.width),cl(H,this.height),ze=this.outputDestination};var Uc=function(M,Fe,At,_t,Vt){$t.push(new Lc),ge=H=0,be=[],ce=M,we=Fe,ue=Vt,_r([At,_t])};for(var fc in h.beginFormObject=function(M,Fe,At,_t,Vt){return Uc(M,Fe,At,_t,Vt),this},h.endFormObject=function(M){return function(Fe){if(Ut[Fe])$t.pop().restore();else{var At=new Lc,_t="Xo"+(Object.keys(It).length+1).toString(10);At.id=_t,Ut[Fe]=_t,It[_t]=At,xt.publish("addFormObject",At),$t.pop().restore()}}(M),this},h.doFormObject=function(M,Fe){var At=It[Ut[M]];return J("q"),J(Fe.toString()+" cm"),J("/"+At.id+" Do"),J("Q"),this},h.getFormObject=function(M){var Fe=It[Ut[M]];return{x:Fe.x,y:Fe.y,width:Fe.width,height:Fe.height,matrix:Fe.matrix}},h.save=function(M,Fe){return M=M||"generated.pdf",(Fe=Fe||{}).returnPromise=Fe.returnPromise||!1,Fe.returnPromise===!1?(hp(ir(Or()),M),typeof hp.unload=="function"&&Ln.setTimeout&&setTimeout(hp.unload,911),this):new Promise(function(At,_t){try{var Vt=hp(ir(Or()),M);typeof hp.unload=="function"&&Ln.setTimeout&&setTimeout(hp.unload,911),At(Vt)}catch(hr){_t(hr.message)}})},an.API)an.API.hasOwnProperty(fc)&&(fc==="events"&&an.API.events.length?function(M,Fe){var At,_t,Vt;for(Vt=Fe.length-1;Vt!==-1;Vt--)At=Fe[Vt][0],_t=Fe[Vt][1],M.subscribe.apply(M,[At].concat(typeof _t=="function"?[_t]:_t))}(xt,an.API.events):h[fc]=an.API[fc]);function ll(M){return Ie[M].mediaBox.topRightX-Ie[M].mediaBox.bottomLeftX}function Au(M,Fe){Ie[M].mediaBox.topRightX=Fe+Ie[M].mediaBox.bottomLeftX}function qA(M){return Ie[M].mediaBox.topRightY-Ie[M].mediaBox.bottomLeftY}function cl(M,Fe){Ie[M].mediaBox.topRightY=Fe+Ie[M].mediaBox.bottomLeftY}var Qc=h.getPageWidth=function(M){return ll(M=M||H)/dt},Bf=h.setPageWidth=function(M,Fe){Au(M,Fe*dt)},ho=h.getPageHeight=function(M){return qA(M=M||H)/dt},Wu=h.setPageHeight=function(M,Fe){cl(M,Fe*dt)};return h.internal={pdfEscape:nr,getStyle:nt,getFont:Yt,getFontSize:Ct,getCharSpace:Ol,getTextColor:Ji,getLineHeight:Yr,getLineHeightFactor:Sr,getLineWidth:ur,write:Re,getHorizontalCoordinate:pr,getVerticalCoordinate:jr,getCoordinateString:Tn,getVerticalCoordinateString:Nn,collections:{},newObject:ee,newAdditionalObject:V,newObjectDeferred:_e,newObjectDeferredBegin:R,getFilters:Ke,putStream:Pe,events:xt,scaleFactor:dt,pageSize:{getWidth:function(){return Qc(H)},setWidth:function(M){Bf(H,M)},getHeight:function(){return ho(H)},setHeight:function(M){Wu(H,M)}},encryptionOptions:d,encryption:Xr,getEncryptor:function(M){return d!==null?Xr.encryptor(M,0):function(Fe){return Fe}},output:br,getNumberOfPages:en,get pages(){return be},out:J,f2:k,f3:T,getPageInfo:Ir,getPageInfoByObjId:Pr,getCurrentPageInfo:fn,getPDFVersion:p,Point:Dl,Rectangle:eo,Matrix:Le,hasHotfix:wr},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Qc(H)},set:function(M){Bf(H,M)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return ho(H)},set:function(M){Wu(H,M)},enumerable:!0,configurable:!0}),(function(M){for(var Fe=0,At=Be.length;Fe<At;Fe++){var _t=Rt.call(this,M[Fe][0],M[Fe][1],M[Fe][2],Be[Fe][3],!0);f===!1&&(A[_t]=!0);var Vt=M[Fe][0].split("-");Nt({id:_t,fontName:Vt[0],fontStyle:Vt[1]||""})}xt.publish("addFonts",{fonts:ne,dictionary:Ve})}).call(h,Be),Je="F1",$r(a,r),xt.publish("initialized"),h}kx.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},kx.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},kx.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},kx.prototype.processOwnerPassword=function(t,e){return Gk($k(e).substr(0,5),t)},kx.prototype.encryptor=function(t,e){var r=$k(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Gk(r,n)}},P2.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||es(t)!==es(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},an.API={events:[]},an.version="3.0.4";var Ci=an.API,X6=1,Lg=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},hx=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},$n=function(t){return t.toFixed(2)},h0=function(t){return t.toFixed(5)};Ci.__acroform__={};var uu=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},jV=function(t){return t*X6},Hf=function(t){var e=new Ore,r=un.internal.getHeight(t)||0,n=un.internal.getWidth(t)||0;return e.BBox=[0,0,Number($n(n)),Number($n(r))],e},Gje=Ci.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},Kje=Ci.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},qje=Ci.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},$i=Ci.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return qje(t,e-1)},Gi=Ci.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Gje(t,e-1)},Ki=Ci.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Kje(t,e-1)},zje=Ci.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,a=t[0],s=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=r(a+o)||0,c.upperRight_Y=n(s)||0,[Number($n(c.lowerLeft_X)),Number($n(c.lowerLeft_Y)),Number($n(c.upperRight_X)),Number($n(c.upperRight_Y))]},Wje=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=Kk(t,r),a=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+a+" "+$n(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Hf(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},Kk=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},a=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");a=t.multiline?a.map(function(k){return k.split(`
`)}):a.map(function(k){return[k]});var s=r,o=un.internal.getHeight(t)||0;o=o<0?-o:o;var l=un.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(k,T,P){if(k+1<a.length){var K=T+" "+a[k+1][0];return RC(K,t,P).width<=l-4}return!1};s++;e:for(;s>0;){e="",s--;var u,d,f=RC("3",t,s).height,A=t.multiline?o-s:(o-f)/2,h=A+=2,m=0,p=0,x=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+RC(e,t,s=12).width+", FieldWidth:"+l+`
`;break}for(var v="",y=0,b=0;b<a.length;b++)if(a.hasOwnProperty(b)){var w=!1;if(a[b].length!==1&&x!==a[b].length-1){if((f+2)*(y+2)+2>o)continue e;v+=a[b][x],w=!0,p=b,b--}else{v=(v+=a[b][x]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var j=parseInt(b),I=c(j,v,s),C=b>=a.length-1;if(I&&!C){v+=" ",x=0;continue}if(I||C){if(C)p=j;else if(t.multiline&&(f+2)*(y+2)+2>o)continue e}else{if(!t.multiline||(f+2)*(y+2)+2>o)continue e;p=j}}for(var S="",E=m;E<=p;E++){var B=a[E];if(t.multiline){if(E===p){S+=B[x]+" ",x=(x+1)%B.length;continue}if(E===m){S+=B[B.length-1]+" ";continue}}S+=B[0]+" "}switch(S=S.substr(S.length-1)==" "?S.substr(0,S.length-1):S,d=RC(S,t,s).width,t.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;default:u=2}e+=$n(u)+" "+$n(h)+` Td
`,e+="("+Lg(S)+`) Tj
`,e+=-$n(u)+` 0 Td
`,h=-(s+2),d=0,m=w?p:p+1,y++,v=""}break}return n.text=e,n.fontSize=s,n},RC=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),a=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},Xje={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Yje=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},Jje=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(jf.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Xje)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");X6=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Dre,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];s.objId=void 0,s.hasAnnotation&&Yje(s,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,a){var s=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=zje(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=un.createDefaultAppearanceStream(l),es(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=Wje(l);c.push({key:"AP",value:"<</N "+d+">>"}),a.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var f="";for(var A in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(A)){var h=l.appearanceStreamContent[A];if(f+="/"+A+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var m=h[o];typeof m=="function"&&(m=m.call(a,l)),f+="/"+o+" "+m+" ",a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(a,l)),f+="/"+o+" "+m,a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}s&&function(p,x){for(var v in p)if(p.hasOwnProperty(v)){var y=v,b=p[v];x.internal.newObjectDeferredBegin(b.objId,!0),es(b)==="object"&&typeof b.putStream=="function"&&b.putStream(),delete p[y]}}(a.internal.acroformPlugin.xForms,a)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},Fre=Ci.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var a="[",s=0;s<t.length;s++)switch(s!==0&&(a+=" "),es(t[s])){case"boolean":case"number":case"object":a+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),a+="("+Lg(n(t[s].toString()))+")"):a+=t[s].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},m5=function(t,e,r){var n=function(a){return a};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+Lg(n(t))+")"},Zf=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Zf.prototype.toString=function(){return this.objId+" 0 R"},Zf.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Zf.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],a=this[n];a&&(Array.isArray(a)?t.push({key:n,value:Fre(a,this.objId,this.scope)}):a instanceof Zf?(a.scope=this.scope,t.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&t.push({key:n,value:a}))}return t};var Ore=function(){Zf.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};uu(Ore,Zf);var Dre=function(){Zf.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Lg(r(t))+")"}},set:function(r){t=r}})};uu(Dre,Zf);var jf=function t(){Zf.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');e=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!$i(e,3)},set:function(v){v?this.F=Gi(e,3):this.F=Ki(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');r=v}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(v){n=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(v){n[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(v){n[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(v){n[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(v){n[3]=v}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof OS)return;s="FieldObject"+t.FieldNum++}var v=function(y){return y};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+Lg(v(s))+")"},set:function(v){s=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(v){s=v}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(v){o=v}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(v){l=v}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(v){c=v}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/X6:u},set:function(v){u=v}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(v){d=v}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof OS||this instanceof Am))return m5(f,this.objId,this.scope)},set:function(v){v=v.toString(),f=v}});var A=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof _o==0?m5(A,this.objId,this.scope):A},set:function(v){v=v.toString(),A=this instanceof _o==0?v.substr(0,1)==="("?hx(v.substr(1,v.length-2)):hx(v):v}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof _o==1?hx(A.substr(1,A.length-1)):A},set:function(v){v=v.toString(),A=this instanceof _o==1?"/"+v:v}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof _o==0?m5(h,this.objId,this.scope):h},set:function(v){v=v.toString(),h=this instanceof _o==0?v.substr(0,1)==="("?hx(v.substr(1,v.length-2)):hx(v):v}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof _o==1?hx(h.substr(1,h.length-1)):h},set:function(v){v=v.toString(),h=this instanceof _o==1?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(v){v=!!v,p=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(v){m=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,1)},set:function(v){v?this.Ff=Gi(this.Ff,1):this.Ff=Ki(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,2)},set:function(v){v?this.Ff=Gi(this.Ff,2):this.Ff=Ki(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,3)},set:function(v){v?this.Ff=Gi(this.Ff,3):this.Ff=Ki(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');x=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(x){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:x=2;break;case"center":case 1:x=1;break;default:x=0}}})};uu(jf,Zf);var Up=function(){jf.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Fre(e,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),e=a}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,18)},set:function(r){r?this.Ff=Gi(this.Ff,18):this.Ff=Ki(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Gi(this.Ff,19):this.Ff=Ki(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,20)},set:function(r){r?(this.Ff=Gi(this.Ff,20),e.sort()):this.Ff=Ki(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,22)},set:function(r){r?this.Ff=Gi(this.Ff,22):this.Ff=Ki(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,23)},set:function(r){r?this.Ff=Gi(this.Ff,23):this.Ff=Ki(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,27)},set:function(r){r?this.Ff=Gi(this.Ff,27):this.Ff=Ki(this.Ff,27)}}),this.hasAppearanceStream=!1};uu(Up,jf);var Qp=function(){Up.call(this),this.fontName="helvetica",this.combo=!1};uu(Qp,Up);var Vp=function(){Qp.call(this),this.combo=!0};uu(Vp,Qp);var Ib=function(){Vp.call(this),this.edit=!0};uu(Ib,Vp);var _o=function(){jf.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,15)},set:function(r){r?this.Ff=Gi(this.Ff,15):this.Ff=Ki(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,16)},set:function(r){r?this.Ff=Gi(this.Ff,16):this.Ff=Ki(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,17)},set:function(r){r?this.Ff=Gi(this.Ff,17):this.Ff=Ki(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,26)},set:function(r){r?this.Ff=Gi(this.Ff,26):this.Ff=Ki(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,a=[];for(n in a.push("<<"),e)a.push("/"+n+" ("+Lg(r(e[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){es(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};uu(_o,jf);var jb=function(){_o.call(this),this.pushButton=!0};uu(jb,_o);var Hp=function(){_o.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};uu(Hp,_o);var OS=function(){var t,e;jf.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(a){e=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),n)o.push("/"+s+" ("+Lg(a(n[s]))+")");return o.push(">>"),o.join(`
`)},set:function(a){es(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=un.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};uu(OS,jf),Hp.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Hp.prototype.createOption=function(t){var e=new OS;return e.Parent=this,e.optionName=t,this.Kids.push(e),Zje.call(this.scope,e),e};var Pb=function(){_o.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=un.CheckBox.createAppearanceStream()};uu(Pb,_o);var Am=function(){jf.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,13)},set:function(e){e?this.Ff=Gi(this.Ff,13):this.Ff=Ki(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,21)},set:function(e){e?this.Ff=Gi(this.Ff,21):this.Ff=Ki(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,23)},set:function(e){e?this.Ff=Gi(this.Ff,23):this.Ff=Ki(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,24)},set:function(e){e?this.Ff=Gi(this.Ff,24):this.Ff=Ki(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,25)},set:function(e){e?this.Ff=Gi(this.Ff,25):this.Ff=Ki(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,26)},set:function(e){e?this.Ff=Gi(this.Ff,26):this.Ff=Ki(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};uu(Am,jf);var Tb=function(){Am.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!$i(this.Ff,14)},set:function(t){t?this.Ff=Gi(this.Ff,14):this.Ff=Ki(this.Ff,14)}}),this.password=!0};uu(Tb,Am);var un={CheckBox:{createAppearanceStream:function(){return{N:{On:un.CheckBox.YesNormal},D:{On:un.CheckBox.YesPushDown,Off:un.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Hf(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),s=Kk(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+$n(un.internal.getWidth(t))+" "+$n(un.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+$n(s.fontSize)+" Tf "+a),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Hf(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),a=[],s=un.internal.getHeight(t),o=un.internal.getWidth(t),l=Kk(t,t.caption);return a.push("1 g"),a.push("0 0 "+$n(o)+" "+$n(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+$n(o-1)+" "+$n(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+$n(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(t){var e=Hf(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+$n(un.internal.getWidth(t))+" "+$n(un.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:un.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=un.RadioButton.Circle.YesNormal,e.D[t]=un.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Hf(t);e.scope=t.scope;var r=[],n=un.internal.getWidth(t)<=un.internal.getHeight(t)?un.internal.getWidth(t)/4:un.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=un.internal.Bezier_C,s=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+h0(un.internal.getWidth(t)/2)+" "+h0(un.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Hf(t);e.scope=t.scope;var r=[],n=un.internal.getWidth(t)<=un.internal.getHeight(t)?un.internal.getWidth(t)/4:un.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*un.internal.Bezier_C).toFixed(5)),o=Number((n*un.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+h0(un.internal.getWidth(t)/2)+" "+h0(un.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+h0(un.internal.getWidth(t)/2)+" "+h0(un.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Hf(t);e.scope=t.scope;var r=[],n=un.internal.getWidth(t)<=un.internal.getHeight(t)?un.internal.getWidth(t)/4:un.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*un.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+h0(un.internal.getWidth(t)/2)+" "+h0(un.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:un.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=un.RadioButton.Cross.YesNormal,e.D[t]=un.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Hf(t);e.scope=t.scope;var r=[],n=un.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+$n(un.internal.getWidth(t)-2)+" "+$n(un.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push($n(n.x1.x)+" "+$n(n.x1.y)+" m"),r.push($n(n.x2.x)+" "+$n(n.x2.y)+" l"),r.push($n(n.x4.x)+" "+$n(n.x4.y)+" m"),r.push($n(n.x3.x)+" "+$n(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Hf(t);e.scope=t.scope;var r=un.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+$n(un.internal.getWidth(t))+" "+$n(un.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+$n(un.internal.getWidth(t)-2)+" "+$n(un.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push($n(r.x1.x)+" "+$n(r.x1.y)+" m"),n.push($n(r.x2.x)+" "+$n(r.x2.y)+" l"),n.push($n(r.x4.x)+" "+$n(r.x4.y)+" m"),n.push($n(r.x3.x)+" "+$n(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Hf(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+$n(un.internal.getWidth(t))+" "+$n(un.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};un.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=un.internal.getWidth(t),r=un.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},un.internal.getWidth=function(t){var e=0;return es(t)==="object"&&(e=jV(t.Rect[2])),e},un.internal.getHeight=function(t){var e=0;return es(t)==="object"&&(e=jV(t.Rect[3])),e};var Zje=Ci.addField=function(t){if(Jje(this,t),!(t instanceof jf))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Ci.AcroFormChoiceField=Up,Ci.AcroFormListBox=Qp,Ci.AcroFormComboBox=Vp,Ci.AcroFormEditBox=Ib,Ci.AcroFormButton=_o,Ci.AcroFormPushButton=jb,Ci.AcroFormRadioButton=Hp,Ci.AcroFormCheckBox=Pb,Ci.AcroFormTextField=Am,Ci.AcroFormPasswordField=Tb,Ci.AcroFormAppearance=un,Ci.AcroForm={ChoiceField:Up,ListBox:Qp,ComboBox:Vp,EditBox:Ib,Button:_o,PushButton:jb,RadioButton:Hp,CheckBox:Pb,TextField:Am,PasswordField:Tb,Appearance:un},an.AcroForm={ChoiceField:Up,ListBox:Qp,ComboBox:Vp,EditBox:Ib,Button:_o,PushButton:jb,RadioButton:Hp,CheckBox:Pb,TextField:Am,PasswordField:Tb,Appearance:un};var ePe=an.AcroForm;function Rre(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=t.__addimage__.getImageFileTypeByImageData=function(k,T){var P,K,le,oe,ie,Ae=r;if((T=T||r)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(I(k))for(ie in n)for(le=n[ie],P=0;P<le.length;P+=1){for(oe=!0,K=0;K<le[P].length;K+=1)if(le[P][K]!==void 0&&le[P][K]!==k[K]){oe=!1;break}if(oe===!0){Ae=ie;break}}else for(ie in n)for(le=n[ie],P=0;P<le.length;P+=1){for(oe=!0,K=0;K<le[P].length;K+=1)if(le[P][K]!==void 0&&le[P][K]!==k.charCodeAt(K)){oe=!1;break}if(oe===!0){Ae=ie;break}}return Ae===r&&T!==r&&(Ae=T),Ae},s=function k(T){for(var P=this.internal.write,K=this.internal.putStream,le=(0,this.internal.getFilters)();le.indexOf("FlateEncode")!==-1;)le.splice(le.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var oe=[];if(oe.push({key:"Type",value:"/XObject"}),oe.push({key:"Subtype",value:"/Image"}),oe.push({key:"Width",value:T.width}),oe.push({key:"Height",value:T.height}),T.colorSpace===v.INDEXED?oe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(oe.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===v.DEVICE_CMYK&&oe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),oe.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&oe.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var ie="",Ae=0,te=T.transparency.length;Ae<te;Ae++)ie+=T.transparency[Ae]+" "+T.transparency[Ae]+" ";oe.push({key:"Mask",value:"["+ie+"]"})}T.sMask!==void 0&&oe.push({key:"SMask",value:T.objectId+1+" 0 R"});var Te=T.filter!==void 0?["/"+T.filter]:void 0;if(K({data:T.data,additionalKeyValues:oe,alreadyAppliedFilters:Te,objectId:T.objectId}),P("endobj"),"sMask"in T&&T.sMask!==void 0){var Ue,O=(Ue=T.sMaskBitsPerComponent)!==null&&Ue!==void 0?Ue:T.bitsPerComponent,H={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:O,data:T.sMask};"filter"in T&&(H.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(O," /Columns ").concat(T.width),H.filter=T.filter),k.call(this,H)}if(T.colorSpace===v.INDEXED){var G=this.internal.newObject();K({data:S(new Uint8Array(T.palette)),objectId:G}),P("endobj")}},o=function(){var k=this.internal.collections[e+"images"];for(var T in k)s.call(this,k[T])},l=function(){var k,T=this.internal.collections[e+"images"],P=this.internal.write;for(var K in T)P("/I"+(k=T[K]).index,k.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var k=this.internal.collections[e+"images"];return c.call(this),k},d=function(){return Object.keys(this.internal.collections[e+"images"]).length},f=function(k){return typeof t["process"+k.toUpperCase()]=="function"},A=function(k){return es(k)==="object"&&k.nodeType===1},h=function(k,T){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var P=""+k.getAttribute("src");if(P.indexOf("data:image/")===0)return gE(unescape(P).split("base64,").pop());var K=t.loadFile(P,!0);if(K!==void 0)return K}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var le;switch(T){case"PNG":le="image/png";break;case"WEBP":le="image/webp";break;default:le="image/jpeg"}return gE(k.toDataURL(le,1).split("base64,").pop())}},m=function(k){var T=this.internal.collections[e+"images"];if(T){for(var P in T)if(k===T[P].alias)return T[P]}},p=function(k,T,P){return k||T||(k=-96,T=-96),k<0&&(k=-1*P.width*72/k/this.internal.scaleFactor),T<0&&(T=-1*P.height*72/T/this.internal.scaleFactor),k===0&&(k=T*P.width/P.height),T===0&&(T=k*P.height/P.width),[k,T]},x=function(k,T,P,K,le,oe){var ie=p.call(this,P,K,le),Ae=this.internal.getCoordinateString,te=this.internal.getVerticalCoordinateString,Te=u.call(this);if(P=ie[0],K=ie[1],Te[le.index]=le,oe){oe*=Math.PI/180;var Ue=Math.cos(oe),O=Math.sin(oe),H=function(L){return L.toFixed(4)},G=[H(Ue),H(O),H(-1*O),H(Ue),0,0,"cm"]}this.internal.write("q"),oe?(this.internal.write([1,"0","0",1,Ae(k),te(T+K),"cm"].join(" ")),this.internal.write(G.join(" ")),this.internal.write([Ae(P),"0","0",Ae(K),"0","0","cm"].join(" "))):this.internal.write([Ae(P),"0","0",Ae(K),Ae(k),te(T+K),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+le.index+" Do"),this.internal.write("Q")},v=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=t.__addimage__.sHashCode=function(k){var T,P,K=0;if(typeof k=="string")for(P=k.length,T=0;T<P;T++)K=(K<<5)-K+k.charCodeAt(T),K|=0;else if(I(k))for(P=k.byteLength/2,T=0;T<P;T++)K=(K<<5)-K+k[T],K|=0;return K},w=t.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var T=!0;return k.length===0&&(T=!1),k.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(T=!1),T},j=t.__addimage__.extractImageFromDataUrl=function(k){if(k==null||!(k=k.trim()).startsWith("data:"))return null;var T=k.indexOf(",");return T<0?null:k.substring(0,T).trim().endsWith("base64")?k.substring(T+1):null};t.__addimage__.isArrayBuffer=function(k){return k instanceof ArrayBuffer};var I=t.__addimage__.isArrayBufferView=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array},C=t.__addimage__.binaryStringToUint8Array=function(k){for(var T=k.length,P=new Uint8Array(T),K=0;K<T;K++)P[K]=k.charCodeAt(K);return P},S=t.__addimage__.arrayBufferToBinaryString=function(k){for(var T="",P=I(k)?k:new Uint8Array(k),K=0;K<P.length;K+=8192)T+=String.fromCharCode.apply(null,P.subarray(K,K+8192));return T};t.addImage=function(){var k,T,P,K,le,oe,ie,Ae,te;if(typeof arguments[1]=="number"?(T=r,P=arguments[1],K=arguments[2],le=arguments[3],oe=arguments[4],ie=arguments[5],Ae=arguments[6],te=arguments[7]):(T=arguments[1],P=arguments[2],K=arguments[3],le=arguments[4],oe=arguments[5],ie=arguments[6],Ae=arguments[7],te=arguments[8]),es(k=arguments[0])==="object"&&!A(k)&&"imageData"in k){var Te=k;k=Te.imageData,T=Te.format||T||r,P=Te.x||P||0,K=Te.y||K||0,le=Te.w||Te.width||le,oe=Te.h||Te.height||oe,ie=Te.alias||ie,Ae=Te.compression||Ae,te=Te.rotation||Te.angle||te}var Ue=this.internal.getFilters();if(Ae===void 0&&Ue.indexOf("FlateEncode")!==-1&&(Ae="SLOW"),isNaN(P)||isNaN(K))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var O=E.call(this,k,T,ie,Ae);return x.call(this,P,K,le,oe,O,te),this};var E=function(k,T,P,K){var le,oe,ie;if(typeof k=="string"&&a(k)===r){k=unescape(k);var Ae=B(k,!1);(Ae!==""||(Ae=t.loadFile(k,!0))!==void 0)&&(k=Ae)}if(A(k)&&(k=h(k,T)),T=a(k,T),!f(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((ie=P)==null||ie.length===0)&&(P=function(te){return typeof te=="string"||I(te)?b(te):I(te.data)?b(te.data):null}(k)),(le=m.call(this,P))||(k instanceof Uint8Array||T==="RGBA"||(oe=k,k=C(k)),le=this["process"+T.toUpperCase()](k,d.call(this),P,function(te){return te&&typeof te=="string"&&(te=te.toUpperCase()),te in t.image_compression?te:y.NONE}(K),oe)),!le)throw new Error("An unknown error occurred whilst processing the image.");return le},B=t.__addimage__.convertBase64ToBinaryString=function(k,T){T=typeof T!="boolean"||T;var P,K="";if(typeof k=="string"){var le;P=(le=j(k))!==null&&le!==void 0?le:k;try{K=gE(P)}catch(oe){if(T)throw w(P)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+oe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return K};t.getImageProperties=function(k){var T,P,K="";if(A(k)&&(k=h(k)),typeof k=="string"&&a(k)===r&&((K=B(k,!1))===""&&(K=t.loadFile(k)||""),k=K),P=a(k),!f(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(k instanceof Uint8Array||(k=C(k)),!(T=this["process"+P.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=P,T}})(an.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};an.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,a,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((n=u[f]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var A=0;A<u.length;A++){n=u[A];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(p.objId),y=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(v(n.contents))+")",s+=" /Popup "+x.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+h(v(y))+") >>",p.content=s;var b=p.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(s+=" /Open true"),s+=" >>",x.content=s,this.internal.write(p.objId,"0 R",x.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var w=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(m(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+w+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var j=this.annotations._nameMap[n.options.name];n.options.pageNumber=j.page,n.options.top=j.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var I=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+I+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,a,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+a),h:u(n+s)},options:o,type:"link"})},t.textWithLink=function(r,n,a,s){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(r,n,a,s),a+=.2*u,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,a-u,l,o,s),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(an.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(p){return e[p.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},l=t.__arabicParser__.isArabicEndLetter=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(p){return o(p)&&a.indexOf(p.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length==4},f=t.__arabicParser__.resolveLigatures=function(p){var x=0,v=r,y="",b=0;for(x=0;x<p.length;x+=1)v[p.charCodeAt(x)]!==void 0?(b++,typeof(v=v[p.charCodeAt(x)])=="number"&&(y+=String.fromCharCode(v),v=r,b=0),x===p.length-1&&(v=r,y+=p.charAt(x-(b-1)),x-=b-1,b=0)):(v=r,y+=p.charAt(x-b),x-=b,b=0);return y};t.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&n[p.charCodeAt(0)]!==void 0};var A=t.__arabicParser__.getCorrectForm=function(p,x,v){return o(p)?s(p)===!1?-1:!u(p)||!o(x)&&!o(v)||!o(v)&&l(x)||l(p)&&!o(x)||l(p)&&c(x)||l(p)&&l(x)?0:d(p)&&o(x)&&!l(x)&&o(v)&&u(v)?3:l(p)||!o(v)?1:2:-1},h=function(p){var x=0,v=0,y=0,b="",w="",j="",I=(p=p||"").split("\\s+"),C=[];for(x=0;x<I.length;x+=1){for(C.push(""),v=0;v<I[x].length;v+=1)b=I[x][v],w=I[x][v-1],j=I[x][v+1],o(b)?(y=A(b,w,j),C[x]+=y!==-1?String.fromCharCode(e[b.charCodeAt(0)][y]):b):C[x]+=b;C[x]=f(C[x])}return C.join(" ")},m=t.__arabicParser__.processArabic=t.processArabic=function(){var p,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(x)){var y=0;for(v=[],y=0;y<x.length;y+=1)Array.isArray(x[y])?v.push([h(x[y][0]),x[y][1],x[y][2]]):v.push([h(x[y])]);p=v}else p=h(x);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};t.events.push(["preProcessText",m])}(an.API),an.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(an.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(p){f=p}});var A=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return A},set:function(p){A=p}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(p){m=p}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),A=u.scaleFactor||this.internal.scaleFactor,h=0,m=0,p=0,x=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var v=u.maxWidth;v>0?typeof c=="string"?c=this.splitTextToSize(c,v):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(b,w){return b.concat(x.splitTextToSize(w,v))},[])):c=Array.isArray(c)?c:[c];for(var y=0;y<c.length;y++)h<(p=this.getStringUnitWidth(c[y],{font:f})*d)&&(h=p);return h!==0&&(m=c.length),{w:h/=A,h:Math.max((m*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/A,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||e,A=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,h&&A&&(this.printHeaderRow(c.lineNumber,!0),c.y+=A[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,d,f,A){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,m,p,x,v=[],y=[],b=[],w={},j={},I=[],C=[],S=(A=A||{}).autoSize||!1,E=A.printHeaders!==!1,B=A.css&&A.css["font-size"]!==void 0?16*A.css["font-size"]:A.fontSize||12,k=A.margins||Object.assign({width:this.getPageWidth()},e),T=typeof A.padding=="number"?A.padding:3,P=A.headerBackgroundColor||"#c8c8c8",K=A.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=E,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=P,this.internal.__cell__.headerTextColor=K,this.setFontSize(B),f==null)y=v=Object.keys(d[0]),b=v.map(function(){return"left"});else if(Array.isArray(f)&&es(f[0])==="object")for(v=f.map(function(Te){return Te.name}),y=f.map(function(Te){return Te.prompt||Te.name||""}),b=f.map(function(Te){return Te.align||"left"}),h=0;h<f.length;h+=1)j[f[h].name]=.7499990551181103*f[h].width;else Array.isArray(f)&&typeof f[0]=="string"&&(y=v=f,b=v.map(function(){return"left"}));if(S||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<v.length;h+=1){for(w[x=v[h]]=d.map(function(Te){return Te[x]}),this.setFont(void 0,"bold"),I.push(this.getTextDimensions(y[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=w[x],this.setFont(void 0,"normal"),p=0;p<m.length;p+=1)I.push(this.getTextDimensions(m[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);j[x]=Math.max.apply(null,I)+T+T,I=[]}if(E){var le={};for(h=0;h<v.length;h+=1)le[v[h]]={},le[v[h]].text=y[h],le[v[h]].align=b[h];var oe=l.call(this,le,j);C=v.map(function(Te){return new s(c,u,j[Te],oe,le[Te].text,void 0,le[Te].align)}),this.setTableHeaderRow(C),this.printHeaderRow(1,!1)}var ie=f.reduce(function(Te,Ue){return Te[Ue.name]=Ue.align,Te},{});for(h=0;h<d.length;h+=1){"rowStart"in A&&A.rowStart instanceof Function&&A.rowStart({row:h,data:d[h]},this);var Ae=l.call(this,d[h],j);for(p=0;p<v.length;p+=1){var te=d[h][v[p]];"cellStart"in A&&A.cellStart instanceof Function&&A.cellStart({row:h,col:p,data:te},this),o.call(this,new s(c,u,j[v[p]],Ae,te,h+2,ie[v[p]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,A=this.internal.scaleFactor;return Object.keys(c).map(function(h){var m=c[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,u[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/A+d+d},this).reduce(function(h,m){return Math.max(h,m)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var A=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,A.push(d)),d.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(m)}A.length>0&&this.setTableHeaderRow(A),this.setFont(void 0,"normal"),r=!1}}(an.API);var Mre={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Lre=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],qk=Rre(Lre),Ure=[100,200,300,400,500,600,700,800,900],tPe=Rre(Ure);function p5(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return Mre[s=s||"normal"]?s:"normal"}(t.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(t.weight),a=function(s){return typeof qk[s=s||"normal"]=="number"?s:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:a,src:t.src||[],ref:t.ref||{name:e,style:[a,r,n].join(" ")}}}function PV(t,e,r,n){var a;for(a=r;a>=0&&a<e.length;a+=n)if(t[e[a]])return t[e[a]];for(a=r;a>=0&&a<e.length;a-=n)if(t[e[a]])return t[e[a]]}var rPe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},TV={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function BV(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function kV(t){return t.trimLeft()}function nPe(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function aPe(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var MC,FV,OV,Ax,LC,DV,RV,MV,g5=["times"];function LV(t,e,r,n,a){var s=4,o=QV;switch(a){case an.API.image_compression.FAST:s=1,o=UV;break;case an.API.image_compression.MEDIUM:s=6,o=VV;break;case an.API.image_compression.SLOW:s=9,o=HV}t=function(c,u,d,f){for(var A,h=c.length/u,m=new Uint8Array(c.length+h),p=[sPe,UV,QV,VV,HV],x=0;x<h;x+=1){var v=x*u,y=c.subarray(v,v+u);if(f)m.set(f(y,d,A),v+x);else{for(var b=p.length,w=[],j=0;j<b;j+=1)w[j]=p[j](y,d,A);var I=oPe(w.concat());m.set(w[I],v+x)}A=y}return m}(t,e,Math.ceil(r*n/8),o);var l=Uk(t,{level:s});return an.API.__addimage__.arrayBufferToBinaryString(l)}function sPe(t){var e=Array.apply([],t);return e.unshift(0),e}function UV(t,e){var r=t.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var s=t[a-e]||0;n[a+1]=t[a]-s+256&255}return n}function QV(t,e,r){var n=t.length,a=[];a[0]=2;for(var s=0;s<n;s+=1){var o=r&&r[s]||0;a[s+1]=t[s]-o+256&255}return a}function VV(t,e,r){var n=t.length,a=[];a[0]=3;for(var s=0;s<n;s+=1){var o=t[s-e]||0,l=r&&r[s]||0;a[s+1]=t[s]+256-(o+l>>>1)&255}return a}function HV(t,e,r){var n=t.length,a=[];a[0]=4;for(var s=0;s<n;s+=1){var o=iPe(t[s-e]||0,r&&r[s]||0,r&&r[s-e]||0);a[s+1]=t[s]-o+256&255}return a}function iPe(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),a=Math.abs(t-r),s=Math.abs(t+e-r-r);return n<=a&&n<=s?t:a<=s?e:r}function oPe(t){var e=t.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return e.indexOf(Math.min.apply(null,e))}function x5(t,e,r){var n=e*r,a=Math.floor(n/8),s=16-(n-8*a+r),o=(1<<r)-1;return Qre(t,a)>>s&o}function $V(t,e,r,n){var a=r*n,s=Math.floor(a/8),o=16-(a-8*s+n),l=(1<<n)-1,c=(e&l)<<o;(function(u,d,f){if(d+1<u.byteLength)u.setUint16(d,f,!1);else{var A=f>>8&255;u.setUint8(d,A)}})(t,s,Qre(t,s)&~(l<<o)&65535|c)}function Qre(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function lPe(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,a=t[e++],s=a>>7,o=1<<1+(7&a);t[e++],t[e++];var l=null,c=null;s&&(l=e,c=o,e+=3*o);var u=!0,d=[],f=0,A=null,h=0,m=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,m=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var p=t[e++];f=t[e++]|t[e++]<<8,A=t[e++],1&p||(A=null),h=p>>2&7,e++;break;case 254:for(;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var x=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,w=t[e++],j=w>>6&1,I=1<<1+(7&w),C=l,S=c,E=!1;w>>7&&(E=!0,C=e,S=I,e+=3*I);var B=e;for(e++;;){var k;if(!((k=t[e++])>=0))throw Error("Invalid block size");if(k===0)break;e+=k}d.push({x,y:v,width:y,height:b,has_local_palette:E,palette_offset:C,palette_size:S,data_offset:B,data_length:e-B,transparent_index:A,interlaced:!!j,delay:f,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(T){if(T<0||T>=d.length)throw new Error("Frame index out of range.");return d[T]},this.decodeAndBlitFrameBGRA=function(T,P){var K=this.frameInfo(T),le=K.width*K.height,oe=new Uint8Array(le);GV(t,K.data_offset,oe,le);var ie=K.palette_offset,Ae=K.transparent_index;Ae===null&&(Ae=256);var te=K.width,Te=r-te,Ue=te,O=4*(K.y*r+K.x),H=4*((K.y+K.height)*r+K.x),G=O,L=4*Te;K.interlaced===!0&&(L+=4*r*7);for(var W=8,X=0,D=oe.length;X<D;++X){var Q=oe[X];if(Ue===0&&(Ue=te,(G+=L)>=H&&(L=4*Te+4*r*(W-1),G=O+(te+Te)*(W<<1),W>>=1)),Q===Ae)G+=4;else{var Z=t[ie+3*Q],be=t[ie+3*Q+1],U=t[ie+3*Q+2];P[G++]=U,P[G++]=be,P[G++]=Z,P[G++]=255}--Ue}},this.decodeAndBlitFrameRGBA=function(T,P){var K=this.frameInfo(T),le=K.width*K.height,oe=new Uint8Array(le);GV(t,K.data_offset,oe,le);var ie=K.palette_offset,Ae=K.transparent_index;Ae===null&&(Ae=256);var te=K.width,Te=r-te,Ue=te,O=4*(K.y*r+K.x),H=4*((K.y+K.height)*r+K.x),G=O,L=4*Te;K.interlaced===!0&&(L+=4*r*7);for(var W=8,X=0,D=oe.length;X<D;++X){var Q=oe[X];if(Ue===0&&(Ue=te,(G+=L)>=H&&(L=4*Te+4*r*(W-1),G=O+(te+Te)*(W<<1),W>>=1)),Q===Ae)G+=4;else{var Z=t[ie+3*Q],be=t[ie+3*Q+1],U=t[ie+3*Q+2];P[G++]=Z,P[G++]=be,P[G++]=U,P[G++]=255}--Ue}}}function GV(t,e,r,n){for(var a=t[e++],s=1<<a,o=s+1,l=o+1,c=a+1,u=(1<<c)-1,d=0,f=0,A=0,h=t[e++],m=new Int32Array(4096),p=null;;){for(;d<16&&h!==0;)f|=t[e++]<<d,d+=8,h===1?h=t[e++]:--h;if(d<c)break;var x=f&u;if(f>>=c,d-=c,x!==s){if(x===o)break;for(var v=x<l?x:p,y=0,b=v;b>s;)b=m[b]>>8,++y;var w=b;if(A+y+(v!==x?1:0)>n)return void hs.log("Warning, gif stream longer than expected.");r[A++]=w;var j=A+=y;for(v!==x&&(r[A++]=w),b=v;y--;)b=m[b],r[--j]=255&b,b>>=8;p!==null&&l<4096&&(m[l++]=p<<8|w,l>=u+1&&c<12&&(++c,u=u<<1|1)),p=x}else l=o+1,u=(1<<(c=a+1))-1,p=null}return A!==n&&hs.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function v5(t){var e,r,n,a,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),A=new Array(65535),h=new Array(64),m=new Array(64),p=[],x=0,v=7,y=new Array(64),b=new Array(64),w=new Array(64),j=new Array(256),I=new Array(2048),C=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],K=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],le=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function oe(O,H){for(var G=0,L=0,W=new Array,X=1;X<=16;X++){for(var D=1;D<=O[X];D++)W[H[L]]=[],W[H[L]][0]=G,W[H[L]][1]=X,L++,G++;G*=2}return W}function ie(O){for(var H=O[0],G=O[1]-1;G>=0;)H&1<<G&&(x|=1<<v),G--,--v<0&&(x==255?(Ae(255),Ae(0)):Ae(x),v=7,x=0)}function Ae(O){p.push(O)}function te(O){Ae(O>>8&255),Ae(255&O)}function Te(O,H,G,L,W){for(var X,D=W[0],Q=W[240],Z=function(Ye,ot){var Ct,jt,Ot,Tt,Qt,Ft,Qe,De,Je,dt,ce=0;for(Je=0;Je<8;++Je){Ct=Ye[ce],jt=Ye[ce+1],Ot=Ye[ce+2],Tt=Ye[ce+3],Qt=Ye[ce+4],Ft=Ye[ce+5],Qe=Ye[ce+6];var we=Ct+(De=Ye[ce+7]),ue=Ct-De,ne=jt+Qe,Ve=jt-Qe,it=Ot+Ft,vt=Ot-Ft,me=Tt+Qt,Ee=Tt-Qt,ye=we+me,We=we-me,ge=ne+it,Ie=ne-it;Ye[ce]=ye+ge,Ye[ce+4]=ye-ge;var xt=.707106781*(Ie+We);Ye[ce+2]=We+xt,Ye[ce+6]=We-xt;var Pt=.382683433*((ye=Ee+vt)-(Ie=Ve+ue)),It=.5411961*ye+Pt,Ut=1.306562965*Ie+Pt,$t=.707106781*(ge=vt+Ve),Le=ue+$t,Ce=ue-$t;Ye[ce+5]=Ce+It,Ye[ce+3]=Ce-It,Ye[ce+1]=Le+Ut,Ye[ce+7]=Le-Ut,ce+=8}for(ce=0,Je=0;Je<8;++Je){Ct=Ye[ce],jt=Ye[ce+8],Ot=Ye[ce+16],Tt=Ye[ce+24],Qt=Ye[ce+32],Ft=Ye[ce+40],Qe=Ye[ce+48];var pe=Ct+(De=Ye[ce+56]),He=Ct-De,he=jt+Qe,ee=jt-Qe,_e=Ot+Ft,R=Ot-Ft,V=Tt+Qt,q=Tt-Qt,se=pe+V,Ne=pe-V,Me=he+_e,Ke=he-_e;Ye[ce]=se+Me,Ye[ce+32]=se-Me;var Pe=.707106781*(Ke+Ne);Ye[ce+16]=Ne+Pe,Ye[ce+48]=Ne-Pe;var rt=.382683433*((se=q+R)-(Ke=ee+He)),lt=.5411961*se+rt,ht=1.306562965*Ke+rt,kt=.707106781*(Me=R+ee),de=He+kt,qe=He-kt;Ye[ce+40]=qe+lt,Ye[ce+24]=qe-lt,Ye[ce+8]=de+ht,Ye[ce+56]=de-ht,ce++}for(Je=0;Je<64;++Je)dt=Ye[Je]*ot[Je],h[Je]=dt>0?dt+.5|0:dt-.5|0;return h}(O,H),be=0;be<64;++be)m[C[be]]=Z[be];var U=m[0]-G;G=m[0],U==0?ie(L[0]):(ie(L[A[X=32767+U]]),ie(f[X]));for(var ze=63;ze>0&&m[ze]==0;)ze--;if(ze==0)return ie(D),G;for(var re,J=1;J<=ze;){for(var Re=J;m[J]==0&&J<=ze;)++J;var ke=J-Re;if(ke>=16){re=ke>>4;for(var Be=1;Be<=re;++Be)ie(Q);ke&=15}X=32767+m[J],ie(W[(ke<<4)+A[X]]),ie(f[X]),J++}return ze!=63&&ie(D),G}function Ue(O){O=Math.min(Math.max(O,1),100),s!=O&&(function(H){for(var G=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],L=0;L<64;L++){var W=o((G[L]*H+50)/100);W=Math.min(Math.max(W,1),255),l[C[L]]=W}for(var X=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],D=0;D<64;D++){var Q=o((X[D]*H+50)/100);Q=Math.min(Math.max(Q,1),255),c[C[D]]=Q}for(var Z=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],be=0,U=0;U<8;U++)for(var ze=0;ze<8;ze++)u[be]=1/(l[C[be]]*Z[U]*Z[ze]*8),d[be]=1/(c[C[be]]*Z[U]*Z[ze]*8),be++}(O<50?Math.floor(5e3/O):Math.floor(200-2*O)),s=O)}this.encode=function(O,H){H&&Ue(H),p=new Array,x=0,v=7,te(65496),te(65504),te(16),Ae(74),Ae(70),Ae(73),Ae(70),Ae(0),Ae(1),Ae(1),Ae(0),te(1),te(1),Ae(0),Ae(0),function(){te(65499),te(132),Ae(0);for(var jt=0;jt<64;jt++)Ae(l[jt]);Ae(1);for(var Ot=0;Ot<64;Ot++)Ae(c[Ot])}(),function(jt,Ot){te(65472),te(17),Ae(8),te(Ot),te(jt),Ae(3),Ae(1),Ae(17),Ae(0),Ae(2),Ae(17),Ae(1),Ae(3),Ae(17),Ae(1)}(O.width,O.height),function(){te(65476),te(418),Ae(0);for(var jt=0;jt<16;jt++)Ae(S[jt+1]);for(var Ot=0;Ot<=11;Ot++)Ae(E[Ot]);Ae(16);for(var Tt=0;Tt<16;Tt++)Ae(B[Tt+1]);for(var Qt=0;Qt<=161;Qt++)Ae(k[Qt]);Ae(1);for(var Ft=0;Ft<16;Ft++)Ae(T[Ft+1]);for(var Qe=0;Qe<=11;Qe++)Ae(P[Qe]);Ae(17);for(var De=0;De<16;De++)Ae(K[De+1]);for(var Je=0;Je<=161;Je++)Ae(le[Je])}(),te(65498),te(12),Ae(3),Ae(1),Ae(0),Ae(2),Ae(17),Ae(3),Ae(17),Ae(0),Ae(63),Ae(0);var G=0,L=0,W=0;x=0,v=7,this.encode.displayName="_encode_";for(var X,D,Q,Z,be,U,ze,re,J,Re=O.data,ke=O.width,Be=O.height,Ye=4*ke,ot=0;ot<Be;){for(X=0;X<Ye;){for(be=Ye*ot+X,ze=-1,re=0,J=0;J<64;J++)U=be+(re=J>>3)*Ye+(ze=4*(7&J)),ot+re>=Be&&(U-=Ye*(ot+1+re-Be)),X+ze>=Ye&&(U-=X+ze-Ye+4),D=Re[U++],Q=Re[U++],Z=Re[U++],y[J]=(I[D]+I[Q+256|0]+I[Z+512|0]>>16)-128,b[J]=(I[D+768|0]+I[Q+1024|0]+I[Z+1280|0]>>16)-128,w[J]=(I[D+1280|0]+I[Q+1536|0]+I[Z+1792|0]>>16)-128;G=Te(y,u,G,e,n),L=Te(b,d,L,r,a),W=Te(w,d,W,r,a),X+=32}ot+=8}if(v>=0){var Ct=[];Ct[1]=v+1,Ct[0]=(1<<v+1)-1,ie(Ct)}return te(65497),new Uint8Array(p)},t=t||50,function(){for(var O=String.fromCharCode,H=0;H<256;H++)j[H]=O(H)}(),e=oe(S,E),r=oe(T,P),n=oe(B,k),a=oe(K,le),function(){for(var O=1,H=2,G=1;G<=15;G++){for(var L=O;L<H;L++)A[32767+L]=G,f[32767+L]=[],f[32767+L][1]=G,f[32767+L][0]=L;for(var W=-(H-1);W<=-O;W++)A[32767+W]=G,f[32767+W]=[],f[32767+W][1]=G,f[32767+W][0]=H-1+W;O<<=1,H<<=1}}(),function(){for(var O=0;O<256;O++)I[O]=19595*O,I[O+256|0]=38470*O,I[O+512|0]=7471*O+32768,I[O+768|0]=-11059*O,I[O+1024|0]=-21709*O,I[O+1280|0]=32768*O+8421375,I[O+1536|0]=-27439*O,I[O+1792|0]=-5329*O}(),Ue(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Xd(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function KV(t){function e(E){if(!E)throw Error("assert :P")}function r(E,B,k){for(var T=0;4>T;T++)if(E[B+T]!=k.charCodeAt(T))return!0;return!1}function n(E,B,k,T,P){for(var K=0;K<P;K++)E[B+K]=k[T+K]}function a(E,B,k,T){for(var P=0;P<T;P++)E[B+P]=k}function s(E){return new Int32Array(E)}function o(E,B){for(var k=[],T=0;T<E;T++)k.push(new B);return k}function l(E,B){var k=[];return function T(P,K,le){for(var oe=le[K],ie=0;ie<oe&&(P.push(le.length>K+1?[]:new B),!(le.length<K+1));ie++)T(P[ie],K+1,le)}(k,0,E),k}var c=function(){var E=this;function B(N,F){for(var z=1<<F-1>>>0;N&z;)z>>>=1;return z?(N&z-1)+z:N}function k(N,F,z,ae,Oe){e(!(ae%z));do N[F+(ae-=z)]=Oe;while(0<ae)}function T(N,F,z,ae,Oe){if(e(2328>=Oe),512>=Oe)var $e=s(512);else if(($e=s(Oe))==null)return 0;return function(Ge,Xe,tt,mt,Bt,Jt){var pt,Lt,Kt=Xe,dr=1<<tt,Wt=s(16),mr=s(16);for(e(Bt!=0),e(mt!=null),e(Ge!=null),e(0<tt),Lt=0;Lt<Bt;++Lt){if(15<mt[Lt])return 0;++Wt[mt[Lt]]}if(Wt[0]==Bt)return 0;for(mr[1]=0,pt=1;15>pt;++pt){if(Wt[pt]>1<<pt)return 0;mr[pt+1]=mr[pt]+Wt[pt]}for(Lt=0;Lt<Bt;++Lt)pt=mt[Lt],0<mt[Lt]&&(Jt[mr[pt]++]=Lt);if(mr[15]==1)return(mt=new P).g=0,mt.value=Jt[0],k(Ge,Kt,1,dr,mt),dr;var gr,Br=-1,Cr=dr-1,bn=0,cn=1,Yn=1,mn=1<<tt;for(Lt=0,pt=1,Bt=2;pt<=tt;++pt,Bt<<=1){if(cn+=Yn<<=1,0>(Yn-=Wt[pt]))return 0;for(;0<Wt[pt];--Wt[pt])(mt=new P).g=pt,mt.value=Jt[Lt++],k(Ge,Kt+bn,Bt,mn,mt),bn=B(bn,pt)}for(pt=tt+1,Bt=2;15>=pt;++pt,Bt<<=1){if(cn+=Yn<<=1,0>(Yn-=Wt[pt]))return 0;for(;0<Wt[pt];--Wt[pt]){if(mt=new P,(bn&Cr)!=Br){for(Kt+=mn,gr=1<<(Br=pt)-tt;15>Br&&!(0>=(gr-=Wt[Br]));)++Br,gr<<=1;dr+=mn=1<<(gr=Br-tt),Ge[Xe+(Br=bn&Cr)].g=gr+tt,Ge[Xe+Br].value=Kt-Xe-Br}mt.g=pt-tt,mt.value=Jt[Lt++],k(Ge,Kt+(bn>>tt),Bt,mn,mt),bn=B(bn,pt)}}return cn!=2*mr[15]-1?0:dr}(N,F,z,ae,Oe,$e)}function P(){this.value=this.g=0}function K(){this.value=this.g=0}function le(){this.G=o(5,P),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(zm,K)}function oe(N,F,z,ae){e(N!=null),e(F!=null),e(2147483648>ae),N.Ca=254,N.I=0,N.b=-8,N.Ka=0,N.oa=F,N.pa=z,N.Jd=F,N.Yc=z+ae,N.Zc=4<=ae?z+ae-4+1:z,D(N)}function ie(N,F){for(var z=0;0<F--;)z|=Z(N,128)<<F;return z}function Ae(N,F){var z=ie(N,F);return Q(N)?-z:z}function te(N,F,z,ae){var Oe,$e=0;for(e(N!=null),e(F!=null),e(4294967288>ae),N.Sb=ae,N.Ra=0,N.u=0,N.h=0,4<ae&&(ae=4),Oe=0;Oe<ae;++Oe)$e+=F[z+Oe]<<8*Oe;N.Ra=$e,N.bb=ae,N.oa=F,N.pa=z}function Te(N){for(;8<=N.u&&N.bb<N.Sb;)N.Ra>>>=8,N.Ra+=N.oa[N.pa+N.bb]<<WA-8>>>0,++N.bb,N.u-=8;L(N)&&(N.h=1,N.u=0)}function Ue(N,F){if(e(0<=F),!N.h&&F<=gu){var z=G(N)&pu[F];return N.u+=F,Te(N),z}return N.h=1,N.u=0}function O(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function H(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function G(N){return N.Ra>>>(N.u&WA-1)>>>0}function L(N){return e(N.bb<=N.Sb),N.h||N.bb==N.Sb&&N.u>WA}function W(N,F){N.u=F,N.h=L(N)}function X(N){N.u>=bh&&(e(N.u>=bh),Te(N))}function D(N){e(N!=null&&N.oa!=null),N.pa<N.Zc?(N.I=(N.oa[N.pa++]|N.I<<8)>>>0,N.b+=8):(e(N!=null&&N.oa!=null),N.pa<N.Yc?(N.b+=8,N.I=N.oa[N.pa++]|N.I<<8):N.Ka?N.b=0:(N.I<<=8,N.b+=8,N.Ka=1))}function Q(N){return ie(N,1)}function Z(N,F){var z=N.Ca;0>N.b&&D(N);var ae=N.b,Oe=z*F>>>8,$e=(N.I>>>ae>Oe)+0;for($e?(z-=Oe,N.I-=Oe+1<<ae>>>0):z=Oe+1,ae=z,Oe=0;256<=ae;)Oe+=8,ae>>=8;return ae=7^Oe+XA[ae],N.b-=ae,N.Ca=(z<<ae)-1,$e}function be(N,F,z){N[F+0]=z>>24&255,N[F+1]=z>>16&255,N[F+2]=z>>8&255,N[F+3]=255&z}function U(N,F){return N[F+0]|N[F+1]<<8}function ze(N,F){return U(N,F)|N[F+2]<<16}function re(N,F){return U(N,F)|U(N,F+2)<<16}function J(N,F){var z=1<<F;return e(N!=null),e(0<F),N.X=s(z),N.X==null?0:(N.Mb=32-F,N.Xa=F,1)}function Re(N,F){e(N!=null),e(F!=null),e(N.Xa==F.Xa),n(F.X,0,N.X,0,1<<F.Xa)}function ke(){this.X=[],this.Xa=this.Mb=0}function Be(N,F,z,ae){e(z!=null),e(ae!=null);var Oe=z[0],$e=ae[0];return Oe==0&&(Oe=(N*$e+F/2)/F),$e==0&&($e=(F*Oe+N/2)/N),0>=Oe||0>=$e?0:(z[0]=Oe,ae[0]=$e,1)}function Ye(N,F){return N+(1<<F)-1>>>F}function ot(N,F){return((4278255360&N)+(4278255360&F)>>>0&4278255360)+((16711935&N)+(16711935&F)>>>0&16711935)>>>0}function Ct(N,F){E[F]=function(z,ae,Oe,$e,Ge,Xe,tt){var mt;for(mt=0;mt<Ge;++mt){var Bt=E[N](Xe[tt+mt-1],Oe,$e+mt);Xe[tt+mt]=ot(z[ae+mt],Bt)}}}function jt(){this.ud=this.hd=this.jd=0}function Ot(N,F){return((4278124286&(N^F))>>>1)+(N&F)>>>0}function Tt(N){return 0<=N&&256>N?N:0>N?0:255<N?255:void 0}function Qt(N,F){return Tt(N+(N-F+.5>>1))}function Ft(N,F,z){return Math.abs(F-z)-Math.abs(N-z)}function Qe(N,F,z,ae,Oe,$e,Ge){for(ae=$e[Ge-1],z=0;z<Oe;++z)$e[Ge+z]=ae=ot(N[F+z],ae)}function De(N,F,z,ae,Oe){var $e;for($e=0;$e<z;++$e){var Ge=N[F+$e],Xe=Ge>>8&255,tt=16711935&(tt=(tt=16711935&Ge)+((Xe<<16)+Xe));ae[Oe+$e]=(4278255360&Ge)+tt>>>0}}function Je(N,F){F.jd=255&N,F.hd=N>>8&255,F.ud=N>>16&255}function dt(N,F,z,ae,Oe,$e){var Ge;for(Ge=0;Ge<ae;++Ge){var Xe=F[z+Ge],tt=Xe>>>8,mt=Xe,Bt=255&(Bt=(Bt=Xe>>>16)+((N.jd<<24>>24)*(tt<<24>>24)>>>5));mt=255&(mt=(mt+=(N.hd<<24>>24)*(tt<<24>>24)>>>5)+((N.ud<<24>>24)*(Bt<<24>>24)>>>5)),Oe[$e+Ge]=(4278255360&Xe)+(Bt<<16)+mt}}function ce(N,F,z,ae,Oe){E[F]=function($e,Ge,Xe,tt,mt,Bt,Jt,pt,Lt){for(tt=Jt;tt<pt;++tt)for(Jt=0;Jt<Lt;++Jt)mt[Bt++]=Oe(Xe[ae($e[Ge++])])},E[N]=function($e,Ge,Xe,tt,mt,Bt,Jt){var pt=8>>$e.b,Lt=$e.Ea,Kt=$e.K[0],dr=$e.w;if(8>pt)for($e=(1<<$e.b)-1,dr=(1<<pt)-1;Ge<Xe;++Ge){var Wt,mr=0;for(Wt=0;Wt<Lt;++Wt)Wt&$e||(mr=ae(tt[mt++])),Bt[Jt++]=Oe(Kt[mr&dr]),mr>>=pt}else E["VP8LMapColor"+z](tt,mt,Kt,dr,Bt,Jt,Ge,Xe,Lt)}}function we(N,F,z,ae,Oe){for(z=F+z;F<z;){var $e=N[F++];ae[Oe++]=$e>>16&255,ae[Oe++]=$e>>8&255,ae[Oe++]=255&$e}}function ue(N,F,z,ae,Oe){for(z=F+z;F<z;){var $e=N[F++];ae[Oe++]=$e>>16&255,ae[Oe++]=$e>>8&255,ae[Oe++]=255&$e,ae[Oe++]=$e>>24&255}}function ne(N,F,z,ae,Oe){for(z=F+z;F<z;){var $e=(Ge=N[F++])>>16&240|Ge>>12&15,Ge=240&Ge|Ge>>28&15;ae[Oe++]=$e,ae[Oe++]=Ge}}function Ve(N,F,z,ae,Oe){for(z=F+z;F<z;){var $e=(Ge=N[F++])>>16&248|Ge>>13&7,Ge=Ge>>5&224|Ge>>3&31;ae[Oe++]=$e,ae[Oe++]=Ge}}function it(N,F,z,ae,Oe){for(z=F+z;F<z;){var $e=N[F++];ae[Oe++]=255&$e,ae[Oe++]=$e>>8&255,ae[Oe++]=$e>>16&255}}function vt(N,F,z,ae,Oe,$e){if($e==0)for(z=F+z;F<z;)be(ae,(($e=N[F++])[0]>>24|$e[1]>>8&65280|$e[2]<<8&16711680|$e[3]<<24)>>>0),Oe+=32;else n(ae,Oe,N,F,z)}function me(N,F){E[F][0]=E[N+"0"],E[F][1]=E[N+"1"],E[F][2]=E[N+"2"],E[F][3]=E[N+"3"],E[F][4]=E[N+"4"],E[F][5]=E[N+"5"],E[F][6]=E[N+"6"],E[F][7]=E[N+"7"],E[F][8]=E[N+"8"],E[F][9]=E[N+"9"],E[F][10]=E[N+"10"],E[F][11]=E[N+"11"],E[F][12]=E[N+"12"],E[F][13]=E[N+"13"],E[F][14]=E[N+"0"],E[F][15]=E[N+"0"]}function Ee(N){return N==B4||N==k4||N==EN||N==F4}function ye(){this.eb=[],this.size=this.A=this.fb=0}function We(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ge(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ye,this.f.kb=new We,this.sd=null}function Ie(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function xt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Pt(N){return alert("todo:WebPSamplerProcessPlane"),N.T}function It(N,F){var z=N.T,ae=F.ba.f.RGBA,Oe=ae.eb,$e=ae.fb+N.ka*ae.A,Ge=ed[F.ba.S],Xe=N.y,tt=N.O,mt=N.f,Bt=N.N,Jt=N.ea,pt=N.W,Lt=F.cc,Kt=F.dc,dr=F.Mc,Wt=F.Nc,mr=N.ka,gr=N.ka+N.T,Br=N.U,Cr=Br+1>>1;for(mr==0?Ge(Xe,tt,null,null,mt,Bt,Jt,pt,mt,Bt,Jt,pt,Oe,$e,null,null,Br):(Ge(F.ec,F.fc,Xe,tt,Lt,Kt,dr,Wt,mt,Bt,Jt,pt,Oe,$e-ae.A,Oe,$e,Br),++z);mr+2<gr;mr+=2)Lt=mt,Kt=Bt,dr=Jt,Wt=pt,Bt+=N.Rc,pt+=N.Rc,$e+=2*ae.A,Ge(Xe,(tt+=2*N.fa)-N.fa,Xe,tt,Lt,Kt,dr,Wt,mt,Bt,Jt,pt,Oe,$e-ae.A,Oe,$e,Br);return tt+=N.fa,N.j+gr<N.o?(n(F.ec,F.fc,Xe,tt,Br),n(F.cc,F.dc,mt,Bt,Cr),n(F.Mc,F.Nc,Jt,pt,Cr),z--):1&gr||Ge(Xe,tt,null,null,mt,Bt,Jt,pt,mt,Bt,Jt,pt,Oe,$e+ae.A,null,null,Br),z}function Ut(N,F,z){var ae=N.F,Oe=[N.J];if(ae!=null){var $e=N.U,Ge=F.ba.S,Xe=Ge==_N||Ge==EN;F=F.ba.f.RGBA;var tt=[0],mt=N.ka;tt[0]=N.T,N.Kb&&(mt==0?--tt[0]:(--mt,Oe[0]-=N.width),N.j+N.ka+N.T==N.o&&(tt[0]=N.o-N.j-mt));var Bt=F.eb;mt=F.fb+mt*F.A,N=Z8(ae,Oe[0],N.width,$e,tt,Bt,mt+(Xe?0:3),F.A),e(z==tt),N&&Ee(Ge)&&H1(Bt,mt,Xe,$e,tt,F.A)}return 0}function $t(N){var F=N.ma,z=F.ba.S,ae=11>z,Oe=z==NN||z==CN||z==_N||z==T4||z==12||Ee(z);if(F.memory=null,F.Ib=null,F.Jb=null,F.Nd=null,!O1(F.Oa,N,Oe?11:12))return 0;if(Oe&&Ee(z)&&Yu(),N.da)alert("todo:use_scaling");else{if(ae){if(F.Ib=Pt,N.Kb){if(z=N.U+1>>1,F.memory=s(N.U+2*z),F.memory==null)return 0;F.ec=F.memory,F.fc=0,F.cc=F.ec,F.dc=F.fc+N.U,F.Mc=F.cc,F.Nc=F.dc+z,F.Ib=It,Yu()}}else alert("todo:EmitYUV");Oe&&(F.Jb=Ut,ae&&Vc())}if(ae&&!mL){for(N=0;256>N;++N)Bde[N]=89858*(N-128)+IN>>SN,Ode[N]=-22014*(N-128)+IN,Fde[N]=-45773*(N-128),kde[N]=113618*(N-128)+IN>>SN;for(N=G1;N<R4;++N)F=76283*(N-16)+IN>>SN,Dde[N-G1]=Er(F,255),Rde[N-G1]=Er(F+8>>4,15);mL=1}return 1}function Le(N){var F=N.ma,z=N.U,ae=N.T;return e(!(1&N.ka)),0>=z||0>=ae?0:(z=F.Ib(N,F),F.Jb!=null&&F.Jb(N,F,z),F.Dc+=z,1)}function Ce(N){N.ma.memory=null}function pe(N,F,z,ae){return Ue(N,8)!=47?0:(F[0]=Ue(N,14)+1,z[0]=Ue(N,14)+1,ae[0]=Ue(N,1),Ue(N,3)!=0?0:!N.h)}function He(N,F){if(4>N)return N+1;var z=N-2>>1;return(2+(1&N)<<z)+Ue(F,z)+1}function he(N,F){return 120<F?F-120:1<=(z=((z=xde[F-1])>>4)*N+(8-(15&z)))?z:1;var z}function ee(N,F,z){var ae=G(z),Oe=N[F+=255&ae].g-8;return 0<Oe&&(W(z,z.u+8),ae=G(z),F+=N[F].value,F+=ae&(1<<Oe)-1),W(z,z.u+N[F].g),N[F].value}function _e(N,F,z){return z.g+=N.g,z.value+=N.value<<F>>>0,e(8>=z.g),N.g}function R(N,F,z){var ae=N.xc;return e((F=ae==0?0:N.vc[N.md*(z>>ae)+(F>>ae)])<N.Wb),N.Ya[F]}function V(N,F,z,ae){var Oe=N.ab,$e=N.c*F,Ge=N.C;F=Ge+F;var Xe=z,tt=ae;for(ae=N.Ta,z=N.Ua;0<Oe--;){var mt=N.gc[Oe],Bt=Ge,Jt=F,pt=Xe,Lt=tt,Kt=(tt=ae,Xe=z,mt.Ea);switch(e(Bt<Jt),e(Jt<=mt.nc),mt.hc){case 2:Bi(pt,Lt,(Jt-Bt)*Kt,tt,Xe);break;case 0:var dr=Bt,Wt=Jt,mr=tt,gr=Xe,Br=(mn=mt).Ea;dr==0&&(R1(pt,Lt,null,null,1,mr,gr),Qe(pt,Lt+1,0,0,Br-1,mr,gr+1),Lt+=Br,gr+=Br,++dr);for(var Cr=1<<mn.b,bn=Cr-1,cn=Ye(Br,mn.b),Yn=mn.K,mn=mn.w+(dr>>mn.b)*cn;dr<Wt;){var pa=Yn,mo=mn,Jn=1;for(Yg(pt,Lt,mr,gr-Br,1,mr,gr);Jn<Br;){var pn=(Jn&~bn)+Cr;pn>Br&&(pn=Br),(0,L1[pa[mo++]>>8&15])(pt,Lt+ +Jn,mr,gr+Jn-Br,pn-Jn,mr,gr+Jn),Jn=pn}Lt+=Br,gr+=Br,++dr&bn||(mn+=cn)}Jt!=mt.nc&&n(tt,Xe-Kt,tt,Xe+(Jt-Bt-1)*Kt,Kt);break;case 1:for(Kt=pt,Wt=Lt,Br=(pt=mt.Ea)-(gr=pt&~(mr=(Lt=1<<mt.b)-1)),dr=Ye(pt,mt.b),Cr=mt.K,mt=mt.w+(Bt>>mt.b)*dr;Bt<Jt;){for(bn=Cr,cn=mt,Yn=new jt,mn=Wt+gr,pa=Wt+pt;Wt<mn;)Je(bn[cn++],Yn),U1(Yn,Kt,Wt,Lt,tt,Xe),Wt+=Lt,Xe+=Lt;Wt<pa&&(Je(bn[cn++],Yn),U1(Yn,Kt,Wt,Br,tt,Xe),Wt+=Br,Xe+=Br),++Bt&mr||(mt+=dr)}break;case 3:if(pt==tt&&Lt==Xe&&0<mt.b){for(Wt=tt,pt=Kt=Xe+(Jt-Bt)*Kt-(gr=(Jt-Bt)*Ye(mt.Ea,mt.b)),Lt=tt,mr=Xe,dr=[],gr=(Br=gr)-1;0<=gr;--gr)dr[gr]=Lt[mr+gr];for(gr=Br-1;0<=gr;--gr)Wt[pt+gr]=dr[gr];vN(mt,Bt,Jt,tt,Kt,tt,Xe)}else vN(mt,Bt,Jt,pt,Lt,tt,Xe)}Xe=ae,tt=z}tt!=z&&n(ae,z,Xe,tt,$e)}function q(N,F){var z=N.V,ae=N.Ba+N.c*N.C,Oe=F-N.C;if(e(F<=N.l.o),e(16>=Oe),0<Oe){var $e=N.l,Ge=N.Ta,Xe=N.Ua,tt=$e.width;if(V(N,Oe,z,ae),Oe=Xe=[Xe],e((z=N.C)<(ae=F)),e($e.v<$e.va),ae>$e.o&&(ae=$e.o),z<$e.j){var mt=$e.j-z;z=$e.j,Oe[0]+=mt*tt}if(z>=ae?z=0:(Oe[0]+=4*$e.v,$e.ka=z-$e.j,$e.U=$e.va-$e.v,$e.T=ae-z,z=1),z){if(Xe=Xe[0],11>(z=N.ca).S){var Bt=z.f.RGBA,Jt=(ae=z.S,Oe=$e.U,$e=$e.T,mt=Bt.eb,Bt.A),pt=$e;for(Bt=Bt.fb+N.Ma*Bt.A;0<pt--;){var Lt=Ge,Kt=Xe,dr=Oe,Wt=mt,mr=Bt;switch(ae){case wN:Q1(Lt,Kt,dr,Wt,mr);break;case NN:YA(Lt,Kt,dr,Wt,mr);break;case B4:YA(Lt,Kt,dr,Wt,mr),H1(Wt,mr,0,dr,1,0);break;case iL:Wm(Lt,Kt,dr,Wt,mr);break;case CN:vt(Lt,Kt,dr,Wt,mr,1);break;case k4:vt(Lt,Kt,dr,Wt,mr,1),H1(Wt,mr,0,dr,1,0);break;case _N:vt(Lt,Kt,dr,Wt,mr,0);break;case EN:vt(Lt,Kt,dr,Wt,mr,0),H1(Wt,mr,1,dr,1,0);break;case T4:JA(Lt,Kt,dr,Wt,mr);break;case F4:JA(Lt,Kt,dr,Wt,mr),J8(Wt,mr,dr,1,0);break;case oL:ZA(Lt,Kt,dr,Wt,mr);break;default:e(0)}Xe+=tt,Bt+=Jt}N.Ma+=$e}else alert("todo:EmitRescaledRowsYUVA");e(N.Ma<=z.height)}}N.C=F,e(N.C<=N.i)}function se(N){var F;if(0<N.ua)return 0;for(F=0;F<N.Wb;++F){var z=N.Ya[F].G,ae=N.Ya[F].H;if(0<z[1][ae[1]+0].g||0<z[2][ae[2]+0].g||0<z[3][ae[3]+0].g)return 0}return 1}function Ne(N,F,z,ae,Oe,$e){if(N.Z!=0){var Ge=N.qd,Xe=N.rd;for(e(r0[N.Z]!=null);F<z;++F)r0[N.Z](Ge,Xe,ae,Oe,ae,Oe,$e),Ge=ae,Xe=Oe,Oe+=$e;N.qd=Ge,N.rd=Xe}}function Me(N,F){var z=N.l.ma,ae=z.Z==0||z.Z==1?N.l.j:N.C;if(ae=N.C<ae?ae:N.C,e(F<=N.l.o),F>ae){var Oe=N.l.width,$e=z.ca,Ge=z.tb+Oe*ae,Xe=N.V,tt=N.Ba+N.c*ae,mt=N.gc;e(N.ab==1),e(mt[0].hc==3),Ff(mt[0],ae,F,Xe,tt,$e,Ge),Ne(z,ae,F,$e,Ge,Oe)}N.C=N.Ma=F}function Ke(N,F,z,ae,Oe,$e,Ge){var Xe=N.$/ae,tt=N.$%ae,mt=N.m,Bt=N.s,Jt=z+N.$,pt=Jt;Oe=z+ae*Oe;var Lt=z+ae*$e,Kt=280+Bt.ua,dr=N.Pb?Xe:16777216,Wt=0<Bt.ua?Bt.Wa:null,mr=Bt.wc,gr=Jt<Lt?R(Bt,tt,Xe):null;e(N.C<$e),e(Lt<=Oe);var Br=!1;e:for(;;){for(;Br||Jt<Lt;){var Cr=0;if(Xe>=dr){var bn=Jt-z;e((dr=N).Pb),dr.wd=dr.m,dr.xd=bn,0<dr.s.ua&&Re(dr.s.Wa,dr.s.vb),dr=Xe+yde}if(tt&mr||(gr=R(Bt,tt,Xe)),e(gr!=null),gr.Qb&&(F[Jt]=gr.qb,Br=!0),!Br)if(X(mt),gr.jc){Cr=mt,bn=F;var cn=Jt,Yn=gr.pd[G(Cr)&zm-1];e(gr.jc),256>Yn.g?(W(Cr,Cr.u+Yn.g),bn[cn]=Yn.value,Cr=0):(W(Cr,Cr.u+Yn.g-256),e(256<=Yn.value),Cr=Yn.value),Cr==0&&(Br=!0)}else Cr=ee(gr.G[0],gr.H[0],mt);if(mt.h)break;if(Br||256>Cr){if(!Br)if(gr.nd)F[Jt]=(gr.qb|Cr<<8)>>>0;else{if(X(mt),Br=ee(gr.G[1],gr.H[1],mt),X(mt),bn=ee(gr.G[2],gr.H[2],mt),cn=ee(gr.G[3],gr.H[3],mt),mt.h)break;F[Jt]=(cn<<24|Br<<16|Cr<<8|bn)>>>0}if(Br=!1,++Jt,++tt>=ae&&(tt=0,++Xe,Ge!=null&&Xe<=$e&&!(Xe%16)&&Ge(N,Xe),Wt!=null))for(;pt<Jt;)Cr=F[pt++],Wt.X[(506832829*Cr&4294967295)>>>Wt.Mb]=Cr}else if(280>Cr){if(Cr=He(Cr-256,mt),bn=ee(gr.G[4],gr.H[4],mt),X(mt),bn=he(ae,bn=He(bn,mt)),mt.h)break;if(Jt-z<bn||Oe-Jt<Cr)break e;for(cn=0;cn<Cr;++cn)F[Jt+cn]=F[Jt+cn-bn];for(Jt+=Cr,tt+=Cr;tt>=ae;)tt-=ae,++Xe,Ge!=null&&Xe<=$e&&!(Xe%16)&&Ge(N,Xe);if(e(Jt<=Oe),tt&mr&&(gr=R(Bt,tt,Xe)),Wt!=null)for(;pt<Jt;)Cr=F[pt++],Wt.X[(506832829*Cr&4294967295)>>>Wt.Mb]=Cr}else{if(!(Cr<Kt))break e;for(Br=Cr-280,e(Wt!=null);pt<Jt;)Cr=F[pt++],Wt.X[(506832829*Cr&4294967295)>>>Wt.Mb]=Cr;Cr=Jt,e(!(Br>>>(bn=Wt).Xa)),F[Cr]=bn.X[Br],Br=!0}Br||e(mt.h==L(mt))}if(N.Pb&&mt.h&&Jt<Oe)e(N.m.h),N.a=5,N.m=N.wd,N.$=N.xd,0<N.s.ua&&Re(N.s.vb,N.s.Wa);else{if(mt.h)break e;Ge!=null&&Ge(N,Xe>$e?$e:Xe),N.a=0,N.$=Jt-z}return 1}return N.a=3,0}function Pe(N){e(N!=null),N.vc=null,N.yc=null,N.Ya=null;var F=N.Wa;F!=null&&(F.X=null),N.vb=null,e(N!=null)}function rt(){var N=new Bn;return N==null?null:(N.a=0,N.xb=uL,me("Predictor","VP8LPredictors"),me("Predictor","VP8LPredictors_C"),me("PredictorAdd","VP8LPredictorsAdd"),me("PredictorAdd","VP8LPredictorsAdd_C"),Bi=De,U1=dt,Q1=we,YA=ue,JA=ne,ZA=Ve,Wm=it,E.VP8LMapColor32b=kf,E.VP8LMapColor8b=M1,N)}function lt(N,F,z,ae,Oe){var $e=1,Ge=[N],Xe=[F],tt=ae.m,mt=ae.s,Bt=null,Jt=0;e:for(;;){if(z)for(;$e&&Ue(tt,1);){var pt=Ge,Lt=Xe,Kt=ae,dr=1,Wt=Kt.m,mr=Kt.gc[Kt.ab],gr=Ue(Wt,2);if(Kt.Oc&1<<gr)$e=0;else{switch(Kt.Oc|=1<<gr,mr.hc=gr,mr.Ea=pt[0],mr.nc=Lt[0],mr.K=[null],++Kt.ab,e(4>=Kt.ab),gr){case 0:case 1:mr.b=Ue(Wt,3)+2,dr=lt(Ye(mr.Ea,mr.b),Ye(mr.nc,mr.b),0,Kt,mr.K),mr.K=mr.K[0];break;case 3:var Br,Cr=Ue(Wt,8)+1,bn=16<Cr?0:4<Cr?1:2<Cr?2:3;if(pt[0]=Ye(mr.Ea,bn),mr.b=bn,Br=dr=lt(Cr,1,0,Kt,mr.K)){var cn,Yn=Cr,mn=mr,pa=1<<(8>>mn.b),mo=s(pa);if(mo==null)Br=0;else{var Jn=mn.K[0],pn=mn.w;for(mo[0]=mn.K[0][0],cn=1;cn<1*Yn;++cn)mo[cn]=ot(Jn[pn+cn],mo[cn-1]);for(;cn<4*pa;++cn)mo[cn]=0;mn.K[0]=null,mn.K[0]=mo,Br=1}}dr=Br;break;case 2:break;default:e(0)}$e=dr}}if(Ge=Ge[0],Xe=Xe[0],$e&&Ue(tt,1)&&!($e=1<=(Jt=Ue(tt,4))&&11>=Jt)){ae.a=3;break e}var Wr;if(Wr=$e)t:{var Fi,Gn,va,Es=ae,dl=Ge,hc=Xe,yi=Jt,Ml=z,Ac=Es.m,po=Es.s,wa=[null],Ha=1,bi=0,$a=vde[yi];r:for(;;){if(Ml&&Ue(Ac,1)){var fl=Ue(Ac,3)+2,qd=Ye(dl,fl),Oi=Ye(hc,fl),Hc=qd*Oi;if(!lt(qd,Oi,0,Es,wa))break r;for(wa=wa[0],po.xc=fl,Fi=0;Fi<Hc;++Fi){var fs=wa[Fi]>>8&65535;wa[Fi]=fs,fs>=Ha&&(Ha=fs+1)}}if(Ac.h)break r;for(Gn=0;5>Gn;++Gn){var go=lL[Gn];!Gn&&0<yi&&(go+=1<<yi),bi<go&&(bi=go)}var vu=o(Ha*$a,P),mc=Ha,yu=o(mc,le);if(yu==null)var bu=null;else e(65536>=mc),bu=yu;var $c=s(bi);if(bu==null||$c==null||vu==null){Es.a=1;break r}var wu=vu;for(Fi=va=0;Fi<Ha;++Fi){var xs=bu[Fi],Nu=xs.G,zd=xs.H,Ym=0,Ch=1,hl=0;for(Gn=0;5>Gn;++Gn){go=lL[Gn],Nu[Gn]=wu,zd[Gn]=va,!Gn&&0<yi&&(go+=1<<yi);a:{var PN,M4=go,TN=Es,K1=$c,Ude=wu,Qde=va,L4=0,n0=TN.m,Vde=Ue(n0,1);if(a(K1,0,0,M4),Vde){var Hde=Ue(n0,1)+1,$de=Ue(n0,1),xL=Ue(n0,$de==0?1:8);K1[xL]=1,Hde==2&&(K1[xL=Ue(n0,8)]=1);var BN=1}else{var vL=s(19),yL=Ue(n0,4)+4;if(19<yL){TN.a=3;var kN=0;break a}for(PN=0;PN<yL;++PN)vL[gde[PN]]=Ue(n0,3);var U4=void 0,q1=void 0,bL=TN,Gde=vL,FN=M4,wL=K1,Q4=0,a0=bL.m,NL=8,CL=o(128,P);n:for(;T(CL,0,7,Gde,19);){if(Ue(a0,1)){var Kde=2+2*Ue(a0,3);if((U4=2+Ue(a0,Kde))>FN)break n}else U4=FN;for(q1=0;q1<FN&&U4--;){X(a0);var _L=CL[0+(127&G(a0))];W(a0,a0.u+_L.g);var Zg=_L.value;if(16>Zg)wL[q1++]=Zg,Zg!=0&&(NL=Zg);else{var qde=Zg==16,EL=Zg-16,zde=mde[EL],SL=Ue(a0,Ade[EL])+zde;if(q1+SL>FN)break n;for(var Wde=qde?NL:0;0<SL--;)wL[q1++]=Wde}}Q4=1;break n}Q4||(bL.a=3),BN=Q4}(BN=BN&&!n0.h)&&(L4=T(Ude,Qde,8,K1,M4)),BN&&L4!=0?kN=L4:(TN.a=3,kN=0)}if(kN==0)break r;if(Ch&&pde[Gn]==1&&(Ch=wu[va].g==0),Ym+=wu[va].g,va+=kN,3>=Gn){var z1,V4=$c[0];for(z1=1;z1<go;++z1)$c[z1]>V4&&(V4=$c[z1]);hl+=V4}}if(xs.nd=Ch,xs.Qb=0,Ch&&(xs.qb=(Nu[3][zd[3]+0].value<<24|Nu[1][zd[1]+0].value<<16|Nu[2][zd[2]+0].value)>>>0,Ym==0&&256>Nu[0][zd[0]+0].value&&(xs.Qb=1,xs.qb+=Nu[0][zd[0]+0].value<<8)),xs.jc=!xs.Qb&&6>hl,xs.jc){var ON,_h=xs;for(ON=0;ON<zm;++ON){var s0=ON,i0=_h.pd[s0],DN=_h.G[0][_h.H[0]+s0];256<=DN.value?(i0.g=DN.g+256,i0.value=DN.value):(i0.g=0,i0.value=0,s0>>=_e(DN,8,i0),s0>>=_e(_h.G[1][_h.H[1]+s0],16,i0),s0>>=_e(_h.G[2][_h.H[2]+s0],0,i0),_e(_h.G[3][_h.H[3]+s0],24,i0))}}}po.vc=wa,po.Wb=Ha,po.Ya=bu,po.yc=vu,Wr=1;break t}Wr=0}if(!($e=Wr)){ae.a=3;break e}if(0<Jt){if(mt.ua=1<<Jt,!J(mt.Wa,Jt)){ae.a=1,$e=0;break e}}else mt.ua=0;var H4=ae,IL=Ge,Xde=Xe,$4=H4.s,G4=$4.xc;if(H4.c=IL,H4.i=Xde,$4.md=Ye(IL,G4),$4.wc=G4==0?-1:(1<<G4)-1,z){ae.xb=Sde;break e}if((Bt=s(Ge*Xe))==null){ae.a=1,$e=0;break e}$e=($e=Ke(ae,Bt,0,Ge,Xe,Xe,null))&&!tt.h;break e}return $e?(Oe!=null?Oe[0]=Bt:(e(Bt==null),e(z)),ae.$=0,z||Pe(mt)):Pe(mt),$e}function ht(N,F){var z=N.c*N.i,ae=z+F+16*F;return e(N.c<=F),N.V=s(ae),N.V==null?(N.Ta=null,N.Ua=0,N.a=1,0):(N.Ta=N.V,N.Ua=N.Ba+z+F,1)}function kt(N,F){var z=N.C,ae=F-z,Oe=N.V,$e=N.Ba+N.c*z;for(e(F<=N.l.o);0<ae;){var Ge=16<ae?16:ae,Xe=N.l.ma,tt=N.l.width,mt=tt*Ge,Bt=Xe.ca,Jt=Xe.tb+tt*z,pt=N.Ta,Lt=N.Ua;V(N,Ge,Oe,$e),eL(pt,Lt,Bt,Jt,mt),Ne(Xe,z,z+Ge,Bt,Jt,tt),ae-=Ge,Oe+=Ge*N.c,z+=Ge}e(z==F),N.C=N.Ma=F}function de(){this.ub=this.yd=this.td=this.Rb=0}function qe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function at(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function st(){this.Yb=function(){var N=[];return function F(z,ae,Oe){for(var $e=Oe[ae],Ge=0;Ge<$e&&(z.push(Oe.length>ae+1?[]:0),!(Oe.length<ae+1));Ge++)F(z[Ge],ae+1,Oe)}(N,0,[3,11]),N}()}function Nt(){this.jb=s(3),this.Wc=l([4,8],st),this.Xc=l([4,17],st)}function Rt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function nr(){this.ld=this.La=this.dd=this.tc=0}function _r(){this.Na=this.la=0}function $r(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function or(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function kr(){this.uc=this.M=this.Nb=0,this.wa=Array(new nr),this.Y=0,this.ya=Array(new or),this.aa=0,this.l=new Se}function en(){this.y=s(16),this.f=s(8),this.ea=s(8)}function rn(){this.cb=this.a=0,this.sc="",this.m=new O,this.Od=new de,this.Kc=new qe,this.ed=new Rt,this.Qa=new at,this.Ic=this.$c=this.Aa=0,this.D=new kr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,O),this.ia=0,this.pb=o(4,$r),this.Pa=new Nt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new en),this.Hd=0,this.rb=Array(new _r),this.sb=0,this.wa=Array(new nr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new or),this.L=this.aa=0,this.gd=l([4,2],nr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Er(N,F){return 0>N?0:N>F?F:N}function Se(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function gt(){var N=new rn;return N!=null&&(N.a=0,N.sc="OK",N.cb=0,N.Xb=0,$1||($1=ir)),N}function er(N,F,z){return N.a==0&&(N.a=F,N.sc=z,N.cb=0),0}function Mr(N,F,z){return 3<=z&&N[F+0]==157&&N[F+1]==1&&N[F+2]==42}function Or(N,F){if(N==null)return 0;if(N.a=0,N.sc="OK",F==null)return er(N,2,"null VP8Io passed to VP8GetHeaders()");var z=F.data,ae=F.w,Oe=F.ha;if(4>Oe)return er(N,7,"Truncated header.");var $e=z[ae+0]|z[ae+1]<<8|z[ae+2]<<16,Ge=N.Od;if(Ge.Rb=!(1&$e),Ge.td=$e>>1&7,Ge.yd=$e>>4&1,Ge.ub=$e>>5,3<Ge.td)return er(N,3,"Incorrect keyframe parameters.");if(!Ge.yd)return er(N,4,"Frame not displayable.");ae+=3,Oe-=3;var Xe=N.Kc;if(Ge.Rb){if(7>Oe)return er(N,7,"cannot parse picture header");if(!Mr(z,ae,Oe))return er(N,3,"Bad code word");Xe.c=16383&(z[ae+4]<<8|z[ae+3]),Xe.Td=z[ae+4]>>6,Xe.i=16383&(z[ae+6]<<8|z[ae+5]),Xe.Ud=z[ae+6]>>6,ae+=7,Oe-=7,N.za=Xe.c+15>>4,N.Ub=Xe.i+15>>4,F.width=Xe.c,F.height=Xe.i,F.Da=0,F.j=0,F.v=0,F.va=F.width,F.o=F.height,F.da=0,F.ib=F.width,F.hb=F.height,F.U=F.width,F.T=F.height,a(($e=N.Pa).jb,0,255,$e.jb.length),e(($e=N.Qa)!=null),$e.Cb=0,$e.Bb=0,$e.Fb=1,a($e.Zb,0,0,$e.Zb.length),a($e.Lb,0,0,$e.Lb)}if(Ge.ub>Oe)return er(N,7,"bad partition length");oe($e=N.m,z,ae,Ge.ub),ae+=Ge.ub,Oe-=Ge.ub,Ge.Rb&&(Xe.Ld=Q($e),Xe.Kd=Q($e)),Xe=N.Qa;var tt,mt=N.Pa;if(e($e!=null),e(Xe!=null),Xe.Cb=Q($e),Xe.Cb){if(Xe.Bb=Q($e),Q($e)){for(Xe.Fb=Q($e),tt=0;4>tt;++tt)Xe.Zb[tt]=Q($e)?Ae($e,7):0;for(tt=0;4>tt;++tt)Xe.Lb[tt]=Q($e)?Ae($e,6):0}if(Xe.Bb)for(tt=0;3>tt;++tt)mt.jb[tt]=Q($e)?ie($e,8):255}else Xe.Bb=0;if($e.Ka)return er(N,3,"cannot parse segment header");if((Xe=N.ed).zd=Q($e),Xe.Tb=ie($e,6),Xe.wb=ie($e,3),Xe.Pc=Q($e),Xe.Pc&&Q($e)){for(mt=0;4>mt;++mt)Q($e)&&(Xe.vd[mt]=Ae($e,6));for(mt=0;4>mt;++mt)Q($e)&&(Xe.od[mt]=Ae($e,6))}if(N.L=Xe.Tb==0?0:Xe.zd?1:2,$e.Ka)return er(N,3,"cannot parse filter header");var Bt=Oe;if(Oe=tt=ae,ae=tt+Bt,Xe=Bt,N.Xb=(1<<ie(N.m,2))-1,Bt<3*(mt=N.Xb))z=7;else{for(tt+=3*mt,Xe-=3*mt,Bt=0;Bt<mt;++Bt){var Jt=z[Oe+0]|z[Oe+1]<<8|z[Oe+2]<<16;Jt>Xe&&(Jt=Xe),oe(N.Jc[+Bt],z,tt,Jt),tt+=Jt,Xe-=Jt,Oe+=3}oe(N.Jc[+mt],z,tt,Xe),z=tt<ae?0:5}if(z!=0)return er(N,z,"cannot parse partitions");for(z=ie(tt=N.m,7),Oe=Q(tt)?Ae(tt,4):0,ae=Q(tt)?Ae(tt,4):0,Xe=Q(tt)?Ae(tt,4):0,mt=Q(tt)?Ae(tt,4):0,tt=Q(tt)?Ae(tt,4):0,Bt=N.Qa,Jt=0;4>Jt;++Jt){if(Bt.Cb){var pt=Bt.Zb[Jt];Bt.Fb||(pt+=z)}else{if(0<Jt){N.pb[Jt]=N.pb[0];continue}pt=z}var Lt=N.pb[Jt];Lt.Sc[0]=O4[Er(pt+Oe,127)],Lt.Sc[1]=D4[Er(pt+0,127)],Lt.Eb[0]=2*O4[Er(pt+ae,127)],Lt.Eb[1]=101581*D4[Er(pt+Xe,127)]>>16,8>Lt.Eb[1]&&(Lt.Eb[1]=8),Lt.Qc[0]=O4[Er(pt+mt,117)],Lt.Qc[1]=D4[Er(pt+tt,127)],Lt.lc=pt+tt}if(!Ge.Rb)return er(N,4,"Not a key frame.");for(Q($e),Ge=N.Pa,z=0;4>z;++z){for(Oe=0;8>Oe;++Oe)for(ae=0;3>ae;++ae)for(Xe=0;11>Xe;++Xe)mt=Z($e,_de[z][Oe][ae][Xe])?ie($e,8):Nde[z][Oe][ae][Xe],Ge.Wc[z][Oe].Yb[ae][Xe]=mt;for(Oe=0;17>Oe;++Oe)Ge.Xc[z][Oe]=Ge.Wc[z][Ede[Oe]]}return N.kc=Q($e),N.kc&&(N.Bd=ie($e,8)),N.cb=1}function ir(N,F,z,ae,Oe,$e,Ge){var Xe=F[Oe].Yb[z];for(z=0;16>Oe;++Oe){if(!Z(N,Xe[z+0]))return Oe;for(;!Z(N,Xe[z+1]);)if(Xe=F[++Oe].Yb[0],z=0,Oe==16)return 16;var tt=F[Oe+1].Yb;if(Z(N,Xe[z+2])){var mt=N,Bt=0;if(Z(mt,(pt=Xe)[(Jt=z)+3]))if(Z(mt,pt[Jt+6])){for(Xe=0,Jt=2*(Bt=Z(mt,pt[Jt+8]))+(pt=Z(mt,pt[Jt+9+Bt])),Bt=0,pt=bde[Jt];pt[Xe];++Xe)Bt+=Bt+Z(mt,pt[Xe]);Bt+=3+(8<<Jt)}else Z(mt,pt[Jt+7])?(Bt=7+2*Z(mt,165),Bt+=Z(mt,145)):Bt=5+Z(mt,159);else Bt=Z(mt,pt[Jt+4])?3+Z(mt,pt[Jt+5]):2;Xe=tt[2]}else Bt=1,Xe=tt[1];tt=Ge+wde[Oe],0>(mt=N).b&&D(mt);var Jt,pt=mt.b,Lt=(Jt=mt.Ca>>1)-(mt.I>>pt)>>31;--mt.b,mt.Ca+=Lt,mt.Ca|=1,mt.I-=(Jt+1&Lt)<<pt,$e[tt]=((Bt^Lt)-Lt)*ae[(0<Oe)+0]}return 16}function br(N){var F=N.rb[N.sb-1];F.la=0,F.Na=0,a(N.zc,0,0,N.zc.length),N.ja=0}function wr(N,F,z,ae,Oe){Oe=N[F+z+32*ae]+(Oe>>3),N[F+z+32*ae]=-256&Oe?0>Oe?0:255:Oe}function Xr(N,F,z,ae,Oe,$e){wr(N,F,0,z,ae+Oe),wr(N,F,1,z,ae+$e),wr(N,F,2,z,ae-$e),wr(N,F,3,z,ae-Oe)}function Ir(N){return(20091*N>>16)+N}function Pr(N,F,z,ae){var Oe,$e=0,Ge=s(16);for(Oe=0;4>Oe;++Oe){var Xe=N[F+0]+N[F+8],tt=N[F+0]-N[F+8],mt=(35468*N[F+4]>>16)-Ir(N[F+12]),Bt=Ir(N[F+4])+(35468*N[F+12]>>16);Ge[$e+0]=Xe+Bt,Ge[$e+1]=tt+mt,Ge[$e+2]=tt-mt,Ge[$e+3]=Xe-Bt,$e+=4,F++}for(Oe=$e=0;4>Oe;++Oe)Xe=(N=Ge[$e+0]+4)+Ge[$e+8],tt=N-Ge[$e+8],mt=(35468*Ge[$e+4]>>16)-Ir(Ge[$e+12]),wr(z,ae,0,0,Xe+(Bt=Ir(Ge[$e+4])+(35468*Ge[$e+12]>>16))),wr(z,ae,1,0,tt+mt),wr(z,ae,2,0,tt-mt),wr(z,ae,3,0,Xe-Bt),$e++,ae+=32}function fn(N,F,z,ae){var Oe=N[F+0]+4,$e=35468*N[F+4]>>16,Ge=Ir(N[F+4]),Xe=35468*N[F+1]>>16;Xr(z,ae,0,Oe+Ge,N=Ir(N[F+1]),Xe),Xr(z,ae,1,Oe+$e,N,Xe),Xr(z,ae,2,Oe-$e,N,Xe),Xr(z,ae,3,Oe-Ge,N,Xe)}function fe(N,F,z,ae,Oe){Pr(N,F,z,ae),Oe&&Pr(N,F+16,z,ae+4)}function et(N,F,z,ae){Xm(N,F+0,z,ae,1),Xm(N,F+32,z,ae+128,1)}function nt(N,F,z,ae){var Oe;for(N=N[F+0]+4,Oe=0;4>Oe;++Oe)for(F=0;4>F;++F)wr(z,ae,F,Oe,N)}function ct(N,F,z,ae){N[F+0]&&Ma(N,F+0,z,ae),N[F+16]&&Ma(N,F+16,z,ae+4),N[F+32]&&Ma(N,F+32,z,ae+128),N[F+48]&&Ma(N,F+48,z,ae+128+4)}function ve(N,F,z,ae){var Oe,$e=s(16);for(Oe=0;4>Oe;++Oe){var Ge=N[F+0+Oe]+N[F+12+Oe],Xe=N[F+4+Oe]+N[F+8+Oe],tt=N[F+4+Oe]-N[F+8+Oe],mt=N[F+0+Oe]-N[F+12+Oe];$e[0+Oe]=Ge+Xe,$e[8+Oe]=Ge-Xe,$e[4+Oe]=mt+tt,$e[12+Oe]=mt-tt}for(Oe=0;4>Oe;++Oe)Ge=(N=$e[0+4*Oe]+3)+$e[3+4*Oe],Xe=$e[1+4*Oe]+$e[2+4*Oe],tt=$e[1+4*Oe]-$e[2+4*Oe],mt=N-$e[3+4*Oe],z[ae+0]=Ge+Xe>>3,z[ae+16]=mt+tt>>3,z[ae+32]=Ge-Xe>>3,z[ae+48]=mt-tt>>3,ae+=64}function ft(N,F,z){var ae,Oe=F-32,$e=xu,Ge=255-N[Oe-1];for(ae=0;ae<z;++ae){var Xe,tt=$e,mt=Ge+N[F-1];for(Xe=0;Xe<z;++Xe)N[F+Xe]=tt[mt+N[Oe+Xe]];F+=32}}function St(N,F){ft(N,F,4)}function wt(N,F){ft(N,F,8)}function yt(N,F){ft(N,F,16)}function Et(N,F){var z;for(z=0;16>z;++z)n(N,F+32*z,N,F-32,16)}function qt(N,F){var z;for(z=16;0<z;--z)a(N,F,N[F-1],16),F+=32}function Mt(N,F,z){var ae;for(ae=0;16>ae;++ae)a(F,z+32*ae,N,16)}function Yt(N,F){var z,ae=16;for(z=0;16>z;++z)ae+=N[F-1+32*z]+N[F+z-32];Mt(ae>>5,N,F)}function ar(N,F){var z,ae=8;for(z=0;16>z;++z)ae+=N[F-1+32*z];Mt(ae>>4,N,F)}function vr(N,F){var z,ae=8;for(z=0;16>z;++z)ae+=N[F+z-32];Mt(ae>>4,N,F)}function ur(N,F){Mt(128,N,F)}function Dt(N,F,z){return N+2*F+z+2>>2}function Yr(N,F){var z,ae=F-32;for(ae=new Uint8Array([Dt(N[ae-1],N[ae+0],N[ae+1]),Dt(N[ae+0],N[ae+1],N[ae+2]),Dt(N[ae+1],N[ae+2],N[ae+3]),Dt(N[ae+2],N[ae+3],N[ae+4])]),z=0;4>z;++z)n(N,F+32*z,ae,0,ae.length)}function Vr(N,F){var z=N[F-1],ae=N[F-1+32],Oe=N[F-1+64],$e=N[F-1+96];be(N,F+0,16843009*Dt(N[F-1-32],z,ae)),be(N,F+32,16843009*Dt(z,ae,Oe)),be(N,F+64,16843009*Dt(ae,Oe,$e)),be(N,F+96,16843009*Dt(Oe,$e,$e))}function Sr(N,F){var z,ae=4;for(z=0;4>z;++z)ae+=N[F+z-32]+N[F-1+32*z];for(ae>>=3,z=0;4>z;++z)a(N,F+32*z,ae,4)}function pr(N,F){var z=N[F-1+0],ae=N[F-1+32],Oe=N[F-1+64],$e=N[F-1-32],Ge=N[F+0-32],Xe=N[F+1-32],tt=N[F+2-32],mt=N[F+3-32];N[F+0+96]=Dt(ae,Oe,N[F-1+96]),N[F+1+96]=N[F+0+64]=Dt(z,ae,Oe),N[F+2+96]=N[F+1+64]=N[F+0+32]=Dt($e,z,ae),N[F+3+96]=N[F+2+64]=N[F+1+32]=N[F+0+0]=Dt(Ge,$e,z),N[F+3+64]=N[F+2+32]=N[F+1+0]=Dt(Xe,Ge,$e),N[F+3+32]=N[F+2+0]=Dt(tt,Xe,Ge),N[F+3+0]=Dt(mt,tt,Xe)}function jr(N,F){var z=N[F+1-32],ae=N[F+2-32],Oe=N[F+3-32],$e=N[F+4-32],Ge=N[F+5-32],Xe=N[F+6-32],tt=N[F+7-32];N[F+0+0]=Dt(N[F+0-32],z,ae),N[F+1+0]=N[F+0+32]=Dt(z,ae,Oe),N[F+2+0]=N[F+1+32]=N[F+0+64]=Dt(ae,Oe,$e),N[F+3+0]=N[F+2+32]=N[F+1+64]=N[F+0+96]=Dt(Oe,$e,Ge),N[F+3+32]=N[F+2+64]=N[F+1+96]=Dt($e,Ge,Xe),N[F+3+64]=N[F+2+96]=Dt(Ge,Xe,tt),N[F+3+96]=Dt(Xe,tt,tt)}function Tn(N,F){var z=N[F-1+0],ae=N[F-1+32],Oe=N[F-1+64],$e=N[F-1-32],Ge=N[F+0-32],Xe=N[F+1-32],tt=N[F+2-32],mt=N[F+3-32];N[F+0+0]=N[F+1+64]=$e+Ge+1>>1,N[F+1+0]=N[F+2+64]=Ge+Xe+1>>1,N[F+2+0]=N[F+3+64]=Xe+tt+1>>1,N[F+3+0]=tt+mt+1>>1,N[F+0+96]=Dt(Oe,ae,z),N[F+0+64]=Dt(ae,z,$e),N[F+0+32]=N[F+1+96]=Dt(z,$e,Ge),N[F+1+32]=N[F+2+96]=Dt($e,Ge,Xe),N[F+2+32]=N[F+3+96]=Dt(Ge,Xe,tt),N[F+3+32]=Dt(Xe,tt,mt)}function Nn(N,F){var z=N[F+0-32],ae=N[F+1-32],Oe=N[F+2-32],$e=N[F+3-32],Ge=N[F+4-32],Xe=N[F+5-32],tt=N[F+6-32],mt=N[F+7-32];N[F+0+0]=z+ae+1>>1,N[F+1+0]=N[F+0+64]=ae+Oe+1>>1,N[F+2+0]=N[F+1+64]=Oe+$e+1>>1,N[F+3+0]=N[F+2+64]=$e+Ge+1>>1,N[F+0+32]=Dt(z,ae,Oe),N[F+1+32]=N[F+0+96]=Dt(ae,Oe,$e),N[F+2+32]=N[F+1+96]=Dt(Oe,$e,Ge),N[F+3+32]=N[F+2+96]=Dt($e,Ge,Xe),N[F+3+64]=Dt(Ge,Xe,tt),N[F+3+96]=Dt(Xe,tt,mt)}function xn(N,F){var z=N[F-1+0],ae=N[F-1+32],Oe=N[F-1+64],$e=N[F-1+96];N[F+0+0]=z+ae+1>>1,N[F+2+0]=N[F+0+32]=ae+Oe+1>>1,N[F+2+32]=N[F+0+64]=Oe+$e+1>>1,N[F+1+0]=Dt(z,ae,Oe),N[F+3+0]=N[F+1+32]=Dt(ae,Oe,$e),N[F+3+32]=N[F+1+64]=Dt(Oe,$e,$e),N[F+3+64]=N[F+2+64]=N[F+0+96]=N[F+1+96]=N[F+2+96]=N[F+3+96]=$e}function ua(N,F){var z=N[F-1+0],ae=N[F-1+32],Oe=N[F-1+64],$e=N[F-1+96],Ge=N[F-1-32],Xe=N[F+0-32],tt=N[F+1-32],mt=N[F+2-32];N[F+0+0]=N[F+2+32]=z+Ge+1>>1,N[F+0+32]=N[F+2+64]=ae+z+1>>1,N[F+0+64]=N[F+2+96]=Oe+ae+1>>1,N[F+0+96]=$e+Oe+1>>1,N[F+3+0]=Dt(Xe,tt,mt),N[F+2+0]=Dt(Ge,Xe,tt),N[F+1+0]=N[F+3+32]=Dt(z,Ge,Xe),N[F+1+32]=N[F+3+64]=Dt(ae,z,Ge),N[F+1+64]=N[F+3+96]=Dt(Oe,ae,z),N[F+1+96]=Dt($e,Oe,ae)}function ga(N,F){var z;for(z=0;8>z;++z)n(N,F+32*z,N,F-32,8)}function Ji(N,F){var z;for(z=0;8>z;++z)a(N,F,N[F-1],8),F+=32}function Zi(N,F,z){var ae;for(ae=0;8>ae;++ae)a(F,z+32*ae,N,8)}function Ol(N,F){var z,ae=8;for(z=0;8>z;++z)ae+=N[F+z-32]+N[F-1+32*z];Zi(ae>>4,N,F)}function xa(N,F){var z,ae=4;for(z=0;8>z;++z)ae+=N[F+z-32];Zi(ae>>3,N,F)}function Qn(N,F){var z,ae=4;for(z=0;8>z;++z)ae+=N[F-1+32*z];Zi(ae>>3,N,F)}function hu(N,F){Zi(128,N,F)}function Dl(N,F,z){var ae=N[F-z],Oe=N[F+0],$e=3*(Oe-ae)+P4[1020+N[F-2*z]-N[F+z]],Ge=bN[112+($e+4>>3)];N[F-z]=xu[255+ae+bN[112+($e+3>>3)]],N[F+0]=xu[255+Oe-Ge]}function eo(N,F,z,ae){var Oe=N[F+0],$e=N[F+z];return Zu[255+N[F-2*z]-N[F-z]]>ae||Zu[255+$e-Oe]>ae}function Lc(N,F,z,ae){return 4*Zu[255+N[F-z]-N[F+0]]+Zu[255+N[F-2*z]-N[F+z]]<=ae}function Uc(N,F,z,ae,Oe){var $e=N[F-3*z],Ge=N[F-2*z],Xe=N[F-z],tt=N[F+0],mt=N[F+z],Bt=N[F+2*z],Jt=N[F+3*z];return 4*Zu[255+Xe-tt]+Zu[255+Ge-mt]>ae?0:Zu[255+N[F-4*z]-$e]<=Oe&&Zu[255+$e-Ge]<=Oe&&Zu[255+Ge-Xe]<=Oe&&Zu[255+Jt-Bt]<=Oe&&Zu[255+Bt-mt]<=Oe&&Zu[255+mt-tt]<=Oe}function fc(N,F,z,ae){var Oe=2*ae+1;for(ae=0;16>ae;++ae)Lc(N,F+ae,z,Oe)&&Dl(N,F+ae,z)}function ll(N,F,z,ae){var Oe=2*ae+1;for(ae=0;16>ae;++ae)Lc(N,F+ae*z,1,Oe)&&Dl(N,F+ae*z,1)}function Au(N,F,z,ae){var Oe;for(Oe=3;0<Oe;--Oe)fc(N,F+=4*z,z,ae)}function qA(N,F,z,ae){var Oe;for(Oe=3;0<Oe;--Oe)ll(N,F+=4,z,ae)}function cl(N,F,z,ae,Oe,$e,Ge,Xe){for($e=2*$e+1;0<Oe--;){if(Uc(N,F,z,$e,Ge))if(eo(N,F,z,Xe))Dl(N,F,z);else{var tt=N,mt=F,Bt=z,Jt=tt[mt-2*Bt],pt=tt[mt-Bt],Lt=tt[mt+0],Kt=tt[mt+Bt],dr=tt[mt+2*Bt],Wt=27*(gr=P4[1020+3*(Lt-pt)+P4[1020+Jt-Kt]])+63>>7,mr=18*gr+63>>7,gr=9*gr+63>>7;tt[mt-3*Bt]=xu[255+tt[mt-3*Bt]+gr],tt[mt-2*Bt]=xu[255+Jt+mr],tt[mt-Bt]=xu[255+pt+Wt],tt[mt+0]=xu[255+Lt-Wt],tt[mt+Bt]=xu[255+Kt-mr],tt[mt+2*Bt]=xu[255+dr-gr]}F+=ae}}function Qc(N,F,z,ae,Oe,$e,Ge,Xe){for($e=2*$e+1;0<Oe--;){if(Uc(N,F,z,$e,Ge))if(eo(N,F,z,Xe))Dl(N,F,z);else{var tt=N,mt=F,Bt=z,Jt=tt[mt-Bt],pt=tt[mt+0],Lt=tt[mt+Bt],Kt=bN[112+(4+(dr=3*(pt-Jt))>>3)],dr=bN[112+(dr+3>>3)],Wt=Kt+1>>1;tt[mt-2*Bt]=xu[255+tt[mt-2*Bt]+Wt],tt[mt-Bt]=xu[255+Jt+dr],tt[mt+0]=xu[255+pt-Kt],tt[mt+Bt]=xu[255+Lt-Wt]}F+=ae}}function Bf(N,F,z,ae,Oe,$e){cl(N,F,z,1,16,ae,Oe,$e)}function ho(N,F,z,ae,Oe,$e){cl(N,F,1,z,16,ae,Oe,$e)}function Wu(N,F,z,ae,Oe,$e){var Ge;for(Ge=3;0<Ge;--Ge)Qc(N,F+=4*z,z,1,16,ae,Oe,$e)}function M(N,F,z,ae,Oe,$e){var Ge;for(Ge=3;0<Ge;--Ge)Qc(N,F+=4,1,z,16,ae,Oe,$e)}function Fe(N,F,z,ae,Oe,$e,Ge,Xe){cl(N,F,Oe,1,8,$e,Ge,Xe),cl(z,ae,Oe,1,8,$e,Ge,Xe)}function At(N,F,z,ae,Oe,$e,Ge,Xe){cl(N,F,1,Oe,8,$e,Ge,Xe),cl(z,ae,1,Oe,8,$e,Ge,Xe)}function _t(N,F,z,ae,Oe,$e,Ge,Xe){Qc(N,F+4*Oe,Oe,1,8,$e,Ge,Xe),Qc(z,ae+4*Oe,Oe,1,8,$e,Ge,Xe)}function Vt(N,F,z,ae,Oe,$e,Ge,Xe){Qc(N,F+4,1,Oe,8,$e,Ge,Xe),Qc(z,ae+4,1,Oe,8,$e,Ge,Xe)}function hr(){this.ba=new ge,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new xt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function yr(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function sn(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function hn(){this.ua=0,this.Wa=new ke,this.vb=new ke,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new le,this.yc=new P}function Bn(){this.xb=this.a=0,this.l=new Se,this.ca=new ge,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new H,this.Pb=0,this.wd=new H,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new hn,this.ab=0,this.gc=o(4,sn),this.Oc=0}function Vn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Se,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function da(N,F,z,ae,Oe,$e,Ge){for(N=N==null?0:N[F+0],F=0;F<Ge;++F)Oe[$e+F]=N+z[ae+F]&255,N=Oe[$e+F]}function ka(N,F,z,ae,Oe,$e,Ge){var Xe;if(N==null)da(null,null,z,ae,Oe,$e,Ge);else for(Xe=0;Xe<Ge;++Xe)Oe[$e+Xe]=N[F+Xe]+z[ae+Xe]&255}function Js(N,F,z,ae,Oe,$e,Ge){if(N==null)da(null,null,z,ae,Oe,$e,Ge);else{var Xe,tt=N[F+0],mt=tt,Bt=tt;for(Xe=0;Xe<Ge;++Xe)mt=Bt+(tt=N[F+Xe])-mt,Bt=z[ae+Xe]+(-256&mt?0>mt?0:255:mt)&255,mt=tt,Oe[$e+Xe]=Bt}}function Va(N,F,z,ae){var Oe=F.width,$e=F.o;if(e(N!=null&&F!=null),0>z||0>=ae||z+ae>$e)return null;if(!N.Cc){if(N.ga==null){var Ge;if(N.ga=new Vn,(Ge=N.ga==null)||(Ge=F.width*F.o,e(N.Gb.length==0),N.Gb=s(Ge),N.Uc=0,N.Gb==null?Ge=0:(N.mb=N.Gb,N.nb=N.Uc,N.rc=null,Ge=1),Ge=!Ge),!Ge){Ge=N.ga;var Xe=N.Fa,tt=N.P,mt=N.qc,Bt=N.mb,Jt=N.nb,pt=tt+1,Lt=mt-1,Kt=Ge.l;if(e(Xe!=null&&Bt!=null&&F!=null),r0[0]=null,r0[1]=da,r0[2]=ka,r0[3]=Js,Ge.ca=Bt,Ge.tb=Jt,Ge.c=F.width,Ge.i=F.height,e(0<Ge.c&&0<Ge.i),1>=mt)F=0;else if(Ge.$a=3&Xe[tt+0],Ge.Z=Xe[tt+0]>>2&3,Ge.Lc=Xe[tt+0]>>4&3,tt=Xe[tt+0]>>6&3,0>Ge.$a||1<Ge.$a||4<=Ge.Z||1<Ge.Lc||tt)F=0;else if(Kt.put=Le,Kt.ac=$t,Kt.bc=Ce,Kt.ma=Ge,Kt.width=F.width,Kt.height=F.height,Kt.Da=F.Da,Kt.v=F.v,Kt.va=F.va,Kt.j=F.j,Kt.o=F.o,Ge.$a)e:{e(Ge.$a==1),F=rt();t:for(;;){if(F==null){F=0;break e}if(e(Ge!=null),Ge.mc=F,F.c=Ge.c,F.i=Ge.i,F.l=Ge.l,F.l.ma=Ge,F.l.width=Ge.c,F.l.height=Ge.i,F.a=0,te(F.m,Xe,pt,Lt),!lt(Ge.c,Ge.i,1,F,null)||(F.ab==1&&F.gc[0].hc==3&&se(F.s)?(Ge.ic=1,Xe=F.c*F.i,F.Ta=null,F.Ua=0,F.V=s(Xe),F.Ba=0,F.V==null?(F.a=1,F=0):F=1):(Ge.ic=0,F=ht(F,Ge.c)),!F))break t;F=1;break e}Ge.mc=null,F=0}else F=Lt>=Ge.c*Ge.i;Ge=!F}if(Ge)return null;N.ga.Lc!=1?N.Ga=0:ae=$e-z}e(N.ga!=null),e(z+ae<=$e);e:{if(F=(Xe=N.ga).c,$e=Xe.l.o,Xe.$a==0){if(pt=N.rc,Lt=N.Vc,Kt=N.Fa,tt=N.P+1+z*F,mt=N.mb,Bt=N.nb+z*F,e(tt<=N.P+N.qc),Xe.Z!=0)for(e(r0[Xe.Z]!=null),Ge=0;Ge<ae;++Ge)r0[Xe.Z](pt,Lt,Kt,tt,mt,Bt,F),pt=mt,Lt=Bt,Bt+=F,tt+=F;else for(Ge=0;Ge<ae;++Ge)n(mt,Bt,Kt,tt,F),pt=mt,Lt=Bt,Bt+=F,tt+=F;N.rc=pt,N.Vc=Lt}else{if(e(Xe.mc!=null),F=z+ae,e((Ge=Xe.mc)!=null),e(F<=Ge.i),Ge.C>=F)F=1;else if(Xe.ic||Vc(),Xe.ic){Xe=Ge.V,pt=Ge.Ba,Lt=Ge.c;var dr=Ge.i,Wt=(Kt=1,tt=Ge.$/Lt,mt=Ge.$%Lt,Bt=Ge.m,Jt=Ge.s,Ge.$),mr=Lt*dr,gr=Lt*F,Br=Jt.wc,Cr=Wt<gr?R(Jt,mt,tt):null;e(Wt<=mr),e(F<=dr),e(se(Jt));t:for(;;){for(;!Bt.h&&Wt<gr;){if(mt&Br||(Cr=R(Jt,mt,tt)),e(Cr!=null),X(Bt),256>(dr=ee(Cr.G[0],Cr.H[0],Bt)))Xe[pt+Wt]=dr,++Wt,++mt>=Lt&&(mt=0,++tt<=F&&!(tt%16)&&Me(Ge,tt));else{if(!(280>dr)){Kt=0;break t}dr=He(dr-256,Bt);var bn,cn=ee(Cr.G[4],Cr.H[4],Bt);if(X(Bt),!(Wt>=(cn=he(Lt,cn=He(cn,Bt)))&&mr-Wt>=dr)){Kt=0;break t}for(bn=0;bn<dr;++bn)Xe[pt+Wt+bn]=Xe[pt+Wt+bn-cn];for(Wt+=dr,mt+=dr;mt>=Lt;)mt-=Lt,++tt<=F&&!(tt%16)&&Me(Ge,tt);Wt<gr&&mt&Br&&(Cr=R(Jt,mt,tt))}e(Bt.h==L(Bt))}Me(Ge,tt>F?F:tt);break t}!Kt||Bt.h&&Wt<mr?(Kt=0,Ge.a=Bt.h?5:3):Ge.$=Wt,F=Kt}else F=Ke(Ge,Ge.V,Ge.Ba,Ge.c,Ge.i,F,kt);if(!F){ae=0;break e}}z+ae>=$e&&(N.Cc=1),ae=1}if(!ae)return null;if(N.Cc&&((ae=N.ga)!=null&&(ae.mc=null),N.ga=null,0<N.Ga))return alert("todo:WebPDequantizeLevels"),null}return N.nb+z*Oe}function xi(N,F,z,ae,Oe,$e){for(;0<Oe--;){var Ge,Xe=N,tt=F+(z?1:0),mt=N,Bt=F+(z?0:3);for(Ge=0;Ge<ae;++Ge){var Jt=mt[Bt+4*Ge];Jt!=255&&(Jt*=32897,Xe[tt+4*Ge+0]=Xe[tt+4*Ge+0]*Jt>>23,Xe[tt+4*Ge+1]=Xe[tt+4*Ge+1]*Jt>>23,Xe[tt+4*Ge+2]=Xe[tt+4*Ge+2]*Jt>>23)}F+=$e}}function Zs(N,F,z,ae,Oe){for(;0<ae--;){var $e;for($e=0;$e<z;++$e){var Ge=N[F+2*$e+0],Xe=15&(mt=N[F+2*$e+1]),tt=4369*Xe,mt=(240&mt|mt>>4)*tt>>16;N[F+2*$e+0]=(240&Ge|Ge>>4)*tt>>16&240|(15&Ge|Ge<<4)*tt>>16>>4&15,N[F+2*$e+1]=240&mt|Xe}F+=Oe}}function vi(N,F,z,ae,Oe,$e,Ge,Xe){var tt,mt,Bt=255;for(mt=0;mt<Oe;++mt){for(tt=0;tt<ae;++tt){var Jt=N[F+tt];$e[Ge+4*tt]=Jt,Bt&=Jt}F+=z,Ge+=Xe}return Bt!=255}function ei(N,F,z,ae,Oe){var $e;for($e=0;$e<Oe;++$e)z[ae+$e]=N[F+$e]>>8}function Vc(){H1=xi,J8=Zs,Z8=vi,eL=ei}function Xu(N,F,z){E[N]=function(ae,Oe,$e,Ge,Xe,tt,mt,Bt,Jt,pt,Lt,Kt,dr,Wt,mr,gr,Br){var Cr,bn=Br-1>>1,cn=Xe[tt+0]|mt[Bt+0]<<16,Yn=Jt[pt+0]|Lt[Kt+0]<<16;e(ae!=null);var mn=3*cn+Yn+131074>>2;for(F(ae[Oe+0],255&mn,mn>>16,dr,Wt),$e!=null&&(mn=3*Yn+cn+131074>>2,F($e[Ge+0],255&mn,mn>>16,mr,gr)),Cr=1;Cr<=bn;++Cr){var pa=Xe[tt+Cr]|mt[Bt+Cr]<<16,mo=Jt[pt+Cr]|Lt[Kt+Cr]<<16,Jn=cn+pa+Yn+mo+524296,pn=Jn+2*(pa+Yn)>>3;mn=pn+cn>>1,cn=(Jn=Jn+2*(cn+mo)>>3)+pa>>1,F(ae[Oe+2*Cr-1],255&mn,mn>>16,dr,Wt+(2*Cr-1)*z),F(ae[Oe+2*Cr-0],255&cn,cn>>16,dr,Wt+(2*Cr-0)*z),$e!=null&&(mn=Jn+Yn>>1,cn=pn+mo>>1,F($e[Ge+2*Cr-1],255&mn,mn>>16,mr,gr+(2*Cr-1)*z),F($e[Ge+2*Cr+0],255&cn,cn>>16,mr,gr+(2*Cr+0)*z)),cn=pa,Yn=mo}1&Br||(mn=3*cn+Yn+131074>>2,F(ae[Oe+Br-1],255&mn,mn>>16,dr,Wt+(Br-1)*z),$e!=null&&(mn=3*Yn+cn+131074>>2,F($e[Ge+Br-1],255&mn,mn>>16,mr,gr+(Br-1)*z)))}}function Yu(){ed[wN]=Ide,ed[NN]=dL,ed[iL]=jde,ed[CN]=fL,ed[_N]=hL,ed[T4]=AL,ed[oL]=Pde,ed[B4]=dL,ed[k4]=fL,ed[EN]=hL,ed[F4]=AL}function _(N){return N&-16384?0>N?0:255:N>>Tde}function Y(N,F){return _((19077*N>>8)+(26149*F>>8)-14234)}function xe(N,F,z){return _((19077*N>>8)-(6419*F>>8)-(13320*z>>8)+8708)}function Ze(N,F){return _((19077*N>>8)+(33050*F>>8)-17685)}function Gt(N,F,z,ae,Oe){ae[Oe+0]=Y(N,z),ae[Oe+1]=xe(N,F,z),ae[Oe+2]=Ze(N,F)}function rr(N,F,z,ae,Oe){ae[Oe+0]=Ze(N,F),ae[Oe+1]=xe(N,F,z),ae[Oe+2]=Y(N,z)}function Lr(N,F,z,ae,Oe){var $e=xe(N,F,z);F=$e<<3&224|Ze(N,F)>>3,ae[Oe+0]=248&Y(N,z)|$e>>5,ae[Oe+1]=F}function ma(N,F,z,ae,Oe){var $e=240&Ze(N,F)|15;ae[Oe+0]=240&Y(N,z)|xe(N,F,z)>>4,ae[Oe+1]=$e}function ti(N,F,z,ae,Oe){ae[Oe+0]=255,Gt(N,F,z,ae,Oe+1)}function aa(N,F,z,ae,Oe){rr(N,F,z,ae,Oe),ae[Oe+3]=255}function Sa(N,F,z,ae,Oe){Gt(N,F,z,ae,Oe),ae[Oe+3]=255}function gs(N,F,z){E[N]=function(ae,Oe,$e,Ge,Xe,tt,mt,Bt,Jt){for(var pt=Bt+(-2&Jt)*z;Bt!=pt;)F(ae[Oe+0],$e[Ge+0],Xe[tt+0],mt,Bt),F(ae[Oe+1],$e[Ge+0],Xe[tt+0],mt,Bt+z),Oe+=2,++Ge,++tt,Bt+=2*z;1&Jt&&F(ae[Oe+0],$e[Ge+0],Xe[tt+0],mt,Bt)}}function mu(N,F,z){return z==0?N==0?F==0?6:5:F==0?4:0:z}function Rl(N,F,z,ae,Oe){switch(N>>>30){case 3:Xm(F,z,ae,Oe,0);break;case 2:Ju(F,z,ae,Oe);break;case 1:Ma(F,z,ae,Oe)}}function ul(N,F){var z,ae,Oe=F.M,$e=F.Nb,Ge=N.oc,Xe=N.pc+40,tt=N.oc,mt=N.pc+584,Bt=N.oc,Jt=N.pc+600;for(z=0;16>z;++z)Ge[Xe+32*z-1]=129;for(z=0;8>z;++z)tt[mt+32*z-1]=129,Bt[Jt+32*z-1]=129;for(0<Oe?Ge[Xe-1-32]=tt[mt-1-32]=Bt[Jt-1-32]=129:(a(Ge,Xe-32-1,127,21),a(tt,mt-32-1,127,9),a(Bt,Jt-32-1,127,9)),ae=0;ae<N.za;++ae){var pt=F.ya[F.aa+ae];if(0<ae){for(z=-1;16>z;++z)n(Ge,Xe+32*z-4,Ge,Xe+32*z+12,4);for(z=-1;8>z;++z)n(tt,mt+32*z-4,tt,mt+32*z+4,4),n(Bt,Jt+32*z-4,Bt,Jt+32*z+4,4)}var Lt=N.Gd,Kt=N.Hd+ae,dr=pt.ad,Wt=pt.Hc;if(0<Oe&&(n(Ge,Xe-32,Lt[Kt].y,0,16),n(tt,mt-32,Lt[Kt].f,0,8),n(Bt,Jt-32,Lt[Kt].ea,0,8)),pt.Za){var mr=Ge,gr=Xe-32+16;for(0<Oe&&(ae>=N.za-1?a(mr,gr,Lt[Kt].y[15],4):n(mr,gr,Lt[Kt+1].y,0,4)),z=0;4>z;z++)mr[gr+128+z]=mr[gr+256+z]=mr[gr+384+z]=mr[gr+0+z];for(z=0;16>z;++z,Wt<<=2)mr=Ge,gr=Xe+pL[z],Kd[pt.Ob[z]](mr,gr),Rl(Wt,dr,16*+z,mr,gr)}else if(mr=mu(ae,Oe,pt.Ob[0]),t0[mr](Ge,Xe),Wt!=0)for(z=0;16>z;++z,Wt<<=2)Rl(Wt,dr,16*+z,Ge,Xe+pL[z]);for(z=pt.Gc,mr=mu(ae,Oe,pt.Dd),Nh[mr](tt,mt),Nh[mr](Bt,Jt),Wt=dr,mr=tt,gr=mt,255&(pt=0|z)&&(170&pt?Of(Wt,256,mr,gr):ds(Wt,256,mr,gr)),pt=Bt,Wt=Jt,255&(z>>=8)&&(170&z?Of(dr,320,pt,Wt):ds(dr,320,pt,Wt)),Oe<N.Ub-1&&(n(Lt[Kt].y,0,Ge,Xe+480,16),n(Lt[Kt].f,0,tt,mt+224,8),n(Lt[Kt].ea,0,Bt,Jt+224,8)),z=8*$e*N.B,Lt=N.sa,Kt=N.ta+16*ae+16*$e*N.R,dr=N.qa,pt=N.ra+8*ae+z,Wt=N.Ha,mr=N.Ia+8*ae+z,z=0;16>z;++z)n(Lt,Kt+z*N.R,Ge,Xe+32*z,16);for(z=0;8>z;++z)n(dr,pt+z*N.B,tt,mt+32*z,8),n(Wt,mr+z*N.B,Bt,Jt+32*z,8)}}function Gd(N,F,z,ae,Oe,$e,Ge,Xe,tt){var mt=[0],Bt=[0],Jt=0,pt=tt!=null?tt.kd:0,Lt=tt??new yr;if(N==null||12>z)return 7;Lt.data=N,Lt.w=F,Lt.ha=z,F=[F],z=[z],Lt.gb=[Lt.gb];e:{var Kt=F,dr=z,Wt=Lt.gb;if(e(N!=null),e(dr!=null),e(Wt!=null),Wt[0]=0,12<=dr[0]&&!r(N,Kt[0],"RIFF")){if(r(N,Kt[0]+8,"WEBP")){Wt=3;break e}var mr=re(N,Kt[0]+4);if(12>mr||4294967286<mr){Wt=3;break e}if(pt&&mr>dr[0]-8){Wt=7;break e}Wt[0]=mr,Kt[0]+=12,dr[0]-=12}Wt=0}if(Wt!=0)return Wt;for(mr=0<Lt.gb[0],z=z[0];;){e:{var gr=N;dr=F,Wt=z;var Br=mt,Cr=Bt,bn=Kt=[0];if((mn=Jt=[Jt])[0]=0,8>Wt[0])Wt=7;else{if(!r(gr,dr[0],"VP8X")){if(re(gr,dr[0]+4)!=10){Wt=3;break e}if(18>Wt[0]){Wt=7;break e}var cn=re(gr,dr[0]+8),Yn=1+ze(gr,dr[0]+12);if(2147483648<=Yn*(gr=1+ze(gr,dr[0]+15))){Wt=3;break e}bn!=null&&(bn[0]=cn),Br!=null&&(Br[0]=Yn),Cr!=null&&(Cr[0]=gr),dr[0]+=18,Wt[0]-=18,mn[0]=1}Wt=0}}if(Jt=Jt[0],Kt=Kt[0],Wt!=0)return Wt;if(dr=!!(2&Kt),!mr&&Jt)return 3;if($e!=null&&($e[0]=!!(16&Kt)),Ge!=null&&(Ge[0]=dr),Xe!=null&&(Xe[0]=0),Ge=mt[0],Kt=Bt[0],Jt&&dr&&tt==null){Wt=0;break}if(4>z){Wt=7;break}if(mr&&Jt||!mr&&!Jt&&!r(N,F[0],"ALPH")){z=[z],Lt.na=[Lt.na],Lt.P=[Lt.P],Lt.Sa=[Lt.Sa];e:{cn=N,Wt=F,mr=z;var mn=Lt.gb;Br=Lt.na,Cr=Lt.P,bn=Lt.Sa,Yn=22,e(cn!=null),e(mr!=null),gr=Wt[0];var pa=mr[0];for(e(Br!=null),e(bn!=null),Br[0]=null,Cr[0]=null,bn[0]=0;;){if(Wt[0]=gr,mr[0]=pa,8>pa){Wt=7;break e}var mo=re(cn,gr+4);if(4294967286<mo){Wt=3;break e}var Jn=8+mo+1&-2;if(Yn+=Jn,0<mn&&Yn>mn){Wt=3;break e}if(!r(cn,gr,"VP8 ")||!r(cn,gr,"VP8L")){Wt=0;break e}if(pa[0]<Jn){Wt=7;break e}r(cn,gr,"ALPH")||(Br[0]=cn,Cr[0]=gr+8,bn[0]=mo),gr+=Jn,pa-=Jn}}if(z=z[0],Lt.na=Lt.na[0],Lt.P=Lt.P[0],Lt.Sa=Lt.Sa[0],Wt!=0)break}z=[z],Lt.Ja=[Lt.Ja],Lt.xa=[Lt.xa];e:if(mn=N,Wt=F,mr=z,Br=Lt.gb[0],Cr=Lt.Ja,bn=Lt.xa,cn=Wt[0],gr=!r(mn,cn,"VP8 "),Yn=!r(mn,cn,"VP8L"),e(mn!=null),e(mr!=null),e(Cr!=null),e(bn!=null),8>mr[0])Wt=7;else{if(gr||Yn){if(mn=re(mn,cn+4),12<=Br&&mn>Br-12){Wt=3;break e}if(pt&&mn>mr[0]-8){Wt=7;break e}Cr[0]=mn,Wt[0]+=8,mr[0]-=8,bn[0]=Yn}else bn[0]=5<=mr[0]&&mn[cn+0]==47&&!(mn[cn+4]>>5),Cr[0]=mr[0];Wt=0}if(z=z[0],Lt.Ja=Lt.Ja[0],Lt.xa=Lt.xa[0],F=F[0],Wt!=0)break;if(4294967286<Lt.Ja)return 3;if(Xe==null||dr||(Xe[0]=Lt.xa?2:1),Ge=[Ge],Kt=[Kt],Lt.xa){if(5>z){Wt=7;break}Xe=Ge,pt=Kt,dr=$e,N==null||5>z?N=0:5<=z&&N[F+0]==47&&!(N[F+4]>>5)?(mr=[0],mn=[0],Br=[0],te(Cr=new H,N,F,z),pe(Cr,mr,mn,Br)?(Xe!=null&&(Xe[0]=mr[0]),pt!=null&&(pt[0]=mn[0]),dr!=null&&(dr[0]=Br[0]),N=1):N=0):N=0}else{if(10>z){Wt=7;break}Xe=Kt,N==null||10>z||!Mr(N,F+3,z-3)?N=0:(pt=N[F+0]|N[F+1]<<8|N[F+2]<<16,dr=16383&(N[F+7]<<8|N[F+6]),N=16383&(N[F+9]<<8|N[F+8]),1&pt||3<(pt>>1&7)||!(pt>>4&1)||pt>>5>=Lt.Ja||!dr||!N?N=0:(Ge&&(Ge[0]=dr),Xe&&(Xe[0]=N),N=1))}if(!N||(Ge=Ge[0],Kt=Kt[0],Jt&&(mt[0]!=Ge||Bt[0]!=Kt)))return 3;tt!=null&&(tt[0]=Lt,tt.offset=F-tt.w,e(4294967286>F-tt.w),e(tt.offset==tt.ha-z));break}return Wt==0||Wt==7&&Jt&&tt==null?($e!=null&&($e[0]|=Lt.na!=null&&0<Lt.na.length),ae!=null&&(ae[0]=Ge),Oe!=null&&(Oe[0]=Kt),0):Wt}function O1(N,F,z){var ae=F.width,Oe=F.height,$e=0,Ge=0,Xe=ae,tt=Oe;if(F.Da=N!=null&&0<N.Da,F.Da&&(Xe=N.cd,tt=N.bd,$e=N.v,Ge=N.j,11>z||($e&=-2,Ge&=-2),0>$e||0>Ge||0>=Xe||0>=tt||$e+Xe>ae||Ge+tt>Oe))return 0;if(F.v=$e,F.j=Ge,F.va=$e+Xe,F.o=Ge+tt,F.U=Xe,F.T=tt,F.da=N!=null&&0<N.da,F.da){if(!Be(Xe,tt,z=[N.ib],$e=[N.hb]))return 0;F.ib=z[0],F.hb=$e[0]}return F.ob=N!=null&&N.ob,F.Kb=N==null||!N.Sd,F.da&&(F.ob=F.ib<3*ae/4&&F.hb<3*Oe/4,F.Kb=0),1}function D1(N){if(N==null)return 2;if(11>N.S){var F=N.f.RGBA;F.fb+=(N.height-1)*F.A,F.A=-F.A}else F=N.f.kb,N=N.height,F.O+=(N-1)*F.fa,F.fa=-F.fa,F.N+=(N-1>>1)*F.Ab,F.Ab=-F.Ab,F.W+=(N-1>>1)*F.Db,F.Db=-F.Db,F.F!=null&&(F.J+=(N-1)*F.lb,F.lb=-F.lb);return 0}function zA(N,F,z,ae){if(ae==null||0>=N||0>=F)return 2;if(z!=null){if(z.Da){var Oe=z.cd,$e=z.bd,Ge=-2&z.v,Xe=-2&z.j;if(0>Ge||0>Xe||0>=Oe||0>=$e||Ge+Oe>N||Xe+$e>F)return 2;N=Oe,F=$e}if(z.da){if(!Be(N,F,Oe=[z.ib],$e=[z.hb]))return 2;N=Oe[0],F=$e[0]}}ae.width=N,ae.height=F;e:{var tt=ae.width,mt=ae.height;if(N=ae.S,0>=tt||0>=mt||!(N>=wN&&13>N))N=2;else{if(0>=ae.Rd&&ae.sd==null){Ge=$e=Oe=F=0;var Bt=(Xe=tt*gL[N])*mt;if(11>N||($e=(mt+1)/2*(F=(tt+1)/2),N==12&&(Ge=(Oe=tt)*mt)),(mt=s(Bt+2*$e+Ge))==null){N=1;break e}ae.sd=mt,11>N?((tt=ae.f.RGBA).eb=mt,tt.fb=0,tt.A=Xe,tt.size=Bt):((tt=ae.f.kb).y=mt,tt.O=0,tt.fa=Xe,tt.Fd=Bt,tt.f=mt,tt.N=0+Bt,tt.Ab=F,tt.Cd=$e,tt.ea=mt,tt.W=0+Bt+$e,tt.Db=F,tt.Ed=$e,N==12&&(tt.F=mt,tt.J=0+Bt+2*$e),tt.Tc=Ge,tt.lb=Oe)}if(F=1,Oe=ae.S,$e=ae.width,Ge=ae.height,Oe>=wN&&13>Oe)if(11>Oe)N=ae.f.RGBA,F&=(Xe=Math.abs(N.A))*(Ge-1)+$e<=N.size,F&=Xe>=$e*gL[Oe],F&=N.eb!=null;else{N=ae.f.kb,Xe=($e+1)/2,Bt=(Ge+1)/2,tt=Math.abs(N.fa),mt=Math.abs(N.Ab);var Jt=Math.abs(N.Db),pt=Math.abs(N.lb),Lt=pt*(Ge-1)+$e;F&=tt*(Ge-1)+$e<=N.Fd,F&=mt*(Bt-1)+Xe<=N.Cd,F=(F&=Jt*(Bt-1)+Xe<=N.Ed)&tt>=$e&mt>=Xe&Jt>=Xe,F&=N.y!=null,F&=N.f!=null,F&=N.ea!=null,Oe==12&&(F&=pt>=$e,F&=Lt<=N.Tc,F&=N.F!=null)}else F=0;N=F?0:2}}return N!=0||z!=null&&z.fd&&(N=D1(ae)),N}var zm=64,pu=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],gu=24,WA=32,bh=8,XA=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ct("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(N){return N},E.Predictor2=function(N,F,z){return F[z+0]},E.Predictor3=function(N,F,z){return F[z+1]},E.Predictor4=function(N,F,z){return F[z-1]},E.Predictor5=function(N,F,z){return Ot(Ot(N,F[z+1]),F[z+0])},E.Predictor6=function(N,F,z){return Ot(N,F[z-1])},E.Predictor7=function(N,F,z){return Ot(N,F[z+0])},E.Predictor8=function(N,F,z){return Ot(F[z-1],F[z+0])},E.Predictor9=function(N,F,z){return Ot(F[z+0],F[z+1])},E.Predictor10=function(N,F,z){return Ot(Ot(N,F[z-1]),Ot(F[z+0],F[z+1]))},E.Predictor11=function(N,F,z){var ae=F[z+0];return 0>=Ft(ae>>24&255,N>>24&255,(F=F[z-1])>>24&255)+Ft(ae>>16&255,N>>16&255,F>>16&255)+Ft(ae>>8&255,N>>8&255,F>>8&255)+Ft(255&ae,255&N,255&F)?ae:N},E.Predictor12=function(N,F,z){var ae=F[z+0];return(Tt((N>>24&255)+(ae>>24&255)-((F=F[z-1])>>24&255))<<24|Tt((N>>16&255)+(ae>>16&255)-(F>>16&255))<<16|Tt((N>>8&255)+(ae>>8&255)-(F>>8&255))<<8|Tt((255&N)+(255&ae)-(255&F)))>>>0},E.Predictor13=function(N,F,z){var ae=F[z-1];return(Qt((N=Ot(N,F[z+0]))>>24&255,ae>>24&255)<<24|Qt(N>>16&255,ae>>16&255)<<16|Qt(N>>8&255,ae>>8&255)<<8|Qt(255&N,255&ae))>>>0};var R1=E.PredictorAdd0;E.PredictorAdd1=Qe,Ct("Predictor2","PredictorAdd2"),Ct("Predictor3","PredictorAdd3"),Ct("Predictor4","PredictorAdd4"),Ct("Predictor5","PredictorAdd5"),Ct("Predictor6","PredictorAdd6"),Ct("Predictor7","PredictorAdd7"),Ct("Predictor8","PredictorAdd8"),Ct("Predictor9","PredictorAdd9"),Ct("Predictor10","PredictorAdd10"),Ct("Predictor11","PredictorAdd11"),Ct("Predictor12","PredictorAdd12"),Ct("Predictor13","PredictorAdd13");var Yg=E.PredictorAdd2;ce("ColorIndexInverseTransform","MapARGB","32b",function(N){return N>>8&255},function(N){return N}),ce("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(N){return N},function(N){return N>>8&255});var Bi,vN=E.ColorIndexInverseTransform,kf=E.MapARGB,Ff=E.VP8LColorIndexInverseTransformAlpha,M1=E.MapAlpha,L1=E.VP8LPredictorsAdd=[];L1.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var U1,Q1,YA,JA,ZA,Wm,e0,Xm,Ju,Of,Ma,ds,ki,Ao,wh,V1,Jg,yN,K8,q8,z8,W8,X8,Y8,H1,J8,Z8,eL,tL=s(511),rL=s(2041),nL=s(225),aL=s(767),sL=0,P4=rL,bN=nL,xu=aL,Zu=tL,wN=0,NN=1,iL=2,CN=3,_N=4,T4=5,oL=6,B4=7,k4=8,EN=9,F4=10,Ade=[2,3,7],mde=[3,3,11],lL=[280,256,256,256,40],pde=[0,1,1,1,0],gde=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],xde=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],vde=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],yde=8,O4=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],D4=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],$1=null,bde=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],wde=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],cL=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Nde=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Cde=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],_de=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Ede=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],t0=[],Kd=[],Nh=[],Sde=1,uL=2,r0=[],ed=[];Xu("UpsampleRgbLinePair",Gt,3),Xu("UpsampleBgrLinePair",rr,3),Xu("UpsampleRgbaLinePair",Sa,4),Xu("UpsampleBgraLinePair",aa,4),Xu("UpsampleArgbLinePair",ti,4),Xu("UpsampleRgba4444LinePair",ma,2),Xu("UpsampleRgb565LinePair",Lr,2);var Ide=E.UpsampleRgbLinePair,jde=E.UpsampleBgrLinePair,dL=E.UpsampleRgbaLinePair,fL=E.UpsampleBgraLinePair,hL=E.UpsampleArgbLinePair,AL=E.UpsampleRgba4444LinePair,Pde=E.UpsampleRgb565LinePair,SN=16,IN=1<<SN-1,G1=-227,R4=482,Tde=6,mL=0,Bde=s(256),kde=s(256),Fde=s(256),Ode=s(256),Dde=s(R4-G1),Rde=s(R4-G1);gs("YuvToRgbRow",Gt,3),gs("YuvToBgrRow",rr,3),gs("YuvToRgbaRow",Sa,4),gs("YuvToBgraRow",aa,4),gs("YuvToArgbRow",ti,4),gs("YuvToRgba4444Row",ma,2),gs("YuvToRgb565Row",Lr,2);var pL=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],jN=[0,2,8],Mde=[8,7,6,4,4,2,2,2,1,1,1,1],Lde=1;this.WebPDecodeRGBA=function(N,F,z,ae,Oe){var $e=NN,Ge=new hr,Xe=new ge;Ge.ba=Xe,Xe.S=$e,Xe.width=[Xe.width],Xe.height=[Xe.height];var tt=Xe.width,mt=Xe.height,Bt=new Ie;if(Bt==null||N==null)var Jt=2;else e(Bt!=null),Jt=Gd(N,F,z,Bt.width,Bt.height,Bt.Pd,Bt.Qd,Bt.format,null);if(Jt!=0?tt=0:(tt!=null&&(tt[0]=Bt.width[0]),mt!=null&&(mt[0]=Bt.height[0]),tt=1),tt){Xe.width=Xe.width[0],Xe.height=Xe.height[0],ae!=null&&(ae[0]=Xe.width),Oe!=null&&(Oe[0]=Xe.height);e:{if(ae=new Se,(Oe=new yr).data=N,Oe.w=F,Oe.ha=z,Oe.kd=1,F=[0],e(Oe!=null),((N=Gd(Oe.data,Oe.w,Oe.ha,null,null,null,F,null,Oe))==0||N==7)&&F[0]&&(N=4),(F=N)==0){if(e(Ge!=null),ae.data=Oe.data,ae.w=Oe.w+Oe.offset,ae.ha=Oe.ha-Oe.offset,ae.put=Le,ae.ac=$t,ae.bc=Ce,ae.ma=Ge,Oe.xa){if((N=rt())==null){Ge=1;break e}if(function(pt,Lt){var Kt=[0],dr=[0],Wt=[0];t:for(;;){if(pt==null)return 0;if(Lt==null)return pt.a=2,0;if(pt.l=Lt,pt.a=0,te(pt.m,Lt.data,Lt.w,Lt.ha),!pe(pt.m,Kt,dr,Wt)){pt.a=3;break t}if(pt.xb=uL,Lt.width=Kt[0],Lt.height=dr[0],!lt(Kt[0],dr[0],1,pt,null))break t;return 1}return e(pt.a!=0),0}(N,ae)){if(ae=(F=zA(ae.width,ae.height,Ge.Oa,Ge.ba))==0){t:{ae=N;r:for(;;){if(ae==null){ae=0;break t}if(e(ae.s.yc!=null),e(ae.s.Ya!=null),e(0<ae.s.Wb),e((z=ae.l)!=null),e((Oe=z.ma)!=null),ae.xb!=0){if(ae.ca=Oe.ba,ae.tb=Oe.tb,e(ae.ca!=null),!O1(Oe.Oa,z,CN)){ae.a=2;break r}if(!ht(ae,z.width)||z.da)break r;if((z.da||Ee(ae.ca.S))&&Vc(),11>ae.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ae.ca.f.kb.F!=null&&Vc()),ae.Pb&&0<ae.s.ua&&ae.s.vb.X==null&&!J(ae.s.vb,ae.s.Wa.Xa)){ae.a=1;break r}ae.xb=0}if(!Ke(ae,ae.V,ae.Ba,ae.c,ae.i,z.o,q))break r;Oe.Dc=ae.Ma,ae=1;break t}e(ae.a!=0),ae=0}ae=!ae}ae&&(F=N.a)}else F=N.a}else{if((N=new gt)==null){Ge=1;break e}if(N.Fa=Oe.na,N.P=Oe.P,N.qc=Oe.Sa,Or(N,ae)){if((F=zA(ae.width,ae.height,Ge.Oa,Ge.ba))==0){if(N.Aa=0,z=Ge.Oa,e((Oe=N)!=null),z!=null){if(0<(tt=0>(tt=z.Md)?0:100<tt?255:255*tt/100)){for(mt=Bt=0;4>mt;++mt)12>(Jt=Oe.pb[mt]).lc&&(Jt.ia=tt*Mde[0>Jt.lc?0:Jt.lc]>>3),Bt|=Jt.ia;Bt&&(alert("todo:VP8InitRandom"),Oe.ia=1)}Oe.Ga=z.Id,100<Oe.Ga?Oe.Ga=100:0>Oe.Ga&&(Oe.Ga=0)}(function(pt,Lt){if(pt==null)return 0;if(Lt==null)return er(pt,2,"NULL VP8Io parameter in VP8Decode().");if(!pt.cb&&!Or(pt,Lt))return 0;if(e(pt.cb),Lt.ac==null||Lt.ac(Lt)){Lt.ob&&(pt.L=0);var Kt=jN[pt.L];if(pt.L==2?(pt.yb=0,pt.zb=0):(pt.yb=Lt.v-Kt>>4,pt.zb=Lt.j-Kt>>4,0>pt.yb&&(pt.yb=0),0>pt.zb&&(pt.zb=0)),pt.Va=Lt.o+15+Kt>>4,pt.Hb=Lt.va+15+Kt>>4,pt.Hb>pt.za&&(pt.Hb=pt.za),pt.Va>pt.Ub&&(pt.Va=pt.Ub),0<pt.L){var dr=pt.ed;for(Kt=0;4>Kt;++Kt){var Wt;if(pt.Qa.Cb){var mr=pt.Qa.Lb[Kt];pt.Qa.Fb||(mr+=dr.Tb)}else mr=dr.Tb;for(Wt=0;1>=Wt;++Wt){var gr=pt.gd[Kt][Wt],Br=mr;if(dr.Pc&&(Br+=dr.vd[0],Wt&&(Br+=dr.od[0])),0<(Br=0>Br?0:63<Br?63:Br)){var Cr=Br;0<dr.wb&&(Cr=4<dr.wb?Cr>>2:Cr>>1)>9-dr.wb&&(Cr=9-dr.wb),1>Cr&&(Cr=1),gr.dd=Cr,gr.tc=2*Br+Cr,gr.ld=40<=Br?2:15<=Br?1:0}else gr.tc=0;gr.La=Wt}}}Kt=0}else er(pt,6,"Frame setup failed"),Kt=pt.a;if(Kt=Kt==0){if(Kt){pt.$c=0,0<pt.Aa||(pt.Ic=Lde);t:{Kt=pt.Ic,dr=4*(Cr=pt.za);var bn=32*Cr,cn=Cr+1,Yn=0<pt.L?Cr*(0<pt.Aa?2:1):0,mn=(pt.Aa==2?2:1)*Cr;if((gr=dr+832+(Wt=3*(16*Kt+jN[pt.L])/2*bn)+(mr=pt.Fa!=null&&0<pt.Fa.length?pt.Kc.c*pt.Kc.i:0))!=gr)Kt=0;else{if(gr>pt.Vb){if(pt.Vb=0,pt.Ec=s(gr),pt.Fc=0,pt.Ec==null){Kt=er(pt,1,"no memory during frame initialization.");break t}pt.Vb=gr}gr=pt.Ec,Br=pt.Fc,pt.Ac=gr,pt.Bc=Br,Br+=dr,pt.Gd=o(bn,en),pt.Hd=0,pt.rb=o(cn+1,_r),pt.sb=1,pt.wa=Yn?o(Yn,nr):null,pt.Y=0,pt.D.Nb=0,pt.D.wa=pt.wa,pt.D.Y=pt.Y,0<pt.Aa&&(pt.D.Y+=Cr),e(!0),pt.oc=gr,pt.pc=Br,Br+=832,pt.ya=o(mn,or),pt.aa=0,pt.D.ya=pt.ya,pt.D.aa=pt.aa,pt.Aa==2&&(pt.D.aa+=Cr),pt.R=16*Cr,pt.B=8*Cr,Cr=(bn=jN[pt.L])*pt.R,bn=bn/2*pt.B,pt.sa=gr,pt.ta=Br+Cr,pt.qa=pt.sa,pt.ra=pt.ta+16*Kt*pt.R+bn,pt.Ha=pt.qa,pt.Ia=pt.ra+8*Kt*pt.B+bn,pt.$c=0,Br+=Wt,pt.mb=mr?gr:null,pt.nb=mr?Br:null,e(Br+mr<=pt.Fc+pt.Vb),br(pt),a(pt.Ac,pt.Bc,0,dr),Kt=1}}if(Kt){if(Lt.ka=0,Lt.y=pt.sa,Lt.O=pt.ta,Lt.f=pt.qa,Lt.N=pt.ra,Lt.ea=pt.Ha,Lt.Vd=pt.Ia,Lt.fa=pt.R,Lt.Rc=pt.B,Lt.F=null,Lt.J=0,!sL){for(Kt=-255;255>=Kt;++Kt)tL[255+Kt]=0>Kt?-Kt:Kt;for(Kt=-1020;1020>=Kt;++Kt)rL[1020+Kt]=-128>Kt?-128:127<Kt?127:Kt;for(Kt=-112;112>=Kt;++Kt)nL[112+Kt]=-16>Kt?-16:15<Kt?15:Kt;for(Kt=-255;510>=Kt;++Kt)aL[255+Kt]=0>Kt?0:255<Kt?255:Kt;sL=1}e0=ve,Xm=fe,Of=et,Ma=nt,ds=ct,Ju=fn,ki=Bf,Ao=ho,wh=Fe,V1=At,Jg=Wu,yN=M,K8=_t,q8=Vt,z8=fc,W8=ll,X8=Au,Y8=qA,Kd[0]=Sr,Kd[1]=St,Kd[2]=Yr,Kd[3]=Vr,Kd[4]=pr,Kd[5]=Tn,Kd[6]=jr,Kd[7]=Nn,Kd[8]=ua,Kd[9]=xn,t0[0]=Yt,t0[1]=yt,t0[2]=Et,t0[3]=qt,t0[4]=ar,t0[5]=vr,t0[6]=ur,Nh[0]=Ol,Nh[1]=wt,Nh[2]=ga,Nh[3]=Ji,Nh[4]=Qn,Nh[5]=xa,Nh[6]=hu,Kt=1}else Kt=0}Kt&&(Kt=function(pa,mo){for(pa.M=0;pa.M<pa.Va;++pa.M){var Jn,pn=pa.Jc[pa.M&pa.Xb],Wr=pa.m,Fi=pa;for(Jn=0;Jn<Fi.za;++Jn){var Gn=Wr,va=Fi,Es=va.Ac,dl=va.Bc+4*Jn,hc=va.zc,yi=va.ya[va.aa+Jn];if(va.Qa.Bb?yi.$b=Z(Gn,va.Pa.jb[0])?2+Z(Gn,va.Pa.jb[2]):Z(Gn,va.Pa.jb[1]):yi.$b=0,va.kc&&(yi.Ad=Z(Gn,va.Bd)),yi.Za=!Z(Gn,145)+0,yi.Za){var Ml=yi.Ob,Ac=0;for(va=0;4>va;++va){var po,wa=hc[0+va];for(po=0;4>po;++po){wa=Cde[Es[dl+po]][wa];for(var Ha=cL[Z(Gn,wa[0])];0<Ha;)Ha=cL[2*Ha+Z(Gn,wa[Ha])];wa=-Ha,Es[dl+po]=wa}n(Ml,Ac,Es,dl,4),Ac+=4,hc[0+va]=wa}}else wa=Z(Gn,156)?Z(Gn,128)?1:3:Z(Gn,163)?2:0,yi.Ob[0]=wa,a(Es,dl,wa,4),a(hc,0,wa,4);yi.Dd=Z(Gn,142)?Z(Gn,114)?Z(Gn,183)?1:3:2:0}if(Fi.m.Ka)return er(pa,7,"Premature end-of-partition0 encountered.");for(;pa.ja<pa.za;++pa.ja){if(Fi=pn,Gn=(Wr=pa).rb[Wr.sb-1],Es=Wr.rb[Wr.sb+Wr.ja],Jn=Wr.ya[Wr.aa+Wr.ja],dl=Wr.kc?Jn.Ad:0)Gn.la=Es.la=0,Jn.Za||(Gn.Na=Es.Na=0),Jn.Hc=0,Jn.Gc=0,Jn.ia=0;else{var bi,$a;if(Gn=Es,Es=Fi,dl=Wr.Pa.Xc,hc=Wr.ya[Wr.aa+Wr.ja],yi=Wr.pb[hc.$b],va=hc.ad,Ml=0,Ac=Wr.rb[Wr.sb-1],wa=po=0,a(va,Ml,0,384),hc.Za)var fl=0,qd=dl[3];else{Ha=s(16);var Oi=Gn.Na+Ac.Na;if(Oi=$1(Es,dl[1],Oi,yi.Eb,0,Ha,0),Gn.Na=Ac.Na=(0<Oi)+0,1<Oi)e0(Ha,0,va,Ml);else{var Hc=Ha[0]+3>>3;for(Ha=0;256>Ha;Ha+=16)va[Ml+Ha]=Hc}fl=1,qd=dl[0]}var fs=15&Gn.la,go=15&Ac.la;for(Ha=0;4>Ha;++Ha){var vu=1&go;for(Hc=$a=0;4>Hc;++Hc)fs=fs>>1|(vu=(Oi=$1(Es,qd,Oi=vu+(1&fs),yi.Sc,fl,va,Ml))>fl)<<7,$a=$a<<2|(3<Oi?3:1<Oi?2:va[Ml+0]!=0),Ml+=16;fs>>=4,go=go>>1|vu<<7,po=(po<<8|$a)>>>0}for(qd=fs,fl=go>>4,bi=0;4>bi;bi+=2){for($a=0,fs=Gn.la>>4+bi,go=Ac.la>>4+bi,Ha=0;2>Ha;++Ha){for(vu=1&go,Hc=0;2>Hc;++Hc)Oi=vu+(1&fs),fs=fs>>1|(vu=0<(Oi=$1(Es,dl[2],Oi,yi.Qc,0,va,Ml)))<<3,$a=$a<<2|(3<Oi?3:1<Oi?2:va[Ml+0]!=0),Ml+=16;fs>>=2,go=go>>1|vu<<5}wa|=$a<<4*bi,qd|=fs<<4<<bi,fl|=(240&go)<<bi}Gn.la=qd,Ac.la=fl,hc.Hc=po,hc.Gc=wa,hc.ia=43690&wa?0:yi.ia,dl=!(po|wa)}if(0<Wr.L&&(Wr.wa[Wr.Y+Wr.ja]=Wr.gd[Jn.$b][Jn.Za],Wr.wa[Wr.Y+Wr.ja].La|=!dl),Fi.Ka)return er(pa,7,"Premature end-of-file encountered.")}if(br(pa),Wr=mo,Fi=1,Jn=(pn=pa).D,Gn=0<pn.L&&pn.M>=pn.zb&&pn.M<=pn.Va,pn.Aa==0)t:{if(Jn.M=pn.M,Jn.uc=Gn,ul(pn,Jn),Fi=1,Jn=($a=pn.D).Nb,Gn=(wa=jN[pn.L])*pn.R,Es=wa/2*pn.B,Ha=16*Jn*pn.R,Hc=8*Jn*pn.B,dl=pn.sa,hc=pn.ta-Gn+Ha,yi=pn.qa,va=pn.ra-Es+Hc,Ml=pn.Ha,Ac=pn.Ia-Es+Hc,go=(fs=$a.M)==0,po=fs>=pn.Va-1,pn.Aa==2&&ul(pn,$a),$a.uc)for(vu=(Oi=pn).D.M,e(Oi.D.uc),$a=Oi.yb;$a<Oi.Hb;++$a){fl=$a,qd=vu;var mc=(yu=(hl=Oi).D).Nb;bi=hl.R;var yu=yu.wa[yu.Y+fl],bu=hl.sa,$c=hl.ta+16*mc*bi+16*fl,wu=yu.dd,xs=yu.tc;if(xs!=0)if(e(3<=xs),hl.L==1)0<fl&&W8(bu,$c,bi,xs+4),yu.La&&Y8(bu,$c,bi,xs),0<qd&&z8(bu,$c,bi,xs+4),yu.La&&X8(bu,$c,bi,xs);else{var Nu=hl.B,zd=hl.qa,Ym=hl.ra+8*mc*Nu+8*fl,Ch=hl.Ha,hl=hl.Ia+8*mc*Nu+8*fl;mc=yu.ld,0<fl&&(Ao(bu,$c,bi,xs+4,wu,mc),V1(zd,Ym,Ch,hl,Nu,xs+4,wu,mc)),yu.La&&(yN(bu,$c,bi,xs,wu,mc),q8(zd,Ym,Ch,hl,Nu,xs,wu,mc)),0<qd&&(ki(bu,$c,bi,xs+4,wu,mc),wh(zd,Ym,Ch,hl,Nu,xs+4,wu,mc)),yu.La&&(Jg(bu,$c,bi,xs,wu,mc),K8(zd,Ym,Ch,hl,Nu,xs,wu,mc))}}if(pn.ia&&alert("todo:DitherRow"),Wr.put!=null){if($a=16*fs,fs=16*(fs+1),go?(Wr.y=pn.sa,Wr.O=pn.ta+Ha,Wr.f=pn.qa,Wr.N=pn.ra+Hc,Wr.ea=pn.Ha,Wr.W=pn.Ia+Hc):($a-=wa,Wr.y=dl,Wr.O=hc,Wr.f=yi,Wr.N=va,Wr.ea=Ml,Wr.W=Ac),po||(fs-=wa),fs>Wr.o&&(fs=Wr.o),Wr.F=null,Wr.J=null,pn.Fa!=null&&0<pn.Fa.length&&$a<fs&&(Wr.J=Va(pn,Wr,$a,fs-$a),Wr.F=pn.mb,Wr.F==null&&Wr.F.length==0)){Fi=er(pn,3,"Could not decode alpha data.");break t}$a<Wr.j&&(wa=Wr.j-$a,$a=Wr.j,e(!(1&wa)),Wr.O+=pn.R*wa,Wr.N+=pn.B*(wa>>1),Wr.W+=pn.B*(wa>>1),Wr.F!=null&&(Wr.J+=Wr.width*wa)),$a<fs&&(Wr.O+=Wr.v,Wr.N+=Wr.v>>1,Wr.W+=Wr.v>>1,Wr.F!=null&&(Wr.J+=Wr.v),Wr.ka=$a-Wr.j,Wr.U=Wr.va-Wr.v,Wr.T=fs-$a,Fi=Wr.put(Wr))}Jn+1!=pn.Ic||po||(n(pn.sa,pn.ta-Gn,dl,hc+16*pn.R,Gn),n(pn.qa,pn.ra-Es,yi,va+8*pn.B,Es),n(pn.Ha,pn.Ia-Es,Ml,Ac+8*pn.B,Es))}if(!Fi)return er(pa,6,"Output aborted.")}return 1}(pt,Lt)),Lt.bc!=null&&Lt.bc(Lt),Kt&=1}return Kt?(pt.cb=0,Kt):0})(N,ae)||(F=N.a)}}else F=N.a}F==0&&Ge.Oa!=null&&Ge.Oa.fd&&(F=D1(Ge.ba))}Ge=F}$e=Ge!=0?null:11>$e?Xe.f.RGBA.eb:Xe.f.kb.y}else $e=null;return $e};var gL=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(E,B){for(var k="",T=0;T<4;T++)k+=String.fromCharCode(E[B++]);return k}function d(E,B){return E[B+0]|E[B+1]<<8}function f(E,B){return(E[B+0]|E[B+1]<<8|E[B+2]<<16)>>>0}function A(E,B){return(E[B+0]|E[B+1]<<8|E[B+2]<<16|E[B+3]<<24)>>>0}new c;var h=[0],m=[0],p=[],x=new c,v=t,y=function(E,B){var k={},T=0,P=!1,K=0,le=0;if(k.frames=[],!function(O,H){for(var G=0;G<4;G++)if(O[H+G]!="RIFF".charCodeAt(G))return!0;return!1}(E,B)){for(A(E,B+=4),B+=8;B<E.length;){var oe=u(E,B),ie=A(E,B+=4);B+=4;var Ae=ie+(1&ie);switch(oe){case"VP8 ":case"VP8L":k.frames[T]===void 0&&(k.frames[T]={}),(Ue=k.frames[T]).src_off=P?le:B-8,Ue.src_size=K+ie+8,T++,P&&(P=!1,K=0,le=0);break;case"VP8X":(Ue=k.header={}).feature_flags=E[B];var te=B+4;Ue.canvas_width=1+f(E,te),te+=3,Ue.canvas_height=1+f(E,te),te+=3;break;case"ALPH":P=!0,K=Ae+8,le=B-8;break;case"ANIM":(Ue=k.header).bgcolor=A(E,B),te=B+4,Ue.loop_count=d(E,te),te+=2;break;case"ANMF":var Te,Ue;(Ue=k.frames[T]={}).offset_x=2*f(E,B),B+=3,Ue.offset_y=2*f(E,B),B+=3,Ue.width=1+f(E,B),B+=3,Ue.height=1+f(E,B),B+=3,Ue.duration=f(E,B),B+=3,Te=E[B++],Ue.dispose=1&Te,Ue.blend=Te>>1&1}oe!="ANMF"&&(B+=Ae)}return k}}(v,0);y.response=v,y.rgbaoutput=!0,y.dataurl=!1;var b=y.header?y.header:null,w=y.frames?y.frames:null;if(b){b.loop_counter=b.loop_count,h=[b.canvas_height],m=[b.canvas_width];for(var j=0;j<w.length&&w[j].blend!=0;j++);}var I=w[0],C=x.WebPDecodeRGBA(v,I.src_off,I.src_size,m,h);I.rgba=C,I.imgwidth=m[0],I.imgheight=h[0];for(var S=0;S<m[0]*h[0]*4;S++)p[S]=C[S];return this.width=m,this.height=h,this.data=p,this}(function(t){var e,r,n,a,s,o,l,c,u,d=function(O){return O=O||{},this.isStrokeTransparent=O.isStrokeTransparent||!1,this.strokeOpacity=O.strokeOpacity||1,this.strokeStyle=O.strokeStyle||"#000000",this.fillStyle=O.fillStyle||"#000000",this.isFillTransparent=O.isFillTransparent||!1,this.fillOpacity=O.fillOpacity||1,this.font=O.font||"10px sans-serif",this.textBaseline=O.textBaseline||"alphabetic",this.textAlign=O.textAlign||"left",this.lineWidth=O.lineWidth||1,this.lineJoin=O.lineJoin||"miter",this.lineCap=O.lineCap||"butt",this.path=O.path||[],this.transform=O.transform!==void 0?O.transform.clone():new c,this.globalCompositeOperation=O.globalCompositeOperation||"normal",this.globalAlpha=O.globalAlpha||1,this.clip_path=O.clip_path||[],this.currentPoint=O.currentPoint||new o,this.miterLimit=O.miterLimit||10,this.lastPoint=O.lastPoint||new o,this.lineDashOffset=O.lineDashOffset||0,this.lineDash=O.lineDash||[],this.margin=O.margin||[0,0,0,0],this.prevPageLastElemOffset=O.prevPageLastElemOffset||0,this.ignoreClearRect=typeof O.ignoreClearRect!="boolean"||O.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new f(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var f=function(O){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var H=O;Object.defineProperty(this,"pdf",{get:function(){return H}});var G=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return G},set:function(J){G=!!J}});var L=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return L},set:function(J){L=!!J}});var W=0;Object.defineProperty(this,"posX",{get:function(){return W},set:function(J){isNaN(J)||(W=J)}});var X=0;Object.defineProperty(this,"posY",{get:function(){return X},set:function(J){isNaN(J)||(X=J)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(J){var Re;typeof J=="number"?Re=[J,J,J,J]:((Re=new Array(4))[0]=J[0],Re[1]=J.length>=2?J[1]:Re[0],Re[2]=J.length>=3?J[2]:Re[0],Re[3]=J.length>=4?J[3]:Re[1]),u.margin=Re}});var D=!1;Object.defineProperty(this,"autoPaging",{get:function(){return D},set:function(J){D=J}});var Q=0;Object.defineProperty(this,"lastBreak",{get:function(){return Q},set:function(J){Q=J}});var Z=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Z},set:function(J){Z=J}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(J){J instanceof d&&(u=J)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(J){u.path=J}});var be=[];Object.defineProperty(this,"ctxStack",{get:function(){return be},set:function(J){be=J}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(J){var Re;Re=A(J),this.ctx.fillStyle=Re.style,this.ctx.isFillTransparent=Re.a===0,this.ctx.fillOpacity=Re.a,this.pdf.setFillColor(Re.r,Re.g,Re.b,{a:Re.a}),this.pdf.setTextColor(Re.r,Re.g,Re.b,{a:Re.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(J){var Re=A(J);this.ctx.strokeStyle=Re.style,this.ctx.isStrokeTransparent=Re.a===0,this.ctx.strokeOpacity=Re.a,Re.a===0?this.pdf.setDrawColor(255,255,255):(Re.a,this.pdf.setDrawColor(Re.r,Re.g,Re.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(J){["butt","round","square"].indexOf(J)!==-1&&(this.ctx.lineCap=J,this.pdf.setLineCap(J))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(J){isNaN(J)||(this.ctx.lineWidth=J,this.pdf.setLineWidth(J))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(J){["bevel","round","miter"].indexOf(J)!==-1&&(this.ctx.lineJoin=J,this.pdf.setLineJoin(J))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(J){isNaN(J)||(this.ctx.miterLimit=J,this.pdf.setMiterLimit(J))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(J){this.ctx.textBaseline=J}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(J){["right","end","center","left","start"].indexOf(J)!==-1&&(this.ctx.textAlign=J)}});var U=null,ze=null,re=null;Object.defineProperty(this,"fontFaces",{get:function(){return re},set:function(J){U=null,ze=null,re=J}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(J){var Re;if(this.ctx.font=J,(Re=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(J))!==null){var ke=Re[1];Re[2];var Be=Re[3],Ye=Re[4];Re[5];var ot=Re[6],Ct=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ye)[2];Ye=Math.floor(Ct==="px"?parseFloat(Ye)*this.pdf.internal.scaleFactor:Ct==="em"?parseFloat(Ye)*this.pdf.getFontSize():parseFloat(Ye)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ye);var jt=function(ce){var we,ue,ne=[],Ve=ce.trim();if(Ve==="")return g5;if(Ve in TV)return[TV[Ve]];for(;Ve!=="";){switch(ue=null,we=(Ve=kV(Ve)).charAt(0)){case'"':case"'":ue=nPe(Ve.substring(1),we);break;default:ue=aPe(Ve)}if(ue===null||(ne.push(ue[0]),(Ve=kV(ue[1]))!==""&&Ve.charAt(0)!==","))return g5;Ve=Ve.replace(/^,/,"")}return ne}(ot);if(this.fontFaces){var Ot=function(ce,we){var ue=ce.getFontList(),ne=JSON.stringify(ue);if(U===null||ze!==ne){var Ve=function(it){var vt=[];return Object.keys(it).forEach(function(me){it[me].forEach(function(Ee){var ye=null;switch(Ee){case"bold":ye={family:me,weight:"bold"};break;case"italic":ye={family:me,style:"italic"};break;case"bolditalic":ye={family:me,weight:"bold",style:"italic"};break;case"":case"normal":ye={family:me}}ye!==null&&(ye.ref={name:me,style:Ee},vt.push(ye))})}),vt}(ue);U=function(it){for(var vt={},me=0;me<it.length;++me){var Ee=p5(it[me]),ye=Ee.family,We=Ee.stretch,ge=Ee.style,Ie=Ee.weight;vt[ye]=vt[ye]||{},vt[ye][We]=vt[ye][We]||{},vt[ye][We][ge]=vt[ye][We][ge]||{},vt[ye][We][ge][Ie]=Ee}return vt}(Ve.concat(we)),ze=ne}return U}(this.pdf,this.fontFaces),Tt=jt.map(function(ce){return{family:ce,stretch:"normal",weight:Be,style:ke}}),Qt=function(ce,we,ue){for(var ne=(ue=ue||{}).defaultFontFamily||"times",Ve=Object.assign({},rPe,ue.genericFontFamilies||{}),it=null,vt=null,me=0;me<we.length;++me)if(Ve[(it=p5(we[me])).family]&&(it.family=Ve[it.family]),ce.hasOwnProperty(it.family)){vt=ce[it.family];break}if(!(vt=vt||ce[ne]))throw new Error("Could not find a font-family for the rule '"+BV(it)+"' and default family '"+ne+"'.");if(vt=function(Ee,ye){if(ye[Ee])return ye[Ee];var We=qk[Ee],ge=We<=qk.normal?-1:1,Ie=PV(ye,Lre,We,ge);if(!Ie)throw new Error("Could not find a matching font-stretch value for "+Ee);return Ie}(it.stretch,vt),vt=function(Ee,ye){if(ye[Ee])return ye[Ee];for(var We=Mre[Ee],ge=0;ge<We.length;++ge)if(ye[We[ge]])return ye[We[ge]];throw new Error("Could not find a matching font-style for "+Ee)}(it.style,vt),!(vt=function(Ee,ye){if(ye[Ee])return ye[Ee];if(Ee===400&&ye[500])return ye[500];if(Ee===500&&ye[400])return ye[400];var We=tPe[Ee],ge=PV(ye,Ure,We,Ee<400?-1:1);if(!ge)throw new Error("Could not find a matching font-weight for value "+Ee);return ge}(it.weight,vt)))throw new Error("Failed to resolve a font for the rule '"+BV(it)+"'.");return vt}(Ot,Tt);this.pdf.setFont(Qt.ref.name,Qt.ref.style)}else{var Ft="";(Be==="bold"||parseInt(Be,10)>=700||ke==="bold")&&(Ft="bold"),ke==="italic"&&(Ft+="italic"),Ft.length===0&&(Ft="normal");for(var Qe="",De={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Je=0;Je<jt.length;Je++){if(this.pdf.internal.getFont(jt[Je],Ft,{noFallback:!0,disableWarning:!0})!==void 0){Qe=jt[Je];break}if(Ft==="bolditalic"&&this.pdf.internal.getFont(jt[Je],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Qe=jt[Je],Ft="bold";else if(this.pdf.internal.getFont(jt[Je],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Qe=jt[Je],Ft="normal";break}}if(Qe===""){for(var dt=0;dt<jt.length;dt++)if(De[jt[dt]]){Qe=De[jt[dt]];break}}Qe=Qe===""?"Times":Qe,this.pdf.setFont(Qe,Ft)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(J){this.ctx.globalCompositeOperation=J}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(J){this.ctx.globalAlpha=J}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(J){this.ctx.lineDashOffset=J,Ue.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(J){this.ctx.lineDash=J,Ue.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(J){this.ctx.ignoreClearRect=!!J}})};f.prototype.setLineDash=function(O){this.lineDash=O},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){w.call(this,"fill",!1)},f.prototype.stroke=function(){w.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(O,H){if(isNaN(O)||isNaN(H))throw hs.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var G=this.ctx.transform.applyToPoint(new o(O,H));this.path.push({type:"mt",x:G.x,y:G.y}),this.ctx.lastPoint=new o(O,H)},f.prototype.closePath=function(){var O=new o(0,0),H=0;for(H=this.path.length-1;H!==-1;H--)if(this.path[H].type==="begin"&&es(this.path[H+1])==="object"&&typeof this.path[H+1].x=="number"){O=new o(this.path[H+1].x,this.path[H+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(O.x,O.y)},f.prototype.lineTo=function(O,H){if(isNaN(O)||isNaN(H))throw hs.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var G=this.ctx.transform.applyToPoint(new o(O,H));this.path.push({type:"lt",x:G.x,y:G.y}),this.ctx.lastPoint=new o(G.x,G.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),w.call(this,null,!0)},f.prototype.quadraticCurveTo=function(O,H,G,L){if(isNaN(G)||isNaN(L)||isNaN(O)||isNaN(H))throw hs.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var W=this.ctx.transform.applyToPoint(new o(G,L)),X=this.ctx.transform.applyToPoint(new o(O,H));this.path.push({type:"qct",x1:X.x,y1:X.y,x:W.x,y:W.y}),this.ctx.lastPoint=new o(W.x,W.y)},f.prototype.bezierCurveTo=function(O,H,G,L,W,X){if(isNaN(W)||isNaN(X)||isNaN(O)||isNaN(H)||isNaN(G)||isNaN(L))throw hs.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var D=this.ctx.transform.applyToPoint(new o(W,X)),Q=this.ctx.transform.applyToPoint(new o(O,H)),Z=this.ctx.transform.applyToPoint(new o(G,L));this.path.push({type:"bct",x1:Q.x,y1:Q.y,x2:Z.x,y2:Z.y,x:D.x,y:D.y}),this.ctx.lastPoint=new o(D.x,D.y)},f.prototype.arc=function(O,H,G,L,W,X){if(isNaN(O)||isNaN(H)||isNaN(G)||isNaN(L)||isNaN(W))throw hs.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(X=!!X,!this.ctx.transform.isIdentity){var D=this.ctx.transform.applyToPoint(new o(O,H));O=D.x,H=D.y;var Q=this.ctx.transform.applyToPoint(new o(0,G)),Z=this.ctx.transform.applyToPoint(new o(0,0));G=Math.sqrt(Math.pow(Q.x-Z.x,2)+Math.pow(Q.y-Z.y,2))}Math.abs(W-L)>=2*Math.PI&&(L=0,W=2*Math.PI),this.path.push({type:"arc",x:O,y:H,radius:G,startAngle:L,endAngle:W,counterclockwise:X})},f.prototype.arcTo=function(O,H,G,L,W){throw new Error("arcTo not implemented.")},f.prototype.rect=function(O,H,G,L){if(isNaN(O)||isNaN(H)||isNaN(G)||isNaN(L))throw hs.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(O,H),this.lineTo(O+G,H),this.lineTo(O+G,H+L),this.lineTo(O,H+L),this.lineTo(O,H),this.lineTo(O+G,H),this.lineTo(O,H)},f.prototype.fillRect=function(O,H,G,L){if(isNaN(O)||isNaN(H)||isNaN(G)||isNaN(L))throw hs.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var W={};this.lineCap!=="butt"&&(W.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(W.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(O,H,G,L),this.fill(),W.hasOwnProperty("lineCap")&&(this.lineCap=W.lineCap),W.hasOwnProperty("lineJoin")&&(this.lineJoin=W.lineJoin)}},f.prototype.strokeRect=function(O,H,G,L){if(isNaN(O)||isNaN(H)||isNaN(G)||isNaN(L))throw hs.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(O,H,G,L),this.stroke())},f.prototype.clearRect=function(O,H,G,L){if(isNaN(O)||isNaN(H)||isNaN(G)||isNaN(L))throw hs.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(O,H,G,L))},f.prototype.save=function(O){O=typeof O!="boolean"||O;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,G=0;G<this.pdf.internal.getNumberOfPages();G++)this.pdf.setPage(G+1),this.pdf.internal.out("q");if(this.pdf.setPage(H),O){this.ctx.fontSize=this.pdf.internal.getFontSize();var L=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=L}},f.prototype.restore=function(O){O=typeof O!="boolean"||O;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,G=0;G<this.pdf.internal.getNumberOfPages();G++)this.pdf.setPage(G+1),this.pdf.internal.out("Q");this.pdf.setPage(H),O&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var A=function(O){var H,G,L,W;if(O.isCanvasGradient===!0&&(O=O.getColor()),!O)return{r:0,g:0,b:0,a:0,style:O};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(O))H=0,G=0,L=0,W=0;else{var X=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(O);if(X!==null)H=parseInt(X[1]),G=parseInt(X[2]),L=parseInt(X[3]),W=1;else if((X=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(O))!==null)H=parseInt(X[1]),G=parseInt(X[2]),L=parseInt(X[3]),W=parseFloat(X[4]);else{if(W=1,typeof O=="string"&&O.charAt(0)!=="#"){var D=new Tre(O);O=D.ok?D.toHex():"#000000"}O.length===4?(H=O.substring(1,2),H+=H,G=O.substring(2,3),G+=G,L=O.substring(3,4),L+=L):(H=O.substring(1,3),G=O.substring(3,5),L=O.substring(5,7)),H=parseInt(H,16),G=parseInt(G,16),L=parseInt(L,16)}}return{r:H,g:G,b:L,a:W,style:O}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(O,H,G,L){if(isNaN(H)||isNaN(G)||typeof O!="string")throw hs.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(L=isNaN(L)?void 0:L,!h.call(this)){var W=Ae(this.ctx.transform.rotation),X=this.ctx.transform.scaleX;T.call(this,{text:O,x:H,y:G,scale:X,angle:W,align:this.textAlign,maxWidth:L})}},f.prototype.strokeText=function(O,H,G,L){if(isNaN(H)||isNaN(G)||typeof O!="string")throw hs.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){L=isNaN(L)?void 0:L;var W=Ae(this.ctx.transform.rotation),X=this.ctx.transform.scaleX;T.call(this,{text:O,x:H,y:G,scale:X,renderingMode:"stroke",angle:W,align:this.textAlign,maxWidth:L})}},f.prototype.measureText=function(O){if(typeof O!="string")throw hs.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var H=this.pdf,G=this.pdf.internal.scaleFactor,L=H.internal.getFontSize(),W=H.getStringUnitWidth(O)*L/H.internal.scaleFactor;return new function(X){var D=(X=X||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return D}}),this}({width:W*=Math.round(96*G/72*1e4)/1e4})},f.prototype.scale=function(O,H){if(isNaN(O)||isNaN(H))throw hs.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var G=new c(O,0,0,H,0,0);this.ctx.transform=this.ctx.transform.multiply(G)},f.prototype.rotate=function(O){if(isNaN(O))throw hs.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var H=new c(Math.cos(O),Math.sin(O),-Math.sin(O),Math.cos(O),0,0);this.ctx.transform=this.ctx.transform.multiply(H)},f.prototype.translate=function(O,H){if(isNaN(O)||isNaN(H))throw hs.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var G=new c(1,0,0,1,O,H);this.ctx.transform=this.ctx.transform.multiply(G)},f.prototype.transform=function(O,H,G,L,W,X){if(isNaN(O)||isNaN(H)||isNaN(G)||isNaN(L)||isNaN(W)||isNaN(X))throw hs.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var D=new c(O,H,G,L,W,X);this.ctx.transform=this.ctx.transform.multiply(D)},f.prototype.setTransform=function(O,H,G,L,W,X){O=isNaN(O)?1:O,H=isNaN(H)?0:H,G=isNaN(G)?0:G,L=isNaN(L)?1:L,W=isNaN(W)?0:W,X=isNaN(X)?0:X,this.ctx.transform=new c(O,H,G,L,W,X)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(O,H,G,L,W,X,D,Q,Z){var be=this.pdf.getImageProperties(O),U=1,ze=1,re=1,J=1;L!==void 0&&Q!==void 0&&(re=Q/L,J=Z/W,U=be.width/L*Q/L,ze=be.height/W*Z/W),X===void 0&&(X=H,D=G,H=0,G=0),L!==void 0&&Q===void 0&&(Q=L,Z=W),L===void 0&&Q===void 0&&(Q=be.width,Z=be.height);var Re=this.ctx.transform.decompose(),ke=Ae(Re.rotate.shx),Be=new c,Ye=(Be=(Be=(Be=Be.multiply(Re.translate)).multiply(Re.skew)).multiply(Re.scale)).applyToRectangle(new l(X-H*re,D-G*J,L*U,W*ze));if(this.autoPaging){for(var ot,Ct=x.call(this,Ye),jt=[],Ot=0;Ot<Ct.length;Ot+=1)jt.indexOf(Ct[Ot])===-1&&jt.push(Ct[Ot]);b(jt);for(var Tt=jt[0],Qt=jt[jt.length-1],Ft=Tt;Ft<Qt+1;Ft++){this.pdf.setPage(Ft);var Qe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],De=Ft===1?this.posY+this.margin[0]:this.margin[0],Je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],dt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ce=Ft===1?0:Je+(Ft-2)*dt;if(this.ctx.clip_path.length!==0){var we=this.path;ot=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(ot,this.posX+this.margin[3],-ce+De+this.ctx.prevPageLastElemOffset),j.call(this,"fill",!0),this.path=we}var ue=JSON.parse(JSON.stringify(Ye));ue=y([ue],this.posX+this.margin[3],-ce+De+this.ctx.prevPageLastElemOffset)[0];var ne=(Ft>Tt||Ft<Qt)&&p.call(this);ne&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Qe,dt,null).clip().discardPath()),this.pdf.addImage(O,"JPEG",ue.x,ue.y,ue.w,ue.h,null,null,ke),ne&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(O,"JPEG",Ye.x,Ye.y,Ye.w,Ye.h,null,null,ke)};var x=function(O,H,G){var L=[];H=H||this.pdf.internal.pageSize.width,G=G||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var W=this.posY+this.ctx.prevPageLastElemOffset;switch(O.type){default:case"mt":case"lt":L.push(Math.floor((O.y+W)/G)+1);break;case"arc":L.push(Math.floor((O.y+W-O.radius)/G)+1),L.push(Math.floor((O.y+W+O.radius)/G)+1);break;case"qct":var X=te(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x,O.y);L.push(Math.floor((X.y+W)/G)+1),L.push(Math.floor((X.y+X.h+W)/G)+1);break;case"bct":var D=Te(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x2,O.y2,O.x,O.y);L.push(Math.floor((D.y+W)/G)+1),L.push(Math.floor((D.y+D.h+W)/G)+1);break;case"rect":L.push(Math.floor((O.y+W)/G)+1),L.push(Math.floor((O.y+O.h+W)/G)+1)}for(var Q=0;Q<L.length;Q+=1)for(;this.pdf.internal.getNumberOfPages()<L[Q];)v.call(this);return L},v=function(){var O=this.fillStyle,H=this.strokeStyle,G=this.font,L=this.lineCap,W=this.lineWidth,X=this.lineJoin;this.pdf.addPage(),this.fillStyle=O,this.strokeStyle=H,this.font=G,this.lineCap=L,this.lineWidth=W,this.lineJoin=X},y=function(O,H,G){for(var L=0;L<O.length;L++)switch(O[L].type){case"bct":O[L].x2+=H,O[L].y2+=G;case"qct":O[L].x1+=H,O[L].y1+=G;default:O[L].x+=H,O[L].y+=G}return O},b=function(O){return O.sort(function(H,G){return H-G})},w=function(O,H){var G=this.fillStyle,L=this.strokeStyle,W=this.lineCap,X=this.lineWidth,D=Math.abs(X*this.ctx.transform.scaleX),Q=this.lineJoin;if(this.autoPaging){for(var Z,be,U=JSON.parse(JSON.stringify(this.path)),ze=JSON.parse(JSON.stringify(this.path)),re=[],J=0;J<ze.length;J++)if(ze[J].x!==void 0)for(var Re=x.call(this,ze[J]),ke=0;ke<Re.length;ke+=1)re.indexOf(Re[ke])===-1&&re.push(Re[ke]);for(var Be=0;Be<re.length;Be++)for(;this.pdf.internal.getNumberOfPages()<re[Be];)v.call(this);b(re);for(var Ye=re[0],ot=re[re.length-1],Ct=Ye;Ct<ot+1;Ct++){this.pdf.setPage(Ct),this.fillStyle=G,this.strokeStyle=L,this.lineCap=W,this.lineWidth=D,this.lineJoin=Q;var jt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ot=Ct===1?this.posY+this.margin[0]:this.margin[0],Tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ft=Ct===1?0:Tt+(Ct-2)*Qt;if(this.ctx.clip_path.length!==0){var Qe=this.path;Z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(Z,this.posX+this.margin[3],-Ft+Ot+this.ctx.prevPageLastElemOffset),j.call(this,O,!0),this.path=Qe}if(be=JSON.parse(JSON.stringify(U)),this.path=y(be,this.posX+this.margin[3],-Ft+Ot+this.ctx.prevPageLastElemOffset),H===!1||Ct===0){var De=(Ct>Ye||Ct<ot)&&p.call(this);De&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],jt,Qt,null).clip().discardPath()),j.call(this,O,H),De&&this.pdf.restoreGraphicsState()}this.lineWidth=X}this.path=U}else this.lineWidth=D,j.call(this,O,H),this.lineWidth=X},j=function(O,H){if((O!=="stroke"||H||!m.call(this))&&(O==="stroke"||H||!h.call(this))){for(var G,L,W=[],X=this.path,D=0;D<X.length;D++){var Q=X[D];switch(Q.type){case"begin":W.push({begin:!0});break;case"close":W.push({close:!0});break;case"mt":W.push({start:Q,deltas:[],abs:[]});break;case"lt":var Z=W.length;if(X[D-1]&&!isNaN(X[D-1].x)&&(G=[Q.x-X[D-1].x,Q.y-X[D-1].y],Z>0)){for(;Z>=0;Z--)if(W[Z-1].close!==!0&&W[Z-1].begin!==!0){W[Z-1].deltas.push(G),W[Z-1].abs.push(Q);break}}break;case"bct":G=[Q.x1-X[D-1].x,Q.y1-X[D-1].y,Q.x2-X[D-1].x,Q.y2-X[D-1].y,Q.x-X[D-1].x,Q.y-X[D-1].y],W[W.length-1].deltas.push(G);break;case"qct":var be=X[D-1].x+2/3*(Q.x1-X[D-1].x),U=X[D-1].y+2/3*(Q.y1-X[D-1].y),ze=Q.x+2/3*(Q.x1-Q.x),re=Q.y+2/3*(Q.y1-Q.y),J=Q.x,Re=Q.y;G=[be-X[D-1].x,U-X[D-1].y,ze-X[D-1].x,re-X[D-1].y,J-X[D-1].x,Re-X[D-1].y],W[W.length-1].deltas.push(G);break;case"arc":W.push({deltas:[],abs:[],arc:!0}),Array.isArray(W[W.length-1].abs)&&W[W.length-1].abs.push(Q)}}L=H?null:O==="stroke"?"stroke":"fill";for(var ke=!1,Be=0;Be<W.length;Be++)if(W[Be].arc)for(var Ye=W[Be].abs,ot=0;ot<Ye.length;ot++){var Ct=Ye[ot];Ct.type==="arc"?S.call(this,Ct.x,Ct.y,Ct.radius,Ct.startAngle,Ct.endAngle,Ct.counterclockwise,void 0,H,!ke):P.call(this,Ct.x,Ct.y),ke=!0}else if(W[Be].close===!0)this.pdf.internal.out("h"),ke=!1;else if(W[Be].begin!==!0){var jt=W[Be].start.x,Ot=W[Be].start.y;K.call(this,W[Be].deltas,jt,Ot),ke=!0}L&&E.call(this,L),H&&B.call(this)}},I=function(O){var H=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,G=H*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return O-G;case"top":return O+H-G;case"hanging":return O+H-2*G;case"middle":return O+H/2-G;default:return O}},C=function(O){return O+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var O=function(){};return O.colorStops=[],O.addColorStop=function(H,G){this.colorStops.push([H,G])},O.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},O.isCanvasGradient=!0,O},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var S=function(O,H,G,L,W,X,D,Q,Z){for(var be=oe.call(this,G,L,W,X),U=0;U<be.length;U++){var ze=be[U];U===0&&(Z?k.call(this,ze.x1+O,ze.y1+H):P.call(this,ze.x1+O,ze.y1+H)),le.call(this,O,H,ze.x2,ze.y2,ze.x3,ze.y3,ze.x4,ze.y4)}Q?B.call(this):E.call(this,D)},E=function(O){switch(O){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(O,H){this.pdf.internal.out(r(O)+" "+n(H)+" m")},T=function(O){var H;switch(O.align){case"right":case"end":H="right";break;case"center":H="center";break;default:H="left"}var G,L,W,X=this.pdf.getTextDimensions(O.text),D=I.call(this,O.y),Q=C.call(this,D)-X.h,Z=this.ctx.transform.applyToPoint(new o(O.x,D));if(this.autoPaging){var be=this.ctx.transform.decompose(),U=new c;U=(U=(U=U.multiply(be.translate)).multiply(be.skew)).multiply(be.scale);for(var ze=this.ctx.transform.applyToRectangle(new l(O.x,D,X.w,X.h)),re=U.applyToRectangle(new l(O.x,Q,X.w,X.h)),J=x.call(this,re),Re=[],ke=0;ke<J.length;ke+=1)Re.indexOf(J[ke])===-1&&Re.push(J[ke]);b(Re);for(var Be=Re[0],Ye=Re[Re.length-1],ot=Be;ot<Ye+1;ot++){this.pdf.setPage(ot);var Ct=ot===1?this.posY+this.margin[0]:this.margin[0],jt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ot=this.pdf.internal.pageSize.height-this.margin[2],Tt=Ot-this.margin[0],Qt=this.pdf.internal.pageSize.width-this.margin[1],Ft=Qt-this.margin[3],Qe=ot===1?0:jt+(ot-2)*Tt;if(this.ctx.clip_path.length!==0){var De=this.path;G=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(G,this.posX+this.margin[3],-1*Qe+Ct),j.call(this,"fill",!0),this.path=De}var Je=y([JSON.parse(JSON.stringify(re))],this.posX+this.margin[3],-Qe+Ct+this.ctx.prevPageLastElemOffset)[0];O.scale>=.01&&(L=this.pdf.internal.getFontSize(),this.pdf.setFontSize(L*O.scale),W=this.lineWidth,this.lineWidth=W*O.scale);var dt=this.autoPaging!=="text";if(dt||Je.y+Je.h<=Ot){if(dt||Je.y>=Ct&&Je.x<=Qt){var ce=dt?O.text:this.pdf.splitTextToSize(O.text,O.maxWidth||Qt-Je.x)[0],we=y([JSON.parse(JSON.stringify(ze))],this.posX+this.margin[3],-Qe+Ct+this.ctx.prevPageLastElemOffset)[0],ue=dt&&(ot>Be||ot<Ye)&&p.call(this);ue&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ft,Tt,null).clip().discardPath()),this.pdf.text(ce,we.x,we.y,{angle:O.angle,align:H,renderingMode:O.renderingMode}),ue&&this.pdf.restoreGraphicsState()}}else Je.y<Ot&&(this.ctx.prevPageLastElemOffset+=Ot-Je.y);O.scale>=.01&&(this.pdf.setFontSize(L),this.lineWidth=W)}}else O.scale>=.01&&(L=this.pdf.internal.getFontSize(),this.pdf.setFontSize(L*O.scale),W=this.lineWidth,this.lineWidth=W*O.scale),this.pdf.text(O.text,Z.x+this.posX,Z.y+this.posY,{angle:O.angle,align:H,renderingMode:O.renderingMode,maxWidth:O.maxWidth}),O.scale>=.01&&(this.pdf.setFontSize(L),this.lineWidth=W)},P=function(O,H,G,L){G=G||0,L=L||0,this.pdf.internal.out(r(O+G)+" "+n(H+L)+" l")},K=function(O,H,G){return this.pdf.lines(O,H,G,null,null)},le=function(O,H,G,L,W,X,D,Q){this.pdf.internal.out([e(a(G+O)),e(s(L+H)),e(a(W+O)),e(s(X+H)),e(a(D+O)),e(s(Q+H)),"c"].join(" "))},oe=function(O,H,G,L){for(var W=2*Math.PI,X=Math.PI/2;H>G;)H-=W;var D=Math.abs(G-H);D<W&&L&&(D=W-D);for(var Q=[],Z=L?-1:1,be=H;D>1e-5;){var U=be+Z*Math.min(D,X);Q.push(ie.call(this,O,be,U)),D-=Math.abs(U-be),be=U}return Q},ie=function(O,H,G){var L=(G-H)/2,W=O*Math.cos(L),X=O*Math.sin(L),D=W,Q=-X,Z=D*D+Q*Q,be=Z+D*W+Q*X,U=4/3*(Math.sqrt(2*Z*be)-be)/(D*X-Q*W),ze=D-U*Q,re=Q+U*D,J=ze,Re=-re,ke=L+H,Be=Math.cos(ke),Ye=Math.sin(ke);return{x1:O*Math.cos(H),y1:O*Math.sin(H),x2:ze*Be-re*Ye,y2:ze*Ye+re*Be,x3:J*Be-Re*Ye,y3:J*Ye+Re*Be,x4:O*Math.cos(G),y4:O*Math.sin(G)}},Ae=function(O){return 180*O/Math.PI},te=function(O,H,G,L,W,X){var D=O+.5*(G-O),Q=H+.5*(L-H),Z=W+.5*(G-W),be=X+.5*(L-X),U=Math.min(O,W,D,Z),ze=Math.max(O,W,D,Z),re=Math.min(H,X,Q,be),J=Math.max(H,X,Q,be);return new l(U,re,ze-U,J-re)},Te=function(O,H,G,L,W,X,D,Q){var Z,be,U,ze,re,J,Re,ke,Be,Ye,ot,Ct,jt,Ot,Tt=G-O,Qt=L-H,Ft=W-G,Qe=X-L,De=D-W,Je=Q-X;for(be=0;be<41;be++)Be=(Re=(U=O+(Z=be/40)*Tt)+Z*((re=G+Z*Ft)-U))+Z*(re+Z*(W+Z*De-re)-Re),Ye=(ke=(ze=H+Z*Qt)+Z*((J=L+Z*Qe)-ze))+Z*(J+Z*(X+Z*Je-J)-ke),be==0?(ot=Be,Ct=Ye,jt=Be,Ot=Ye):(ot=Math.min(ot,Be),Ct=Math.min(Ct,Ye),jt=Math.max(jt,Be),Ot=Math.max(Ot,Ye));return new l(Math.round(ot),Math.round(Ct),Math.round(jt-ot),Math.round(Ot-Ct))},Ue=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var O,H,G=(O=this.ctx.lineDash,H=this.ctx.lineDashOffset,JSON.stringify({lineDash:O,lineDashOffset:H}));this.prevLineDash!==G&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=G)}}})(an.API),function(t){var e=function(o){var l,c,u,d,f,A,h,m,p,x;for(c=[],u=0,d=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;d>u;u+=4)(f=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(A=(f=((f=((f=((f=(f-(x=f%85))/85)-(p=f%85))/85)-(m=f%85))/85)-(h=f%85))/85)%85,c.push(A+33,h+33,m+33,p+33,x+33)):c.push(122);return function(v,y){for(var b=y;b>0;b--)v.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,d,f,A=String,h="length",m=255,p="charCodeAt",x="slice",v="replace";for(o[x](-2),o=o[x](0,-2)[v](/\s/g,"")[v]("z","!!!!!"),u=[],d=0,f=(o+=l="uuuuu"[x](o[h]%5||5))[h];f>d;d+=5)c=52200625*(o[p](d)-33)+614125*(o[p](d+1)-33)+7225*(o[p](d+2)-33)+85*(o[p](d+3)-33)+(o[p](d+4)-33),u.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(y,b){for(var w=b;w>0;w--)y.pop()}(u,l[h]),A.fromCharCode.apply(A,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=Uk(l)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};t.processDataByFilters=function(o,l){var c=0,u=o||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=a(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(an.API),function(t){t.loadFile=function(e,r,n){return function(a,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var f=new XMLHttpRequest,A=0,h=function(m){var p=m.length,x=[],v=String.fromCharCode;for(A=0;A<p;A+=1)x.push(v(255&m.charCodeAt(A)));return x.join("")};if(f.open("GET",c,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(h(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return h(f.responseText)}(a,s,o)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(an.API),function(t){function e(){return(Ln.html2canvas?Promise.resolve(Ln.html2canvas):oA(()=>Promise.resolve().then(()=>G6),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Ln.DOMPurify?Promise.resolve(Ln.DOMPurify):oA(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=es(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var u=document.createElement(l);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},s=function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)u!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||d.appendChild(l(f,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return(d=d.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(u){return this.set({src:a("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,A=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete A.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var m=d[h],p=m.src.find(function(x){return x.format==="truetype"});p&&u.addFont(p.url,m.ref.name,m.ref.style)}return A.windowHeight=A.windowHeight||0,A.windowHeight=A.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):A.windowHeight,u.context2d.save(!0),c(this.prop.container,A)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(l=l||an.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,d){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,d){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(d,f){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(A){return u.updateProgress(null,d),A}).then(d,f).then(function(A){return u.updateProgress(1),A})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var d=this;l&&(l=l.bind(d)),c&&(c=c.bind(d));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),A=u.call(f,l,c);return o.convert(A,d.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,an.getPageSize=function(l,c,u){if(es(l)==="object"){var d=l;l=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var f,A=(""+u).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var m,p=0,x=0;if(h.hasOwnProperty(A))p=h[A][1]/f,x=h[A][0]/f;else try{p=u[1],x=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",x>p&&(m=x,x=p,p=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",p>x&&(m=x,x=p,p=m)}return{width:x,height:p,unit:c,k:f,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(p5):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(an.API),an.API.addJS=function(t){return OV=t,this.internal.events.subscribe("postPutResources",function(){MC=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(MC+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),FV=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+OV+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){MC!==void 0&&FV!==void 0&&this.internal.out("/Names <</JavaScript "+MC+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),s=0;s<a.length;s++){var o=a[s],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var f=r.internal.newObject();d.push(f);var A=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+A.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<d.length;s++)r.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,s){var o={title:a,options:s,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var o=n.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var s=0;s<a.children.length;s++)n.count++,this.count_r(n,a.children[s]);return n.count}}])}(an.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,a,s,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var A,h=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,p={width:0,height:0,numcomponents:1},x=4;x<m;x+=2){if(x+=h,e.indexOf(f.charCodeAt(x+1))!==-1){A=256*f.charCodeAt(x+5)+f.charCodeAt(x+6),p={width:256*f.charCodeAt(x+7)+f.charCodeAt(x+8),height:A,numcomponents:f.charCodeAt(x+9)};break}h=256*f.charCodeAt(x+2)+f.charCodeAt(x+3)}return p}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:a}}return d}}(an.API),an.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var a,s=Uje(t,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,d=s.depth;a=u&&c===1?function(S){for(var E=S.width,B=S.height,k=S.data,T=S.palette,P=S.depth,K=!1,le=[],oe=[],ie=void 0,Ae=!1,te=0,Te=0;Te<T.length;Te++){var Ue=LQ(T[Te],4),O=Ue[0],H=Ue[1],G=Ue[2],L=Ue[3];le.push(O,H,G),L!=null&&(L===0?(te++,oe.length<1&&oe.push(Te)):L<255&&(Ae=!0))}if(Ae||te>1){K=!0,oe=void 0;var W=E*B;ie=new Uint8Array(W);for(var X=new DataView(k.buffer),D=0;D<W;D++){var Q=x5(X,D,P),Z=LQ(T[Q],4)[3];ie[D]=Z}}else te===0&&(oe=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:K?8:void 0,colorBytes:k,alphaBytes:ie,needSMask:K,palette:le,mask:oe}}(s):c===2||c===4?function(S){for(var E=S.data,B=S.width,k=S.height,T=S.channels,P=S.depth,K=T===2?"DeviceGray":"DeviceRGB",le=T-1,oe=B*k,ie=le,Ae=oe*ie,te=1*oe,Te=Math.ceil(Ae*P/8),Ue=Math.ceil(te*P/8),O=new Uint8Array(Te),H=new Uint8Array(Ue),G=new DataView(E.buffer),L=new DataView(O.buffer),W=new DataView(H.buffer),X=!1,D=0;D<oe;D++){for(var Q=D*T,Z=0;Z<ie;Z++)$V(L,x5(G,Q+Z,P),D*ie+Z,P);var be=x5(G,Q+ie,P);be<(1<<P)-1&&(X=!0),$V(W,be,1*D,P)}return{colorSpace:K,colorsPerPixel:le,sMaskBitsPerComponent:X?P:void 0,colorBytes:O,alphaBytes:H,needSMask:X}}(s):function(S){var E=S.data,B=S.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:B,colorsPerPixel:B==="DeviceGray"?1:3,colorBytes:E instanceof Uint16Array?function(k){for(var T=k.length,P=new Uint8Array(2*T),K=new DataView(P.buffer,P.byteOffset,P.byteLength),le=0;le<T;le++)K.setUint16(2*le,k[le],!1);return P}(E):E,needSMask:!1}}(s);var f,A,h,m=a,p=m.colorSpace,x=m.colorsPerPixel,v=m.sMaskBitsPerComponent,y=m.colorBytes,b=m.alphaBytes,w=m.needSMask,j=m.palette,I=m.mask,C=null;return n!==an.API.image_compression.NONE&&typeof Uk=="function"?(C=function(S){var E;switch(S){case an.API.image_compression.FAST:E=11;break;case an.API.image_compression.MEDIUM:E=13;break;case an.API.image_compression.SLOW:E=14;break;default:E=12}return E}(n),f=this.decode.FLATE_DECODE,A="/Predictor ".concat(C," /Colors ").concat(x," /BitsPerComponent ").concat(d," /Columns ").concat(o),t=LV(y,Math.ceil(o*x*d/8),x,d,n),w&&(h=LV(b,Math.ceil(o*v/8),1,v,n))):(f=void 0,A=void 0,t=y,w&&(h=b)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:t,index:e,filter:f,decodeParameters:A,transparency:I,palette:j,sMask:h,predictor:C,width:o,height:l,bitsPerComponent:d,sMaskBitsPerComponent:v,colorSpace:p}}},function(t){t.processGIF89A=function(e,r,n,a){var s=new lPe(e),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new v5(100).encode(u,100);return t.processJPEG.call(this,d,r,n,a)},t.processGIF87A=t.processGIF89A}(an.API),Xd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:a,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Xd.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){hs.log("bit decode error:"+r)}},Xd.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<e;a++)for(var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Xd.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<t;a++){var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*a+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Xd.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},Xd.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,l=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,u=s>>15?255:0,d=n*this.width*4+4*a;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=t}},Xd.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/e*255|0,d=a*this.width*4+4*s;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=t}},Xd.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Xd.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=s,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=o}},Xd.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,a){var s=new Xd(e,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new v5(100).encode(c,100);return t.processJPEG.call(this,u,r,n,a)}}(an.API),KV.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,a){var s=new KV(e),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new v5(100).encode(c,100);return t.processJPEG.call(this,u,r,n,a)}}(an.API),an.API.processRGBA=function(t,e,r){for(var n=t.data,a=n.length,s=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,c=0,u=0;u<a;u+=4){var d=n[u],f=n[u+1],A=n[u+2],h=n[u+3];s[l++]=d,s[l++]=f,s[l++]=A,o[c++]=h}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},an.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Ax=an.API,LC=Ax.getCharWidthsArray=function(t,e){var r,n,a=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:a.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=e.doKerning!==!1,A=0,h=t.length,m=0,p=l[0]||c,x=[];for(r=0;r<h;r++)n=t.charCodeAt(r),typeof a.metadata.widthOfString=="function"?x.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/s)||0)/1e3):(A=f&&es(u[n])==="object"&&!isNaN(parseInt(u[n][m],10))?u[n][m]/d:0,x.push((l[n]||p)/c+A)),m=n;return x},DV=Ax.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),a=e.charSpace||this.internal.getCharSpace();return Ax.processArabic&&(t=Ax.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,a)/r:LC.apply(this,arguments).reduce(function(s,o){return s+o},0)},RV=function(t,e,r,n){for(var a=[],s=0,o=t.length,l=0;s!==o&&l+e[s]<r;)l+=e[s],s++;a.push(t.slice(0,s));var c=s;for(l=0;s!==o;)l+e[s]>n&&(a.push(t.slice(c,s)),l=0,c=s),l+=e[s],s++;return c!==s&&a.push(t.slice(c,s)),a},MV=function(t,e,r){r||(r={});var n,a,s,o,l,c,u,d=[],f=[d],A=r.textIndent||0,h=0,m=0,p=t.split(" "),x=LC.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?p[0].length+2:r.lineIndent||0){var v=Array(c).join(" "),y=[];p.map(function(w){(w=w.split(/\s*\n/)).length>1?y=y.concat(w.map(function(j,I){return(I&&j.length?`
`:"")+j})):y.push(w[0])}),p=y,c=DV.apply(this,[v,r])}for(s=0,o=p.length;s<o;s++){var b=0;if(n=p[s],c&&n[0]==`
`&&(n=n.substr(1),b=1),A+h+(m=(a=LC.apply(this,[n,r])).reduce(function(w,j){return w+j},0))>e||b){if(m>e){for(l=RV.apply(this,[n,a,e-(A+h),e]),d.push(l.shift()),d=[l.pop()];l.length;)f.push([l.shift()]);m=a.slice(n.length-(d[0]?d[0].length:0)).reduce(function(w,j){return w+j},0)}else d=[n];f.push(d),A=m+c,h=x}else d.push(n),A+=h+m,h=x}return u=c?function(w,j){return(j?v:"")+w.join(" ")}:function(w){return w.join(" ")},f.map(u)},Ax.splitTextToSize=function(t,e,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle),A="Unicode";return f.metadata[A]?{widths:f.metadata[A].widths||{0:1},kerning:f.metadata[A].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/a;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(MV.apply(this,[n[l],o,s]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},s=0;s<16;s++)n[r[s]]=e[s],a[e[s]]=r[s];var o=function(A){return"0x"+parseInt(A,10).toString(16)},l=t.__fontmetrics__.compress=function(A){var h,m,p,x,v=["{"];for(var y in A){if(h=A[y],isNaN(parseInt(y,10))?m="'"+y+"'":(y=parseInt(y,10),m=(m=o(y).slice(2)).slice(0,-1)+a[m.slice(-1)]),typeof h=="number")h<0?(p=o(h).slice(3),x="-"):(p=o(h).slice(2),x=""),p=x+p.slice(0,-1)+a[p.slice(-1)];else{if(es(h)!=="object")throw new Error("Don't know what to do with value type "+es(h)+".");p=l(h)}v.push(m+p)}return v.push("}"),v.join("")},c=t.__fontmetrics__.uncompress=function(A){if(typeof A!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,m,p,x,v={},y=1,b=v,w=[],j="",I="",C=A.length-1,S=1;S<C;S+=1)(x=A[S])=="'"?h?(p=h.join(""),h=void 0):h=[]:h?h.push(x):x=="{"?(w.push([b,p]),b={},p=void 0):x=="}"?((m=w.pop())[0][m[1]]=b,p=void 0,b=m[0]):x=="-"?y=-1:p===void 0?n.hasOwnProperty(x)?(j+=n[x],p=parseInt(j,16)*y,y=1,j=""):j+=x:n.hasOwnProperty(x)?(I+=n[x],b[p]=parseInt(I,16)*y,y=1,p=void 0,I=""):I+=x;return v},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(A){var h=A.font,m=f.Unicode[h.postScriptName];m&&(h.metadata.Unicode={},h.metadata.Unicode.widths=m.widths,h.metadata.Unicode.kerning=m.kerning);var p=d.Unicode[h.postScriptName];p&&(h.metadata.Unicode.encoding=p,h.encoding=p.codePages[0])}])}(an.API),function(t){var e=function(r){for(var n=r.length,a=new Uint8Array(n),s=0;s<n;s++)a[s]=r.charCodeAt(s);return a};t.API.events.push(["addFont",function(r){var n=void 0,a=r.font,s=r.instance;if(!a.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=s.existsFileInVFS(a.postScriptName)===!1?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(gE(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])}(an),an.API.addSvgAsImage=function(t,e,r,n,a,s,o,l){if(isNaN(e)||isNaN(r))throw hs.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw hs.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Ln.canvg?Promise.resolve(Ln.canvg):oA(()=>import("./index.es-DvI81cv0.js"),[])).catch(function(A){return Promise.reject(new Error("Could not load canvg: "+A))}).then(function(A){return A.default?A.default:A}).then(function(A){return A.fromString(u,t,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(A){return A.render(d)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),e,r,n,a,o,l)})},an.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(e,r);return this},an.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,a,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,f=0;function A(m,p){var x,v=!1;for(x=0;x<m.length;x+=1)m[x]===p&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var h=l.length;for(f=0;f<h;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(es(t)==="object"){for(a in t)if(s=t[a],A(l,a)&&s!==void 0){if(r[a].type==="boolean"&&typeof s=="boolean")r[a].value=s;else if(r[a].type==="name"&&A(r[a].valueSet,s))r[a].value=s;else if(r[a].type==="integer"&&Number.isInteger(s))r[a].value=s;else if(r[a].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(n=!1);n===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,p=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?p.push("/"+m+" /"+r[m].value):p.push("/"+m+" "+r[m].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=s.length+o.length+l.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(a+s+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(an.API),function(t){var e=t.API,r=e.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,A=s.length;f<A;++f){if(l=o.metadata.characterToGlyph(s.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(s){var o,l,c,u,d,f,A;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,A=(l=Object.keys(s).sort(function(h,m){return h-m})).length;f<A;f++)o=l[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,A=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",m=0;m<A.length;m++)h+=String.fromCharCode(A[m]);var p=u();d({data:h,addLength1:!0,objectId:p}),c("endobj");var x=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var v=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Fx(l.fontName)),c("/FontFile2 "+p+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var y=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Fx(l.fontName)),c("/FontDescriptor "+v+" 0 R"),c("/W "+t.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+x+" 0 R"),c("/BaseFont /"+Fx(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+y+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,A="",h=0;h<f.length;h++)A+=String.fromCharCode(f[h]);var m=u();d({data:A,addLength1:!0,objectId:m}),c("endobj");var p=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var x=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Fx(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var v=0;v<l.metadata.hmtx.widths.length;v++)l.metadata.hmtx.widths[v]=parseInt(l.metadata.hmtx.widths[v]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+Fx(l.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var a=function(s){var o,l=s.text||"",c=s.x,u=s.y,d=s.options||{},f=s.mutex||{},A=f.pdfEscape,h=f.activeFontKey,m=f.fonts,p=h,x="",v=0,y="",b=m[p].encoding;if(m[p].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:f};for(y=l,p=h,Array.isArray(l)&&(y=l[0]),v=0;v<y.length;v+=1)m[p].metadata.hasOwnProperty("cmap")&&(o=m[p].metadata.cmap.unicode.codeMap[y[v].charCodeAt(0)]),o||y[v].charCodeAt(0)<256&&m[p].metadata.hasOwnProperty("Unicode")?x+=y[v]:x+="";var w="";return parseInt(p.slice(1))<14||b==="WinAnsiEncoding"?w=A(x,p).split("").map(function(j){return j.charCodeAt(0).toString(16)}).join(""):b==="Identity-H"&&(w=r(x,m[p])),f.isHex=!0,{text:w,x:c,y:u,options:d,mutex:f}};e.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([a(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(a(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=a(Object.assign({},c,{text:o})).text}])}(an),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(an.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var a,s,o,l,c,u,d,f=e,A=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),y=!1,b=0;this.__bidiEngine__={};var w=function(k){var T=k.charCodeAt(),P=T>>8,K=p[P];return K!==void 0?f[256*K+(255&T)]:P===252||P===253?"AL":v.test(P)?"L":P===8?"R":"N"},j=function(k){for(var T,P=0;P<k.length;P++){if((T=w(k.charAt(P)))==="L")return!1;if(T==="R")return!0}return!1},I=function(k,T,P,K){var le,oe,ie,Ae,te=T[K];switch(te){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":y=!1;break;case"N":case"AN":break;case"EN":y&&(te="AN");break;case"AL":y=!0,te="R";break;case"WS":case"BN":te="N";break;case"CS":K<1||K+1>=T.length||(le=P[K-1])!=="EN"&&le!=="AN"||(oe=T[K+1])!=="EN"&&oe!=="AN"?te="N":y&&(oe="AN"),te=oe===le?oe:"N";break;case"ES":te=(le=K>0?P[K-1]:"B")==="EN"&&K+1<T.length&&T[K+1]==="EN"?"EN":"N";break;case"ET":if(K>0&&P[K-1]==="EN"){te="EN";break}if(y){te="N";break}for(ie=K+1,Ae=T.length;ie<Ae&&T[ie]==="ET";)ie++;te=ie<Ae&&T[ie]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(Ae=T.length,ie=K+1;ie<Ae&&T[ie]==="NSM";)ie++;if(ie<Ae){var Te=k[K],Ue=Te>=1425&&Te<=2303||Te===64286;if(le=T[ie],Ue&&(le==="R"||le==="AL")){te="R";break}}}te=K<1||(le=T[K-1])==="B"?"N":P[K-1];break;case"B":y=!1,a=!0,te=b;break;case"S":s=!0,te="N"}return te},C=function(k,T,P){var K=k.split("");return P&&S(K,P,{hiLevel:b}),K.reverse(),T&&T.reverse(),K.join("")},S=function(k,T,P){var K,le,oe,ie,Ae,te=-1,Te=k.length,Ue=0,O=[],H=b?h:A,G=[];for(y=!1,a=!1,s=!1,le=0;le<Te;le++)G[le]=w(k[le]);for(oe=0;oe<Te;oe++){if(Ae=Ue,O[oe]=I(k,G,O,oe),K=240&(Ue=H[Ae][m[O[oe]]]),Ue&=15,T[oe]=ie=H[Ue][5],K>0)if(K===16){for(le=te;le<oe;le++)T[le]=1;te=-1}else te=-1;if(H[Ue][6])te===-1&&(te=oe);else if(te>-1){for(le=te;le<oe;le++)T[le]=ie;te=-1}G[oe]==="B"&&(T[oe]=0),P.hiLevel|=ie}s&&function(L,W,X){for(var D=0;D<X;D++)if(L[D]==="S"){W[D]=b;for(var Q=D-1;Q>=0&&L[Q]==="WS";Q--)W[Q]=b}}(G,T,Te)},E=function(k,T,P,K,le){if(!(le.hiLevel<k)){if(k===1&&b===1&&!a)return T.reverse(),void(P&&P.reverse());for(var oe,ie,Ae,te,Te=T.length,Ue=0;Ue<Te;){if(K[Ue]>=k){for(Ae=Ue+1;Ae<Te&&K[Ae]>=k;)Ae++;for(te=Ue,ie=Ae-1;te<ie;te++,ie--)oe=T[te],T[te]=T[ie],T[ie]=oe,P&&(oe=P[te],P[te]=P[ie],P[ie]=oe);Ue=Ae}Ue++}}},B=function(k,T,P){var K=k.split(""),le={hiLevel:b};return P||(P=[]),S(K,P,le),function(oe,ie,Ae){if(Ae.hiLevel!==0&&d)for(var te,Te=0;Te<oe.length;Te++)ie[Te]===1&&(te=x.indexOf(oe[Te]))>=0&&(oe[Te]=x[te+1])}(K,P,le),E(2,K,T,P,le),E(1,K,T,P,le),K.join("")};return this.__bidiEngine__.doBidiReorder=function(k,T,P){if(function(le,oe){if(oe)for(var ie=0;ie<le.length;ie++)oe[ie]=ie;l===void 0&&(l=j(le)),u===void 0&&(u=j(le))}(k,T),o||!c||u)if(o&&c&&l^u)b=l?1:0,k=C(k,T,P);else if(!o&&c&&u)b=l?1:0,k=B(k,T,P),k=C(k,T);else if(!o||l||c||u){if(o&&!c&&l^u)k=C(k,T),l?(b=0,k=B(k,T,P)):(b=1,k=B(k,T,P),k=C(k,T));else if(o&&l&&!c&&u)b=1,k=B(k,T,P),k=C(k,T);else if(!o&&!c&&l^u){var K=d;l?(b=1,k=B(k,T,P),b=0,d=!1,k=B(k,T,P),d=K):(b=0,k=B(k,T,P),k=C(k,T),b=1,d=!1,k=B(k,T,P),d=K,k=C(k,T))}}else b=0,k=B(k,T,P);else b=l?1:0,k=B(k,T,P);return k},this.__bidiEngine__.setOptions=function(k){k&&(o=k.isInputVisual,c=k.isOutputVisual,l=k.isInputRtl,u=k.isOutputRtl,d=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([r.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([r.doBidiReorder(a[l])]);n.text=o}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(an),an.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Im(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new NPe(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new cPe(this.contents),this.head=new dPe(this),this.name=new pPe(this),this.cmap=new Vre(this),this.toUnicode={},this.hhea=new fPe(this),this.maxp=new gPe(this),this.hmtx=new xPe(this),this.post=new APe(this),this.os2=new hPe(this),this.loca=new wPe(this),this.glyf=new vPe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,a,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],u.push(Math.round(e*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var a,s,o,l;for(o=0,s=0,l=(e=""+e).length;0<=l?s<l:s>l;s=0<=l?++s:--s)a=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var Pf,Im=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,a;for(a=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(e.charCodeAt(r)));return a},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,a,s,o,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*a+16777216*s+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,a,s;for(s=[],n=0,a=e.length;n<a;n++)r=e[n],s.push(this.writeByte(r));return s},t}(),cPe=function(){var t;function e(r){var n,a,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,s=this.tableCount;0<=s?a<s:a>s;a=0<=s?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,a,s,o,l,c,u,d,f,A,h,m,p;for(p in h=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(h)/c),o=Math.floor(f/c),d=16*h-f,(a=new Im).writeInt(this.scalarType),a.writeShort(h),a.writeShort(f),a.writeShort(o),a.writeShort(d),s=16*h,u=a.pos+s,l=null,m=[],r)for(A=r[p],a.writeString(p),a.writeInt(t(A)),a.writeInt(u),a.writeInt(A.length),m=m.concat(A),p==="head"&&(l=u),u+=A.length;u%4;)m.push(0),u++;return a.write(m),n=2981146554-t(a.data),a.pos=l+8,a.writeUInt32(n),a.data},t=function(r){var n,a,s,o;for(r=Hre.call(r);r.length%4;)r.push(0);for(s=new Im(r),a=0,n=0,o=r.length;n<o;n=n+=4)a+=s.readUInt32();return 4294967295&a},e}(),uPe={}.hasOwnProperty,gh=function(t,e){for(var r in e)uPe.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Pf=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var dPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return gh(t,Pf),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new Im).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t}(),qV=function(){function t(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),f=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(h=e.readUInt16(),A=h/2,e.pos+=6,s=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),e.pos+=2,p=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),u=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),d=function(){var w,j;for(j=[],c=w=0;0<=A?w<A:w>A;c=0<=A?++w:--w)j.push(e.readUInt16());return j}(),a=(this.length-e.pos+this.offset)/2,l=function(){var w,j;for(j=[],c=w=0;0<=a?w<a:w>a;c=0<=a?++w:--w)j.push(e.readUInt16());return j}(),c=v=0,b=s.length;v<b;c=++v)for(x=s[c],n=y=m=p[c];m<=x?y<=x:y>=x;n=m<=x?++y:--y)d[c]===0?o=n+u[c]:(o=l[d[c]/2+(n-m)-(A-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}e.pos=f}return t.encode=function(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,I,C,S,E,B,k,T,P,K,le,oe,ie,Ae,te,Te,Ue,O,H,G,L,W,X,D,Q,Z,be,U;switch(K=new Im,o=Object.keys(e).sort(function(ze,re){return ze-re}),r){case"macroman":for(p=0,x=function(){var ze=[];for(m=0;m<256;++m)ze.push(0);return ze}(),y={0:0},s={},le=0,te=o.length;le<te;le++)y[Q=e[a=o[le]]]==null&&(y[Q]=++p),s[a]={old:e[a],new:y[e[a]]},x[a]=y[e[a]];return K.writeUInt16(1),K.writeUInt16(0),K.writeUInt32(12),K.writeUInt16(0),K.writeUInt16(262),K.writeUInt16(0),K.write(x),{charMap:s,subtable:K.data,maxGlyphID:p+1};case"unicode":for(T=[],f=[],b=0,y={},n={},v=u=null,oe=0,Te=o.length;oe<Te;oe++)y[j=e[a=o[oe]]]==null&&(y[j]=++b),n[a]={old:j,new:y[j]},l=y[j]-a,v!=null&&l===u||(v&&f.push(v),T.push(a),u=l),v=a;for(v&&f.push(v),f.push(65535),T.push(65535),B=2*(E=T.length),S=2*Math.pow(Math.log(E)/Math.LN2,2),A=Math.log(S/2)/Math.LN2,C=2*E-S,c=[],I=[],h=[],m=ie=0,Ue=T.length;ie<Ue;m=++ie){if(k=T[m],d=f[m],k===65535){c.push(0),I.push(0);break}if(k-(P=n[k].new)>=32768)for(c.push(0),I.push(2*(h.length+E-m)),a=Ae=k;k<=d?Ae<=d:Ae>=d;a=k<=d?++Ae:--Ae)h.push(n[a].new);else c.push(P-k),I.push(0)}for(K.writeUInt16(3),K.writeUInt16(1),K.writeUInt32(12),K.writeUInt16(4),K.writeUInt16(16+8*E+2*h.length),K.writeUInt16(0),K.writeUInt16(B),K.writeUInt16(S),K.writeUInt16(A),K.writeUInt16(C),X=0,O=f.length;X<O;X++)a=f[X],K.writeUInt16(a);for(K.writeUInt16(0),D=0,H=T.length;D<H;D++)a=T[D],K.writeUInt16(a);for(Z=0,G=c.length;Z<G;Z++)l=c[Z],K.writeUInt16(l);for(be=0,L=I.length;be<L;be++)w=I[be],K.writeUInt16(w);for(U=0,W=h.length;U<W;U++)p=h[U],K.writeUInt16(p);return{charMap:n,subtable:K.data,maxGlyphID:b+1}}},t}(),Vre=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return gh(t,Pf),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,a;for(e.pos=this.offset,this.version=e.readUInt16(),a=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new qV(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,a;return r==null&&(r="macroman"),n=qV.encode(e,r),(a=new Im).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},t}(),fPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return gh(t,Pf),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),hPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return gh(t,Pf),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),APe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return gh(t,Pf),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,a;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],a=[];e.pos<this.offset+this.length;)r=e.readByte(),a.push(this.names.push(e.readString(r)));return a;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t}(),mPe=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},pPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return gh(t,Pf),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,a,s,o,l,c,u,d,f,A;for(e.pos=this.offset,e.readShort(),r=e.readShort(),l=e.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},s=d=0,f=n.length;d<f;s=++d)a=n[s],e.pos=a.offset,u=e.readString(a.length),o=new mPe(u,a),c[A=a.nameID]==null&&(c[A]=[]),c[a.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),gPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return gh(t,Pf),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),xPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return gh(t,Pf),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,a,s,o,l,c;for(e.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],r=u=0;0<=a?u<a:u>a;r=0<=a?++u:--u)d.push(e.readInt16());return d}(),this.widths=(function(){var u,d,f,A;for(A=[],u=0,d=(f=this.metrics).length;u<d;u++)s=f[u],A.push(s.advance);return A}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=a?o<a:o>a;r=0<=a?++o:--o)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),Hre=[].slice,vPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return gh(t,Pf),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,a,s,o,l,c,u,d,f;return e in this.cache?this.cache[e]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(e),(a=s.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,o=(l=new Im(r.read(a))).readShort(),u=l.readShort(),f=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[e]=o===-1?new bPe(l,u,f,c,d):new yPe(l,o,u,f,c,d),this.cache[e]))},t.prototype.encode=function(e,r,n){var a,s,o,l,c;for(o=[],s=[],l=0,c=r.length;l<c;l++)a=e[r[l]],s.push(o.length),a&&(o=o.concat(a.encode(n)));return s.push(o.length),{table:o,offsets:s}},t}(),yPe=function(){function t(e,r,n,a,s,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=s,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),bPe=function(){function t(e,r,n,a,s){var o,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Im(Hre.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),wPe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return gh(t,Pf),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=4)s.push(e.readUInt32());return s}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),a=0,s=0,o=0;o<n.length;++o)if(n[o]=a,s<r.length&&r[s]==o){++s,n[o]=a;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(a+=c)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},t}(),NPe=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,a,s;for(r in a=this.font.cmap.tables[0].codeMap,e={},s=this.subset)n=s[r],e[r]=a[n];return e},t.prototype.glyphsFor=function(e){var r,n,a,s,o,l,c;for(a={},o=0,l=e.length;o<l;o++)a[s=e[o]]=this.font.glyf.glyphFor(s);for(s in r=[],a)(n=a[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],a[s]=n;return a},t.prototype.encode=function(e,r){var n,a,s,o,l,c,u,d,f,A,h,m,p,x,v;for(a in n=Vre.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),h={0:0},v=n.charMap)h[(c=v[a]).old]=c.new;for(m in A=n.maxGlyphID,o)m in h||(h[m]=A++);return d=function(y){var b,w;for(b in w={},y)w[y[b]]=b;return w}(h),f=Object.keys(d).sort(function(y,b){return y-b}),p=function(){var y,b,w;for(w=[],y=0,b=f.length;y<b;y++)l=f[y],w.push(d[l]);return w}(),s=this.font.glyf.encode(o,p,h),u=this.font.loca.encode(s.offsets,p),x={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},t}();an.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,a,s,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in s=["<<"],r)o=r[a],s.push("/"+a+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+r},e}();const zk=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:ePe,AcroFormAppearance:un,AcroFormButton:_o,AcroFormCheckBox:Pb,AcroFormChoiceField:Up,AcroFormComboBox:Vp,AcroFormEditBox:Ib,AcroFormListBox:Qp,AcroFormPasswordField:Tb,AcroFormPushButton:jb,AcroFormRadioButton:Hp,AcroFormTextField:Am,GState:P2,ShadingPattern:Q0,TilingPattern:jp,default:an,jsPDF:an},Symbol.toStringTag,{value:"Module"}));async function zV(t){const e={...t,remaining:t.quantity,status:"PENDIENTE",createdAt:xr.now()};return Wn(bt(je,"inventory_batches"),e)}async function $re(t,e){await kn(Xt(je,"inventory_batches",t),{status:"PAGADO",paidAmount:null,paidAt:xr.now()})}async function CPe(t,e){const r=sr(bt(je,"batch_allocations"),Ar("saleDate",">=",t),Ar("saleDate","<=",e)),n=await Ht(r),a={};return n.forEach(s=>{const o=s.data(),l=o.batchId;a[l]||(a[l]={batchId:o.batchId,batchDate:o.batchDate,productName:o.productName,quantity:0,amountCharged:0}),a[l].quantity+=Number(o.quantity||0),a[l].amountCharged+=Number(o.amountCharged||0)}),Object.values(a)}async function Gre(t){const e=Xt(je,"salesV2",t),r=await Cs(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),a=[];if(Array.isArray(n.items)){for(const l of n.items)if(Array.isArray(l==null?void 0:l.allocations))for(const c of l.allocations){const u=String((c==null?void 0:c.batchId)||"").trim(),d=Number((c==null?void 0:c.qty)||0);u&&d&&a.push({batchId:u,qty:d})}}if(Array.isArray(n.allocations))for(const l of n.allocations){const c=String((l==null?void 0:l.batchId)||"").trim(),u=Number((l==null?void 0:l.qty)||0);c&&u&&a.push({batchId:c,qty:u})}if(a.length===0)return await qs(je,async l=>{l.delete(e)}),{restored:0};const s=new Map;for(const l of a)s.set(l.batchId,Number((s.get(l.batchId)||0)+l.qty));let o=0;return await qs(je,async l=>{const c=Array.from(s.entries()),u=c.map(([f])=>Xt(je,"inventory_batches",f)),d=await Promise.all(u.map(f=>l.get(f)));c.forEach(([f,A],h)=>{const m=d[h];if(!m.exists())return;const p=m.data(),x=Number((p==null?void 0:p.remaining)??0),v=Number((x+Number(A||0)).toFixed(3));l.update(u[h],{remaining:v}),o+=Number(A||0)}),l.delete(e)}),{restored:o}}var Kre={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},WV=oi.createContext&&oi.createContext(Kre),_Pe=["attr","size","title"];function EPe(t,e){if(t==null)return{};var r=SPe(t,e),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)n=s[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function SPe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function DS(){return DS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},DS.apply(this,arguments)}function XV(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function RS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XV(Object(r),!0).forEach(function(n){IPe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XV(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function IPe(t,e,r){return e=jPe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jPe(t){var e=PPe(t,"string");return typeof e=="symbol"?e:e+""}function PPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qre(t){return t&&t.map((e,r)=>oi.createElement(e.tag,RS({key:r},e.attr),qre(e.child)))}function TPe(t){return e=>oi.createElement(BPe,DS({attr:RS({},t.attr)},e),qre(t.child))}function BPe(t){var e=r=>{var{attr:n,size:a,title:s}=t,o=EPe(t,_Pe),l=a||r.size||"1em",c;return r.className&&(c=r.className),t.className&&(c=(c?c+" ":"")+t.className),oi.createElement("svg",DS({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:c,style:RS(RS({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&oi.createElement("title",null,s),t.children)};return WV!==void 0?oi.createElement(WV.Consumer,null,r=>e(r)):e(Kre)}function kPe(t){return TPe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(t)}function Rc({onClick:t,loading:e,className:r=""}){return i.jsxs("button",{onClick:t,disabled:e,className:`flex items-center gap-2 px-3 py-1.5 rounded-2xl  border 
        bg-white hover:bg-gray-100 text-sm font-medium shadow-2xl
        disabled:opacity-50 disabled:cursor-not-allowed ${r}`,title:"Refrescar datos",children:[i.jsx(kPe,{className:`w-4 h-4 ${e?"animate-spin text-blue-500":""}`}),e?"Actualizando...":"Refrescar"]})}function Mc(){const[t,e]=g.useState(0),r=g.useCallback(()=>e(n=>n+1),[]);return{refreshKey:t,refresh:r}}const ml=t=>Math.round((Number(t)||0)*100)/100,Ph=t=>Math.round((Number(t)||0)*1e3)/1e3,td=t=>Number(t??0).toFixed(2),Th=t=>Number(t??0).toFixed(3),YV=(t,e)=>{var o;const r=t.date?String(t.date):"",n=(o=t.timestamp)!=null&&o.toDate?Ur(t.timestamp.toDate(),"yyyy-MM-dd"):"";let a=r||n;if(r&&n){const l=new Date(r+"T00:00:00").getTime(),c=new Date(n+"T00:00:00").getTime(),u=Math.abs(l-c)/(1e3*60*60*24);isFinite(u)&&u>30&&(a=n)}if(!a)return[];const s=t.type??"CONTADO";return Array.isArray(t.items)&&t.items.length>0?t.items.map((l,c)=>{const u=Number((l==null?void 0:l.qty)??0),d=Number((l==null?void 0:l.lineFinal)??0)||Math.max(0,Number((l==null?void 0:l.unitPrice)||0)*u-Number((l==null?void 0:l.discount)||0));return{id:`${e}#${c}`,productName:String((l==null?void 0:l.productName)??"(sin nombre)"),quantity:u,amount:ml(d),amountSuggested:Number(t.amountSuggested??0),date:a,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",type:s,measurement:String((l==null?void 0:l.measurement)??t.measurement??""),allocations:Array.isArray(l==null?void 0:l.allocations)?l.allocations:t.allocations,avgUnitCost:Number((l==null?void 0:l.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((l==null?void 0:l.cogsAmount)??0)}}):[{id:e,productName:t.productName??"(sin nombre)",quantity:Number(t.quantity??0),amount:Number(t.amount??t.amountCharged??0),amountSuggested:Number(t.amountSuggested??0),date:a,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",type:s,measurement:String(t.measurement??""),allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount}]};function FPe({role:t,roles:e}){const[r,n]=g.useState([]),[a,s]=g.useState([]),[o,l]=g.useState(null),[c,u]=g.useState(!0),[d,f]=g.useState(""),[A,h]=g.useState("ALL"),[m,p]=g.useState("ALL"),[x,v]=g.useState({}),[y,b]=g.useState(null),[w,j]=g.useState(0),[I,C]=g.useState(0),[S,E]=g.useState(""),[B,k]=g.useState(0),[T,P]=g.useState("0"),K=Ur(new Date,"yyyy-MM-dd"),[le,oe]=g.useState(K),[ie,Ae]=g.useState(K),[te,Te]=g.useState(!1),[Ue,O]=g.useState(!1),[H,G]=g.useState(!1),[L,W]=g.useState(""),X=g.useRef(null),{refreshKey:D,refresh:Q}=Mc(),Z=e&&e.length?e:t,be=ibe(Z,"bills","cerrarVentas"),U=Sn(Z,"admin"),ze=({title:ge,open:Ie,onToggle:xt,right:Pt})=>i.jsxs("button",{type:"button",onClick:xt,className:"w-full flex items-center justify-between gap-3 px-4 py-3 rounded-xl border bg-gray-50 hover:bg-gray-100 active:bg-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[i.jsx("span",{className:"font-semibold truncate",children:ge}),Pt?i.jsx("span",{className:"text-xs text-gray-600",children:Pt}):null]}),i.jsx("div",{className:"shrink-0 text-lg font-bold leading-none",children:Ie?"":"+"})]});g.useEffect(()=>{if(!le||!ie)return;u(!0);const ge=sr(bt(je,"salesV2"),Ar("date",">=",le),Ar("date","<=",ie)),Ie=Pd(ge,xt=>{const Pt=[];xt.forEach(It=>{const Ut=YV(It.data(),It.id);Pt.push(...Ut)}),n(Pt),u(!1)},xt=>{console.error("Error cargando ventas por periodo:",xt),n([]),u(!1)});return()=>Ie()},[le,ie,D]),g.useEffect(()=>{if(!le||!ie)return;const ge=sr(bt(je,"salesV2"),Ar("status","==","FLOTANTE"),Ar("date",">=",le),Ar("date","<=",ie)),Ie=Pd(ge,xt=>{const Pt=[];xt.forEach(It=>{const Ut=YV(It.data(),It.id);Pt.push(...Ut)}),s(Pt)});return()=>Ie()},[le,ie,D]),g.useEffect(()=>{(async()=>{try{const ge=await Ht(bt(je,"users")),Ie={};ge.forEach(xt=>{const Pt=xt.data(),It=String(Pt.email||"").trim().toLowerCase(),Ut=String(Pt.name||"").trim();It&&(Ie[It]=Ut||Pt.email||"")}),v(Ie)}catch(ge){console.error("Error cargando usuarios:",ge),v({})}})()},[]);const re=ge=>{const Ie=String(ge||"").trim().toLowerCase();return x[Ie]||ge||""};g.useEffect(()=>{(async()=>{const Ie=sr(bt(je,"daily_closures"),Ar("date","==",K)),xt=await Ht(Ie);if(xt.empty)l(null);else{const Pt=xt.docs[0];l({id:Pt.id,...Pt.data()})}})()},[K,D]);const J=oi.useMemo(()=>{let ge=[];if(A==="FLOTANTE"){const xt=[...r,...a],Pt=new Map;for(const It of xt)It.status==="FLOTANTE"&&Pt.set(It.id,It);ge=Array.from(Pt.values())}else if(A==="ALL"){const xt=[...r,...a],Pt=new Map;for(const It of xt)Pt.set(It.id,It);ge=Array.from(Pt.values())}else ge=r.filter(xt=>xt.status==="PROCESADA");m!=="ALL"&&(ge=ge.filter(xt=>xt.type===m));const Ie=L.trim().toLowerCase();if(Ie){const xt=It=>String(It||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),Pt=xt(Ie);ge=ge.filter(It=>xt(It.productName).includes(Pt))}return ge},[A,r,a,L,m]),Re=ml(J.reduce((ge,Ie)=>ge+(Ie.amount||0),0)),ke=ml(J.reduce((ge,Ie)=>ge+Number(Ie.cogsAmount??0),0)),Be=ge=>String(ge||"").trim().toLowerCase()!=="lb",Ye=J.filter(ge=>ge.type==="CONTADO"),ot=J.filter(ge=>ge.type==="CREDITO"),Ct=Ph(Ye.filter(ge=>Be(ge.measurement)).reduce((ge,Ie)=>ge+(Ie.quantity||0),0)),jt=Ph(Ye.filter(ge=>!Be(ge.measurement)).reduce((ge,Ie)=>ge+(Ie.quantity||0),0)),Ot=Ph(ot.filter(ge=>Be(ge.measurement)).reduce((ge,Ie)=>ge+(Ie.quantity||0),0)),Tt=Ph(ot.filter(ge=>!Be(ge.measurement)).reduce((ge,Ie)=>ge+(Ie.quantity||0),0)),Qt=ml(Ye.reduce((ge,Ie)=>ge+(Ie.amount||0),0)),Ft=ml(ot.reduce((ge,Ie)=>ge+(Ie.amount||0),0)),Qe=ml(Ye.reduce((ge,Ie)=>ge+Number(Ie.cogsAmount??0),0)),De=ml(ot.reduce((ge,Ie)=>ge+Number(Ie.cogsAmount??0),0)),Je=ml(Qt-Qe),dt=ml(Ft-De),ce=Ph(Ct+Ot),we=Ph(jt+Tt),ue=ml(Qt+Ft),ne={};J.forEach(ge=>{const Ie=ge.productName||"(sin nombre)";ne[Ie]||(ne[Ie]={totalQuantity:0,totalAmount:0}),ne[Ie].totalQuantity=Ph(ne[Ie].totalQuantity+(ge.quantity||0)),ne[Ie].totalAmount=ml(ne[Ie].totalAmount+(ge.amount||0))});const Ve=Object.entries(ne).map(([ge,Ie])=>({productName:ge,totalQuantity:Ie.totalQuantity,totalAmount:Ie.totalAmount})),it=async()=>{try{const ge=J.filter(Le=>Le.status==="FLOTANTE"),Ie=ge.length>0?ge:r.filter(Le=>Le.status!=="PROCESADA");if(Ie.length===0){f("No hay ventas para procesar.");return}const xt={totalCharged:ml(Ie.reduce((Le,Ce)=>Le+(Ce.amount||0),0)),totalSuggested:ml(Ie.reduce((Le,Ce)=>Le+(Ce.amountSuggested||0),0)),totalUnits:Ph(Ie.reduce((Le,Ce)=>Le+(Ce.quantity||0),0)),totalCOGS:ml(Ie.reduce((Le,Ce)=>Le+Number(Ce.cogsAmount??0),0))},Pt=ml(xt.totalCharged-xt.totalSuggested),It=ml(xt.totalCharged-xt.totalCOGS),Ut=await Wn(bt(je,"daily_closures"),{date:K,createdAt:xr.now(),periodStart:le,periodEnd:ie,totalCharged:xt.totalCharged,totalSuggested:xt.totalSuggested,totalDifference:Pt,totalUnits:xt.totalUnits,totalCOGS:xt.totalCOGS,grossProfit:It,products:Ie.map(Le=>({productName:Le.productName,quantity:Le.quantity,amount:Le.amount})),salesV2:Ie.map(Le=>({id:Le.id,productName:Le.productName,quantity:Le.quantity,amount:Le.amount,amountSuggested:Le.amountSuggested,userEmail:Le.userEmail,clientName:Le.clientName,amountReceived:Le.amountReceived,change:Le.change,status:Le.status,cogsAmount:Le.cogsAmount??0,avgUnitCost:Le.avgUnitCost??null,allocations:Le.allocations??[],date:Le.date})),productSummary:Object.entries(Ie.reduce((Le,Ce)=>{const pe=Ce.productName||"(sin nombre)";return Le[pe]||(Le[pe]={totalQuantity:0,totalAmount:0}),Le[pe].totalQuantity=Ph(Le[pe].totalQuantity+(Ce.quantity||0)),Le[pe].totalAmount=ml(Le[pe].totalAmount+(Ce.amount||0)),Le},{})).map(([Le,Ce])=>({productName:Le,totalQuantity:Ce.totalQuantity,totalAmount:Ce.totalAmount}))}),$t=Sc(je);Ie.forEach(Le=>{$t.update(Xt(je,"salesV2",Le.id.split("#")[0]),{status:"PROCESADA",closureId:Ut.id,closureDate:K,date:Le.date})}),await $t.commit(),f(` Cierre guardado. Ventas procesadas: ${Ie.length}.`)}catch(ge){console.error(ge),f(" Error al guardar el cierre.")}},vt=async ge=>{if(!U){f(" No tienes permisos para revertir esta venta.");return}if(window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await kn(Xt(je,"salesV2",ge.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null}),f(" Venta revertida a FLOTANTE.")}catch(Ie){console.error(Ie),f(" No se pudo revertir la venta.")}},me=ge=>{if(!U){f(" No tienes permisos para editar esta venta.");return}b(ge),j(ge.quantity),C(ge.amount),E(ge.clientName),k(ge.amountReceived),P(ge.change)},Ee=async()=>{if(!U){f(" No tienes permisos para guardar cambios.");return}if(y)try{await kn(Xt(je,"salesV2",y.id.split("#")[0]),{quantity:w,amount:I,amountCharged:I,clientName:S,amountReceived:B,change:T}),b(null),f(" Venta actualizada.")}catch(ge){console.error(ge),f(" No se pudo actualizar la venta.")}},ye=async ge=>{if(!U){f(" No tienes permisos para eliminar esta venta.");return}if(window.confirm("Eliminar esta venta? Se restaurar el stock en los lotes asignados."))try{const{restored:Ie}=await Gre(ge.split("#")[0]);f(` Venta eliminada. Stock restaurado: ${Number(Ie).toFixed(2)}.`)}catch(Ie){console.error(Ie),f(" No se pudo eliminar la venta.")}},We=async()=>{if(X.current){X.current.classList.add("force-pdf-colors"),X.current.classList.add("pdf-print-mode");try{const Ie=(await Vm(X.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),xt=new an;xt.addImage(Ie,"PNG",10,10,190,0),xt.save(`cierre_${K}.pdf`)}finally{X.current.classList.remove("pdf-print-mode"),X.current.classList.remove("force-pdf-colors")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("style",{children:`
        .pdf-print-mode .pdf-desktop { display: block !important; }
        .pdf-print-mode .pdf-mobile  { display: none !important; }
      `}),i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-4",children:[i.jsxs("h2",{className:"text-2xl font-bold",children:["Cierre de Ventas - ",le,"  ",ie]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx(Rc,{onClick:Q})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx(ze,{title:"Filtros",open:te,onToggle:()=>Te(ge=>!ge),right:i.jsxs("span",{className:"ml-1",children:[le,"  ",ie,A!=="ALL"?`  ${A}`:"",m!=="ALL"?`  ${m==="CREDITO"?"Crdito":"Cash"}`:"",L.trim()?`  "${L.trim()}"`:""]})}),te&&i.jsx("div",{className:"mt-3 border rounded-xl p-3 bg-white",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3",children:[i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Periodo desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-2 w-full",value:le,onChange:ge=>oe(ge.target.value)})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-2 w-full",value:ie,onChange:ge=>Ae(ge.target.value)})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-2 w-full",value:A,onChange:ge=>h(ge.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Tipo Operacin"}),i.jsxs("select",{className:"border rounded px-2 py-2 w-full",value:m,onChange:ge=>p(ge.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),i.jsx("option",{value:"CREDITO",children:"Crdito"}),i.jsx("option",{value:"CONTADO",children:"Cash"})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Producto"}),i.jsx("input",{type:"text",className:"border rounded px-2 py-2 w-full",placeholder:"Buscar por producto...",value:L,onChange:ge=>W(ge.target.value)})]})]})})]}),c?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:X,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras - Unidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[J.map(ge=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ge.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ge.status})}),i.jsx("td",{className:"border p-1",children:ge.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:ge.productName}),i.jsx("td",{className:"border p-1",children:Th(ge.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",td(ge.amount)]}),i.jsx("td",{className:"border p-1",children:ge.date}),i.jsx("td",{className:"border p-1",children:re(ge.userEmail)}),i.jsx("td",{className:"border p-1",children:ge.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:U?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>me(ge),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>ye(ge.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):ge.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:U?i.jsx("button",{onClick:()=>vt(ge.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},ge.id)),J.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden mb-4",children:[i.jsx(ze,{title:"Ventas",open:Ue,onToggle:()=>O(ge=>!ge),right:i.jsxs("span",{className:"ml-1",children:[J.length,"  C$",td(Re)]})}),Ue&&i.jsxs("div",{className:"mt-3 space-y-3",children:[J.map(ge=>i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:ge.productName}),i.jsx("div",{className:"text-xs text-gray-500",children:ge.date})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",td(ge.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${ge.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ge.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Cantidad"}),i.jsx("strong",{children:Th(ge.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("strong",{children:ge.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:re(ge.userEmail)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("strong",{className:"text-right break-all",children:ge.clientName||""})]}),i.jsx("div",{className:"pt-2",children:ge.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:U?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>me(ge),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>ye(ge.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):ge.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:U?i.jsx("button",{onClick:()=>vt(ge.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},ge.id)),J.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas para mostrar."})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Total libras Cash: ",i.jsx("strong",{children:Th(jt)})]}),i.jsxs("div",{children:["Total Unidades cash: ",i.jsx("strong",{children:Th(Ct)})]}),i.jsxs("div",{children:["Total libras credito: ",i.jsx("strong",{children:Th(Tt)})]}),i.jsxs("div",{children:["Total Unidades credito: ",i.jsx("strong",{children:Th(Ot)})]}),i.jsxs("div",{children:["Total facturado Cash: ",i.jsxs("strong",{children:["C$",td(Qe)]})]}),i.jsxs("div",{children:["Total facturado credito:"," ",i.jsxs("strong",{children:["C$",td(De)]})]}),i.jsxs("div",{children:["Total venta Cash: ",i.jsxs("strong",{children:["C$",td(Qt)]})]}),i.jsxs("div",{children:["Total venta Credito: ",i.jsxs("strong",{children:["C$",td(Ft)]})]}),i.jsxs("div",{children:["Utilidad bruta Cash: ",i.jsxs("strong",{children:["C$",td(Je)]})]}),i.jsxs("div",{children:["Utilidad bruta credito:"," ",i.jsxs("strong",{children:["C$",td(dt)]})]}),i.jsxs("div",{children:["Total libras cash y credito: ",i.jsx("strong",{children:Th(we)})]}),i.jsxs("div",{children:["Total unidades cash y credito:"," ",i.jsx("strong",{children:Th(ce)})]}),i.jsxs("div",{children:["Total ventas Cash y credito:"," ",i.jsxs("strong",{children:["C$",td(ue)]})]}),i.jsxs("div",{children:["Total facturado a precio compra:"," ",i.jsxs("strong",{children:["C$",td(ke)]})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsx(ze,{title:"Consolidado por producto",open:H,onToggle:()=>G(ge=>!ge),right:i.jsx("span",{className:"ml-1",children:Ve.length})}),H&&i.jsx("div",{className:"mt-3",children:i.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsxs("tbody",{children:[Ve.map(ge=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ge.productName}),i.jsx("td",{className:"border p-1",children:Th(ge.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",td(ge.totalAmount)]})]},ge.productName)),Ve.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[i.jsx("button",{disabled:!be,onClick:it,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del da"}),i.jsx("button",{onClick:We,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),y&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[y.productName,"  ",re(y.userEmail)]}),i.jsx("label",{className:"text-sm",children:"Cantidad"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:w,onChange:ge=>j(parseFloat(ge.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:I,onChange:ge=>C(parseFloat(ge.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:S,onChange:ge=>E(ge.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:B,onChange:ge=>k(parseFloat(ge.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:T,onChange:ge=>P(ge.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>b(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:Ee,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const rd=t=>Number(t??0).toFixed(2),mx=t=>Number(t??0).toFixed(3);function OPe(){var y,b,w,j;const t=async I=>{if(!window.confirm(`Eliminar el cierre del ${I.date}?`))return;const C=window.confirm("Tambin quieres reabrir (revertir a FLOTANTE) las ventas vinculadas a este cierre?");try{if(C){const S=await Ht(sr(bt(je,"salesV2"),Ar("closureId","==",I.id)));if(!S.empty){const E=Sc(je);S.forEach(B=>{E.update(Xt(je,"salesV2",B.id),{status:"FLOTANTE",closureId:null,closureDate:null})}),await E.commit()}}await zn(Xt(je,"daily_closures",I.id)),(u==null?void 0:u.id)===I.id&&d(null),await m(),A(` Cierre eliminado${C?" y ventas reabiertas.":"."}`)}catch(S){console.error(S),A(" No se pudo eliminar el cierre.")}},[e,r]=g.useState(Ur(Wee(new Date),"yyyy-MM-dd")),[n,a]=g.useState(Ur(new Date,"yyyy-MM-dd")),[s,o]=g.useState(!0),[l,c]=g.useState([]),[u,d]=g.useState(null),[f,A]=g.useState(""),h=g.useRef(null),m=async()=>{try{o(!0);const I=sr(bt(je,"daily_closures"),Ar("date",">=",e),Ar("date","<=",n)),C=await Ht(I),S=[];C.forEach(E=>S.push({id:E.id,...E.data()})),S.sort((E,B)=>E.date<B.date?1:E.date>B.date?-1:0),c(S)}catch(I){console.error(I),A(" Error cargando el historial.")}finally{o(!1)}};g.useEffect(()=>{m()},[]);const p=async I=>{I.preventDefault(),m()},x=g.useMemo(()=>{if(!u)return{units:0,sug:0,chg:0,diff:0,cogs:0,profit:0};const I=Number(u.totalUnits??0),C=Number(u.totalSuggested??0),S=Number(u.totalCharged??0),E=Number(u.totalDifference??(isFinite(S-C)?S-C:0)),B=Number(u.totalCOGS??0),k=Number(u.grossProfit??(isFinite(S-B)?S-B:0));return{units:I,sug:C,chg:S,diff:E,cogs:B,profit:k}},[u]),v=async()=>{if(!h.current||!u)return;const I=h.current;I.classList.add("force-pdf-colors");try{const[{default:C},{jsPDF:S}]=await Promise.all([oA(()=>Promise.resolve().then(()=>G6),void 0),oA(()=>Promise.resolve().then(()=>zk),void 0)]),B=(await C(I,{backgroundColor:"#ffffff",onclone:P=>{const K=P.defaultView;P.body.querySelectorAll("*").forEach(oe=>{const ie=K.getComputedStyle(oe);ie.color&&(oe.style.color=ie.color),ie.backgroundColor&&ie.backgroundColor!=="rgba(0, 0, 0, 0)"&&(oe.style.backgroundColor=ie.backgroundColor),ie.borderColor&&(oe.style.borderColor=ie.borderColor)})}})).toDataURL("image/png"),{jsPDF:k}=await oA(async()=>{const{jsPDF:P}=await Promise.resolve().then(()=>zk);return{jsPDF:P}},void 0),T=new k;T.addImage(B,"PNG",10,10,190,0),T.save(`cierre_${u.date}.pdf`)}finally{I.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Histrico de cierres"}),i.jsxs("form",{onSubmit:p,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:e,onChange:I=>r(I.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:n,onChange:I=>a(I.target.value)})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),s?i.jsx("p",{children:"Cargando..."}):l.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6  shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Monto de venta"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Ganancia sin gastos"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsx("tbody",{children:l.map(I=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.date}),i.jsx("td",{className:"border p-1",children:mx(I.totalUnits)}),i.jsxs("td",{className:"border p-1",children:["C$",rd(I.totalCharged)]}),i.jsxs("td",{className:"border p-1",children:["C$",rd(I.totalCOGS)]}),i.jsxs("td",{className:"border p-1",children:["C$",rd(I.grossProfit??Number(I.totalCharged??0)-Number(I.totalCOGS??0))]}),i.jsx("td",{className:"border p-1",children:i.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>d(I),children:"Ver detalle"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>t(I),children:"Eliminar"})]})})]},I.id))})]}),u&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",u.date]}),i.jsx("button",{onClick:()=>d(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:v,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:h,className:"space-y-4",children:[i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:i.jsxs("div",{children:["Total Libras/Unidades: ",i.jsx("strong",{children:mx(x.units)})]})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:[i.jsxs("div",{children:["Monto al costo:"," ",i.jsxs("strong",{children:["C$",rd(x.cogs)]})]}),i.jsxs("div",{children:["Ganancia sin gastos:"," ",i.jsxs("strong",{children:["C$",rd(x.profit)]})]})]}),(y=u.salesV2)!=null&&y.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto de ventas"}),i.jsx("th",{className:"border p-2",children:"Monto al costo"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Vendedor"})]})}),i.jsx("tbody",{children:u.salesV2.map((I,C)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:mx(I.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",rd(I.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",rd(I.cogsAmount)]}),i.jsx("td",{className:"border p-1",children:I.date??""}),i.jsx("td",{className:"border p-1",children:I.userEmail??""})]},C))})]})]}):(b=u.sales)!=null&&b.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Paga con"}),i.jsx("th",{className:"border p-2",children:"Vuelto"})]})}),i.jsx("tbody",{children:u.sales.map((I,C)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName??"(sin nombre)"}),i.jsx("td",{className:"border p-1",children:mx(I.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",rd(I.amount)]}),i.jsx("td",{className:"border p-1",children:I.userEmail??""}),i.jsx("td",{className:"border p-1",children:I.clientName??""}),i.jsxs("td",{className:"border p-1",children:["C$",rd(I.amountReceived)]}),i.jsx("td",{className:"border p-1",children:typeof I.change=="number"?rd(I.change):I.change??"0"})]},C))})]})]}):(w=u.products)!=null&&w.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Productos en el cierre"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Cantidad"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:u.products.map((I,C)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName}),i.jsx("td",{className:"border p-1",children:mx(I.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",rd(I.amount)]})]},C))})]})]}):i.jsx("p",{className:"text-sm text-gray-500",children:"Sin detalle de ventas en este cierre."}),(j=u.productSummary)!=null&&j.length?i.jsxs(i.Fragment,{children:[i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),i.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),i.jsx("tbody",{children:u.productSummary.map((I,C)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:I.productName}),i.jsx("td",{className:"border p-1",children:mx(I.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",rd(I.totalAmount)]})]},C))})]})]}):null]})]}),f&&i.jsx("p",{className:"mt-3 text-sm",children:f})]})}function DPe(){const[t,e]=g.useState(""),[r,n]=g.useState(""),[a,s]=g.useState(""),[o,l]=g.useState(!1),[c,u]=g.useState(["vendedor_pollo"]),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState([]),[x,v]=g.useState(!0),[y,b]=g.useState(null),[w,j]=g.useState(["vendedor_pollo"]),[I,C]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState(!1),[T,P]=g.useState([]),K=L=>!L||L==="vendedor"?"vendedor_pollo":L==="admin"||L==="supervisor_pollo"||L==="contador"||L==="vendedor_pollo"||L==="vendedor_ropa"||L==="vendedor_dulces"?L:"vendedor_pollo",le=L=>L?Array.isArray(L)?L.map(W=>K(String(W))):[K(String(L))]:["vendedor_pollo"],oe=async()=>{v(!0);const L=await Ht(bt(je,"users")),W=[];L.forEach(X=>{const D=X.data();W.push({id:X.id,email:D.email??"",name:D.name??"",roles:le(D.roles??D.role),sellerCandyId:D.sellerCandyId??""})}),p(W),v(!1)},ie=async()=>{try{const L=await Ht(bt(je,"sellers_candies")),W=[];L.forEach(X=>{const D=X.data();W.push({id:X.id,name:D.name??"(sin nombre)",branchLabel:D.branch??"",commissionPercent:Number(D.commissionPercent??0)})}),P(W)}catch(L){console.error("Error cargando sellers_candies:",L)}};g.useEffect(()=>{oe(),ie()},[]);const Ae=()=>{e(""),n(""),s(""),u(["vendedor_pollo"]),h("")},te=async L=>{if(L.preventDefault(),f(""),y){if(a&&a.length>0&&a.length<6){f(" La contrasea debe tener al menos 6 caracteres.");return}}else if(a.length<6){f(" La contrasea debe tener al menos 6 caracteres.");return}if(!t.trim()){f(" El nombre es obligatorio.");return}try{if(y){const U=Xt(je,"users",y),ze=w.length?w:["vendedor_pollo"],re=ze.includes("vendedor_dulces")&&(I||A)||"";if(await kn(U,{email:r,name:t.trim(),roles:ze,role:ze[0]||"vendedor_pollo",sellerCandyId:re}),p(J=>J.map(Re=>Re.id===y?{...Re,email:r,name:t.trim(),roles:ze,sellerCandyId:re}:Re)),a&&a.length>=6)try{const J=GB(),Re=S||r;await Nge(J,Re),f(` Usuario actualizado. Se envi correo de restablecimiento a ${Re}`)}catch(J){console.error("Error sending password reset:",J),f(" Usuario actualizado. No se pudo enviar correo de restablecimiento.")}else f(" Usuario actualizado correctamente.");Ue();return}const W=BD(),X=TD(W.options,"Secondary"),D=GB(X),Q=await Cge(D,r,a),Z=c.length?c:["vendedor_pollo"],be=Z.includes("vendedor_dulces")&&A||"";await Pee(Xt(bt(je,"users"),Q.user.uid),{email:r,name:t.trim(),roles:Z,role:Z[0]||"vendedor_pollo",sellerCandyId:be}),await UD(D),await ppe(X),p(U=>[{id:Q.user.uid,email:r,name:t.trim(),roles:Z,sellerCandyId:be},...U]),f(" Usuario creado correctamente."),Ae(),k(!1)}catch(W){console.error(W),f(" Error al crear el usuario: "+W.message)}},Te=L=>{b(L.id),e(L.name||""),n(L.email||""),E(L.email||""),j(L.roles&&L.roles.length?L.roles:["vendedor_pollo"]),h(L.sellerCandyId||""),C(L.sellerCandyId||""),s(""),k(!0)},Ue=()=>{b(null),j(["vendedor_pollo"]),C(""),E(""),Ae(),k(!1)},O=async L=>{confirm("Eliminar este usuario del listado?")&&(await zn(Xt(je,"users",L)),p(X=>X.filter(D=>D.id!==L)))},H=L=>{const W=L==="admin"?"admin":L==="supervisor_pollo"?"supervisor_pollo":L==="vendedor_ropa"?"vendedor_ropa":L==="vendedor_dulces"?"vendedor_dulces":"vendedor_pollo",X=W==="admin"?"bg-blue-100 text-blue-700":W==="supervisor_pollo"?"bg-amber-100 text-amber-700":W==="vendedor_ropa"?"bg-indigo-100 text-indigo-700":W==="vendedor_dulces"?"bg-pink-100 text-pink-700":"bg-green-100 text-green-700";return i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${X}`,children:W})},G=L=>`${L.name}  ${L.branchLabel||"Sin sucursal"}  ${L.commissionPercent.toFixed(2)}%`;return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Usuarios"}),i.jsx("button",{className:"px-3 py-2 rounded bg-purple-600 text-white hover:bg-purple-700",onClick:()=>k(!0),type:"button",children:"Crear usuario"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Email"}),i.jsx("th",{className:"p-2 border",children:"Rol"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:x?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Cargando"})}):m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Sin usuarios"})}):m.map(L=>{const W=y===L.id,X=(W?w:L.roles).includes("vendedor_dulces");return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:L.name||""}),i.jsx("td",{className:"p-2 border",children:L.email}),i.jsx("td",{className:"p-2 border",children:W?i.jsxs("div",{className:"space-y-2 text-left",children:[["supervisor_pollo","admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].map(D=>i.jsxs("label",{className:"inline-flex items-center mr-3",children:[i.jsx("input",{type:"checkbox",className:"mr-2",checked:w.includes(D),onChange:()=>j(Q=>Q.includes(D)?Q.filter(Z=>Z!==D):[...Q,D])}),i.jsx("span",{className:"text-sm",children:D})]},D)),w.includes("vendedor_dulces")&&i.jsxs("select",{className:"w-full border p-1 rounded text-xs mt-1",value:I,onChange:D=>C(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces"}),T.map(D=>i.jsx("option",{value:D.id,children:G(D)},D.id))]})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex gap-2 justify-center",children:L.roles.map(D=>i.jsx("span",{children:H(D)},D))}),X&&L.sellerCandyId&&i.jsx("div",{className:"mt-1 text-[11px] text-gray-500",children:"Vendedor asignado"})]})}),i.jsx("td",{className:"p-2 border space-x-2",children:i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Te(L),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>O(L.id),children:"Eliminar"})]})})]},L.id)})})]})}),d&&i.jsx("p",{className:"text-sm mt-2",children:d}),B&&i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>k(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-lg max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:y?"Editar usuario":"Registrar nuevo usuario"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Ue,type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:te,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre completo"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:t,onChange:L=>e(L.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Correo electrnico"}),i.jsx("input",{type:"email",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:r,onChange:L=>n(L.target.value),required:!0})]}),i.jsxs("div",{className:"space-y-1 relative",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Contrasea (mnimo 6 caracteres)"}),i.jsx("input",{type:o?"text":"password",minLength:6,className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400 pr-10",value:a,onChange:L=>s(L.target.value),required:!y}),i.jsx("button",{type:"button",className:"absolute right-2 top-8 text-sm text-gray-600 hover:text-gray-800",onClick:()=>l(L=>!L),children:o?"":""})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Roles"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:["supervisor_pollo","contador","admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].map(L=>i.jsxs("label",{className:"inline-flex items-center mr-3",children:[i.jsx("input",{type:"checkbox",className:"mr-2",checked:y?w.includes(L):c.includes(L),onChange:()=>{y?j(W=>W.includes(L)?W.filter(X=>X!==L):[...W,L]):u(W=>W.includes(L)?W.filter(X=>X!==L):[...W,L])}}),i.jsx("span",{className:"text-sm",children:L})]},L))})]}),(y?w.includes("vendedor_dulces"):c.includes("vendedor_dulces"))&&i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Vendedor (dulces)"}),i.jsxs("select",{className:"w-full border p-2 rounded text-sm",value:A,onChange:L=>h(L.target.value),children:[i.jsx("option",{value:"",children:"Selecciona vendedor de dulces asignado"}),T.map(L=>i.jsx("option",{value:L.id,children:G(L)},L.id))]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:Ue,children:"Cancelar"}),i.jsx("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:y?"Guardar cambios":"Crear usuario"})]})]}),d&&i.jsx("p",{className:"text-sm mt-2",children:d})]})]})]})}const JV=t=>`C$${(Number(t)||0).toFixed(2)}`;function RPe(){const[t,e]=g.useState(""),[r,n]=g.useState(0),[a,s]=g.useState(0),[o,l]=g.useState(""),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState([]),[m,p]=g.useState(!0),[x,v]=g.useState(!1),[y,b]=g.useState(null),[w,j]=g.useState(""),[I,C]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState(0),[T,P]=g.useState(0),[K,le]=g.useState(!1),oe=async()=>{p(!0);const G=await Ht(bt(je,"products")),L=[];G.forEach(W=>{const X=W.data();L.push({id:W.id,name:X.name??"",price:Number(X.price??0),providerPrice:Number(X.providerPrice??0),category:X.category??"",measurement:X.measurement??"",active:X.active!==!1})}),h(L),p(!1)};g.useEffect(()=>{oe()},[]);const ie=async G=>{if(G.preventDefault(),l(""),!t||r<=0||!d){l(" Completa nombre, precio vlido y unidad de medida");return}try{const L={name:t,price:parseFloat(r.toFixed(2)),providerPrice:parseFloat((a||0).toFixed(2)),category:c,measurement:d,active:!0},W=await Wn(bt(je,"products"),L);h(X=>[{id:W.id,...L},...X]),l(" Producto registrado con exito."),e(""),n(0),s(0),f(""),u(""),le(!1)}catch(L){l(" Error: "+L.message)}},Ae=G=>{b(G.id),j(G.name),C(G.category),E(G.measurement),k(G.price),P(G.providerPrice||0)},te=()=>{b(null),j(""),C(""),E(""),k(0)},Te=async()=>{if(!y)return;const G=Xt(je,"products",y);await kn(G,{name:w,category:I,measurement:S,price:parseFloat((B||0).toFixed(2)),providerPrice:parseFloat((T||0).toFixed(2))}),h(L=>L.map(W=>W.id===y?{...W,name:w,category:I,measurement:S,price:parseFloat((B||0).toFixed(2)),providerPrice:parseFloat((T||0).toFixed(2))}:W)),te()},Ue=async G=>{const L=Xt(je,"products",G.id),W=G.active===!1;await kn(L,{active:W}),h(X=>X.map(D=>D.id===G.id?{...D,active:W}:D))},O=async G=>{const L=sr(bt(je,"inventory_batches"),Ar("productId","==",G),vS(1));if(!(await Ht(L)).empty){alert(`No se puede eliminar: hay lotes asociados a este producto.
Sugerencia: desactvalo para ocultarlo.`);return}confirm("Eliminar este producto definitivamente?")&&(await zn(Xt(je,"products",G)),h(D=>D.filter(Q=>Q.id!==G)))},H=x?A:A.filter(G=>G.active!==!1);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{l(""),le(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]}),K&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>le(!1)}),i.jsxs("div",{className:"relative z-10 w-[95%] max-w-lg bg-white rounded-lg shadow-2xl border p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h3",{className:"text-lg font-bold text-green-700 flex items-center gap-2",children:[i.jsx("span",{className:"inline-block bg-green-100 text-green-700 rounded-full p-2",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Registrar producto"]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>le(!1),children:"Cerrar"})]}),i.jsxs("form",{onSubmit:ie,className:"space-y-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Categora"}),i.jsxs("select",{value:c,onChange:G=>u(G.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre del producto"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded",value:t,onChange:G=>e(G.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de unidad de medida"}),i.jsxs("select",{value:d,onChange:G=>f(G.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio proveedor (ej: 40.00)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(a)?"":a,onChange:G=>s(parseFloat(G.target.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Precio por unidad (ej: 55.50)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(r)?"":r,onChange:G=>n(parseFloat(G.target.value)),onFocus:G=>G.target.value==="0"?n(NaN):null})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",children:"Agregar producto"}),o&&i.jsx("p",{className:"text-sm mt-2",children:o})]})]})]}),i.jsxs("div",{className:"flex items-center justify-between mt-6 mb-2",children:[i.jsx("h3",{className:"text-lg font-semibold p-2",children:"Productos"}),i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:x,onChange:G=>v(G.target.checked)}),"Mostrar inactivos"]})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):H.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin productos"})}):H.map(G=>{const L=y===G.id,W=G.active!==!1;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:L?i.jsx("input",{className:"w-full border p-1 rounded",value:w,onChange:X=>j(X.target.value)}):G.name}),i.jsx("td",{className:"p-2 border",children:L?i.jsxs("select",{className:"w-full border p-1 rounded",value:I,onChange:X=>C(X.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"pollo",children:"Pollo"}),i.jsx("option",{value:"cerdo",children:"Cerdo"}),i.jsx("option",{value:"huevo",children:"Huevos"}),i.jsx("option",{value:"ropa",children:"Ropa"}),i.jsx("option",{value:"otros",children:"Otros"})]}):G.category}),i.jsx("td",{className:"p-2 border",children:L?i.jsxs("select",{className:"w-full border p-1 rounded",value:S,onChange:X=>E(X.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),i.jsx("option",{value:"lb",children:"Libra"}),i.jsx("option",{value:"kg",children:"Kilogramo"}),i.jsx("option",{value:"unidad",children:"Unidad"})]}):G.measurement}),i.jsx("td",{className:"p-2 border",children:L?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(T)?"":T,onChange:X=>P(parseFloat(X.target.value))}):JV(G.providerPrice||0)}),i.jsx("td",{className:"p-2 border",children:L?i.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(B)?"":B,onChange:X=>k(parseFloat(X.target.value))}):JV(G.price)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${W?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`,children:W?"Activo":"Inactivo"})}),i.jsx("td",{className:"p-2 border space-x-2",children:L?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Te,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:te,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Ae(G),children:"Editar"}),i.jsx("button",{className:`px-2 py-1 rounded ${W?"bg-gray-600 hover:bg-gray-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,onClick:()=>Ue(G),children:W?"Desactivar":"Activar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>O(G.id),children:"Eliminar"})]})})]},G.id)})})]})})]})}const pl=[];for(let t=0;t<256;++t)pl.push((t+256).toString(16).slice(1));function MPe(t,e=0){return(pl[t[e+0]]+pl[t[e+1]]+pl[t[e+2]]+pl[t[e+3]]+"-"+pl[t[e+4]]+pl[t[e+5]]+"-"+pl[t[e+6]]+pl[t[e+7]]+"-"+pl[t[e+8]]+pl[t[e+9]]+"-"+pl[t[e+10]]+pl[t[e+11]]+pl[t[e+12]]+pl[t[e+13]]+pl[t[e+14]]+pl[t[e+15]]).toLowerCase()}let y5;const LPe=new Uint8Array(16);function UPe(){if(!y5){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");y5=crypto.getRandomValues.bind(crypto)}return y5(LPe)}const QPe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ZV={randomUUID:QPe};function VPe(t,e,r){var a;if(ZV.randomUUID&&!t)return ZV.randomUUID();t=t||{};const n=t.random??((a=t.rng)==null?void 0:a.call(t))??UPe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,MPe(n)}async function HPe(t,e,r,n=!1){if(r<=0)return{allocations:[],avgUnitCost:0,cogsAmount:0};const a=bt(t,"inventory_batches"),s=sr(a,Ar("productName","==",e)),c=(await Ht(s)).docs.map(u=>({id:u.id,data:u.data()})).sort((u,d)=>{var p,x;const f=u.data.date??"",A=d.data.date??"";if(f!==A)return f<A?-1:1;const h=((p=u.data.createdAt)==null?void 0:p.seconds)??0,m=((x=d.data.createdAt)==null?void 0:x.seconds)??0;return h-m}).map(u=>Xt(t,"inventory_batches",u.id));return qs(t,async u=>{let d=Number(r);const f=[],A=await Promise.all(c.map(x=>u.get(x)));for(let x=0;x<c.length&&d>0;x++){const v=c[x],y=A[x];if(!y.exists())continue;const b=y.data(),w=Number(b.quantity??0),j=Number(b.remaining??w??0),I=Number(b.purchasePrice??0);if(j<=0)continue;const C=Math.min(j,d),S=Number((j-C).toFixed(3));u.update(v,{remaining:S}),f.push({batchId:v.id,qty:C,unitCost:I,lineCost:Number((C*I).toFixed(2))}),d=Number((d-C).toFixed(3))}if(d>0&&!n)throw new Error(`Stock insuficiente para "${e}". Faltan ${d} unidades.`);const h=Number(f.reduce((x,v)=>x+v.lineCost,0).toFixed(2)),m=f.reduce((x,v)=>x+v.qty,0),p=m>0?Number((h/m).toFixed(4)):0;return{allocations:f,avgUnitCost:p,cogsAmount:h}})}const zre=3,$Pe=.5*10**-zre;function As(t){const e=Number(t??0);return Number(e.toFixed(zre))}function b5(t,e){return As((t??0)+(e??0))}function UC(t,e){return As(t)+$Pe>=As(e)}async function GPe(t,e){const r=await Ht(bt(je,"inventory_batches")),n=t.trim().toLowerCase();let a=0;for(const s of r.docs){const o=s.data();(o.productName||"").trim().toLowerCase()===n&&o.productId!==e&&(await kn(Xt(je,"inventory_batches",s.id),{productId:e}),a++)}return a}const A0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function eH({user:t,role:e,roles:r}){r&&r.length;const[n,a]=g.useState([]),[s,o]=g.useState([]),[l,c]=g.useState(""),[u,d]=g.useState(Ur(new Date,"yyyy-MM-dd")),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState([]),[v,y]=g.useState(0),[b,w]=g.useState(0),[j,I]=g.useState("0"),[C,S]=g.useState(""),[E,B]=g.useState(!1),[k,T]=g.useState({}),P=Qe=>Math.round(Qe*100)/100,K=Qe=>As(Qe).toFixed(3),[le,oe]=g.useState("CONTADO"),[ie,Ae]=g.useState([]),[te,Te]=g.useState(""),[Ue,O]=g.useState(0),H=Qe=>{oe(Qe),Qe==="CREDITO"?(A(""),w(0),I("0.00")):(Te(""),O(0))},G=Qe=>{const De=Number(Qe.specialPrice||0);return De>0?De:Number(Qe.price||0)},L=async Qe=>{if(!Qe)return 0;const De=sr(bt(je,"inventory_batches"),Ar("productId","==",Qe)),Je=await Ht(De);let dt=0;return Je.forEach(ce=>{const we=ce.data();dt=b5(dt,Number(we.remaining||0))}),As(dt)},W=async Qe=>{if(!Qe)return 0;const De=await Ht(bt(je,"inventory_batches"));let Je=0;return De.forEach(dt=>{const ce=dt.data();(ce.productName||"").trim().toLowerCase()===Qe.trim().toLowerCase()&&(Je=b5(Je,Number(ce.remaining||0)))}),As(Je)};g.useEffect(()=>{(async()=>{const Qe=await Ht(bt(je,"products")),De=[];Qe.forEach(Je=>{const dt=Je.data();(dt==null?void 0:dt.active)!==!1&&De.push({id:Je.id,productName:dt.name??dt.productName??"(sin nombre)",price:Number(dt.price??0),measurement:dt.measurement??"(sin unidad)",category:dt.category??"(sin categora)"})}),a(De)})()},[]),g.useEffect(()=>{(async()=>{const Qe=await Ht(bt(je,"inventory_batches")),De={};Qe.forEach(Je=>{const dt=Je.data(),ce=dt.productId,we=Number(dt.remaining||0);ce&&(De[ce]=b5(De[ce]||0,we))}),Object.keys(De).forEach(Je=>De[Je]=As(De[Je])),T(De)})()},[]),g.useEffect(()=>{(async()=>{const Qe=await Ht(bt(je,"users")),De=[];Qe.forEach(Je=>{const dt=Je.data();De.push({id:Je.id,email:dt.email??"(sin email)",role:dt.role??"USER"})}),o(De)})()},[]);const X=async()=>{if(!l)return;const Qe=n.find(Je=>Je.id===l);if(!Qe)return;if(p.some(Je=>Je.productId===Qe.id)){c("");return}const De=await L(Qe.id);x(Je=>[...Je,{productId:Qe.id,productName:Qe.productName,measurement:Qe.measurement,price:Number(Qe.price||0),specialPrice:0,stock:De,qty:0,qtyInput:"",specialPriceInput:"",discount:0,discountInput:""}]),c("")},D=async Qe=>{if(!Qe)return;const De=n.find(dt=>dt.id===Qe);if(!De||p.some(dt=>dt.productId===De.id))return;const Je=await L(De.id);x(dt=>[...dt,{productId:De.id,productName:De.productName,measurement:De.measurement,price:Number(De.price||0),specialPrice:0,stock:Je,qty:0,qtyInput:"",specialPriceInput:"",discount:0,discountInput:""}]),c("")},Q=Qe=>{x(De=>De.filter(Je=>Je.productId!==Qe))},Z=Qe=>{const De=String(Qe||"").replace(",",".");if(De==="")return"";const Je=De.split(".");return Je.length===1?De:`${Je[0]}.${Je.slice(1).join("")}`},be=async(Qe,De)=>{x(Je=>Je.map(dt=>{if(dt.productId!==Qe)return dt;const ce=(dt.measurement||"").toLowerCase()!=="lb",we=Z(De);if(we.trim()==="")return{...dt,qty:0,qtyInput:""};if(!ce&&we===".")return{...dt,qty:0,qtyInput:"0."};const ue=Number(we),ne=Number.isFinite(ue)?ue:0;let Ve=ce?Math.max(0,Math.round(ne)):As(ne);const it=ce?Math.max(0,Math.floor(Number(dt.stock||0))):As(Number(dt.stock||0));if(Ve>it){Ve=it,S(` Cantidad limitada a existencias (${it})`);const me=ce?String(Ve):Ve===0?"":String(Ve);return{...dt,qty:Ve,qtyInput:me}}const vt=ce?String(Ve):we.endsWith(".")?we:String(Ve);return{...dt,qty:Ve,qtyInput:vt}}))},U=(Qe,De)=>{x(Je=>Je.map(dt=>{if(dt.productId!==Qe)return dt;const ce=Z(De);if(ce.trim()==="")return{...dt,specialPrice:0,specialPriceInput:""};if(ce===".")return{...dt,specialPrice:0,specialPriceInput:"0."};const we=Number(ce),ue=Number.isFinite(we)?Math.max(0,P(we)):0,ne=ce.endsWith(".")?ce:String(ue);return{...dt,specialPrice:ue,specialPriceInput:ne}}))},ze=(Qe,De)=>{x(Je=>Je.map(dt=>{if(dt.productId!==Qe)return dt;const ce=Z(De);if(ce.trim()==="")return{...dt,discount:0,discountInput:""};if(ce===".")return{...dt,discount:0,discountInput:"0."};const we=Number(ce),ue=Number.isFinite(we)?Math.max(0,Math.floor(we)):0,ne=ce.endsWith(".")?ce:String(ue);return{...dt,discount:ue,discountInput:ne}}))},re=g.useMemo(()=>{let Qe=0;for(const De of p){const Je=G(De),dt=Number(Je||0)*Number(De.qty||0),ce=Math.max(0,dt-Math.max(0,Number(De.discount||0)));Qe+=ce}return P(Qe)},[p]);g.useEffect(()=>{y(re)},[re]),g.useEffect(()=>{const Qe=Number(b)||0,De=Number(v)||0;I((Qe-De).toFixed(2))},[b,v]);const J=Qe=>{Qe.key===","&&(Qe.preventDefault(),Qe.target.value+=".")},[Re,ke]=g.useState(!1);g.useEffect(()=>{var Je;const Qe=window.matchMedia("(max-width: 900px)"),De=()=>ke(Qe.matches);return De(),(Je=Qe.addEventListener)==null||Je.call(Qe,"change",De),()=>{var dt;return(dt=Qe.removeEventListener)==null?void 0:dt.call(Qe,"change",De)}},[]),g.useEffect(()=>{(async()=>{try{const Qe=await Ht(bt(je,"customers_pollo")),De=[];Qe.forEach(Je=>{const dt=Je.data();De.push({id:Je.id,name:dt.name??"",phone:dt.phone??"",status:dt.status??"ACTIVO",creditLimit:Number(dt.creditLimit??0),vendorId:dt.vendorId??"",vendorName:dt.vendorName??"",balance:0})});for(const Je of De)try{const dt=sr(bt(je,"ar_movements_pollo"),Ar("customerId","==",Je.id)),ce=await Ht(dt);let we=0;ce.forEach(ne=>{we+=Number(ne.data().amount||0)});const ue=Number(Je.initialDebt||0);Je.balance=we+ue}catch{Je.balance=0}De.sort((Je,dt)=>(Je.name||"").localeCompare(dt.name||"")),Ae(De)}catch(Qe){console.error("Error cargando customers_pollo:",Qe),Ae([])}})()},[]);const Be=g.useMemo(()=>ie.find(Qe=>Qe.id===te)||null,[ie,te]),Ye=Number((Be==null?void 0:Be.balance)||0),ot=le==="CREDITO"?Math.max(0,Number(Ye||0)+Math.max(0,Number(v||0))):0;g.useEffect(()=>{le==="CREDITO"&&O(Qe=>Math.min(Math.max(0,Number(Qe||0)),ot))},[le,ot]),g.useEffect(()=>{le==="CREDITO"&&(w(Number(Ue||0)),I("0.00"))},[le,Ue]);const Ct=le==="CREDITO"?Ye+Math.max(0,Number(v||0))-Math.max(0,Number(Ue||0)):0,jt=async()=>{if(p.length===0)return"Agrega al menos un producto.";for(const Qe of p){if(!Qe.qty||Qe.qty<=0)return`Cantidad invlida para "${Qe.productName}".`;const De=await L(Qe.productId);if(!UC(De,Qe.qty)){const Je=await W(Qe.productName);if(UC(Je,0)&&!UC(De,0)){const dt=await GPe(Qe.productName,Qe.productId),ce=await L(Qe.productId);if(!UC(ce,Qe.qty))return`Stock insuficiente tras corregir ${dt} lote(s) para "${Qe.productName}".`}else return`Stock insuficiente para "${Qe.productName}". Disponible: ${De}`}}return null},Ot=async Qe=>{var Je,dt;Qe.preventDefault(),S("");const De=await jt();if(De){S(" "+De);return}try{B(!0);const ce=[];if(le==="CONTADO"){if(!f.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!te)return"Selecciona un cliente (crdito).";if(Ue<0)return"El pago inicial no puede ser negativo.";if(Ue>v)return"El pago inicial no puede superar el total.";if((Be==null?void 0:Be.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede fiar."}for(const me of p){const Ee=me.qty,{allocations:ye,avgUnitCost:We,cogsAmount:ge}=await HPe(je,me.productName,Ee,!1),Ie=G(me),xt=Number(Ie||0)*Number(Ee||0),Pt=Math.max(0,Number(me.discount||0)),It=Math.max(0,xt-Pt);ce.push({productId:me.productId,productName:me.productName,measurement:me.measurement,unitPrice:Number(Ie||0),regularPrice:Number(me.price||0),specialPrice:Number(me.specialPrice||0)>0?Number(me.specialPrice):null,qty:Ee,discount:Pt,lineTotal:P(xt),lineFinal:P(It),allocations:ye,avgUnitCost:We,cogsAmount:ge})}const we=ce.reduce((me,Ee)=>me+Ee.lineFinal,0),ue=ce.reduce((me,Ee)=>me+Number(Ee.qty||0),0),ne=Number(le==="CREDITO"?Ue||0:b||0),Ve=le==="CREDITO"?"0.00":j,it={id:VPe(),quantity:ue,amount:we,amountCharged:we,timestamp:xr.now(),date:u,userEmail:(t==null?void 0:t.email)??((Je=s[0])==null?void 0:Je.email)??"sin usuario",vendor:e??((dt=s[0])==null?void 0:dt.role)??"sin usuario",status:"FLOTANTE",items:ce,itemsTotal:we,type:le,amountReceived:ne,change:Ve,customerId:le==="CREDITO"?te:"",customerName:le==="CREDITO"?(Be==null?void 0:Be.name)||"":f.trim(),clientName:le==="CONTADO"?f.trim():""};if(le==="CONTADO"){if(!f.trim()){S(" Ingresa el nombre del cliente (contado).");return}}else{if(!te){S(" Selecciona un cliente (crdito).");return}if(Ue<0){S(" El pago inicial no puede ser negativo.");return}if(Ue>v){S(" El pago inicial no puede superar el total.");return}if((Be==null?void 0:Be.status)==="BLOQUEADO"){S(" El cliente est BLOQUEADO. No se puede fiar.");return}const me=Number((Be==null?void 0:Be.creditLimit)||0);if(me>0&&Ct>me){S(` Supera el lmite de crdito (C$ ${me.toFixed(2)}).`);return}}const vt=await Wn(bt(je,"salesV2"),it);if(le==="CREDITO"&&te){const me={customerId:te,date:u,createdAt:xr.now(),ref:{saleId:vt.id}};await Wn(bt(je,"ar_movements_pollo"),{...me,type:"CARGO",amount:Number(we)||0}),Number(Ue)>0&&await Wn(bt(je,"ar_movements_pollo"),{...me,type:"ABONO",amount:-Number(Ue)}),Ae(Ee=>Ee.map(ye=>ye.id===te?{...ye,balance:Number(ye.balance||0)+Number(we||0)-Number(Ue||0)}:ye))}S(" Venta registrada y asignada a inventario (FIFO)."),x([]),c(""),y(0),w(0),I("0"),A(""),d(Ur(new Date,"yyyy-MM-dd")),Te(""),O(0),oe("CONTADO")}catch(ce){console.error(ce),S(` ${(ce==null?void 0:ce.message)||"Error al registrar la venta."}`)}finally{B(!1)}},Tt=g.useMemo(()=>new Set(p.map(Qe=>Qe.productId)),[p]),Qt=g.useMemo(()=>n.filter(Qe=>(k[Qe.id]||0)>0),[n,k]),Ft=g.useMemo(()=>{const Qe=String(h||"").trim().toLowerCase();return Qe?Qt.filter(De=>`${De.productName||""}`.toLowerCase().includes(Qe)):Qt},[Qt,h]);return Re?i.jsx("div",{className:"w-full max-w-lg mx-auto p-3",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow p-3 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"font-bold text-lg text-blue-700",children:"Registrar venta (Pollo)"}),i.jsx("input",{type:"date",className:"text-sm text-gray-700 border rounded px-2 py-1",value:u,onChange:Qe=>d(Qe.target.value),"aria-label":"Fecha de la venta"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:le,onChange:Qe=>H(Qe.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),le==="CONTADO"?i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Cliente (Contado)"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:f,onChange:Qe=>A(Qe.target.value),placeholder:"Ej: Cliente Mostrador"})]}):i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Cliente (Crdito)"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:te,onChange:Qe=>Te(Qe.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),ie.map(Qe=>i.jsxs("option",{value:Qe.status==="ACTIVO"?Qe.id:"",disabled:Qe.status==="BLOQUEADO",children:[Qe.name,"  Saldo: ",A0(Qe.balance||0)]},Qe.id))]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-base font-semibold",children:A0(Ye)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-base font-semibold",children:A0(Ct)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-semibold",children:"Pago inicial"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",type:"number",step:"0.01",inputMode:"decimal",max:ot,value:Ue===0?"":Ue,onChange:Qe=>{const De=Math.max(0,Number(Qe.target.value||0)),Je=Math.min(De,ot);O(Je)},placeholder:"0.00"}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Mximo: ",A0(ot)]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 mb-2",placeholder:"Buscar producto por nombre...",value:h,onChange:Qe=>m(Qe.target.value)}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("select",{className:"flex-1 border rounded px-1 py-2 text-sm",value:l,onChange:async Qe=>{const De=Qe.target.value;c(De),await D(De)},children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),Ft.map(Qe=>i.jsxs("option",{value:Qe.id,disabled:Tt.has(Qe.id),children:[Qe.productName," | C$ ",Qe.price," | Disp:"," ",K(k[Qe.id]||0)]},Qe.id))]})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Items"}),p.length===0?i.jsx("div",{className:"text-gray-500",children:"Agrega productos al carrito."}):i.jsx("div",{className:"space-y-2",children:p.map(Qe=>{const De=G(Qe),Je=Number(De||0)*Number(Qe.qty||0),dt=Math.max(0,Je-Math.max(0,Number(Qe.discount||0))),ce=(Qe.measurement||"").toLowerCase()!=="lb";return i.jsxs("div",{className:"border rounded p-2",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("div",{className:"font-semibold",children:Qe.productName}),i.jsxs("div",{className:"text-sm",children:["C$ ",P(De).toFixed(2)]})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 items-center",children:[i.jsx("input",{className:"border rounded px-2 py-1 text-right",inputMode:ce?"numeric":"decimal",step:ce?1:.01,value:Qe.qtyInput??(Qe.qty===0?"":Qe.qty),onKeyDown:J,onChange:we=>be(Qe.productId,we.target.value),placeholder:ce?"Unid":"Libras",title:ce?"Unidades":"Libras"}),i.jsx("input",{className:"border rounded px-1 py-1 text-right",inputMode:"numeric",value:Qe.discountInput??(Qe.discount===0?"":Qe.discount),onChange:we=>ze(Qe.productId,we.target.value),placeholder:"Descuento",title:"Descuento (C$)"}),i.jsx("input",{className:"border rounded px-2 py-1 text-right",inputMode:"decimal",value:Qe.specialPriceInput??(Qe.specialPrice===0?"":Qe.specialPrice),onChange:we=>U(Qe.productId,we.target.value),placeholder:"Sugerido",title:"Precio sugerido (opcional)"})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Exist:"," ",As(Number(Qe.stock)-Number(Qe.qty||0)).toFixed(3)]}),i.jsxs("div",{className:"font-semibold",children:["C$ ",P(dt).toFixed(2)]})]}),i.jsx("div",{className:"mt-2 text-right",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600",onClick:()=>Q(Qe.productId),children:"Quitar"})})]},Qe.productId)})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Monto total"}),i.jsxs("div",{className:"text-xl font-bold",children:["C$ ",v.toFixed(2)]})]}),le==="CONTADO"&&i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{className:"border rounded px-2 py-2",inputMode:"decimal",value:b===0?"":b,onChange:Qe=>w(Number(Qe.target.value||0)),placeholder:"Monto recibido"}),i.jsxs("div",{className:"border rounded px-2 py-2 bg-gray-100",children:["Cambio: C$ ",j]})]}),i.jsx("button",{onClick:Ot,disabled:p.length===0||E,className:"w-full bg-blue-600 text-white px-4 py-2 rounded",children:E?"Guardando...":"Guardar venta"}),C&&i.jsx("div",{className:`text-sm ${C.startsWith("")?"text-green-600":C.startsWith("")?"text-yellow-600":"text-red-600"}`,children:C})]})}):i.jsxs("div",{className:"relative",children:[i.jsxs("form",{onSubmit:Ot,className:`w-full mx-auto bg-white rounded-2xl shadow-2xl\r
                 p-4 sm:p-6 md:p-8\r
                 max-w-5xl space-y-4`,children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-blue-700 whitespace-nowrap",children:"Registrar venta (Pollo)"})}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Producto | Precio por Libra/Unidad"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:l,onChange:Qe=>c(Qe.target.value),children:[i.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),Qt.map(Qe=>i.jsxs("option",{value:Qe.id,disabled:Tt.has(Qe.id),title:Tt.has(Qe.id)?"Ya est en la lista":`Disponible: ${K(k[Qe.id]||0)}`,children:[Qe.productName,"  ",Qe.measurement,"  C$ ",Qe.price," (disp:"," ",K(k[Qe.id]||0),")"]},Qe.id))]}),i.jsx("button",{type:"button",onClick:X,disabled:!l||Tt.has(l),className:"px-3 py-2 rounded-2xl shadow-2xl bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:"Agregar"})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Fecha de la venta"}),i.jsx("input",{type:"date",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:u,onChange:Qe=>d(Qe.target.value)})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:le,onChange:Qe=>H(Qe.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),le==="CONTADO"?i.jsxs("div",{className:"md:col-span-2 space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente (Contado)"}),i.jsx("input",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:f,onChange:Qe=>A(Qe.target.value),placeholder:"Ej: Cliente Mostrador"})]}):i.jsxs("div",{className:"md:col-span-2 space-y-2",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente (Crdito)"}),i.jsxs("select",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:te,onChange:Qe=>Te(Qe.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),ie.map(Qe=>i.jsxs("option",{value:Qe.status==="ACTIVO"?Qe.id:"",disabled:Qe.status==="BLOQUEADO",children:[Qe.name,"  Saldo: ",A0(Qe.balance||0)]},Qe.id))]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:A0(Ye)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Pago inicial"}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Mximo: ",A0(ot)]}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:ot,className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:Ue===0?"":Ue,onChange:Qe=>{const De=Math.max(0,Number(Qe.target.value||0)),Je=Math.min(De,ot);O(Je)},placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:A0(Ct)})]})]})]})]}),i.jsx("div",{className:"rounded border overflow-x-auto shadow-2xl",children:i.jsxs("table",{className:"min-w-full text-sm r",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"text-center",children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio especial"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Existencias"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cantidad"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descuento"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:""})]})}),i.jsx("tbody",{children:p.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Agrega productos al carrito."})}):p.map(Qe=>{const De=G(Qe),Je=Number(De||0)*Number(Qe.qty||0),dt=Math.max(0,Je-Math.max(0,Number(Qe.discount||0))),ce=(Qe.measurement||"").toLowerCase()!=="lb",we=As(Number(Qe.stock)-Number(Qe.qty||0));return i.jsxs("tr",{className:"text-center",children:[i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[Qe.productName,"  ",Qe.measurement]}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",P(Qe.price).toFixed(2)]}),i.jsxs("td",{className:"p-2 border",children:[i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:Qe.specialPrice===0?"":Qe.specialPrice,onKeyDown:J,onChange:ue=>U(Qe.productId,ue.target.value),placeholder:"",title:"Precio especial (si se deja vaco, se usa el precio normal)"}),i.jsxs("div",{className:"text-[11px] text-gray-500 mt-1",children:["Aplicado: C$ ",P(De).toFixed(2)]})]}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:we.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:ce?1:.01,inputMode:ce?"numeric":"decimal",className:"w-28 border p-1 rounded text-right",value:Qe.qtyInput??(Qe.qty===0?"":Qe.qty),onKeyDown:J,onChange:ue=>be(Qe.productId,ue.target.value),placeholder:"0",title:"Cantidad"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:1,min:0,className:"w-24 border p-1 rounded text-right",value:Qe.discount===0?"":Qe.discount,onChange:ue=>ze(Qe.productId,ue.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento (entero C$)"})}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",P(dt).toFixed(2)]}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600 hover:bg-red-200",onClick:()=>Q(Qe.productId),title:"Quitar",children:""})})]},Qe.productId)})})]})}),i.jsxs("div",{className:"space-y-1 ",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 ",children:" Monto total"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${v.toFixed(2)}`,readOnly:!0,title:"Suma de (precio aplicado  cantidad  descuento) de cada producto."})]}),le==="CONTADO"&&i.jsx(i.Fragment,{children:i.jsxs("div",{className:"grid grid-cols-2 gap-x-3",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Monto recibido"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:b===0?"":b,onChange:Qe=>w(Number(Qe.target.value||0))})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cambio"}),i.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${j}`,readOnly:!0})]})]})}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 sm:py-2 rounded-2xl shadow-2xl font-semibold shadow hover:bg-blue-700 transition disabled:opacity-50",disabled:p.length===0||E,children:E?"Guardando...":"Guardar venta"}),C&&i.jsx("p",{className:`text-sm mt-2 ${C.startsWith("")?"text-green-600":C.startsWith("")?"text-yellow-600":"text-red-600"}`,children:C})]}),E&&i.jsx("div",{className:"fixed inset-0 bg-black/40 z-[60] flex items-center justify-center",children:i.jsx("div",{className:"bg-white rounded-lg shadow-xl border px-6 py-5",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-semibold",children:"Guardando venta"})]})})})]})}function Wre(t,e,r,n,a){n=n||{};var s=1.15,o=a.internal.scaleFactor,l=a.internal.getFontSize()/o,c=a.getLineHeightFactor?a.getLineHeightFactor():s,u=l*c,d=/\r\n|\r|\n/g,f="",A=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof t=="string"?t.split(d):t,A=f.length||1),r+=l*(2-s),n.valign==="middle"?r-=A/2*u:n.valign==="bottom"&&(r-=A*u),n.halign==="center"||n.halign==="right"){var h=l;if(n.halign==="center"&&(h*=.5),f&&A>=1){for(var m=0;m<f.length;m++)a.text(f[m],e-a.getStringUnitWidth(f[m])*h,r),r+=u;return a}e-=a.getStringUnitWidth(t)*h}return n.halign==="justify"?a.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(t,e,r),a}var tH={},pv=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:tH=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,a,s;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var o=this.jsPDFDocument.internal.getFont(),l=o.fontStyle,c=o.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),l=u[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var d=t.unifyColor(e.fillColor);d&&(n=this.jsPDFDocument).setFillColor.apply(n,d),d=t.unifyColor(e.textColor),d&&(a=this.jsPDFDocument).setTextColor.apply(a,d),d=t.unifyColor(e.lineColor),d&&(s=this.jsPDFDocument).setDrawColor.apply(s,d),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,a,s){return this.jsPDFDocument.rect(e,r,n,a,s)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return tH||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),Wk=function(t,e){return Wk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},Wk(t,e)};function Xre(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Wk(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Yre=function(t){Xre(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function KPe(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function qPe(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function MS(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],a=n.map(function(s){return r.getTextWidth(s)}).reduce(function(s,o){return Math.max(s,o)},0);return a}function Jre(t,e,r,n){var a=e.settings.tableLineWidth,s=e.settings.tableLineColor;t.applyStyles({lineWidth:a,lineColor:s});var o=Zre(a,!1);o&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,o)}function Zre(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function oP(t,e){var r,n,a,s;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(a=t.right)!==null&&a!==void 0?a:e,bottom:(s=t.bottom)!==null&&s!==void 0?s:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function ene(t,e){var r=oP(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function zPe(t,e,r,n,a){var s={},o=1.3333333333333333,l=w5(e,function(b){return a.getComputedStyle(b).backgroundColor});l!=null&&(s.fillColor=l);var c=w5(e,function(b){return a.getComputedStyle(b).color});c!=null&&(s.textColor=c);var u=XPe(n,r);u&&(s.cellPadding=u);var d="borderTopColor",f=o*r,A=n.borderTopWidth;if(n.borderBottomWidth===A&&n.borderRightWidth===A&&n.borderLeftWidth===A){var h=(parseFloat(A)||0)/f;h&&(s.lineWidth=h)}else s.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},s.lineWidth.top||(s.lineWidth.right?d="borderRightColor":s.lineWidth.bottom?d="borderBottomColor":s.lineWidth.left&&(d="borderLeftColor"));var m=w5(e,function(b){return a.getComputedStyle(b)[d]});m!=null&&(s.lineColor=m);var p=["left","right","center","justify"];p.indexOf(n.textAlign)!==-1&&(s.halign=n.textAlign),p=["middle","bottom","top"],p.indexOf(n.verticalAlign)!==-1&&(s.valign=n.verticalAlign);var x=parseInt(n.fontSize||"");isNaN(x)||(s.fontSize=x/o);var v=WPe(n);v&&(s.fontStyle=v);var y=(n.fontFamily||"").toLowerCase();return t.indexOf(y)!==-1&&(s.font=y),s}function WPe(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function w5(t,e){var r=tne(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],s=parseInt(n[4]);return s===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function tne(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:tne(t.parentElement,e):r}function XPe(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),a=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,s=r.map(function(l){return parseInt(l||"0")/n}),o=oP(s,0);return a>o.top&&(o.top=a),a>o.bottom&&(o.bottom=a),o}function rne(t,e,r,n,a){var s,o;n===void 0&&(n=!1),a===void 0&&(a=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),u=t.scaleFactor(),d=[],f=[],A=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:d,body:f,foot:A};for(var h=0;h<l.rows.length;h++){var m=l.rows[h],p=(o=(s=m==null?void 0:m.parentElement)===null||s===void 0?void 0:s.tagName)===null||o===void 0?void 0:o.toLowerCase(),x=YPe(c,u,r,m,n,a);x&&(p==="thead"?d.push(x):p==="tfoot"?A.push(x):f.push(x))}return{head:d,body:f,foot:A}}function YPe(t,e,r,n,a,s){for(var o=new Yre(n),l=0;l<n.cells.length;l++){var c=n.cells[l],u=r.getComputedStyle(c);if(a||u.display!=="none"){var d=void 0;s&&(d=zPe(t,c,e,u,r)),o.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:d,_element:c,content:JPe(c)})}}var f=r.getComputedStyle(n);if(o.length>0&&(a||f.display!=="none"))return o}function JPe(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function ZPe(t,e,r){for(var n=0,a=[t,e,r];n<a.length;n++){var s=a[n];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function Yh(t,e,r,n,a){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),o=1;o<arguments.length;o++){var l=arguments[o];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(s[c]=l[c])}return s}function nne(t,e){var r=new pv(t),n=r.getDocumentOptions(),a=r.getGlobalOptions();ZPe(a,n,e);var s=Yh({},a,n,e),o;typeof window<"u"&&(o=window);var l=e4e(a,n,e),c=t4e(a,n,e),u=r4e(r,s),d=a4e(r,s,o);return{id:e.tableId,content:d,hooks:c,styles:l,settings:u}}function e4e(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(c){if(c==="columnStyles"){var u=t[c],d=e[c],f=r[c];n.columnStyles=Yh({},u,d,f)}else{var A=[t,e,r],h=A.map(function(m){return m[c]||{}});n[c]=Yh({},h[0],h[1],h[2])}},s=0,o=Object.keys(n);s<o.length;s++){var l=o[s];a(l)}return n}function t4e(t,e,r){for(var n=[t,e,r],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,o=n;s<o.length;s++){var l=o[s];l.didParseCell&&a.didParseCell.push(l.didParseCell),l.willDrawCell&&a.willDrawCell.push(l.willDrawCell),l.didDrawCell&&a.didDrawCell.push(l.didDrawCell),l.willDrawPage&&a.willDrawPage.push(l.willDrawPage),l.didDrawPage&&a.didDrawPage.push(l.didDrawPage)}return a}function r4e(t,e){var r,n,a,s,o,l,c,u,d,f,A,h,m=oP(e.margin,40/t.scaleFactor()),p=(r=n4e(t,e.startY))!==null&&r!==void 0?r:m.top,x;e.showFoot===!0?x="everyPage":e.showFoot===!1?x="never":x=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var v;e.showHead===!0?v="everyPage":e.showHead===!1?v="never":v=(a=e.showHead)!==null&&a!==void 0?a:"everyPage";var y=(s=e.useCss)!==null&&s!==void 0?s:!1,b=e.theme||(y?"plain":"striped"),w=!!e.horizontalPageBreak,j=(o=e.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:y,theme:b,startY:p,margin:m,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=e.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(d=e.tableWidth)!==null&&d!==void 0?d:"auto",showHead:v,showFoot:x,tableLineWidth:(f=e.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(A=e.tableLineColor)!==null&&A!==void 0?A:200,horizontalPageBreak:w,horizontalPageBreakRepeat:j,horizontalPageBreakBehaviour:(h=e.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function n4e(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),a=t.pageNumber(),s=!1;if(r&&r.startPageNumber){var o=r.startPageNumber+r.pageNumber-1;s=o===a}return typeof e=="number"?e:(e==null||e===!1)&&s&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function a4e(t,e,r){var n=e.head||[],a=e.body||[],s=e.foot||[];if(e.html){var o=e.includeHiddenHtml;if(r){var l=rne(t,e.html,r,o,e.useCss)||{};n=l.head||n,a=l.body||n,s=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||s4e(n,a,s);return{columns:c,head:n,body:a,foot:s}}function s4e(t,e,r){var n=t[0]||e[0]||r[0]||[],a=[];return Object.keys(n).filter(function(s){return s!=="_element"}).forEach(function(s){var o=1,l;Array.isArray(n)?l=n[parseInt(s)]:l=n[s],typeof l=="object"&&!Array.isArray(l)&&(o=(l==null?void 0:l.colSpan)||1);for(var c=0;c<o;c++){var u=void 0;Array.isArray(n)?u=a.length:u=s+(c>0?"_".concat(c):"");var d={dataKey:u};a.push(d)}}),a}var Xk=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),i4e=function(t){Xre(e,t);function e(r,n,a,s,o,l){var c=t.call(this,r,n,l)||this;return c.cell=a,c.row=s,c.column=o,c.section=s.section,c}return e}(Xk),o4e=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,a,s,o){for(var l=0,c=r;l<c.length;l++){var u=c[l],d=new i4e(e,this,n,a,s,o),f=u(d)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var s=a[n];s(new Xk(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var s=a[n];s(new Xk(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(a,s){return a+s.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),ane=function(){function t(e,r,n,a,s){s===void 0&&(s=!1),this.height=0,this.raw=e,e instanceof Yre&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=a,this.spansMultiplePages=s}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,a){var s;return Math.max(n,((s=r.cells[a.index])===null||s===void 0?void 0:s.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var a=r.cells[n.index];return a?a.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(a,s){var o=n.cells[s.index];if(!o)return 0;var l=r.getLineHeight(o.styles.fontSize),c=o.padding("vertical"),u=c+l;return u>a?u:a},0)},t}(),sne=function(){function t(e,r,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var s=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,s=(a=e.content)!==null&&a!==void 0?a:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var o=s!=null?""+s:"",l=/\r\n|\r|\n/g;this.text=o.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/e*r,s=n*a+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=oP(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),l4e=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,a=e.allRows();n<a.length;n++){var s=a[n],o=s.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(r=Math.max(r,o.styles.cellWidth))}return r},t}();function c4e(t,e){u4e(t,e);var r=[],n=0;e.columns.forEach(function(s){var o=s.getMaxCustomCellWidth(e);o?s.width=o:(s.width=s.wrappedWidth,r.push(s)),n+=s.width});var a=e.getWidth(t.pageSize().width)-n;a&&(a=Yk(r,a,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),a&&(a=Yk(r,a,function(s){return s.minWidth})),a=Math.abs(a),!e.settings.horizontalPageBreak&&a>.1/t.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),f4e(e),h4e(e,t),d4e(e)}function u4e(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,a=ene(t,e);e.allRows().forEach(function(s){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u){var d=e.hooks.didParseCell;e.callCellHooks(t,d,u,s,c,null);var f=u.padding("horizontal");u.contentWidth=MS(u.text,u.styles,t)+f;var A=MS(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,t);if(u.minReadableWidth=A+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>a?(u.minWidth=a,u.wrappedWidth=a):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var h=10/r;u.minWidth=u.styles.minCellWidth||h,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),e.allRows().forEach(function(s){for(var o=0,l=e.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var d=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},f=d.cellWidth||d.minCellWidth;f&&typeof f=="number"&&(c.minWidth=f,c.wrappedWidth=f)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function Yk(t,e,r){for(var n=e,a=t.reduce(function(h,m){return h+m.wrappedWidth},0),s=0;s<t.length;s++){var o=t[s],l=o.wrappedWidth/a,c=n*l,u=o.width+c,d=r(o),f=u<d?d:u;e-=f-o.width,o.width=f}if(e=Math.round(e*1e10)/1e10,e){var A=t.filter(function(h){return e<0?h.width>r(h):!0});A.length&&(e=Yk(A,e,r))}return e}function d4e(t){for(var e={},r=1,n=t.allRows(),a=0;a<n.length;a++)for(var s=n[a],o=0,l=t.columns;o<l.length;o++){var c=l[o],u=e[c.index];if(r>1)r--,delete s.cells[c.index];else if(u)u.cell.height+=s.height,r=u.cell.colSpan,delete s.cells[c.index],u.left--,u.left<=1&&delete e[c.index];else{var d=s.cells[c.index];if(!d)continue;if(d.height=s.height,d.rowSpan>1){var f=n.length-a,A=d.rowSpan>f?f:d.rowSpan;e[c.index]={cell:d,left:A,row:s}}}}}function f4e(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],a=null,s=0,o=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(o-=1,o>1&&t.columns[l+1])s+=c.width,delete n.cells[c.index];else if(a){var u=a;delete n.cells[c.index],a=null,u.width=c.width+s}else{var u=n.cells[c.index];if(!u)continue;if(o=u.colSpan,s=0,u.colSpan>1){a=u,s+=c.width;continue}u.width=c.width+s}}}function h4e(t,e){for(var r={count:0,height:0},n=0,a=t.allRows();n<a.length;n++){for(var s=a[n],o=0,l=t.columns;o<l.length;o++){var c=l[o],u=s.cells[c.index];if(u){e.applyStyles(u.styles,!0);var d=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=e.splitTextToSize(u.text,d+1/e.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=rH(u.text,d,u.styles,e,"...");else if(u.styles.overflow==="hidden")u.text=rH(u.text,d,u.styles,e,"");else if(typeof u.styles.overflow=="function"){var f=u.styles.overflow(u.text,d);typeof f=="string"?u.text=[f]:u.text=f}u.contentHeight=u.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var A=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<A*u.rowSpan?r={height:A,count:u.rowSpan}:r&&r.count>0&&r.height>A&&(A=r.height),A>s.height&&(s.height=A)}}r.count--}}function rH(t,e,r,n,a){return t.map(function(s){return A4e(s,e,r,n,a)})}function A4e(t,e,r,n,a){var s=1e4*n.scaleFactor();if(e=Math.ceil(e*s)/s,e>=MS(t,r,n))return t;for(;e<MS(t+a,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+a}function ine(t,e){var r=new pv(t),n=m4e(e,r.scaleFactor()),a=new o4e(e,n);return c4e(r,a),r.applyStyles(r.userStyles),a}function m4e(t,e){var r=t.content,n=g4e(r.columns);if(r.head.length===0){var a=nH(n,"head");a&&r.head.push(a)}if(r.foot.length===0){var a=nH(n,"foot");a&&r.foot.push(a)}var s=t.settings.theme,o=t.styles;return{columns:n,head:N5("head",r.head,n,o,s,e),body:N5("body",r.body,n,o,s,e),foot:N5("foot",r.foot,n,o,s,e)}}function N5(t,e,r,n,a,s){var o={},l=e.map(function(c,u){for(var d=0,f={},A=0,h=0,m=0,p=r;m<p.length;m++){var x=p[m];if(o[x.index]==null||o[x.index].left===0)if(h===0){var v=void 0;Array.isArray(c)?v=c[x.index-A-d]:v=c[x.dataKey];var y={};typeof v=="object"&&!Array.isArray(v)&&(y=(v==null?void 0:v.styles)||{});var b=x4e(t,x,u,a,n,s,y),w=new sne(v,b,t);f[x.dataKey]=w,f[x.index]=w,h=w.colSpan-1,o[x.index]={left:w.rowSpan-1,times:h}}else h--,A++;else o[x.index].left--,h=o[x.index].times,d++}return new ane(c,u,t,f)});return l}function nH(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var a=p4e(e,n.raw);a!=null&&(r[n.dataKey]=a)}}),Object.keys(r).length>0?r:null}function p4e(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function g4e(t){return t.map(function(e,r){var n,a;return typeof e=="object"?a=(n=e.dataKey)!==null&&n!==void 0?n:r:a=r,new l4e(a,e,r)})}function x4e(t,e,r,n,a,s,o){var l=qPe(n),c;t==="head"?c=a.headStyles:t==="body"?c=a.bodyStyles:t==="foot"&&(c=a.footStyles);var u=Yh({},l.table,l[t],a.styles,c),d=a.columnStyles[e.dataKey]||a.columnStyles[e.index]||{},f=t==="body"?d:{},A=t==="body"&&r%2===0?Yh({},l.alternateRow,a.alternateRowStyles):{},h=KPe(s),m=Yh({},h,u,A,f);return Yh(m,o)}function v4e(t,e,r){var n;r===void 0&&(r={});var a=ene(t,e),s=new Map,o=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(A){var h=e.columns.find(function(m){return m.dataKey===A||m.index===A});h&&!s.has(h.index)&&(s.set(h.index,!0),o.push(h.index),l.push(e.columns[h.index]),a-=h.wrappedWidth)});for(var u=!0,d=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;d<e.columns.length;){if(s.has(d)){d++;continue}var f=e.columns[d].wrappedWidth;if(u||a>=f)u=!1,o.push(d),l.push(e.columns[d]),a-=f;else break;d++}return{colIndexes:o,columns:l,lastIndex:d-1}}function y4e(t,e){for(var r=[],n=0;n<e.columns.length;n++){var a=v4e(t,e,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}function one(t,e){var r=e.settings,n=r.startY,a=r.margin,s={x:a.left,y:n},o=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=n+a.bottom+o;if(r.pageBreak==="avoid"){var c=e.body,u=c.reduce(function(A,h){return A+h.height},0);l+=u}var d=new pv(t);(r.pageBreak==="always"||r.startY!=null&&l>d.pageSize().height)&&(cne(d),s.y=a.top),e.callWillDrawPageHooks(d,s);var f=Yh({},s);e.startPageNumber=d.pageNumber(),r.horizontalPageBreak?b4e(d,e,f,s):(d.applyStyles(d.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(A){return bA(d,e,A,s,e.columns)}),d.applyStyles(d.userStyles),e.body.forEach(function(A,h){var m=h===e.body.length-1;LS(d,e,A,m,f,s,e.columns)}),d.applyStyles(d.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(A){return bA(d,e,A,s,e.columns)})),Jre(d,e,f,s),e.callEndPageHooks(d,s),e.finalY=s.y,t.lastAutoTable=e,d.applyStyles(d.userStyles)}function b4e(t,e,r,n){var a=y4e(t,e),s=e.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(u,d){t.applyStyles(t.userStyles),d>0?Bb(t,e,r,n,u.columns,!0):aH(t,e,n,u.columns),w4e(t,e,r,n,u.columns),C5(t,e,n,u.columns)});else for(var o=-1,l=a[0],c=function(){var u=o;if(l){t.applyStyles(t.userStyles);var d=l.columns;o>=0?Bb(t,e,r,n,d,!0):aH(t,e,n,d),u=sH(t,e,o+1,n,d),C5(t,e,n,d)}var f=u-o;a.slice(1).forEach(function(A){t.applyStyles(t.userStyles),Bb(t,e,r,n,A.columns,!0),sH(t,e,o+1,n,A.columns,f),C5(t,e,n,A.columns)}),o=u};o<e.body.length-1;)c()}function aH(t,e,r,n){var a=e.settings;t.applyStyles(t.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&e.head.forEach(function(s){return bA(t,e,s,r,n)})}function w4e(t,e,r,n,a){t.applyStyles(t.userStyles),e.body.forEach(function(s,o){var l=o===e.body.length-1;LS(t,e,s,l,r,n,a)})}function sH(t,e,r,n,a,s){t.applyStyles(t.userStyles),s=s??e.body.length;var o=Math.min(r+s,e.body.length),l=-1;return e.body.slice(r,o).forEach(function(c,u){var d=r+u===e.body.length-1,f=lne(t,e,d,n);c.canEntireRowFit(f,a)&&(bA(t,e,c,n,a),l=r+u)}),l}function C5(t,e,r,n){var a=e.settings;t.applyStyles(t.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&e.foot.forEach(function(s){return bA(t,e,s,r,n)})}function N4e(t,e,r){var n=r.getLineHeight(t.styles.fontSize),a=t.padding("vertical"),s=Math.floor((e-a)/n);return Math.max(0,s)}function C4e(t,e,r,n){var a={};t.spansMultiplePages=!0,t.height=0;for(var s=0,o=0,l=r.columns;o<l.length;o++){var c=l[o],u=t.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var d=new sne(u.raw,u.styles,u.section);d=Yh(d,u),d.text=[];var f=N4e(u,e,n);u.text.length>f&&(d.text=u.text.splice(f,u.text.length));var A=n.scaleFactor(),h=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(A,h),u.contentHeight>=e&&(u.contentHeight=e,d.styles.minCellHeight-=e),u.contentHeight>t.height&&(t.height=u.contentHeight),d.contentHeight=d.getContentHeight(A,h),d.contentHeight>s&&(s=d.contentHeight),a[c.index]=d}}var m=new ane(t.raw,-1,t.section,a,!0);m.height=s;for(var p=0,x=r.columns;p<x.length;p++){var c=x[p],d=m.cells[c.index];d&&(d.height=m.height);var u=t.cells[c.index];u&&(u.height=t.height)}return m}function _4e(t,e,r,n){var a=t.pageSize().height,s=n.settings.margin,o=s.top+s.bottom,l=a-o;e.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),u=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var d=e.hasRowSpan(n.columns),f=e.getMaxCellHeight(n.columns)>l;return f?(d&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(d||n.settings.rowPageBreak==="avoid")}function LS(t,e,r,n,a,s,o){var l=lne(t,e,n,s);if(r.canEntireRowFit(l,o))bA(t,e,r,s,o);else if(_4e(t,r,l,e)){var c=C4e(r,l,e,t);bA(t,e,r,s,o),Bb(t,e,a,s,o),LS(t,e,c,n,a,s,o)}else Bb(t,e,a,s,o),LS(t,e,r,n,a,s,o)}function bA(t,e,r,n,a){n.x=e.settings.margin.left;for(var s=0,o=a;s<o.length;s++){var l=o[s],c=r.cells[l.index];if(!c){n.x+=l.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,n);if(u===!1){n.x+=l.width;continue}E4e(t,c,n);var d=c.getTextPos();Wre(c.text,d.x,d.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function E4e(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=Zre(n.lineWidth,n.fillColor);a&&t.rect(e.x,r.y,e.width,e.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),S4e(t,e,r,n.lineWidth))}function S4e(t,e,r,n){var a,s,o,l;n.top&&(a=r.x,s=r.y,o=r.x+e.width,l=r.y,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.top,a,s,o,l)),n.bottom&&(a=r.x,s=r.y+e.height,o=r.x+e.width,l=r.y+e.height,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.bottom,a,s,o,l)),n.left&&(a=r.x,s=r.y,o=r.x,l=r.y+e.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,a,s,o,l)),n.right&&(a=r.x+e.width,s=r.y,o=r.x+e.width,l=r.y+e.height,n.top&&(s-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,a,s,o,l));function c(u,d,f,A,h){t.getDocument().setLineWidth(u),t.getDocument().line(d,f,A,h,"S")}}function lne(t,e,r,n){var a=e.settings.margin.bottom,s=e.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&r)&&(a+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-a}function Bb(t,e,r,n,a,s){a===void 0&&(a=[]),s===void 0&&(s=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!s&&e.foot.forEach(function(l){return bA(t,e,l,n,a)}),e.callEndPageHooks(t,n);var o=e.settings.margin;Jre(t,e,r,n),cne(t),e.pageNumber++,n.x=o.left,n.y=o.top,r.y=o.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return bA(t,e,l,n,a)}),t.applyStyles(t.userStyles))}function cne(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function I4e(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],a=nne(this,n),s=ine(this,a);return one(this,s),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,a){Wre(e,r,n,a,this)},t.API.autoTableSetDefaults=function(e){return pv.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){pv.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new pv(this),s=rne(a,e,window,r,!1),o=s.head,l=s.body,c=((n=o[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:l,data:l}}}var _5;function V0(t,e){var r=nne(t,e),n=ine(t,r);one(t,n)}try{if(typeof window<"u"&&window){var iH=window,oH=iH.jsPDF||((_5=iH.jspdf)===null||_5===void 0?void 0:_5.jsPDF);oH&&I4e(oH)}}catch(t){console.error("Could not apply autoTable plugin",t)}const Ga=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function E5(t="LOT"){return`${t}-${Date.now()}-${Math.random().toString(16).slice(2)}`}function j4e({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const[a,s]=g.useState([]),[o,l]=g.useState([]),[c,u]=g.useState(!0),[d,f]=g.useState(""),{refreshKey:A,refresh:h}=Mc(),m=e&&e.length?e:t,p=Sn(m,"admin"),x=p||Sn(m,"contador"),[v,y]=g.useState(Ur(Qd(new Date),"yyyy-MM-dd")),[b,w]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[j,I]=g.useState(""),[C,S]=g.useState(!1),[E,B]=g.useState(""),[k,T]=g.useState(Ur(new Date,"yyyy-MM-dd")),[P,K]=g.useState("lb"),[le,oe]=g.useState(""),[ie,Ae]=g.useState(0),[te,Te]=g.useState(NaN),[Ue,O]=g.useState(0),[H,G]=g.useState([]),[L,W]=g.useState(null),[X,D]=g.useState([]),[Q,Z]=g.useState(!1),[be,U]=g.useState(null),[ze,re]=g.useState(!1),[J,Re]=g.useState(null),[ke,Be]=g.useState(null),Ye=Ce=>Be(pe=>pe===Ce?null:Ce),[ot,Ct]=g.useState(!1),jt=()=>Ct(Ce=>!Ce),[Ot,Tt]=g.useState("all"),[Qt,Ft]=g.useState({}),Qe=Ce=>Ft(pe=>({...pe,[Ce]:!(pe[Ce]??!1)})),De=(Ce,pe)=>{const He=[];return Ce>0&&He.push(`${Ce.toFixed(3)} lb`),pe>0&&He.push(`${pe.toFixed(3)} un`),He.length===0?"0":He.join("  ")},Je=Ce=>{const pe=(Ce||"").toLowerCase();return/(^|\s)(lb|lbs|libra|libras)(\s|$)/.test(pe)||pe==="lb"};g.useEffect(()=>{(async()=>{u(!0),f("");const Ce=await Ht(bt(je,"products")),pe=[];Ce.forEach(_e=>{const R=_e.data();R.active===!0&&pe.push({id:_e.id,name:R.name??R.productName??"(sin nombre)",category:R.category??"(sin categora)",measurement:R.measurement??"lb",price:Number(R.price??0),providerPrice:Object.prototype.hasOwnProperty.call(R,"providerPrice")?Number(R.providerPrice):void 0})}),s(pe);const He=sr(bt(je,"inventory_batches"),In("date","desc")),he=await Ht(He),ee=[];he.forEach(_e=>{const R=_e.data(),V=As(Number(R.quantity||0)),q=Number(R.purchasePrice||0),se=Number(R.salePrice||0),Ne=Number((V*q).toFixed(2)),Me=Number((V*se).toFixed(2));ee.push({id:_e.id,productId:R.productId,productName:R.productName,category:R.category,unit:R.unit,quantity:V,remaining:As(Number(R.remaining||0)),purchasePrice:q,salePrice:se,invoiceTotal:R.invoiceTotal!=null?Number(R.invoiceTotal):Ne,expectedTotal:R.expectedTotal!=null?Number(R.expectedTotal):Me,date:R.date,createdAt:R.createdAt,status:R.status,notes:R.notes,paidAmount:Number(R.paidAmount||0),paidAt:R.paidAt,batchGroupId:R.batchGroupId,orderName:R.orderName})}),l(ee),u(!1)})()},[A]);const dt=g.useMemo(()=>o.filter(Ce=>!(v&&Ce.date<v||b&&Ce.date>b||j&&Ce.productId!==j)),[o,v,b,j]),ce=g.useMemo(()=>{if(!j)return"Todos";const Ce=a.find(pe=>pe.id===j);return Ce?`${Ce.name}  ${Ce.category}`:"Filtro activo"},[j,a]),we=g.useMemo(()=>{const Ce=dt.reduce((q,se)=>q+Number(se.invoiceTotal||0),0),pe=dt.reduce((q,se)=>q+Number(se.expectedTotal||0),0);let He=0,he=0,ee=0,_e=0;for(const q of dt)Je(q.unit)?(He+=q.quantity,he+=q.remaining):(ee+=q.quantity,_e+=q.remaining);const R=dt.reduce((q,se)=>q+se.quantity,0),V=dt.reduce((q,se)=>q+se.remaining,0);return{lbsIng:He,lbsRem:he,udsIng:ee,udsRem:_e,qty:R,rem:V,totalFacturado:Ce,totalEsperado:pe}},[dt]),ue=g.useMemo(()=>{var He,he;const Ce=new Map;for(const ee of dt){const _e=ee.batchGroupId&&String(ee.batchGroupId).trim()||ee.id;Ce.has(_e)||Ce.set(_e,[]),Ce.get(_e).push(ee)}const pe=[];for(const[ee,_e]of Ce.entries()){const R=[..._e].sort((qe,at)=>{var Rt,nr;const st=((Rt=qe.createdAt)==null?void 0:Rt.seconds)??0;return(((nr=at.createdAt)==null?void 0:nr.seconds)??0)-st}),V=((He=R[0])==null?void 0:He.date)||"",q=String(((he=R[0])==null?void 0:he.orderName)||"").trim()||`Pedido ${V||""}`.trim()||"Pedido",se=new Set(R.map(qe=>String(qe.category||"").trim()).filter(Boolean)),Ne=se.size===1?Array.from(se)[0].toUpperCase():"MIXTO",Me=R.some(qe=>qe.status==="PENDIENTE")?"PENDIENTE":"PAGADO",Ke=As(R.reduce((qe,at)=>qe+(Je(at.unit)?Number(at.quantity||0):0),0)),Pe=As(R.reduce((qe,at)=>qe+(Je(at.unit)?Number(at.remaining||0):0),0)),rt=As(R.reduce((qe,at)=>qe+(Je(at.unit)?0:Number(at.quantity||0)),0)),lt=As(R.reduce((qe,at)=>qe+(Je(at.unit)?0:Number(at.remaining||0)),0)),ht=Number(R.reduce((qe,at)=>qe+Number(at.invoiceTotal||0),0).toFixed(2)),kt=Number(R.reduce((qe,at)=>qe+Number(at.expectedTotal||0),0).toFixed(2)),de=Number((kt-ht).toFixed(2));pe.push({groupId:ee,orderName:q,date:V,typeLabel:Ne,status:Me,lbsIn:Ke,lbsRem:Pe,udsIn:rt,udsRem:lt,totalFacturado:ht,totalEsperado:kt,utilidadBruta:de,items:R})}return pe.sort((ee,_e)=>ee.date===_e.date?ee.groupId<_e.groupId?1:-1:ee.date<_e.date?1:-1),pe},[dt]),ne=g.useMemo(()=>Ot==="all"?ue:ue.filter(Ce=>{const pe=Ce.lbsRem>0||Ce.udsRem>0;return Ot==="with"?pe:!pe}),[ue,Ot]),Ve=g.useMemo(()=>{const Ce=new Map;return ne.forEach(pe=>{const He=pe.typeLabel||"MIXTO";Ce.has(He)||Ce.set(He,[]),Ce.get(He).push(pe)}),Array.from(Ce.entries()).map(([pe,He])=>({type:pe,items:He}))},[ne]),it=g.useMemo(()=>{const Ce=String(P||"").toLowerCase().trim();return a.filter(He=>String(He.measurement||"").toLowerCase().trim()===Ce).sort((He,he)=>He.name.localeCompare(he.name,"es"))},[a,P]);g.useEffect(()=>{const Ce=H.find(He=>He.productId===le);if(Ce){Ae(Number(Ce.quantity||0)),Te(Number(Ce.purchasePrice||0)),O(Number(Ce.salePrice||0));return}const pe=a.find(He=>He.id===le);pe?(Ae(0),O(Number(pe.price||0)),pe.providerPrice!=null&&Number.isFinite(Number(pe.providerPrice))?Te(Number(pe.providerPrice)):Te(NaN)):(Ae(0),O(0),Te(NaN))},[le,a,A,H]);const vt=()=>{f("");const Ce=a.find(V=>V.id===le);if(!Ce)return f("Selecciona un producto.");if(ie<=0||!Number.isFinite(te)||te<=0)return f("Completa libras a ingresar y precio proveedor.");const pe=As(ie),He=Ce.measurement,he=Number((pe*Number(te||0)).toFixed(2)),ee=Number((pe*Number(Ue||0)).toFixed(2)),_e=Number((ee-he).toFixed(2)),R=H.findIndex(V=>V.productId===Ce.id);R>=0?G(V=>V.map((q,se)=>se!==R?q:{...q,quantity:pe,remaining:pe,purchasePrice:Number(te||0),salePrice:Number(Ue||0),invoiceTotal:he,expectedTotal:ee,utilidadBruta:_e})):G(V=>[...V,{tempId:E5("IT"),productId:Ce.id,productName:Ce.name,category:Ce.category,unit:He,quantity:pe,remaining:pe,purchasePrice:Number(te||0),salePrice:Number(Ue||0),invoiceTotal:he,expectedTotal:ee,utilidadBruta:_e}]),oe(""),Ae(0),Te(NaN),O(0)},me=Ce=>{G(pe=>pe.filter(He=>He.tempId!==Ce))},Ee=(Ce,pe,He)=>{G(he=>he.map(ee=>{if(ee.tempId!==Ce)return ee;const _e={...ee};return pe==="quantity"&&(_e.quantity=As(Math.max(0,He)),L||(_e.remaining=_e.quantity)),pe==="purchasePrice"&&(_e.purchasePrice=Math.max(0,Number(He||0))),pe==="salePrice"&&(_e.salePrice=Math.max(0,Number(He||0))),_e.invoiceTotal=Number((_e.quantity*_e.purchasePrice).toFixed(2)),_e.expectedTotal=Number((_e.quantity*_e.salePrice).toFixed(2)),_e.utilidadBruta=Number((_e.expectedTotal-_e.invoiceTotal).toFixed(2)),_e}))},ye=g.useMemo(()=>{const Ce=As(H.reduce((_e,R)=>_e+(Je(R.unit)?Number(R.quantity||0):0),0)),pe=As(H.reduce((_e,R)=>_e+(Je(R.unit)?Number(R.remaining||0):0),0)),He=Number(H.reduce((_e,R)=>_e+Number(R.invoiceTotal||0),0).toFixed(2)),he=Number(H.reduce((_e,R)=>_e+Number(R.expectedTotal||0),0).toFixed(2)),ee=Number((he-He).toFixed(2));return{lbsIn:Ce,lbsRem:pe,totalFacturado:He,totalEsperado:he,utilidadBruta:ee}},[H]),We=()=>{W(null),D([]),B(""),T(Ur(new Date,"yyyy-MM-dd")),K("lb"),oe(""),Ae(0),Te(NaN),O(0),G([])},ge=async()=>{if(f(""),!H.length)return f("Agrega al menos un producto al pedido.");const Ce=k||Ur(new Date,"yyyy-MM-dd"),pe=String(E||"").trim()||`Pedido ${Ce}`,He=L||E5("BATCH");try{if(!L){for(const R of H)await zV({productId:R.productId,productName:R.productName,category:R.category,unit:R.unit,quantity:As(R.quantity),purchasePrice:Number(R.purchasePrice||0),salePrice:Number(R.salePrice||0),invoiceTotal:Number(R.invoiceTotal||0),expectedTotal:Number(R.expectedTotal||0),date:Ce,notes:"",batchGroupId:He,orderName:pe});f(" Pedido creado"),S(!1),We(),h();return}const he=X,ee=new Map;for(const R of he)ee.set(R.productId,R);const _e=new Set(H.map(R=>R.productId));for(const R of H){const V=ee.get(R.productId),q=As(R.quantity);if(V){const se=As(V.quantity-V.remaining),Ne=Math.max(0,As(q-se));await kn(Xt(je,"inventory_batches",V.id),{date:Ce,orderName:pe,batchGroupId:He,quantity:q,purchasePrice:Number(R.purchasePrice||0),salePrice:Number(R.salePrice||0),invoiceTotal:Number(R.invoiceTotal||0),expectedTotal:Number(R.expectedTotal||0),remaining:Ne})}else await zV({productId:R.productId,productName:R.productName,category:R.category,unit:R.unit,quantity:q,purchasePrice:Number(R.purchasePrice||0),salePrice:Number(R.salePrice||0),invoiceTotal:Number(R.invoiceTotal||0),expectedTotal:Number(R.expectedTotal||0),date:Ce,notes:"",batchGroupId:He,orderName:pe})}for(const R of he)_e.has(R.productId)||await zn(Xt(je,"inventory_batches",R.id));f(" Pedido actualizado"),S(!1),We(),h()}catch(he){console.error(he),f(" Error al guardar pedido")}},Ie=Ce=>{U(Ce),Z(!0)},xt=Ce=>{W(Ce.groupId),D(Ce.items),B(Ce.orderName),T(Ce.date||Ur(new Date,"yyyy-MM-dd"));const pe=Ce.items.map(He=>{const he=Number(He.invoiceTotal||0),ee=Number(He.expectedTotal||0);return{tempId:E5("IT"),productId:He.productId,productName:He.productName,category:He.category,unit:He.unit,quantity:As(He.quantity),remaining:As(He.remaining),purchasePrice:Number(He.purchasePrice||0),salePrice:Number(He.salePrice||0),invoiceTotal:he,expectedTotal:ee,utilidadBruta:Number((ee-he).toFixed(2))}});G(pe),S(!0)},Pt=async Ce=>{if(confirm(`Eliminar el pedido "${Ce.orderName}" del ${Ce.date}?`))try{for(const He of Ce.items)await zn(Xt(je,"inventory_batches",He.id));f(" Pedido eliminado"),h()}catch(He){console.error(He),f(" Error al eliminar pedido")}},It=Ce=>{Re(Ce),re(!0)},Ut=async()=>{if(J)try{for(const Ce of J.items){if(Ce.status!=="PENDIENTE")continue;await $re(Ce.id),await kn(Xt(je,"inventory_batches",Ce.id),{remaining:0});const pe={date:Ce.date,productName:Ce.productName,quantity:Ce.quantity,amount:Number((Ce.expectedTotal??Ce.salePrice*Ce.quantity).toFixed(2)),allocations:[{batchId:Ce.id,qty:Ce.quantity,unitCost:Ce.purchasePrice,lineCost:Number((Ce.purchasePrice*Ce.quantity).toFixed(2))}],avgUnitCost:Ce.purchasePrice,measurement:Ce.unit,createdAt:xr.now(),autoGeneratedFromInventory:!0};await Wn(bt(je,"salesV2"),pe)}f(" Pedido pagado y reflejado como venta"),h()}catch(Ce){console.error(Ce),f(" Error al pagar pedido")}finally{re(!1),Re(null)}},$t=()=>{re(!1),Re(null)},Le=()=>{const Ce=new an({unit:"pt",format:"a4",orientation:"landscape"}),pe="Inventario de Pollo",He=`Rango: ${v||"(sin inicio)"} a ${b||"(sin fin)"}`,he=`Producto: ${ce}`,ee=V=>Number(V||0).toFixed(3);let _e=40;Ce.setFontSize(16),Ce.text(pe,40,_e),_e+=16,Ce.setFontSize(10),Ce.text(He,40,_e),_e+=12,Ce.text(he,40,_e),_e+=14;const R=()=>{var V;_e=(V=Ce.lastAutoTable)!=null&&V.finalY?Ce.lastAutoTable.finalY+18:_e+18};V0(Ce,{startY:_e,head:[["KPI","Valor"]],body:[["Libras ingresadas",ee(we.lbsIng)],["Libras restantes",ee(we.lbsRem)],["Unidades ingresadas",ee(we.udsIng)],["Unidades restantes",ee(we.udsRem)],["Total esperado",Ga(we.totalEsperado)],["Total facturado",Ga(we.totalFacturado)],["Ganancia sin gastos",Ga(we.totalEsperado-we.totalFacturado)],["Cantidad de lotes",dt.length.toString()]],styles:{fontSize:9},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),R(),V0(Ce,{startY:_e,head:[["Fecha","Pedido","Tipo","Lb In","Lb Rem","Ud In","Ud Rem","Facturado","Esperado","Utilidad","Estado"]],body:ue.map(V=>[V.date,V.orderName,V.typeLabel,ee(V.lbsIn),ee(V.lbsRem),ee(V.udsIn),ee(V.udsRem),Ga(V.totalFacturado),Ga(V.totalEsperado),Ga(V.utilidadBruta),V.status]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),R(),ue.forEach(V=>{Ce.setFontSize(11),Ce.text(`Pedido: ${V.orderName} (${V.date})  ${V.typeLabel}`,40,_e),_e+=12,V0(Ce,{startY:_e,head:[["Producto","Unidad","Ingresado","Restante","Precio compra","Precio venta","Total facturado","Total esperado","Utilidad","Estado"]],body:V.items.map(q=>[q.productName,(q.unit||"").toUpperCase(),ee(q.quantity),ee(q.remaining),Ga(q.purchasePrice),Ga(q.salePrice),Ga(q.invoiceTotal||q.purchasePrice*q.quantity),Ga(q.expectedTotal||q.salePrice*q.quantity),Ga((q.expectedTotal||q.salePrice*q.quantity)-(q.invoiceTotal||q.purchasePrice*q.quantity)),q.status]),styles:{fontSize:8},headStyles:{fillColor:[230,230,230],textColor:[0,0,0]}}),R()}),Ce.save(`inventario_pollo_${v||"sin_desde"}_a_${b||"sin_hasta"}.pdf`)};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-2xl bg-gray-900 text-white hover:bg-black",type:"button",onClick:Le,disabled:c,children:"Exportar PDF"}),x&&i.jsx("button",{className:"px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",type:"button",onClick:()=>{We(),S(!0)},children:"Crear Lote"})]})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow-2xl border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:v,onChange:Ce=>y(Ce.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:b,onChange:Ce=>w(Ce.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:j,onChange:Ce=>I(Ce.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),a.map(Ce=>i.jsxs("option",{value:Ce.id,children:[Ce.name,"  ",Ce.category]},Ce.id))]})]}),i.jsx("button",{className:"px-3 rounded-2xl shadow-2xl py-1 bg-gray-200 hover:bg-gray-300",onClick:()=>{y(""),w(""),I("")},children:"Quitar filtro"}),i.jsx("div",{className:"ml-auto",children:i.jsx(Rc,{onClick:()=>h(),loading:c})})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:[i.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:jt,role:"button","aria-expanded":ot,children:[i.jsxs("div",{className:"flex gap-6 items-center",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",we.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",we.lbsRem.toFixed(3)]})]}),i.jsx("div",{className:"text-sm text-gray-500",children:ot?"Cerrar":"Ver ms"})]}),ot&&i.jsx("div",{className:"mt-3",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",we.lbsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",we.lbsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",we.udsIng.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",we.udsRem.toFixed(3)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ","C$ ",we.totalEsperado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," C$"," ",we.totalFacturado.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," C$"," ",(we.totalEsperado-we.totalFacturado).toFixed(2)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes (por filtro):"})," ",dt.length.toLocaleString()]})]})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsx("div",{className:"flex gap-2",children:[{key:"all",label:"Todos"},{key:"with",label:"Con disponibilidad"},{key:"without",label:"Sin disponibilidad"}].map(Ce=>{const pe=Ot===Ce.key;return i.jsx("button",{type:"button",onClick:()=>Tt(Ce.key),className:`flex-1 px-3 py-2 rounded-xl text-sm font-semibold shadow ${pe?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:Ce.label},Ce.key)})}),c?i.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow",children:"Cargando"}):ne.length===0?i.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow text-center",children:Ot==="with"?"Sin lotes con disponibilidad.":Ot==="without"?"Sin lotes sin disponibilidad.":"Sin lotes"}):Ve.map(({type:Ce,items:pe})=>{const He=Qt[Ce]??!1;return i.jsxs("div",{className:"bg-white border rounded-2xl",children:[i.jsxs("button",{type:"button",onClick:()=>Qe(Ce),className:"w-full px-4 py-3 flex items-center justify-between text-left",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:Ce}),i.jsxs("div",{className:"text-xs text-gray-500",children:[pe.length," ",pe.length===1?"lote":"lotes"]})]}),i.jsx("span",{className:"text-xs text-gray-500",children:He?"Cerrar":"Ver"})]}),He&&i.jsx("div",{className:"space-y-3 px-2 pb-4",children:pe.map(he=>{const ee=ke===he.groupId,_e=he.lbsRem>0||he.udsRem>0;return i.jsxs("div",{className:"bg-gray-50 border rounded-2xl",children:[i.jsxs("div",{className:"p-4 flex items-start justify-between gap-3 cursor-pointer",onClick:()=>Ye(he.groupId),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsxs("div",{className:"font-semibold text-lg",children:[he.date,i.jsxs("div",{className:"text-sm text-gray-500",children:["Producto: ",he.typeLabel]})]}),i.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["Nombre: ",he.orderName]})]}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsx("span",{className:`px-2 py-1 rounded text-xs shrink-0 ${he.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:he.status})})]}),i.jsxs("div",{className:"pb-4 p-4 flex items-start justify-between gap-1 cursor-pointer",children:[i.jsxs("div",{className:"px-2 py-1 rounded text-xs shrink-0 bg-green-100 font-semibold text-gray-700",children:["Ingresado: ",De(he.lbsIn,he.udsIn)]}),i.jsxs("span",{className:`px-2 py-1 rounded text-xs shrink-0 ${_e?"bg-green-100 font-semibold text-gray-700":"bg-red-100 font-semibold text-red-700"}`,children:["Disponible: ",De(he.lbsRem,he.udsRem)]})]}),ee&&i.jsxs("div",{className:"p-4 pt-0",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Tipo"}),i.jsx("div",{className:"font-semibold",children:he.typeLabel})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Utilidad bruta"}),i.jsx("div",{className:"font-semibold",children:Ga(he.utilidadBruta)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lbs ingresadas"}),i.jsx("div",{className:"font-semibold",children:he.lbsIn.toFixed(3)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lbs restantes"}),i.jsx("div",{className:"font-semibold",children:he.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-2 col-span-2",children:[i.jsxs("div",{className:"flex justify-between text-[11px] text-gray-500",children:[i.jsx("span",{children:"Total facturado"}),i.jsx("span",{children:"Total esperado"})]}),i.jsxs("div",{className:"flex justify-between font-semibold",children:[i.jsx("span",{children:Ga(he.totalFacturado)}),i.jsx("span",{children:Ga(he.totalEsperado)})]})]}),he.items.length>0&&i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 col-span-2 border border-gray-100",children:[i.jsx("div",{className:"text-[11px] text-gray-500 mb-2",children:"Productos asociados"}),i.jsx("div",{className:"space-y-1",children:he.items.map(R=>i.jsxs("div",{className:"flex items-center text-xs justify-between gap-2",children:[i.jsx("div",{className:"font-semibold text-gray-800 truncate",children:R.productName}),i.jsxs("div",{className:"text-gray-600 text-right",children:[i.jsxs("div",{children:["Ingresado:"," ",R.quantity.toFixed(3)]}),i.jsxs("div",{children:["Restante:"," ",R.remaining.toFixed(3)]})]})]},R.id))})]})]}),i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-sm",onClick:()=>Ie(he),children:"Ver detalle"}),p?i.jsxs(i.Fragment,{children:[he.status==="PENDIENTE"&&i.jsx("button",{className:"px-3 py-2 rounded-xl bg-green-600 hover:bg-green-700 text-white text-sm",onClick:()=>It(he),children:"Pagar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-yellow-600 hover:bg-yellow-700 text-white text-sm",onClick:()=>xt(he),children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-red-600 hover:bg-red-700 text-white text-sm",onClick:()=>Pt(he),children:"Borrar"})]}):null]})]})]},he.groupId)})})]},Ce)})]}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Unidades ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Unidades restantes"}),i.jsx("th",{className:"p-2 border",children:"Total Facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:c?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):ue.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin lotes"})}):ue.map(Ce=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border",children:[i.jsx("button",{className:"underline text-blue-700 hover:text-blue-900",onClick:()=>Ie(Ce),title:Ce.orderName,children:Ce.date}),i.jsx("div",{className:"text-[11px] text-gray-500",children:Ce.orderName})]}),i.jsx("td",{className:"p-2 border",children:Ce.typeLabel}),i.jsx("td",{className:"p-2 border",children:Ce.lbsIn.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ce.lbsRem.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ce.udsIn.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ce.udsRem.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ga(Ce.totalFacturado)}),i.jsx("td",{className:"p-2 border",children:Ga(Ce.totalEsperado)}),i.jsx("td",{className:"p-2 border",children:Ga(Ce.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Ce.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:Ce.status})}),i.jsx("td",{className:"p-2 border",children:p?i.jsxs("div",{className:"flex gap-2 justify-center",children:[Ce.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>It(Ce),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>xt(Ce),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Pt(Ce),children:"Borrar"})]}):i.jsx("span",{className:"text-xs text-gray-500",children:"Solo vista"})})]},Ce.groupId))})]})}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),C&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>S(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:L?"Editar pedido":"Crear pedido"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>S(!1),type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de pedido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:E,onChange:Ce=>B(Ce.target.value),placeholder:"Ej: Pedido Pollo - Semana 1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:k,onChange:Ce=>T(Ce.target.value)})]})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidad"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:P,onChange:Ce=>{K(Ce.target.value),oe(""),Ae(0),Te(NaN),O(0)},children:[i.jsx("option",{value:"lb",children:"lb"}),i.jsx("option",{value:"unidad",children:"unidad"}),i.jsx("option",{value:"kg",children:"kg"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (solo activos)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:le,onChange:Ce=>oe(Ce.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),it.map(Ce=>i.jsxs("option",{value:Ce.id,children:[Ce.name,"  ",Ce.category,"  ",Ce.measurement]},Ce.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Libras a ingresar"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ie===0?"":ie,onChange:Ce=>{const pe=Ce.target.value.replace(",","."),He=parseFloat(pe),he=Number.isFinite(He)?parseFloat(He.toFixed(3)):0;Ae(Math.max(0,he));const ee=H.find(_e=>_e.productId===le);ee&&Ee(ee.tempId,"quantity",he)},disabled:!le})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Number.isNaN(te)?"":te,onChange:Ce=>{const pe=Ce.target.value.replace(",",".");if(pe==="")return Te(NaN);const He=parseFloat(pe),he=Number.isFinite(He)?parseFloat(He.toFixed(2)):NaN;Te(Number.isFinite(he)?Math.max(0,he):NaN);const ee=H.find(_e=>_e.productId===le);ee&&Number.isFinite(he)&&Ee(ee.tempId,"purchasePrice",he)},disabled:!le})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio venta (editable)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Ue===0?"":Ue,onChange:Ce=>{const pe=Ce.target.value.replace(",","."),He=parseFloat(pe),he=Number.isFinite(He)?parseFloat(He.toFixed(2)):0;O(Math.max(0,he));const ee=H.find(_e=>_e.productId===le);ee&&Ee(ee.tempId,"salePrice",he)},disabled:!le})]})]}),i.jsx("div",{className:"flex justify-end mt-3",children:i.jsx("button",{type:"button",onClick:vt,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto al pedido"})})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),i.jsx("th",{className:"p-2 border",children:"Libras restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:H.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center text-gray-500",children:"No hay productos agregados."})}):H.map(Ce=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsxs("td",{className:"p-2 border text-left",children:[Ce.productName,i.jsxs("div",{className:"text-[11px] text-gray-500",children:[Ce.category,"  ",Ce.unit]})]}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:Ce.quantity,onChange:pe=>{const He=pe.target.value.replace(",","."),he=parseFloat(He),ee=Number.isFinite(he)?parseFloat(he.toFixed(3)):0;Ee(Ce.tempId,"quantity",ee)}})}),i.jsx("td",{className:"p-2 border",children:Number(Ce.remaining||0).toFixed(3)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:Ce.purchasePrice,onChange:pe=>{const He=pe.target.value.replace(",","."),he=parseFloat(He),ee=Number.isFinite(he)?parseFloat(he.toFixed(2)):0;Ee(Ce.tempId,"purchasePrice",ee)}})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:Ce.salePrice,onChange:pe=>{const He=pe.target.value.replace(",","."),he=parseFloat(He),ee=Number.isFinite(he)?parseFloat(he.toFixed(2)):0;Ee(Ce.tempId,"salePrice",ee)}})}),i.jsx("td",{className:"p-2 border",children:Ga(Ce.invoiceTotal)}),i.jsx("td",{className:"p-2 border",children:Ga(Ce.expectedTotal)}),i.jsx("td",{className:"p-2 border",children:Ga(Ce.utilidadBruta)}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>me(Ce.tempId),children:"Quitar"})})]},Ce.tempId))})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:ye.lbsIn.toFixed(3)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:ye.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado"}),i.jsx("div",{className:"text-lg font-semibold",children:Ga(ye.totalFacturado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Total esperado"}),i.jsx("div",{className:"text-lg font-semibold",children:Ga(ye.totalEsperado)}),i.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:Ga(ye.utilidadBruta)})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>S(!1),children:"Cancelar"}),i.jsx("button",{type:"button",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:ge,disabled:H.length===0,children:L?"Editar pedido":"Crear pedido"})]})]})]}),document.body),Q&&be&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[75] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{Z(!1),U(null)}}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del pedido"}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:be.orderName})," "," ",be.date]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Z(!1),U(null)},type:"button",children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:be.items.map(Ce=>{const pe=Number(Ce.invoiceTotal||0),He=Number(Ce.expectedTotal||0);return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border text-left",children:Ce.productName}),i.jsx("td",{className:"p-2 border",children:(Ce.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Ce.quantity.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ce.remaining.toFixed(3)}),i.jsx("td",{className:"p-2 border",children:Ga(Ce.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:Ga(Ce.salePrice)}),i.jsx("td",{className:"p-2 border",children:Ga(pe)}),i.jsx("td",{className:"p-2 border",children:Ga(He)}),i.jsx("td",{className:"p-2 border",children:Ga(He-pe)}),i.jsx("td",{className:"p-2 border",children:Ce.status})]},Ce.id)})})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),i.jsx("div",{className:"text-lg font-semibold",children:be.lbsIn.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras restantes"}),i.jsx("div",{className:"text-lg font-semibold",children:be.lbsRem.toFixed(3)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:Ga(be.utilidadBruta)})]})]})]})]}),document.body),ze&&J&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:$t}),i.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl border w-[90%] max-w-md p-6",children:[i.jsx("h3",{className:"text-lg font-bold mb-3 text-center",children:"Confirmar pago de inventario"}),i.jsxs("p",{className:"text-sm text-gray-700 mb-5 text-center",children:["Seguro que quieres pagar este pedido?",i.jsx("br",{}),i.jsx("strong",{children:J.orderName})," "," ",J.date,i.jsx("br",{}),"Ya no habrn libras disponibles al pagar este inventario."]}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx("button",{onClick:Ut,className:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700",children:"Confirmar"}),i.jsx("button",{onClick:$t,className:"px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400",children:"Cancelar"})]})]})]}),document.body)]})}const Bh=t=>`C$${(Number(t)||0).toFixed(2)}`;function P4e(){const t=lwe(new Date),[e,r]=g.useState(Ur(t,"yyyy-MM")),[n,a]=g.useState([]),[s,o]=g.useState(!1),[l,c]=g.useState(""),u=g.useRef(null),d=g.useMemo(()=>{const[x,v]=e.split("-").map(w=>parseInt(w,10)),y=Ur(Qd(new Date(x,v-1,1)),"yyyy-MM-dd"),b=Ur(Ud(new Date(x,v-1,1)),"yyyy-MM-dd");return{from:y,to:b}},[e]),f=async()=>{o(!0);try{const x=await CPe(d.from,d.to),v=[];for(const y of x){const b=Xt(je,"inventory_batches",y.batchId),w=await Cs(b);if(!w.exists())continue;const j=w.data();v.push({batchId:y.batchId,batchDate:y.batchDate,productName:y.productName,soldQty:Number(y.quantity||0),soldAmount:Number(y.amountCharged||0),status:j.status??"PENDIENTE",purchasePrice:Number(j.purchasePrice||0),salePrice:Number(j.salePrice||0),supplier:j.supplier})}a(v)}catch(x){console.error(x),c(" Error al cargar liquidaciones")}finally{o(!1)}};g.useEffect(()=>{f()},[e]);const A=async x=>{confirm("Marcar este lote como PAGADO?")&&(await $re(x),a(y=>y.map(b=>b.batchId===x?{...b,status:"PAGADO"}:b)))},h=g.useMemo(()=>{const x=n.reduce((w,j)=>w+j.soldQty,0),v=n.reduce((w,j)=>w+j.soldAmount,0),y=n.reduce((w,j)=>w+j.soldQty*j.purchasePrice,0),b=v-y;return{q:x,amt:v,cogs:y,profit:b}},[n]),m=g.useMemo(()=>{const x=new Map;for(const v of n){const y=v.productName||"(sin nombre)";x.has(y)||x.set(y,{productName:y,qty:0,revenue:0,cogs:0,profit:0});const b=x.get(y);b.qty+=v.soldQty,b.revenue+=v.soldAmount;const w=v.soldQty*v.purchasePrice;b.cogs+=w,b.profit=b.revenue-b.cogs}return Array.from(x.values()).sort((v,y)=>v.productName.localeCompare(y.productName))},[n]),p=async()=>{if(!u.current)return;const x=u.current;x.classList.add("force-pdf-colors");try{const[{default:v},{jsPDF:y}]=await Promise.all([oA(()=>Promise.resolve().then(()=>G6),void 0),oA(()=>Promise.resolve().then(()=>zk),void 0)]),w=(await v(x,{backgroundColor:"#ffffff",scale:2})).toDataURL("image/png"),j=new y("p","mm","a4"),I=190,C=j.getImageProperties(w),S=I,E=C.height*S/C.width;j.addImage(w,"PNG",10,10,S,E),j.save(`liquidaciones_${e}.pdf`)}catch(v){console.error(v),alert("No se pudo generar el PDF")}finally{x.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Liquidaciones por lote"}),i.jsx("button",{onClick:p,className:"bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"Descargar PDF"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-center gap-3",children:[i.jsx("label",{className:"text-sm font-semibold",children:"Mes:"}),i.jsx("input",{type:"month",className:"border rounded px-2 py-1",value:e,onChange:x=>r(x.target.value)}),i.jsx("button",{onClick:f,className:"bg-gray-800 text-white px-3 py-1 rounded",children:"Aplicar"})]}),i.jsxs("div",{ref:u,children:[i.jsx("div",{className:"bg-white p-3 rounded shadow border mb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total vendido (cantidad):"})," ",h.q]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto vendido:"})," ",Bh(h.amt)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Costo (COGS):"})," ",Bh(h.cogs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Utilidad:"})," ",Bh(h.profit)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Lote (fecha)"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Vendido"}),i.jsx("th",{className:"p-2 border",children:"Monto vendido"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:s?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):n.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin datos"})}):n.map(x=>{const v=x.soldQty*x.purchasePrice,y=x.soldAmount-v;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.batchDate}),i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.supplier||"-"}),i.jsx("td",{className:"p-2 border",children:x.soldQty}),i.jsx("td",{className:"p-2 border",children:Bh(x.soldAmount)}),i.jsx("td",{className:"p-2 border",children:Bh(v)}),i.jsx("td",{className:`p-2 border ${y>=0?"text-green-700":"text-red-700"}`,children:Bh(y)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${x.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:x.status})}),i.jsx("td",{className:"p-2 border",children:x.status==="PENDIENTE"&&i.jsx("button",{onClick:()=>A(x.batchId),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Marcar pagado"})})]},x.batchId)})})]})}),i.jsx("h3",{className:"font-semibold mb-2",children:"Utilidad por producto"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad vendida"}),i.jsx("th",{className:"p-2 border",children:"Ingreso"}),i.jsx("th",{className:"p-2 border",children:"COGS"}),i.jsx("th",{className:"p-2 border",children:"Utilidad"})]})}),i.jsx("tbody",{children:m.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin datos"})}):m.map(x=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:x.productName}),i.jsx("td",{className:"p-2 border",children:x.qty}),i.jsx("td",{className:"p-2 border",children:Bh(x.revenue)}),i.jsx("td",{className:"p-2 border",children:Bh(x.cogs)}),i.jsx("td",{className:`p-2 border ${x.profit>=0?"text-green-700":"text-red-700"}`,children:Bh(x.profit)})]},x.productName))})]})})]}),l&&i.jsx("p",{className:"mt-2 text-sm",children:l})]})}const Zr=t=>`C$${Number(t??0).toFixed(2)}`,T4e=()=>Ur(new Date,"yyyy-MM-dd"),oa=t=>Number(t||0).toFixed(3);function B4e(){const[t,e]=g.useState(()=>{const he=new Date,ee=new Date(he.getFullYear(),he.getMonth(),1);return Ur(ee,"yyyy-MM-dd")}),[r,n]=g.useState(T4e()),[a,s]=g.useState(!0),[o,l]=g.useState([]),[c,u]=g.useState([]),[d,f]=g.useState([]),[A,h]=g.useState(!1),[m,p]=g.useState(null),[x,v]=g.useState(0),[y,b]=g.useState(0),[w,j]=g.useState(0),[I,C]=g.useState(0),[S,E]=g.useState({}),[B,k]=g.useState({}),{refreshKey:T,refresh:P}=Mc(),[K,le]=g.useState({}),[oe,ie]=g.useState({}),[Ae,te]=g.useState(!1),Te=()=>te(he=>!he),[Ue,O]=g.useState(!1),H=()=>O(he=>!he),[G,L]=g.useState(!1),[W,X]=g.useState(!1),[D,Q]=g.useState(!1),[Z,be]=g.useState(!1),[U,ze]=g.useState(!1),[re,J]=g.useState(!1),Re=()=>L(he=>!he),ke=()=>X(he=>!he),Be=()=>Q(he=>!he),Ye=()=>be(he=>!he),ot=()=>ze(he=>!he),Ct=()=>J(he=>!he),[jt,Ot]=g.useState("");g.useEffect(()=>{(async()=>{s(!0);const ee=sr(bt(je,"salesV2"),Ar("date",">=",t),Ar("date","<=",r)),_e=await Ht(ee),R=[];_e.forEach(Ne=>{const Me=Ne.data(),Ke=Me.date??"";if(Array.isArray(Me.items)&&Me.items.length>0){Me.items.forEach((Pe,rt)=>{const lt=String(Pe.productName??"(sin nombre)"),ht=Number(Pe.qty??0),kt=Number(Pe.lineFinal??0)||Math.max(0,Number(Pe.unitPrice||0)*ht-Number(Pe.discount||0));R.push({id:`${Ne.id}#${rt}`,date:Ke,productName:lt,quantity:ht,amount:kt,allocations:Array.isArray(Pe.allocations)?Pe.allocations:Me.allocations,avgUnitCost:Number(Pe.avgUnitCost??Me.avgUnitCost??0),measurement:Pe.measurement??Me.measurement??"",type:Me.type??"CONTADO"})});return}R.push({id:Ne.id,date:Ke,productName:Me.productName??"(sin nombre)",quantity:Number(Me.quantity??0),amount:Number(Me.amount??Me.amountCharged??0),allocations:Array.isArray(Me.allocations)?Me.allocations:[],avgUnitCost:Number(Me.avgUnitCost??0),measurement:Me.measurement??"",type:Me.type??"CONTADO"})}),l(R);const V=sr(bt(je,"expenses"),Ar("date",">=",t),Ar("date","<=",r)),q=await Ht(V),se=[];q.forEach(Ne=>{const Me=Ne.data();se.push({id:Ne.id,date:Me.date??"",category:Me.category??"(sin categora)",description:Me.description??"",amount:Number(Me.amount??0),status:Me.status??"PAGADO",createdAt:Me.createdAt})}),u(se),s(!1)})()},[t,r,T]),g.useMemo(()=>{const he=o.reduce((q,se)=>q+(se.amount||0),0);let ee=0;o.forEach(q=>{var se;(se=q.allocations)!=null&&se.length?ee+=q.allocations.reduce((Ne,Me)=>Ne+Number(Me.lineCost||0),0):q.avgUnitCost&&q.quantity&&(ee+=Number(q.avgUnitCost)*Number(q.quantity))});const _e=he-ee,R=c.reduce((q,se)=>q+(se.amount||0),0),V=_e-R;return{revenue:he,cogsReal:ee,grossProfit:_e,expensesSum:R,netProfit:V}},[o,c]);const Tt=g.useMemo(()=>jt?o.filter(he=>(he.productName||"")===jt):o,[o,jt]),Qt=g.useMemo(()=>{const he=Tt.reduce((q,se)=>q+(se.amount||0),0);let ee=0;Tt.forEach(q=>{var se;(se=q.allocations)!=null&&se.length?ee+=q.allocations.reduce((Ne,Me)=>Ne+Number(Me.lineCost||0),0):q.avgUnitCost&&q.quantity&&(ee+=Number(q.avgUnitCost)*Number(q.quantity))});const _e=he-ee,R=c.reduce((q,se)=>q+(se.amount||0),0),V=_e-R;return{revenue:he,cogsReal:ee,grossProfit:_e,expensesSum:R,netProfit:V}},[Tt,c]),Ft=g.useMemo(()=>{const he=Tt.filter(se=>se.type==="CONTADO"),ee=he.reduce((se,Ne)=>se+(Ne.amount||0),0);let _e=0;he.forEach(se=>{var Ne;(Ne=se.allocations)!=null&&Ne.length?_e+=se.allocations.reduce((Me,Ke)=>Me+Number(Ke.lineCost||0),0):se.avgUnitCost&&se.quantity&&(_e+=Number(se.avgUnitCost)*Number(se.quantity))});const R=ee-_e,V=c.reduce((se,Ne)=>se+(Ne.amount||0),0),q=R-V;return{revenue:ee,cogsReal:_e,grossProfit:R,expensesSum:V,netProfit:q}},[Tt,c]),Qe=g.useMemo(()=>{const he=Tt.filter(V=>V.type==="CREDITO"),ee=he.reduce((V,q)=>V+(q.amount||0),0);let _e=0;he.forEach(V=>{var q;(q=V.allocations)!=null&&q.length?_e+=V.allocations.reduce((se,Ne)=>se+Number(Ne.lineCost||0),0):V.avgUnitCost&&V.quantity&&(_e+=Number(V.avgUnitCost)*Number(V.quantity))});const R=ee-_e;return{revenue:ee,cogsReal:_e,grossProfit:R}},[Tt]),De=he=>String(he??"").toLowerCase().trim(),Je=he=>Number(he.qty??he.quantity??0),dt=he=>["lb","lbs","libra","libras"].includes(De(he)),ce=he=>["unidad","unidades","ud","uds","pieza","piezas"].includes(De(he)),we=he=>he?typeof he=="string"?he:he!=null&&he.toDate?Ur(he.toDate(),"yyyy-MM-dd"):"":"";g.useEffect(()=>{(async()=>{h(!0);try{const ee=await Ht(bt(je,"customers_pollo")),_e={};ee.forEach(Se=>{const gt=Se.data();_e[Se.id]=String(gt.name??"(sin nombre)")});const R=await Ht(bt(je,"ar_movements_pollo")),V={},q={},se={},Ne={},Me={},Ke=new Set,Pe={},rt={},lt={},ht={};let kt=0,de=0;const qe=Se=>{var gt;return Se!=null&&Se.date?String(Se.date):(gt=Se==null?void 0:Se.createdAt)!=null&&gt.toDate?Ur(Se.createdAt.toDate(),"yyyy-MM-dd"):""};R.forEach(Se=>{var Xr,Ir,Pr;const gt=Se.data(),er=String(gt.customerId??"").trim();if(!er)return;const Mr=Number(gt.amount??0);V[er]=(V[er]||0)+Mr;const Or=String(gt.type??"").toUpperCase(),ir=String(gt.debtStatus??gt.creditStatus??gt.cycleStatus??gt.status??"").toUpperCase().trim(),br=["PAGADA","PAGADO","CERRADA","CERRADO","LIQUIDADA","LIQUIDADO"].includes(ir),wr=gt.createdAt??null;if(Or==="ABONO"){kt+=Math.abs(Mr);const fn=qe(gt);fn&&fn>=t&&fn<=r&&(de+=Math.abs(Mr));const fe=(Xr=gt==null?void 0:gt.ref)!=null&&Xr.saleId?String(gt.ref.saleId):"";fe?(Pe[fe]=(Pe[fe]||0)+Math.abs(Mr),fn&&fn>=t&&fn<=r&&(lt[fe]=(lt[fe]||0)+Math.abs(Mr)),Ke.add(fe)):(rt[er]=(rt[er]||0)+Math.abs(Mr),fn&&fn>=t&&fn<=r&&(ht[er]=(ht[er]||0)+Math.abs(Mr)));const et=se[er],nt=!(et!=null&&et.ts)||(wr!=null&&wr.toDate&&((Ir=et.ts)!=null&&Ir.toDate)?wr.toDate()>et.ts.toDate():!1);(!et||nt)&&(se[er]={amount:Math.abs(Mr),date:gt.date??"",ts:wr})}if(Or==="CARGO"){const fn=(Pr=gt==null?void 0:gt.ref)!=null&&Pr.saleId?String(gt.ref.saleId):"";fn&&(Ne[er]||(Ne[er]=new Set),Ne[er].add(fn),br||(Me[er]||(Me[er]=new Set),Me[er].add(fn)),Ke.add(fn)),br||(q[er]=(q[er]||0)+Math.abs(Mr))}});const at=new Map;await Promise.all(Array.from(Ke).map(async Se=>{const gt=await Cs(Xt(je,"salesV2",Se));gt.exists()&&at.set(Se,gt.data())}));let st=0,Nt=0;const Rt=Se=>{const gt=Number(Se.qty??Se.quantity??0);return Number(Se.lineFinal??0)||Math.max(0,Number(Se.unitPrice||0)*gt-Number(Se.discount||0))},nr=Se=>{if(Array.isArray(Se.items)&&Se.items.length>0){let Or=0,ir=0;return Se.items.forEach(br=>{const wr=Number(br.qty??br.quantity??0);if(Or+=Rt(br),Array.isArray(br.allocations)&&br.allocations.length>0)ir+=br.allocations.reduce((Xr,Ir)=>Xr+Number(Ir.lineCost||0),0);else{const Xr=Number(br.avgUnitCost??Se.avgUnitCost??0);ir+=Xr*wr}}),{total:Or,cogs:ir}}const gt=Number(Se.quantity??0),er=Number(Se.amount??Se.amountCharged??0)||0;let Mr=0;return Array.isArray(Se.allocations)&&Se.allocations.length>0?Mr=Se.allocations.reduce((Or,ir)=>Or+Number(ir.lineCost||0),0):Se.avgUnitCost&&(Mr=Number(Se.avgUnitCost)*gt),{total:er,cogs:Mr}},_r=new Map;at.forEach((Se,gt)=>{const{total:er,cogs:Mr}=nr(Se);_r.set(gt,{total:er,cogs:Mr,grossProfit:er-Mr})});const $r={},or={},kr={},en={};Object.keys(Pe).forEach(Se=>{const gt=_r.get(Se);if(!(gt!=null&&gt.total))return;const er=Number(Pe[Se]||0);or[Se]=er;const Mr=Math.min(1,er/gt.total),Or=gt.grossProfit*Mr;$r[Se]=Or,st+=Or}),Object.keys(lt).forEach(Se=>{const gt=_r.get(Se);if(!(gt!=null&&gt.total))return;const er=Number(lt[Se]||0);en[Se]=er;const Mr=Math.min(1,er/gt.total),Or=gt.grossProfit*Mr;kr[Se]=Or,Nt+=Or}),Object.keys(rt).forEach(Se=>{const gt=Ne[Se];if(!gt||gt.size===0)return;let er=0,Mr=0,Or=0,ir=0;gt.forEach(Pr=>{const fn=_r.get(Pr);fn&&(er+=fn.total,Mr+=fn.grossProfit,or[Pr]&&(Or+=Math.min(fn.total,or[Pr])),ir+=$r[Pr]||0)});const br=Math.max(0,er-Or),wr=Math.max(0,Mr-ir);if(!br||!wr)return;const Xr=Number(rt[Se]||0),Ir=Math.min(1,Xr/br);st+=wr*Ir}),Object.keys(ht).forEach(Se=>{const gt=Ne[Se];if(!gt||gt.size===0)return;let er=0,Mr=0,Or=0,ir=0;gt.forEach(Pr=>{const fn=_r.get(Pr);fn&&(er+=fn.total,Mr+=fn.grossProfit,en[Pr]&&(Or+=Math.min(fn.total,en[Pr])),ir+=kr[Pr]||0)});const br=Math.max(0,er-Or),wr=Math.max(0,Mr-ir);if(!br||!wr)return;const Xr=Number(ht[Se]||0),Ir=Math.min(1,Xr/br);Nt+=wr*Ir});const rn=[];Object.keys(V).forEach(Se=>{const gt=Number(V[Se]||0);if(gt<=0)return;const er=new Map;let Mr=0,Or=0,ir="";(Me[Se]||new Set).forEach(Ir=>{const Pr=at.get(Ir);if(!Pr)return;const fn=String(Pr.date??"");fn&&(!ir||fn>ir)&&(ir=fn),(Array.isArray(Pr.items)&&Pr.items.length>0?Pr.items:[{productName:Pr.productName,qty:Pr.quantity,unitPrice:Pr.unitPrice,discount:Pr.discount,lineFinal:Pr.amount??Pr.amountCharged,measurement:Pr.measurement}]).forEach(et=>{const nt=String(et.productName??"(sin nombre)"),ct=Number(et.qty??et.quantity??0),ve=String(et.measurement??""),ft=Number(et.lineFinal??0)||Math.max(0,Number(et.unitPrice||0)*ct-Number(et.discount||0));dt(ve)?Mr+=ct:Or+=ct;const St=`${nt}||${ve}`,wt=er.get(St)||{productName:nt,qty:0,amount:0,measurement:ve};wt.qty+=ct,wt.amount+=ft,er.set(St,wt)})});const wr=se[Se],Xr=Number(q[Se]||0);rn.push({customerId:Se,name:_e[Se]||"(sin nombre)",balance:gt,globalBalance:Xr>0?Xr:gt,lbs:Mr,units:Or,lastPaymentAmount:Number((wr==null?void 0:wr.amount)||0),lastSaleDate:ir||"",lastPaymentDate:we((wr==null?void 0:wr.ts)||(wr==null?void 0:wr.date)),products:Array.from(er.values()).sort((Ir,Pr)=>Ir.productName.localeCompare(Pr.productName))})});const Er=rn.filter(Se=>Se.products.length);Er.sort((Se,gt)=>gt.balance-Se.balance),f(Er),v(kt),b(de),j(st),C(Nt)}catch(ee){console.error("Error cargando saldos pendientes:",ee),f([]),v(0),b(0),C(0)}finally{h(!1)}})()},[T,t,r]),g.useEffect(()=>{(async()=>{try{const ee=await Ht(sr(bt(je,"inventory_batches"))),_e=wS(t,"yyyy-MM-dd",new Date),R=wS(r,"yyyy-MM-dd",new Date),V=Ur(Qd(_e),"yyyy-MM-dd"),q=Ur(Ud(R),"yyyy-MM-dd"),se={};ee.forEach(Ne=>{var kt;const Me=Ne.data(),Ke=String(Me.productName??"(sin nombre)"),Pe=Number(Me.quantity??0),rt=Number(Me.remaining??0),lt=(kt=Me==null?void 0:Me.date)!=null&&kt.toDate?Ur(Me.date.toDate(),"yyyy-MM-dd"):String((Me==null?void 0:Me.date)??(Me==null?void 0:Me.createdAt)??""),ht=lt&&lt>=V&&lt<=q;se[Ke]||(se[Ke]={incomingQty:0,remainingQty:0}),ht&&(se[Ke].incomingQty+=Pe),se[Ke].remainingQty+=rt}),E(se)}catch(ee){console.error("Error cargando inventario:",ee),E({})}})()},[T,t,r]),g.useMemo(()=>o.reduce((he,ee)=>dt(ee.measurement)?he+Je(ee):he,0),[o]),g.useMemo(()=>Tt.reduce((he,ee)=>dt(ee.measurement)?he+Je(ee):he,0),[Tt]);const ue=g.useMemo(()=>Tt.filter(he=>he.type==="CONTADO"),[Tt]),ne=g.useMemo(()=>Tt.filter(he=>he.type==="CREDITO"),[Tt]),Ve=g.useMemo(()=>ue.reduce((he,ee)=>he+(ee.amount||0),0),[ue]),it=g.useMemo(()=>ne.reduce((he,ee)=>he+(ee.amount||0),0),[ne]),vt=g.useMemo(()=>d.reduce((he,ee)=>he+Number(ee.balance||0),0),[d]),me=g.useMemo(()=>Ft.revenue,[Ft.revenue]),Ee=g.useMemo(()=>Ve,[Ve]),ye=g.useMemo(()=>Ve+y,[Ve,y]),We=g.useMemo(()=>Ft.grossProfit+I,[Ft.grossProfit,I]),ge=g.useMemo(()=>Ft.netProfit+I,[Ft.netProfit,I]),Ie=g.useMemo(()=>ue.reduce((he,ee)=>dt(ee.measurement)?he+Je(ee):he,0),[ue]),xt=g.useMemo(()=>ne.reduce((he,ee)=>dt(ee.measurement)?he+Je(ee):he,0),[ne]);g.useMemo(()=>o.reduce((he,ee)=>ce(ee.measurement)?he+Je(ee):he,0),[o]),g.useMemo(()=>Tt.reduce((he,ee)=>ce(ee.measurement)?he+Je(ee):he,0),[Tt]);const Pt=g.useMemo(()=>ue.reduce((he,ee)=>ce(ee.measurement)?he+Je(ee):he,0),[ue]),It=g.useMemo(()=>ne.reduce((he,ee)=>ce(ee.measurement)?he+Je(ee):he,0),[ne]),Ut=g.useMemo(()=>Array.from(new Set(o.map(he=>he.productName||"(sin nombre)"))).sort(),[o]),$t=g.useMemo(()=>{var ee;const he=new Map;for(const _e of Tt){const R=_e.productName||"(sin nombre)";he.has(R)||he.set(R,{productName:R,units:0,revenue:0,cogs:0,profit:0,firstDate:_e.date||"",lastDate:_e.date||""});const V=he.get(R);V.units+=Number(_e.quantity||0),V.revenue+=Number(_e.amount||0),(!V.firstDate||_e.date<(V.firstDate||_e.date))&&(V.firstDate=_e.date),(!V.lastDate||_e.date>(V.lastDate||_e.date))&&(V.lastDate=_e.date);let q=0;(ee=_e.allocations)!=null&&ee.length?q=_e.allocations.reduce((se,Ne)=>se+Number(Ne.lineCost||0),0):_e.avgUnitCost&&(q=Number(_e.avgUnitCost)*Number(_e.quantity||0)),V.cogs+=q,V.profit=V.revenue-V.cogs}return Array.from(he.values()).sort((_e,R)=>_e.productName.localeCompare(R.productName))},[Tt]),Le=g.useMemo(()=>[...$t].sort((he,ee)=>ee.units-he.units).slice(0,3).map((he,ee)=>({idx:ee+1,name:he.productName,units:he.units})),[$t]),Ce=he=>le(ee=>({...ee,[he]:!ee[he]})),pe=he=>ie(ee=>({...ee,[he]:!ee[he]})),He=()=>{const he=new an({unit:"pt",format:"a4"}),ee="Dashboard Financiero",_e=`Rango: ${t} a ${r}`,R=jt?`Producto: ${jt}`:"Producto: Todos";he.setFontSize(16),he.text(ee,40,40),he.setFontSize(10),he.text(_e,40,58),he.text(R,40,72);let V=90;const q=()=>{var Ne;V=(Ne=he.lastAutoTable)!=null&&Ne.finalY?he.lastAutoTable.finalY+18:V+18},se=(Ne,Me)=>{Me.length&&(he.setFontSize(11),he.text(Ne,40,V),V+=12,V0(he,{startY:V,head:[["KPI","Valor"]],body:Me,styles:{fontSize:9},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),q())};se("KPIs Generales",[["Ventas (rango)",Zr(Qt.revenue)],["Costo",Zr(Qt.cogsReal)],["Utilidad Bruta",Zr(Qt.grossProfit)],["Gastos",Zr(Qt.expensesSum)],["Utilidad Neta",Zr(Qt.netProfit)]]),se("KPIs Cash",[["Ventas Cash",Zr(me)],["Costo Cash",Zr(Ft.cogsReal)],["Utilidad Bruta Cash",Zr(Ft.grossProfit)]]),se("KPIs Crdito",[["Ventas Crdito",Zr(Qe.revenue)],["Costo Crdito",Zr(Qe.cogsReal)],["Utilidad Bruta Crdito",Zr(Qe.grossProfit)]]),se("Fondos y Utilidades",[["CxC",Zr(vt)],["Recaudacin (Abonos)",Zr(x)],["Recaudacin a la fecha",Zr(y)],["Recolectado Cash + Abonos",Zr(ye)],["Utilidad Neta Crdito (Caja)",Zr(I)],["Utilidad Bruta Cash + Crdito",Zr(We)],["Gastos",Zr(Ft.expensesSum)],["Utilidad Neta Cash + Crdito",Zr(ge)]]),se("KPIs de Volumen y Ventas",[["Ventas Cash",Zr(Ee)],["Ventas Crdito",Zr(it)],["Libras Cash",oa(Ie)],["Libras Crdito",oa(xt)],["Libras Cash + Crdito",oa(Ie+xt)],["Unidades Cash",oa(Pt)],["Unidades Crdito",oa(It)],["Unidades Cash + Crdito",oa(Pt+It)]]),Le.length>0&&(he.setFontSize(11),he.text("Top productos por unidades",40,V),V+=12,V0(he,{startY:V,head:[["#","Producto","Cantidad"]],body:Le.map(Ne=>[String(Ne.idx),Ne.name,oa(Ne.units)]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),q()),V0(he,{startY:V,head:[["Cliente","Libras","Unidades","Saldo Global","ltimo abono","Saldo pendiente","Fecha ult. abono"]],body:d.map(Ne=>[Ne.name,oa(Ne.lbs),oa(Ne.units),Zr(Ne.globalBalance),Zr(Ne.lastPaymentAmount),Zr(Ne.balance),Ne.lastPaymentDate||""]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]},didDrawPage:Ne=>{Ne.pageNumber>1&&(he.setFontSize(10),he.text(ee,40,30))}}),q(),V0(he,{startY:V,head:[["Producto","Ingresado","Disponibilidad","Fechas","Cantidad","Venta","Costo","Utilidad"]],body:$t.map(Ne=>{var Me,Ke;return[Ne.productName,oa(((Me=S[Ne.productName])==null?void 0:Me.incomingQty)||0),oa(((Ke=S[Ne.productName])==null?void 0:Ke.remainingQty)||0),Ne.firstDate&&Ne.lastDate?Ne.firstDate===Ne.lastDate?Ne.firstDate:`${Ne.firstDate}  ${Ne.lastDate}`:"",oa(Ne.units),Zr(Ne.revenue),Zr(Ne.cogs),Zr(Ne.profit)]}),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),q(),V0(he,{startY:V,head:[["Fecha","Categora","Descripcin","Monto","Estado"]],body:c.map(Ne=>[Ne.date,Ne.category,Ne.description||"",Zr(Ne.amount),Ne.status||""]),styles:{fontSize:8},headStyles:{fillColor:[245,245,245],textColor:[0,0,0]}}),he.save(`dashboard_${t}_a_${r}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-4 sm:p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[i.jsx("h2",{className:"text-xl sm:text-2xl font-bold",children:"Dashboard Financiero"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",onClick:He,className:"px-3 py-2 rounded-lg text-sm bg-gray-900 text-white hover:bg-black",children:"Exportar PDF"}),i.jsx(Rc,{onClick:P,loading:a})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:t,onChange:he=>e(he.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:r,onChange:he=>n(he.target.value)})]})]}),a?i.jsx("p",{children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:Re,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Kpi Financiero"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Ventas: ",i.jsx("b",{children:Zr(Qt.revenue)}),"  Utilidad Neta:"," ",i.jsx("b",{children:Zr(Qt.netProfit)})]})]}),i.jsx("div",{className:"text-gray-500",children:G?"Cerrar":"Ver"})]}),G&&i.jsxs("div",{className:"mt-3",children:[i.jsx("div",{className:"flex gap-2 mb-2 items-center",children:i.jsxs("select",{className:"w-full border rounded px-2 py-2 text-sm",value:jt,onChange:he=>Ot(he.target.value),children:[i.jsx("option",{value:"",children:"Todos los productos"}),Ut.map(he=>i.jsx("option",{value:he,children:he},he))]})}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:Ye,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Ventas cash - Credito"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Resumen"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:Z?"Cerrar":"Ver"})]}),Z&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsx(ss,{title:"Ventas",subtitle:"Ventas cash",value:Zr(me),valueClass:"text-[#1E4D2B]"}),i.jsx(ss,{title:"Costo",value:Zr(Ft.cogsReal)}),i.jsx(ss,{title:"Utilidad Bruta Cash",value:Zr(Ft.grossProfit),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsx(ss,{title:"Ventas Crdito",value:Zr(Qe.revenue)}),i.jsx(ss,{title:"Costo",value:Zr(Qe.cogsReal),negative:!0}),i.jsx(ss,{title:"Utilidad Bruta Crdito",value:Zr(Qe.grossProfit),positive:!0})]})]})]}),i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:ot,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Fondos"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Liquidez"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:U?"Cerrar":"Ver"})]}),U&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[i.jsx(ss,{title:"CxC",value:Zr(vt)}),i.jsx(ss,{title:"Recaudacin Global(Abonos)",value:Zr(x)}),i.jsx(ss,{title:"Recaudacin a la fecha",value:Zr(y)}),i.jsx(ss,{title:"Recolectado Cash + Abonos",value:Zr(ye),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsx(ss,{title:"Utilidad Neta Crdito (Caja)",value:Zr(I),valueClass:"text-[#BF5700]"}),i.jsx(ss,{title:"Utilidad Bruta Cash + Crdito",value:Zr(We),positive:!0})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsx(ss,{title:"Gastos",value:Zr(Ft.expensesSum),negative:!0}),i.jsx(ss,{title:"Utilidad Neta Cash + Crdito",value:Zr(ge),positive:!0})]})]})]}),i.jsxs("div",{className:"rounded-3xl bg-white shadow-xl border border-gray-100 p-3 sm:p-4 space-y-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left",onClick:Ct,children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-sm text-gray-800",children:"Detalles"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Mtricas adicionales"})]}),i.jsx("span",{className:"text-xs text-gray-500",children:re?"Cerrar":"Ver"})]}),re&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(Kl,{title:"Ventas Cash",value:Zr(Ee)}),i.jsx(Kl,{title:"Ventas Crdito",value:Zr(it)}),i.jsx(Kl,{title:"Libras Cash",value:oa(Ie)}),i.jsx(Kl,{title:"Libras Crdito",value:oa(xt)}),i.jsx(Kl,{title:"Unidades Cash",value:oa(Pt)}),i.jsx(Kl,{title:"Unidades Crdito",value:oa(It)})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 rounded-lg shadow-2xl p-3 sm:p-4 bg-gray-50",children:[i.jsx(Kl,{title:"Libras Cash + Credito",value:oa(Ie+xt)}),i.jsx(Kl,{title:"Unidades Cash + Credito",value:oa(Pt+It)}),i.jsx(lH,{title:"Productos ms vendidos",items:Le.map(he=>({key:`${he.idx}`,label:`${he.idx}. ${he.name}`,value:`(${oa(he.units)})`}))})]})]})]})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ss,{title:"Ventas Cash",value:Zr(me),positive:!0}),i.jsx(ss,{title:"Costo",value:Zr(Ft.cogsReal),negative:!0}),i.jsx(ss,{title:"Utilidad Bruta Cash",value:Zr(Ft.grossProfit),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ss,{title:"Ventas Crdito",value:Zr(Qe.revenue),positive:!0}),i.jsx(ss,{title:"Costo",value:Zr(Qe.cogsReal),negative:!0}),i.jsx(ss,{title:"Utilidad Bruta Crdito",value:Zr(Qe.grossProfit),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-3 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ss,{title:"CxC",value:Zr(vt),negative:!0}),i.jsx(ss,{title:"Recaudacin Global(Abonos)",value:Zr(x),positive:!0}),i.jsx(ss,{title:"Recaudacin a la fecha",value:Zr(y),positive:!0}),i.jsx(ss,{title:"Recolectado Cash + Abonos",value:Zr(ye),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-4 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(ss,{title:"Utilidad Neta Crdito (Caja)",value:Zr(I),valueClass:"text-[#BF5700]"}),i.jsx(ss,{title:"Utilidad Bruta Cash + Crdito",value:Zr(We),positive:!0}),i.jsx(ss,{title:"Gastos",value:Zr(Ft.expensesSum),negative:!0}),i.jsx(ss,{title:"Utilidad Neta Cash + Crdito",value:Zr(ge),positive:!0})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[i.jsx(Kl,{title:"Ventas Cash",value:Zr(Ee)}),i.jsx(Kl,{title:"Ventas Crdito",value:Zr(it)}),i.jsx(Kl,{title:"Libras Cash",value:oa(Ie)}),i.jsx(Kl,{title:"Libras Crdito",value:oa(xt)}),i.jsx(Kl,{title:"Unidades Cash",value:oa(Pt)}),i.jsx(Kl,{title:"Unidades Crdito",value:oa(It)})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6 rounded-lg shadow-2xl p-3 sm:p-4 bg-gray-50",children:[i.jsx(Kl,{title:"Libras Cash + Credito",value:oa(Ie+xt)}),i.jsx(Kl,{title:"Unidades Cash + Credito",value:oa(Pt+It)}),i.jsx(lH,{title:"Productos ms vendidos",items:Le.map(he=>({key:`${he.idx}`,label:`${he.idx}. ${he.name}`,value:`(${oa(he.units)})`}))})]})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:ke,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsx("div",{className:"font-semibold",children:"Saldos pendientes"}),i.jsx("div",{className:"text-gray-500",children:W?"Cerrar":"Ver"})]}),W&&i.jsx("div",{className:"border rounded-2xl p-3 sm:p-4 bg-gray-50 mt-3",children:A?i.jsx("div",{className:"text-sm text-gray-600",children:"Cargando saldos"}):d.length===0?i.jsx("div",{className:"text-sm text-gray-600",children:"Sin saldos pendientes."}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-white",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Libras"}),i.jsx("th",{className:"border p-2",children:"Unidades"}),i.jsx("th",{className:"border p-2",children:"Saldo Global"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"}),i.jsx("th",{className:"border p-2",children:"Saldo pendiente"}),i.jsx("th",{className:"border p-2",children:"Fecha ult. abono"}),i.jsx("th",{className:"border p-2",children:"Ver"})]})}),i.jsx("tbody",{children:d.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1 text-left",children:he.name}),i.jsx("td",{className:"border p-1",children:oa(he.lbs)}),i.jsx("td",{className:"border p-1",children:oa(he.units)}),i.jsx("td",{className:"border p-1",children:Zr(he.globalBalance)}),i.jsx("td",{className:"border p-1",children:Zr(he.lastPaymentAmount)}),i.jsx("td",{className:"border p-1",children:Zr(he.balance)}),i.jsx("td",{className:"border p-1",children:he.lastPaymentDate||""}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",onClick:()=>p(he),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},he.customerId))})]})})})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{type:"button",onClick:Be,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsx("div",{className:"font-semibold",children:"Ventas y Gastos"}),i.jsx("div",{className:"text-gray-500",children:D?"Cerrar":"Ver"})]}),D&&i.jsxs("div",{className:"mt-3",children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Ventas"}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-6",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Ingresado Lb/Un"}),i.jsx("th",{className:"border p-2",children:"Disponibilidad"}),i.jsx("th",{className:"border p-2",children:"Fecha Venta"}),i.jsx("th",{className:"border p-2",children:"Cantidad Lb/Un"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Costo"}),i.jsx("th",{className:"border p-2",children:"Utilidad"})]})}),i.jsxs("tbody",{children:[$t.map(he=>{var ee,_e;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:he.productName}),i.jsx("td",{className:"border p-1",children:oa(((ee=S[he.productName])==null?void 0:ee.incomingQty)||0)}),i.jsx("td",{className:"border p-1",children:oa(((_e=S[he.productName])==null?void 0:_e.remainingQty)||0)}),i.jsx("td",{className:"border p-1",children:he.firstDate&&he.lastDate?he.firstDate===he.lastDate?he.firstDate:`${he.firstDate}  ${he.lastDate}`:""}),i.jsx("td",{className:"border p-1",children:oa(he.units)}),i.jsx("td",{className:"border p-1",children:Zr(he.revenue)}),i.jsx("td",{className:"border p-1",children:Zr(he.cogs)}),i.jsx("td",{className:`border p-1 ${he.profit>=0?"text-green-700":"text-red-700"}`,children:Zr(he.profit)})]},he.productName)}),$t.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin datos en el rango seleccionado."})})]})]})}),i.jsxs("div",{className:"md:hidden mb-6",children:[i.jsxs("button",{type:"button",onClick:Te,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Ventas por producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[$t.length," productos"]})]}),i.jsx("div",{className:"text-gray-500",children:Ae?"Cerrar":"Ver"})]}),Ae&&i.jsx("div",{className:"space-y-2 mt-3",children:$t.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-sm text-gray-500 bg-gray-50",children:"Sin datos en el rango seleccionado."}):$t.map(he=>{var R,V,q,se;const ee=!!K[he.productName],_e=he.firstDate&&he.lastDate?he.firstDate===he.lastDate?he.firstDate:`${he.firstDate}  ${he.lastDate}`:"";return i.jsxs("div",{className:"border rounded-2xl bg-white shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>Ce(he.productName),className:"w-full text-left px-3 py-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:he.productName}),i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Libras/Unidades"}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Vendidas: ",i.jsx("b",{children:oa(he.units)}),"  Disponible:"," ",i.jsx("b",{className:((R=S[he.productName])==null?void 0:R.remainingQty)>0?"text-green-700":"text-red-700",children:oa(((V=S[he.productName])==null?void 0:V.remainingQty)||0)})]})]}),i.jsx("div",{className:"text-gray-500 text-xs pt-0.10",children:ee?"Cerrar":"Ver"})]}),ee&&i.jsx("div",{className:"px-3 pb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx(nd,{label:"Lb/Un Ingresadas",value:oa(((q=S[he.productName])==null?void 0:q.incomingQty)||0)}),i.jsx(nd,{label:"Lb/Un Disponibles",value:oa(((se=S[he.productName])==null?void 0:se.remainingQty)||0)}),i.jsx(nd,{label:"Fechas Venta",value:_e}),i.jsx(nd,{label:"Lb/Un Vendidas",value:oa(he.units)}),i.jsx(nd,{label:"Facturado al costo",value:Zr(he.cogs)}),i.jsx(nd,{label:"Monto Venta",value:Zr(he.revenue)}),i.jsx(nd,{label:"Utilidad bruta",value:Zr(he.profit),valueClass:he.profit>=0?"text-green-700 font-semibold":"text-red-700 font-semibold"})]})})]},he.productName)})})]}),i.jsx("h3",{className:"font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Categora"}),i.jsx("th",{className:"border p-2",children:"Descripcin"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Estado"})]})}),i.jsxs("tbody",{children:[c.map(he=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:he.date}),i.jsx("td",{className:"border p-1",children:he.category}),i.jsx("td",{className:"border p-1",children:he.description}),i.jsx("td",{className:"border p-1",children:Zr(he.amount)}),i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${he.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:he.status})})]},he.id)),c.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-3 text-center text-gray-500",children:"Sin gastos en el rango seleccionado."})})]})]})}),i.jsxs("div",{className:"md:hidden mb-6",children:[i.jsxs("button",{type:"button",onClick:H,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Gastos del periodo"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[c.length," registros"]})]}),i.jsx("div",{className:"text-gray-500",children:Ue?"Cerrar":"Abrir"})]}),Ue&&i.jsx("div",{className:"space-y-2 mt-3",children:c.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-sm text-gray-500 bg-gray-50",children:"Sin gastos en el rango seleccionado."}):c.map(he=>{const ee=!!oe[he.id],_e=he.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700";return i.jsxs("div",{className:"border rounded-2xl bg-white shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>pe(he.id),className:"w-full text-left px-3 py-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:he.category}),i.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] ${_e}`,children:he.status})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[he.date,"  ",i.jsx("b",{children:Zr(he.amount)})]})]}),i.jsx("div",{className:"text-gray-500 text-sm pt-0.5",children:ee?"Cerrar":"Ver"})]}),ee&&i.jsx("div",{className:"px-3 pb-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[i.jsx(nd,{label:"Fecha",value:he.date}),i.jsx(nd,{label:"Categora",value:he.category}),i.jsx(nd,{label:"Descripcin",value:he.description||""}),i.jsx(nd,{label:"Monto",value:Zr(he.amount)}),i.jsx(nd,{label:"Estado",value:he.status||""})]})})]},he.id)})})]})]})]})]}),m&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:m.name}),i.jsx("button",{type:"button",onClick:()=>p(null),className:"text-sm text-gray-500 hover:text-gray-700",children:""})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Libras/Unidades"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Fecha Venta"})]})}),i.jsx("tbody",{children:m.products.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"border p-2 text-center text-gray-500",children:"Sin productos asociados."})}):m.products.map(he=>i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1",children:he.productName}),i.jsx("td",{className:"border p-1 text-center",children:oa(he.qty)}),i.jsx("td",{className:"border p-1 text-center",children:Zr(he.amount)}),i.jsx("td",{className:"border p-1 text-center",children:m.lastSaleDate||""})]},`${he.productName}-${he.measurement}`))})]})})]})})]})}function ss({title:t,value:e,positive:r,negative:n,valueClass:a,subtitle:s}){const o=a||(r?"text-[#568203]":n?"text-[#AB274F]":"");return i.jsxs("div",{className:"border rounded-2xl p-3 bg-white",children:[i.jsx("div",{className:"text-[13px] sm:text-[17px] text-gray-500",children:t}),s?i.jsx("div",{className:"text-[11px] sm:text-[12px] text-gray-400",children:s}):null,i.jsx("div",{className:`text-[26px] sm:text-[30px] font-bold ${o}`,children:e})]})}function Kl({title:t,value:e}){return i.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[i.jsx("div",{className:"text-[13px] sm:text-[17px] text-gray-500",children:t}),i.jsx("div",{className:"text-[18px] sm:text-[20px] font-semibold",children:e})]})}function lH({title:t,items:e}){return i.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[i.jsx("div",{className:"text-[11px] text-gray-500 mb-1",children:t}),i.jsx("ul",{className:"text-sm leading-snug list-none pl-0 m-0 space-y-0.5",children:e.length===0?i.jsx("li",{className:"text-gray-500",children:""}):e.map(r=>i.jsxs("li",{children:[r.label," ",r.value??""]},r.key))})]})}function nd({label:t,value:e,valueClass:r}){return i.jsxs("div",{className:"border rounded-xl p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:t}),i.jsx("div",{className:`text-sm mt-0.5 ${r||""}`,children:e})]})}function k4e({open:t,onClose:e,children:r}){return t?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 max-w-lg w-full relative",children:[i.jsx("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700 text-2xl font-bold",onClick:e,"aria-label":"Cerrar",children:""}),r]})}):null}const S5=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal","Varios"],m0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function F4e(){const{refreshKey:t,refresh:e}=Mc(),[r,n]=g.useState(Ur(Qd(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[o,l]=g.useState(Ur(new Date,"yyyy-MM-dd")),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState(0),[m,p]=g.useState("PENDIENTE"),[x,v]=g.useState(""),[y,b]=g.useState([]),[w,j]=g.useState(!0),[I,C]=g.useState(""),[S,E]=g.useState(null),[B,k]=g.useState(""),[T,P]=g.useState(""),[K,le]=g.useState(""),[oe,ie]=g.useState(0),[Ae,te]=g.useState("PENDIENTE"),[Te,Ue]=g.useState(""),[O,H]=g.useState(!1),G=()=>H(!0),L=()=>H(!1),[W,X]=g.useState(null),D=Be=>X(Ye=>Ye===Be?null:Be);g.useEffect(()=>{(async()=>{j(!0),C("");try{const Be=sr(bt(je,"expenses"),In("date","desc")),Ye=await Ht(Be),ot=[];Ye.forEach(Ct=>{const jt=Ct.data();ot.push({id:Ct.id,date:jt.date||Ur(new Date,"yyyy-MM-dd"),category:jt.category||"",description:jt.description||"",amount:Number(jt.amount||0),status:jt.status||"PENDIENTE",notes:jt.notes||"",createdAt:jt.createdAt??xr.now()})}),b(ot)}catch(Be){console.error(Be),C(" Error al cargar gastos")}finally{j(!1)}})()},[t]);const Q=g.useMemo(()=>y.filter(Be=>!(r&&Be.date<r||a&&Be.date>a)),[y,r,a]),Z=g.useMemo(()=>{const Be=Q.reduce((Ct,jt)=>Ct+(jt.amount||0),0),Ye=Q.filter(Ct=>Ct.status==="PAGADO").reduce((Ct,jt)=>Ct+(jt.amount||0),0),ot=Be-Ye;return{total:Be,pagado:Ye,pendiente:ot}},[Q]),be=()=>{l(Ur(new Date,"yyyy-MM-dd")),u(""),f(""),h(0),p("PENDIENTE"),v("")},U=async Be=>{if(Be.preventDefault(),C(""),!c)return C("Selecciona una categora.");if(!d.trim())return C("Ingresa una descripcin.");if(!A||A<=0)return C("Ingresa un monto vlido.");try{const Ye={date:o,category:c,description:d.trim(),amount:Number(Number(A||0).toFixed(2)),status:m,notes:x||"",createdAt:xr.now()},ot=await Wn(bt(je,"expenses"),Ye);b(Ct=>[{id:ot.id,...Ye},...Ct]),be(),C(" Gasto registrado")}catch(Ye){console.error(Ye),C(" Error al guardar gasto")}},ze=Be=>{C(""),E(Be.id),k(Be.date),P(Be.category||""),le(Be.description||""),ie(Number(Be.amount||0)),te(Be.status||"PENDIENTE"),Ue(Be.notes||"")},re=()=>{E(null),k(""),P(""),le(""),ie(0),te("PENDIENTE"),Ue("")},J=async()=>{if(S){if(!T)return C("Selecciona una categora.");if(!K.trim())return C("Ingresa una descripcin.");if(!oe||oe<=0)return C("Ingresa un monto vlido.");try{const Be={date:B,category:T,description:K.trim(),amount:Number(Number(oe||0).toFixed(2)),status:Ae,notes:Te||""};await kn(Xt(je,"expenses",S),Be),b(Ye=>Ye.map(ot=>ot.id===S?{...ot,...Be}:ot)),re(),C(" Gasto actualizado")}catch(Be){console.error(Be),C(" Error al actualizar gasto")}}},Re=async Be=>{if(confirm(`Eliminar el gasto "${Be.description}"?`))try{await zn(Xt(je,"expenses",Be.id)),b(ot=>ot.filter(Ct=>Ct.id!==Be.id)),C(" Gasto borrado")}catch(ot){console.error(ot),C(" Error al borrar gasto")}},ke=Be=>Be==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700";return i.jsxs("div",{className:"max-w-6xl mx-auto px-3 sm:px-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2 flex-wrap",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Gastos (Pollo)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:G,type:"button",children:"Crear pago"}),i.jsx(Rc,{onClick:e,loading:w})]})]}),i.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-2xl border mb-4 flex flex-col sm:flex-row sm:items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:Be=>n(Be.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:Be=>s(Be.target.value)})]})]}),i.jsxs("div",{className:"sm:ml-auto text-sm bg-gray-50 border rounded-xl p-3",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",m0(Z.total)]}),i.jsxs("div",{children:["Pagado: ",m0(Z.pagado)]}),i.jsxs("div",{children:["Pendiente: ",m0(Z.pendiente)]})]})]}),i.jsxs(k4e,{open:O,onClose:L,children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Crear gasto"}),i.jsxs("form",{onSubmit:Be=>{U(Be),!(!c||!d.trim()||!A||A<=0)&&L()},className:"grid grid-cols-1 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:o,onChange:Be=>l(Be.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:c,onChange:Be=>u(Be.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),S5.map(Be=>i.jsx("option",{value:Be,children:Be},Be))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:d,onChange:Be=>f(Be.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:A===0?"":A,onChange:Be=>{const Ye=String(Be.target.value||"").replace(",","."),ot=parseFloat(Ye);h(Number.isFinite(ot)?Math.max(0,ot):0)},placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:Be=>p(Be.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:x,onChange:Be=>v(Be.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[x.length,"/500"]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"}),i.jsx("button",{type:"button",className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",onClick:()=>{be(),L()},children:"Cancelar"})]})]}),I&&i.jsx("p",{className:"mt-2 text-sm",children:I})]}),i.jsx("div",{className:"block md:hidden space-y-3",children:w?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):Q.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Sin gastos en el rango seleccionado."}):Q.map(Be=>{const Ye=W===Be.id,ot=S===Be.id;return i.jsxs("div",{className:"bg-white border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full text-left px-3 py-3 flex items-start justify-between bg-white",onClick:()=>D(Be.id),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:Be.description}),i.jsxs("div",{className:"text-xs text-gray-500",children:[Be.category||"","  ",Be.date]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"font-bold",children:m0(Be.amount)}),i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ke(Be.status)}`,children:Be.status})]})]}),Ye&&i.jsxs("div",{className:"p-3",children:[i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:Be.notes?Be.notes:""}),ot?i.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2 text-sm",children:[i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:B,onChange:Ct=>k(Ct.target.value)}),i.jsxs("select",{className:"w-full border p-2 rounded",value:T,onChange:Ct=>P(Ct.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),S5.map(Ct=>i.jsx("option",{value:Ct,children:Ct},Ct))]}),i.jsx("input",{className:"w-full border p-2 rounded",value:K,onChange:Ct=>le(Ct.target.value)}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:Number.isNaN(oe)?"":oe,onChange:Ct=>{const jt=String(Ct.target.value||"").replace(",","."),Ot=parseFloat(jt);ie(Number.isFinite(Ot)?Math.max(0,Ot):0)}}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Ae,onChange:Ct=>te(Ct.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Te,onChange:Ct=>Ue(Ct.target.value),maxLength:500}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:J,children:"Guardar"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:re,children:"Cancelar"})]})]}):i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>ze(Be),children:"Editar"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Re(Be),children:"Borrar"})]})]})]},Be.id)})}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded-2xl shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-2 py-1 text-left",children:"Fecha"}),i.jsx("th",{className:"px-2 py-1 text-left",children:"Categora"}),i.jsx("th",{className:"px-2 py-1 text-left",children:"Descripcin"}),i.jsx("th",{className:"px-2 py-1 text-right",children:"Monto"}),i.jsx("th",{className:"px-2 py-1 text-center",children:"Estado"}),i.jsx("th",{className:"px-2 py-1 text-left",children:"Comentario"}),i.jsx("th",{className:"px-2 py-1 text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:w?i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"text-center py-4",children:"Cargando"})}):Q.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"text-center py-4",children:"Sin gastos en el rango seleccionado."})}):Q.map(Be=>{const Ye=S===Be.id;return i.jsx("tr",{className:Ye?"bg-yellow-50":"",children:Ye?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"px-2 py-1",children:i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:B,onChange:ot=>k(ot.target.value)})}),i.jsx("td",{className:"px-2 py-1",children:i.jsxs("select",{className:"w-full border p-1 rounded",value:T,onChange:ot=>P(ot.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),S5.map(ot=>i.jsx("option",{value:ot,children:ot},ot))]})}),i.jsx("td",{className:"px-2 py-1",children:i.jsx("input",{className:"w-full border p-1 rounded",value:K,onChange:ot=>le(ot.target.value)})}),i.jsx("td",{className:"px-2 py-1 text-right",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(oe)?"":oe,onChange:ot=>{const Ct=String(ot.target.value||"").replace(",","."),jt=parseFloat(Ct);ie(Number.isFinite(jt)?Math.max(0,jt):0)}})}),i.jsx("td",{className:"px-2 py-1 text-center",children:i.jsxs("select",{className:"w-full border p-1 rounded",value:Ae,onChange:ot=>te(ot.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})}),i.jsx("td",{className:"px-2 py-1",children:i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:Te,onChange:ot=>Ue(ot.target.value),maxLength:500})}),i.jsxs("td",{className:"px-2 py-1 text-center flex gap-1",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:J,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:re,children:"Cancelar"})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"px-2 py-1",children:Be.date}),i.jsx("td",{className:"px-2 py-1",children:Be.category||""}),i.jsx("td",{className:"px-2 py-1",children:Be.description}),i.jsx("td",{className:"px-2 py-1 text-right",children:m0(Be.amount)}),i.jsx("td",{className:"px-2 py-1 text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ke(Be.status)}`,children:Be.status})}),i.jsx("td",{className:"px-2 py-1",children:Be.notes?Be.notes:""}),i.jsxs("td",{className:"px-2 py-1 text-center flex gap-1",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>ze(Be),children:"Editar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Re(Be),children:"Borrar"})]})]})},Be.id)})})]})}),i.jsxs("div",{className:"mt-6 flex flex-col md:flex-row gap-4 justify-center items-stretch",children:[i.jsxs("div",{className:"flex-1 bg-blue-50 border border-blue-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-blue-700 font-semibold mb-1",children:"Total"}),i.jsx("div",{className:"text-2xl font-bold text-blue-900",children:m0(Z.total)})]}),i.jsxs("div",{className:"flex-1 bg-green-50 border border-green-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-green-700 font-semibold mb-1",children:"Pagado"}),i.jsx("div",{className:"text-2xl font-bold text-green-900",children:m0(Z.pagado)})]}),i.jsxs("div",{className:"flex-1 bg-yellow-50 border border-yellow-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-yellow-700 font-semibold mb-1",children:"Pendiente"}),i.jsx("div",{className:"text-2xl font-bold text-yellow-900",children:m0(Z.pendiente)})]})]}),I&&i.jsx("p",{className:"mt-2 text-sm",children:I})]})}function US(t){return(t||"").trim().toLowerCase()}async function une(){const t=await Ht(bt(je,"products")),e=new Map;return t.forEach(r=>{const n=r.data(),a=US(n.name??n.productName);a&&e.set(a,r.id)}),e}async function O4e(t=!1){const e=await une(),r=await Ht(bt(je,"inventory_batches")),n={checked:0,fixed:0,alreadyOk:0,missingName:0,withoutMatch:0,details:[]};for(const a of r.docs){n.checked++;const s=a.data(),o=US(s.productName);if(!o){n.missingName++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,status:"missingName"});continue}const l=e.get(o);if(!l){n.withoutMatch++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,status:"withoutMatch"});continue}if(s.productId===l){n.alreadyOk++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,newProductId:l,status:"alreadyOk"});continue}t||await kn(Xt(je,"inventory_batches",a.id),{productId:l}),n.fixed++,n.details.push({batchId:a.id,productName:s.productName??"",oldProductId:s.productId,newProductId:l,status:"fixed"})}return console.group("[fixAllBatchProductIds] Resultado"),console.log("checked:",n.checked),console.log("fixed:",n.fixed),console.log("alreadyOk:",n.alreadyOk),console.log("missingName:",n.missingName),console.log("withoutMatch:",n.withoutMatch),console.groupEnd(),n}async function D4e(t,e=!1){const r=US(t),a=(await une()).get(r);if(!a)throw new Error(`No existe un producto activo con nombre "${t}".`);const s=await Ht(bt(je,"inventory_batches"));let o=0;for(const l of s.docs){const c=l.data();US(c.productName)===r&&c.productId!==a&&(e||await kn(Xt(je,"inventory_batches",l.id),{productId:a}),o++)}return console.log(`[fixBatchesByProductName] "${t}" fixed: ${o} lote(s)`),o}function R4e(){const[t,e]=g.useState(!1),[r,n]=g.useState(""),a=async()=>{try{e(!0),n("");const c=await O4e(!1);n(` Hecho. Revisados: ${c.checked}, Corregidos: ${c.fixed}, Ok: ${c.alreadyOk}, Sin nombre: ${c.missingName}, Sin match: ${c.withoutMatch}. (Mira consola para detalles)`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}},[s,o]=g.useState(""),l=async()=>{if(!s.trim()){n(" Escribe el nombre del producto.");return}try{e(!0),n("");const c=await D4e(s.trim(),!1);n(` Hecho. Corregidos ${c} lote(s) para "${s}".`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}};return i.jsxs("div",{className:"max-w-xl mx-auto bg-white p-6 rounded shadow border space-y-4",children:[i.jsx("h1",{className:"text-xl font-bold",children:"Herramienta de Migracin de Lotes"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Corrige los ",i.jsx("code",{children:"inventory_batches.productId"})," basndose en el nombre del producto. salo una sola vez para limpiar datos viejos. Revisa la consola para un log detallado."]}),i.jsx("div",{className:"space-y-2",children:i.jsx("button",{onClick:a,disabled:t,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir TODOS los lotes"})}),i.jsx("hr",{}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Corregir por nombre:"}),i.jsx("input",{className:"border p-2 rounded w-full",placeholder:'Ej: "Pierna Entera"',value:s,onChange:c=>o(c.target.value)}),i.jsx("button",{onClick:l,disabled:t,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir lotes de ese producto"})]}),r&&i.jsx("p",{className:"text-sm",children:r})]})}const M4e=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal","Varios"];function L4e({onCreated:t,onClose:e}){const[r,n]=g.useState(Ur(new Date,"yyyy-MM-dd")),[a,s]=g.useState(""),[o,l]=g.useState(""),[c,u]=g.useState(0),[d]=g.useState("PAGADO"),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState(!1),v=async y=>{if(y.preventDefault(),m(""),!a)return m("Selecciona una categora.");if(!o.trim())return m("Ingresa una descripcin.");if(!c||c<=0)return m("Ingresa un monto vlido.");try{x(!0);const b={date:r,category:a,description:o.trim(),amount:Number(Number(c||0).toFixed(2)),status:"PAGADO",notes:f||"",createdAt:xr.now()},w=await Wn(bt(je,"expenses"),b);t({id:w.id,...b}),m(" Gasto registrado"),e()}catch{m(" Error al guardar gasto")}finally{x(!1)}};return i.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-xl p-6 relative",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear gasto"}),i.jsx("button",{type:"button",onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:v,className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:r,onChange:y=>n(y.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:a,onChange:y=>s(y.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),M4e.map(y=>i.jsx("option",{value:y,children:y},y))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",value:o,onChange:y=>l(y.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:c===0?"":c,onChange:y=>u(Number(y.target.value)),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100 text-gray-500 cursor-not-allowed",value:"PAGADO",readOnly:!0,disabled:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:f,onChange:y=>A(y.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[f.length,"/500"]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",disabled:p,children:"Guardar gasto"}),i.jsx("button",{type:"button",className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",onClick:e,children:"Cancelar"})]}),h&&i.jsx("div",{className:"text-sm mt-2",children:h})]})]})})}const Gc=t=>`C$${Number(t||0).toFixed(2)}`,px=t=>Number(t||0).toFixed(3),U4e=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase()),I5=()=>{const t=new Date;return Ur(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},QC=()=>Ur(new Date,"yyyy-MM-dd");function dne({paidBatches:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[a,s]=g.useState(I5()),[o,l]=g.useState(QC()),[c,u]=g.useState(""),d=g.useMemo(()=>{const ue=new Map;return n.forEach(ne=>ue.set(ne.productId,{id:ne.productId,name:ne.productName})),Array.from(ue.values()).sort((ne,Ve)=>ne.name.localeCompare(Ve.name))},[n]),f=g.useMemo(()=>n.filter(ue=>!(a&&ue.date<a||o&&ue.date>o||c&&ue.productId!==c)),[n,a,o,c]),[A,h]=g.useState(QC()),[m,p]=g.useState(()=>`FAC-${Date.now().toString().slice(-6)}`),[x,v]=g.useState(""),[y,b]=g.useState([]);g.useEffect(()=>{b(ue=>{const ne=ue.filter(Ve=>f.some(it=>it.id===Ve));return ne.length===0&&f.length>0?f.map(Ve=>Ve.id):ne})},[f]);const[w,j]=g.useState([]),[I,C]=g.useState([]),[S,E]=g.useState(!1),[B,k]=g.useState(I5()),[T,P]=g.useState(QC()),[K,le]=g.useState(!1);g.useEffect(()=>{(async()=>{try{E(!0);const ue=sr(bt(je,"expenses"),In("date","desc")),ne=await Ht(ue),Ve=[];ne.forEach(it=>{const vt=it.data();Ve.push({id:it.id,date:vt.date,description:vt.description,amount:Number(vt.amount||0)})}),j(Ve)}catch(ue){console.error(ue)}finally{E(!1)}})()},[]);const oe=ue=>{j(ne=>[ue,...ne]),C(ne=>[ue.id,...ne])},ie=g.useMemo(()=>w.filter(ue=>!(!ue.date||B&&ue.date<B||T&&ue.date>T)),[w,B,T]),[Ae,te]=g.useState([]),[Te,Ue]=g.useState(!1),[O,H]=g.useState(""),[G,L]=g.useState("DEBITO"),[W,X]=g.useState(""),D=()=>{const ue=Number(W);!O.trim()||!isFinite(ue)||ue<=0||(te(ne=>[...ne,{id:`${Date.now()}_${ne.length+1}`,description:O.trim(),type:G,amount:Number(ue.toFixed(2))}]),H(""),X(""))},[Q,Z]=g.useState(null),[be,U]=g.useState(""),[ze,re]=g.useState("DEBITO"),[J,Re]=g.useState(""),ke=ue=>{Z(ue.id),U(ue.description),re(ue.type),Re(ue.amount.toFixed(2))},Be=()=>{Z(null),U(""),re("DEBITO"),Re("")},Ye=()=>{if(!Q)return;const ue=Number(J);!isFinite(ue)||ue<=0||(te(ne=>ne.map(Ve=>Ve.id===Q?{...Ve,description:be.trim(),type:ze,amount:Number(ue.toFixed(2))}:Ve)),Be())},ot=ue=>{te(ne=>ne.filter(Ve=>Ve.id!==ue)),Q===ue&&Be()},Ct=(ue,ne)=>{b(Ve=>ne?[...new Set([...Ve,ue])]:Ve.filter(it=>it!==ue))},jt=ue=>{b(ue?f.map(ne=>ne.id):[])},Ot=(ue,ne)=>{C(Ve=>ne?[...new Set([...Ve,ue])]:Ve.filter(it=>it!==ue))},Tt=g.useMemo(()=>f.filter(ue=>y.includes(ue.id)),[f,y]),Qt=g.useMemo(()=>Ae.filter(ue=>ue.type==="DEBITO").reduce((ue,ne)=>ue+ne.amount,0),[Ae]),Ft=g.useMemo(()=>Ae.filter(ue=>ue.type==="CREDITO").reduce((ue,ne)=>ue+ne.amount,0),[Ae]),Qe=g.useMemo(()=>{let ue=0,ne=0,Ve=0,it=0;for(const Ee of Tt){U4e(Ee.unit)?ue+=Number(Ee.quantity||0):ne+=Number(Ee.quantity||0);const ye=Ee.expectedTotal??Number((Number(Ee.quantity||0)*Number(Ee.salePrice||0)).toFixed(2)),We=Ee.invoiceTotal!==void 0&&Ee.invoiceTotal!==null?Number(Ee.invoiceTotal):Number((Number(Ee.quantity||0)*Number(Ee.purchasePrice||0)).toFixed(2));Ve+=Number(ye||0),it+=Number(We||0)}const vt=ie.filter(Ee=>I.includes(Ee.id)).reduce((Ee,ye)=>Ee+Number(ye.amount||0),0),me=Ve-vt-Qt+Ft;return{totalLbs:ue,totalUnits:ne,totalExpected:Number(Ve.toFixed(2)),totalInvoiced:Number(it.toFixed(2)),totalGastos:Number(vt.toFixed(2)),debits:Number(Qt.toFixed(2)),credits:Number(Ft.toFixed(2)),finalAmount:Number(me.toFixed(2)),grossProfit:Number((Ve-it).toFixed(2))}},[Tt,ie,I,Qt,Ft]),[De,Je]=g.useState(!1),[dt,ce]=g.useState(""),we=async()=>{if(ce(""),Tt.length===0){ce("Selecciona al menos 1 lote pagado.");return}try{Je(!0);const ue={number:m.trim(),date:A,description:x.trim(),status:"PENDIENTE",createdAt:xr.now(),totalLbs:Number(px(Qe.totalLbs)),totalUnits:Number(px(Qe.totalUnits)),totalAmount:Qe.totalExpected,invoiceTotal:Qe.totalInvoiced,totalExpenses:Qe.totalGastos,totalDebits:Qe.debits,totalCredits:Qe.credits,finalAmount:Qe.finalAmount,batches:Tt.map(ne=>{var Ve;return{id:ne.id,productId:ne.productId,productName:ne.productName,unit:ne.unit,quantity:Number(px(ne.quantity)),salePrice:Number(Number(ne.salePrice||0).toFixed(2)),purchasePrice:Number(Number(ne.purchasePrice||0).toFixed(2)),expectedTotal:Number((Number(ne.quantity||0)*Number(ne.salePrice||0)).toFixed(2)),invoiceTotal:ne.invoiceTotal!==void 0&&ne.invoiceTotal!==null?Number(ne.invoiceTotal):Number((Number(ne.quantity||0)*Number(ne.purchasePrice||0)).toFixed(2)),batchDate:ne.date,paidAt:(Ve=ne.paidAt)!=null&&Ve.toDate?Ur(ne.paidAt.toDate(),"yyyy-MM-dd"):null}}),expenses:ie.filter(ne=>I.includes(ne.id)).map(ne=>({id:ne.id,date:ne.date||null,description:ne.description||"",amount:Number(Number(ne.amount||0).toFixed(2))})),adjustments:Ae.map(ne=>({id:ne.id,description:ne.description,type:ne.type,amount:Number(ne.amount.toFixed(2))}))};await Wn(bt(je,"invoices"),ue),ce(" Factura creada."),r()}catch(ue){console.error(ue),ce(` Error al crear factura: ${(ue==null?void 0:ue.message)||"desconocido"}`)}finally{Je(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura"}),i.jsx("button",{type:"button",onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:A,onChange:ue=>h(ue.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:m,onChange:ue=>p(ue.target.value),placeholder:"FAC-001"})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:x,onChange:ue=>v(ue.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:ue=>s(ue.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (lote)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:o,onChange:ue=>l(ue.target.value)})]}),i.jsxs("div",{className:"min-w-[220px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:c,onChange:ue=>u(ue.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),d.map(ue=>i.jsx("option",{value:ue.id,children:ue.name},ue.id))]})]}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{s(I5()),l(QC()),u("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Lotes pagados"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:f.length>0&&y.length===f.length,onChange:ue=>jt(ue.target.checked)}),"Seleccionar todos (sobre el filtro)"]})]}),f.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay lotes pagados disponibles en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha lote"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Cantidad"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Ganancia bruta"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"})]})}),i.jsx("tbody",{children:f.map(ue=>{var me;const ne=y.includes(ue.id),Ve=ue.expectedTotal??Number((Number(ue.quantity||0)*Number(ue.salePrice||0)).toFixed(2)),it=ue.invoiceTotal!==void 0&&ue.invoiceTotal!==null?Number(ue.invoiceTotal):Number((Number(ue.quantity||0)*Number(ue.purchasePrice||0)).toFixed(2)),vt=Ve-it;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:ne,onChange:Ee=>Ct(ue.id,Ee.target.checked)})}),i.jsx("td",{className:"p-2 border",children:ue.date}),i.jsx("td",{className:"p-2 border",children:ue.productName}),i.jsx("td",{className:"p-2 border",children:(ue.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:px(ue.quantity)}),i.jsx("td",{className:"p-2 border",children:Gc(ue.salePrice)}),i.jsx("td",{className:"p-2 border",children:Gc(it)}),i.jsx("td",{className:"p-2 border",children:Gc(Ve)}),i.jsx("td",{className:"p-2 border",children:Gc(vt)}),i.jsx("td",{className:"p-2 border",children:(me=ue.paidAt)!=null&&me.toDate?Ur(ue.paidAt.toDate(),"yyyy-MM-dd"):""})]},ue.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),S&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>le(!0),children:"Crear gasto"}),i.jsxs("div",{className:"flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:B,onChange:ue=>k(ue.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:T,onChange:ue=>P(ue.target.value)})]})]})]}),ie.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:ie.map(ue=>{const ne=I.includes(ue.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:ne,onChange:Ve=>Ot(ue.id,Ve.target.checked)})}),i.jsx("td",{className:"p-2 border",children:ue.date||""}),i.jsx("td",{className:"p-2 border",children:ue.description||""}),i.jsx("td",{className:"p-2 border",children:Gc(Number(ue.amount||0))})]},ue.id)})})]})}),K&&i.jsx(L4e,{onCreated:oe,onClose:()=>le(!1)})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>Ue(!0),children:"Crear Cargo"})]}),Ae.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:Ae.map(ue=>{const ne=Q===ue.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ne?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:be,onChange:Ve=>U(Ve.target.value)}):i.jsx("span",{title:ue.description,children:ue.description.length>60?`${ue.description.slice(0,60)}`:ue.description})}),i.jsx("td",{className:"p-2 border",children:ne?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ze,onChange:Ve=>re(Ve.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ue.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:ue.type})}),i.jsx("td",{className:"p-2 border",children:ne?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:J,onChange:Ve=>Re(Ve.target.value)}):Gc(ue.amount)}),i.jsx("td",{className:"p-2 border",children:ne?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:Ye,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:Be,children:"Cancelar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ot(ue.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>ke(ue),children:"Editar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ot(ue.id),children:"Eliminar"})]})})]},ue.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-blue-700 font-semibold mb-1",children:"Total libras"}),i.jsx("div",{className:"text-2xl font-bold text-blue-900",children:px(Qe.totalLbs)})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-blue-700 font-semibold mb-1",children:"Total unidades"}),i.jsx("div",{className:"text-2xl font-bold text-blue-900",children:px(Qe.totalUnits)})]}),i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-green-700 font-semibold mb-1",children:"Total facturado (costo)"}),i.jsx("div",{className:"text-2xl font-bold text-green-900",children:Gc(Qe.totalInvoiced)})]})]}),i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-red-700 font-semibold mb-1",children:"Gastos"}),i.jsx("div",{className:"text-2xl font-bold text-red-900",children:Gc(Qe.totalGastos)})]}),i.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-orange-700 font-semibold mb-1",children:"Dbitos"}),i.jsx("div",{className:"text-2xl font-bold text-orange-900",children:Gc(Qe.debits)})]}),i.jsxs("div",{className:"bg-lime-50 border border-lime-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-lime-700 font-semibold mb-1",children:"Crditos"}),i.jsx("div",{className:"text-2xl font-bold text-lime-900",children:Gc(Qe.credits)})]})]}),i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-green-700 font-semibold mb-1",children:"Total esperado (ventas)"}),i.jsx("div",{className:"text-2xl font-bold text-green-900",children:Gc(Qe.totalExpected)})]}),i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-yellow-700 font-semibold mb-1",children:"Ganancia bruta"}),i.jsx("div",{className:"text-2xl font-bold text-yellow-900",children:Gc(Qe.grossProfit)})]}),i.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4 shadow text-center",children:[i.jsx("div",{className:"text-xs text-purple-700 font-semibold mb-1",children:"Ganancia neta"}),i.jsx("div",{className:"text-2xl font-bold text-purple-900",children:Gc(Qe.grossProfit-Qe.totalGastos-Qe.debits)})]})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-4 bg-blue-100 border border-blue-300 rounded-xl text-center font-semibold text-lg shadow",children:["Monto final (esperado  gastos  dbitos + crditos):"," ",i.jsx("span",{className:"text-blue-700",children:Gc(Qe.finalAmount)})]})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:De,onClick:we,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:De?"Creando":"Crear factura"}),i.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),dt&&i.jsx("span",{className:"text-sm ml-2",children:dt})]}),De&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),Te&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{type:"button",className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>Ue(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:O,onChange:ue=>H(ue.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:G,onChange:ue=>L(ue.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:W,onChange:ue=>X(ue.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:D,children:"Agregar"})})]})]})})]})}const ad=t=>`C$ ${Number(t||0).toFixed(2)}`,Kc=t=>Number(t||0).toFixed(3),Q4e=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase());function V4e(){const[t,e]=g.useState([]),[r,n]=g.useState(!0),[a,s]=g.useState(!1),[o,l]=g.useState(null),[c,u]=g.useState(Ur(new Date(new Date().getFullYear(),new Date().getMonth(),1),"yyyy-MM-dd")),[d,f]=g.useState(Ur(new Date,"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(!1),{refreshKey:x,refresh:v}=Mc(),[y,b]=g.useState(!1),w=()=>b(P=>!P),[j,I]=g.useState(null),C=P=>I(K=>K===P?null:P);g.useEffect(()=>{(async()=>{n(!0);const P=sr(bt(je,"inventory_batches"),Ar("status","==","PAGADO"),In("date","desc")),K=await Ht(P),le=[];K.forEach(oe=>{const ie=oe.data(),Ae=Number(ie.quantity||0),te=Number(ie.remaining||0),Te=Number(ie.purchasePrice||0),Ue=Number(ie.salePrice||0),O=Number((Ae*Te).toFixed(2)),H=Number((Ae*Ue).toFixed(2));le.push({id:oe.id,productId:ie.productId,productName:ie.productName,category:ie.category,unit:ie.unit,quantity:Ae,remaining:te,purchasePrice:Te,salePrice:Ue,invoiceTotal:ie.invoiceTotal!=null?Number(ie.invoiceTotal):O,expectedTotal:ie.expectedTotal!=null?Number(ie.expectedTotal):H,date:ie.date,status:ie.status,paidAt:ie.paidAt})}),e(le),n(!1)})()},[x]);const S=g.useMemo(()=>t.filter(P=>!(c&&P.date<c||d&&P.date>d||A&&P.productId!==A)),[t,c,d,A]),E=g.useMemo(()=>{let P=0,K=0,le=0,oe=0,ie=0,Ae=0;for(const te of S)Q4e(te.unit)?(P+=te.quantity,K+=te.remaining):(le+=te.quantity,oe+=te.remaining),ie+=Number(te.expectedTotal||0),Ae+=Number(te.invoiceTotal||0);return{lbsIng:P,lbsRem:K,udsIng:le,udsRem:oe,totalEsperado:ie,totalFact:Ae,gross:ie-Ae}},[S]),B=P=>{l(P),s(!0)},k=async()=>{if(o)try{const P=Xt(je,"inventory_batches",o.id);await kn(P,{status:"PENDIENTE",remaining:o.quantity});const K=bt(je,"salesV2"),le=await Ht(sr(K,Ar("batchId","==",o.id))),oe=await Ht(sr(K,Ar("productName","==",o.productName),Ar("date","==",o.date))),ie=[...le.docs,...oe.docs];for(const Ae of ie)await zn(Xt(je,"salesV2",Ae.id));s(!1),l(null),v()}catch(P){console.error("Error al marcar pendiente:",P)}},T=g.useMemo(()=>{const P=new Map;return t.forEach(K=>P.set(K.productId,{id:K.productId,name:K.productName})),Array.from(P.values()).sort((K,le)=>K.name.localeCompare(le.name))},[t]);return i.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Pagados"}),i.jsx(Rc,{onClick:v,loading:r})]}),i.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-2xl border mb-4 flex flex-col sm:flex-row sm:items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-wrap gap-3",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:P=>u(P.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:P=>f(P.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:P=>h(P.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),T.map(P=>i.jsx("option",{value:P.id,children:P.name},P.id))]})]}),i.jsx("button",{type:"button",className:"px-3 py-1 rounded-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h("")},children:"Quitar filtro"})]}),i.jsx("button",{type:"button",className:"sm:ml-auto px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",onClick:()=>p(!0),children:"Crear factura"})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("div",{className:"md:hidden",children:[i.jsxs("button",{type:"button",onClick:w,className:"w-full text-left px-3 py-3 flex items-center justify-between border rounded-2xl bg-white",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"Totales"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Libras: ",i.jsx("b",{children:Kc(E.lbsIng)}),"  Restantes:"," ",i.jsx("b",{children:Kc(E.lbsRem)})]})]}),i.jsx("div",{className:"text-gray-500",children:y?"":""})]}),y&&i.jsx("div",{className:"mt-3 bg-gray-50 p-3 rounded-2xl shadow-2xl border text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Kc(E.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Kc(E.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",ad(E.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Kc(E.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Kc(E.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",ad(E.totalFact)]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",ad(E.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes:"})," ",S.length.toLocaleString()]})]})})]}),i.jsx("div",{className:"hidden md:block bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",Kc(E.lbsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Kc(E.udsIng)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",ad(E.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",Kc(E.lbsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Kc(E.udsRem)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",ad(E.totalFact)]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",ad(E.gross)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes:"})," ",S.length.toLocaleString()]})]})})]}),i.jsx("div",{className:"block md:hidden space-y-3",children:r?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):S.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Sin lotes pagados"}):S.map(P=>{var le;const K=j===P.id;return i.jsxs("div",{className:"bg-white border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>C(P.id),className:"w-full text-left px-3 py-3 flex items-center justify-between bg-white",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:P.productName}),i.jsxs("div",{className:"text-xs text-gray-500 truncate",children:[(P.category||"").toUpperCase(),"  ",P.date," "," ",(P.unit||"").toUpperCase()]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-sm font-bold",children:ad(P.expectedTotal||0)}),i.jsx("div",{className:"text-[11px] text-gray-500",children:K?"Detalles":"Esperado"})]})]}),K&&i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ingresado"}),i.jsx("div",{className:"font-semibold",children:Kc(P.quantity)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:Kc(P.remaining)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Costo"}),i.jsx("div",{className:"font-semibold",children:ad(P.invoiceTotal||0)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Fecha pago"}),i.jsx("div",{className:"font-semibold",children:(le=P.paidAt)!=null&&le.toDate?Ur(P.paidAt.toDate(),"yyyy-MM-dd"):""})]})]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>B(P),children:"Marcar PENDIENTE"})})]})]},P.id)})}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow-2xl border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Ingresado"}),i.jsx("th",{className:"p-2 border",children:"Restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Compra"}),i.jsx("th",{className:"p-2 border",children:"Precio Venta"}),i.jsx("th",{className:"p-2 border",children:"Total factura"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Fecha pago"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):S.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin lotes pagados"})}):S.map(P=>{var K;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.date}),i.jsx("td",{className:"p-2 border",children:(P.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:P.productName}),i.jsx("td",{className:"p-2 border",children:(P.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:Kc(P.quantity)}),i.jsx("td",{className:"p-2 border",children:Kc(P.remaining)}),i.jsx("td",{className:"p-2 border",children:ad(P.purchasePrice)}),i.jsx("td",{className:"p-2 border",children:ad(P.salePrice)}),i.jsx("td",{className:"p-2 border",children:ad(P.invoiceTotal||0)}),i.jsx("td",{className:"p-2 border",children:ad(P.expectedTotal||0)}),i.jsx("td",{className:"p-2 border",children:(K=P.paidAt)!=null&&K.toDate?Ur(P.paidAt.toDate(),"yyyy-MM-dd"):""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>B(P),children:"Marcar PENDIENTE"})})]},P.id)})})]})}),m&&i.jsx(dne,{paidBatches:t,onClose:()=>p(!1),onCreated:()=>p(!1)}),a&&o&&i.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-3",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Confirmar accin"}),i.jsxs("p",{className:"text-gray-700 mb-4",children:["Seguro que quieres marcar pendiente este inventario?",i.jsx("br",{}),"Al hacerlo, las libras se restaurarn y se eliminarn las ventas generadas."]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-xl",children:"Cancelar"}),i.jsx("button",{type:"button",onClick:k,className:"px-4 py-2 bg-yellow-600 text-white hover:bg-yellow-700 rounded-xl",children:"Confirmar"})]})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var QS={};QS.version="0.18.5";var fne=1252,H4e=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Y6={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},J6=function(t){H4e.indexOf(t)!=-1&&(fne=Y6[0]=t)};function $4e(){J6(1252)}var hf=function(t){J6(t)};function Z6(){hf(1200),$4e()}function cH(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function G4e(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function hne(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Xy=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?G4e(t.slice(2)):e==254&&r==255?hne(t.slice(2)):e==65279?t.slice(1):t},VC=function(e){return String.fromCharCode(e)},uH=function(e){return String.fromCharCode(e)},T2,Y0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function B2(t){for(var e="",r=0,n=0,a=0,s=0,o=0,l=0,c=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),o=(r&3)<<4|n>>4,a=t.charCodeAt(u++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),e+=Y0.charAt(s)+Y0.charAt(o)+Y0.charAt(l)+Y0.charAt(c);return e}function $u(t){var e="",r=0,n=0,a=0,s=0,o=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=Y0.indexOf(t.charAt(u++)),o=Y0.indexOf(t.charAt(u++)),r=s<<2|o>>4,e+=String.fromCharCode(r),l=Y0.indexOf(t.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(n)),c=Y0.indexOf(t.charAt(u++)),a=(l&3)<<6|c,c!==64&&(e+=String.fromCharCode(a));return e}var ra=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),RA=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function jm(t){return ra?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function dH(t){return ra?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Tu=function(e){return ra?RA(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function lP(t){if(typeof ArrayBuffer>"u")return Tu(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Hm(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function K4e(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function eR(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return eR(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Zo=ra?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:RA(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function q4e(t){for(var e=[],r=0,n=t.length+250,a=jm(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++s)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(e.push(a.slice(0,r)),r=0,a=jm(65535),n=65530)}return e.push(a.slice(0,r)),Zo(e)}var Bc=/\u0000/g,Yy=/[\u0001-\u0006]/g;function gv(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Af(t,e){var r=""+t;return r.length>=e?r:Si("0",e-r.length)+r}function tR(t,e){var r=""+t;return r.length>=e?r:Si(" ",e-r.length)+r}function VS(t,e){var r=""+t;return r.length>=e?r:r+Si(" ",e-r.length)}function z4e(t,e){var r=""+Math.round(t);return r.length>=e?r:Si("0",e-r.length)+r}function W4e(t,e){var r=""+t;return r.length>=e?r:Si("0",e-r.length)+r}var fH=Math.pow(2,32);function gx(t,e){if(t>fH||t<-fH)return z4e(t,e);var r=Math.round(t);return W4e(r,e)}function HS(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var hH=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],j5=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function X4e(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Fn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},AH={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Y4e={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $S(t,e,r){for(var n=t<0?-1:1,a=t*n,s=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(a);u<e&&(f=Math.floor(a),l=f*o+s,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),s=o,o=l,c=u,u=d;if(d>e&&(u>e?(d=c,l=s):(d=u,l=o)),!r)return[0,n*l,d];var A=Math.floor(n*l/d);return[A,n*l-A*d,d]}function Pp(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),s=0,o=[],l={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=n3e(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=s,l}var Ane=new Date(1899,11,31,0,0,0),J4e=Ane.getTime(),Z4e=new Date(1900,2,1,0,0,0);function mne(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Z4e&&(r+=24*60*60*1e3),(r-(J4e+(t.getTimezoneOffset()-Ane.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function rR(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function e3e(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function t3e(t){var e=t<0?12:11,r=rR(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function r3e(t){var e=rR(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function k2(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=t3e(t):e===10?r=t.toFixed(10).substr(0,12):r=r3e(t),rR(e3e(r.toUpperCase()))}function pg(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):k2(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Dd(14,mne(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function n3e(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function a3e(t,e,r,n){var a="",s=0,o=0,l=r.y,c,u=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,u=e.length;break;case 3:return j5[r.m-1][1];case 5:return j5[r.m-1][0];default:return j5[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,u=e.length;break;case 3:return hH[r.q][0];default:return hH[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Af(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(a=Af(s,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?Af(c,u):"";return d}function J0(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var pne=/%/g;function s3e(t,e,r){var n=e.replace(pne,""),a=e.length-n.length;return lA(t,n,r*Math.pow(10,2*a))+Si("%",a)}function i3e(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return lA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function gne(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+gne(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var xne=/# (\?+)( ?)\/( ?)(\d+)/;function o3e(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),s=Math.floor(a/n),o=a-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?Si(" ",t[1].length+1+t[4].length):tR(o,t[1].length)+t[2]+"/"+t[3]+Af(l,t[4].length))}function l3e(t,e,r){return r+(e===0?"":""+e)+Si(" ",t[1].length+2+t[4].length)}var vne=/^#*0*\.([0#]+)/,yne=/\).*[0#]/,bne=/\(###\) ###\\?-####/;function Nc(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function mH(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function pH(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function c3e(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function u3e(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ud(t,e,r){if(t.charCodeAt(0)===40&&!e.match(yne)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ud("n",n,r):"("+ud("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return i3e(t,e,r);if(e.indexOf("%")!==-1)return s3e(t,e,r);if(e.indexOf("E")!==-1)return gne(e,r);if(e.charCodeAt(0)===36)return"$"+ud(t,e.substr(e.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+gx(c,e.length);if(e.match(/^[#?]+$/))return a=gx(r,0),a==="0"&&(a=""),a.length>e.length?a:Nc(e.substr(0,e.length-a.length))+a;if(s=e.match(xne))return o3e(s,c,u);if(e.match(/^#+0+$/))return u+gx(c,e.length-e.indexOf("0"));if(s=e.match(vne))return a=mH(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Nc(s[1])).replace(/\.$/,"."+Nc(s[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+Si("0",Nc(s[1]).length-p.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+mH(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+J0(gx(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ud(t,e,-r):J0(""+(Math.floor(r)+c3e(r,s[1].length)))+"."+Af(pH(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return ud(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=gv(ud(t,e.replace(/[\\-]/g,""),r)),o=0,gv(gv(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(e.match(bne))return a=ud(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=$S(c,Math.pow(10,o)-1,!1),a=""+u,d=lA("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=VS(l[2],o),d.length<s[4].length&&(d=Nc(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=$S(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?tR(l[1],o)+s[2]+"/"+s[3]+VS(l[2],o):Si(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=gx(r,0),e.length<=a.length?a:Nc(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=e.indexOf(".")-o,A=e.length-a.length-f;return Nc(e.substr(0,f)+a+e.substr(e.length-A))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=pH(r,s[1].length),r<0?"-"+ud(t,e,-r):J0(u3e(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Af(0,3-m.length):"")+m})+"."+Af(o,s[1].length);switch(e){case"###,##0.00":return ud(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=J0(gx(c,0));return h!=="0"?u+h:"";case"###,###.00":return ud(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ud(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function d3e(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return lA(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function f3e(t,e,r){var n=e.replace(pne,""),a=e.length-n.length;return lA(t,n,r*Math.pow(10,2*a))+Si("%",a)}function wne(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+wne(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function $f(t,e,r){if(t.charCodeAt(0)===40&&!e.match(yne)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$f("n",n,r):"("+$f("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return d3e(t,e,r);if(e.indexOf("%")!==-1)return f3e(t,e,r);if(e.indexOf("E")!==-1)return wne(e,r);if(e.charCodeAt(0)===36)return"$"+$f(t,e.substr(e.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Af(c,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:Nc(e.substr(0,e.length-a.length))+a;if(s=e.match(xne))return l3e(s,c,u);if(e.match(/^#+0+$/))return u+Af(c,e.length-e.indexOf("0"));if(s=e.match(vne))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Nc(s[1])).replace(/\.$/,"."+Nc(s[1])),a=a.replace(/\.(\d*)$/,function(m,p){return"."+p+Si("0",Nc(s[1]).length-p.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+J0(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$f(t,e,-r):J0(""+r)+"."+Si("0",s[1].length);if(s=e.match(/^#,#*,#0/))return $f(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=gv($f(t,e.replace(/[\\-]/g,""),r)),o=0,gv(gv(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(e.match(bne))return a=$f(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=$S(c,Math.pow(10,o)-1,!1),a=""+u,d=lA("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=VS(l[2],o),d.length<s[4].length&&(d=Nc(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=$S(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?tR(l[1],o)+s[2]+"/"+s[3]+VS(l[2],o):Si(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:Nc(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=e.indexOf(".")-o,A=e.length-a.length-f;return Nc(e.substr(0,f)+a+e.substr(e.length-A))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+$f(t,e,-r):J0(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Af(0,3-m.length):"")+m})+"."+Af(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var h=J0(""+c);return h!=="0"?u+h:"";default:if(e.match(/\.[0#?]*$/))return $f(t,e.slice(0,e.lastIndexOf(".")),r)+Nc(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function lA(t,e,r){return(r|0)===r?$f(t,e,r):ud(t,e,r)}function h3e(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var Nne=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function y1(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":HS(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(Nne))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function A3e(t,e,r,n){for(var a=[],s="",o=0,l="",c="t",u,d,f,A="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!HS(t,o))throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++o;break;case"\\":var h=t.charAt(++o),m=h==="("||h===")"?h:"t";a[a.length]={t:m,v:h},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(u==null&&(u=Pp(e,r,t.charAt(o+1)==="2"),u==null))return"";a[a.length]={t:"X",v:t.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Pp(e,r),u==null))return"";for(s=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=A),a[a.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(u==null&&(u=Pp(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",A="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",o+=5,A="h"):t.substr(o,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",o+=5,A="h"):(p.t="t",++o),u==null&&p.t==="T")return"";a[a.length]=p,c=l;break;case"[":for(s=l;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Nne)){if(u==null&&(u=Pp(e,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",y1(t)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<t.length&&(l=t.charAt(o))==="0";)s+=l;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)s+=l;a[a.length]={t:"n",v:s};break;case"?":for(s=l;t.charAt(++o)===l;)s+=l;a[a.length]={t:l,v:s},c=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"t",v:l},++o;break}var x=0,v=0,y;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=A,c="h",x<1&&(x=1);break;case"s":(y=a[o].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&a[o].v.match(/[Hh]/)&&(x=1),x<2&&a[o].v.match(/[Mm]/)&&(x=2),x<3&&a[o].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",w;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=a3e(a[o].t.charCodeAt(0),a[o].v,u,v),a[o].t="t";break;case"n":case"?":for(w=o+1;a[w]!=null&&((l=a[w].t)==="?"||l==="D"||(l===" "||l==="t")&&a[w+1]!=null&&(a[w+1].t==="?"||a[w+1].t==="t"&&a[w+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[w].v==="/"||a[w].v===" "&&a[w+1]!=null&&a[w+1].t=="?"));)a[o].v+=a[w].v,a[w]={v:"",t:";"},++w;b+=a[o].v,o=w-1;break;case"G":a[o].t="t",a[o].v=pg(e,r);break}var j="",I,C;if(b.length>0){b.charCodeAt(0)==40?(I=e<0&&b.charCodeAt(0)===45?-e:e,C=lA("n",b,I)):(I=e<0&&n>1?-e:e,C=lA("n",b,I),I<0&&a[0]&&a[0].t=="t"&&(C=C.substr(1),a[0].v="-"+a[0].v)),w=C.length-1;var S=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){S=o;break}var E=a.length;if(S===a.length&&C.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(w>=a[o].v.length-1?(w-=a[o].v.length,a[o].v=C.substr(w+1,a[o].v.length)):w<0?a[o].v="":(a[o].v=C.substr(0,w+1),w=-1),a[o].t="t",E=o);w>=0&&E<a.length&&(a[E].v=C.substr(0,w+1)+a[E].v)}else if(S!==a.length&&C.indexOf("E")===-1){for(w=C.indexOf(".")-1,o=S;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(d=a[o].v.indexOf(".")>-1&&o===S?a[o].v.indexOf(".")-1:a[o].v.length-1,j=a[o].v.substr(d+1);d>=0;--d)w>=0&&(a[o].v.charAt(d)==="0"||a[o].v.charAt(d)==="#")&&(j=C.charAt(w--)+j);a[o].v=j,a[o].t="t",E=o}for(w>=0&&E<a.length&&(a[E].v=C.substr(0,w+1)+a[E].v),w=C.indexOf(".")+1,o=S;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==S)){for(d=a[o].v.indexOf(".")>-1&&o===S?a[o].v.indexOf(".")+1:0,j=a[o].v.substr(0,d);d<a[o].v.length;++d)w<C.length&&(j+=C.charAt(w++));a[o].v=j,a[o].t="t",E=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(I=n>1&&e<0&&o>0&&a[o-1].v==="-"?-e:e,a[o].v=lA(a[o].t,a[o].v,I),a[o].t="t");var B="";for(o=0;o!==a.length;++o)a[o]!=null&&(B+=a[o].v);return B}var gH=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function xH(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function m3e(t,e){var r=h3e(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(gH),l=r[1].match(gH);return xH(e,o)?[n,r[0]]:xH(e,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function Dd(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Fn)[t],n==null&&(n=r.table&&r.table[AH[t]]||Fn[AH[t]]),n==null&&(n=Y4e[t]||"General");break}if(HS(n,0))return pg(e,r);e instanceof Date&&(e=mne(e,r.date1904));var a=m3e(n,e);if(HS(a[1]))return pg(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return A3e(a[1],e,r,a[0])}function cA(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Fn[r]==null){e<0&&(e=r);continue}if(Fn[r]==t){e=r;break}}e<0&&(e=391)}return Fn[e]=t,e}function cP(t){for(var e=0;e!=392;++e)t[e]!==void 0&&cA(t[e],e)}function b1(){Fn=X4e()}var p3e={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Cne=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function g3e(t){var e=typeof t=="number"?Fn[t]:t;return e=e.replace(Cne,"(\\d+)"),new RegExp("^"+e+"$")}function x3e(t,e,r){var n=-1,a=-1,s=-1,o=-1,l=-1,c=-1;(e.match(Cne)||[]).forEach(function(f,A){var h=parseInt(r[A+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:a=h;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&a==-1&&s==-1?d:u+"T"+d}var v3e=function(){var t={};t.version="1.2.0";function e(){for(var C=0,S=new Array(256),E=0;E!=256;++E)C=E,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,S[E]=C;return typeof Int32Array<"u"?new Int32Array(S):S}var r=e();function n(C){var S=0,E=0,B=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)k[B]=C[B];for(B=0;B!=256;++B)for(E=C[B],S=256+B;S<4096;S+=256)E=k[S]=E>>>8^C[E&255];var T=[];for(B=1;B!=16;++B)T[B-1]=typeof Int32Array<"u"?k.subarray(B*256,B*256+256):k.slice(B*256,B*256+256);return T}var a=n(r),s=a[0],o=a[1],l=a[2],c=a[3],u=a[4],d=a[5],f=a[6],A=a[7],h=a[8],m=a[9],p=a[10],x=a[11],v=a[12],y=a[13],b=a[14];function w(C,S){for(var E=S^-1,B=0,k=C.length;B<k;)E=E>>>8^r[(E^C.charCodeAt(B++))&255];return~E}function j(C,S){for(var E=S^-1,B=C.length-15,k=0;k<B;)E=b[C[k++]^E&255]^y[C[k++]^E>>8&255]^v[C[k++]^E>>16&255]^x[C[k++]^E>>>24]^p[C[k++]]^m[C[k++]]^h[C[k++]]^A[C[k++]]^f[C[k++]]^d[C[k++]]^u[C[k++]]^c[C[k++]]^l[C[k++]]^o[C[k++]]^s[C[k++]]^r[C[k++]];for(B+=15;k<B;)E=E>>>8^r[(E^C[k++])&255];return~E}function I(C,S){for(var E=S^-1,B=0,k=C.length,T=0,P=0;B<k;)T=C.charCodeAt(B++),T<128?E=E>>>8^r[(E^T)&255]:T<2048?(E=E>>>8^r[(E^(192|T>>6&31))&255],E=E>>>8^r[(E^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,P=C.charCodeAt(B++)&1023,E=E>>>8^r[(E^(240|T>>8&7))&255],E=E>>>8^r[(E^(128|T>>2&63))&255],E=E>>>8^r[(E^(128|P>>6&15|(T&3)<<4))&255],E=E>>>8^r[(E^(128|P&63))&255]):(E=E>>>8^r[(E^(224|T>>12&15))&255],E=E>>>8^r[(E^(128|T>>6&63))&255],E=E>>>8^r[(E^(128|T&63))&255]);return~E}return t.table=r,t.bstr=w,t.buf=j,t.str=I,t}(),En=function(){var e={};e.version="1.2.1";function r(R,V){for(var q=R.split("/"),se=V.split("/"),Ne=0,Me=0,Ke=Math.min(q.length,se.length);Ne<Ke;++Ne){if(Me=q[Ne].length-se[Ne].length)return Me;if(q[Ne]!=se[Ne])return q[Ne]<se[Ne]?-1:1}return q.length-se.length}function n(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:n(R.slice(0,-1));var V=R.lastIndexOf("/");return V===-1?R:R.slice(0,V+1)}function a(R){if(R.charAt(R.length-1)=="/")return a(R.slice(0,-1));var V=R.lastIndexOf("/");return V===-1?R:R.slice(V+1)}function s(R,V){typeof V=="string"&&(V=new Date(V));var q=V.getHours();q=q<<6|V.getMinutes(),q=q<<5|V.getSeconds()>>>1,R.write_shift(2,q);var se=V.getFullYear()-1980;se=se<<4|V.getMonth()+1,se=se<<5|V.getDate(),R.write_shift(2,se)}function o(R){var V=R.read_shift(2)&65535,q=R.read_shift(2)&65535,se=new Date,Ne=q&31;q>>>=5;var Me=q&15;q>>>=4,se.setMilliseconds(0),se.setFullYear(q+1980),se.setMonth(Me-1),se.setDate(Ne);var Ke=V&31;V>>>=5;var Pe=V&63;return V>>>=6,se.setHours(V),se.setMinutes(Pe),se.setSeconds(Ke<<1),se}function l(R){El(R,0);for(var V={},q=0;R.l<=R.length-4;){var se=R.read_shift(2),Ne=R.read_shift(2),Me=R.l+Ne,Ke={};switch(se){case 21589:q=R.read_shift(1),q&1&&(Ke.mtime=R.read_shift(4)),Ne>5&&(q&2&&(Ke.atime=R.read_shift(4)),q&4&&(Ke.ctime=R.read_shift(4))),Ke.mtime&&(Ke.mt=new Date(Ke.mtime*1e3));break}R.l=Me,V[se]=Ke}return V}var c;function u(){return c||(c={})}function d(R,V){if(R[0]==80&&R[1]==75)return ye(R,V);if((R[0]|32)==109&&(R[1]|32)==105)return Le(R,V);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var q=3,se=512,Ne=0,Me=0,Ke=0,Pe=0,rt=0,lt=[],ht=R.slice(0,512);El(ht,0);var kt=f(ht);switch(q=kt[0],q){case 3:se=512;break;case 4:se=4096;break;case 0:if(kt[1]==0)return ye(R,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+q)}se!==512&&(ht=R.slice(0,se),El(ht,28));var de=R.slice(0,se);A(ht,q);var qe=ht.read_shift(4,"i");if(q===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);ht.l+=4,Ke=ht.read_shift(4,"i"),ht.l+=4,ht.chk("00100000","Mini Stream Cutoff Size: "),Pe=ht.read_shift(4,"i"),Ne=ht.read_shift(4,"i"),rt=ht.read_shift(4,"i"),Me=ht.read_shift(4,"i");for(var at=-1,st=0;st<109&&(at=ht.read_shift(4,"i"),!(at<0));++st)lt[st]=at;var Nt=h(R,se);x(rt,Me,Nt,se,lt);var Rt=y(Nt,Ke,lt,se);Rt[Ke].name="!Directory",Ne>0&&Pe!==P&&(Rt[Pe].name="!MiniFAT"),Rt[lt[0]].name="!FAT",Rt.fat_addrs=lt,Rt.ssz=se;var nr={},_r=[],$r=[],or=[];b(Ke,Rt,Nt,_r,Ne,nr,$r,Pe),m($r,or,_r),_r.shift();var kr={FileIndex:$r,FullPaths:or};return V&&V.raw&&(kr.raw={header:de,sectors:Nt}),kr}function f(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(K,"Header Signature: "),R.l+=16;var V=R.read_shift(2,"u");return[R.read_shift(2,"u"),V]}function A(R,V){var q=9;switch(R.l+=2,q=R.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+q);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+q)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function h(R,V){for(var q=Math.ceil(R.length/V)-1,se=[],Ne=1;Ne<q;++Ne)se[Ne-1]=R.slice(Ne*V,(Ne+1)*V);return se[q-1]=R.slice(q*V),se}function m(R,V,q){for(var se=0,Ne=0,Me=0,Ke=0,Pe=0,rt=q.length,lt=[],ht=[];se<rt;++se)lt[se]=ht[se]=se,V[se]=q[se];for(;Pe<ht.length;++Pe)se=ht[Pe],Ne=R[se].L,Me=R[se].R,Ke=R[se].C,lt[se]===se&&(Ne!==-1&&lt[Ne]!==Ne&&(lt[se]=lt[Ne]),Me!==-1&&lt[Me]!==Me&&(lt[se]=lt[Me])),Ke!==-1&&(lt[Ke]=se),Ne!==-1&&se!=lt[se]&&(lt[Ne]=lt[se],ht.lastIndexOf(Ne)<Pe&&ht.push(Ne)),Me!==-1&&se!=lt[se]&&(lt[Me]=lt[se],ht.lastIndexOf(Me)<Pe&&ht.push(Me));for(se=1;se<rt;++se)lt[se]===se&&(Me!==-1&&lt[Me]!==Me?lt[se]=lt[Me]:Ne!==-1&&lt[Ne]!==Ne&&(lt[se]=lt[Ne]));for(se=1;se<rt;++se)if(R[se].type!==0){if(Pe=se,Pe!=lt[Pe])do Pe=lt[Pe],V[se]=V[Pe]+"/"+V[se];while(Pe!==0&&lt[Pe]!==-1&&Pe!=lt[Pe]);lt[se]=-1}for(V[0]+="/",se=1;se<rt;++se)R[se].type!==2&&(V[se]+="/")}function p(R,V,q){for(var se=R.start,Ne=R.size,Me=[],Ke=se;q&&Ne>0&&Ke>=0;)Me.push(V.slice(Ke*T,Ke*T+T)),Ne-=T,Ke=Np(q,Ke*4);return Me.length===0?cr(0):Zo(Me).slice(0,R.size)}function x(R,V,q,se,Ne){var Me=P;if(R===P){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var Ke=q[R],Pe=(se>>>2)-1;if(!Ke)return;for(var rt=0;rt<Pe&&(Me=Np(Ke,rt*4))!==P;++rt)Ne.push(Me);x(Np(Ke,se-4),V-1,q,se,Ne)}}function v(R,V,q,se,Ne){var Me=[],Ke=[];Ne||(Ne=[]);var Pe=se-1,rt=0,lt=0;for(rt=V;rt>=0;){Ne[rt]=!0,Me[Me.length]=rt,Ke.push(R[rt]);var ht=q[Math.floor(rt*4/se)];if(lt=rt*4&Pe,se<4+lt)throw new Error("FAT boundary crossed: "+rt+" 4 "+se);if(!R[ht])break;rt=Np(R[ht],lt)}return{nodes:Me,data:PH([Ke])}}function y(R,V,q,se){var Ne=R.length,Me=[],Ke=[],Pe=[],rt=[],lt=se-1,ht=0,kt=0,de=0,qe=0;for(ht=0;ht<Ne;++ht)if(Pe=[],de=ht+V,de>=Ne&&(de-=Ne),!Ke[de]){rt=[];var at=[];for(kt=de;kt>=0;){at[kt]=!0,Ke[kt]=!0,Pe[Pe.length]=kt,rt.push(R[kt]);var st=q[Math.floor(kt*4/se)];if(qe=kt*4&lt,se<4+qe)throw new Error("FAT boundary crossed: "+kt+" 4 "+se);if(!R[st]||(kt=Np(R[st],qe),at[kt]))break}Me[de]={nodes:Pe,data:PH([rt])}}return Me}function b(R,V,q,se,Ne,Me,Ke,Pe){for(var rt=0,lt=se.length?2:0,ht=V[R].data,kt=0,de=0,qe;kt<ht.length;kt+=128){var at=ht.slice(kt,kt+128);El(at,64),de=at.read_shift(2),qe=cR(at,0,de-lt),se.push(qe);var st={name:qe,type:at.read_shift(1),color:at.read_shift(1),L:at.read_shift(4,"i"),R:at.read_shift(4,"i"),C:at.read_shift(4,"i"),clsid:at.read_shift(16),state:at.read_shift(4,"i"),start:0,size:0},Nt=at.read_shift(2)+at.read_shift(2)+at.read_shift(2)+at.read_shift(2);Nt!==0&&(st.ct=w(at,at.l-8));var Rt=at.read_shift(2)+at.read_shift(2)+at.read_shift(2)+at.read_shift(2);Rt!==0&&(st.mt=w(at,at.l-8)),st.start=at.read_shift(4,"i"),st.size=at.read_shift(4,"i"),st.size<0&&st.start<0&&(st.size=st.type=0,st.start=P,st.name=""),st.type===5?(rt=st.start,Ne>0&&rt!==P&&(V[rt].name="!StreamData")):st.size>=4096?(st.storage="fat",V[st.start]===void 0&&(V[st.start]=v(q,st.start,V.fat_addrs,V.ssz)),V[st.start].name=st.name,st.content=V[st.start].data.slice(0,st.size)):(st.storage="minifat",st.size<0?st.size=0:rt!==P&&st.start!==P&&V[rt]&&(st.content=p(st,V[rt].data,(V[Pe]||{}).data))),st.content&&El(st.content,0),Me[qe]=st,Ke.push(st)}}function w(R,V){return new Date((Pu(R,V+4)/1e7*Math.pow(2,32)+Pu(R,V)/1e7-11644473600)*1e3)}function j(R,V){return u(),d(c.readFileSync(R),V)}function I(R,V){var q=V&&V.type;switch(q||ra&&Buffer.isBuffer(R)&&(q="buffer"),q||"base64"){case"file":return j(R,V);case"base64":return d(Tu($u(R)),V);case"binary":return d(Tu(R),V)}return d(R,V)}function C(R,V){var q=V||{},se=q.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=se+"/",R.FileIndex[0]={name:se,type:5}),q.CLSID&&(R.FileIndex[0].clsid=q.CLSID),S(R)}function S(R){var V="Sh33tJ5";if(!En.find(R,"/"+V)){var q=cr(4);q[0]=55,q[1]=q[3]=50,q[2]=54,R.FileIndex.push({name:V,type:2,content:q,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+V),E(R)}}function E(R,V){C(R);for(var q=!1,se=!1,Ne=R.FullPaths.length-1;Ne>=0;--Ne){var Me=R.FileIndex[Ne];switch(Me.type){case 0:se?q=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:se=!0,isNaN(Me.R*Me.L*Me.C)&&(q=!0),Me.R>-1&&Me.L>-1&&Me.R==Me.L&&(q=!0);break;default:q=!0;break}}if(!(!q&&!V)){var Ke=new Date(1987,1,19),Pe=0,rt=Object.create?Object.create(null):{},lt=[];for(Ne=0;Ne<R.FullPaths.length;++Ne)rt[R.FullPaths[Ne]]=!0,R.FileIndex[Ne].type!==0&&lt.push([R.FullPaths[Ne],R.FileIndex[Ne]]);for(Ne=0;Ne<lt.length;++Ne){var ht=n(lt[Ne][0]);se=rt[ht],se||(lt.push([ht,{name:a(ht).replace("/",""),type:1,clsid:oe,ct:Ke,mt:Ke,content:null}]),rt[ht]=!0)}for(lt.sort(function(qe,at){return r(qe[0],at[0])}),R.FullPaths=[],R.FileIndex=[],Ne=0;Ne<lt.length;++Ne)R.FullPaths[Ne]=lt[Ne][0],R.FileIndex[Ne]=lt[Ne][1];for(Ne=0;Ne<lt.length;++Ne){var kt=R.FileIndex[Ne],de=R.FullPaths[Ne];if(kt.name=a(de).replace("/",""),kt.L=kt.R=kt.C=-(kt.color=1),kt.size=kt.content?kt.content.length:0,kt.start=0,kt.clsid=kt.clsid||oe,Ne===0)kt.C=lt.length>1?1:-1,kt.size=0,kt.type=5;else if(de.slice(-1)=="/"){for(Pe=Ne+1;Pe<lt.length&&n(R.FullPaths[Pe])!=de;++Pe);for(kt.C=Pe>=lt.length?-1:Pe,Pe=Ne+1;Pe<lt.length&&n(R.FullPaths[Pe])!=n(de);++Pe);kt.R=Pe>=lt.length?-1:Pe,kt.type=1}else n(R.FullPaths[Ne+1]||"")==n(de)&&(kt.R=Ne+1),kt.type=2}}}function B(R,V){var q=V||{};if(q.fileType=="mad")return Ce(R,q);switch(E(R),q.fileType){case"zip":return ge(R,q)}var se=function(qe){for(var at=0,st=0,Nt=0;Nt<qe.FileIndex.length;++Nt){var Rt=qe.FileIndex[Nt];if(Rt.content){var nr=Rt.content.length;nr>0&&(nr<4096?at+=nr+63>>6:st+=nr+511>>9)}}for(var _r=qe.FullPaths.length+3>>2,$r=at+7>>3,or=at+127>>7,kr=$r+st+_r+or,en=kr+127>>7,rn=en<=109?0:Math.ceil((en-109)/127);kr+en+rn+127>>7>en;)rn=++en<=109?0:Math.ceil((en-109)/127);var Er=[1,rn,en,or,_r,st,at,0];return qe.FileIndex[0].size=at<<6,Er[7]=(qe.FileIndex[0].start=Er[0]+Er[1]+Er[2]+Er[3]+Er[4]+Er[5])+(Er[6]+7>>3),Er}(R),Ne=cr(se[7]<<9),Me=0,Ke=0;{for(Me=0;Me<8;++Me)Ne.write_shift(1,le[Me]);for(Me=0;Me<8;++Me)Ne.write_shift(2,0);for(Ne.write_shift(2,62),Ne.write_shift(2,3),Ne.write_shift(2,65534),Ne.write_shift(2,9),Ne.write_shift(2,6),Me=0;Me<3;++Me)Ne.write_shift(2,0);for(Ne.write_shift(4,0),Ne.write_shift(4,se[2]),Ne.write_shift(4,se[0]+se[1]+se[2]+se[3]-1),Ne.write_shift(4,0),Ne.write_shift(4,4096),Ne.write_shift(4,se[3]?se[0]+se[1]+se[2]-1:P),Ne.write_shift(4,se[3]),Ne.write_shift(-4,se[1]?se[0]-1:P),Ne.write_shift(4,se[1]),Me=0;Me<109;++Me)Ne.write_shift(-4,Me<se[2]?se[1]+Me:-1)}if(se[1])for(Ke=0;Ke<se[1];++Ke){for(;Me<236+Ke*127;++Me)Ne.write_shift(-4,Me<se[2]?se[1]+Me:-1);Ne.write_shift(-4,Ke===se[1]-1?P:Ke+1)}var Pe=function(qe){for(Ke+=qe;Me<Ke-1;++Me)Ne.write_shift(-4,Me+1);qe&&(++Me,Ne.write_shift(-4,P))};for(Ke=Me=0,Ke+=se[1];Me<Ke;++Me)Ne.write_shift(-4,ie.DIFSECT);for(Ke+=se[2];Me<Ke;++Me)Ne.write_shift(-4,ie.FATSECT);Pe(se[3]),Pe(se[4]);for(var rt=0,lt=0,ht=R.FileIndex[0];rt<R.FileIndex.length;++rt)ht=R.FileIndex[rt],ht.content&&(lt=ht.content.length,!(lt<4096)&&(ht.start=Ke,Pe(lt+511>>9)));for(Pe(se[6]+7>>3);Ne.l&511;)Ne.write_shift(-4,ie.ENDOFCHAIN);for(Ke=Me=0,rt=0;rt<R.FileIndex.length;++rt)ht=R.FileIndex[rt],ht.content&&(lt=ht.content.length,!(!lt||lt>=4096)&&(ht.start=Ke,Pe(lt+63>>6)));for(;Ne.l&511;)Ne.write_shift(-4,ie.ENDOFCHAIN);for(Me=0;Me<se[4]<<2;++Me){var kt=R.FullPaths[Me];if(!kt||kt.length===0){for(rt=0;rt<17;++rt)Ne.write_shift(4,0);for(rt=0;rt<3;++rt)Ne.write_shift(4,-1);for(rt=0;rt<12;++rt)Ne.write_shift(4,0);continue}ht=R.FileIndex[Me],Me===0&&(ht.start=ht.size?ht.start-1:P);var de=Me===0&&q.root||ht.name;if(lt=2*(de.length+1),Ne.write_shift(64,de,"utf16le"),Ne.write_shift(2,lt),Ne.write_shift(1,ht.type),Ne.write_shift(1,ht.color),Ne.write_shift(-4,ht.L),Ne.write_shift(-4,ht.R),Ne.write_shift(-4,ht.C),ht.clsid)Ne.write_shift(16,ht.clsid,"hex");else for(rt=0;rt<4;++rt)Ne.write_shift(4,0);Ne.write_shift(4,ht.state||0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,0),Ne.write_shift(4,ht.start),Ne.write_shift(4,ht.size),Ne.write_shift(4,0)}for(Me=1;Me<R.FileIndex.length;++Me)if(ht=R.FileIndex[Me],ht.size>=4096)if(Ne.l=ht.start+1<<9,ra&&Buffer.isBuffer(ht.content))ht.content.copy(Ne,Ne.l,0,ht.size),Ne.l+=ht.size+511&-512;else{for(rt=0;rt<ht.size;++rt)Ne.write_shift(1,ht.content[rt]);for(;rt&511;++rt)Ne.write_shift(1,0)}for(Me=1;Me<R.FileIndex.length;++Me)if(ht=R.FileIndex[Me],ht.size>0&&ht.size<4096)if(ra&&Buffer.isBuffer(ht.content))ht.content.copy(Ne,Ne.l,0,ht.size),Ne.l+=ht.size+63&-64;else{for(rt=0;rt<ht.size;++rt)Ne.write_shift(1,ht.content[rt]);for(;rt&63;++rt)Ne.write_shift(1,0)}if(ra)Ne.l=Ne.length;else for(;Ne.l<Ne.length;)Ne.write_shift(1,0);return Ne}function k(R,V){var q=R.FullPaths.map(function(rt){return rt.toUpperCase()}),se=q.map(function(rt){var lt=rt.split("/");return lt[lt.length-(rt.slice(-1)=="/"?2:1)]}),Ne=!1;V.charCodeAt(0)===47?(Ne=!0,V=q[0].slice(0,-1)+V):Ne=V.indexOf("/")!==-1;var Me=V.toUpperCase(),Ke=Ne===!0?q.indexOf(Me):se.indexOf(Me);if(Ke!==-1)return R.FileIndex[Ke];var Pe=!Me.match(Yy);for(Me=Me.replace(Bc,""),Pe&&(Me=Me.replace(Yy,"!")),Ke=0;Ke<q.length;++Ke)if((Pe?q[Ke].replace(Yy,"!"):q[Ke]).replace(Bc,"")==Me||(Pe?se[Ke].replace(Yy,"!"):se[Ke]).replace(Bc,"")==Me)return R.FileIndex[Ke];return null}var T=64,P=-2,K="d0cf11e0a1b11ae1",le=[208,207,17,224,161,177,26,225],oe="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:oe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ae(R,V,q){u();var se=B(R,q);c.writeFileSync(V,se)}function te(R){for(var V=new Array(R.length),q=0;q<R.length;++q)V[q]=String.fromCharCode(R[q]);return V.join("")}function Te(R,V){var q=B(R,V);switch(V&&V.type||"buffer"){case"file":return u(),c.writeFileSync(V.filename,q),q;case"binary":return typeof q=="string"?q:te(q);case"base64":return B2(typeof q=="string"?q:te(q));case"buffer":if(ra)return Buffer.isBuffer(q)?q:RA(q);case"array":return typeof q=="string"?Tu(q):q}return q}var Ue;function O(R){try{var V=R.InflateRaw,q=new V;if(q._processChunk(new Uint8Array([3,0]),q._finishFlushFlag),q.bytesRead)Ue=R;else throw new Error("zlib does not expose bytesRead")}catch(se){console.error("cannot use native zlib: "+(se.message||se))}}function H(R,V){if(!Ue)return me(R,V);var q=Ue.InflateRaw,se=new q,Ne=se._processChunk(R.slice(R.l),se._finishFlushFlag);return R.l+=se.bytesRead,Ne}function G(R){return Ue?Ue.deflateRawSync(R):dt(R)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],X=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function D(R){var V=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(V>>16|V>>8|V)&255}for(var Q=typeof Uint8Array<"u",Z=Q?new Uint8Array(256):[],be=0;be<256;++be)Z[be]=D(be);function U(R,V){var q=Z[R&255];return V<=8?q>>>8-V:(q=q<<8|Z[R>>8&255],V<=16?q>>>16-V:(q=q<<8|Z[R>>16&255],q>>>24-V))}function ze(R,V){var q=V&7,se=V>>>3;return(R[se]|(q<=6?0:R[se+1]<<8))>>>q&3}function re(R,V){var q=V&7,se=V>>>3;return(R[se]|(q<=5?0:R[se+1]<<8))>>>q&7}function J(R,V){var q=V&7,se=V>>>3;return(R[se]|(q<=4?0:R[se+1]<<8))>>>q&15}function Re(R,V){var q=V&7,se=V>>>3;return(R[se]|(q<=3?0:R[se+1]<<8))>>>q&31}function ke(R,V){var q=V&7,se=V>>>3;return(R[se]|(q<=1?0:R[se+1]<<8))>>>q&127}function Be(R,V,q){var se=V&7,Ne=V>>>3,Me=(1<<q)-1,Ke=R[Ne]>>>se;return q<8-se||(Ke|=R[Ne+1]<<8-se,q<16-se)||(Ke|=R[Ne+2]<<16-se,q<24-se)||(Ke|=R[Ne+3]<<24-se),Ke&Me}function Ye(R,V,q){var se=V&7,Ne=V>>>3;return se<=5?R[Ne]|=(q&7)<<se:(R[Ne]|=q<<se&255,R[Ne+1]=(q&7)>>8-se),V+3}function ot(R,V,q){var se=V&7,Ne=V>>>3;return q=(q&1)<<se,R[Ne]|=q,V+1}function Ct(R,V,q){var se=V&7,Ne=V>>>3;return q<<=se,R[Ne]|=q&255,q>>>=8,R[Ne+1]=q,V+8}function jt(R,V,q){var se=V&7,Ne=V>>>3;return q<<=se,R[Ne]|=q&255,q>>>=8,R[Ne+1]=q&255,R[Ne+2]=q>>>8,V+16}function Ot(R,V){var q=R.length,se=2*q>V?2*q:V+5,Ne=0;if(q>=V)return R;if(ra){var Me=dH(se);if(R.copy)R.copy(Me);else for(;Ne<R.length;++Ne)Me[Ne]=R[Ne];return Me}else if(Q){var Ke=new Uint8Array(se);if(Ke.set)Ke.set(R);else for(;Ne<q;++Ne)Ke[Ne]=R[Ne];return Ke}return R.length=se,R}function Tt(R){for(var V=new Array(R),q=0;q<R;++q)V[q]=0;return V}function Qt(R,V,q){var se=1,Ne=0,Me=0,Ke=0,Pe=0,rt=R.length,lt=Q?new Uint16Array(32):Tt(32);for(Me=0;Me<32;++Me)lt[Me]=0;for(Me=rt;Me<q;++Me)R[Me]=0;rt=R.length;var ht=Q?new Uint16Array(rt):Tt(rt);for(Me=0;Me<rt;++Me)lt[Ne=R[Me]]++,se<Ne&&(se=Ne),ht[Me]=0;for(lt[0]=0,Me=1;Me<=se;++Me)lt[Me+16]=Pe=Pe+lt[Me-1]<<1;for(Me=0;Me<rt;++Me)Pe=R[Me],Pe!=0&&(ht[Me]=lt[Pe+16]++);var kt=0;for(Me=0;Me<rt;++Me)if(kt=R[Me],kt!=0)for(Pe=U(ht[Me],se)>>se-kt,Ke=(1<<se+4-kt)-1;Ke>=0;--Ke)V[Pe|Ke<<kt]=kt&15|Me<<4;return se}var Ft=Q?new Uint16Array(512):Tt(512),Qe=Q?new Uint16Array(32):Tt(32);if(!Q){for(var De=0;De<512;++De)Ft[De]=0;for(De=0;De<32;++De)Qe[De]=0}(function(){for(var R=[],V=0;V<32;V++)R.push(5);Qt(R,Qe,32);var q=[];for(V=0;V<=143;V++)q.push(8);for(;V<=255;V++)q.push(9);for(;V<=279;V++)q.push(7);for(;V<=287;V++)q.push(8);Qt(q,Ft,288)})();var Je=function(){for(var V=Q?new Uint8Array(32768):[],q=0,se=0;q<X.length-1;++q)for(;se<X[q+1];++se)V[se]=q;for(;se<32768;++se)V[se]=29;var Ne=Q?new Uint8Array(259):[];for(q=0,se=0;q<W.length-1;++q)for(;se<W[q+1];++se)Ne[se]=q;function Me(Pe,rt){for(var lt=0;lt<Pe.length;){var ht=Math.min(65535,Pe.length-lt),kt=lt+ht==Pe.length;for(rt.write_shift(1,+kt),rt.write_shift(2,ht),rt.write_shift(2,~ht&65535);ht-- >0;)rt[rt.l++]=Pe[lt++]}return rt.l}function Ke(Pe,rt){for(var lt=0,ht=0,kt=Q?new Uint16Array(32768):[];ht<Pe.length;){var de=Math.min(65535,Pe.length-ht);if(de<10){for(lt=Ye(rt,lt,+(ht+de==Pe.length)),lt&7&&(lt+=8-(lt&7)),rt.l=lt/8|0,rt.write_shift(2,de),rt.write_shift(2,~de&65535);de-- >0;)rt[rt.l++]=Pe[ht++];lt=rt.l*8;continue}lt=Ye(rt,lt,+(ht+de==Pe.length)+2);for(var qe=0;de-- >0;){var at=Pe[ht];qe=(qe<<5^at)&32767;var st=-1,Nt=0;if((st=kt[qe])&&(st|=ht&-32768,st>ht&&(st-=32768),st<ht))for(;Pe[st+Nt]==Pe[ht+Nt]&&Nt<250;)++Nt;if(Nt>2){at=Ne[Nt],at<=22?lt=Ct(rt,lt,Z[at+1]>>1)-1:(Ct(rt,lt,3),lt+=5,Ct(rt,lt,Z[at-23]>>5),lt+=3);var Rt=at<8?0:at-4>>2;Rt>0&&(jt(rt,lt,Nt-W[at]),lt+=Rt),at=V[ht-st],lt=Ct(rt,lt,Z[at]>>3),lt-=3;var nr=at<4?0:at-2>>1;nr>0&&(jt(rt,lt,ht-st-X[at]),lt+=nr);for(var _r=0;_r<Nt;++_r)kt[qe]=ht&32767,qe=(qe<<5^Pe[ht])&32767,++ht;de-=Nt-1}else at<=143?at=at+48:lt=ot(rt,lt,1),lt=Ct(rt,lt,Z[at]),kt[qe]=ht&32767,++ht}lt=Ct(rt,lt,0)-1}return rt.l=(lt+7)/8|0,rt.l}return function(rt,lt){return rt.length<8?Me(rt,lt):Ke(rt,lt)}}();function dt(R){var V=cr(50+Math.floor(R.length*1.1)),q=Je(R,V);return V.slice(0,q)}var ce=Q?new Uint16Array(32768):Tt(32768),we=Q?new Uint16Array(32768):Tt(32768),ue=Q?new Uint16Array(128):Tt(128),ne=1,Ve=1;function it(R,V){var q=Re(R,V)+257;V+=5;var se=Re(R,V)+1;V+=5;var Ne=J(R,V)+4;V+=4;for(var Me=0,Ke=Q?new Uint8Array(19):Tt(19),Pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],rt=1,lt=Q?new Uint8Array(8):Tt(8),ht=Q?new Uint8Array(8):Tt(8),kt=Ke.length,de=0;de<Ne;++de)Ke[L[de]]=Me=re(R,V),rt<Me&&(rt=Me),lt[Me]++,V+=3;var qe=0;for(lt[0]=0,de=1;de<=rt;++de)ht[de]=qe=qe+lt[de-1]<<1;for(de=0;de<kt;++de)(qe=Ke[de])!=0&&(Pe[de]=ht[qe]++);var at=0;for(de=0;de<kt;++de)if(at=Ke[de],at!=0){qe=Z[Pe[de]]>>8-at;for(var st=(1<<7-at)-1;st>=0;--st)ue[qe|st<<at]=at&7|de<<3}var Nt=[];for(rt=1;Nt.length<q+se;)switch(qe=ue[ke(R,V)],V+=qe&7,qe>>>=3){case 16:for(Me=3+ze(R,V),V+=2,qe=Nt[Nt.length-1];Me-- >0;)Nt.push(qe);break;case 17:for(Me=3+re(R,V),V+=3;Me-- >0;)Nt.push(0);break;case 18:for(Me=11+ke(R,V),V+=7;Me-- >0;)Nt.push(0);break;default:Nt.push(qe),rt<qe&&(rt=qe);break}var Rt=Nt.slice(0,q),nr=Nt.slice(q);for(de=q;de<286;++de)Rt[de]=0;for(de=se;de<30;++de)nr[de]=0;return ne=Qt(Rt,ce,286),Ve=Qt(nr,we,30),V}function vt(R,V){if(R[0]==3&&!(R[1]&3))return[jm(V),2];for(var q=0,se=0,Ne=dH(V||1<<18),Me=0,Ke=Ne.length>>>0,Pe=0,rt=0;!(se&1);){if(se=re(R,q),q+=3,se>>>1)se>>1==1?(Pe=9,rt=5):(q=it(R,q),Pe=ne,rt=Ve);else{q&7&&(q+=8-(q&7));var lt=R[q>>>3]|R[(q>>>3)+1]<<8;if(q+=32,lt>0)for(!V&&Ke<Me+lt&&(Ne=Ot(Ne,Me+lt),Ke=Ne.length);lt-- >0;)Ne[Me++]=R[q>>>3],q+=8;continue}for(;;){!V&&Ke<Me+32767&&(Ne=Ot(Ne,Me+32767),Ke=Ne.length);var ht=Be(R,q,Pe),kt=se>>>1==1?Ft[ht]:ce[ht];if(q+=kt&15,kt>>>=4,!(kt>>>8&255))Ne[Me++]=kt;else{if(kt==256)break;kt-=257;var de=kt<8?0:kt-4>>2;de>5&&(de=0);var qe=Me+W[kt];de>0&&(qe+=Be(R,q,de),q+=de),ht=Be(R,q,rt),kt=se>>>1==1?Qe[ht]:we[ht],q+=kt&15,kt>>>=4;var at=kt<4?0:kt-2>>1,st=X[kt];for(at>0&&(st+=Be(R,q,at),q+=at),!V&&Ke<qe&&(Ne=Ot(Ne,qe+100),Ke=Ne.length);Me<qe;)Ne[Me]=Ne[Me-st],++Me}}}return V?[Ne,q+7>>>3]:[Ne.slice(0,Me),q+7>>>3]}function me(R,V){var q=R.slice(R.l||0),se=vt(q,V);return R.l+=se[1],se[0]}function Ee(R,V){if(R)typeof console<"u"&&console.error(V);else throw new Error(V)}function ye(R,V){var q=R;El(q,0);var se=[],Ne=[],Me={FileIndex:se,FullPaths:Ne};C(Me,{root:V.root});for(var Ke=q.length-4;(q[Ke]!=80||q[Ke+1]!=75||q[Ke+2]!=5||q[Ke+3]!=6)&&Ke>=0;)--Ke;q.l=Ke+4,q.l+=4;var Pe=q.read_shift(2);q.l+=6;var rt=q.read_shift(4);for(q.l=rt,Ke=0;Ke<Pe;++Ke){q.l+=20;var lt=q.read_shift(4),ht=q.read_shift(4),kt=q.read_shift(2),de=q.read_shift(2),qe=q.read_shift(2);q.l+=8;var at=q.read_shift(4),st=l(q.slice(q.l+kt,q.l+kt+de));q.l+=kt+de+qe;var Nt=q.l;q.l=at+4,We(q,lt,ht,Me,st),q.l=Nt}return Me}function We(R,V,q,se,Ne){R.l+=2;var Me=R.read_shift(2),Ke=R.read_shift(2),Pe=o(R);if(Me&8257)throw new Error("Unsupported ZIP encryption");for(var rt=R.read_shift(4),lt=R.read_shift(4),ht=R.read_shift(4),kt=R.read_shift(2),de=R.read_shift(2),qe="",at=0;at<kt;++at)qe+=String.fromCharCode(R[R.l++]);if(de){var st=l(R.slice(R.l,R.l+de));(st[21589]||{}).mt&&(Pe=st[21589].mt),((Ne||{})[21589]||{}).mt&&(Pe=Ne[21589].mt)}R.l+=de;var Nt=R.slice(R.l,R.l+lt);switch(Ke){case 8:Nt=H(R,ht);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ke)}var Rt=!1;Me&8&&(rt=R.read_shift(4),rt==134695760&&(rt=R.read_shift(4),Rt=!0),lt=R.read_shift(4),ht=R.read_shift(4)),lt!=V&&Ee(Rt,"Bad compressed size: "+V+" != "+lt),ht!=q&&Ee(Rt,"Bad uncompressed size: "+q+" != "+ht),He(se,qe,Nt,{unsafe:!0,mt:Pe})}function ge(R,V){var q=V||{},se=[],Ne=[],Me=cr(1),Ke=q.compression?8:0,Pe=0,rt=0,lt=0,ht=0,kt=0,de=R.FullPaths[0],qe=de,at=R.FileIndex[0],st=[],Nt=0;for(rt=1;rt<R.FullPaths.length;++rt)if(qe=R.FullPaths[rt].slice(de.length),at=R.FileIndex[rt],!(!at.size||!at.content||qe=="Sh33tJ5")){var Rt=ht,nr=cr(qe.length);for(lt=0;lt<qe.length;++lt)nr.write_shift(1,qe.charCodeAt(lt)&127);nr=nr.slice(0,nr.l),st[kt]=v3e.buf(at.content,0);var _r=at.content;Ke==8&&(_r=G(_r)),Me=cr(30),Me.write_shift(4,67324752),Me.write_shift(2,20),Me.write_shift(2,Pe),Me.write_shift(2,Ke),at.mt?s(Me,at.mt):Me.write_shift(4,0),Me.write_shift(-4,st[kt]),Me.write_shift(4,_r.length),Me.write_shift(4,at.content.length),Me.write_shift(2,nr.length),Me.write_shift(2,0),ht+=Me.length,se.push(Me),ht+=nr.length,se.push(nr),ht+=_r.length,se.push(_r),Me=cr(46),Me.write_shift(4,33639248),Me.write_shift(2,0),Me.write_shift(2,20),Me.write_shift(2,Pe),Me.write_shift(2,Ke),Me.write_shift(4,0),Me.write_shift(-4,st[kt]),Me.write_shift(4,_r.length),Me.write_shift(4,at.content.length),Me.write_shift(2,nr.length),Me.write_shift(2,0),Me.write_shift(2,0),Me.write_shift(2,0),Me.write_shift(2,0),Me.write_shift(4,0),Me.write_shift(4,Rt),Nt+=Me.l,Ne.push(Me),Nt+=nr.length,Ne.push(nr),++kt}return Me=cr(22),Me.write_shift(4,101010256),Me.write_shift(2,0),Me.write_shift(2,0),Me.write_shift(2,kt),Me.write_shift(2,kt),Me.write_shift(4,Nt),Me.write_shift(4,ht),Me.write_shift(2,0),Zo([Zo(se),Zo(Ne),Me])}var Ie={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function xt(R,V){if(R.ctype)return R.ctype;var q=R.name||"",se=q.match(/\.([^\.]+)$/);return se&&Ie[se[1]]||V&&(se=(q=V).match(/[\.\\]([^\.\\])+$/),se&&Ie[se[1]])?Ie[se[1]]:"application/octet-stream"}function Pt(R){for(var V=B2(R),q=[],se=0;se<V.length;se+=76)q.push(V.slice(se,se+76));return q.join(`\r
`)+`\r
`}function It(R){var V=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(lt){var ht=lt.charCodeAt(0).toString(16).toUpperCase();return"="+(ht.length==1?"0"+ht:ht)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var q=[],se=V.split(`\r
`),Ne=0;Ne<se.length;++Ne){var Me=se[Ne];if(Me.length==0){q.push("");continue}for(var Ke=0;Ke<Me.length;){var Pe=76,rt=Me.slice(Ke,Ke+Pe);rt.charAt(Pe-1)=="="?Pe--:rt.charAt(Pe-2)=="="?Pe-=2:rt.charAt(Pe-3)=="="&&(Pe-=3),rt=Me.slice(Ke,Ke+Pe),Ke+=Pe,Ke<Me.length&&(rt+="="),q.push(rt)}}return q.join(`\r
`)}function Ut(R){for(var V=[],q=0;q<R.length;++q){for(var se=R[q];q<=R.length&&se.charAt(se.length-1)=="=";)se=se.slice(0,se.length-1)+R[++q];V.push(se)}for(var Ne=0;Ne<V.length;++Ne)V[Ne]=V[Ne].replace(/[=][0-9A-Fa-f]{2}/g,function(Me){return String.fromCharCode(parseInt(Me.slice(1),16))});return Tu(V.join(`\r
`))}function $t(R,V,q){for(var se="",Ne="",Me="",Ke,Pe=0;Pe<10;++Pe){var rt=V[Pe];if(!rt||rt.match(/^\s*$/))break;var lt=rt.match(/^(.*?):\s*([^\s].*)$/);if(lt)switch(lt[1].toLowerCase()){case"content-location":se=lt[2].trim();break;case"content-type":Me=lt[2].trim();break;case"content-transfer-encoding":Ne=lt[2].trim();break}}switch(++Pe,Ne.toLowerCase()){case"base64":Ke=Tu($u(V.slice(Pe).join("")));break;case"quoted-printable":Ke=Ut(V.slice(Pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Ne)}var ht=He(R,se.slice(q.length),Ke,{unsafe:!0});Me&&(ht.ctype=Me)}function Le(R,V){if(te(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var q=V&&V.root||"",se=(ra&&Buffer.isBuffer(R)?R.toString("binary"):te(R)).split(`\r
`),Ne=0,Me="";for(Ne=0;Ne<se.length;++Ne)if(Me=se[Ne],!!/^Content-Location:/i.test(Me)&&(Me=Me.slice(Me.indexOf("file")),q||(q=Me.slice(0,Me.lastIndexOf("/")+1)),Me.slice(0,q.length)!=q))for(;q.length>0&&(q=q.slice(0,q.length-1),q=q.slice(0,q.lastIndexOf("/")+1),Me.slice(0,q.length)!=q););var Ke=(se[1]||"").match(/boundary="(.*?)"/);if(!Ke)throw new Error("MAD cannot find boundary");var Pe="--"+(Ke[1]||""),rt=[],lt=[],ht={FileIndex:rt,FullPaths:lt};C(ht);var kt,de=0;for(Ne=0;Ne<se.length;++Ne){var qe=se[Ne];qe!==Pe&&qe!==Pe+"--"||(de++&&$t(ht,se.slice(kt,Ne),q),kt=Ne)}return ht}function Ce(R,V){var q=V||{},se=q.boundary||"SheetJS";se="------="+se;for(var Ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+se.slice(2)+'"',"","",""],Me=R.FullPaths[0],Ke=Me,Pe=R.FileIndex[0],rt=1;rt<R.FullPaths.length;++rt)if(Ke=R.FullPaths[rt].slice(Me.length),Pe=R.FileIndex[rt],!(!Pe.size||!Pe.content||Ke=="Sh33tJ5")){Ke=Ke.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Nt){return"_x"+Nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Nt){return"_u"+Nt.charCodeAt(0).toString(16)+"_"});for(var lt=Pe.content,ht=ra&&Buffer.isBuffer(lt)?lt.toString("binary"):te(lt),kt=0,de=Math.min(1024,ht.length),qe=0,at=0;at<=de;++at)(qe=ht.charCodeAt(at))>=32&&qe<128&&++kt;var st=kt>=de*4/5;Ne.push(se),Ne.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+Ke),Ne.push("Content-Transfer-Encoding: "+(st?"quoted-printable":"base64")),Ne.push("Content-Type: "+xt(Pe,Ke)),Ne.push(""),Ne.push(st?It(ht):Pt(ht))}return Ne.push(se+`--\r
`),Ne.join(`\r
`)}function pe(R){var V={};return C(V,R),V}function He(R,V,q,se){var Ne=se&&se.unsafe;Ne||C(R);var Me=!Ne&&En.find(R,V);if(!Me){var Ke=R.FullPaths[0];V.slice(0,Ke.length)==Ke?Ke=V:(Ke.slice(-1)!="/"&&(Ke+="/"),Ke=(Ke+V).replace("//","/")),Me={name:a(V),type:2},R.FileIndex.push(Me),R.FullPaths.push(Ke),Ne||En.utils.cfb_gc(R)}return Me.content=q,Me.size=q?q.length:0,se&&(se.CLSID&&(Me.clsid=se.CLSID),se.mt&&(Me.mt=se.mt),se.ct&&(Me.ct=se.ct)),Me}function he(R,V){C(R);var q=En.find(R,V);if(q){for(var se=0;se<R.FileIndex.length;++se)if(R.FileIndex[se]==q)return R.FileIndex.splice(se,1),R.FullPaths.splice(se,1),!0}return!1}function ee(R,V,q){C(R);var se=En.find(R,V);if(se){for(var Ne=0;Ne<R.FileIndex.length;++Ne)if(R.FileIndex[Ne]==se)return R.FileIndex[Ne].name=a(q),R.FullPaths[Ne]=q,!0}return!1}function _e(R){E(R,!0)}return e.find=k,e.read=I,e.parse=d,e.write=Te,e.writeFile=Ae,e.utils={cfb_new:pe,cfb_add:He,cfb_del:he,cfb_mov:ee,cfb_gc:_e,ReadShift:kb,CheckField:Kne,prep_blob:El,bconcat:Zo,use_zlib:O,_deflateRaw:dt,_inflateRaw:me,consts:ie},e}();function y3e(t){return typeof t=="string"?lP(t):Array.isArray(t)?K4e(t):t}function Lw(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=lP(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?eh(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([y3e(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=Hm(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function b3e(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ti(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function vH(t,e){for(var r=[],n=Ti(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function uP(t){for(var e=[],r=Ti(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function dP(t){for(var e=[],r=Ti(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function w3e(t){for(var e=[],r=Ti(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var GS=new Date(1899,11,30,0,0,0);function Do(t,e){var r=t.getTime(),n=GS.getTime()+(t.getTimezoneOffset()-GS.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var _ne=new Date,N3e=GS.getTime()+(_ne.getTimezoneOffset()-GS.getTimezoneOffset())*6e4,yH=_ne.getTimezoneOffset();function fP(t){var e=new Date;return e.setTime(t*24*60*60*1e3+N3e),e.getTimezoneOffset()!==yH&&e.setTime(e.getTime()+(e.getTimezoneOffset()-yH)*6e4),e}function C3e(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[s],10)}return e}var bH=new Date("2017-02-19T19:06:09.000Z"),Ene=isNaN(bH.getFullYear())?new Date("2/19/17"):bH,_3e=Ene.getFullYear()==2017;function Ds(t,e){var r=new Date(t);if(_3e)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Ene.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function gg(t,e){if(ra&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return eh(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return eh(hne(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return eh(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return eh(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function Rs(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Rs(t[r]));return e}function Si(t,e){for(var r="";r.length<e;)r+=t;return r}function xf(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var E3e=["january","february","march","april","may","june","july","august","september","october","november","december"];function Qv(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&E3e.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var S3e=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(a),o.push(s[l]);return o}}();function Sne(t){return t?t.content&&t.type?gg(t.content,!0):t.data?Xy(t.data):t.asNodeBuffer&&ra?Xy(t.asNodeBuffer().toString("binary")):t.asBinary?Xy(t.asBinary()):t._data&&t._data.getContent?Xy(gg(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function Ine(t){if(!t)return null;if(t.data)return cH(t.data);if(t.asNodeBuffer&&ra)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?cH(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function I3e(t){return t&&t.name.slice(-4)===".bin"?Ine(t):Sne(t)}function gd(t,e){for(var r=t.FullPaths||Ti(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function nR(t,e){var r=gd(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function no(t,e,r){if(!r)return I3e(nR(t,e));if(!e)return null;try{return no(t,e)}catch{return null}}function Bu(t,e,r){if(!r)return Sne(nR(t,e));if(!e)return null;try{return Bu(t,e)}catch{return null}}function j3e(t,e,r){return Ine(nR(t,e))}function wH(t){for(var e=t.FullPaths||Ti(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Zn(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return ra?n=RA(r):n=q4e(r),En.utils.cfb_add(t,e,n)}En.utils.cfb_add(t,e,r)}else t.file(e,r)}function aR(){return En.utils.cfb_new()}function jne(t,e){switch(e.type){case"base64":return En.read(t,{type:"base64"});case"binary":return En.read(t,{type:"binary"});case"buffer":case"array":return En.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Jy(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Yi=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,P3e=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,NH=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,T3e=/<[^>]*>/g,uc=Yi.match(NH)?NH:T3e,B3e=/<\w*:/,k3e=/<(\/?)\w+:/;function Dn(t,e,r){for(var n={},a=0,s=0;a!==t.length&&!((s=t.charCodeAt(a))===32||s===10||s===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var o=t.match(P3e),l=0,c="",u=0,d="",f="",A=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(A=(a=f.charCodeAt(s+1))==34||a==39?1:0,c=f.slice(s+1+A,f.length-A),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var h=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[h]&&d.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function xh(t){return t.replace(k3e,"<$1")}var Pne={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},sR=uP(Pne),_a=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(t,function(l,c){return Pne[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(e,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,o)+r(a.slice(o+3))}}(),iR=/[&<>'"]/g,F3e=/[\u0000-\u0008\u000b-\u001f]/g;function rs(t){var e=t+"";return e.replace(iR,function(r){return sR[r]}).replace(F3e,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function CH(t){return rs(t).replace(/ /g,"_x0020_")}var Tne=/[\u0000-\u001f]/g;function oR(t){var e=t+"";return e.replace(iR,function(r){return sR[r]}).replace(/\n/g,"<br/>").replace(Tne,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function O3e(t){var e=t+"";return e.replace(iR,function(r){return sR[r]}).replace(Tne,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var _H=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function D3e(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Bs(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function P5(t){for(var e="",r=0,n=0,a=0,s=0,o=0,l=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}o=t.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function EH(t){var e=jm(2*t.length),r,n,a=1,s=0,o=0,l;for(n=0;n<t.length;n+=a)a=1,(l=t.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function SH(t){return RA(t,"binary").toString("utf8")}var HC="foo bar baz",cs=ra&&(SH(HC)==P5(HC)&&SH||EH(HC)==P5(HC)&&EH)||P5,eh=ra?function(t){return RA(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},F2=function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Bne=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}}(),R3e=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),M3e=/<\/?(?:vt:)?variant>/g,L3e=/<(?:vt:)([^>]*)>([\s\S]*)</;function IH(t,e){var r=Dn(t),n=t.match(R3e(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var o=s.replace(M3e,"").match(L3e);o&&a.push({v:cs(o[2]),t:o[1]})}),a}var kne=/(^\s|\s$|\n)/;function Il(t,e){return"<"+t+(e.match(kne)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function O2(t){return Ti(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Gr(t,e,r){return"<"+t+(r!=null?O2(r):"")+(e!=null?(e.match(kne)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Jk(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function U3e(t,e){switch(typeof t){case"string":var r=Gr("vt:lpwstr",rs(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Gr((t|0)==t?"vt:i4":"vt:r8",rs(String(t)));case"boolean":return Gr("vt:bool",t?"true":"false")}if(t instanceof Date)return Gr("vt:filetime",Jk(t));throw new Error("Unable to serialize "+t)}function lR(t){if(ra&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return cs(Hm(eR(t)));throw new Error("Bad input format: expected Buffer or string")}var D2=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,To={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ug=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ju={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Q3e(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,s=5;s>=0;--s)a=a*256+t[e+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function V3e(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,s=0,o=n?-e:e;isFinite(o)?o==0?a=s=0:(a=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(e)?26985:0);for(var l=0;l<=5;++l,s/=256)t[r+l]=s&255;t[r+6]=(a&15)<<4|s&15,t[r+7]=a>>4|n}var jH=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,s=t[0][n].length;a<s;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},PH=ra?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:RA(e)})):jH(t)}:jH,TH=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(Jh(t,a)));return n.join("").replace(Bc,"")},cR=ra?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Bc,""):TH(t,e,r)}:TH,BH=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},Fne=ra?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):BH(t,e,r)}:BH,kH=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(Ox(t,a)));return n.join("")},Uw=ra?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):kH(e,r,n)}:kH,One=function(t,e){var r=Pu(t,e);return r>0?Uw(t,e+4,e+4+r-1):""},Dne=One,Rne=function(t,e){var r=Pu(t,e);return r>0?Uw(t,e+4,e+4+r-1):""},Mne=Rne,Lne=function(t,e){var r=2*Pu(t,e);return r>0?Uw(t,e+4,e+4+r-1):""},Une=Lne,Qne=function(e,r){var n=Pu(e,r);return n>0?cR(e,r+4,r+4+n):""},Vne=Qne,Hne=function(t,e){var r=Pu(t,e);return r>0?Uw(t,e+4,e+4+r):""},$ne=Hne,Gne=function(t,e){return Q3e(t,e)},KS=Gne,uR=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};ra&&(Dne=function(e,r){if(!Buffer.isBuffer(e))return One(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Mne=function(e,r){if(!Buffer.isBuffer(e))return Rne(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Une=function(e,r){if(!Buffer.isBuffer(e))return Lne(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Vne=function(e,r){if(!Buffer.isBuffer(e))return Qne(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},$ne=function(e,r){if(!Buffer.isBuffer(e))return Hne(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},KS=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Gne(e,r)},uR=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ox=function(t,e){return t[e]},Jh=function(t,e){return t[e+1]*256+t[e]},H3e=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Pu=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Np=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},$3e=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function kb(t,e){var r="",n,a,s=[],o,l,c,u;switch(e){case"dbcs":if(u=this.l,ra&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Jh(this,u)),u+=2;t*=2;break;case"utf8":r=Uw(this,this.l,this.l+t);break;case"utf16le":t*=2,r=cR(this,this.l,this.l+t);break;case"wstr":return kb.call(this,t,"dbcs");case"lpstr-ansi":r=Dne(this,this.l),t=4+Pu(this,this.l);break;case"lpstr-cp":r=Mne(this,this.l),t=4+Pu(this,this.l);break;case"lpwstr":r=Une(this,this.l),t=4+2*Pu(this,this.l);break;case"lpp4":t=4+Pu(this,this.l),r=Vne(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Pu(this,this.l),r=$ne(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Ox(this,this.l+t++))!==0;)s.push(VC(o));r=s.join("");break;case"_wstr":for(t=0,r="";(o=Jh(this,this.l+t))!==0;)s.push(VC(o)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ox(this,u),this.l=u+1,l=kb.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(VC(Jh(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Ox(this,u),this.l=u+1,l=kb.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(VC(Ox(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=Ox(this,this.l),this.l++,n;case 2:return n=(e==="i"?H3e:Jh)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Np:$3e)(this,this.l),this.l+=4,n):(a=Pu(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=KS(this,this.l):a=KS([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=Fne(this,this.l,t);break}}return this.l+=t,r}var G3e=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},K3e=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},q3e=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function z3e(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)q3e(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var o=e.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,G3e(this,e,this.l);break;case 8:if(n=8,r==="f"){V3e(this,e,this.l);break}case 16:break;case-4:n=4,K3e(this,e,this.l);break}return this.l+=n,this}function Kne(t,e){var r=Fne(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function El(t,e){t.l=e,t.read_shift=kb,t.chk=Kne,t.write_shift=z3e}function cc(t,e){t.l+=e}function cr(t){var e=jm(t);return El(e,0),e}function MA(t,e,r){if(t){var n,a,s;El(t,t.l||0);for(var o=t.length,l=0,c=0;t.l<o;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var u=V2[l]||V2[65535];for(n=t.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=t.read_shift(1))&127)<<7*a;c=t.l+s;var d=u.f&&u.f(t,s,r);if(t.l=c,e(d,u,l))return}}}function lu(){var t=[],e=ra?256:2048,r=function(u){var d=cr(u);return El(d,0),d},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,e)))},o=function(){return a(),Zo(t)},l=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:l,end:o,_bufs:t}}function Nr(t,e,r,n){var a=+e,s;if(!isNaN(a)){n||(n=V2[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=t.next(s);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&uR(r)&&t.push(r)}}function Fb(t,e,r){var n=Rs(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function FH(t,e,r){var n=Rs(t);return n.s=Fb(n.s,e.s,r),n.e=Fb(n.e,e.s,r),n}function Ob(t,e){if(t.cRel&&t.c<0)for(t=Rs(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Rs(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=On(t);return!t.cRel&&t.cRel!=null&&(r=Y3e(r)),!t.rRel&&t.rRel!=null&&(r=W3e(r)),r}function T5(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+ui(t.s.c)+":"+(t.e.cRel?"":"$")+ui(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Wi(t.s.r)+":"+(t.e.rRel?"":"$")+Wi(t.e.r):Ob(t.s,e.biff)+":"+Ob(t.e,e.biff)}function dR(t){return parseInt(X3e(t),10)-1}function Wi(t){return""+(t+1)}function W3e(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function X3e(t){return t.replace(/\$(\d+)$/,"$1")}function fR(t){for(var e=J3e(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function ui(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Y3e(t){return t.replace(/^([A-Z])/,"$$$1")}function J3e(t){return t.replace(/^\$([A-Z])/,"$1")}function Z3e(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function di(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function On(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function cu(t){var e=t.indexOf(":");return e==-1?{s:di(t),e:di(t)}:{s:di(t.slice(0,e)),e:di(t.slice(e+1))}}function Xn(t,e){return typeof e>"u"||typeof e=="number"?Xn(t.s,t.e):(typeof t!="string"&&(t=On(t)),typeof e!="string"&&(e=On(e)),t==e?t:t+":"+e)}function Ea(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=t.length;for(r=0;n<s&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<s&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===s||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=s&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function OH(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Dd(t.z,r?Do(e):e)}catch{}try{return t.w=Dd((t.XF||{}).numFmtId||(r?14:0),r?Do(e):e)}catch{return""+e}}function wA(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?LA[t.v]||t.v:e==null?OH(t,t.v):OH(t,e))}function $m(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function qne(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,s=t||(a?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?di(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Ea(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var A=0;A!=e[f].length;++A)if(!(typeof e[f][A]>"u")){var h={v:e[f][A]},m=o+f,p=l+A;if(u.s.r>m&&(u.s.r=m),u.s.c>p&&(u.s.c=p),u.e.r<m&&(u.e.r=m),u.e.c<p&&(u.e.c=p),e[f][A]&&typeof e[f][A]=="object"&&!Array.isArray(e[f][A])&&!(e[f][A]instanceof Date))h=e[f][A];else if(Array.isArray(h.v)&&(h.f=e[f][A][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Fn[14],n.cellDates?(h.t="d",h.w=Dd(h.z,Do(h.v))):(h.t="n",h.v=Do(h.v),h.w=Dd(h.z,h.v))):h.t="s";if(a)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(h.z=s[m][p].z),s[m][p]=h;else{var x=On({c:p,r:m});s[x]&&s[x].z&&(h.z=s[x].z),s[x]=h}}}return u.s.c<1e7&&(s["!ref"]=Xn(u)),s}function w1(t,e){return qne(null,t,e)}function e5e(t){return t.read_shift(4,"i")}function vf(t,e){return e||(e=cr(4)),e.write_shift(4,t),e}function ic(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function el(t,e){var r=!1;return e==null&&(r=!0,e=cr(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function t5e(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function r5e(t,e){return e||(e=cr(4)),e.write_shift(2,0),e.write_shift(2,0),e}function hR(t,e){var r=t.l,n=t.read_shift(1),a=ic(t),s=[],o={t:a,h:a};if(n&1){for(var l=t.read_shift(4),c=0;c!=l;++c)s.push(t5e(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function n5e(t,e){var r=!1;return e==null&&(r=!0,e=cr(15+4*t.t.length)),e.write_shift(1,0),el(t.t,e),r?e.slice(0,e.l):e}var a5e=hR;function s5e(t,e){var r=!1;return e==null&&(r=!0,e=cr(23+4*t.t.length)),e.write_shift(1,1),el(t.t,e),e.write_shift(4,1),r5e({},e),r?e.slice(0,e.l):e}function Vd(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Qg(t,e){return e==null&&(e=cr(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Vg(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Hg(t,e){return e==null&&(e=cr(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var i5e=ic,zne=el;function AR(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function qS(t,e){var r=!1;return e==null&&(r=!0,e=cr(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var o5e=ic,Zk=AR,mR=qS;function pR(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?KS([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Np(e,0)>>2;return r?a/100:a}function Wne(t,e){e==null&&(e=cr(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Xne(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function l5e(t,e){return e||(e=cr(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var $g=Xne,N1=l5e;function ac(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function xg(t,e){return(e||cr(8)).write_shift(8,t,"f")}function c5e(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var u=$p[a];u&&(e.rgb=M2(u));break;case 2:e.rgb=M2([o,l,c]);break;case 3:e.theme=a;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function zS(t,e){if(e||(e=cr(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function u5e(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function d5e(t,e){e||(e=cr(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function Yne(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function f5e(t){return Yne(t,1)}function h5e(t){return Yne(t,2)}var gR=2,Yc=3,$C=11,DH=12,WS=19,GC=64,A5e=65,m5e=71,p5e=4108,g5e=4126,Xo=80,Jne=81,x5e=[Xo,Jne],eF={1:{n:"CodePage",t:gR},2:{n:"Category",t:Xo},3:{n:"PresentationFormat",t:Xo},4:{n:"ByteCount",t:Yc},5:{n:"LineCount",t:Yc},6:{n:"ParagraphCount",t:Yc},7:{n:"SlideCount",t:Yc},8:{n:"NoteCount",t:Yc},9:{n:"HiddenCount",t:Yc},10:{n:"MultimediaClipCount",t:Yc},11:{n:"ScaleCrop",t:$C},12:{n:"HeadingPairs",t:p5e},13:{n:"TitlesOfParts",t:g5e},14:{n:"Manager",t:Xo},15:{n:"Company",t:Xo},16:{n:"LinksUpToDate",t:$C},17:{n:"CharacterCount",t:Yc},19:{n:"SharedDoc",t:$C},22:{n:"HyperlinksChanged",t:$C},23:{n:"AppVersion",t:Yc,p:"version"},24:{n:"DigSig",t:A5e},26:{n:"ContentType",t:Xo},27:{n:"ContentStatus",t:Xo},28:{n:"Language",t:Xo},29:{n:"Version",t:Xo},255:{},2147483648:{n:"Locale",t:WS},2147483651:{n:"Behavior",t:WS},1919054434:{}},tF={1:{n:"CodePage",t:gR},2:{n:"Title",t:Xo},3:{n:"Subject",t:Xo},4:{n:"Author",t:Xo},5:{n:"Keywords",t:Xo},6:{n:"Comments",t:Xo},7:{n:"Template",t:Xo},8:{n:"LastAuthor",t:Xo},9:{n:"RevNumber",t:Xo},10:{n:"EditTime",t:GC},11:{n:"LastPrinted",t:GC},12:{n:"CreatedDate",t:GC},13:{n:"ModifiedDate",t:GC},14:{n:"PageCount",t:Yc},15:{n:"WordCount",t:Yc},16:{n:"CharCount",t:Yc},17:{n:"Thumbnail",t:m5e},18:{n:"Application",t:Xo},19:{n:"DocSecurity",t:Yc},255:{},2147483648:{n:"Locale",t:WS},2147483651:{n:"Behavior",t:WS},1919054434:{}},RH={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},v5e=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function y5e(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var b5e=y5e([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),$p=Rs(b5e),LA={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Zne={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},rF={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},KC={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function xR(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function w5e(t){var e=xR();if(!t||!t.match)return e;var r={};if((t.match(uc)||[]).forEach(function(n){var a=Dn(n);switch(a[0].replace(B3e,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[rF[a.ContentType]]!==void 0&&e[rF[a.ContentType]].push(a.PartName);break}}),e.xmlns!==To.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function eae(t,e){var r=w3e(rF),n=[],a;n[n.length]=Yi,n[n.length]=Gr("Types",null,{xmlns:To.CT,"xmlns:xsd":To.xsd,"xmlns:xsi":To.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Gr("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){t[c]&&t[c].length>0&&(a=t[c][0],n[n.length]=Gr("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:KC[c][e.bookType]||KC[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(u){n[n.length]=Gr("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:KC[c][e.bookType]||KC[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(u){n[n.length]=Gr("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ia={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function R2(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Db(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(uc)||[]).forEach(function(a){var s=Dn(a);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:Jy(s.Target,e);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function xv(t){var e=[Yi,Gr("Relationships",null,{xmlns:To.RELS})];return Ti(t["!id"]).forEach(function(r){e[e.length]=Gr("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ja(t,e,r,n,a,s){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[ia.HLINK,ia.XPATH,ia.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var N5e="application/vnd.oasis.opendocument.spreadsheet";function C5e(t,e){for(var r=lR(t),n,a;n=D2.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Dn(n[0],!1),a.path=="/"&&a.type!==N5e)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function _5e(t){var e=[Yi];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function MH(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function E5e(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function S5e(t){var e=[Yi];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(MH(t[r][0],t[r][1])),e.push(E5e("",t[r][0]));return e.push(MH("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function tae(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+QS.version+"</meta:generator></office:meta></office:document-meta>"}var Td=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],I5e=function(){for(var t=new Array(Td.length),e=0;e<Td.length;++e){var r=Td[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function rae(t){var e={};t=cs(t);for(var r=0;r<Td.length;++r){var n=Td[r],a=t.match(I5e[r]);a!=null&&a.length>0&&(e[n[1]]=_a(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Ds(e[n[1]]))}return e}function B5(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=rs(e),n[n.length]=r?Gr(t,e,r):Il(t,e))}function nae(t,e){var r=e||{},n=[Yi,Gr("cp:coreProperties",null,{"xmlns:cp":To.CORE_PROPS,"xmlns:dc":To.dc,"xmlns:dcterms":To.dcterms,"xmlns:dcmitype":To.dcmitype,"xmlns:xsi":To.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&B5("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Jk(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&B5("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Jk(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Td.length;++s){var o=Td[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&B5(o[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Gp=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],aae=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function sae(t,e,r,n){var a=[];if(typeof t=="string")a=IH(t,n);else for(var s=0;s<t.length;++s)a=a.concat(t[s].map(function(d){return{v:d}}));var o=typeof e=="string"?IH(e,n).map(function(d){return d.v}):e,l=0,c=0;if(o.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function j5e(t,e,r){var n={};return e||(e={}),t=cs(t),Gp.forEach(function(a){var s=(t.match(F2(a[0]))||[])[1];switch(a[2]){case"string":s&&(e[a[1]]=_a(s));break;case"bool":e[a[1]]=s==="true";break;case"raw":var o=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&sae(n.HeadingPairs,n.TitlesOfParts,e,r),e}function iae(t){var e=[],r=Gr;return t||(t={}),t.Application="SheetJS",e[e.length]=Yi,e[e.length]=Gr("Properties",null,{xmlns:To.EXT_PROPS,"xmlns:vt":To.vt}),Gp.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=rs(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+rs(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var P5e=/<[^>]+>[^<]*/g;function T5e(t,e){var r={},n="",a=t.match(P5e);if(a)for(var s=0;s!=a.length;++s){var o=a[s],l=Dn(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=_a(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=_a(d);break;case"bool":r[n]=Bs(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Ds(d);break;case"cy":case"error":r[n]=_a(d);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function oae(t){var e=[Yi,Gr("Properties",null,{xmlns:To.CUST_PROPS,"xmlns:vt":To.vt})];if(!t)return e.join("");var r=1;return Ti(t).forEach(function(a){++r,e[e.length]=Gr("property",U3e(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:rs(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var nF={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},k5;function B5e(t,e,r){k5||(k5=uP(nF)),e=k5[e]||e,t[e]=r}function k5e(t,e){var r=[];return Ti(nF).map(function(n){for(var a=0;a<Td.length;++a)if(Td[a][1]==n)return Td[a];for(a=0;a<Gp.length;++a)if(Gp[a][1]==n)return Gp[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Il(nF[n[1]]||n[1],a))}}),Gr("DocumentProperties",r.join(""),{xmlns:ju.o})}function F5e(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Ti(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<Td.length;++o)if(s==Td[o][1])return;for(o=0;o<Gp.length;++o)if(s==Gp[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=t[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(Gr(CH(s),l,{"dt:dt":c}))}}),e&&Ti(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(Gr(CH(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+ju.o+'">'+a.join("")+"</"+n+">"}function vR(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function O5e(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var o=cr(8);return o.write_shift(4,n),o.write_shift(4,a),o}function lae(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function cae(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function uae(t,e,r){return e===31?cae(t):lae(t,e,r)}function aF(t,e,r){return uae(t,e,r===!1?0:4)}function D5e(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return uae(t,e,0)}function R5e(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Bc,""),t.l-a&2&&(t.l+=2)}return r}function M5e(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Bc,"");return r}function L5e(t){var e=t.l,r=XS(t,Jne);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=XS(t,Yc);return[r,n]}function U5e(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(L5e(t));return r}function LH(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var s=t.read_shift(4),o=t.read_shift(4);n[s]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Bc,"").replace(Yy,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function dae(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function Q5e(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function XS(t,e,r){var n=t.read_shift(2),a,s=r||{};if(t.l+=2,e!==DH&&n!==e&&x5e.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===DH?n:e){case 2:return a=t.read_shift(2,"i"),s.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return lae(t,n,4).replace(Bc,"");case 31:return cae(t);case 64:return vR(t);case 65:return dae(t);case 71:return Q5e(t);case 80:return aF(t,n,!s.raw).replace(Bc,"");case 81:return D5e(t,n).replace(Bc,"");case 4108:return U5e(t);case 4126:case 4127:return n==4127?R5e(t):M5e(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function UH(t,e){var r=cr(4),n=cr(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=cr(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=O5e(e);break;case 31:case 80:for(n=cr(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Zo([r,n])}function QH(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),s=[],o=0,l=0,c=-1,u={};for(o=0;o!=a;++o){var d=t.read_shift(4),f=t.read_shift(4);s[o]=[d,f+r]}s.sort(function(y,b){return y[1]-b[1]});var A={};for(o=0;o!=a;++o){if(t.l!==s[o][1]){var h=!0;if(o>0&&e)switch(e[s[o-1][0]].t){case 2:t.l+2===s[o][1]&&(t.l+=2,h=!1);break;case 80:t.l<=s[o][1]&&(t.l=s[o][1],h=!1);break;case 4108:t.l<=s[o][1]&&(t.l=s[o][1],h=!1);break}if((!e||o==0)&&t.l<=s[o][1]&&(h=!1,t.l=s[o][1]),h)throw new Error("Read Error: Expected address "+s[o][1]+" at "+t.l+" :"+o)}if(e){var m=e[s[o][0]];if(A[m.n]=XS(t,m.t,{raw:!0}),m.p==="version"&&(A[m.n]=String(A[m.n]>>16)+"."+("0000"+String(A[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(A[m.n]){case 0:A[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:hf(l=A[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+A[m.n])}}else if(s[o][0]===1){if(l=A.CodePage=XS(t,gR),hf(l),c!==-1){var p=t.l;t.l=s[c][1],u=LH(t,l),t.l=p}}else if(s[o][0]===0){if(l===0){c=o,t.l=s[o+1][1];continue}u=LH(t,l)}else{var x=u[s[o][0]],v;switch(t[t.l]){case 65:t.l+=4,v=dae(t);break;case 30:t.l+=4,v=aF(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,v=aF(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,v=t.read_shift(4,"i");break;case 19:t.l+=4,v=t.read_shift(4);break;case 5:t.l+=4,v=t.read_shift(8,"f");break;case 11:t.l+=4,v=Li(t,4);break;case 64:t.l+=4,v=Ds(vR(t));break;default:throw new Error("unparsed value: "+t[t.l])}A[x]=v}}return t.l=r+n,A}var fae=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function V5e(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function VH(t,e,r){var n=cr(8),a=[],s=[],o=8,l=0,c=cr(8),u=cr(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),a.push(u),o+=8+c.length,!e){u=cr(8),u.write_shift(4,0),a.unshift(u);var d=[cr(4)];for(d[0].write_shift(4,t.length),l=0;l<t.length;++l){var f=t[l][0];for(c=cr(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Zo(d),s.unshift(c),o+=8+c.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(fae.indexOf(t[l][0])>-1||aae.indexOf(t[l][0])>-1)&&t[l][1]!=null){var A=t[l][1],h=0;if(e){h=+e[t[l][0]];var m=r[h];if(m.p=="version"&&typeof A=="string"){var p=A.split(".");A=(+p[0]<<16)+(+p[1]||0)}c=UH(m.t,A)}else{var x=V5e(A);x==-1&&(x=31,A=String(A)),c=UH(x,A)}s.push(c),u=cr(8),u.write_shift(4,e?h:2+l),a.push(u),o+=8+c.length}var v=8*(s.length+1);for(l=0;l<s.length;++l)a[l].write_shift(4,v),v+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),Zo([n].concat(a).concat(s))}function HH(t,e,r){var n=t.content;if(!n)return{};El(n,0);var a,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==En.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=QH(n,e),A={SystemIdentifier:u};for(var h in f)A[h]=f[h];if(A.FMTID=s,a===1)return A;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=QH(n,null)}catch{}for(h in m)A[h]=m[h];return A.FMTID=[s,o],A}function $H(t,e,r,n,a,s){var o=cr(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,En.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,a?68:48);var c=VH(t,r,n);if(l.push(c),a){var u=VH(a,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Zo(l)}function p0(t,e){return t.read_shift(e),null}function H5e(t,e){e||(e=cr(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function $5e(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Li(t,e){return t.read_shift(e)===1}function Cc(t,e){return e||(e=cr(2)),e.write_shift(2,+!!t),e}function ao(t){return t.read_shift(2,"u")}function xd(t,e){return e||(e=cr(2)),e.write_shift(2,t),e}function hae(t,e){return $5e(t,e,ao)}function G5e(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Aae(t,e,r){return r||(r=cr(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Qw(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?t.read_shift(n,a):"";return o}function K5e(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,s=1+(r&1),o=0,l,c={};a&&(o=t.read_shift(2)),n&&(l=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,u);return a&&(t.l+=4*o),n&&(t.l+=l),c.t=d,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function q5e(t){var e=t.t||"",r=cr(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=cr(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return Zo(a)}function vg(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Vw(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):vg(t,n,r)}function Gg(t,e,r){if(r.biff>5)return Vw(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function mae(t,e,r){return r||(r=cr(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function z5e(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function W5e(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Bc,"");return n&&(t.l+=24),a}function X5e(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(s>>1,"utf16le").replace(Bc,"");return r+o}function Y5e(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return W5e(t);case"0303000000000000c000000000000046":return X5e(t);default:throw new Error("Unsupported Moniker "+r)}}function qC(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Bc,""):"";return r}function GH(t,e){e||(e=cr(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function J5e(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var s,o,l,c,u="",d,f;a&16&&(s=qC(t,r-t.l)),a&128&&(o=qC(t,r-t.l)),(a&257)===257&&(l=qC(t,r-t.l)),(a&257)===1&&(c=Y5e(t,r-t.l)),a&8&&(u=qC(t,r-t.l)),a&32&&(d=t.read_shift(16)),a&64&&(f=vR(t)),t.l=r;var A=o||l||c||"";A&&u&&(A+="#"+u),A||(A="#"+u),a&2&&A.charAt(0)=="/"&&A.charAt(1)!="/"&&(A="file://"+A);var h={Target:A};return d&&(h.guid=d),f&&(h.time=f),s&&(h.Tooltip=s),h}function Z5e(t){var e=cr(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(s==28)n=n.slice(1),GH(n,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var l=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),s&8&&GH(a>-1?n.slice(a+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function pae(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function gae(t,e){var r=pae(t);return r[3]=0,r}function vh(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function yg(t,e,r,n){return n||(n=cr(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function eTe(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function tTe(t,e,r){return e===0?"":Gg(t,e,r)}function rTe(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),s=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[a,s,o]}function xae(t){var e=t.read_shift(2),r=pR(t);return[e,r]}function nTe(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=Qw(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,a}function hP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function vae(t,e){return e||(e=cr(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function yae(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var aTe=yae;function bae(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function sTe(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function iTe(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function ql(t){t.l+=2,t.l+=t.read_shift(2)}var oTe={0:ql,4:ql,5:ql,6:ql,7:iTe,8:ql,9:ql,10:ql,11:ql,12:ql,13:sTe,14:ql,15:ql,16:ql,17:ql,18:ql,19:ql,20:ql,21:bae};function lTe(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(oTe[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function zC(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function yR(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=cr(a);return s.write_shift(2,n),s.write_shift(2,e),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function cTe(t,e){return e===0||t.read_shift(2),1200}function uTe(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=Gg(t,0,r);return t.read_shift(e+n-t.l),a}function dTe(t,e){var r=!e||e.biff==8,n=cr(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function fTe(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function hTe(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=Qw(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:s,name:o}}function ATe(t,e){var r=!e||e.biff>=8?2:1,n=cr(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function mTe(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),s=[],o=0;o!=a&&t.l<r;++o)s.push(K5e(t));return s.Count=n,s.Unique=a,s}function pTe(t,e){var r=cr(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=q5e(t[a]);var s=Zo([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function gTe(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function xTe(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function vTe(t){var e=eTe(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function yTe(t){return t.read_shift(2),t.read_shift(4)}function KH(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function bTe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function wTe(){var t=cr(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function NTe(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function CTe(t){var e=cr(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function _Te(){}function ETe(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Qw(t,0,r),n}function STe(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,s=cr(a);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function ITe(t){var e=vh(t);return e.isst=t.read_shift(4),e}function jTe(t,e,r,n){var a=cr(10);return yg(t,e,n,a),a.write_shift(4,r),a}function PTe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=vh(t);r.biff==2&&t.l++;var s=Vw(t,n-t.l,r);return a.val=s,a}function TTe(t,e,r,n,a){var s=!a||a.biff==8,o=cr(8+ +s+(1+s)*r.length);return yg(t,e,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function BTe(t,e,r){var n=t.read_shift(2),a=Gg(t,0,r);return[n,a]}function kTe(t,e,r,n){var a=r&&r.biff==5;n||(n=cr(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var FTe=Gg;function qH(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,s=t.read_shift(a),o=t.read_shift(a),l=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:s,c:l},e:{r:o,c}}}function OTe(t,e){var r=e.biff==8||!e.biff?4:2,n=cr(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function DTe(t){var e=t.read_shift(2),r=t.read_shift(2),n=xae(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function RTe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),s=[];t.l<r;)s.push(xae(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(s.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:s}}function MTe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(s.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:s}}function LTe(t,e,r,n){var a={},s=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return a.patternType=v5e[l>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function UTe(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=LTe(t,e,n.fStyle,r),n}function zH(t,e,r,n){var a=r&&r.biff==5;n||(n=cr(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function QTe(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function VTe(t){var e=cr(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function WH(t,e,r){var n=vh(t);(r.biff==2||e==9)&&++t.l;var a=G5e(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function HTe(t,e,r,n,a,s){var o=cr(8);return yg(t,e,n,o),Aae(r,s,o),o}function $Te(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=vh(t),a=ac(t);return n.val=a,n}function GTe(t,e,r,n){var a=cr(14);return yg(t,e,n,a),xg(r,a),a}var XH=tTe;function KTe(t,e,r){var n=t.l+e,a=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=vg(t,s),l=[];n>t.l;)l.push(Vw(t));return[s,a,o,l]}function YH(t,e,r){var n=t.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=nTe(t,e-2,r)),s.body=a||t.read_shift(e-2),typeof a=="string"&&(s.Name=a),s}var qTe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function JH(t,e,r){var n=t.l+e,a=t.read_shift(2),s=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=vg(t,o,r);a&32&&(u=qTe[u.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var f=n==t.l||l===0||!(d>0)?[]:lDe(t,d,r,l);return{chKey:s,Name:u,itab:c,rgce:f}}function wae(t,e,r){if(r.biff<8)return zTe(t,e,r);for(var n=[],a=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(rTe(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function zTe(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Qw(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function WTe(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),s=vg(t,n,r),o=vg(t,a,r);return[s,o]}function XTe(t,e,r){var n=yae(t);t.l++;var a=t.read_shift(1);return e-=8,[cDe(t,e,r),a,n]}function ZH(t,e,r){var n=aTe(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,iDe(t,e,r)]}function YTe(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function JTe(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),l=Gg(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},l,o,s]}}function ZTe(t,e,r){return JTe(t,e,r)}function eBe(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(hP(t));return r}function tBe(t){var e=cr(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)vae(t[r],e);return e}function rBe(t,e,r){if(r&&r.biff<8)return aBe(t,e,r);var n=bae(t),a=lTe(t,e-22,n[1]);return{cmo:n,ft:a}}var nBe={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function aBe(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((nBe[n]||cc)(t,e,r)),{cmo:[a,n,s],ft:o}}function sBe(t,e,r){var n=t.l,a="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:o=z5e(t,6,r);var l=t.read_shift(2);t.read_shift(2),ao(t,2);var c=t.read_shift(2);t.l+=c;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var d=t[t.l],f=vg(t,t.lens[u+1]-t.lens[u]-1);if(a+=f,a.length>=(d?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function iBe(t,e){var r=hP(t);t.l+=16;var n=J5e(t,e-24);return[r,n]}function oBe(t){var e=cr(24),r=di(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return Zo([e,Z5e(t[1])])}function lBe(t,e){t.read_shift(2);var r=hP(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Bc,""),[r,n]}function cBe(t){var e=t[1].Tooltip,r=cr(10+2*(e.length+1));r.write_shift(2,2048);var n=di(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function uBe(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=RH[r]||r,r=t.read_shift(2),e[1]=RH[r]||r,e}function dBe(t){return t||(t=cr(4)),t.write_shift(2,1),t.write_shift(2,1),t}function fBe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(gae(t));return r}function hBe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(gae(t));return r}function ABe(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function Nae(t,e,r){if(!r.cellStyles)return cc(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var u={s:a,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function mBe(t,e){var r=cr(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function pBe(t,e){var r={};return e<32||(t.l+=16,r.header=ac(t),r.footer=ac(t),t.l+=2),r}function gBe(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function xBe(t){for(var e=cr(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var vBe=vh,yBe=hae,bBe=Vw;function wBe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function NBe(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=vh(t);++t.l;var a=Gg(t,e-7,r);return n.t="str",n.val=a,n}function CBe(t){var e=vh(t);++t.l;var r=ac(t);return e.t="n",e.val=r,e}function _Be(t,e,r){var n=cr(15);return Kw(n,t,e),n.write_shift(8,r,"f"),n}function EBe(t){var e=vh(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function SBe(t,e,r){var n=cr(9);return Kw(n,t,e),n.write_shift(2,r),n}function IBe(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function jBe(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function PBe(t,e,r){var n=t.l+e,a=vh(t),s=t.read_shift(2),o=vg(t,s,r);return t.l=n,a.t="str",a.val=o,a}var TBe=[2,3,48,49,131,139,140,245],sF=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=uP({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=jm(1);switch(c.type){case"base64":d=Tu($u(l));break;case"binary":d=Tu(l);break;case"buffer":case"array":d=l;break}El(d,0);var f=d.read_shift(1),A=!!(f&136),h=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,A=!0;break;case 49:h=!0,A=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,x=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(x=d.read_shift(2));var v=d.read_shift(2),y=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=t[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var b=[],w={},j=Math.min(d.length,f==2?521:x-10-(h?264:0)),I=m?32:11;d.l<j&&d[d.l]!=13;)switch(w={},w.name=T2.utils.decode(y,d.slice(d.l,d.l+I)).replace(/[\u0000\r\n].*$/g,""),d.l+=I,w.type=String.fromCharCode(d.read_shift(1)),f!=2&&!m&&(w.offset=d.read_shift(4)),w.len=d.read_shift(1),f==2&&(w.offset=d.read_shift(2)),w.dec=d.read_shift(1),w.name.length&&b.push(w),f!=2&&(d.l+=m?13:14),w.type){case"B":(!h||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(d[d.l]!==13&&(d.l=x-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=x;var C=0,S=0;for(u[0]=[],S=0;S!=b.length;++S)u[0][S]=b[S].name;for(;p-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++C]=[],S=0,S=0;S!=b.length;++S){var E=d.slice(d.l,d.l+b[S].len);d.l+=b[S].len,El(E,0);var B=T2.utils.decode(y,E);switch(b[S].type){case"C":B.trim().length&&(u[C][S]=B.replace(/\s+$/,""));break;case"D":B.length===8?u[C][S]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):u[C][S]=B;break;case"F":u[C][S]=parseFloat(B.trim());break;case"+":case"I":u[C][S]=m?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":u[C][S]=!0;break;case"N":case"F":u[C][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!A)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[C][S]="##MEMO##"+(m?parseInt(B.trim(),10):E.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(u[C][S]=+B||0);break;case"@":u[C][S]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":u[C][S]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":u[C][S]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[C][S]=-E.read_shift(-8,"f");break;case"B":if(h&&b[S].len==8){u[C][S]=E.read_shift(8,"f");break}case"G":case"P":E.l+=b[S].len;break;case"0":if(b[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[S].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=b,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=w1(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(l,c){try{return $m(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&hf(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=lu(),f=ZS(l,{header:1,raw:!0,cellDates:!0}),A=f[0],h=f.slice(1),m=l["!cols"]||[],p=0,x=0,v=0,y=1;for(p=0;p<A.length;++p){if(((m[p]||{}).DBF||{}).name){A[p]=m[p].DBF.name,++v;continue}if(A[p]!=null){if(++v,typeof A[p]=="number"&&(A[p]=A[p].toString(10)),typeof A[p]!="string")throw new Error("DBF Invalid column name "+A[p]+" |"+typeof A[p]+"|");if(A.indexOf(A[p])!==p){for(x=0;x<1024;++x)if(A.indexOf(A[p]+"_"+x)==-1){A[p]+="_"+x;break}}}}var b=Ea(l["!ref"]),w=[],j=[],I=[];for(p=0;p<=b.e.c-b.s.c;++p){var C="",S="",E=0,B=[];for(x=0;x<h.length;++x)h[x][p]!=null&&B.push(h[x][p]);if(B.length==0||A[p]==null){w[p]="?";continue}for(x=0;x<B.length;++x){switch(typeof B[x]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=B[x]instanceof Date?"D":"C";break;default:S="C"}E=Math.max(E,String(B[x]).length),C=C&&C!=S?"C":S}E>250&&(E=250),S=((m[p]||{}).DBF||{}).type,S=="C"&&m[p].DBF.len>E&&(E=m[p].DBF.len),C=="B"&&S=="N"&&(C="N",I[p]=m[p].DBF.dec,E=m[p].DBF.len),j[p]=C=="C"||S=="N"?E:s[C]||0,y+=j[p],w[p]=C}var k=d.next(32);for(k.write_shift(4,318902576),k.write_shift(4,h.length),k.write_shift(2,296+32*v),k.write_shift(2,y),p=0;p<4;++p)k.write_shift(4,0);for(k.write_shift(4,0|(+e[fne]||3)<<8),p=0,x=0;p<A.length;++p)if(A[p]!=null){var T=d.next(32),P=(A[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,P,"sbcs"),T.write_shift(1,w[p]=="?"?"C":w[p],"sbcs"),T.write_shift(4,x),T.write_shift(1,j[p]||s[w[p]]||0),T.write_shift(1,I[p]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),x+=j[p]||s[w[p]]||0}var K=d.next(264);for(K.write_shift(4,13),p=0;p<65;++p)K.write_shift(4,0);for(p=0;p<h.length;++p){var le=d.next(y);for(le.write_shift(1,0),x=0;x<A.length;++x)if(A[x]!=null)switch(w[x]){case"L":le.write_shift(1,h[p][x]==null?63:h[p][x]?84:70);break;case"B":le.write_shift(8,h[p][x]||0,"f");break;case"N":var oe="0";for(typeof h[p][x]=="number"&&(oe=h[p][x].toFixed(I[x]||0)),v=0;v<j[x]-oe.length;++v)le.write_shift(1,32);le.write_shift(1,oe,"sbcs");break;case"D":h[p][x]?(le.write_shift(4,("0000"+h[p][x].getFullYear()).slice(-4),"sbcs"),le.write_shift(2,("00"+(h[p][x].getMonth()+1)).slice(-2),"sbcs"),le.write_shift(2,("00"+h[p][x].getDate()).slice(-2),"sbcs")):le.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(h[p][x]!=null?h[p][x]:"").slice(0,j[x]);for(le.write_shift(1,ie,"sbcs"),v=0;v<j[x]-ie.length;++v)le.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),Cae=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ti(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(A,h){var m=t[h];return typeof m=="number"?uH(m):m},n=function(A,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?A:uH(p)};t["|"]=254;function a(A,h){switch(h.type){case"base64":return s($u(A),h);case"binary":return s(A,h);case"buffer":return s(ra&&Buffer.isBuffer(A)?A.toString("binary"):Hm(A),h);case"array":return s(gg(A),h)}throw new Error("Unrecognized type "+h.type)}function s(A,h){var m=A.split(/[\n\r]+/),p=-1,x=-1,v=0,y=0,b=[],w=[],j=null,I={},C=[],S=[],E=[],B=0,k;for(+h.codepage>=0&&hf(+h.codepage);v!==m.length;++v){B=0;var T=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),P=T.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),K=P[0],le;if(T.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&w.push(T.slice(3).replace(/;;/g,";"));break;case"C":var oe=!1,ie=!1,Ae=!1,te=!1,Te=-1,Ue=-1;for(y=1;y<P.length;++y)switch(P[y].charAt(0)){case"A":break;case"X":x=parseInt(P[y].slice(1))-1,ie=!0;break;case"Y":for(p=parseInt(P[y].slice(1))-1,ie||(x=0),k=b.length;k<=p;++k)b[k]=[];break;case"K":le=P[y].slice(1),le.charAt(0)==='"'?le=le.slice(1,le.length-1):le==="TRUE"?le=!0:le==="FALSE"?le=!1:isNaN(xf(le))?isNaN(Qv(le).getDate())||(le=Ds(le)):(le=xf(le),j!==null&&y1(j)&&(le=fP(le))),oe=!0;break;case"E":te=!0;var O=vv(P[y].slice(1),{r:p,c:x});b[p][x]=[b[p][x],O];break;case"S":Ae=!0,b[p][x]=[b[p][x],"S5S"];break;case"G":break;case"R":Te=parseInt(P[y].slice(1))-1;break;case"C":Ue=parseInt(P[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}if(oe&&(b[p][x]&&b[p][x].length==2?b[p][x][0]=le:b[p][x]=le,j=null),Ae){if(te)throw new Error("SYLK shared formula cannot have own formula");var H=Te>-1&&b[Te][Ue];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");b[p][x][1]=Vae(H[1],{r:p-Te,c:x-Ue})}break;case"F":var G=0;for(y=1;y<P.length;++y)switch(P[y].charAt(0)){case"X":x=parseInt(P[y].slice(1))-1,++G;break;case"Y":for(p=parseInt(P[y].slice(1))-1,k=b.length;k<=p;++k)b[k]=[];break;case"M":B=parseInt(P[y].slice(1))/20;break;case"F":break;case"G":break;case"P":j=w[parseInt(P[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=P[y].slice(1).split(" "),k=parseInt(E[0],10);k<=parseInt(E[1],10);++k)B=parseInt(E[2],10),S[k-1]=B===0?{hidden:!0}:{wch:B},Pm(S[k-1]);break;case"C":x=parseInt(P[y].slice(1))-1,S[x]||(S[x]={});break;case"R":p=parseInt(P[y].slice(1))-1,C[p]||(C[p]={}),B>0?(C[p].hpt=B,C[p].hpx=Hv(B)):B===0&&(C[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}G<1&&(j=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}}return C.length>0&&(I["!rows"]=C),S.length>0&&(I["!cols"]=S),h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),[b,I]}function o(A,h){var m=a(A,h),p=m[0],x=m[1],v=w1(p,h);return Ti(x).forEach(function(y){v[y]=x[y]}),v}function l(A,h){return $m(o(A,h),h)}function c(A,h,m,p){var x="C;Y"+(m+1)+";X"+(p+1)+";K";switch(A.t){case"n":x+=A.v||0,A.f&&!A.F&&(x+=";E"+ER(A.f,{r:m,c:p}));break;case"b":x+=A.v?"TRUE":"FALSE";break;case"e":x+=A.w||A.v;break;case"d":x+='"'+(A.w||A.v)+'"';break;case"s":x+='"'+A.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function u(A,h){h.forEach(function(m,p){var x="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?x+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=L2(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=U2(m.wpx)),typeof m.wch=="number"&&(x+=Math.round(m.wch))),x.charAt(x.length-1)!=" "&&A.push(x)})}function d(A,h){h.forEach(function(m,p){var x="F;";m.hidden?x+="M0;":m.hpt?x+="M"+20*m.hpt+";":m.hpx&&(x+="M"+20*Q2(m.hpx)+";"),x.length>2&&A.push(x+"R"+(p+1))})}function f(A,h){var m=["ID;PWXL;N;E"],p=[],x=Ea(A["!ref"]),v,y=Array.isArray(A),b=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),A["!cols"]&&u(m,A["!cols"]),A["!rows"]&&d(m,A["!rows"]),m.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var w=x.s.r;w<=x.e.r;++w)for(var j=x.s.c;j<=x.e.c;++j){var I=On({r:w,c:j});v=y?(A[w]||[])[j]:A[I],!(!v||v.v==null&&(!v.f||v.F))&&p.push(c(v,A,w,j))}return m.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),_ae=function(){function t(s,o){switch(o.type){case"base64":return e($u(s),o);case"binary":return e(s,o);case"buffer":return e(ra&&Buffer.isBuffer(s)?s.toString("binary"):Hm(s),o);case"array":return e(gg(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var l=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var A=l[d].trim().split(","),h=A[0],m=A[1];++d;for(var p=l[d]||"";(p.match(/["]/g)||[]).length&1&&d<l.length-1;)p+=`
`+l[++d];switch(p=p.trim(),+h){case-1:if(p==="BOT"){f[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][u]=!0:p==="FALSE"?f[c][u]=!1:isNaN(xf(m))?isNaN(Qv(m).getDate())?f[c][u]=m:f[c][u]=Ds(m):f[c][u]=xf(m),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return w1(t(s,o),o)}function n(s,o){return $m(r(s,o),o)}var a=function(){var s=function(c,u,d,f,A){c.push(u),c.push(d+","+f),c.push('"'+A.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=Ea(c["!ref"]),f,A=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){o(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var p=On({r:h,c:m});if(f=A?(c[h]||[])[m]:c[p],!f){o(u,1,0,"");continue}switch(f.t){case"n":var x=f.w;!x&&f.v!=null&&(x=f.v),x==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,x,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Dd(f.z||Fn[14],Do(Ds(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var v=`\r
`,y=u.join(v);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),Eae=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,A){for(var h=f.split(`
`),m=-1,p=-1,x=0,v=[];x!==h.length;++x){var y=h[x].trim().split(":");if(y[0]==="cell"){var b=di(y[1]);if(v.length<=b.r)for(m=v.length;m<=b.r;++m)v[m]||(v[m]=[]);switch(m=b.r,p=b.c,y[2]){case"t":v[m][p]=t(y[3]);break;case"v":v[m][p]=+y[3];break;case"vtf":var w=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[m][p]=!!+y[4];break;default:v[m][p]=+y[4];break}y[2]=="vtf"&&(v[m][p]=[v[m][p],w])}}}return A&&A.sheetRows&&(v=v.slice(0,A.sheetRows)),v}function n(f,A){return w1(r(f,A),A)}function a(f,A){return $m(n(f,A),A)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var A=[],h=[],m,p="",x=cu(f["!ref"]),v=Array.isArray(f),y=x.s.r;y<=x.e.r;++y)for(var b=x.s.c;b<=x.e.c;++b)if(p=On({r:y,c:b}),m=v?(f[y]||[])[b]:f[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(e(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=e(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var w=Do(Ds(m.v));h[2]="vtc",h[3]="nd",h[4]=""+w,h[5]=m.w||Dd(m.z||Fn[14],w);break;case"e":continue}A.push(h.join(":"))}return A.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),A.push("valueformat:1:text-wiki"),A.join(`
`)}function d(f){return[s,o,l,o,u(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),Vv=function(){function t(d,f,A,h,m){m.raw?f[A][h]=d:d===""||(d==="TRUE"?f[A][h]=!0:d==="FALSE"?f[A][h]=!1:isNaN(xf(d))?isNaN(Qv(d).getDate())?f[A][h]=d:f[A][h]=Ds(d):f[A][h]=xf(d))}function e(d,f){var A=f||{},h=[];if(!d||d.length===0)return h;for(var m=d.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var x=10,v=0,y=0;y<=p;++y)v=m[y].indexOf(" "),v==-1?v=m[y].length:v++,x=Math.max(x,v);for(y=0;y<=p;++y){h[y]=[];var b=0;for(t(m[y].slice(0,x).trim(),h,y,b,A),b=1;b<=(m[y].length-x)/10+1;++b)t(m[y].slice(x+(b-1)*10,x+b*10).trim(),h,y,b,A)}return A.sheetRows&&(h=h.slice(0,A.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},A=!1,h=0,m=0;h<d.length;++h)(m=d.charCodeAt(h))==34?A=!A:!A&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h]);if(!m.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h])}return m.sort(function(p,x){return p[0]-x[0]||n[p[1]]-n[x[1]]}),r[m.pop()[1]]||44}function s(d,f){var A=f||{},h="",m=A.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=a(d.slice(0,1024)):A&&A.FS?h=A.FS:h=a(d.slice(0,1024));var x=0,v=0,y=0,b=0,w=0,j=h.charCodeAt(0),I=!1,C=0,S=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var E=A.dateNF!=null?g3e(A.dateNF):null;function B(){var k=d.slice(b,w),T={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)T.t="z";else if(A.raw)T.t="s",T.v=k;else if(k.trim().length===0)T.t="s",T.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(T.t="s",T.v=k.slice(2,-1).replace(/""/g,'"')):KFe(k)?(T.t="n",T.f=k.slice(1)):(T.t="s",T.v=k);else if(k=="TRUE")T.t="b",T.v=!0;else if(k=="FALSE")T.t="b",T.v=!1;else if(!isNaN(y=xf(k)))T.t="n",A.cellText!==!1&&(T.w=k),T.v=y;else if(!isNaN(Qv(k).getDate())||E&&k.match(E)){T.z=A.dateNF||Fn[14];var P=0;E&&k.match(E)&&(k=x3e(k,A.dateNF,k.match(E)||[]),P=1),A.cellDates?(T.t="d",T.v=Ds(k,P)):(T.t="n",T.v=Do(Ds(k,P))),A.cellText!==!1&&(T.w=Dd(T.z,T.v instanceof Date?Do(T.v):T.v)),A.cellNF||delete T.z}else T.t="s",T.v=k;if(T.t=="z"||(A.dense?(m[x]||(m[x]=[]),m[x][v]=T):m[On({c:v,r:x})]=T),b=w+1,S=d.charCodeAt(b),p.e.c<v&&(p.e.c=v),p.e.r<x&&(p.e.r=x),C==j)++v;else if(v=0,++x,A.sheetRows&&A.sheetRows<=x)return!0}e:for(;w<d.length;++w)switch(C=d.charCodeAt(w)){case 34:S===34&&(I=!I);break;case j:case 10:case 13:if(!I&&B())break e;break}return w-b>0&&B(),m["!ref"]=Xn(p),m}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):w1(e(d,f),f)}function l(d,f){var A="",h=f.type=="string"?[0,0,0,0]:FR(d,f);switch(f.type){case"base64":A=$u(d);break;case"binary":A=d;break;case"buffer":f.codepage==65001?A=d.toString("utf8"):f.codepage&&typeof T2<"u"||(A=ra&&Buffer.isBuffer(d)?d.toString("binary"):Hm(d));break;case"array":A=gg(d);break;case"string":A=d;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?A=cs(A.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?A=cs(A):f.type=="binary"&&typeof T2<"u",A.slice(0,19)=="socialcalc:version:"?Eae.to_sheet(f.type=="string"?A:cs(A),f):o(A,f)}function c(d,f){return $m(l(d,f),f)}function u(d){for(var f=[],A=Ea(d["!ref"]),h,m=Array.isArray(d),p=A.s.r;p<=A.e.r;++p){for(var x=[],v=A.s.c;v<=A.e.c;++v){var y=On({r:p,c:v});if(h=m?(d[p]||[])[v]:d[y],!h||h.v==null){x.push("          ");continue}for(var b=(h.w||(wA(h),h.w)||"").slice(0,10);b.length<10;)b+=" ";x.push(b+(v===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function BBe(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=Cae.to_workbook(t,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Vv.to_workbook(t,e)}}var Kp=function(){function t(O,H,G){if(O){El(O,O.l||0);for(var L=G.Enum||Te;O.l<O.length;){var W=O.read_shift(2),X=L[W]||L[65535],D=O.read_shift(2),Q=O.l+D,Z=X.f&&X.f(O,D,G);if(O.l=Q,H(Z,X,W))return}}}function e(O,H){switch(H.type){case"base64":return r(Tu($u(O)),H);case"binary":return r(Tu(O),H);case"buffer":case"array":return r(O,H)}throw"Unsupported type "+H.type}function r(O,H){if(!O)return O;var G=H||{},L=G.dense?[]:{},W="Sheet1",X="",D=0,Q={},Z=[],be=[],U={s:{r:0,c:0},e:{r:0,c:0}},ze=G.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)G.Enum=Te,t(O,function(ke,Be,Ye){switch(Ye){case 0:G.vers=ke,ke>=4096&&(G.qpro=!0);break;case 6:U=ke;break;case 204:ke&&(X=ke);break;case 222:X=ke;break;case 15:case 51:G.qpro||(ke[1].v=ke[1].v.slice(1));case 13:case 14:case 16:Ye==14&&(ke[2]&112)==112&&(ke[2]&15)>1&&(ke[2]&15)<15&&(ke[1].z=G.dateNF||Fn[14],G.cellDates&&(ke[1].t="d",ke[1].v=fP(ke[1].v))),G.qpro&&ke[3]>D&&(L["!ref"]=Xn(U),Q[W]=L,Z.push(W),L=G.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},D=ke[3],W=X||"Sheet"+(D+1),X="");var ot=G.dense?(L[ke[0].r]||[])[ke[0].c]:L[On(ke[0])];if(ot){ot.t=ke[1].t,ot.v=ke[1].v,ke[1].z!=null&&(ot.z=ke[1].z),ke[1].f!=null&&(ot.f=ke[1].f);break}G.dense?(L[ke[0].r]||(L[ke[0].r]=[]),L[ke[0].r][ke[0].c]=ke[1]):L[On(ke[0])]=ke[1];break}},G);else if(O[2]==26||O[2]==14)G.Enum=Ue,O[2]==14&&(G.qpro=!0,O.l=0),t(O,function(ke,Be,Ye){switch(Ye){case 204:W=ke;break;case 22:ke[1].v=ke[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ke[3]>D&&(L["!ref"]=Xn(U),Q[W]=L,Z.push(W),L=G.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},D=ke[3],W="Sheet"+(D+1)),ze>0&&ke[0].r>=ze)break;G.dense?(L[ke[0].r]||(L[ke[0].r]=[]),L[ke[0].r][ke[0].c]=ke[1]):L[On(ke[0])]=ke[1],U.e.c<ke[0].c&&(U.e.c=ke[0].c),U.e.r<ke[0].r&&(U.e.r=ke[0].r);break;case 27:ke[14e3]&&(be[ke[14e3][0]]=ke[14e3][1]);break;case 1537:be[ke[0]]=ke[1],ke[0]==D&&(W=ke[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(L["!ref"]=Xn(U),Q[X||W]=L,Z.push(X||W),!be.length)return{SheetNames:Z,Sheets:Q};for(var re={},J=[],Re=0;Re<be.length;++Re)Q[Z[Re]]?(J.push(be[Re]||Z[Re]),re[be[Re]]=Q[be[Re]]||Q[Z[Re]]):(J.push(be[Re]),re[be[Re]]={"!ref":"A1"});return{SheetNames:J,Sheets:re}}function n(O,H){var G=H||{};if(+G.codepage>=0&&hf(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var L=lu(),W=Ea(O["!ref"]),X=Array.isArray(O),D=[];Kr(L,0,s(1030)),Kr(L,6,c(W));for(var Q=Math.min(W.e.r,8191),Z=W.s.r;Z<=Q;++Z)for(var be=Wi(Z),U=W.s.c;U<=W.e.c;++U){Z===W.s.r&&(D[U]=ui(U));var ze=D[U]+be,re=X?(O[Z]||[])[U]:O[ze];if(!(!re||re.t=="z"))if(re.t=="n")(re.v|0)==re.v&&re.v>=-32768&&re.v<=32767?Kr(L,13,h(Z,U,re.v)):Kr(L,14,p(Z,U,re.v));else{var J=wA(re);Kr(L,15,f(Z,U,J.slice(0,239)))}}return Kr(L,1),L.end()}function a(O,H){var G=H||{};if(+G.codepage>=0&&hf(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var L=lu();Kr(L,0,o(O));for(var W=0,X=0;W<O.SheetNames.length;++W)(O.Sheets[O.SheetNames[W]]||{})["!ref"]&&Kr(L,27,te(O.SheetNames[W],X++));var D=0;for(W=0;W<O.SheetNames.length;++W){var Q=O.Sheets[O.SheetNames[W]];if(!(!Q||!Q["!ref"])){for(var Z=Ea(Q["!ref"]),be=Array.isArray(Q),U=[],ze=Math.min(Z.e.r,8191),re=Z.s.r;re<=ze;++re)for(var J=Wi(re),Re=Z.s.c;Re<=Z.e.c;++Re){re===Z.s.r&&(U[Re]=ui(Re));var ke=U[Re]+J,Be=be?(Q[re]||[])[Re]:Q[ke];if(!(!Be||Be.t=="z"))if(Be.t=="n")Kr(L,23,B(re,Re,D,Be.v));else{var Ye=wA(Be);Kr(L,22,C(re,Re,D,Ye.slice(0,239)))}}++D}}return Kr(L,1),L.end()}function s(O){var H=cr(2);return H.write_shift(2,O),H}function o(O){var H=cr(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var G=0,L=0,W=0,X=0;X<O.SheetNames.length;++X){var D=O.SheetNames[X],Q=O.Sheets[D];if(!(!Q||!Q["!ref"])){++W;var Z=cu(Q["!ref"]);G<Z.e.r&&(G=Z.e.r),L<Z.e.c&&(L=Z.e.c)}}return G>8191&&(G=8191),H.write_shift(2,G),H.write_shift(1,W),H.write_shift(1,L),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function l(O,H,G){var L={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&G.qpro?(L.s.c=O.read_shift(1),O.l++,L.s.r=O.read_shift(2),L.e.c=O.read_shift(1),O.l++,L.e.r=O.read_shift(2),L):(L.s.c=O.read_shift(2),L.s.r=O.read_shift(2),H==12&&G.qpro&&(O.l+=2),L.e.c=O.read_shift(2),L.e.r=O.read_shift(2),H==12&&G.qpro&&(O.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function c(O){var H=cr(8);return H.write_shift(2,O.s.c),H.write_shift(2,O.s.r),H.write_shift(2,O.e.c),H.write_shift(2,O.e.r),H}function u(O,H,G){var L=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(L[0].c=O.read_shift(1),L[3]=O.read_shift(1),L[0].r=O.read_shift(2),O.l+=2):(L[2]=O.read_shift(1),L[0].c=O.read_shift(2),L[0].r=O.read_shift(2)),L}function d(O,H,G){var L=O.l+H,W=u(O,H,G);if(W[1].t="s",G.vers==20768){O.l++;var X=O.read_shift(1);return W[1].v=O.read_shift(X,"utf8"),W}return G.qpro&&O.l++,W[1].v=O.read_shift(L-O.l,"cstr"),W}function f(O,H,G){var L=cr(7+G.length);L.write_shift(1,255),L.write_shift(2,H),L.write_shift(2,O),L.write_shift(1,39);for(var W=0;W<L.length;++W){var X=G.charCodeAt(W);L.write_shift(1,X>=128?95:X)}return L.write_shift(1,0),L}function A(O,H,G){var L=u(O,H,G);return L[1].v=O.read_shift(2,"i"),L}function h(O,H,G){var L=cr(7);return L.write_shift(1,255),L.write_shift(2,H),L.write_shift(2,O),L.write_shift(2,G,"i"),L}function m(O,H,G){var L=u(O,H,G);return L[1].v=O.read_shift(8,"f"),L}function p(O,H,G){var L=cr(13);return L.write_shift(1,255),L.write_shift(2,H),L.write_shift(2,O),L.write_shift(8,G,"f"),L}function x(O,H,G){var L=O.l+H,W=u(O,H,G);if(W[1].v=O.read_shift(8,"f"),G.qpro)O.l=L;else{var X=O.read_shift(2);w(O.slice(O.l,O.l+X),W),O.l+=X}return W}function v(O,H,G){var L=H&32768;return H&=-32769,H=(L?O:0)+(H>=8192?H-16384:H),(L?"":"$")+(G?ui(H):Wi(H))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(O,H){El(O,0);for(var G=[],L=0,W="",X="",D="",Q="";O.l<O.length;){var Z=O[O.l++];switch(Z){case 0:G.push(O.read_shift(8,"f"));break;case 1:X=v(H[0].c,O.read_shift(2),!0),W=v(H[0].r,O.read_shift(2),!1),G.push(X+W);break;case 2:{var be=v(H[0].c,O.read_shift(2),!0),U=v(H[0].r,O.read_shift(2),!1);X=v(H[0].c,O.read_shift(2),!0),W=v(H[0].r,O.read_shift(2),!1),G.push(be+U+":"+X+W)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(O.read_shift(2));break;case 6:{for(var ze="";Z=O[O.l++];)ze+=String.fromCharCode(Z);G.push('"'+ze.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:Q=G.pop(),D=G.pop(),G.push(["AND","OR"][Z-20]+"("+D+","+Q+")");break;default:if(Z<32&&b[Z])Q=G.pop(),D=G.pop(),G.push(D+b[Z]+Q);else if(y[Z]){if(L=y[Z][1],L==69&&(L=O[O.l++]),L>G.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+G.join("|")+"|");return}var re=G.slice(-L);G.length-=L,G.push(y[Z][0]+"("+re.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}G.length==1?H[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function j(O){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=O.read_shift(2),H[3]=O[O.l++],H[0].c=O[O.l++],H}function I(O,H){var G=j(O);return G[1].t="s",G[1].v=O.read_shift(H-4,"cstr"),G}function C(O,H,G,L){var W=cr(6+L.length);W.write_shift(2,O),W.write_shift(1,G),W.write_shift(1,H),W.write_shift(1,39);for(var X=0;X<L.length;++X){var D=L.charCodeAt(X);W.write_shift(1,D>=128?95:D)}return W.write_shift(1,0),W}function S(O,H){var G=j(O);G[1].v=O.read_shift(2);var L=G[1].v>>1;if(G[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return G[1].v=L,G}function E(O,H){var G=j(O),L=O.read_shift(4),W=O.read_shift(4),X=O.read_shift(2);if(X==65535)return L===0&&W===3221225472?(G[1].t="e",G[1].v=15):L===0&&W===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var D=X&32768;return X=(X&32767)-16446,G[1].v=(1-D*2)*(W*Math.pow(2,X+32)+L*Math.pow(2,X)),G}function B(O,H,G,L){var W=cr(14);if(W.write_shift(2,O),W.write_shift(1,G),W.write_shift(1,H),L==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var X=0,D=0,Q=0,Z=0;return L<0&&(X=1,L=-L),D=Math.log2(L)|0,L/=Math.pow(2,D-31),Z=L>>>0,Z&2147483648||(L/=2,++D,Z=L>>>0),L-=Z,Z|=2147483648,Z>>>=0,L*=Math.pow(2,32),Q=L>>>0,W.write_shift(4,Q),W.write_shift(4,Z),D+=16383+(X?32768:0),W.write_shift(2,D),W}function k(O,H){var G=E(O);return O.l+=H-14,G}function T(O,H){var G=j(O),L=O.read_shift(4);return G[1].v=L>>6,G}function P(O,H){var G=j(O),L=O.read_shift(8,"f");return G[1].v=L,G}function K(O,H){var G=P(O);return O.l+=H-10,G}function le(O,H){return O[O.l+H-1]==0?O.read_shift(H,"cstr"):""}function oe(O,H){var G=O[O.l++];G>H-1&&(G=H-1);for(var L="";L.length<G;)L+=String.fromCharCode(O[O.l++]);return L}function ie(O,H,G){if(!(!G.qpro||H<21)){var L=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var W=O.read_shift(H-21,"cstr");return[L,W]}}function Ae(O,H){for(var G={},L=O.l+H;O.l<L;){var W=O.read_shift(2);if(W==14e3){for(G[W]=[0,""],G[W][0]=O.read_shift(2);O[O.l];)G[W][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return G}function te(O,H){var G=cr(5+O.length);G.write_shift(2,14e3),G.write_shift(2,H);for(var L=0;L<O.length;++L){var W=O.charCodeAt(L);G[G.l++]=W>127?95:W}return G[G.l++]=0,G}var Te={0:{n:"BOF",f:ao},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:A},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:le},222:{n:"SHEETNAMELP",f:oe},65535:{n:""}},Ue={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:le},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}}();function kBe(t){var e={},r=t.match(uc),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Dn(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=Y6[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return e}var FBe=function(){var t=F2("t"),e=F2("rPr");function r(s){var o=s.match(t);if(!o)return{t:"s",v:""};var l={t:"s",v:_a(o[1])},c=s.match(e);return c&&(l.s=kBe(c[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),OBe=function(){var e=/(\r\n|\n)/g;function r(a,s,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),a.b&&(s.push("<b>"),o.push("</b>")),a.i&&(s.push("<i>"),o.push("</i>")),a.strike&&(s.push("<s>"),o.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),DBe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,RBe=/<(?:\w+:)?r>/,MBe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function bR(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=_a(cs(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=cs(t),r&&(n.h=oR(n.t))):t.match(RBe)&&(n.r=cs(t),n.t=_a(cs((t.replace(MBe,"").match(DBe)||[]).join("").replace(uc,""))),r&&(n.h=OBe(FBe(n.r)))),n):{t:""}}var LBe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,UBe=/<(?:\w+:)?(?:si|sstItem)>/g,QBe=/<\/(?:\w+:)?(?:si|sstItem)>/;function VBe(t,e){var r=[],n="";if(!t)return r;var a=t.match(LBe);if(a){n=a[2].replace(UBe,"").split(QBe);for(var s=0;s!=n.length;++s){var o=bR(n[s].trim(),e);o!=null&&(r[r.length]=o)}a=Dn(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var HBe=/^\s|\s$|[\t\n\r]/;function Sae(t,e){if(!e.bookSST)return"";var r=[Yi];r[r.length]=Gr("sst",null,{xmlns:Ug[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(HBe)&&(s+=' xml:space="preserve"'),s+=">"+rs(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function $Be(t){return[t.read_shift(4),t.read_shift(4)]}function GBe(t,e){var r=[],n=!1;return MA(t,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function KBe(t,e){return e||(e=cr(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var qBe=n5e;function zBe(t){var e=lu();Nr(e,159,KBe(t));for(var r=0;r<t.length;++r)Nr(e,19,qBe(t[r]));return Nr(e,160),e.end()}function Iae(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function uA(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function WBe(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=uA(t,4),e.U=uA(t,4),e.W=uA(t,4),e}function XBe(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),s=[];a-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function YBe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(XBe(t));return e}function JBe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function ZBe(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=uA(t,4),e.U=uA(t,4),e.W=uA(t,4),e}function eke(t){var e=ZBe(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function jae(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function Pae(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function tke(t){var e=uA(t);switch(e.Minor){case 2:return[e.Minor,rke(t)];case 3:return[e.Minor,nke()];case 4:return[e.Minor,ake(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function rke(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=jae(t,r),a=Pae(t,t.length-t.l);return{t:"Std",h:n,v:a}}function nke(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ake(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(uc,function(s){var o=Dn(s);switch(xh(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function ske(t,e){var r={},n=r.EncryptionVersionInfo=uA(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=jae(t,a),e-=a,r.EncryptionVerifier=Pae(t,e),r}function ike(t){var e={},r=e.EncryptionVersionInfo=uA(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function wR(t){var e=0,r,n=Iae(t),a=n.length+1,s,o,l,c,u;for(r=jm(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)o=r[s],l=e&16384?1:0,c=e<<1&32767,u=l|c,e=u^o;return e^52811}var Tae=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},s=function(o){for(var l=e[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=Iae(o),c=s(l),u=l.length,d=jm(16),f=0;f!=16;++f)d[f]=0;var A,h,m;for((u&1)===1&&(A=c>>8,d[u]=a(t[0],A),--u,A=c&255,h=l[l.length-1],d[u]=a(h,A));u>0;)--u,A=c>>8,d[u]=a(l[u],A),--u,A=c&255,d[u]=a(l[u],A);for(u=15,m=15-l.length;m>0;)A=c>>8,d[u]=a(t[m],A),--u,--m,A=c&255,d[u]=a(l[u],A),--u,--m;return d}}(),oke=function(t,e,r,n,a){a||(a=e),n||(n=Tae(t));var s,o;for(s=0;s!=e.length;++s)o=e[s],o^=n[r],o=(o>>5|o<<3)&255,a[s]=o,++r;return[a,r,n]},lke=function(t){var e=0,r=Tae(t);return function(n){var a=oke("",n,e,r);return e=a[1],a[0]}};function cke(t,e,r,n){var a={key:ao(t),verificationBytes:ao(t)};return r.password&&(a.verifier=wR(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=lke(r.password)),a}function uke(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=ike(t):n.Data=ske(t,e),n}function dke(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?uke(t,e-2,n):cke(t,r.biff>=8?e:e-2,r,n),n}var Bae=function(){function t(a,s){switch(s.type){case"base64":return e($u(a),s);case"binary":return e(a,s);case"buffer":return e(ra&&Buffer.isBuffer(a)?a.toString("binary"):Hm(a),s);case"array":return e(gg(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){var o=s||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var A=/\\\w+\b/g,h=0,m,p=-1;m=A.exec(d);){switch(m[0]){case"\\cell":var x=d.slice(h,A.lastIndex-m[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var v={v:x,t:"s"};Array.isArray(l)?l[f][p]=v:l[On({r:f,c:p})]=v}break}h=A.lastIndex}p>u.e.c&&(u.e.c=p)}),l["!ref"]=Xn(u),l}function r(a,s){return $m(t(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],o=Ea(a["!ref"]),l,c=Array.isArray(a),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=On({r:u,c:d});l=c?(a[u]||[])[d]:a[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(wA(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function fke(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function M2(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function hke(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),s=Math.min(e,r,n),o=a-s;if(o===0)return[0,0,e];var l=0,c=0,u=a+s;switch(c=o/(u>1?2-u:u),a){case e:l=((r-n)/o+6)%6;break;case r:l=(n-e)/o+2;break;case n:l=(e-r)/o+4;break}return[l/6,c,u/2]}function Ake(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),s=n-a/2,o=[s,s,s],l=6*e,c;if(r!==0)switch(l|0){case 0:case 6:c=a*l,o[0]+=a,o[1]+=c;break;case 1:c=a*(2-l),o[0]+=c,o[1]+=a;break;case 2:c=a*(l-2),o[1]+=a,o[2]+=c;break;case 3:c=a*(4-l),o[1]+=c,o[2]+=a;break;case 4:c=a*(l-4),o[2]+=a,o[0]+=c;break;case 5:c=a*(6-l),o[2]+=c,o[0]+=a;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function YS(t,e){if(e===0)return t;var r=hke(fke(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),M2(Ake(r))}var kae=6,mke=15,pke=1,nc=kae;function L2(t){return Math.floor((t+Math.round(128/nc)/256)*nc)}function U2(t){return Math.floor((t-5)/nc*100+.5)/100}function JS(t){return Math.round((t*nc+5)/nc*256)/256}function F5(t){return JS(U2(L2(t)))}function NR(t){var e=Math.abs(t-F5(t)),r=nc;if(e>.005)for(nc=pke;nc<mke;++nc)Math.abs(t-F5(t))<=e&&(e=Math.abs(t-F5(t)),r=nc);nc=r}function Pm(t){t.width?(t.wpx=L2(t.width),t.wch=U2(t.wpx),t.MDW=nc):t.wpx?(t.wch=U2(t.wpx),t.width=JS(t.wch),t.MDW=nc):typeof t.wch=="number"&&(t.width=JS(t.wch),t.wpx=L2(t.width),t.MDW=nc),t.customWidth&&delete t.customWidth}var gke=96,Fae=gke;function Q2(t){return t*96/Fae}function Hv(t){return t*Fae/96}var xke={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function vke(t,e,r,n){e.Borders=[];var a={},s=!1;(t[0].match(uc)||[]).forEach(function(o){var l=Dn(o);switch(xh(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=Bs(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=Bs(l.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function yke(t,e,r,n){e.Fills=[];var a={},s=!1;(t[0].match(uc)||[]).forEach(function(o){var l=Dn(o);switch(xh(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function bke(t,e,r,n){e.Fonts=[];var a={},s=!1;(t[0].match(uc)||[]).forEach(function(o){var l=Dn(o);switch(xh(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=cs(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?Bs(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?Bs(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?Bs(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?Bs(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?Bs(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?Bs(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?Bs(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Y6[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=Bs(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var c=$p[a.color.index];a.color.index==81&&(c=$p[1]),c||(c=$p[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=YS(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function wke(t,e,r){e.NumberFmt=[];for(var n=Ti(Fn),a=0;a<n.length;++a)e.NumberFmt[n[a]]=Fn[n[a]];var s=t[0].match(uc);if(s)for(a=0;a<s.length;++a){var o=Dn(s[a]);switch(xh(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=_a(cs(o.formatCode)),c=parseInt(o.numFmtId,10);if(e.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=l}cA(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Nke(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Gr("numFmt",null,{numFmtId:n,formatCode:rs(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Gr("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var WC=["numFmtId","fillId","fontId","borderId","xfId"],XC=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Cke(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(uc)||[]).forEach(function(s){var o=Dn(s),l=0;switch(xh(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<WC.length;++l)n[WC[l]]&&(n[WC[l]]=parseInt(n[WC[l]],10));for(l=0;l<XC.length;++l)n[XC[l]]&&(n[XC[l]]=Bs(n[XC[l]]));if(e.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[l]){n.numFmtId=l;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=Bs(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function _ke(t){var e=[];return e[e.length]=Gr("cellXfs",null),t.forEach(function(r){e[e.length]=Gr("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Gr("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Eke=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(e))&&wke(f,d,u),(f=l.match(a))&&bke(f,d,c,u),(f=l.match(n))&&yke(f,d,c,u),(f=l.match(s))&&vke(f,d,c,u),(f=l.match(r))&&Cke(f,d,u),d}}();function Oae(t,e){var r=[Yi,Gr("styleSheet",null,{xmlns:Ug[0],"xmlns:vt":To.vt})],n;return t.SSF&&(n=Nke(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=_ke(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Ske(t,e){var r=t.read_shift(2),n=ic(t);return[r,n]}function Ike(t,e,r){r||(r=cr(6+4*e.length)),r.write_shift(2,t),el(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function jke(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=u5e(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=c5e(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ic(t),n}function Pke(t,e){e||(e=cr(25+4*32)),e.write_shift(2,t.sz*20),d5e(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),zS(t.color,e);var n=0;return n=2,e.write_shift(1,n),el(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Tke=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],O5,Bke=cc;function e$(t,e){e||(e=cr(4*3+8*7+16*1)),O5||(O5=uP(Tke));var r=O5[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(zS({auto:1},e),zS({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function kke(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function Dae(t,e,r){r||(r=cr(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function xy(t,e){return e||(e=cr(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Fke=cc;function Oke(t,e){return e||(e=cr(51)),e.write_shift(1,0),xy(null,e),xy(null,e),xy(null,e),xy(null,e),xy(null,e),e.length>e.l?e.slice(0,e.l):e}function Dke(t,e){return e||(e=cr(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),qS(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Rke(t,e,r){var n=cr(2052);return n.write_shift(4,t),qS(e,n),qS(r,n),n.length>n.l?n.slice(0,n.l):n}function Mke(t,e,r){var n={};n.NumberFmt=[];for(var a in Fn)n.NumberFmt[a]=Fn[a];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return MA(t,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],cA(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=YS(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function Lke(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Nr(t,615,vf(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Nr(t,44,Ike(a,e[a]))}),Nr(t,616))}}function Uke(t){var e=1;Nr(t,611,vf(e)),Nr(t,43,Pke({sz:12,color:{theme:1},name:"Calibri",family:2})),Nr(t,612)}function Qke(t){var e=2;Nr(t,603,vf(e)),Nr(t,45,e$({patternType:"none"})),Nr(t,45,e$({patternType:"gray125"})),Nr(t,604)}function Vke(t){var e=1;Nr(t,613,vf(e)),Nr(t,46,Oke()),Nr(t,614)}function Hke(t){var e=1;Nr(t,626,vf(e)),Nr(t,47,Dae({numFmtId:0},65535)),Nr(t,627)}function $ke(t,e){Nr(t,617,vf(e.length)),e.forEach(function(r){Nr(t,47,Dae(r,0))}),Nr(t,618)}function Gke(t){var e=1;Nr(t,619,vf(e)),Nr(t,48,Dke({xfId:0,name:"Normal"})),Nr(t,620)}function Kke(t){var e=0;Nr(t,505,vf(e)),Nr(t,506)}function qke(t){var e=0;Nr(t,508,Rke(e,"TableStyleMedium9","PivotStyleMedium4")),Nr(t,509)}function zke(t,e){var r=lu();return Nr(r,278),Lke(r,t.SSF),Uke(r),Qke(r),Vke(r),Hke(r),$ke(r,e.cellXfs),Gke(r),Kke(r),qke(r),Nr(r,279),r.end()}var Wke=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Xke(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(uc)||[]).forEach(function(a){var s=Dn(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[Wke.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function Yke(){}function Jke(){}var Zke=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,eFe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,tFe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function rFe(t,e,r){e.themeElements={};var n;[["clrScheme",Zke,Xke],["fontScheme",eFe,Yke],["fmtScheme",tFe,Jke]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var nFe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Rae(t,e){(!t||t.length===0)&&(t=CR());var r,n={};if(!(r=t.match(nFe)))throw new Error("themeElements not found in theme");return rFe(r[0],n,e),n.raw=t,n}function CR(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Yi];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function aFe(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var o;try{o=jne(s,{type:"array"})}catch{return}var l=Bu(o,"theme/theme/theme1.xml",!0);if(l)return Rae(l,r)}}function sFe(t){return t.read_shift(4)}function iFe(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=oFe(t,4);break;case 2:e.xclrValue=pae(t);break;case 3:e.xclrValue=sFe(t);break;case 4:t.l+=4;break}return t.l+=8,e}function oFe(t,e){return cc(t,e)}function lFe(t,e){return cc(t,e)}function cFe(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=iFe(t);break;case 6:n[1]=lFe(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function uFe(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),s=[];a-- >0;)s.push(cFe(t,r-t.l));return{ixfe:n,ext:s}}function dFe(t,e){e.forEach(function(r){switch(r[0]){}})}function fFe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:ic(t)}}function hFe(t){var e=cr(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),el(t.name,e),e.slice(0,e.l)}function AFe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function mFe(t){var e=cr(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function pFe(t,e){var r=cr(8+2*e.length);return r.write_shift(4,t),el(e,r),r.slice(0,r.l)}function gFe(t){return t.l+=4,t.read_shift(4)!=0}function xFe(t,e){var r=cr(8);return r.write_shift(4,t),r.write_shift(4,1),r}function vFe(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],o=!1,l=2;return MA(t,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(d),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function yFe(){var t=lu();return Nr(t,332),Nr(t,334,vf(1)),Nr(t,335,hFe({name:"XLDAPR",version:12e4,flags:3496657072})),Nr(t,336),Nr(t,339,pFe(1,"XLDAPR")),Nr(t,52),Nr(t,35,vf(514)),Nr(t,4096,vf(0)),Nr(t,4097,xd(1)),Nr(t,36),Nr(t,53),Nr(t,340),Nr(t,337,xFe(1)),Nr(t,51,mFe([[1,0]])),Nr(t,338),Nr(t,333),t.end()}function bFe(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,s=2,o;return t.replace(uc,function(l){var c=Dn(l);switch(xh(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function Mae(){var t=[Yi];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function wFe(t){var e=[];if(!t)return e;var r=1;return(t.match(uc)||[]).forEach(function(n){var a=Dn(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function NFe(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=On(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function CFe(t,e,r){var n=[];return MA(t,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function _Fe(t,e,r,n){if(!t)return t;var a=n||{},s=!1;MA(t,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function EFe(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Yx=1024;function Lae(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Gr("xml",null,{"xmlns:v":ju.v,"xmlns:o":ju.o,"xmlns:x":ju.x,"xmlns:mv":ju.mv}).replace(/\/>/,">"),Gr("o:shapelayout",Gr("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Gr("v:shapetype",[Gr("v:stroke",null,{joinstyle:"miter"}),Gr("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Yx<t*1e3;)Yx+=1e3;return e.forEach(function(s){var o=di(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Gr("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Gr("v:fill",c,l),d={on:"t",obscured:"t"};++Yx,a=a.concat(["<v:shape"+O2({id:"_x0000_s"+Yx,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Gr("v:shadow",null,d),Gr("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Il("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Il("x:AutoFill","False"),Il("x:Row",String(o.r)),Il("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function t$(t,e,r,n){var a=Array.isArray(t),s;e.forEach(function(o){var l=di(o.ref);if(a?(t[l.r]||(t[l.r]=[]),s=t[l.r][l.c]):s=t[o.ref],!s){s={t:"z"},a?t[l.r][l.c]=s:t[o.ref]=s;var c=Ea(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=Xn(c);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function SFe(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Dn(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=di(c.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),A=!!f&&!!f[1]&&bR(f[1])||{r:"",t:"",h:""};u.r=A.r,A.r=="<t></t>"&&(A.t=A.h=""),u.t=(A.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=A.h),n.push(u)}}}}),n}function Uae(t){var e=[Yi,Gr("comments",null,{xmlns:Ug[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var s=rs(a.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(rs(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)e.push(Il("t",rs(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;e.push(Il("t",rs(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function IFe(t,e){var r=[],n=!1,a={},s=0;return t.replace(uc,function(l,c){var u=Dn(l);switch(xh(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":a.t=t.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function jFe(t,e,r){var n=[Yi,Gr("ThreadedComments",null,{xmlns:To.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var s="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Gr("threadedComment",Il("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function PFe(t,e){var r=[],n=!1;return t.replace(uc,function(s){var o=Dn(s);switch(xh(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function TFe(t){var e=[Yi,Gr("personList",null,{xmlns:To.TCMNT,"xmlns:x":Ug[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Gr("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function BFe(t){var e={};e.iauthor=t.read_shift(4);var r=$g(t);return e.rfx=r.s,e.ref=On(r.s),t.l+=16,e}function kFe(t,e){return e==null&&(e=cr(36)),e.write_shift(4,t[1].iauthor),N1(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var FFe=ic;function OFe(t){return el(t.slice(0,54))}function DFe(t,e){var r=[],n=[],a={},s=!1;return MA(t,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function RFe(t){var e=lu(),r=[];return Nr(e,628),Nr(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Nr(e,632,OFe(a.a)))})}),Nr(e,631),Nr(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:di(n[0]),e:di(n[0])};Nr(e,635,kFe([s,a])),a.t&&a.t.length>0&&Nr(e,637,s5e(a)),Nr(e,636),delete a.iauthor})}),Nr(e,634),Nr(e,629),e.end()}var MFe="application/vnd.ms-office.vbaProject";function LFe(t){var e=En.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");En.utils.cfb_add(e,a,t.FileIndex[n].content)}}),En.write(e)}function UFe(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&En.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var Qae=["xlsb","xlsm","xlam","biff8","xla"];function QFe(){return{"!type":"dialog"}}function VFe(){return{"!type":"dialog"}}function HFe(){return{"!type":"macro"}}function $Fe(){return{"!type":"macro"}}var vv=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=e.c:--d,c?u+=e.r:--u,a+(l?"":"$")+ui(d)+(c?"":"$")+Wi(u)}return function(a,s){return e=s,a.replace(t,r)}}(),_R=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ER=function(){return function(e,r){return e.replace(_R,function(n,a,s,o,l,c){var u=fR(o)-(s?0:r.c),d=dR(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",A=u==0?"":s?u+1:"["+u+"]";return a+"R"+f+"C"+A})}}();function Vae(t,e){return t.replace(_R,function(r,n,a,s,o,l){return n+(a=="$"?a+s:ui(fR(s)+e.c))+(o=="$"?o+l:Wi(dR(l)+e.r))})}function GFe(t,e,r){var n=cu(e),a=n.s,s=di(r),o={r:s.r-a.r,c:s.c-a.c};return Vae(t,o)}function KFe(t){return t.length!=1}function r$(t){return t.replace(/_xlfn\./g,"")}function to(t){t.l+=1}function Tm(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Hae(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return $ae(t);r.biff==12&&(n=4)}var a=t.read_shift(n),s=t.read_shift(n),o=Tm(t),l=Tm(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function $ae(t){var e=Tm(t),r=Tm(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function qFe(t,e,r){if(r.biff<8)return $ae(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),s=Tm(t),o=Tm(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Gae(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return zFe(t);var n=t.read_shift(r&&r.biff==12?4:2),a=Tm(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function zFe(t){var e=Tm(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function WFe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function XFe(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return YFe(t);var a=t.read_shift(n>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:o,rRel:l}}function YFe(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function JFe(t,e,r){var n=(t[t.l++]&96)>>5,a=Hae(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function ZFe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=Hae(t,s,r);return[n,a,o]}function eOe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function tOe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,a]}function rOe(t,e,r){var n=(t[t.l++]&96)>>5,a=qFe(t,e-1,r);return[n,a]}function nOe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function n$(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function aOe(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function sOe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function iOe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function oOe(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function lOe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Kae(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function cOe(t){return t.read_shift(2),Kae(t)}function uOe(t){return t.read_shift(2),Kae(t)}function dOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=Gae(t,0,r);return[n,a]}function fOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=XFe(t,0,r);return[n,a]}function hOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=Gae(t,0,r);return[n,a,s]}function AOe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[gDe[a],Wae[a],n]}function mOe(t,e,r){var n=t[t.l++],a=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:pOe(t);return[a,(s[0]===0?Wae:pDe)[s[1]]]}function pOe(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function gOe(t,e,r){t.l+=r&&r.biff==2?3:4}function xOe(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function vOe(t){return t.l++,LA[t.read_shift(1)]}function yOe(t){return t.l++,t.read_shift(2)}function bOe(t){return t.l++,t.read_shift(1)!==0}function wOe(t){return t.l++,ac(t)}function NOe(t,e,r){return t.l++,Qw(t,e-1,r)}function COe(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Li(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=LA[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=ac(t);break;case 2:r[1]=Gg(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function _Oe(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?$g:hP)(t));return a}function EOe(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=a;++l)o[s][l]=COe(t,r.biff);return o}function SOe(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function IOe(t,e,r){if(r.biff==5)return jOe(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),s=t.read_shift(4);return[n,a,s]}function jOe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function POe(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function TOe(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function BOe(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function kOe(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,a]}var FOe=cc,OOe=cc,DOe=cc;function Hw(t,e,r){return t.l+=2,[WFe(t)]}function SR(t){return t.l+=6,[]}var ROe=Hw,MOe=SR,LOe=SR,UOe=Hw;function qae(t){return t.l+=2,[ao(t),t.read_shift(2)&1]}var QOe=Hw,VOe=qae,HOe=SR,$Oe=Hw,GOe=Hw,KOe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function qOe(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),s=t.read_shift(2),o=KOe[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:a,C:s}}function zOe(t){return t.l+=2,[t.read_shift(4)]}function WOe(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function XOe(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function YOe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function JOe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function ZOe(t){return t.l+=4,[0,0]}var a$={1:{n:"PtgExp",f:xOe},2:{n:"PtgTbl",f:DOe},3:{n:"PtgAdd",f:to},4:{n:"PtgSub",f:to},5:{n:"PtgMul",f:to},6:{n:"PtgDiv",f:to},7:{n:"PtgPower",f:to},8:{n:"PtgConcat",f:to},9:{n:"PtgLt",f:to},10:{n:"PtgLe",f:to},11:{n:"PtgEq",f:to},12:{n:"PtgGe",f:to},13:{n:"PtgGt",f:to},14:{n:"PtgNe",f:to},15:{n:"PtgIsect",f:to},16:{n:"PtgUnion",f:to},17:{n:"PtgRange",f:to},18:{n:"PtgUplus",f:to},19:{n:"PtgUminus",f:to},20:{n:"PtgPercent",f:to},21:{n:"PtgParen",f:to},22:{n:"PtgMissArg",f:to},23:{n:"PtgStr",f:NOe},26:{n:"PtgSheet",f:WOe},27:{n:"PtgEndSheet",f:XOe},28:{n:"PtgErr",f:vOe},29:{n:"PtgBool",f:bOe},30:{n:"PtgInt",f:yOe},31:{n:"PtgNum",f:wOe},32:{n:"PtgArray",f:nOe},33:{n:"PtgFunc",f:AOe},34:{n:"PtgFuncVar",f:mOe},35:{n:"PtgName",f:SOe},36:{n:"PtgRef",f:dOe},37:{n:"PtgArea",f:JFe},38:{n:"PtgMemArea",f:POe},39:{n:"PtgMemErr",f:FOe},40:{n:"PtgMemNoMem",f:OOe},41:{n:"PtgMemFunc",f:TOe},42:{n:"PtgRefErr",f:BOe},43:{n:"PtgAreaErr",f:eOe},44:{n:"PtgRefN",f:fOe},45:{n:"PtgAreaN",f:rOe},46:{n:"PtgMemAreaN",f:YOe},47:{n:"PtgMemNoMemN",f:JOe},57:{n:"PtgNameX",f:IOe},58:{n:"PtgRef3d",f:hOe},59:{n:"PtgArea3d",f:ZFe},60:{n:"PtgRefErr3d",f:kOe},61:{n:"PtgAreaErr3d",f:tOe},255:{}},eDe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},tDe={1:{n:"PtgElfLel",f:qae},2:{n:"PtgElfRw",f:$Oe},3:{n:"PtgElfCol",f:ROe},6:{n:"PtgElfRwV",f:GOe},7:{n:"PtgElfColV",f:UOe},10:{n:"PtgElfRadical",f:QOe},11:{n:"PtgElfRadicalS",f:HOe},13:{n:"PtgElfColS",f:MOe},15:{n:"PtgElfColSV",f:LOe},16:{n:"PtgElfRadicalLel",f:VOe},25:{n:"PtgList",f:qOe},29:{n:"PtgSxName",f:zOe},255:{}},rDe={0:{n:"PtgAttrNoop",f:ZOe},1:{n:"PtgAttrSemi",f:lOe},2:{n:"PtgAttrIf",f:iOe},4:{n:"PtgAttrChoose",f:aOe},8:{n:"PtgAttrGoto",f:sOe},16:{n:"PtgAttrSum",f:gOe},32:{n:"PtgAttrBaxcel",f:n$},33:{n:"PtgAttrBaxcel",f:n$},64:{n:"PtgAttrSpace",f:cOe},65:{n:"PtgAttrSpaceSemi",f:uOe},128:{n:"PtgAttrIfError",f:oOe},255:{}};function $w(t,e,r,n){if(n.biff<8)return cc(t,e);for(var a=t.l+e,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=EOe(t,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=_Oe(t,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=a-t.l,e!==0&&s.push(cc(t,e)),s}function Gw(t,e,r){for(var n=t.l+e,a,s,o=[];n!=t.l;)e=n-t.l,s=t[t.l],a=a$[s]||a$[eDe[s]],(s===24||s===25)&&(a=(s===24?tDe:rDe)[t[t.l+1]]),!a||!a.f?cc(t,e):o.push([a.n,a.f(t,e,r)]);return o}function nDe(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var aDe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sDe(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function zae(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function s$(t,e,r){var n=zae(t,e,r);return n=="#REF"?n:sDe(n,r)}function tc(t,e,r,n,a){var s=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,f=0,A=0,h,m="";if(!t[0]||!t[0][0])return"";for(var p=-1,x="",v=0,y=t[0].length;v<y;++v){var b=t[0][v];switch(b[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),p>=0){switch(t[0][p][1][0]){case 0:x=Si(" ",t[0][p][1][1]);break;case 1:x=Si("\r",t[0][p][1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}u=u+x,p=-1}l.push(u+aDe[b[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Fb(b[1][1],o,a),l.push(Ob(d,s));break;case"PtgRefN":d=r?Fb(b[1][1],r,a):b[1][1],l.push(Ob(d,s));break;case"PtgRef3d":f=b[1][1],d=Fb(b[1][2],o,a),m=s$(n,f,a),l.push(m+"!"+Ob(d,s));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],j=b[1][1];w||(w=0),w&=127;var I=w==0?[]:l.slice(-w);l.length-=w,j==="User"&&(j=I.shift()),l.push(j+"("+I.join(",")+")");break;case"PtgBool":l.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(b[1]);break;case"PtgNum":l.push(String(b[1]));break;case"PtgStr":l.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(b[1]);break;case"PtgAreaN":h=FH(b[1][1],r?{s:r}:o,a),l.push(T5(h,a));break;case"PtgArea":h=FH(b[1][1],o,a),l.push(T5(h,a));break;case"PtgArea3d":f=b[1][1],h=b[1][2],m=s$(n,f,a),l.push(m+"!"+T5(h,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":A=b[1][2];var C=(n.names||[])[A-1]||(n[0]||[])[A],S=C?C.Name:"SH33TJSNAME"+String(A);S&&S.slice(0,6)=="_xlfn."&&!a.xlfn&&(S=S.slice(6)),l.push(S);break;case"PtgNameX":var E=b[1][1];A=b[1][2];var B;if(a.biff<=5)E<0&&(E=-E),n[E]&&(B=n[E][A]);else{var k="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][A]&&n[E][A].itab>0&&(k=n.SheetNames[n[E][A].itab-1]+"!"):k=n.SheetNames[A-1]+"!"),n[E]&&n[E][A])k+=n[E][A].Name;else if(n[0]&&n[0][A])k+=n[0][A].Name;else{var T=(zae(n,E,a)||"").split(";;");T[A-1]?k=T[A-1]:k+="SH33TJSERRX"}l.push(k);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var P="(",K=")";if(p>=0){switch(x="",t[0][p][1][0]){case 2:P=Si(" ",t[0][p][1][1])+P;break;case 3:P=Si("\r",t[0][p][1][1])+P;break;case 4:K=Si(" ",t[0][p][1][1])+K;break;case 5:K=Si("\r",t[0][p][1][1])+K;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}l.push(P+l.pop()+K);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:b[1][1],r:b[1][0]};var le={c:r.c,r:r.r};if(n.sharedf[On(d)]){var oe=n.sharedf[On(d)];l.push(tc(oe,o,le,n,a))}else{var ie=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(tc(u[1],o,le,n,a)),ie=!0;break}ie||l.push(b[1])}break;case"PtgArray":l.push("{"+nDe(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var Ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&Ae.indexOf(t[0][v][0])==-1){b=t[0][p];var te=!0;switch(b[1][0]){case 4:te=!1;case 0:x=Si(" ",b[1][1]);break;case 5:te=!1;case 1:x=Si("\r",b[1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}l.push((te?x:"")+l.pop()+(te?"":x)),p=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function iDe(t,e,r){var n=t.l+e,a=r.biff==2?1:2,s,o=t.read_shift(a);if(o==65535)return[[],cc(t,e-2)];var l=Gw(t,o,r);return e!==o+a&&(s=$w(t,e-o-a,l,r)),t.l=n,[l,s]}function oDe(t,e,r){var n=t.l+e,a=r.biff==2?1:2,s,o=t.read_shift(a);if(o==65535)return[[],cc(t,e-2)];var l=Gw(t,o,r);return e!==o+a&&(s=$w(t,e-o-a,l,r)),t.l=n,[l,s]}function lDe(t,e,r,n){var a=t.l+e,s=Gw(t,n,r),o;return a!==t.l&&(o=$w(t,a-t.l,s,r)),[s,o]}function cDe(t,e,r){var n=t.l+e,a,s=t.read_shift(2),o=Gw(t,s,r);return s==65535?[[],cc(t,e-2)]:(e!==s+2&&(a=$w(t,n-s-2,o,r)),[o,a])}function uDe(t){var e;if(Jh(t,t.l+6)!==65535)return[ac(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function dDe(t){if(t==null){var e=cr(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return xg(t);return xg(0)}function D5(t,e,r){var n=t.l+e,a=vh(t);r.biff==2&&++t.l;var s=uDe(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var l=oDe(t,n-t.l,r);return{cell:a,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function fDe(t,e,r,n,a){var s=yg(e,r,a),o=dDe(t.v),l=cr(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=cr(t.bf.length),d=0;d<t.bf.length;++d)u[d]=t.bf[d];var f=Zo([s,o,l,u]);return f}function AP(t,e,r){var n=t.read_shift(4),a=Gw(t,n,r),s=t.read_shift(4),o=s>0?$w(t,s,a,r):null;return[a,o]}var hDe=AP,mP=AP,ADe=AP,mDe=AP,pDe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Wae={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},gDe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function i$(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function xDe(t){var e="of:="+t.replace(_R,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function R5(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function vDe(t){return t.replace(/\./,"!")}var Rb={},yv={},Mb=typeof Map<"u";function IR(t,e,r){var n=0,a=t.length;if(r){if(Mb?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Mb?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(Mb?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function pP(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(nc=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=U2(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=JS(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function qp(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Gm(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,s=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){cA(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=s;++a)if(t[a].numFmtId===n)return a;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Xae(t,e,r,n,a,s){try{n.cellNF&&(t.z=Fn[e])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Ds(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Fn[e]==null&&cA(p3e[e]||"General",e),t.t==="e")t.w=t.w||LA[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=k2(t.v);else if(t.t==="d"){var o=Do(t.v);(o|0)===o?t.w=o.toString(10):t.w=k2(o)}else{if(t.v===void 0)return"";t.w=pg(t.v,yv)}else t.t==="d"?t.w=Dd(e,Do(t.v),yv):t.w=Dd(e,t.v,yv)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=YS(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=YS(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function yDe(t,e,r){if(t&&t["!ref"]){var n=Ea(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function bDe(t,e){var r=Ea(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Xn(r))}var wDe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,NDe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,CDe=/<(?:\w:)?hyperlink [^>]*>/mg,_De=/"(\w*:\w*)"/,EDe=/<(?:\w:)?col\b[^>]*[\/]?>/g,SDe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,IDe=/<(?:\w:)?pageMargins[^>]*\/>/g,Yae=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,jDe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,PDe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function TDe(t,e,r,n,a,s,o){if(!t)return t;n||(n={"!id":{}});var l=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=t.match(NDe);f?(u=t.slice(0,f.index),d=t.slice(f.index+f[0].length)):u=d=t;var A=u.match(Yae);A?jR(A[0],l,a,r):(A=u.match(jDe))&&kDe(A[0],A[1]||"",l,a,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=u.slice(h,h+50).match(_De);m&&bDe(l,m[1])}var p=u.match(PDe);p&&p[1]&&KDe(p[1],a);var x=[];if(e.cellStyles){var v=u.match(EDe);v&&QDe(x,v)}f&&WDe(f[1],l,e,c,s,o);var y=d.match(SDe);y&&(l["!autofilter"]=HDe(y[0]));var b=[],w=d.match(wDe);if(w)for(h=0;h!=w.length;++h)b[h]=Ea(w[h].slice(w[h].indexOf('"')+1));var j=d.match(CDe);j&&MDe(l,j,n);var I=d.match(IDe);if(I&&(l["!margins"]=LDe(Dn(I[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Xn(c)),e.sheetRows>0&&l["!ref"]){var C=Ea(l["!ref"]);e.sheetRows<=+C.e.r&&(C.e.r=e.sheetRows-1,C.e.r>c.e.r&&(C.e.r=c.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>c.e.c&&(C.e.c=c.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Xn(C))}return x.length>0&&(l["!cols"]=x),b.length>0&&(l["!merges"]=b),l}function BDe(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Xn(t[r])+'"/>';return e+"</mergeCells>"}function jR(t,e,r,n){var a=Dn(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=_a(cs(a.codeName)))}function kDe(t,e,r,n,a){jR(t.slice(0,t.indexOf(">")),r,n,a)}function FDe(t,e,r,n,a){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=eh(rs(c))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),l=(l||"")+Gr("outlinePr",null,u)}!s&&!l||(a[a.length]=Gr("sheetPr",l,o))}var ODe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],DDe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function RDe(t){var e={sheet:1};return ODe.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),DDe.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=wR(t.password).toString(16).toUpperCase()),Gr("sheetProtection",null,e)}function MDe(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var s=Dn(cs(e[a]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+_a(s.location))):(s.Target="#"+_a(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=Ea(s.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=On({c:u,r:c});n?(t[c]||(t[c]=[]),t[c][u]||(t[c][u]={t:"z",v:void 0}),t[c][u].l=s):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=s)}}}function LDe(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function UDe(t){return qp(t),Gr("pageMargins",null,t)}function QDe(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=Dn(e[n],!0);a.hidden&&(a.hidden=Bs(a.hidden));var s=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,NR(a.width)),Pm(a);s<=o;)t[s++]=Rs(a)}}function VDe(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=Gr("col",null,pP(a,n)));return r[r.length]="</cols>",r.join("")}function HDe(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function $De(t,e,r,n){var a=typeof t.ref=="string"?t.ref:Xn(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=cu(a);o.s.r==o.e.r&&(o.e.r=cu(e["!ref"]).e.r,a=Xn(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Gr("autoFilter",null,{ref:a})}var GDe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function KDe(t,e){e.Views||(e.Views=[{}]),(t.match(GDe)||[]).forEach(function(r,n){var a=Dn(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),Bs(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function qDe(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Gr("sheetViews",Gr("sheetView",null,a),{})}function zDe(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=LA[t.v];break;case"d":n&&n.cellDates?a=Ds(t.v,-1).toISOString():(t=Rs(t),t.t="n",a=""+(t.v=Do(Ds(t.v)))),typeof t.z>"u"&&(t.z=Fn[14]);break;default:a=t.v;break}var l=Il("v",rs(a)),c={r:e},u=Gm(n.cellXfs,t,n);switch(u!==0&&(c.s=u),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Il("v",""+IR(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=Gr("f",rs(t.f),d)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),Gr("c",l,c)}var WDe=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=F2("v"),o=F2("f");return function(c,u,d,f,A,h){for(var m=0,p="",x=[],v=[],y=0,b=0,w=0,j="",I,C,S=0,E=0,B,k,T=0,P=0,K=Array.isArray(h.CellXf),le,oe=[],ie=[],Ae=Array.isArray(u),te=[],Te={},Ue=!1,O=!!d.sheetStubs,H=c.split(e),G=0,L=H.length;G!=L;++G){p=H[G].trim();var W=p.length;if(W!==0){var X=0;e:for(m=0;m<W;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(C=Dn(p.slice(X,m),!0),S=C.r!=null?parseInt(C.r,10):S+1,E=-1,d.sheetRows&&d.sheetRows<S)continue;Te={},Ue=!1,C.ht&&(Ue=!0,Te.hpt=parseFloat(C.ht),Te.hpx=Hv(Te.hpt)),C.hidden=="1"&&(Ue=!0,Te.hidden=!0),C.outlineLevel!=null&&(Ue=!0,Te.level=+C.outlineLevel),Ue&&(te[S-1]=Te)}break;case"<":X=m;break}if(X>=m)break;if(C=Dn(p.slice(X,m),!0),S=C.r!=null?parseInt(C.r,10):S+1,E=-1,!(d.sheetRows&&d.sheetRows<S)){f.s.r>S-1&&(f.s.r=S-1),f.e.r<S-1&&(f.e.r=S-1),d&&d.cellStyles&&(Te={},Ue=!1,C.ht&&(Ue=!0,Te.hpt=parseFloat(C.ht),Te.hpx=Hv(Te.hpt)),C.hidden=="1"&&(Ue=!0,Te.hidden=!0),C.outlineLevel!=null&&(Ue=!0,Te.level=+C.outlineLevel),Ue&&(te[S-1]=Te)),x=p.slice(m).split(t);for(var D=0;D!=x.length&&x[D].trim().charAt(0)=="<";++D);for(x=x.slice(D),m=0;m!=x.length;++m)if(p=x[m].trim(),p.length!==0){if(v=p.match(r),y=m,b=0,w=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,v!=null&&v.length===2){for(y=0,j=v[1],b=0;b!=j.length&&!((w=j.charCodeAt(b)-64)<1||w>26);++b)y=26*y+w;--y,E=y}else++E;for(b=0;b!=p.length&&p.charCodeAt(b)!==62;++b);if(++b,C=Dn(p.slice(0,b),!0),C.r||(C.r=On({r:S-1,c:E})),j=p.slice(b),I={t:""},(v=j.match(s))!=null&&v[1]!==""&&(I.v=_a(v[1])),d.cellFormula){if((v=j.match(o))!=null&&v[1]!==""){if(I.f=_a(cs(v[1])).replace(/\r\n/g,`
`),d.xlfn||(I.f=r$(I.f)),v[0].indexOf('t="array"')>-1)I.F=(j.match(a)||[])[1],I.F.indexOf(":")>-1&&oe.push([Ea(I.F),I.F]);else if(v[0].indexOf('t="shared"')>-1){k=Dn(v[0]);var Q=_a(cs(v[1]));d.xlfn||(Q=r$(Q)),ie[parseInt(k.si,10)]=[k,Q,C.r]}}else(v=j.match(/<f[^>]*\/>/))&&(k=Dn(v[0]),ie[k.si]&&(I.f=GFe(ie[k.si][1],ie[k.si][2],C.r)));var Z=di(C.r);for(b=0;b<oe.length;++b)Z.r>=oe[b][0].s.r&&Z.r<=oe[b][0].e.r&&Z.c>=oe[b][0].s.c&&Z.c<=oe[b][0].e.c&&(I.F=oe[b][1])}if(C.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(O)I.t="z";else continue;else I.t=C.t||"n";switch(f.s.c>E&&(f.s.c=E),f.e.c<E&&(f.e.c=E),I.t){case"n":if(I.v==""||I.v==null){if(!O)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!O)continue;I.t="z"}else B=Rb[parseInt(I.v,10)],I.v=B.t,I.r=B.r,d.cellHTML&&(I.h=B.h);break;case"str":I.t="s",I.v=I.v!=null?cs(I.v):"",d.cellHTML&&(I.h=oR(I.v));break;case"inlineStr":v=j.match(n),I.t="s",v!=null&&(B=bR(v[1]))?(I.v=B.t,d.cellHTML&&(I.h=B.h)):I.v="";break;case"b":I.v=Bs(I.v);break;case"d":d.cellDates?I.v=Ds(I.v,1):(I.v=Do(Ds(I.v,1)),I.t="n");break;case"e":(!d||d.cellText!==!1)&&(I.w=I.v),I.v=Zne[I.v];break}if(T=P=0,le=null,K&&C.s!==void 0&&(le=h.CellXf[C.s],le!=null&&(le.numFmtId!=null&&(T=le.numFmtId),d.cellStyles&&le.fillId!=null&&(P=le.fillId))),Xae(I,T,P,d,A,h),d.cellDates&&K&&I.t=="n"&&y1(Fn[T])&&(I.t="d",I.v=fP(I.v)),C.cm&&d.xlmeta){var be=(d.xlmeta.Cell||[])[+C.cm-1];be&&be.type=="XLDAPR"&&(I.D=!0)}if(Ae){var U=di(C.r);u[U.r]||(u[U.r]=[]),u[U.r][U.c]=I}else u[C.r]=I}}}}te.length>0&&(u["!rows"]=te)}}();function XDe(t,e,r,n){var a=[],s=[],o=Ea(t["!ref"]),l="",c,u="",d=[],f=0,A=0,h=t["!rows"],m=Array.isArray(t),p={r:u},x,v=-1;for(A=o.s.c;A<=o.e.c;++A)d[A]=ui(A);for(f=o.s.r;f<=o.e.r;++f){for(s=[],u=Wi(f),A=o.s.c;A<=o.e.c;++A){c=d[A]+u;var y=m?(t[f]||[])[A]:t[c];y!==void 0&&(l=zDe(y,c,t,e))!=null&&s.push(l)}(s.length>0||h&&h[f])&&(p={r:u},h&&h[f]&&(x=h[f],x.hidden&&(p.hidden=1),v=-1,x.hpx?v=Q2(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(p.ht=v,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),a[a.length]=Gr("row",s.join(""),p))}if(h)for(;f<h.length;++f)h&&h[f]&&(p={r:f+1},x=h[f],x.hidden&&(p.hidden=1),v=-1,x.hpx?v=Q2(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(p.ht=v,p.customHeight=1),x.level&&(p.outlineLevel=x.level),a[a.length]=Gr("row","",p));return a.join("")}function Jae(t,e,r,n){var a=[Yi,Gr("worksheet",null,{xmlns:Ug[0],"xmlns:r":To.r})],s=r.SheetNames[t],o=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=Ea(u);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Xn(d)}n||(n={}),c["!comments"]=[];var f=[];FDe(c,r,t,e,a),a[a.length]=Gr("dimension",null,{ref:u}),a[a.length]=qDe(c,e,t,r),e.sheetFormat&&(a[a.length]=Gr("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=VDe(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=XDe(c,e),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=RDe(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=$De(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=BDe(c["!merges"]));var A=-1,h,m=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=Ja(n,-1,rs(p[1].Target).replace(/#.*$/,""),ia.HLINK),h["r:id"]="rId"+m),(A=p[1].Target.indexOf("#"))>-1&&(h.location=rs(p[1].Target.slice(A+1))),p[1].Tooltip&&(h.tooltip=rs(p[1].Tooltip)),a[a.length]=Gr("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=UDe(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=Il("ignoredErrors",Gr("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(m=Ja(n,-1,"../drawings/drawing"+(t+1)+".xml",ia.DRAW),a[a.length]=Gr("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=f),c["!comments"].length>0&&(m=Ja(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ia.VML),a[a.length]=Gr("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function YDe(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function JDe(t,e,r){var n=cr(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;a.hpx?s=Q2(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var f=-1,A=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[On(u)];m&&(f<0&&(f=h),A=h)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,A))}var p=n.l;return n.l=c,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function ZDe(t,e,r,n){var a=JDe(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Nr(t,0,a)}var e6e=$g,t6e=N1;function r6e(){}function n6e(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=i5e(t),r}function a6e(t,e,r){r==null&&(r=cr(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return zS({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),zne(t,r),r.slice(0,r.l)}function s6e(t){var e=Vd(t);return[e]}function i6e(t,e,r){return r==null&&(r=cr(8)),Qg(e,r)}function o6e(t){var e=Vg(t);return[e]}function l6e(t,e,r){return r==null&&(r=cr(4)),Hg(e,r)}function c6e(t){var e=Vd(t),r=t.read_shift(1);return[e,r,"b"]}function u6e(t,e,r){return r==null&&(r=cr(9)),Qg(e,r),r.write_shift(1,t.v?1:0),r}function d6e(t){var e=Vg(t),r=t.read_shift(1);return[e,r,"b"]}function f6e(t,e,r){return r==null&&(r=cr(5)),Hg(e,r),r.write_shift(1,t.v?1:0),r}function h6e(t){var e=Vd(t),r=t.read_shift(1);return[e,r,"e"]}function A6e(t,e,r){return r==null&&(r=cr(9)),Qg(e,r),r.write_shift(1,t.v),r}function m6e(t){var e=Vg(t),r=t.read_shift(1);return[e,r,"e"]}function p6e(t,e,r){return r==null&&(r=cr(8)),Hg(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function g6e(t){var e=Vd(t),r=t.read_shift(4);return[e,r,"s"]}function x6e(t,e,r){return r==null&&(r=cr(12)),Qg(e,r),r.write_shift(4,e.v),r}function v6e(t){var e=Vg(t),r=t.read_shift(4);return[e,r,"s"]}function y6e(t,e,r){return r==null&&(r=cr(8)),Hg(e,r),r.write_shift(4,e.v),r}function b6e(t){var e=Vd(t),r=ac(t);return[e,r,"n"]}function w6e(t,e,r){return r==null&&(r=cr(16)),Qg(e,r),xg(t.v,r),r}function Zae(t){var e=Vg(t),r=ac(t);return[e,r,"n"]}function N6e(t,e,r){return r==null&&(r=cr(12)),Hg(e,r),xg(t.v,r),r}function C6e(t){var e=Vd(t),r=pR(t);return[e,r,"n"]}function _6e(t,e,r){return r==null&&(r=cr(12)),Qg(e,r),Wne(t.v,r),r}function E6e(t){var e=Vg(t),r=pR(t);return[e,r,"n"]}function S6e(t,e,r){return r==null&&(r=cr(8)),Hg(e,r),Wne(t.v,r),r}function I6e(t){var e=Vd(t),r=hR(t);return[e,r,"is"]}function j6e(t){var e=Vd(t),r=ic(t);return[e,r,"str"]}function P6e(t,e,r){return r==null&&(r=cr(12+4*t.v.length)),Qg(e,r),el(t.v,r),r.length>r.l?r.slice(0,r.l):r}function T6e(t){var e=Vg(t),r=ic(t);return[e,r,"str"]}function B6e(t,e,r){return r==null&&(r=cr(8+4*t.v.length)),Hg(e,r),el(t.v,r),r.length>r.l?r.slice(0,r.l):r}function k6e(t,e,r){var n=t.l+e,a=Vd(t);a.r=r["!row"];var s=t.read_shift(1),o=[a,s,"b"];if(r.cellFormula){t.l+=2;var l=mP(t,n-t.l,r);o[3]=tc(l,null,a,r.supbooks,r)}else t.l=n;return o}function F6e(t,e,r){var n=t.l+e,a=Vd(t);a.r=r["!row"];var s=t.read_shift(1),o=[a,s,"e"];if(r.cellFormula){t.l+=2;var l=mP(t,n-t.l,r);o[3]=tc(l,null,a,r.supbooks,r)}else t.l=n;return o}function O6e(t,e,r){var n=t.l+e,a=Vd(t);a.r=r["!row"];var s=ac(t),o=[a,s,"n"];if(r.cellFormula){t.l+=2;var l=mP(t,n-t.l,r);o[3]=tc(l,null,a,r.supbooks,r)}else t.l=n;return o}function D6e(t,e,r){var n=t.l+e,a=Vd(t);a.r=r["!row"];var s=ic(t),o=[a,s,"str"];if(r.cellFormula){t.l+=2;var l=mP(t,n-t.l,r);o[3]=tc(l,null,a,r.supbooks,r)}else t.l=n;return o}var R6e=$g,M6e=N1;function L6e(t,e){return e==null&&(e=cr(4)),e.write_shift(4,t),e}function U6e(t,e){var r=t.l+e,n=$g(t),a=AR(t),s=ic(t),o=ic(t),l=ic(t);t.l=r;var c={rfx:n,relId:a,loc:s,display:l};return o&&(c.Tooltip=o),c}function Q6e(t,e){var r=cr(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));N1({s:di(t[0]),e:di(t[0])},r),mR("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return el(a||"",r),el(t[1].Tooltip||"",r),el("",r),r.slice(0,r.l)}function V6e(){}function H6e(t,e,r){var n=t.l+e,a=Xne(t),s=t.read_shift(1),o=[a];if(o[2]=s,r.cellFormula){var l=hDe(t,n-t.l,r);o[1]=l}else t.l=n;return o}function $6e(t,e,r){var n=t.l+e,a=$g(t),s=[a];if(r.cellFormula){var o=mDe(t,n-t.l,r);s[1]=o,t.l=n}else t.l=n;return s}function G6e(t,e,r){r==null&&(r=cr(18));var n=pP(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var ese=["left","right","top","bottom","header","footer"];function K6e(t){var e={};return ese.forEach(function(r){e[r]=ac(t)}),e}function q6e(t,e){return e==null&&(e=cr(6*8)),qp(t),ese.forEach(function(r){xg(t[r],e)}),e}function z6e(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function W6e(t,e,r){r==null&&(r=cr(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function X6e(t){var e=cr(24);return e.write_shift(4,4),e.write_shift(4,1),N1(t,e),e}function Y6e(t,e){return e==null&&(e=cr(16*4+2)),e.write_shift(2,t.password?wR(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function J6e(){}function Z6e(){}function eRe(t,e,r,n,a,s,o){if(!t)return t;var l=e||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,A=!1,h,m,p,x,v,y,b,w,j,I=[];l.biff=12,l["!row"]=0;var C=0,S=!1,E=[],B={},k=l.supbooks||a.supbooks||[[]];if(k.sharedf=B,k.arrayf=E,k.SheetNames=a.SheetNames||a.Sheets.map(function(Ae){return Ae.name}),!l.supbooks&&(l.supbooks=k,a.Names))for(var T=0;T<a.Names.length;++T)k[0][T+1]=a.Names[T];var P=[],K=[],le=!1;V2[16]={n:"BrtShortReal",f:Zae};var oe;if(MA(t,function(te,Te,Ue){if(!A)switch(Ue){case 148:u=te;break;case 0:h=te,l.sheetRows&&l.sheetRows<=h.r&&(A=!0),w=Wi(x=h.r),l["!row"]=h.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=Hv(te.hpt)),K[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:te[2]},te[2]){case"n":m.v=te[1];break;case"s":b=Rb[te[1]],m.v=b.t,m.r=b.r;break;case"b":m.v=!!te[1];break;case"e":m.v=te[1],l.cellText!==!1&&(m.w=LA[m.v]);break;case"str":m.t="s",m.v=te[1];break;case"is":m.t="s",m.v=te[1].t;break}if((p=o.CellXf[te[0].iStyleRef])&&Xae(m,p.numFmtId,null,l,s,o),v=te[0].c==-1?v+1:te[0].c,l.dense?(c[x]||(c[x]=[]),c[x][v]=m):c[ui(v)+w]=m,l.cellFormula){for(S=!1,C=0;C<E.length;++C){var O=E[C];h.r>=O[0].s.r&&h.r<=O[0].e.r&&v>=O[0].s.c&&v<=O[0].e.c&&(m.F=Xn(O[0]),S=!0)}!S&&te.length>3&&(m.f=te[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),l.cellDates&&p&&m.t=="n"&&y1(Fn[p.numFmtId])){var H=Pp(m.v);H&&(m.t="d",m.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}oe&&(oe.type=="XLDAPR"&&(m.D=!0),oe=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;m={t:"z",v:void 0},v=te[0].c==-1?v+1:te[0].c,l.dense?(c[x]||(c[x]=[]),c[x][v]=m):c[ui(v)+w]=m,d.s.r>h.r&&(d.s.r=h.r),d.s.c>v&&(d.s.c=v),d.e.r<h.r&&(d.e.r=h.r),d.e.c<v&&(d.e.c=v),oe&&(oe.type=="XLDAPR"&&(m.D=!0),oe=void 0);break;case 176:I.push(te);break;case 49:oe=((l.xlmeta||{}).Cell||[])[te-1];break;case 494:var G=n["!id"][te.relId];for(G?(te.Target=G.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=G):te.relId==""&&(te.Target="#"+te.loc),x=te.rfx.s.r;x<=te.rfx.e.r;++x)for(v=te.rfx.s.c;v<=te.rfx.e.c;++v)l.dense?(c[x]||(c[x]=[]),c[x][v]||(c[x][v]={t:"z",v:void 0}),c[x][v].l=te):(y=On({c:v,r:x}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=te);break;case 426:if(!l.cellFormula)break;E.push(te),j=l.dense?c[x][v]:c[ui(v)+w],j.f=tc(te[1],d,{r:h.r,c:v},k,l),j.F=Xn(te[0]);break;case 427:if(!l.cellFormula)break;B[On(te[0].s)]=te[1],j=l.dense?c[x][v]:c[ui(v)+w],j.f=tc(te[1],d,{r:h.r,c:v},k,l);break;case 60:if(!l.cellStyles)break;for(;te.e>=te.s;)P[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},le||(le=!0,NR(te.w/256)),Pm(P[te.e+1]);break;case 161:c["!autofilter"]={ref:Xn(te)};break;case 476:c["!margins"]=te;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),te.name&&(a.Sheets[r].CodeName=te.name),(te.above||te.left)&&(c["!outline"]={above:te.above,left:te.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),te.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!Te.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+Ue.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Xn(u||d)),l.sheetRows&&c["!ref"]){var ie=Ea(c["!ref"]);l.sheetRows<=+ie.e.r&&(ie.e.r=l.sheetRows-1,ie.e.r>d.e.r&&(ie.e.r=d.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>d.e.c&&(ie.e.c=d.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Xn(ie))}return I.length>0&&(c["!merges"]=I),P.length>0&&(c["!cols"]=P),K.length>0&&(c["!rows"]=K),c}function tRe(t,e,r,n,a,s,o){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=Rs(e),e.z=e.z||Fn[14],e.v=Do(Ds(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var c={r,c:n};switch(c.s=Gm(a.cellXfs,e,a),e.l&&s["!links"].push([On(c),e.l]),e.c&&s["!comments"].push([On(c),e.c]),e.t){case"s":case"str":return a.bookSST?(l=IR(a.Strings,e.v,a.revStrings),c.t="s",c.v=l,o?Nr(t,18,y6e(e,c)):Nr(t,7,x6e(e,c))):(c.t="str",o?Nr(t,17,B6e(e,c)):Nr(t,6,P6e(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Nr(t,13,S6e(e,c)):Nr(t,2,_6e(e,c)):o?Nr(t,16,N6e(e,c)):Nr(t,5,w6e(e,c)),!0;case"b":return c.t="b",o?Nr(t,15,f6e(e,c)):Nr(t,4,u6e(e,c)),!0;case"e":return c.t="e",o?Nr(t,14,p6e(e,c)):Nr(t,3,A6e(e,c)),!0}return o?Nr(t,12,l6e(e,c)):Nr(t,1,i6e(e,c)),!0}function rRe(t,e,r,n){var a=Ea(e["!ref"]||"A1"),s,o="",l=[];Nr(t,145);var c=Array.isArray(e),u=a.e.r;e["!rows"]&&(u=Math.max(a.e.r,e["!rows"].length-1));for(var d=a.s.r;d<=u;++d){o=Wi(d),ZDe(t,e,a,d);var f=!1;if(d<=a.e.r)for(var A=a.s.c;A<=a.e.c;++A){d===a.s.r&&(l[A]=ui(A)),s=l[A]+o;var h=c?(e[d]||[])[A]:e[s];if(!h){f=!1;continue}f=tRe(t,h,d,A,n,e,f)}}Nr(t,146)}function nRe(t,e){!e||!e["!merges"]||(Nr(t,177,L6e(e["!merges"].length)),e["!merges"].forEach(function(r){Nr(t,176,M6e(r))}),Nr(t,178))}function aRe(t,e){!e||!e["!cols"]||(Nr(t,390),e["!cols"].forEach(function(r,n){r&&Nr(t,60,G6e(n,r))}),Nr(t,391))}function sRe(t,e){!e||!e["!ref"]||(Nr(t,648),Nr(t,649,X6e(Ea(e["!ref"]))),Nr(t,650))}function iRe(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=Ja(r,-1,n[1].Target.replace(/#.*$/,""),ia.HLINK);Nr(t,494,Q6e(n,a))}}),delete e["!links"]}function oRe(t,e,r,n){if(e["!comments"].length>0){var a=Ja(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ia.VML);Nr(t,551,mR("rId"+a)),e["!legacy"]=a}}function lRe(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],s=typeof a.ref=="string"?a.ref:Xn(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=cu(s);l.s.r==l.e.r&&(l.e.r=cu(e["!ref"]).e.r,s=Xn(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Nr(t,161,N1(Ea(s))),Nr(t,162)}}function cRe(t,e,r){Nr(t,133),Nr(t,137,W6e(e,r)),Nr(t,138),Nr(t,134)}function uRe(t,e){e["!protect"]&&Nr(t,535,Y6e(e["!protect"]))}function dRe(t,e,r,n){var a=lu(),s=r.SheetNames[t],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var c=Ea(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Nr(a,129),(r.vbaraw||o["!outline"])&&Nr(a,147,a6e(l,o["!outline"])),Nr(a,148,t6e(c)),cRe(a,o,r.Workbook),aRe(a,o),rRe(a,o,t,e),uRe(a,o),lRe(a,o,r,t),nRe(a,o),iRe(a,o,n),o["!margins"]&&Nr(a,476,q6e(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&sRe(a,o),oRe(a,o,t,n),Nr(a,130),a.end()}function fRe(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var a=_a((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,a,n]}function hRe(t,e,r,n,a,s){var o=s||{"!type":"chart"};if(!t)return s;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var A=fRe(f);d.s.r=d.s.c=0,d.e.c=l,u=ui(l),A[0].forEach(function(h,m){o[u+Wi(m)]={t:"n",v:h,z:A[1]},c=m}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=Xn(d)),o}function ARe(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=t.match(Yae);return l&&jR(l[0],s,a,r),(o=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function mRe(t,e){t.l+=10;var r=ic(t);return{name:r}}function pRe(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return MA(t,function(c,u,d){switch(d){case 550:s["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var PR=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],gRe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],xRe=[],vRe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function o$(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var s=e[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Bs(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function l$(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Bs(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function tse(t){l$(t.WBProps,PR),l$(t.CalcPr,vRe),o$(t.WBView,gRe),o$(t.Sheets,xRe),yv.date1904=Bs(t.WBProps.date1904)}function yRe(t){return!t.Workbook||!t.Workbook.WBProps?"false":Bs(t.Workbook.WBProps.date1904)?"true":"false"}var bRe="][*?/\\".split("");function rse(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return bRe.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function wRe(t,e,r){t.forEach(function(n,a){rse(n);for(var s=0;s<a;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[a]&&e[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function NRe(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];wRe(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)yDe(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var CRe=/<\w+:workbook/;function _Re(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},o=0;if(t.replace(uc,function(c,u){var d=Dn(c);switch(xh(d[0])){case"<?xml":break;case"<workbook":c.match(CRe)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":PR.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Bs(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=cs(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=_a(cs(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=cs(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),Bs(d.hidden||"0")&&(s.Hidden=!0),o=u+c.length;break;case"</definedName>":s.Ref=_a(cs(t.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),Ug.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return tse(r),r}function nse(t){var e=[Yi];e[e.length]=Gr("workbook",null,{xmlns:Ug[0],"xmlns:r":To.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(PR.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Gr("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:rs(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Gr("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(e[e.length]=Gr("definedName",rs(l.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function ERe(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Zk(t),r.name=ic(t),r}function SRe(t,e){return e||(e=cr(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),mR(t.strRelID,e),el(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function IRe(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?ic(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function jRe(t,e){e||(e=cr(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),zne(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function PRe(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function TRe(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),s=o5e(t),o=ADe(t,0,r),l=AR(t);t.l=n;var c={Name:s,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function BRe(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],V2[16]={n:"BrtFRTArchID$",f:PRe},MA(t,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=tc(c.Ptg,null,null,o,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),tse(r),r.Names=s,r.supbooks=o,r}function kRe(t,e){Nr(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Nr(t,156,SRe(a))}Nr(t,144)}function FRe(t,e){e||(e=cr(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return el("SheetJS",e),el(QS.version,e),el(QS.version,e),el("7262",e),e.length>e.l?e.slice(0,e.l):e}function ORe(t,e){e||(e=cr(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function DRe(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(Nr(t,135),Nr(t,158,ORe(a)),Nr(t,136))}}function RRe(t,e){var r=lu();return Nr(r,131),Nr(r,128,FRe()),Nr(r,153,jRe(t.Workbook&&t.Workbook.WBProps||null)),DRe(r,t),kRe(r,t),Nr(r,132),r.end()}function MRe(t,e,r){return e.slice(-4)===".bin"?BRe(t,r):_Re(t,r)}function LRe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?eRe(t,n,r,a,s,o,l):TDe(t,n,r,a,s,o,l)}function URe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?pRe(t,n,r,a,s):ARe(t,n,r,a,s)}function QRe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?HFe():$Fe()}function VRe(t,e,r,n,a,s,o,l){return e.slice(-4)===".bin"?QFe():VFe()}function HRe(t,e,r,n){return e.slice(-4)===".bin"?Mke(t,r,n):Eke(t,r,n)}function $Re(t,e,r){return Rae(t,r)}function GRe(t,e,r){return e.slice(-4)===".bin"?GBe(t,r):VBe(t,r)}function KRe(t,e,r){return e.slice(-4)===".bin"?DFe(t,r):SFe(t,r)}function qRe(t,e,r){return e.slice(-4)===".bin"?CFe(t):wFe(t)}function zRe(t,e,r,n){return r.slice(-4)===".bin"?_Fe(t,e,r,n):void 0}function WRe(t,e,r){return e.slice(-4)===".bin"?vFe(t,e,r):bFe(t,e,r)}function XRe(t,e,r){return(e.slice(-4)===".bin"?RRe:nse)(t)}function YRe(t,e,r,n,a){return(e.slice(-4)===".bin"?dRe:Jae)(t,r,n,a)}function JRe(t,e,r){return(e.slice(-4)===".bin"?zke:Oae)(t,r)}function ZRe(t,e,r){return(e.slice(-4)===".bin"?zBe:Sae)(t,r)}function eMe(t,e,r){return(e.slice(-4)===".bin"?RFe:Uae)(t)}function tMe(t){return(t.slice(-4)===".bin"?yFe:Mae)()}var ase=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,sse=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Yd(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(ase),s,o,l,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(sse),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function rMe(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(ase),a,s,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(sse),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),r[o]=a[2].slice(1,a[2].length-1));return r}var Lb;function nMe(t,e){var r=Lb[t]||_a(t);return r==="General"?pg(e):Dd(r,e)}function aMe(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Bs(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Ds(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[_a(e)]=a}function sMe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||LA[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=k2(t.v):t.w=pg(t.v):t.w=nMe(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Lb[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&y1(n)){var a=Pp(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function iMe(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=xke[n.Pattern]||n.Pattern)}t[e.ID]=e}function oMe(t,e,r,n,a,s,o,l,c,u){var d="General",f=n.StyleID,A={};u=u||{};var h=[],m=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&h.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Bs(t);break;case"String":n.t="s",n.r=_H(_a(t)),n.v=t.indexOf("<")>-1?_a(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Ds(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=_a(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Zne[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=_H(e||t));break}if(sMe(n,d,u),u.cellFormula!==!1)if(n.Formula){var p=_a(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=vv(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=vv("RC:RC",a):n.ArrayRange&&(n.F=vv(n.ArrayRange,a),c.push([Ea(n.F),n.F]))}else for(m=0;m<c.length;++m)a.r>=c[m][0].s.r&&a.r<=c[m][0].e.r&&a.c>=c[m][0].s.c&&a.c<=c[m][0].e.c&&(n.F=c[m][1]);u.cellStyles&&(h.forEach(function(x){!A.patternType&&x.patternType&&(A.patternType=x.patternType)}),n.s=A),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function lMe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function M5(t,e){var r=e||{};b1();var n=Xy(lR(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=cs(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=Rs(r);return o.type="string",Vv.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Be){a.indexOf("<"+Be)>=0&&(s=!0)}),s)return qMe(n,r);Lb={"General Number":"General","General Date":Fn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Fn[15],"Short Date":Fn[14],"Long Time":Fn[19],"Medium Time":Fn[18],"Short Time":Fn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Fn[2],Standard:Fn[4],Percent:Fn[10],Scientific:Fn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],A=r.dense?[]:{},h="",m={},p={},x=Yd('<Data ss:Type="String">'),v=0,y=0,b=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},I={},C="",S=0,E=[],B={},k={},T=0,P=[],K=[],le={},oe=[],ie,Ae=!1,te=[],Te=[],Ue={},O=0,H=0,G={Sheets:[],WBProps:{date1904:!1}},L={};D2.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var W="";l=D2.exec(n);)switch(l[3]=(W=l[3]).toLowerCase()){case"data":if(W=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?oMe(n.slice(v,l.index),C,x,c[c.length-1][0]=="comment"?le:m,{c:y,r:b},j,oe[y],p,te,r):(C="",x=Yd(l[0]),v=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(K.length>0&&(m.c=K),(!r.sheetRows||r.sheetRows>b)&&m.v!==void 0&&(r.dense?(A[b]||(A[b]=[]),A[b][y]=m):A[ui(y)+Wi(b)]=m),m.HRef&&(m.l={Target:_a(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(O=y+(parseInt(m.MergeAcross,10)|0),H=b+(parseInt(m.MergeDown,10)|0),E.push({s:{c:y,r:b},e:{c:O,r:H}})),!r.sheetStubs)m.MergeAcross?y=O+1:++y;else if(m.MergeAcross||m.MergeDown){for(var X=y;X<=O;++X)for(var D=b;D<=H;++D)(X>y||D>b)&&(r.dense?(A[D]||(A[D]=[]),A[D][X]={t:"z"}):A[ui(X)+Wi(D)]={t:"z"});y=O+1}else++y;else m=rMe(l[0]),m.Index&&(y=+m.Index-1),y<w.s.c&&(w.s.c=y),y>w.e.c&&(w.e.c=y),l[0].slice(-2)==="/>"&&++y,K=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(b<w.s.r&&(w.s.r=b),b>w.e.r&&(w.e.r=b),l[0].slice(-2)==="/>"&&(p=Yd(l[0]),p.Index&&(b=+p.Index-1)),y=0,++b):(p=Yd(l[0]),p.Index&&(b=+p.Index-1),Ue={},(p.AutoFitHeight=="0"||p.Height)&&(Ue.hpx=parseInt(p.Height,10),Ue.hpt=Q2(Ue.hpx),Te[b]=Ue),p.Hidden=="1"&&(Ue.hidden=!0,Te[b]=Ue));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(h),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(A["!ref"]=Xn(w),r.sheetRows&&r.sheetRows<=w.e.r&&(A["!fullref"]=A["!ref"],w.e.r=r.sheetRows-1,A["!ref"]=Xn(w))),E.length&&(A["!merges"]=E),oe.length>0&&(A["!cols"]=oe),Te.length>0&&(A["!rows"]=Te),d[h]=A}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=y=0,c.push([l[3],!1]),u=Yd(l[0]),h=_a(u.Name),A=r.dense?[]:{},E=[],te=[],Te=[],L={name:h,Hidden:0},G.Sheets.push(L);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),oe=[],Ae=!1}break;case"style":l[1]==="/"?iMe(j,I,r):I=Yd(l[0]);break;case"numberformat":I.nf=_a(Yd(l[0]).Format||"General"),Lb[I.nf]&&(I.nf=Lb[I.nf]);for(var Q=0;Q!=392&&Fn[Q]!=I.nf;++Q);if(Q==392){for(Q=57;Q!=392;++Q)if(Fn[Q]==null){cA(I.nf,Q);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ie=Yd(l[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!Ae&&ie.wpx>10){Ae=!0,nc=kae;for(var Z=0;Z<oe.length;++Z)oe[Z]&&Pm(oe[Z])}Ae&&Pm(ie),oe[ie.Index-1||oe.length]=ie;for(var be=0;be<+ie.Span;++be)oe[oe.length]=Rs(ie);break;case"namedrange":if(l[1]==="/")break;G.Names||(G.Names=[]);var U=Dn(l[0]),ze={Name:U.Name,Ref:vv(U.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(ze.Sheet=G.Sheets.length-1),G.Names.push(ze);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?C+=n.slice(S,l.index):S=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;I.Interior=Yd(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?B5e(B,W,n.slice(T,l.index)):T=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));lMe(le),K.push(le)}else c.push([l[3],!1]),u=Yd(l[0]),le={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var re=Yd(l[0]);A["!autofilter"]={ref:vv(re.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return h$(n,r);var J=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(l[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:J=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(T,l.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else T=l.index+l[0].length;break;case"header":A["!margins"]||qp(A["!margins"]={},"xlml"),isNaN(+Dn(l[0]).Margin)||(A["!margins"].header=+Dn(l[0]).Margin);break;case"footer":A["!margins"]||qp(A["!margins"]={},"xlml"),isNaN(+Dn(l[0]).Margin)||(A["!margins"].footer=+Dn(l[0]).Margin);break;case"pagemargins":var Re=Dn(l[0]);A["!margins"]||qp(A["!margins"]={},"xlml"),isNaN(+Re.Top)||(A["!margins"].top=+Re.Top),isNaN(+Re.Left)||(A["!margins"].left=+Re.Left),isNaN(+Re.Right)||(A["!margins"].right=+Re.Right),isNaN(+Re.Bottom)||(A["!margins"].bottom=+Re.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":A["!outline"]||(A["!outline"]={}),A["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":A["!outline"]||(A["!outline"]={}),A["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:J=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:J=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:J=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:J=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1;break}if(J||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?aMe(k,W,P,n.slice(T,l.index)):(P=l,T=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ke={};return!r.bookSheets&&!r.bookProps&&(ke.Sheets=d),ke.SheetNames=f,ke.Workbook=G,ke.SSF=Rs(Fn),ke.Props=B,ke.Custprops=k,ke}function iF(t,e){switch(BR(e=e||{}),e.type||"base64"){case"base64":return M5($u(t),e);case"binary":case"buffer":case"file":return M5(t,e);case"array":return M5(Hm(t),e)}}function cMe(t,e){var r=[];return t.Props&&r.push(k5e(t.Props,e)),t.Custprops&&r.push(F5e(t.Props,t.Custprops)),r.join("")}function uMe(){return""}function dMe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var s=[];s.push(Gr("NumberFormat",null,{"ss:Format":rs(Fn[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(Gr("Style",s.join(""),o))}),Gr("Styles",r.join(""))}function ise(t){return Gr("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+ER(t.Ref,{r:0,c:0})})}function fMe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(ise(a)))}return Gr("Names",r.join(""))}function hMe(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(ise(l)))}return s.join("")}function AMe(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Gr("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Gr("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Gr("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Gr("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(Il("ProtectContents","True")),t["!protect"].objects&&a.push(Il("ProtectObjects","True")),t["!protect"].scenarios&&a.push(Il("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(Il("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(Il("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":Gr("WorksheetOptions",a.join(""),{xmlns:ju.x})}function mMe(t){return t.map(function(e){var r=D3e(e.t||""),n=Gr("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Gr("Comment",n,{"ss:Author":e.a})}).join("")}function pMe(t,e,r,n,a,s,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+rs(ER(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var c=di(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=rs(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=rs(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",A="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",A=String(t.v);break;case"b":f="Boolean",A=t.v?"1":"0";break;case"e":f="Error",A=LA[t.v];break;case"d":f="DateTime",A=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Fn[14]);break;case"s":f="String",A=O3e(t.v||"");break}var h=Gm(n.cellXfs,t,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var m=t.v!=null?A:"",p=t.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(t.c||[]).length>0&&(p+=mMe(t.c)),Gr("Cell",p,l)}function gMe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Hv(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function xMe(t,e,r,n){if(!t["!ref"])return"";var a=Ea(t["!ref"]),s=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(x,v){Pm(x);var y=!!x.width,b=pP(v,x),w={"ss:Index":v+1};y&&(w["ss:Width"]=L2(b.width)),x.hidden&&(w["ss:Hidden"]="1"),l.push(Gr("Column",null,w))});for(var c=Array.isArray(t),u=a.s.r;u<=a.e.r;++u){for(var d=[gMe(u,(t["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var A=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>u)&&!(s[o].e.c<f)&&!(s[o].e.r<u)){(s[o].s.c!=f||s[o].s.r!=u)&&(A=!0);break}if(!A){var h={r:u,c:f},m=On(h),p=c?(t[u]||[])[f]:t[m];d.push(pMe(p,m,t,e,r,n,h))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function vMe(t,e,r){var n=[],a=r.SheetNames[t],s=r.Sheets[a],o=s?hMe(s,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?xMe(s,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(AMe(s,e,t,r)),n.join("")}function yMe(t,e){e||(e={}),t.SSF||(t.SSF=Rs(Fn)),t.SSF&&(b1(),cP(t.SSF),e.revssf=dP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Gm(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(cMe(t,e)),r.push(uMe()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Gr("Worksheet",vMe(n,e,t),{"ss:Name":rs(t.SheetNames[n])}));return r[2]=dMe(t,e),r[3]=fMe(t),Yi+Gr("Workbook",r.join(""),{xmlns:ju.ss,"xmlns:o":ju.o,"xmlns:x":ju.x,"xmlns:ss":ju.ss,"xmlns:dt":ju.dt,"xmlns:html":ju.html})}function bMe(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=f5e(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=h5e(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var wMe=[60,1084,2066,2165,2175];function NMe(t,e,r,n,a){var s=n,o=[],l=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=s;for(var c=Jh(r,r.l),u=oF[c],d=0;u!=null&&wMe.indexOf(c)>-1;)s=Jh(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+s),o.push(l),r.l+=4+s,u=oF[c=Jh(r,r.l)];var f=Zo(o);El(f,0);var A=0;f.lens=[];for(var h=0;h<o.length;++h)f.lens.push(A),A+=o[h].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,a)}function Lf(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Fn[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||LA[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=k2(t.v):t.w=pg(t.v):t.w=Dd(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&y1(Fn[n]||String(n))){var a=Pp(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function YC(t,e,r){return{v:t,ixfe:e,t:r}}function CMe(t,e){var r={opts:{}},n={},a=e.dense?[]:{},s={},o={},l=null,c=[],u="",d={},f,A="",h,m,p,x,v={},y=[],b,w,j=[],I=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},E=function(dt){return dt<8?$p[dt]:dt<64&&I[dt-8]||$p[dt]},B=function(dt,ce,we){var ue=ce.XF.data;if(!(!ue||!ue.patternType||!we||!we.cellStyles)){ce.s={},ce.s.patternType=ue.patternType;var ne;(ne=M2(E(ue.icvFore)))&&(ce.s.fgColor={rgb:ne}),(ne=M2(E(ue.icvBack)))&&(ce.s.bgColor={rgb:ne})}},k=function(dt,ce,we){if(!(Ue>1)&&!(we.sheetRows&&dt.r>=we.sheetRows)){if(we.cellStyles&&ce.XF&&ce.XF.data&&B(dt,ce,we),delete ce.ixfe,delete ce.XF,f=dt,A=On(dt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<o.s.r&&(o.s.r=dt.r),dt.c<o.s.c&&(o.s.c=dt.c),dt.r+1>o.e.r&&(o.e.r=dt.r+1),dt.c+1>o.e.c&&(o.e.c=dt.c+1),we.cellFormula&&ce.f){for(var ue=0;ue<y.length;++ue)if(!(y[ue][0].s.c>dt.c||y[ue][0].s.r>dt.r)&&!(y[ue][0].e.c<dt.c||y[ue][0].e.r<dt.r)){ce.F=Xn(y[ue][0]),(y[ue][0].s.c!=dt.c||y[ue][0].s.r!=dt.r)&&delete ce.f,ce.f&&(ce.f=""+tc(y[ue][1],o,dt,te,T));break}}we.dense?(a[dt.r]||(a[dt.r]=[]),a[dt.r][dt.c]=ce):a[A]=ce}},T={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(T.password=e.password);var P,K=[],le=[],oe=[],ie=[],Ae=!1,te=[];te.SheetNames=T.snames,te.sharedf=T.sharedf,te.arrayf=T.arrayf,te.names=[],te.XTI=[];var Te=0,Ue=0,O=0,H=[],G=[],L;T.codepage=1200,hf(1200);for(var W=!1;t.l<t.length-1;){var X=t.l,D=t.read_shift(2);if(D===0&&Te===10)break;var Q=t.l===t.length?0:t.read_shift(2),Z=oF[D];if(Z&&Z.f){if(e.bookSheets&&Te===133&&D!==133)break;if(Te=D,Z.r===2||Z.r==12){var be=t.read_shift(2);if(Q-=2,!T.enc&&be!==D&&((be&255)<<8|be>>8)!==D)throw new Error("rt mismatch: "+be+"!="+D);Z.r==12&&(t.l+=10,Q-=10)}var U={};if(D===10?U=Z.f(t,Q,T):U=NMe(D,Z,t,Q,T),Ue==0&&[9,521,1033,2057].indexOf(Te)===-1)continue;switch(D){case 34:r.opts.Date1904=C.WBProps.date1904=U;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(t.l=0),T.enc=U,!e.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=U;break;case 66:var ze=Number(U);switch(ze){case 21010:ze=1200;break;case 32768:ze=1e4;break;case 32769:ze=1252;break}hf(T.codepage=ze),W=!0;break;case 317:T.rrtabid=U;break;case 25:T.winlocked=U;break;case 439:r.opts.RefreshAll=U;break;case 12:r.opts.CalcCount=U;break;case 16:r.opts.CalcDelta=U;break;case 17:r.opts.CalcIter=U;break;case 13:r.opts.CalcMode=U;break;case 14:r.opts.CalcPrecision=U;break;case 95:r.opts.CalcSaveRecalc=U;break;case 15:T.CalcRefMode=U;break;case 2211:r.opts.FullCalc=U;break;case 129:U.fDialog&&(a["!type"]="dialog"),U.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),U.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:j.push(U);break;case 430:te.push([U]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(U);break;case 24:case 536:L={Name:U.Name,Ref:tc(U.rgce,o,null,te,T)},U.itab>0&&(L.Sheet=U.itab-1),te.names.push(L),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(G[U.itab-1]={ref:Xn(U.rgce[0][0][1][2])});break;case 22:T.ExternCount=U;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(U),te.XTI=te.XTI.concat(U);break;case 2196:if(T.biff<8)break;L!=null&&(L.Comment=U[1]);break;case 18:a["!protect"]=U;break;case 19:U!==0&&T.WTF&&console.error("Password verifier: "+U);break;case 133:s[U.pos]=U,T.snames.push(U.name);break;case 10:{if(--Ue)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=Xn(o),e.sheetRows&&e.sheetRows<=o.e.r){var re=o.e.r;o.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Xn(o),o.e.r=re}o.e.r++,o.e.c++}K.length>0&&(a["!merges"]=K),le.length>0&&(a["!objects"]=le),oe.length>0&&(a["!cols"]=oe),ie.length>0&&(a["!rows"]=ie),C.Sheets.push(S)}u===""?d=a:n[u]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[D]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),T.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(T.biff=5,W=!0,hf(T.codepage=28591)),T.biff==8&&U.BIFFVer==0&&U.dt==16&&(T.biff=2),Ue++)break;if(a=e.dense?[]:{},T.biff<8&&!W&&(W=!0,hf(T.codepage=e.codepage||1252)),T.biff<5||U.BIFFVer==0&&U.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:t.l-Q,name:u};s[J.pos]=J,T.snames.push(u)}else u=(s[X]||{name:""}).name;U.dt==32&&(a["!type"]="chart"),U.dt==64&&(a["!type"]="macro"),K=[],le=[],T.arrayf=y=[],oe=[],ie=[],Ae=!1,S={Hidden:(s[X]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[U.r]||[])[U.c]:a[On({c:U.c,r:U.r})])&&++U.c,b={ixfe:U.ixfe,XF:j[U.ixfe]||{},v:U.val,t:"n"},O>0&&(b.z=H[b.ixfe>>8&63]),Lf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 5:case 517:b={ixfe:U.ixfe,XF:j[U.ixfe],v:U.val,t:U.t},O>0&&(b.z=H[b.ixfe>>8&63]),Lf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 638:b={ixfe:U.ixfe,XF:j[U.ixfe],v:U.rknum,t:"n"},O>0&&(b.z=H[b.ixfe>>8&63]),Lf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 189:for(var Re=U.c;Re<=U.C;++Re){var ke=U.rkrec[Re-U.c][0];b={ixfe:ke,XF:j[ke],v:U.rkrec[Re-U.c][1],t:"n"},O>0&&(b.z=H[b.ixfe>>8&63]),Lf(b,e,r.opts.Date1904),k({c:Re,r:U.r},b,e)}break;case 6:case 518:case 1030:{if(U.val=="String"){l=U;break}if(b=YC(U.val,U.cell.ixfe,U.tt),b.XF=j[b.ixfe],e.cellFormula){var Be=U.formula;if(Be&&Be[0]&&Be[0][0]&&Be[0][0][0]=="PtgExp"){var Ye=Be[0][0][1][0],ot=Be[0][0][1][1],Ct=On({r:Ye,c:ot});v[Ct]?b.f=""+tc(U.formula,o,U.cell,te,T):b.F=((e.dense?(a[Ye]||[])[ot]:a[Ct])||{}).F}else b.f=""+tc(U.formula,o,U.cell,te,T)}O>0&&(b.z=H[b.ixfe>>8&63]),Lf(b,e,r.opts.Date1904),k(U.cell,b,e),l=U}break;case 7:case 519:if(l)l.val=U,b=YC(U,l.cell.ixfe,"s"),b.XF=j[b.ixfe],e.cellFormula&&(b.f=""+tc(l.formula,o,l.cell,te,T)),O>0&&(b.z=H[b.ixfe>>8&63]),Lf(b,e,r.opts.Date1904),k(l.cell,b,e),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(U);var jt=On(U[0].s);if(h=e.dense?(a[U[0].s.r]||[])[U[0].s.c]:a[jt],e.cellFormula&&h){if(!l||!jt||!h)break;h.f=""+tc(U[1],o,U[0],te,T),h.F=Xn(U[0])}}break;case 1212:{if(!e.cellFormula)break;if(A){if(!l)break;v[On(l.cell)]=U[0],h=e.dense?(a[l.cell.r]||[])[l.cell.c]:a[On(l.cell)],(h||{}).f=""+tc(U[0],o,f,te,T)}}break;case 253:b=YC(c[U.isst].t,U.ixfe,"s"),c[U.isst].h&&(b.h=c[U.isst].h),b.XF=j[b.ixfe],O>0&&(b.z=H[b.ixfe>>8&63]),Lf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:U.ixfe,XF:j[U.ixfe],t:"z"},O>0&&(b.z=H[b.ixfe>>8&63]),Lf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e));break;case 190:if(e.sheetStubs)for(var Ot=U.c;Ot<=U.C;++Ot){var Tt=U.ixfe[Ot-U.c];b={ixfe:Tt,XF:j[Tt],t:"z"},O>0&&(b.z=H[b.ixfe>>8&63]),Lf(b,e,r.opts.Date1904),k({c:Ot,r:U.r},b,e)}break;case 214:case 516:case 4:b=YC(U.val,U.ixfe,"s"),b.XF=j[b.ixfe],O>0&&(b.z=H[b.ixfe>>8&63]),Lf(b,e,r.opts.Date1904),k({c:U.c,r:U.r},b,e);break;case 0:case 512:Ue===1&&(o=U);break;case 252:c=U;break;case 1054:if(T.biff==4){H[O++]=U[1];for(var Qt=0;Qt<O+163&&Fn[Qt]!=U[1];++Qt);Qt>=163&&cA(U[1],O+163)}else cA(U[1],U[0]);break;case 30:{H[O++]=U;for(var Ft=0;Ft<O+163&&Fn[Ft]!=U;++Ft);Ft>=163&&cA(U,O+163)}break;case 229:K=K.concat(U);break;case 93:le[U.cmo[0]]=T.lastobj=U;break;case 438:T.lastobj.TxO=U;break;case 127:T.lastobj.ImData=U;break;case 440:for(x=U[0].s.r;x<=U[0].e.r;++x)for(p=U[0].s.c;p<=U[0].e.c;++p)h=e.dense?(a[x]||[])[p]:a[On({c:p,r:x})],h&&(h.l=U[1]);break;case 2048:for(x=U[0].s.r;x<=U[0].e.r;++x)for(p=U[0].s.c;p<=U[0].e.c;++p)h=e.dense?(a[x]||[])[p]:a[On({c:p,r:x})],h&&h.l&&(h.l.Tooltip=U[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;h=e.dense?(a[U[0].r]||[])[U[0].c]:a[On(U[0])];var Qe=le[U[2]];h||(e.dense?(a[U[0].r]||(a[U[0].r]=[]),h=a[U[0].r][U[0].c]={t:"z"}):h=a[On(U[0])]={t:"z"},o.e.r=Math.max(o.e.r,U[0].r),o.s.r=Math.min(o.s.r,U[0].r),o.e.c=Math.max(o.e.c,U[0].c),o.s.c=Math.min(o.s.c,U[0].c)),h.c||(h.c=[]),m={a:U[1],t:Qe.TxO.t},h.c.push(m)}break;case 2173:dFe(j[U.ixfe],U.ext);break;case 125:{if(!T.cellStyles)break;for(;U.e>=U.s;)oe[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},Ae||(Ae=!0,NR(U.w/256)),Pm(oe[U.e+1])}break;case 520:{var De={};U.level!=null&&(ie[U.r]=De,De.level=U.level),U.hidden&&(ie[U.r]=De,De.hidden=!0),U.hpt&&(ie[U.r]=De,De.hpt=U.hpt,De.hpx=Hv(U.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||qp(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[D]]=U;break;case 161:a["!margins"]||qp(a["!margins"]={}),a["!margins"].header=U.header,a["!margins"].footer=U.footer;break;case 574:U.RTL&&(C.Views[0].RTL=!0);break;case 146:I=U;break;case 2198:P=U;break;case 140:w=U;break;case 442:u?S.CodeName=U||S.name:C.WBProps.CodeName=U||"ThisWorkbook";break}}else Z||console.error("Missing Info for XLS Record 0x"+D.toString(16)),t.l+=Q}return r.SheetNames=Ti(s).sort(function(Je,dt){return Number(Je)-Number(dt)}).map(function(Je){return s[Je].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&G.forEach(function(Je,dt){r.Sheets[r.SheetNames[dt]]["!autofilter"]=Je}),r.Strings=c,r.SSF=Rs(Fn),T.enc&&(r.Encryption=T.enc),P&&(r.Themes=P),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),te.names.length>0&&(C.Names=te.names),r.Workbook=C,r}var Ub={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _Me(t,e,r){var n=En.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=HH(n,eF,Ub.DSI);for(var s in a)e[s]=a[s]}catch(u){if(r.WTF)throw u}var o=En.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var l=HH(o,tF,Ub.SI);for(var c in l)e[c]==null&&(e[c]=l[c])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(sae(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function EMe(t,e){var r=[],n=[],a=[],s=0,o,l=vH(eF,"n"),c=vH(tF,"n");if(t.Props)for(o=Ti(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=Ti(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],t.Custprops[o[s]]]);var u=[];for(s=0;s<a.length;++s)fae.indexOf(a[s][0])>-1||aae.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&En.utils.cfb_add(e,"/SummaryInformation",$H(n,Ub.SI,c,tF)),(r.length||u.length)&&En.utils.cfb_add(e,"/DocumentSummaryInformation",$H(r,Ub.DSI,l,eF,u.length?u:null,Ub.UDI))}function ose(t,e){e||(e={}),BR(e),Z6(),e.codepage&&J6(e.codepage);var r,n;if(t.FullPaths){if(En.find(t,"/encryption"))throw new Error("File is password-protected");r=En.find(t,"!CompObj"),n=En.find(t,"/Workbook")||En.find(t,"/Book")}else{switch(e.type){case"base64":t=Tu($u(t));break;case"binary":t=Tu(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}El(t,0),n={content:t}}var a,s;if(r&&bMe(r),e.bookProps&&!e.bookSheets)a={};else{var o=ra?"buffer":"array";if(n&&n.content)a=CMe(n.content,e);else if((s=En.find(t,"PerfectOffice_MAIN"))&&s.content)a=Kp.to_workbook(s.content,(e.type=o,e));else if((s=En.find(t,"NativeContent_MAIN"))&&s.content)a=Kp.to_workbook(s.content,(e.type=o,e));else throw(s=En.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&En.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=LFe(t))}var l={};return t.FullPaths&&_Me(t,l,e),a.Props=a.Custprops=l,e.bookFiles&&(a.cfb=t),a}function SMe(t,e){var r=e||{},n=En.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return En.utils.cfb_add(n,a,lse(t,r)),r.biff==8&&(t.Props||t.Custprops)&&EMe(t,n),r.biff==8&&t.vbaraw&&UFe(n,En.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var V2={0:{f:YDe},1:{f:s6e},2:{f:C6e},3:{f:h6e},4:{f:c6e},5:{f:b6e},6:{f:j6e},7:{f:g6e},8:{f:D6e},9:{f:O6e},10:{f:k6e},11:{f:F6e},12:{f:o6e},13:{f:E6e},14:{f:m6e},15:{f:d6e},16:{f:Zae},17:{f:T6e},18:{f:v6e},19:{f:hR},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:TRe},40:{},42:{},43:{f:jke},44:{f:Ske},45:{f:Bke},46:{f:Fke},47:{f:kke},48:{},49:{f:e5e},50:{},51:{f:AFe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Nae},62:{f:I6e},63:{f:NFe},64:{f:J6e},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:cc,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:z6e},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:n6e},148:{f:e6e,p:16},151:{f:V6e},152:{},153:{f:IRe},154:{},155:{},156:{f:ERe},157:{},158:{},159:{T:1,f:$Be},160:{T:-1},161:{T:1,f:$g},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:R6e},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:fFe},336:{T:-1},337:{f:gFe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Zk},357:{},358:{},359:{},360:{T:1},361:{},362:{f:wae},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:H6e},427:{f:$6e},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:K6e},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:r6e},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:U6e},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Zk},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:FFe},633:{T:1},634:{T:-1},635:{T:1,f:BFe},636:{T:-1},637:{f:a5e},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:mRe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Z6e},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},oF={6:{f:D5},10:{f:p0},12:{f:ao},13:{f:ao},14:{f:Li},15:{f:Li},16:{f:ac},17:{f:Li},18:{f:Li},19:{f:ao},20:{f:XH},21:{f:XH},23:{f:wae},24:{f:JH},25:{f:Li},26:{},27:{},28:{f:ZTe},29:{},34:{f:Li},35:{f:YH},38:{f:ac},39:{f:ac},40:{f:ac},41:{f:ac},42:{f:Li},43:{f:Li},47:{f:dke},49:{f:ETe},51:{f:ao},60:{},61:{f:bTe},64:{f:Li},65:{f:_Te},66:{f:ao},77:{},80:{},81:{},82:{},85:{f:ao},89:{},90:{},91:{},92:{f:uTe},93:{f:rBe},94:{},95:{f:Li},96:{},97:{},99:{f:Li},125:{f:Nae},128:{f:QTe},129:{f:fTe},130:{f:ao},131:{f:Li},132:{f:Li},133:{f:hTe},134:{},140:{f:uBe},141:{f:ao},144:{},146:{f:hBe},151:{},152:{},153:{},154:{},155:{},156:{f:ao},157:{},158:{},160:{f:yBe},161:{f:pBe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:RTe},190:{f:MTe},193:{f:p0},197:{},198:{},199:{},200:{},201:{},202:{f:Li},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ao},220:{},221:{f:Li},222:{},224:{f:UTe},225:{f:cTe},226:{f:p0},227:{},229:{f:eBe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:mTe},253:{f:ITe},255:{f:gTe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:hae},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Li},353:{f:p0},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:KTe},431:{f:Li},432:{},433:{},434:{},437:{},438:{f:sBe},439:{f:Li},440:{f:iBe},441:{},442:{f:Vw},443:{},444:{f:ao},445:{},446:{},448:{f:p0},449:{f:yTe,r:2},450:{f:p0},512:{f:qH},513:{f:vBe},515:{f:$Te},516:{f:PTe},517:{f:WH},519:{f:bBe},520:{f:xTe},523:{},545:{f:ZH},549:{f:KH},566:{},574:{f:NTe},638:{f:DTe},659:{},1048:{},1054:{f:BTe},1084:{},1212:{f:XTe},2048:{f:lBe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:zC},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:p0},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:ABe,r:12},2173:{f:uFe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Li,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:WTe,r:12},2197:{},2198:{f:aFe,r:12},2199:{},2200:{},2201:{},2202:{f:YTe,r:12},2203:{f:p0},2204:{},2205:{},2206:{},2207:{},2211:{f:vTe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ao},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:gBe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:fBe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:qH},1:{},2:{f:EBe},3:{f:CBe},4:{f:NBe},5:{f:WH},7:{f:IBe},8:{},9:{f:zC},11:{},22:{f:ao},30:{f:FTe},31:{},32:{},33:{f:ZH},36:{},37:{f:KH},50:{f:jBe},62:{},52:{},67:{},68:{f:ao},69:{},86:{},126:{},127:{f:wBe},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:PBe},223:{},234:{},354:{},421:{},518:{f:D5},521:{f:zC},536:{f:JH},547:{f:YH},561:{},579:{},1030:{f:D5},1033:{f:zC},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Kr(t,e,r,n){var a=e;if(!isNaN(a)){var s=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,a),o.write_shift(2,s),s>0&&uR(r)&&t.push(r)}}function IMe(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return Kr(t,e,r,a);var s=e;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=t.next(4);for(d.write_shift(2,s),d.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u;c<a;){for(d=t.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),t.push(r.slice(c,c+u)),c+=u}}}function Kw(t,e,r){return t||(t=cr(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function jMe(t,e,r,n){var a=cr(9);return Kw(a,t,e),Aae(r,n||"b",a),a}function PMe(t,e,r){var n=cr(8+2*r.length);return Kw(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function TMe(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?Do(Ds(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Kr(t,2,SBe(r,n,a)):Kr(t,3,_Be(r,n,a));return;case"b":case"e":Kr(t,5,jMe(r,n,e.v,e.t));return;case"s":case"str":Kr(t,4,PMe(r,n,(e.v||"").slice(0,255)));return}Kr(t,1,Kw(null,r,n))}function BMe(t,e,r,n){var a=Array.isArray(e),s=Ea(e["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=Xn(s)}for(var u=s.s.r;u<=s.e.r;++u){l=Wi(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=ui(d)),o=c[d]+l;var f=a?(e[u]||[])[d]:e[o];f&&TMe(t,f,u,d)}}}function kMe(t,e){for(var r=e||{},n=lu(),a=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Kr(n,r.biff==4?1033:r.biff==3?521:9,yR(t,16,r)),BMe(n,t.Sheets[t.SheetNames[a]],a,r),Kr(n,10),n.end()}function FMe(t,e,r){Kr(t,49,STe({sz:12,name:"Arial"},r))}function OMe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Kr(t,1054,kTe(a,e[a],r))})}function DMe(t,e){var r=cr(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Kr(t,2151,r),r=cr(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),vae(Ea(e["!ref"]||"A1"),r),r.write_shift(4,4),Kr(t,2152,r)}function RMe(t,e){for(var r=0;r<16;++r)Kr(t,224,zH({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Kr(t,224,zH(n,0,e))})}function MMe(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Kr(t,440,oBe(n)),n[1].Tooltip&&Kr(t,2048,cBe(n))}delete e["!links"]}function LMe(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&Kr(t,125,mBe(pP(a,n),a))})}}function UMe(t,e,r,n,a){var s=16+Gm(a.cellXfs,e,a);if(e.v==null&&!e.bf){Kr(t,513,yg(r,n,s));return}if(e.bf)Kr(t,6,fDe(e,r,n,a,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?Do(Ds(e.v)):e.v;Kr(t,515,GTe(r,n,o,s));break;case"b":case"e":Kr(t,517,HTe(r,n,e.v,s,a,e.t));break;case"s":case"str":if(a.bookSST){var l=IR(a.Strings,e.v,a.revStrings);Kr(t,253,jTe(r,n,l,s))}else Kr(t,516,TTe(r,n,(e.v||"").slice(0,255),s,a));break;default:Kr(t,513,yg(r,n,s))}}function QMe(t,e,r){var n=lu(),a=r.SheetNames[t],s=r.Sheets[a]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[t]||{},c=Array.isArray(s),u=e.biff==8,d,f="",A=[],h=Ea(s["!ref"]||"A1"),m=u?65536:16384;if(h.e.c>255||h.e.r>=m){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}Kr(n,2057,yR(r,16,e)),Kr(n,13,xd(1)),Kr(n,12,xd(100)),Kr(n,15,Cc(!0)),Kr(n,17,Cc(!1)),Kr(n,16,xg(.001)),Kr(n,95,Cc(!0)),Kr(n,42,Cc(!1)),Kr(n,43,Cc(!1)),Kr(n,130,xd(1)),Kr(n,128,VTe()),Kr(n,131,Cc(!1)),Kr(n,132,Cc(!1)),u&&LMe(n,s["!cols"]),Kr(n,512,OTe(h,e)),u&&(s["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){f=Wi(p);for(var x=h.s.c;x<=h.e.c;++x){p===h.s.r&&(A[x]=ui(x)),d=A[x]+f;var v=c?(s[p]||[])[x]:s[d];v&&(UMe(n,v,p,x,e),u&&v.l&&s["!links"].push([d,v.l]))}}var y=l.CodeName||l.name||a;return u&&Kr(n,574,CTe((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&Kr(n,229,tBe(s["!merges"])),u&&MMe(n,s),Kr(n,442,mae(y)),u&&DMe(n,s),Kr(n,10),n.end()}function VMe(t,e,r){var n=lu(),a=(t||{}).Workbook||{},s=a.Sheets||[],o=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(Kr(n,2057,yR(t,5,r)),r.bookType=="xla"&&Kr(n,135),Kr(n,225,l?xd(1200):null),Kr(n,193,H5e(2)),c&&Kr(n,191),c&&Kr(n,192),Kr(n,226),Kr(n,92,dTe("SheetJS",r)),Kr(n,66,xd(l?1200:1252)),l&&Kr(n,353,xd(0)),l&&Kr(n,448),Kr(n,317,xBe(t.SheetNames.length)),l&&t.vbaraw&&Kr(n,211),l&&t.vbaraw){var u=o.CodeName||"ThisWorkbook";Kr(n,442,mae(u))}Kr(n,156,xd(17)),Kr(n,25,Cc(!1)),Kr(n,18,Cc(!1)),Kr(n,19,xd(0)),l&&Kr(n,431,Cc(!1)),l&&Kr(n,444,xd(0)),Kr(n,61,wTe()),Kr(n,64,Cc(!1)),Kr(n,141,xd(0)),Kr(n,34,Cc(yRe(t)=="true")),Kr(n,14,Cc(!0)),l&&Kr(n,439,Cc(!1)),Kr(n,218,xd(0)),FMe(n,t,r),OMe(n,t.SSF,r),RMe(n,r),l&&Kr(n,352,Cc(!1));var d=n.end(),f=lu();l&&Kr(f,140,dBe()),l&&r.Strings&&IMe(f,252,pTe(r.Strings)),Kr(f,10);var A=f.end(),h=lu(),m=0,p=0;for(p=0;p<t.SheetNames.length;++p)m+=(l?12:11)+(l?2:1)*t.SheetNames[p].length;var x=d.length+m+A.length;for(p=0;p<t.SheetNames.length;++p){var v=s[p]||{};Kr(h,133,ATe({pos:x,hs:v.Hidden||0,dt:0,name:t.SheetNames[p]},r)),x+=e[p].length}var y=h.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var b=[];return d.length&&b.push(d),y.length&&b.push(y),A.length&&b.push(A),Zo(b)}function HMe(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Rs(Fn)),t&&t.SSF&&(b1(),cP(t.SSF),r.revssf=dP(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,kR(r),r.cellXfs=[],Gm(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=QMe(a,r,t);return n.unshift(VMe(t,n,r)),Zo(n)}function lse(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=cu(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return HMe(t,e);case 4:case 3:case 2:return kMe(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function c$(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),o=a.index,l=s&&s.index||t.length,c=S3e(t.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,A=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var p=c[o].trim(),x=p.slice(0,3).toLowerCase();if(x=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(x!="<td"&&x!="<th")){var v=p.split(/<\/t[dh]>/i);for(l=0;l<v.length;++l){var y=v[l].trim();if(y.match(/<t[dh]/i)){for(var b=y,w=0;b.charAt(0)=="<"&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var j=0;j<m.length;++j){var I=m[j];I.s.c==d&&I.s.r<u&&u<=I.e.r&&(d=I.e.c+1,j=-1)}var C=Dn(y.slice(0,y.indexOf(">")));A=C.colspan?+C.colspan:1,((f=+C.rowspan)>1||A>1)&&m.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+A-1}});var S=C.t||C["data-t"]||"";if(!b.length){d+=A;continue}if(b=Bne(b),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!b.length){d+=A;continue}var E={t:"s",v:b};r.raw||!b.trim().length||S=="s"||(b==="TRUE"?E={t:"b",v:!0}:b==="FALSE"?E={t:"b",v:!1}:isNaN(xf(b))?isNaN(Qv(b).getDate())||(E={t:"d",v:Ds(b)},r.cellDates||(E={t:"n",v:Do(E.v)}),E.z=r.dateNF||Fn[14]):E={t:"n",v:xf(b)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=E):n[On({r:u,c:d})]=E,d+=A}}}}return n["!ref"]=Xn(h),m.length&&(n["!merges"]=m),n}function $Me(t,e,r,n){for(var a=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var l=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>o)&&!(a[u].e.r<r||a[u].e.c<o)){if(a[u].s.r<r||a[u].s.c<o){l=-1;break}l=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(l<0)){var d=On({r,c:o}),f=n.dense?(t[r]||[])[o]:t[d],A=f&&f.v!=null&&(f.h||oR(f.w||(wA(f),f.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?A='<span contenteditable="true">'+A+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(A='<a href="'+f.l.Target+'">'+A+"</a>")),h.id=(n.id||"sjs")+"-"+d,s.push(Gr("td",A,h))}}var m="<tr>";return m+s.join("")+"</tr>"}var GMe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',KMe="</body></html>";function qMe(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return $m(c$(r[0],e),e);var n=DR();return r.forEach(function(a,s){RR(n,c$(a,e),"Sheet"+(s+1))}),n}function zMe(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function cse(t,e){var r=e||{},n=r.header!=null?r.header:GMe,a=r.footer!=null?r.footer:KMe,s=[n],o=cu(t["!ref"]);r.dense=Array.isArray(t),s.push(zMe(t,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push($Me(t,o,l,r));return s.push("</table>"+a),s.join("")}function use(t,e,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?di(n.origin):n.origin;a=o.r,s=o.c}var l=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(t["!ref"]){var d=cu(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],A=0,h=t["!rows"]||(t["!rows"]=[]),m=0,p=0,x=0,v=0,y=0,b=0;for(t["!cols"]||(t["!cols"]=[]);m<l.length&&p<c;++m){var w=l[m];if(u$(w)){if(n.display)continue;h[p]={hidden:!0}}var j=w.children;for(x=v=0;x<j.length;++x){var I=j[x];if(!(n.display&&u$(I))){var C=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):Bne(I.innerHTML),S=I.getAttribute("data-z")||I.getAttribute("z");for(A=0;A<f.length;++A){var E=f[A];E.s.c==v+s&&E.s.r<p+a&&p+a<=E.e.r&&(v=E.e.c+1-s,A=-1)}b=+I.getAttribute("colspan")||1,((y=+I.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:p+a,c:v+s},e:{r:p+a+(y||1)-1,c:v+s+(b||1)-1}});var B={t:"s",v:C},k=I.getAttribute("data-t")||I.getAttribute("t")||"";C!=null&&(C.length==0?B.t=k||"z":n.raw||C.trim().length==0||k=="s"||(C==="TRUE"?B={t:"b",v:!0}:C==="FALSE"?B={t:"b",v:!1}:isNaN(xf(C))?isNaN(Qv(C).getDate())||(B={t:"d",v:Ds(C)},n.cellDates||(B={t:"n",v:Do(B.v)}),B.z=n.dateNF||Fn[14]):B={t:"n",v:xf(C)})),B.z===void 0&&S!=null&&(B.z=S);var T="",P=I.getElementsByTagName("A");if(P&&P.length)for(var K=0;K<P.length&&!(P[K].hasAttribute("href")&&(T=P[K].getAttribute("href"),T.charAt(0)!="#"));++K);T&&T.charAt(0)!="#"&&(B.l={Target:T}),n.dense?(t[p+a]||(t[p+a]=[]),t[p+a][v+s]=B):t[On({c:v+s,r:p+a})]=B,u.e.c<v+s&&(u.e.c=v+s),v+=b}}++p}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+a),t["!ref"]=Xn(u),p>=c&&(t["!fullref"]=Xn((u.e.r=l.length-m+p-1+a,u))),t}function dse(t,e){var r=e||{},n=r.dense?[]:{};return use(n,t,e)}function WMe(t,e){return $m(dse(t,e),e)}function u$(t){var e="",r=XMe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function XMe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function YMe(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=_a(e.replace(/<[^>]*>/g,""));return[r]}var d$={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function fse(t,e){var r=e||{},n=lR(t),a=[],s,o,l={name:""},c="",u=0,d,f,A={},h=[],m=r.dense?[]:{},p,x,v={value:""},y="",b=0,w=[],j=-1,I=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,E={},B=[],k={},T=0,P=0,K=[],le=1,oe=1,ie=[],Ae={Names:[]},te={},Te=["",""],Ue=[],O={},H="",G=0,L=!1,W=!1,X=0;for(D2.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=D2.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?m["!ref"]=Xn(C):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=C.e.r&&(m["!fullref"]=m["!ref"],C.e.r=r.sheetRows-1,m["!ref"]=Xn(C)),B.length&&(m["!merges"]=B),K.length&&(m["!rows"]=K),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),A[d.name]=m,W=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=Dn(p[0],!1),j=I=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,m=r.dense?[]:{},B=[],K=[],W=!0);break;case"table-row-group":p[1]==="/"?--S:++S;break;case"table-row":case"":if(p[1]==="/"){j+=le,le=1;break}if(f=Dn(p[0],!1),f.?j=f.-1:j==-1&&(j=0),le=+f["number-rows-repeated"]||1,le<10)for(X=0;X<le;++X)S>0&&(K[j+X]={level:S});I=-1;break;case"covered-table-cell":p[1]!=="/"&&++I,r.sheetStubs&&(r.dense?(m[j]||(m[j]=[]),m[j][I]={t:"z"}):m[On({r:j,c:I})]={t:"z"}),y="",w=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++I,v=Dn(p[0],!1),oe=parseInt(v["number-columns-repeated"]||"1",10),x={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(x.f=i$(_a(v.formula))),(v.||v["value-type"])=="string"&&(x.t="s",x.v=_a(v["string-value"]||""),r.dense?(m[j]||(m[j]=[]),m[j][I]=x):m[On({r:j,c:I})]=x),I+=oe-1;else if(p[1]!=="/"){++I,y="",b=0,w=[],oe=1;var D=le?j+le-1:j;if(I>C.e.c&&(C.e.c=I),I<C.s.c&&(C.s.c=I),j<C.s.r&&(C.s.r=j),D>C.e.r&&(C.e.r=D),v=Dn(p[0],!1),Ue=[],O={},x={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=_a(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(T=parseInt(v["number-matrix-rows-spanned"],10)||0,P=parseInt(v["number-matrix-columns-spanned"],10)||0,k={s:{r:j,c:I},e:{r:j+T-1,c:I+P-1}},x.F=Xn(k),ie.push([k,x.F])),v.formula)x.f=i$(v.formula);else for(X=0;X<ie.length;++X)j>=ie[X][0].s.r&&j<=ie[X][0].e.r&&I>=ie[X][0].s.c&&I<=ie[X][0].e.c&&(x.F=ie[X][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(T=parseInt(v["number-rows-spanned"],10)||0,P=parseInt(v["number-columns-spanned"],10)||0,k={s:{r:j,c:I},e:{r:j+T-1,c:I+P-1}},B.push(k)),v["number-columns-repeated"]&&(oe=parseInt(v["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=Bs(v["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(v.value);break;case"percentage":x.t="n",x.v=parseFloat(v.value);break;case"currency":x.t="n",x.v=parseFloat(v.value);break;case"date":x.t="d",x.v=Ds(v["date-value"]),r.cellDates||(x.t="n",x.v=Do(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=C3e(v["time-value"])/86400,r.cellDates&&(x.t="d",x.v=fP(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(v.);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",v["string-value"]!=null&&(y=_a(v["string-value"]),w=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(L=!1,x.t==="s"&&(x.v=y||"",w.length&&(x.R=w),L=b==0),te.Target&&(x.l=te),Ue.length>0&&(x.c=Ue,Ue=[]),y&&r.cellText!==!1&&(x.w=y),L&&(x.t="z",delete x.v),(!L||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var Q=0;Q<le;++Q){if(oe=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[j+Q]||(m[j+Q]=[]),m[j+Q][I]=Q==0?x:Rs(x);--oe>0;)m[j+Q][I+oe]=Rs(x);else for(m[On({r:j+Q,c:I})]=x;--oe>0;)m[On({r:j+Q,c:I+oe})]=Rs(x);C.e.c<=I&&(C.e.c=I)}oe=parseInt(v["number-columns-repeated"]||"1",10),I+=oe-1,oe=0,x={},y="",w=[]}te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s;O.t=y,w.length&&(O.R=w),O.a=H,Ue.push(O)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);H="",G=0,y="",b=0,w=[];break;case"creator":p[1]==="/"?H=n.slice(G,p.index):G=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);y="",b=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(E[l.name]=c,(s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=Dn(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Dn(p[0],!1),c+=d$[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Dn(p[0],!1),c+=d$[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":o=Dn(p[0],!1),Te=R5(o["cell-range-address"]);var Z={Name:o.name,Ref:Te[0]+"!"+Te[1]};W&&(Z.Sheet=h.length),Ae.Names.push(Z);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!v||!v["string-value"])){var be=YMe(n.slice(b,p.index));y=(y.length>0?y+`
`:"")+be[0]}else Dn(p[0],!1),b=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{Te=R5(Dn(p[0])["target-range-address"]),A[Te[0]]["!autofilter"]={ref:Te[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(te=Dn(p[0],!1),!te.href)break;te.Target=_a(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(Te=R5(te.Target.slice(1)),te.Target="#"+Te[0]+"!"+Te[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var U={Sheets:A,SheetNames:h,Workbook:Ae};return r.bookSheets&&delete U.Sheets,U}function f$(t,e){e=e||{},gd(t,"META-INF/manifest.xml")&&C5e(no(t,"META-INF/manifest.xml"),e);var r=Bu(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=fse(cs(r),e);return gd(t,"meta.xml")&&(n.Props=rae(no(t,"meta.xml"))),n}function h$(t,e){return fse(t,e)}var JMe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+O2({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Yi+e}}(),A$=function(){var t=function(s){return rs(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+rs(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=cu(s["!ref"]||"A1"),A=s["!merges"]||[],h=0,m=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",x=s["!rows"]||[];for(u=0;u<f.s.r;++u)p=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=f.e.r;++u){for(p=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<f.s.c;++d)c.push(e);for(;d<=f.e.c;++d){var v=!1,y={},b="";for(h=0;h!=A.length;++h)if(!(A[h].s.c>d)&&!(A[h].s.r>u)&&!(A[h].e.c<d)&&!(A[h].e.r<u)){(A[h].s.c!=d||A[h].s.r!=u)&&(v=!0),y["table:number-columns-spanned"]=A[h].e.c-A[h].s.c+1,y["table:number-rows-spanned"]=A[h].e.r-A[h].s.r+1;break}if(v){c.push(r);continue}var w=On({r:u,c:d}),j=m?(s[u]||[])[d]:s[w];if(j&&j.f&&(y["table:formula"]=rs(xDe(j.f)),j.F&&j.F.slice(0,w.length)==w)){var I=cu(j.F);y["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,y["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!j){c.push(e);continue}switch(j.t){case"b":b=j.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=j.v?"true":"false";break;case"n":b=j.w||String(j.v||0),y["office:value-type"]="float",y["office:value"]=j.v||0;break;case"s":case"str":b=j.v==null?"":j.v,y["office:value-type"]="string";break;case"d":b=j.w||Ds(j.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Ds(j.v).toISOString(),y["table:style-name"]="ce1";break;default:c.push(e);continue}var C=t(b);if(j.l&&j.l.Target){var S=j.l.Target;S=S.charAt(0)=="#"?"#"+vDe(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),C=Gr("text:a",C,{"xlink:href":S.replace(/&/g,"&amp;")})}c.push("          "+Gr("table:table-cell",Gr("text:p",C,{}),y)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Pm(f),f.ods=l;var A=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+A+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Yi],u=O2({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=O2({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(tae().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function hse(t,e){if(e.bookType=="fods")return A$(t,e);var r=aR(),n="",a=[],s=[];return n="mimetype",Zn(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Zn(r,n,A$(t,e)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Zn(r,n,JMe(t,e)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Zn(r,n,Yi+tae()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Zn(r,n,S5e(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Zn(r,n,_5e(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function bg(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function lF(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):cs(Hm(t))}function ZMe(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Tu(eh(t))}function e8e(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Bm(t){var e=t.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function m$(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function t8e(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function r8e(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)t[e+s]=a&255;t[e+15]|=r>=0?0:128}function H2(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Wa(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function ji(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ia(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=H2(t,r),s=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(s){case 0:{for(var c=r[0];t[r[0]++]>=128;);l=t.slice(c,r[0])}break;case 5:o=4,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=H2(t,r),l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:l,type:s};e[a]==null?e[a]=[u]:e[a].push(u)}return e}function gl(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(Wa(n*8+a.type)),a.type==2&&e.push(Wa(a.data.length)),e.push(a.data))})}),Bm(e)}function TR(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function dd(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=H2(t,n),s=Ia(t.slice(n[0],n[0]+a));n[0]+=a;var o={id:ji(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=Ia(l.data),u=ji(c[3][0].data);o.messages.push({meta:c,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(o.merge=ji(s[3][0].data)>>>0>0),r.push(o)}return r}function xx(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Wa(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Wa(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:Wa(o.data.length)}],n[2].push({data:gl(o.meta),type:2})});var s=gl(n);e.push(Wa(s.length)),e.push(s),a.forEach(function(o){return e.push(o)})}),Bm(e)}function n8e(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=H2(e,r),a=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=e[r[0]],l>1&&(o|=e[r[0]+1]<<8),l>2&&(o|=e[r[0]+2]<<16),l>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Bm(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var d=Bm(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function fd(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(n8e(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Bm(e)}function vx(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var s=Wa(n),o=s.length;e.push(s),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return Bm(e)}function a8e(t,e,r,n){var a=bg(t),s=a.getUint32(4,!0),o=(n>1?12:8)+m$(s&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);s&512&&(l=a.getUint32(o,!0),o+=4),o+=m$(s&(n>1?12288:4096))*4,s&16&&(c=a.getUint32(o,!0),o+=4),s&32&&(u=a.getFloat64(o,!0),o+=8),s&64&&(d.setTime(d.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:e[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:e[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function s8e(t,e,r){var n=bg(t),a=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);a&1&&(c=t8e(t,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(l=n.getUint32(s,!0),s+=4),a&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return f}function L5(t,e){var r=new Uint8Array(32),n=bg(r),a=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,r8e(r,a,t.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),s|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,a)}function U5(t,e){var r=new Uint8Array(32),n=bg(r),a=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),s|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,a)}function i8e(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return a8e(t,e,r,t[0]);case 5:return s8e(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Zl(t){var e=Ia(t);return H2(e[1][0].data)}function p$(t,e){var r=Ia(e.data),n=ji(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(o){var l=Ia(o.data),c=ji(l[1][0].data)>>>0;switch(n){case 1:s[c]=lF(l[3][0].data);break;case 8:{var u=t[Zl(l[9][0].data)][0],d=Ia(u.data),f=t[Zl(d[1][0].data)][0],A=ji(f.meta[1][0].data);if(A!=2001)throw new Error("2000 unexpected reference to ".concat(A));var h=Ia(f.data);s[c]=h[3].map(function(m){return lF(m.data)}).join("")}break}}),s}function o8e(t,e){var r,n,a,s,o,l,c,u,d,f,A,h,m,p,x=Ia(t),v=ji(x[1][0].data)>>>0,y=ji(x[2][0].data)>>>0,b=((n=(r=x[8])==null?void 0:r[0])==null?void 0:n.data)&&ji(x[8][0].data)>0||!1,w,j;if((s=(a=x[7])==null?void 0:a[0])!=null&&s.data&&e!=0)w=(l=(o=x[7])==null?void 0:o[0])==null?void 0:l.data,j=(u=(c=x[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=x[4])==null?void 0:d[0])!=null&&f.data&&e!=1)w=(h=(A=x[4])==null?void 0:A[0])==null?void 0:h.data,j=(p=(m=x[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var I=b?4:1,C=bg(w),S=[],E=0;E<w.length/2;++E){var B=C.getUint16(E*2,!0);B<65535&&S.push([E,B])}if(S.length!=y)throw"Expected ".concat(y," cells, found ").concat(S.length);var k=[];for(E=0;E<S.length-1;++E)k[S[E][0]]=j.subarray(S[E][1]*I,S[E+1][1]*I);return S.length>=1&&(k[S[S.length-1][0]]=j.subarray(S[S.length-1][1]*I)),{R:v,cells:k}}function l8e(t,e){var r,n=Ia(e.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?ji(n[7][0].data)>>>0>0?1:0:-1,s=TR(n[5],function(o){return o8e(o,a)});return{nrows:ji(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function c8e(t,e,r){var n,a=Ia(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(ji(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(ji(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Xn(s);var o=Ia(a[4][0].data),l=p$(t,t[Zl(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?p$(t,t[Zl(o[17][0].data)][0]):[],u=Ia(o[3][0].data),d=0;u[1].forEach(function(f){var A=Ia(f.data),h=t[Zl(A[2][0].data)][0],m=ji(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=l8e(t,h);p.data.forEach(function(x,v){x.forEach(function(y,b){var w=On({r:d+v,c:b}),j=i8e(y,l,c);j&&(r[w]=j)})}),d+=p.nrows})}function u8e(t,e){var r=Ia(e.data),n={"!ref":"A1"},a=t[Zl(r[2][0].data)],s=ji(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return c8e(t,a[0],n),n}function d8e(t,e){var r,n=Ia(e.data),a={name:(r=n[1])!=null&&r[0]?lF(n[1][0].data):"",sheets:[]},s=TR(n[2],Zl);return s.forEach(function(o){t[o].forEach(function(l){var c=ji(l.meta[1][0].data);c==6e3&&a.sheets.push(u8e(t,l))})}),a}function f8e(t,e){var r=DR(),n=Ia(e.data),a=TR(n[1],Zl);if(a.forEach(function(s){t[s].forEach(function(o){var l=ji(o.meta[1][0].data);if(l==2){var c=d8e(t,o);c.sheets.forEach(function(u,d){RR(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Q5(t){var e,r,n,a,s={},o=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=fd(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=dd(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&ji(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(u){var d=ji(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return f8e(s,l)}function h8e(t,e,r){var n,a,s,o;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&ji(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=bg(t[7][0].data),d=0,f=[],A=bg(t[4][0].data),h=0,m=[],p=0;p<e.length;++p){if(e[p]==null){u.setUint16(p*2,65535,!0),A.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),A.setUint16(p*2,h,!0);var x,v;switch(typeof e[p]){case"string":x=L5({t:"s",v:e[p]},r),v=U5({t:"s",v:e[p]},r);break;case"number":x=L5({t:"n",v:e[p]},r),v=U5({t:"n",v:e[p]},r);break;case"boolean":x=L5({t:"b",v:e[p]},r),v=U5({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}f.push(x),d+=x.length,m.push(v),h+=v.length,++c}for(t[2][0].data=Wa(c);p<t[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),A.setUint16(p*2,65535,!0);return t[6][0].data=Bm(f),t[3][0].data=Bm(m),c}function A8e(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=cu(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Xn(n)));var s=ZS(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(G){typeof G=="string"&&o.push(G)})});var l={},c=[],u=En.read(e.numbers,{type:"base64"});u.FileIndex.map(function(H,G){return[H,u.FullPaths[G]]}).forEach(function(H){var G=H[0],L=H[1];if(G.type==2&&G.name.match(/\.iwa/)){var W=G.content,X=fd(W),D=dd(X);D.forEach(function(Q){c.push(Q.id),l[Q.id]={deps:[],location:L,type:ji(Q.messages[0].meta[1][0].data)}})}}),c.sort(function(H,G){return H-G});var d=c.filter(function(H){return H>1}).map(function(H){return[H,Wa(H)]});u.FileIndex.map(function(H,G){return[H,u.FullPaths[G]]}).forEach(function(H){var G=H[0];if(H[1],!!G.name.match(/\.iwa/)){var L=dd(fd(G.content));L.forEach(function(W){W.messages.forEach(function(X){d.forEach(function(D){W.messages.some(function(Q){return ji(Q.meta[1][0].data)!=11006&&e8e(Q.data,D[1])})&&l[D[0]].deps.push(W.id)})})})}});for(var f=En.find(u,l[1].location),A=dd(fd(f.content)),h,m=0;m<A.length;++m){var p=A[m];p.id==1&&(h=p)}var x=Zl(Ia(h.messages[0].data)[1][0].data);for(f=En.find(u,l[x].location),A=dd(fd(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);for(x=Zl(Ia(h.messages[0].data)[2][0].data),f=En.find(u,l[x].location),A=dd(fd(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);for(x=Zl(Ia(h.messages[0].data)[2][0].data),f=En.find(u,l[x].location),A=dd(fd(f.content)),m=0;m<A.length;++m)p=A[m],p.id==x&&(h=p);var v=Ia(h.messages[0].data);{v[6][0].data=Wa(n.e.r+1),v[7][0].data=Wa(n.e.c+1);var y=Zl(v[46][0].data),b=En.find(u,l[y].location),w=dd(fd(b.content));{for(var j=0;j<w.length&&w[j].id!=y;++j);if(w[j].id!=y)throw"Bad ColumnRowUIDMapArchive";var I=Ia(w[j].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var C=0;C<=n.e.c;++C){var S=[];S[1]=S[2]=[{type:0,data:Wa(C+420690)}],I[1].push({type:2,data:gl(S)}),I[2].push({type:0,data:Wa(C)}),I[3].push({type:0,data:Wa(C)})}I[4]=[],I[5]=[],I[6]=[];for(var E=0;E<=n.e.r;++E)S=[],S[1]=S[2]=[{type:0,data:Wa(E+726270)}],I[4].push({type:2,data:gl(S)}),I[5].push({type:0,data:Wa(E)}),I[6].push({type:0,data:Wa(E)});w[j].messages[0].data=gl(I)}b.content=vx(xx(w)),b.size=b.content.length,delete v[46];var B=Ia(v[4][0].data);{B[7][0].data=Wa(n.e.r+1);var k=Ia(B[1][0].data),T=Zl(k[2][0].data);b=En.find(u,l[T].location),w=dd(fd(b.content));{if(w[0].id!=T)throw"Bad HeaderStorageBucket";var P=Ia(w[0].messages[0].data);for(E=0;E<s.length;++E){var K=Ia(P[2][0].data);K[1][0].data=Wa(E),K[4][0].data=Wa(s[E].length),P[2][E]={type:P[2][0].type,data:gl(K)}}w[0].messages[0].data=gl(P)}b.content=vx(xx(w)),b.size=b.content.length;var le=Zl(B[2][0].data);b=En.find(u,l[le].location),w=dd(fd(b.content));{if(w[0].id!=le)throw"Bad HeaderStorageBucket";for(P=Ia(w[0].messages[0].data),C=0;C<=n.e.c;++C)K=Ia(P[2][0].data),K[1][0].data=Wa(C),K[4][0].data=Wa(n.e.r+1),P[2][C]={type:P[2][0].type,data:gl(K)};w[0].messages[0].data=gl(P)}b.content=vx(xx(w)),b.size=b.content.length;var oe=Zl(B[4][0].data);(function(){for(var H=En.find(u,l[oe].location),G=dd(fd(H.content)),L,W=0;W<G.length;++W){var X=G[W];X.id==oe&&(L=X)}var D=Ia(L.messages[0].data);{D[3]=[];var Q=[];o.forEach(function(U,ze){Q[1]=[{type:0,data:Wa(ze)}],Q[2]=[{type:0,data:Wa(1)}],Q[3]=[{type:2,data:ZMe(U)}],D[3].push({type:2,data:gl(Q)})})}L.messages[0].data=gl(D);var Z=xx(G),be=vx(Z);H.content=be,H.size=H.content.length})();var ie=Ia(B[3][0].data);{var Ae=ie[1][0];delete ie[2];var te=Ia(Ae.data);{var Te=Zl(te[2][0].data);(function(){for(var H=En.find(u,l[Te].location),G=dd(fd(H.content)),L,W=0;W<G.length;++W){var X=G[W];X.id==Te&&(L=X)}var D=Ia(L.messages[0].data);{delete D[6],delete ie[7];var Q=new Uint8Array(D[5][0].data);D[5]=[];for(var Z=0,be=0;be<=n.e.r;++be){var U=Ia(Q);Z+=h8e(U,s[be],o),U[1][0].data=Wa(be),D[5].push({data:gl(U),type:2})}D[1]=[{type:0,data:Wa(n.e.c+1)}],D[2]=[{type:0,data:Wa(n.e.r+1)}],D[3]=[{type:0,data:Wa(Z)}],D[4]=[{type:0,data:Wa(n.e.r+1)}]}L.messages[0].data=gl(D);var ze=xx(G),re=vx(ze);H.content=re,H.size=H.content.length})()}Ae.data=gl(te)}B[3][0].data=gl(ie)}v[4][0].data=gl(B)}h.messages[0].data=gl(v);var Ue=xx(A),O=vx(Ue);return f.content=O,f.size=f.content.length,u}function Ase(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function BR(t){Ase([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function kR(t){Ase([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function m8e(t){return ia.WS.indexOf(t)>-1?"sheet":t==ia.CS?"chart":t==ia.DS?"dialog":t==ia.MS?"macro":t&&t.length?t:"sheet"}function p8e(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,m8e(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function g8e(t,e,r,n,a,s,o,l,c,u,d,f){try{s[n]=Db(Bu(t,r,!0),e);var A=no(t,e),h;switch(l){case"sheet":h=LRe(A,e,a,c,s[n],u,d,f);break;case"chart":if(h=URe(A,e,a,c,s[n],u,d,f),!h||!h["!drawel"])break;var m=Jy(h["!drawel"].Target,e),p=R2(m),x=EFe(Bu(t,m,!0),Db(Bu(t,p,!0),m)),v=Jy(x,m),y=R2(v);h=hRe(Bu(t,v,!0),v,c,Db(Bu(t,y,!0),v),u,h);break;case"macro":h=QRe(A,e,a,c,s[n],u,d,f);break;case"dialog":h=VRe(A,e,a,c,s[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=h;var b=[];s&&s[n]&&Ti(s[n]).forEach(function(w){var j="";if(s[n][w].Type==ia.CMNT){j=Jy(s[n][w].Target,e);var I=KRe(no(t,j,!0),j,c);if(!I||!I.length)return;t$(h,I,!1)}s[n][w].Type==ia.TCMNT&&(j=Jy(s[n][w].Target,e),b=b.concat(IFe(no(t,j,!0),c)))}),b&&b.length&&t$(h,b,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function sd(t){return t.charAt(0)=="/"?t.slice(1):t}function x8e(t,e){if(b1(),e=e||{},BR(e),gd(t,"META-INF/manifest.xml")||gd(t,"objectdata.xml"))return f$(t,e);if(gd(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Q5<"u"){if(t.FileIndex)return Q5(t);var r=En.utils.cfb_new();return wH(t).forEach(function(K){Zn(r,K,j3e(t,K))}),Q5(r)}throw new Error("Unsupported NUMBERS file")}if(!gd(t,"[Content_Types].xml"))throw gd(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):gd(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=wH(t),a=w5e(Bu(t,"[Content_Types].xml")),s=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",no(t,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!no(t,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!e.bookSheets&&!e.bookProps){if(Rb=[],a.sst)try{Rb=GRe(no(t,sd(a.sst)),a.sst,e)}catch(K){if(e.WTF)throw K}e.cellStyles&&a.themes.length&&(c=$Re(Bu(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(u=HRe(no(t,sd(a.style)),a.style,c,e))}a.links.map(function(K){try{var le=Db(Bu(t,R2(sd(K))),K);return zRe(no(t,sd(K)),le,K,e)}catch{}});var d=MRe(no(t,sd(a.workbooks[0])),a.workbooks[0],e),f={},A="";a.coreprops.length&&(A=no(t,sd(a.coreprops[0]),!0),A&&(f=rae(A)),a.extprops.length!==0&&(A=no(t,sd(a.extprops[0]),!0),A&&j5e(A,f,e)));var h={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(A=Bu(t,sd(a.custprops[0]),!0),A&&(h=T5e(A,e)));var m={};if((e.bookSheets||e.bookProps)&&(d.Sheets?o=d.Sheets.map(function(le){return le.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),e.bookProps&&(m.Props=f,m.Custprops=h),e.bookSheets&&typeof o<"u"&&(m.SheetNames=o),e.bookSheets?m.SheetNames:e.bookProps))return m;o={};var p={};e.bookDeps&&a.calcchain&&(p=qRe(no(t,sd(a.calcchain)),a.calcchain));var x=0,v={},y,b;{var w=d.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var j=0;j!=w.length;++j)f.SheetNames[j]=w[j].name}var I=s?"bin":"xml",C=a.workbooks[0].lastIndexOf("/"),S=(a.workbooks[0].slice(0,C+1)+"_rels/"+a.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");gd(t,S)||(S="xl/_rels/workbook."+I+".rels");var E=Db(Bu(t,S,!0),S.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=WRe(no(t,sd(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=PFe(no(t,sd(a.people[0])),e)),E&&(E=p8e(E,d.Sheets));var B=no(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=f.Worksheets;++x){var k="sheet";if(E&&E[x]?(y="xl/"+E[x][1].replace(/[\/]?xl\//,""),gd(t,y)||(y=E[x][1]),gd(t,y)||(y=S.replace(/_rels\/.*$/,"")+E[x][1]),k=E[x][2]):(y="xl/worksheets/sheet"+(x+1-B)+"."+I,y=y.replace(/sheet0\./,"sheet.")),b=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(x!=e.sheets)continue e;break;case"string":if(f.SheetNames[x].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var T=!1,P=0;P!=e.sheets.length;++P)typeof e.sheets[P]=="number"&&e.sheets[P]==x&&(T=1),typeof e.sheets[P]=="string"&&e.sheets[P].toLowerCase()==f.SheetNames[x].toLowerCase()&&(T=1);if(!T)continue e}}g8e(t,y,b,f.SheetNames[x],x,v,o,k,e,d,c,u)}return m={Directory:a,Workbook:d,Props:f,Custprops:h,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Rb,Styles:u,Themes:c,SSF:Rs(Fn)},e&&e.bookFiles&&(t.files?(m.keys=n,m.files=t.files):(m.keys=[],m.files={},t.FullPaths.forEach(function(K,le){K=K.replace(/^Root Entry[\/]/,""),m.keys.push(K),m.files[K]=t.FileIndex[le]}))),e&&e.bookVBA&&(a.vba.length>0?m.vbaraw=no(t,sd(a.vba[0]),!0):a.defaults&&a.defaults.bin===MFe&&(m.vbaraw=no(t,"xl/vbaProject.bin",!0))),m}function v8e(t,e){var r=e||{},n="Workbook",a=En.find(t,n);try{if(n="/!DataSpaces/Version",a=En.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(WBe(a.content),n="/!DataSpaces/DataSpaceMap",a=En.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=YBe(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=En.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=JBe(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=En.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);eke(a.content)}catch{}if(n="/EncryptionInfo",a=En.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=tke(a.content);if(n="/EncryptedPackage",a=En.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function y8e(t,e){return e.bookType=="ods"?hse(t,e):e.bookType=="numbers"?A8e(t,e):e.bookType=="xlsb"?b8e(t,e):w8e(t,e)}function b8e(t,e){Yx=1024,t&&!t.SSF&&(t.SSF=Rs(Fn)),t&&t.SSF&&(b1(),cP(t.SSF),e.revssf=dP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Mb?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=Qae.indexOf(e.bookType)>-1,a=xR();kR(e=e||{});var s=aR(),o="",l=0;if(e.cellXfs=[],Gm(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Zn(s,o,nae(t.Props,e)),a.coreprops.push(o),Ja(e.rels,2,o,ia.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Zn(s,o,iae(t.Props)),a.extprops.push(o),Ja(e.rels,3,o,ia.EXT_PROPS),t.Custprops!==t.Props&&Ti(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Zn(s,o,oae(t.Custprops)),a.custprops.push(o),Ja(e.rels,4,o,ia.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var d={"!id":{}},f=t.Sheets[t.SheetNames[l-1]],A=(f||{})["!type"]||"sheet";switch(A){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Zn(s,o,YRe(l-1,o,e,t,d)),a.sheets.push(o),Ja(e.wbrels,-1,"worksheets/sheet"+l+"."+r,ia.WS[0])}if(f){var h=f["!comments"],m=!1,p="";h&&h.length>0&&(p="xl/comments"+l+"."+r,Zn(s,p,eMe(h,p)),a.comments.push(p),Ja(d,-1,"../comments"+l+"."+r,ia.CMNT),m=!0),f["!legacy"]&&m&&Zn(s,"xl/drawings/vmlDrawing"+l+".vml",Lae(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Zn(s,R2(o),xv(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Zn(s,o,ZRe(e.Strings,o,e)),a.strs.push(o),Ja(e.wbrels,-1,"sharedStrings."+r,ia.SST)),o="xl/workbook."+r,Zn(s,o,XRe(t,o)),a.workbooks.push(o),Ja(e.rels,1,o,ia.WB),o="xl/theme/theme1.xml",Zn(s,o,CR(t.Themes,e)),a.themes.push(o),Ja(e.wbrels,-1,"theme/theme1.xml",ia.THEME),o="xl/styles."+r,Zn(s,o,JRe(t,o,e)),a.styles.push(o),Ja(e.wbrels,-1,"styles."+r,ia.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Zn(s,o,t.vbaraw),a.vba.push(o),Ja(e.wbrels,-1,"vbaProject.bin",ia.VBA)),o="xl/metadata."+r,Zn(s,o,tMe(o)),a.metadata.push(o),Ja(e.wbrels,-1,"metadata."+r,ia.XLMETA),Zn(s,"[Content_Types].xml",eae(a,e)),Zn(s,"_rels/.rels",xv(e.rels)),Zn(s,"xl/_rels/workbook."+r+".rels",xv(e.wbrels)),delete e.revssf,delete e.ssf,s}function w8e(t,e){Yx=1024,t&&!t.SSF&&(t.SSF=Rs(Fn)),t&&t.SSF&&(b1(),cP(t.SSF),e.revssf=dP(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Mb?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=Qae.indexOf(e.bookType)>-1,a=xR();kR(e=e||{});var s=aR(),o="",l=0;if(e.cellXfs=[],Gm(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Zn(s,o,nae(t.Props,e)),a.coreprops.push(o),Ja(e.rels,2,o,ia.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(t.SheetNames[u]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Zn(s,o,iae(t.Props)),a.extprops.push(o),Ja(e.rels,3,o,ia.EXT_PROPS),t.Custprops!==t.Props&&Ti(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Zn(s,o,oae(t.Custprops)),a.custprops.push(o),Ja(e.rels,4,o,ia.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var f={"!id":{}},A=t.Sheets[t.SheetNames[l-1]],h=(A||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Zn(s,o,Jae(l-1,e,t,f)),a.sheets.push(o),Ja(e.wbrels,-1,"worksheets/sheet"+l+"."+r,ia.WS[0])}if(A){var m=A["!comments"],p=!1,x="";if(m&&m.length>0){var v=!1;m.forEach(function(y){y[1].forEach(function(b){b.T==!0&&(v=!0)})}),v&&(x="xl/threadedComments/threadedComment"+l+"."+r,Zn(s,x,jFe(m,d,e)),a.threadedcomments.push(x),Ja(f,-1,"../threadedComments/threadedComment"+l+"."+r,ia.TCMNT)),x="xl/comments"+l+"."+r,Zn(s,x,Uae(m)),a.comments.push(x),Ja(f,-1,"../comments"+l+"."+r,ia.CMNT),p=!0}A["!legacy"]&&p&&Zn(s,"xl/drawings/vmlDrawing"+l+".vml",Lae(l,A["!comments"])),delete A["!comments"],delete A["!legacy"]}f["!id"].rId1&&Zn(s,R2(o),xv(f))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Zn(s,o,Sae(e.Strings,e)),a.strs.push(o),Ja(e.wbrels,-1,"sharedStrings."+r,ia.SST)),o="xl/workbook."+r,Zn(s,o,nse(t)),a.workbooks.push(o),Ja(e.rels,1,o,ia.WB),o="xl/theme/theme1.xml",Zn(s,o,CR(t.Themes,e)),a.themes.push(o),Ja(e.wbrels,-1,"theme/theme1.xml",ia.THEME),o="xl/styles."+r,Zn(s,o,Oae(t,e)),a.styles.push(o),Ja(e.wbrels,-1,"styles."+r,ia.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Zn(s,o,t.vbaraw),a.vba.push(o),Ja(e.wbrels,-1,"vbaProject.bin",ia.VBA)),o="xl/metadata."+r,Zn(s,o,Mae()),a.metadata.push(o),Ja(e.wbrels,-1,"metadata."+r,ia.XLMETA),d.length>1&&(o="xl/persons/person.xml",Zn(s,o,TFe(d)),a.people.push(o),Ja(e.wbrels,-1,"persons/person.xml",ia.PEOPLE)),Zn(s,"[Content_Types].xml",eae(a,e)),Zn(s,"_rels/.rels",xv(e.rels)),Zn(s,"xl/_rels/workbook."+r+".rels",xv(e.wbrels)),delete e.revssf,delete e.ssf,s}function FR(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=$u(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function N8e(t,e){return En.find(t,"EncryptedPackage")?v8e(t,e):ose(t,e)}function C8e(t,e){var r,n=t,a=e||{};return a.type||(a.type=ra&&Buffer.isBuffer(t)?"buffer":"base64"),r=jne(n,a),x8e(r,a)}function mse(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return iF(t.slice(r),e);default:break e}return Vv.to_workbook(t,e)}function _8e(t,e){var r="",n=FR(t,e);switch(e.type){case"base64":r=$u(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=gg(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=cs(r)),e.type="binary",mse(r,e)}function E8e(t,e){var r=t;return e.type=="base64"&&(r=$u(r)),r=T2.utils.decode(1200,r.slice(2),"str"),e.type="binary",mse(r,e)}function S8e(t){return t.match(/[^\x00-\x7F]/)?eh(t):t}function V5(t,e,r,n){return n?(r.type="string",Vv.to_workbook(t,r)):Vv.to_workbook(e,r)}function $v(t,e){Z6();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return $v(new Uint8Array(t),(r=Rs(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),yv={},r.dateNF&&(yv.dateNF=r.dateNF),r.type||(r.type=ra&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=ra?"buffer":"binary",n=b3e(t),typeof Uint8Array<"u"&&!ra&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=S8e(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Rs(r),r.type="array",$v(eR(n),r)}switch((a=FR(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return N8e(En.read(n,r),r);break;case 9:if(a[1]<=8)return ose(n,r);break;case 60:return iF(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return BBe(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return _ae.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?C8e(n,r):V5(t,n,r,s);case 239:return a[3]===60?iF(n,r):V5(t,n,r,s);case 255:if(a[1]===254)return E8e(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Kp.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Kp.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return sF.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Bae.to_workbook(n,r);break;case 10:case 13:case 32:return _8e(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return TBe.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?sF.to_workbook(n,r):V5(t,n,r,s)}function pse(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Lw(e.file,En.write(t,{type:ra?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return En.write(t,e)}function I8e(t,e){var r=Rs(e||{}),n=y8e(t,r);return j8e(n,r)}function j8e(t,e){var r={},n=ra?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?En.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(lP(a))}return e.password&&typeof encrypt_agile<"u"?pse(encrypt_agile(a,e.password),e):e.type==="file"?Lw(e.file,a):e.type=="string"?cs(a):a}function P8e(t,e){var r=e||{},n=SMe(t,r);return pse(n,r)}function Gf(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return B2(eh(n));case"binary":return eh(n);case"string":return t;case"file":return Lw(e.file,n,"utf8");case"buffer":return ra?RA(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Gf(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function T8e(t,e){switch(e.type){case"base64":return B2(t);case"binary":return t;case"string":return t;case"file":return Lw(e.file,t,"binary");case"buffer":return ra?RA(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function JC(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?B2(r):e.type=="string"?cs(r):r;case"file":return Lw(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function gP(t,e){Z6(),NRe(t);var r=Rs(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=gP(t,r);return r.type="array",lP(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Gf(yMe(t,r),r);case"slk":case"sylk":return Gf(Cae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return Gf(cse(t.Sheets[t.SheetNames[a]],r),r);case"txt":return T8e(gse(t.Sheets[t.SheetNames[a]],r),r);case"csv":return Gf(OR(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return Gf(_ae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return JC(sF.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return Gf(Vv.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return Gf(Bae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return Gf(Eae.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return Gf(hse(t,r),r);case"wk1":return JC(Kp.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return JC(Kp.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),JC(lse(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),P8e(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return I8e(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function B8e(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function $2(t,e,r){var n={};return n.type="file",n.file=e,B8e(n),gP(t,n)}function k8e(t,e,r,n,a,s,o,l){var c=Wi(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,A=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(A,"__rowNum__",{value:r,enumerable:!1})}catch{A.__rowNum__=r}else A.__rowNum__=r;if(!o||t[r])for(var h=e.s.c;h<=e.e.c;++h){var m=o?t[r][h]:t[n[h]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;s[h]!=null&&(A[s[h]]=u);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[h]!=null){if(p==null)if(m.t=="e"&&p===null)A[s[h]]=null;else if(u!==void 0)A[s[h]]=u;else if(d&&p===null)A[s[h]]=null;else continue;else A[s[h]]=d&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?p:wA(m,p,l);p!=null&&(f=!1)}}return{row:A,isempty:f}}function ZS(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=Ea(d);break;case"number":c=Ea(t["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var f=Wi(c.s.r),A=[],h=[],m=0,p=0,x=Array.isArray(t),v=c.s.r,y=0,b={};x&&!t[v]&&(t[v]=[]);var w=u.skipHidden&&t["!cols"]||[],j=u.skipHidden&&t["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(w[y]||{}).hidden)switch(A[y]=ui(y),r=x?t[v][y]:t[A[y]+f],n){case 1:s[y]=y-c.s.c;break;case 2:s[y]=A[y];break;case 3:s[y]=u.header[y-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=wA(r,null,u),p=b[o]||0,!p)b[o]=1;else{do l=o+"_"+p++;while(b[l]);b[o]=p,b[l]=1}s[y]=l}for(v=c.s.r+a;v<=c.e.r;++v)if(!(j[v]||{}).hidden){var I=k8e(t,c,v,A,n,s,x,u);(I.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[m++]=I.row)}return h.length=m,h}var g$=/"/g;function F8e(t,e,r,n,a,s,o,l){for(var c=!0,u=[],d="",f=Wi(r),A=e.s.c;A<=e.e.c;++A)if(n[A]){var h=l.dense?(t[r]||[])[A]:t[n[A]+f];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:wA(h,null,l));for(var m=0,p=0;m!==d.length;++m)if((p=d.charCodeAt(m))===a||p===s||p===34||l.forceQuotes){d='"'+d.replace(g$,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(g$,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function OR(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Ea(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(t);for(var A=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(A[m]||{}).hidden||(f[m]=ui(m));for(var p=0,x=a.s.r;x<=a.e.r;++x)(h[x]||{}).hidden||(d=F8e(t,a,x,f,o,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((p++?l:"")+d)));return delete n.dense,r.join("")}function gse(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=OR(t,e);return r}function O8e(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Ea(t["!ref"]),s="",o=[],l,c=[],u=Array.isArray(t);for(l=a.s.c;l<=a.e.c;++l)o[l]=ui(l);for(var d=a.s.r;d<=a.e.r;++d)for(s=Wi(d),l=a.s.c;l<=a.e.c;++l)if(e=o[l]+s,r=u?(t[d]||[])[l]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function xse(t,e,r){var n=r||{},a=+!n.skipHeader,s=t||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?di(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+e.length-1+a}};if(s["!ref"]){var f=Ea(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+e.length-1+a)}else o==-1&&(o=0,d.e.r=e.length-1+a);var A=n.header||[],h=0;e.forEach(function(p,x){Ti(p).forEach(function(v){(h=A.indexOf(v))==-1&&(A[h=A.length]=v);var y=p[v],b="z",w="",j=On({c:l+h,r:o+x+a});u=G2(s,j),y&&typeof y=="object"&&!(y instanceof Date)?s[j]=y:(typeof y=="number"?b="n":typeof y=="boolean"?b="b":typeof y=="string"?b="s":y instanceof Date?(b="d",n.cellDates||(b="n",y=Do(y)),w=n.dateNF||Fn[14]):y===null&&n.nullError&&(b="e",y=0),u?(u.t=b,u.v=y,delete u.w,delete u.R,w&&(u.z=w)):s[j]=u={t:b,v:y},w&&(u.z=w))})}),d.e.c=Math.max(d.e.c,l+A.length-1);var m=Wi(o);if(a)for(h=0;h<A.length;++h)s[ui(h+l)+m]={t:"s",v:A[h]};return s["!ref"]=Xn(d),s}function D8e(t,e){return xse(null,t,e)}function G2(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=di(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?G2(t,On(e)):G2(t,On({r:e,c:r||0}))}function R8e(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function DR(){return{SheetNames:[],Sheets:{}}}function RR(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var o=s&&s[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=o+a)!=-1;++a);}if(rse(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function M8e(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=R8e(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function L8e(t,e){return t.z=e,t}function vse(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function U8e(t,e,r){return vse(t,"#"+e,r)}function Q8e(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function V8e(t,e,r,n){for(var a=typeof e!="string"?e:Ea(e),s=typeof e=="string"?e:Xn(e),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=G2(t,o,l);c.t="n",c.F=s,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}return t}var Qa={encode_col:ui,encode_row:Wi,encode_cell:On,encode_range:Xn,decode_col:fR,decode_row:dR,split_cell:Z3e,decode_cell:di,decode_range:cu,format_cell:wA,sheet_add_aoa:qne,sheet_add_json:xse,sheet_add_dom:use,aoa_to_sheet:w1,json_to_sheet:D8e,table_to_sheet:dse,table_to_book:WMe,sheet_to_csv:OR,sheet_to_txt:gse,sheet_to_json:ZS,sheet_to_html:cse,sheet_to_formulae:O8e,sheet_to_row_object_array:ZS,sheet_get_cell:G2,book_new:DR,book_append_sheet:RR,book_set_sheet_visibility:M8e,cell_set_number_format:L8e,cell_set_hyperlink:vse,cell_set_internal_link:U8e,cell_add_comment:Q8e,sheet_set_array_formula:V8e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const xP="pollo_cash_audits";async function H8e(t){return(await Wn(bt(je,xP),{...t,createdAt:t.createdAt??xr.now()})).id}async function $8e(t){const e=bt(je,xP),r=(()=>{if(t!=null&&t.createdFrom&&(t!=null&&t.createdTo)){const s=xr.fromDate(t.createdFrom),o=xr.fromDate(t.createdTo);return sr(e,Ar("createdAt",">=",s),Ar("createdAt","<=",o),In("createdAt","desc"))}return sr(e,In("createdAt","desc"))})();return(await Ht(r)).docs.map(s=>{const o=s.data();return{id:s.id,createdAt:o.createdAt,createdByUid:o.createdByUid||"",createdByName:o.createdByName||"",contadorUid:o.contadorUid||"",contadorName:o.contadorName||"",entregadoPor:o.entregadoPor||"",recibidoPor:o.recibidoPor||"",rangeFrom:o.rangeFrom||"",rangeTo:o.rangeTo||"",ventasCash:Number(o.ventasCash||0),abonos:Number(o.abonos||0),ingresosExtra:Number(o.ingresosExtra||0),debitos:Number(o.debitos||0),subTotal:Number(o.subTotal||0),totalEntregado:Number(o.totalEntregado||0),comment:o.comment||""}})}async function G8e(t){await zn(Xt(je,xP,t))}async function K8e(t,e){await kn(Xt(je,xP,t),e)}const wi=t=>`C$ ${(Number(t)||0).toFixed(2)}`,ZC=t=>Number(t||0).toFixed(3),Mi=t=>{const e=Number(String(t??"").replace(/,/g,"."));return isNaN(e)?0:Math.round(e*100)/100},eI=t=>{const e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${n}`},ep=()=>{const t=new Date,e=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${r}-${n}`},q8e=()=>{const t=new Date;return eI(new Date(t.getFullYear(),t.getMonth(),1))},z8e=()=>{const t=new Date;return eI(new Date(t.getFullYear(),t.getMonth()+1,0))},W8e=t=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0),X8e=t=>new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59),yse=t=>String(t??"").toLowerCase().trim(),e_=t=>Number(t.qty??t.quantity??0),x$=t=>["lb","lbs","libra","libras"].includes(yse(t)),v$=t=>["unidad","unidades","ud","uds","pieza","piezas"].includes(yse(t));function Y8e(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(!1),[o,l]=g.useState(!1),[c,u]=g.useState(null),[d,f]=g.useState(!1),[A,h]=g.useState([]),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState(""),[I,C]=g.useState(ep()),[S,E]=g.useState(ep()),[B,k]=g.useState(0),[T,P]=g.useState(0),[K,le]=g.useState(0),[oe,ie]=g.useState(0),[Ae,te]=g.useState(""),[Te,Ue]=g.useState([]),[O,H]=g.useState(0),[G,L]=g.useState(!1),W=g.useMemo(()=>Mi(B+T+K),[B,T,K]),X=g.useMemo(()=>Mi(W-oe),[W,oe]),[D,Q]=g.useState([]),[Z,be]=g.useState(!1),[U,ze]=g.useState(q8e()),[re,J]=g.useState(z8e()),[Re,ke]=g.useState([]),[Be,Ye]=g.useState(0),[ot,Ct]=g.useState(!1);async function jt(){var me;const ne=(await Ht(sr(bt(je,"users")))).docs.map(Ee=>{const ye=Ee.data();return{uid:Ee.id,name:ye.displayName||ye.name||ye.email||Ee.id,role:ye.role,roles:ye.roles}}).filter(Ee=>Ee.role==="contador"||Array.isArray(Ee.roles)&&Ee.roles.includes("contador"));h(ne);const Ve=((me=Ic.currentUser)==null?void 0:me.uid)||"",vt=ne.find(Ee=>Ee.uid===Ve)||ne[0];vt&&(p(vt.uid),v(vt.name))}async function Ot(){be(!0);try{const we=U&&re?{createdFrom:W8e(new Date(U)),createdTo:X8e(new Date(re))}:void 0,ue=await $8e(we);Q(ue)}finally{be(!1)}}g.useEffect(()=>{jt(),Ot()},[]),g.useEffect(()=>{Ot()},[U,re]),g.useEffect(()=>{(async()=>{if(!(!U||!re)){Ct(!0);try{const ue=sr(bt(je,"salesV2"),Ar("date",">=",U),Ar("date","<=",re)),ne=await Ht(ue),Ve=[];ne.forEach(Ee=>{const ye=Ee.data(),We=ye.date??"";if(Array.isArray(ye.items)&&ye.items.length>0){ye.items.forEach((ge,Ie)=>{const xt=String(ge.productName??"(sin nombre)"),Pt=Number(ge.qty??0),It=Number(ge.lineFinal??0)||Math.max(0,Number(ge.unitPrice||0)*Pt-Number(ge.discount||0));Ve.push({id:`${Ee.id}#${Ie}`,date:We,productName:xt,quantity:Pt,amount:It,measurement:ge.measurement??ye.measurement??"",type:ye.type??"CONTADO"})});return}Ve.push({id:Ee.id,date:We,productName:ye.productName??"(sin nombre)",quantity:Number(ye.quantity??0),amount:Number(ye.amount??ye.amountCharged??0),measurement:ye.measurement??"",type:ye.type??"CONTADO"})}),ke(Ve);const it=await Ht(bt(je,"ar_movements_pollo"));let vt=0;const me=Ee=>{var ye;return Ee!=null&&Ee.date?String(Ee.date):(ye=Ee==null?void 0:Ee.createdAt)!=null&&ye.toDate?eI(Ee.createdAt.toDate()):""};it.forEach(Ee=>{const ye=Ee.data();if(String(ye.type??"").toUpperCase()!=="ABONO")return;const ge=Math.abs(Number(ye.amount??0)),Ie=me(ye);Ie&&Ie>=U&&Ie<=re&&(vt+=ge)}),Ye(vt)}catch(ue){console.error("Error cargando KPIs del periodo:",ue),ke([]),Ye(0)}finally{Ct(!1)}}})()},[U,re]),g.useEffect(()=>{(async()=>{if(!(!I||!S)){L(!0);try{const ue=sr(bt(je,"salesV2"),Ar("date",">=",I),Ar("date","<=",S)),ne=await Ht(ue),Ve=[];ne.forEach(Ee=>{const ye=Ee.data(),We=ye.date??"";if(Array.isArray(ye.items)&&ye.items.length>0){ye.items.forEach((ge,Ie)=>{const xt=String(ge.productName??"(sin nombre)"),Pt=Number(ge.qty??0),It=Number(ge.lineFinal??0)||Math.max(0,Number(ge.unitPrice||0)*Pt-Number(ge.discount||0));Ve.push({id:`${Ee.id}#${Ie}`,date:We,productName:xt,quantity:Pt,amount:It,measurement:ge.measurement??ye.measurement??"",type:ye.type??"CONTADO"})});return}Ve.push({id:Ee.id,date:We,productName:ye.productName??"(sin nombre)",quantity:Number(ye.quantity??0),amount:Number(ye.amount??ye.amountCharged??0),measurement:ye.measurement??"",type:ye.type??"CONTADO"})}),Ue(Ve);const it=await Ht(bt(je,"ar_movements_pollo"));let vt=0;const me=Ee=>{var ye;return Ee!=null&&Ee.date?String(Ee.date):(ye=Ee==null?void 0:Ee.createdAt)!=null&&ye.toDate?eI(Ee.createdAt.toDate()):""};it.forEach(Ee=>{const ye=Ee.data();if(String(ye.type??"").toUpperCase()!=="ABONO")return;const ge=Math.abs(Number(ye.amount??0)),Ie=me(ye);Ie&&Ie>=I&&Ie<=S&&(vt+=ge)}),H(vt)}catch(ue){console.error("Error cargando KPI de modal:",ue),Ue([]),H(0)}finally{L(!1)}}})()},[I,S]);const Tt=g.useMemo(()=>{const we=D.reduce((Ve,it)=>Ve+(Number(it.totalEntregado)||0),0),ue=D.reduce((Ve,it)=>Ve+(Number(it.debitos)||0),0),ne=D.reduce((Ve,it)=>Ve+(Number(it.subTotal)||0),0);return{sumTotal:Mi(we),sumDeb:Mi(ue),sumSub:Mi(ne)}},[D]),Qt=g.useMemo(()=>{const we=Re.filter(ye=>ye.type==="CONTADO"),ue=Re.filter(ye=>ye.type==="CREDITO"),ne=we.reduce((ye,We)=>ye+(We.amount||0),0),Ve=ne+Be,it=we.reduce((ye,We)=>x$(We.measurement)?ye+e_(We):ye,0),vt=we.reduce((ye,We)=>v$(We.measurement)?ye+e_(We):ye,0),me=ue.reduce((ye,We)=>x$(We.measurement)?ye+e_(We):ye,0),Ee=ue.reduce((ye,We)=>v$(We.measurement)?ye+e_(We):ye,0);return{ventasCash:Mi(ne),recaudado:Mi(Ve),lbsCash:ZC(it),unitsCash:ZC(vt),lbsCredit:ZC(me),unitsCredit:ZC(Ee)}},[Re,Be]),Ft=g.useMemo(()=>{const ne=Te.filter(Ve=>Ve.type==="CONTADO").reduce((Ve,it)=>Ve+(it.amount||0),0)+O;return{recaudado:Mi(ne)}},[Te,O]);function Qe(){b(""),j(""),C(ep()),E(ep()),k(0),P(0),le(0),ie(0),te(""),s(!1),l(!1),u(null)}function De(we){u(we.id),e(!0),s(!0),l(!0),p(we.contadorUid||""),v(we.contadorName||""),b(we.recibidoPor||""),j(we.entregadoPor||""),C(we.rangeFrom||ep()),E(we.rangeTo||ep()),k(Number(we.ventasCash||0)),P(Number(we.abonos||0)),le(Number(we.ingresosExtra||0)),ie(Number(we.debitos||0)),te(we.comment||"")}async function Je(){var we,ue,ne;if(!m)return alert("Seleccione Contador.");if(!y.trim())return alert("Recibido por es obligatorio.");if(!I||!S)return alert("Seleccione el rango arqueado.");if(new Date(I)>new Date(S))return alert("Rango invlido: Desde no puede ser mayor que Hasta.");n(!0);try{if(c)await K8e(c,{contadorUid:m,contadorName:x,recibidoPor:y.trim(),entregadoPor:w.trim(),rangeFrom:I,rangeTo:S,ventasCash:Mi(B),abonos:Mi(T),ingresosExtra:Mi(K),debitos:Mi(oe),subTotal:Mi(W),totalEntregado:Mi(X),comment:Ae.trim()});else{const Ve=((we=Ic.currentUser)==null?void 0:we.uid)||"",it=((ue=Ic.currentUser)==null?void 0:ue.displayName)||((ne=Ic.currentUser)==null?void 0:ne.email)||Ve;await H8e({createdAt:xr.now(),createdByUid:Ve,createdByName:it,contadorUid:m,contadorName:x,recibidoPor:y.trim(),entregadoPor:w.trim(),rangeFrom:I,rangeTo:S,ventasCash:Mi(B),abonos:Mi(T),ingresosExtra:Mi(K),debitos:Mi(oe),subTotal:Mi(W),totalEntregado:Mi(X),comment:Ae.trim()})}e(!1),Qe(),await Ot()}finally{n(!1)}}async function dt(we){var ne;if(window.confirm(`Eliminar el arqueo creado el ${(ne=we.createdAt)!=null&&ne.toDate?we.createdAt.toDate().toLocaleString():""}?`)){n(!0);try{await G8e(we.id),await Ot()}finally{n(!1)}}}function ce(){const we=D.map(Ve=>{var it;return{"Fecha de creacin":(it=Ve.createdAt)!=null&&it.toDate?Ve.createdAt.toDate().toLocaleString():"","Rango arqueado":`${Ve.rangeFrom} a ${Ve.rangeTo}`,"Arqueado por (Contador)":Ve.contadorName,"Recibido por":Ve.recibidoPor,"Entregado por":Ve.entregadoPor,"Ventas cash":Ve.ventasCash,Abonos:Ve.abonos,"Ingresos extra":Ve.ingresosExtra,"Sub total":Ve.subTotal,Dbitos:Ve.debitos,"Monto entregado":Ve.totalEntregado,Comentario:Ve.comment||""}}),ue=Qa.json_to_sheet(we),ne=Qa.book_new();Qa.book_append_sheet(ne,ue,"Arqueos"),$2(ne,`arqueos_pollo_${ep()}.xlsx`)}return i.jsxs("div",{className:"p-3 md:p-6",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg md:text-xl font-semibold",children:"Arqueo fsico y entregas (Pollo)"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Registro de arqueos, dbitos por gasto/reabastecimiento y monto entregado."})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{Qe(),e(!0)},className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",children:"+ Nuevo arqueo"}),i.jsx("button",{onClick:ce,className:"px-3 py-2 rounded bg-emerald-600 text-white text-sm hover:bg-emerald-700",children:"Exportar Excel"})]})]}),i.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Filtro por fecha (creacin)"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",value:U,onChange:we=>ze(we.target.value),className:"w-full border rounded px-2 py-2 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",value:re,onChange:we=>J(we.target.value),className:"w-full border rounded px-2 py-2 text-sm"})]})]}),i.jsx("button",{onClick:()=>{ze(""),J("")},className:"mt-2 text-xs text-blue-600 hover:underline",children:"Limpiar filtro"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3 hidden md:block",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Monto entregado"}),i.jsx("div",{className:"text-xl font-semibold",children:wi(Tt.sumTotal)}),i.jsx("div",{className:"text-xs text-gray-400",children:"Suma de Total (Sub total - Dbitos)"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3 hidden md:block",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Dbitos"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Tt.sumDeb)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Sub totales"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Tt.sumSub)})]})]}),i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Sumas del listado filtrado"})]})]}),i.jsxs("div",{className:"mt-3 hidden md:grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3",children:[i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas cash (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Qt.ventasCash)}),ot&&i.jsx("div",{className:"text-[11px] text-gray-400",children:"Actualizando"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Recaudado (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Qt.recaudado)}),i.jsx("div",{className:"text-[11px] text-gray-400",children:"Cash + abonos"})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.lbsCash})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.unitsCash})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.lbsCredit})]}),i.jsxs("div",{className:"bg-white rounded shadow p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.unitsCredit})]})]}),i.jsx("div",{className:"mt-3 md:hidden",children:i.jsx(H5,{title:"KPIs",open:d,onToggle:()=>f(we=>!we),children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Monto entregado"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Tt.sumTotal)}),i.jsx("div",{className:"text-xs text-gray-400",children:"Suma de Total (Sub total - Dbitos)"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Dbitos"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Tt.sumDeb)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500",children:"KPI: Sub totales"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Tt.sumSub)})]})]}),i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Sumas del listado filtrado"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas cash (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Qt.ventasCash)}),ot&&i.jsx("div",{className:"text-[11px] text-gray-400",children:"Actualizando"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Recaudado (perodo)"}),i.jsx("div",{className:"text-lg font-semibold",children:wi(Qt.recaudado)}),i.jsx("div",{className:"text-[11px] text-gray-400",children:"Cash + abonos"})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.lbsCash})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades cash"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.unitsCash})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Libras crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.lbsCredit})]}),i.jsxs("div",{className:"bg-white rounded border p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Unidades crdito"}),i.jsx("div",{className:"text-lg font-semibold",children:Qt.unitsCredit})]})]})]})})}),i.jsx("div",{className:"mt-4 block md:hidden space-y-3",children:Z?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):D.length===0?i.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"No hay arqueos en este rango."}):D.map(we=>{var ue;return i.jsxs("div",{className:"bg-white border rounded-2xl p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Fecha de creacin"}),i.jsx("div",{className:"font-semibold text-sm",children:(ue=we.createdAt)!=null&&ue.toDate?we.createdAt.toDate().toLocaleString():""}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Rango arqueado"}),i.jsxs("div",{className:"text-sm",children:[we.rangeFrom," a ",we.rangeTo]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Monto entregado"}),i.jsx("div",{className:"font-semibold",children:wi(we.totalEntregado)})]})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-xs text-gray-600",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Contador:"})," ",we.contadorName]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Recibido:"})," ",we.recibidoPor]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Sub total:"})," ",wi(we.subTotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Dbitos:"})," ",wi(we.debitos)]})]}),i.jsxs("div",{className:"mt-3 flex justify-end",children:[i.jsx("button",{type:"button",onClick:()=>De(we),className:"text-xs px-3 py-1.5 rounded border text-gray-700 hover:bg-gray-50",disabled:r,children:"Editar"}),i.jsx("button",{type:"button",onClick:()=>dt(we),className:"ml-2 text-xs px-3 py-1.5 rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",disabled:r,children:"Eliminar"})]})]},we.id)})}),i.jsxs("div",{className:"mt-4 bg-white rounded shadow overflow-hidden hidden md:block",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsx("div",{className:"text-sm font-semibold",children:"Arqueos guardados"}),i.jsx("div",{className:"text-xs text-gray-500",children:Z?"Cargando...":`${D.length} registro(s)`})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[900px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50 text-gray-600",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left px-3 py-2",children:"Fecha de creacin"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Rango arqueado"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Arqueado por"}),i.jsx("th",{className:"text-left px-3 py-2",children:"Recibido por"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Sub total"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Dbitos"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Monto entregado"}),i.jsx("th",{className:"text-right px-3 py-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[!Z&&D.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"px-3 py-6 text-center text-gray-500",children:"No hay arqueos en este rango."})}),D.map(we=>{var ue;return i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"px-3 py-2",children:(ue=we.createdAt)!=null&&ue.toDate?we.createdAt.toDate().toLocaleString():""}),i.jsxs("td",{className:"px-3 py-2",children:[we.rangeFrom," a ",we.rangeTo]}),i.jsx("td",{className:"px-3 py-2",children:we.contadorName}),i.jsx("td",{className:"px-3 py-2",children:we.recibidoPor}),i.jsx("td",{className:"px-3 py-2 text-right font-medium",children:wi(we.subTotal)}),i.jsx("td",{className:"px-3 py-2 text-right",children:wi(we.debitos)}),i.jsx("td",{className:"px-3 py-2 text-right font-semibold",children:wi(we.totalEntregado)}),i.jsxs("td",{className:"px-3 py-2 text-right",children:[i.jsx("button",{type:"button",onClick:()=>De(we),className:"text-xs px-3 py-1.5 rounded border text-gray-700 hover:bg-gray-50",disabled:r,children:"Editar"}),i.jsx("button",{type:"button",onClick:()=>dt(we),className:"ml-2 text-xs px-3 py-1.5 rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",disabled:r,children:"Eliminar"})]})]},we.id)})]})]})})]}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-3xl rounded shadow-lg overflow-hidden",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:c?"Editar arqueo":"Nuevo arqueo"}),i.jsx("button",{onClick:()=>{e(!1),Qe()},className:"text-sm px-2 py-1 rounded hover:bg-gray-100",children:""})]}),i.jsxs("div",{className:"p-3 md:p-4 space-y-3 text-sm",children:[i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsx(H5,{title:"Datos colaboradores",open:a,onToggle:()=>s(we=>!we),children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Contador"}),i.jsxs("select",{value:m,onChange:we=>{const ue=we.target.value,ne=A.find(Ve=>Ve.uid===ue);p(ue),v((ne==null?void 0:ne.name)||"")},className:"w-full border rounded px-2 py-2",children:[A.length===0&&i.jsx("option",{value:"",children:"(No hay contadores)"}),A.map(we=>i.jsx("option",{value:we.uid,children:we.name},we.uid))]}),i.jsx("div",{className:"text-[11px] text-gray-400 mt-1",children:"Por default se selecciona el contador logueado si aplica."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Recibido por (obligatorio)"}),i.jsx("input",{value:y,onChange:we=>b(we.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien recibe el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Entregado por"}),i.jsx("input",{value:w,onChange:we=>j(we.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien entrega el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Rango cierre ventas"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{type:"date",value:I,onChange:we=>C(we.target.value),className:"w-full border rounded px-2 py-2"}),i.jsx("input",{type:"date",value:S,onChange:we=>E(we.target.value),className:"w-full border rounded px-2 py-2"})]})]})]})}),i.jsxs(H5,{title:"Inputs y KPIs",open:o,onToggle:()=>l(we=>!we),children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"text-xs text-blue-700",children:"Recaudado en el rango (Ventas cash + abonos)"}),i.jsx("div",{className:"text-lg font-semibold text-blue-900",children:wi(Ft.recaudado)}),G&&i.jsx("div",{className:"text-[11px] text-blue-600",children:"Actualizando"})]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsx(g0,{label:"Ventas cash",value:B,onChange:k}),i.jsx(g0,{label:"Abonos",value:T,onChange:P}),i.jsx(g0,{label:"Ingresos extra oficiales",value:K,onChange:le}),i.jsx(g0,{label:"Dbitos (gasto o reabastecimiento)",value:oe,onChange:ie})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[i.jsx(t_,{title:"Sub total (ventas + abonos + ingresos)",value:wi(W)}),i.jsx(t_,{title:"Total (sub total - dbitos)",value:wi(X)})]})]})]}),i.jsxs("div",{className:"hidden md:block space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Contador"}),i.jsxs("select",{value:m,onChange:we=>{const ue=we.target.value,ne=A.find(Ve=>Ve.uid===ue);p(ue),v((ne==null?void 0:ne.name)||"")},className:"w-full border rounded px-2 py-2",children:[A.length===0&&i.jsx("option",{value:"",children:"(No hay contadores)"}),A.map(we=>i.jsx("option",{value:we.uid,children:we.name},we.uid))]}),i.jsx("div",{className:"text-[11px] text-gray-400 mt-1",children:"Por default se selecciona el contador logueado si aplica."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Recibido por (obligatorio)"}),i.jsx("input",{value:y,onChange:we=>b(we.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien recibe el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Entregado por"}),i.jsx("input",{value:w,onChange:we=>j(we.target.value),className:"w-full border rounded px-2 py-2",placeholder:"Nombre de quien entrega el dinero"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Rango cierre ventas"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{type:"date",value:I,onChange:we=>C(we.target.value),className:"w-full border rounded px-2 py-2"}),i.jsx("input",{type:"date",value:S,onChange:we=>E(we.target.value),className:"w-full border rounded px-2 py-2"})]})]})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3",children:[i.jsx("div",{className:"text-xs text-blue-700",children:"Recaudado en el rango (Ventas cash + abonos)"}),i.jsx("div",{className:"text-lg font-semibold text-blue-900",children:wi(Ft.recaudado)}),G&&i.jsx("div",{className:"text-[11px] text-blue-600",children:"Actualizando"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsx(g0,{label:"Ventas cash",value:B,onChange:k}),i.jsx(g0,{label:"Abonos",value:T,onChange:P}),i.jsx(g0,{label:"Ingresos extra oficiales",value:K,onChange:le}),i.jsx(g0,{label:"Dbitos (gasto o reabastecimiento)",value:oe,onChange:ie})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsx(t_,{title:"Sub total (ventas + abonos + ingresos)",value:wi(W)}),i.jsx(t_,{title:"Total (sub total - dbitos)",value:wi(X)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Comentario / Nota"}),i.jsx("textarea",{value:Ae,onChange:we=>te(we.target.value),className:"w-full border rounded px-2 py-2 min-h-[90px]",placeholder:"Opcional..."})]})]}),i.jsxs("div",{className:"p-3 border-t flex items-center justify-end gap-2",children:[i.jsx("button",{onClick:()=>{e(!1),Qe()},className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",disabled:r,children:"Cancelar"}),i.jsx("button",{onClick:Je,className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700 disabled:opacity-60",disabled:r,children:r?"Guardando...":c?"Guardar cambios":"Guardar arqueo"})]})]})})]})}function t_({title:t,value:e}){return i.jsxs("div",{className:"bg-gray-50 border rounded p-3",children:[i.jsx("div",{className:"text-xs text-gray-500",children:t}),i.jsx("div",{className:"text-lg font-semibold",children:e})]})}function g0({label:t,value:e,onChange:r}){return i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:t}),i.jsx("input",{inputMode:"decimal",value:String(e),onChange:n=>r(Mi(n.target.value)),className:"w-full border rounded px-2 py-2",placeholder:"0.00"})]})}function H5({title:t,open:e,onToggle:r,children:n}){return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold text-sm",children:t}),i.jsx("button",{type:"button",onClick:r,className:"text-xs px-3 py-1.5 rounded border hover:bg-gray-50",children:e?"Cerrar":"Ver"})]}),e&&i.jsx("div",{className:"px-3 pb-3 pt-1",children:n})]})}const Ss=t=>`C$ ${Number(t??0).toFixed(2)}`,tp=t=>Number(t??0).toFixed(3);async function J8e(t){const e=new Set;for(const n of t)for(const a of n.batches||[]){const s=(a.batchId||a.id||"").trim();if(!s)continue;(a.purchasePrice===void 0||a.purchasePrice===null)&&(a.invoiceTotal===void 0||a.invoiceTotal===null)&&e.add(s)}if(e.size===0)return t;const r=new Map;return await Promise.all(Array.from(e).map(async n=>{try{const a=await Cs(Xt(je,"inventory_batches",n));if(a.exists()){const s=a.data();r.set(n,Number(s.purchasePrice||0))}}catch{}})),t.map(n=>({...n,batches:(n.batches||[]).map(a=>{if((a.purchasePrice===void 0||a.purchasePrice===null)&&(a.invoiceTotal===void 0||a.invoiceTotal===null)){const s=(a.batchId||a.id||"").trim(),o=s?r.get(s):void 0;if(o!==void 0)return{...a,purchasePrice:o}}return a})}))}function $5(t){var p,x;const e=t.batches||[],r=t.expenses||[],n=t.adjustments||[],a=Number(((p=t.totals)==null?void 0:p.lbs)??t.totalLbs??0),s=Number(((x=t.totals)==null?void 0:x.units)??t.totalUnits??0);let o=0,l=0;for(const v of e){const y=Number(v.quantity??0);let b=v.expectedTotal!==void 0&&v.expectedTotal!==null?Number(v.expectedTotal):y*Number(v.salePrice??0);isFinite(b)||(b=0);let w=y*Number(v.purchasePrice??Number.NaN);isFinite(w)||(w=v.invoiceTotal!==void 0&&v.invoiceTotal!==null?Number(v.invoiceTotal):0),o+=b,l+=w}const c=r.reduce((v,y)=>v+Number(y.amount||0),0),u=n.filter(v=>v.type==="DEBITO").reduce((v,y)=>v+Number(y.amount||0),0),d=n.filter(v=>v.type==="CREDITO").reduce((v,y)=>v+Number(y.amount||0),0),f=t.totalDebits!==void 0?Number(t.totalDebits):u,A=t.totalCredits!==void 0?Number(t.totalCredits):d,h=o-l,m=o-c-f+A;return{lbs:a,units:s,expectedSum:o,invoicedSum:l,expenses:c,debits:f,credits:A,grossProfit:h,finalAmount:m}}function Z8e(){const[t,e]=g.useState([]),[r,n]=g.useState(!0),[a,s]=g.useState(null),o=g.useRef(null),[l,c]=g.useState(!1),[u,d]=g.useState([]),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState(""),[v,y]=g.useState(""),b=t.filter(P=>{let K=!0;return f&&P.date<f&&(K=!1),h&&P.date>h&&(K=!1),p&&!(P.number||"").toLowerCase().includes(p.toLowerCase())&&(K=!1),v&&P.status!==v&&(K=!1),K}),[w,j]=g.useState(1),I=5,C=Math.ceil(b.length/I)||1,S=b.slice((w-1)*I,w*I);oi.useEffect(()=>{j(1)},[f,h,p,v,t]);const E=async()=>{n(!0);const P=sr(bt(je,"invoices"),In("date","desc")),K=await Ht(P),le=[];K.forEach(te=>{const Te=te.data();le.push({id:te.id,...Te,batches:Te.batches||[],expenses:Te.expenses||[],adjustments:Te.adjustments||[],totals:Te.totals||{lbs:Te.totalLbs||0,units:Te.totalUnits||0,amount:Te.totalAmount||0,expenses:Te.totalExpenses||0,finalAmount:Te.finalAmount||0,invoiceTotal:Te.invoiceTotal||0},totalDebits:Te.totalDebits||0,totalCredits:Te.totalCredits||0})});const oe=await J8e(le);e(oe);const ie=await Ht(bt(je,"inventory_batches")),Ae=[];ie.forEach(te=>{const Te=te.data();Ae.push({id:te.id,...Te})}),d(Ae),n(!1)};g.useEffect(()=>{E()},[]);const B=async P=>{const K=P.status==="PAGADA"?"PENDIENTE":"PAGADA";await kn(Xt(je,"invoices",P.id),{status:K}),e(le=>le.map(oe=>oe.id===P.id?{...oe,status:K}:oe)),(a==null?void 0:a.id)===P.id&&s({...P,status:K})},k=async P=>{if(window.confirm(`Eliminar factura del ${P.date}?`))try{const K=Xt(je,"invoices",P.id),le=await Cs(K),oe=le.exists()?le.data():null,ie=Sc(je),Ae=(oe==null?void 0:oe.batches)||[];for(const te of Ae){const Te=te.batchId||te.id;if(!Te)continue;const Ue=Xt(je,"inventory_batches",Te);ie.update(Ue,{invoiceId:null,invoiceNumber:null,invoiceTotal:null})}ie.delete(K),await ie.commit(),e(te=>te.filter(Te=>Te.id!==P.id)),(a==null?void 0:a.id)===P.id&&s(null)}catch(K){console.error(K),alert("No se pudo eliminar la factura por completo.")}},T=async()=>{if(!o.current||!a)return;const P=o.current,K=await Vm(P,{backgroundColor:"#ffffff",onclone:te=>{const Te=te.body;Te.style.background="#ffffff",Te.querySelectorAll("*").forEach(Ue=>{const O=te.defaultView.getComputedStyle(Ue);O.boxShadow&&O.boxShadow!=="none"&&(Ue.style.boxShadow="none")})},scale:2}),le=K.toDataURL("image/png"),oe=new an("p","mm","a4"),ie=oe.internal.pageSize.getWidth(),Ae=K.height*ie/K.width;oe.addImage(le,"PNG",0,0,ie,Ae),oe.save(`factura_${a.number||a.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Facturacin"}),i.jsx("div",{className:"mb-4 flex justify-end",children:i.jsx("button",{type:"button",className:"px-4 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",onClick:()=>c(!0),children:"Crear factura"})}),l&&i.jsx(dne,{paidBatches:u,onClose:()=>c(!1),onCreated:()=>{c(!1),E()}}),i.jsxs("div",{className:"bg-white p-3 rounded-xl shadow border mb-4 flex flex-wrap gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:P=>A(P.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:h,onChange:P=>m(P.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold mb-1",children:"N factura"}),i.jsx("input",{type:"text",className:"border rounded px-2 py-1",placeholder:"Buscar...",value:p,onChange:P=>x(P.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold mb-1",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:v,onChange:P=>y(P.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"PAGADA",children:"Pagada"}),i.jsx("option",{value:"PENDIENTE",children:"Pendiente"})]})]}),i.jsx("button",{type:"button",className:"ml-auto text-xs px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{A(""),m(""),x(""),y("")},children:"Limpiar filtros"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4",children:i.jsxs("table",{className:"min-w-full w-full- text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"N factura"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Libras"}),i.jsx("th",{className:"p-2 border",children:"Unidades"}),i.jsx("th",{className:"p-2 border",children:"Facturado"}),i.jsx("th",{className:"p-2 border",children:"Ventas"}),i.jsx("th",{className:"p-2 border",children:"Gastos"}),i.jsx("th",{className:"p-2 border",children:"Dbitos"}),i.jsx("th",{className:"p-2 border",children:"Crditos"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsxs("tbody",{children:[r?i.jsx("tr",{children:i.jsx("td",{colSpan:13,className:"p-4 text-center",children:"Cargando"})}):S.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:13,className:"p-4 text-center",children:"Sin facturas"})}):S.map(P=>{const K=$5(P);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.date}),i.jsx("td",{className:"p-2 border",children:P.number||""}),i.jsx("td",{className:"p-2 border",children:P.description||""}),i.jsx("td",{className:"p-2 border",children:tp(K.lbs)}),i.jsx("td",{className:"p-2 border",children:tp(K.units)}),i.jsx("td",{className:"p-2 border",children:Ss(K.invoicedSum)}),i.jsx("td",{className:"p-2 border",children:Ss(K.expectedSum)}),i.jsx("td",{className:"p-2 border",children:Ss(K.expenses)}),i.jsx("td",{className:"p-2 border",children:Ss(K.debits)}),i.jsx("td",{className:"p-2 border",children:Ss(K.credits)}),i.jsx("td",{className:"p-2 border",children:Ss(K.finalAmount)}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${P.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:P.status})}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>s(P),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>B(P),children:P.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>k(P),children:"Eliminar"})]})})]},P.id)}),i.jsxs("div",{className:"flex justify-center items-center gap-2 mb-4",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50",onClick:()=>j(P=>Math.max(1,P-1)),disabled:w===1,children:"Anterior"}),i.jsxs("span",{className:"text-sm",children:["Pgina ",w," de ",C]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50",onClick:()=>j(P=>Math.min(C,P+1)),disabled:w===C,children:"Siguiente"})]})]})]})}),a&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",a.date," ",a.number?` ${a.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>s(null),children:"Cerrar"}),i.jsx("button",{onClick:T,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const P=$5(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",a.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Libras:"})," ",tp(P.lbs)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades:"})," ",tp(P.units)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto Facturado:"})," ",Ss(P.invoicedSum)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Monto Ventas (Esperado):"})," ",Ss(P.expectedSum)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia Bruta:"})," ",Ss(P.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",Ss(P.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",Ss(P.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",Ss(P.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Lotes"}),i.jsxs("table",{className:"min-w-full text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Unidad"}),i.jsx("th",{className:"p-2 border",children:"Cantidad"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total facturado"}),i.jsx("th",{className:"p-2 border",children:"Total esperado"}),i.jsx("th",{className:"p-2 border",children:"Ganancia bruta"})]})}),i.jsx("tbody",{children:(a.batches||[]).map((P,K)=>{const le=Number(P.quantity??0),oe=P.expectedTotal!==void 0&&P.expectedTotal!==null?Number(P.expectedTotal):le*Number(P.salePrice??0);let ie=le*Number(P.purchasePrice??Number.NaN);isFinite(ie)||(ie=P.invoiceTotal!==void 0&&P.invoiceTotal!==null?Number(P.invoiceTotal):0);const Ae=oe-ie;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.productName||"(sin nombre)"}),i.jsx("td",{className:"p-2 border",children:(P.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 border",children:tp(P.quantity)}),i.jsx("td",{className:"p-2 border",children:Ss(P.salePrice)}),i.jsx("td",{className:"p-2 border",children:Ss(ie)}),i.jsx("td",{className:"p-2 border",children:Ss(oe)}),i.jsx("td",{className:"p-2 border",children:Ss(Ae)})]},K)})})]}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsxs("table",{className:"min-w-full text-sm shadow-xl mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:(a.expenses||[]).length>0?(a.expenses||[]).map((P,K)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.date}),i.jsx("td",{className:"p-2 border",children:P.description}),i.jsx("td",{className:"p-2 border",children:Ss(P.amount)})]},K)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin gastos"})})})]}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsxs("table",{className:"min-w-full text-sm shadow-xl mb-4",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Fecha"})]})}),i.jsx("tbody",{children:(a.adjustments||[]).length>0?(a.adjustments||[]).map((P,K)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:P.description}),i.jsx("td",{className:"p-2 border",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${P.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:P.type})}),i.jsx("td",{className:"p-2 border",children:Ss(P.amount)}),i.jsx("td",{className:"p-2 border",children:a.date})]},K)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin cargos extras"})})})]}),(()=>{const P=$5(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total libras: ",i.jsx("strong",{children:tp(P.lbs)})]}),i.jsxs("div",{children:["Total unidades: ",i.jsx("strong",{children:tp(P.units)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total facturado (costo):"," ",i.jsx("strong",{children:Ss(P.invoicedSum)})]}),i.jsxs("div",{children:["Total esperado (ventas):"," ",i.jsx("strong",{children:Ss(P.expectedSum)})]}),i.jsxs("div",{children:["Ganancia bruta (esperado  facturado):"," ",i.jsx("strong",{children:Ss(P.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:Ss(P.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:Ss(P.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:Ss(P.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Monto final (esperado  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:Ss(P.finalAmount)})]})})]})})()]})]})}const Vo=t=>`C$ ${(Number(t)||0).toFixed(2)}`,eLe=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function r_(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function tLe(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function rLe(t){const e="ROP",r=r_(t.subcat).slice(0,3)||"GEN",n=tLe(t.gender),a=r_(t.color).slice(0,3)||"COL",s=r_(t.size)||"TLL",o=r_(t.brand).slice(0,4)||"BRD",l=Date.now().toString(36).toUpperCase().slice(-4);return`${e}-${r}-${n}-${a}-${s}-${o}-${l}`}const vy=/^[A-Za-z0-9._-]{0,32}$/;function nLe(){const[t,e]=g.useState([]),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(Ur(Qd(new Date),"yyyy-MM-dd")),[d,f]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(Ur(new Date,"yyyy-MM-dd")),[y,b]=g.useState(0),[w,j]=g.useState(0),[I,C]=g.useState(0),[S,E]=g.useState(0),[B,k]=g.useState(0),[T,P]=g.useState(""),[K,le]=g.useState(""),[oe,ie]=g.useState(""),[Ae,te]=g.useState(""),[Te,Ue]=g.useState(""),[O,H]=g.useState(""),[G,L]=g.useState(""),[W,X]=g.useState(!1),[D,Q]=g.useState(""),[Z,be]=g.useState("Camisa"),[U,ze]=g.useState(null),[re,J]=g.useState(""),[Re,ke]=g.useState(0),[Be,Ye]=g.useState(0),[ot,Ct]=g.useState(0),[jt,Ot]=g.useState(0),[Tt,Qt]=g.useState(0),[Ft,Qe]=g.useState(""),[De,Je]=g.useState(""),[dt,ce]=g.useState(""),[we,ue]=g.useState(""),[ne,Ve]=g.useState(""),[it,vt]=g.useState(""),[me,Ee]=g.useState(""),[ye,We]=g.useState(null),[ge,Ie]=g.useState({x:0,y:0}),[xt,Pt]=g.useState(!1);g.useEffect(()=>{const V=()=>We(null),q=se=>se.key==="Escape"&&We(null);return document.addEventListener("click",V),document.addEventListener("keydown",q),()=>{document.removeEventListener("click",V),document.removeEventListener("keydown",q)}},[]);const It=(V,q,se=192,Ne=160)=>{let Ke=V;V+se+8>window.innerWidth&&(Ke=V-se),Ke=Math.max(8,Math.min(Ke,window.innerWidth-se-8));let Pe=q;return q+Ne+8>window.innerHeight&&(Pe=window.innerHeight-Ne-8),Pe=Math.max(8,Math.min(Pe,window.innerHeight-Ne-8)),{x:Ke,y:Pe}},Ut=(V,q)=>{V.stopPropagation();const se=V.currentTarget.getBoundingClientRect(),Ne=se.right,Me=se.bottom,Ke=It(Ne,Me);Ie(Ke),We(Pe=>Pe===q?null:q)};g.useEffect(()=>{const V=()=>We(null),q=se=>{se.key==="Escape"&&We(null)};return document.addEventListener("click",V),document.addEventListener("keydown",q),()=>{document.removeEventListener("click",V),document.removeEventListener("keydown",q)}},[]),g.useEffect(()=>{if(!ye)return;const V=()=>We(null);return window.addEventListener("scroll",V,!0),window.addEventListener("resize",V),()=>{window.removeEventListener("scroll",V,!0),window.removeEventListener("resize",V)}},[ye]),g.useEffect(()=>{(async()=>{const V=await Ht(bt(je,"products_clothes")),q=[];V.forEach(Ke=>{const Pe=Ke.data();q.push({id:Ke.id,name:Pe.name??"(sin nombre)",category:Pe.category??"(sin categora)",measurement:Pe.measurement??"unidad",price:Number(Pe.price??0),sku:Pe.sku||"",size:Pe.size||"",color:Pe.color||"",gender:Pe.gender||"",brand:Pe.brand||""})}),e(q);const se=sr(bt(je,"inventory_clothes_batches"),In("date","desc")),Ne=await Ht(se),Me=[];Ne.forEach(Ke=>{const Pe=Ke.data();Me.push({id:Ke.id,productId:Pe.productId,productName:Pe.productName,category:Pe.category,unit:Pe.unit,quantity:Number(Pe.quantity||0),remaining:Number(Pe.remaining??Pe.quantity??0),purchasePrice:Number(Pe.purchasePrice||0),salePrice:Number(Pe.salePrice||0),invoiceTotal:Number(Pe.invoiceTotal??Number(Pe.quantity||0)*Number(Pe.purchasePrice||0)),expectedTotal:Number(Pe.expectedTotal??Number(Pe.quantity||0)*Number(Pe.salePrice||0)),date:Pe.date,createdAt:Pe.createdAt,status:Pe.status,notes:Pe.notes||"",sku:Pe.sku||"",size:Pe.size||"",color:Pe.color||"",gender:Pe.gender||"",brand:Pe.brand||"",clientCode:Pe.clientCode||""})}),n(Me),s(!1)})()},[]),g.useEffect(()=>{const V=t.find(q=>q.id===m);V&&(C(Number(V.price||0)),V.sku&&le(V.sku),V.size&&ie(q=>q||V.size),V.color&&te(q=>q||V.color),V.gender&&Ue(q=>q||V.gender),V.brand&&H(q=>q||V.brand))},[m,t]),g.useEffect(()=>{E(Math.floor(y*w*100)/100)},[y,w]),g.useEffect(()=>{k(Math.floor(y*I*100)/100)},[y,I]),g.useEffect(()=>{const V=t.find(Ne=>Ne.id===m);if(V!=null&&V.sku){le(V.sku);return}const q=W&&Z?Z:(V==null?void 0:V.category)||"";if(!q&&!Te&&!Ae&&!oe&&!O){le("");return}const se=rLe({subcat:q,gender:Te||"",color:Ae||"",size:oe||"",brand:O||""});le(se)},[W,Z,m,Te,Ae,oe,O,t]);const $t=g.useMemo(()=>r.filter(V=>!(c&&V.date<c||d&&V.date>d||A&&V.productId!==A)),[r,c,d,A]),Le=g.useMemo(()=>{const V=$t.reduce((Me,Ke)=>Me+(Ke.invoiceTotal||0),0),q=$t.reduce((Me,Ke)=>Me+(Ke.expectedTotal||0),0),se=$t.reduce((Me,Ke)=>Me+Ke.quantity,0),Ne=$t.reduce((Me,Ke)=>Me+Ke.remaining,0);return{udsIng:se,udsRem:Ne,totalFacturado:V,totalEsperado:q}},[$t]),Ce=async V=>{V.preventDefault(),l("");const q=!!m&&!W,se=t.find(Pe=>Pe.id===m),Ne=q?(se==null?void 0:se.name)||"":D||"",Me=q?(se==null?void 0:se.category)||"":Z||"General",Ke=q&&(se==null?void 0:se.measurement)||"unidad";if(!Ne||y<=0||w<=0){l("Completa nombre/cantidad/costo.");return}if(G&&!vy.test(G)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}try{const Pe=await Wn(bt(je,"inventory_clothes_batches"),{productId:q?se.id:"",productName:Ne,category:Me,unit:Ke,quantity:y,remaining:y,purchasePrice:w,salePrice:I,invoiceTotal:S,expectedTotal:B,date:x,createdAt:xr.now(),status:"PENDIENTE",notes:T||"",sku:K||"",size:oe||"",color:Ae||"",gender:Te||"",brand:O||"",clientCode:G||""});n(rt=>[{id:Pe.id,productId:q?se.id:"",productName:Ne,category:Me,unit:Ke,quantity:y,remaining:y,purchasePrice:w,salePrice:I,invoiceTotal:S,expectedTotal:B,date:x,createdAt:xr.now(),status:"PENDIENTE",notes:T||"",sku:K||"",size:oe||"",color:Ae||"",gender:Te||"",brand:O||"",clientCode:G||""},...rt]),l(" Lote de ropa creado"),p(""),v(Ur(new Date,"yyyy-MM-dd")),b(0),j(0),C(0),E(0),k(0),P(""),le(""),ie(""),te(""),Ue(""),H(""),L(""),X(!1),Q(""),be("Camisa")}catch(Pe){console.error(Pe),l(" Error al crear lote")}},pe=async V=>{confirm(`Marcar PAGADO el lote del ${V.date} (${V.productName})?`)&&(await kn(Xt(je,"inventory_clothes_batches",V.id),{status:"PAGADO"}),n(se=>se.map(Ne=>Ne.id===V.id?{...Ne,status:"PAGADO"}:Ne)))},He=V=>{ze(V.id),J(V.date),ke(V.quantity),Ye(V.purchasePrice),Ct(V.salePrice),Ot(Number((V.quantity*V.purchasePrice).toFixed(2))),Qt(Number((V.quantity*V.salePrice).toFixed(2))),Qe(V.notes||""),Je(V.sku||""),ce(V.size||""),ue(V.color||""),Ve(V.gender||""),vt(V.brand||""),Ee(V.clientCode||"")},he=()=>{ze(null),J(""),ke(0),Ye(0),Ct(0),Ot(0),Qt(0),Qe(""),Je(""),ce(""),ue(""),Ve(""),vt(""),Ee("")};g.useEffect(()=>{U&&Ot(Math.floor(Re*Be*100)/100)},[U,Re,Be]),g.useEffect(()=>{U&&Qt(Math.floor(Re*ot*100)/100)},[U,Re,ot]);const ee=async()=>{if(!U)return;const V=r.find(Me=>Me.id===U);if(!V)return;const q=Math.max(0,V.quantity-V.remaining),se=Math.max(0,Re-q);if(me&&!vy.test(me)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}const Ne=Xt(je,"inventory_clothes_batches",U);await kn(Ne,{date:re,quantity:Re,purchasePrice:Be,salePrice:ot,invoiceTotal:jt,expectedTotal:Tt,notes:Ft,remaining:se,sku:De,size:dt,color:we,gender:ne||"",brand:it||"",clientCode:me||""}),n(Me=>Me.map(Ke=>Ke.id===U?{...Ke,date:re,quantity:Re,purchasePrice:Be,salePrice:ot,invoiceTotal:jt,expectedTotal:Tt,notes:Ft,remaining:se,sku:De,size:dt,color:we,gender:ne||"",brand:it||"",clientCode:me||""}:Ke)),he(),l(" Lote actualizado")},_e=async V=>{confirm(`Eliminar el lote del ${V.date} (${V.productName})?`)&&(await zn(Xt(je,"inventory_clothes_batches",V.id)),n(se=>se.filter(Ne=>Ne.id!==V.id)),l(" Lote eliminado"))},R=()=>{const V=(c?`Desde ${c}`:"Desde inicio")+"  "+(d?`Hasta ${d}`:"Hasta hoy"),q=Ke=>(Ke||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),se=$t.map(Ke=>`
      <tr>
        <td>${Ke.date}</td>
        <td>${(Ke.category||"").toUpperCase()}</td>
        <td>${q(Ke.productName)}</td>
        <td>${q(Ke.sku||"")}</td>
        <td>${q(Ke.size||"")}</td>
        <td>${q(Ke.color||"")}</td>
        <td>${q(Ke.clientCode||"")}</td>
        <td>${q(Ke.gender||"")}</td>
        <td>${(Ke.unit||"").toUpperCase()}</td>
        <td style="text-align:right">${Ke.quantity.toFixed(0)}</td>
        <td style="text-align:right">${Ke.remaining.toFixed(0)}</td>
        <td style="text-align:right">${Vo(Ke.purchasePrice)}</td>
        <td style="text-align:right">${Vo(Ke.salePrice)}</td>
        <td style="text-align:right">${Vo(Ke.invoiceTotal||0)}</td>
        <td style="text-align:right">${Vo(Ke.expectedTotal||0)}</td>
        <td>${q((Ke.notes||"").slice(0,120))}</td>
        <td>${Ke.status}</td>
      </tr>`).join(""),Ne=`
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Inventario de Ropa por Lotes</title>
  <style>
    * { font-family: Arial, sans-serif; }
    h1 { margin: 0 0 4px; }
    .muted { color: #555; font-size: 12px; margin-bottom: 12px; }
    table { width: 100%; border-collapse: collapse; font-size: 11px; }
    th, td { border: 1px solid #ddd; padding: 6px; }
    th { background: #f5f5f5; text-align: left; }
    .totals { margin: 10px 0 16px; font-size: 12px; display: grid; grid-template-columns: repeat(2, max-content); column-gap: 32px; row-gap: 6px; align-items: center; }
    @media print { @page { size: A4 landscape; margin: 12mm; } button { display: none; } }
  </style>
</head>
<body>
  <button onclick="window.print()">Imprimir</button>
  <h1>Inventario de Ropa por Lotes</h1>
  <div class="muted">${V}</div>
  <div class="totals">
    <span><strong>Unidades ingresadas:</strong> ${Le.udsIng.toFixed(0)}</span>
    <span><strong>Unidades restantes:</strong> ${Le.udsRem.toFixed(0)}</span>
    <span><strong>Total esperado a ganar:</strong> ${Vo(Le.totalEsperado)}</span>
    <span><strong>Total facturado:</strong> ${Vo(Le.totalFacturado)}</span>
    <span><strong>Ganancia sin gastos:</strong> ${Vo(Number((Le.totalEsperado-Le.totalFacturado).toFixed(2)))}</span>
  </div>
  <table>
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Subcat.</th>
        <th>Producto</th>
        <th>SKU</th>
        <th>Talla</th>
        <th>Color</th>
        <th>Cdigo Cliente</th>
        <th>Gnero</th>
        <th>Unidad</th>
        <th>Ingresado</th>
        <th>Restantes</th>
        <th>Precio Compra</th>
        <th>Precio Venta</th>
        <th>Total factura</th>
        <th>Total esperado</th>
        <th>Comentario</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>${se||'<tr><td colspan="17" style="text-align:center">Sin lotes</td></tr>'}</tbody>
  </table>
</body>
</html>`,Me=window.open("","_blank");Me&&(Me.document.open(),Me.document.write(Ne),Me.document.close())};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario de Ropa"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>Pt(!0),type:"button",children:"Crear Inventario"})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:V=>u(V.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:V=>f(V.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:V=>h(V.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(V=>i.jsxs("option",{value:V.id,children:[V.name,"  ",V.category]},V.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h("")},children:"Quitar filtro"}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:R,children:"Imprimir PDF"})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-base",children:i.jsxs("div",{className:"grid grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",Le.udsIng.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",Le.udsRem.toFixed(0)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",Vo(Le.totalEsperado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",Vo(Le.totalFacturado)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",Vo(Number((Le.totalEsperado-Le.totalFacturado).toFixed(2)))]})]})}),i.jsx("div",{className:"bg-white rounded shadow border",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden sm:table-cell",children:"Subcat."}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"SKU"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Talla"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Color"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Gnero"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Unidad"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Ingresado"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Restantes"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Compra"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Venta"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total factura"}),i.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total esperado"}),i.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Comentario"}),i.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Estado"}),i.jsx("th",{className:"p-2 md:p-3 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Cargando"})}):$t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Sin lotes"})}):$t.map(V=>{const q=U===V.id;return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 md:p-3 border align-top",children:q?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:re,onChange:se=>J(se.target.value)}):V.date}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden sm:table-cell",children:(V.category||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top max-w-[220px] md:max-w-[320px]",children:i.jsx("span",{className:"block truncate",title:V.productName,children:V.productName})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell max-w-[220px]",children:q?i.jsx("input",{className:"w-full border p-1 rounded",value:De,onChange:se=>Je(se.target.value)}):i.jsx("span",{className:"block truncate",title:V.sku||"",children:V.sku||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:q?i.jsx("input",{className:"w-full border p-1 rounded",value:dt,onChange:se=>ce(se.target.value)}):V.size||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:q?i.jsx("input",{className:"w-full border p-1 rounded",value:we,onChange:se=>ue(se.target.value)}):V.color||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[200px]",children:q?i.jsx("input",{className:"w-full border p-1 rounded",value:me,onChange:se=>{const Ne=se.target.value;vy.test(Ne)&&Ee(Ne)},placeholder:"Ej: LOTE-SHEIN-SEP-01",title:"AZ 09 . _ - (mx 32)"}):i.jsx("span",{className:"block truncate",title:V.clientCode||"",children:V.clientCode||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:q?i.jsx("select",{className:"w-full border p-1 rounded",value:ne,onChange:se=>Ve(se.target.value),children:eLe.map(se=>i.jsx("option",{value:se,children:se||""},se))}):V.gender||""}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:(V.unit||"").toUpperCase()}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:q?i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-20 border p-1 rounded text-right",value:Number.isNaN(Re)?"":Re,onChange:se=>ke(Math.max(0,parseInt(se.target.value||"0",10)))}):V.quantity.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:q?V.remaining:V.remaining.toFixed(0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:q?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(Be)?"":Be,onChange:se=>Ye(Math.max(0,parseFloat(se.target.value||"0")))}):Vo(V.purchasePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:q?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(ot)?"":ot,onChange:se=>Ct(Math.max(0,parseFloat(se.target.value||"0")))}):Vo(V.salePrice)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:Vo(q?jt:V.invoiceTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:Vo(q?Tt:V.expectedTotal||0)}),i.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[280px]",children:q?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Ft,onChange:se=>Qe(se.target.value),maxLength:500}):i.jsx("span",{className:"block truncate",title:V.notes||"",children:V.notes||""})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${V.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:V.status})}),i.jsx("td",{className:"p-2 md:p-3 border align-top",children:q?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:ee,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:he,children:"Cancelar"})]}):i.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-8 h-8 rounded border border-gray-200 hover:bg-gray-100",title:"Acciones",onClick:se=>Ut(se,V.id),children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:[i.jsx("circle",{cx:"12",cy:"5",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"12",r:"1.6"}),i.jsx("circle",{cx:"12",cy:"19",r:"1.6"})]})})})]},V.id)})})]})})}),ye&&Lu.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{onClick:()=>We(null),className:"fixed inset-0 z-[60]"}),i.jsx("div",{className:"fixed z-[61] w-44 rounded-md border border-gray-200 bg-white shadow-xl",style:{left:ge.x,top:ge.y},onClick:V=>V.stopPropagation(),role:"menu","aria-orientation":"vertical",children:i.jsxs("div",{className:"py-1 text-sm",children:[(()=>{const V=$t.find(q=>q.id===ye);return(V==null?void 0:V.status)==="PENDIENTE"?i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-green-50",onClick:()=>{We(null),pe(V)},children:" Pagar"}):null})(),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-yellow-50",onClick:()=>{const V=$t.find(q=>q.id===ye);V&&(We(null),He(V))},children:" Editar"}),i.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-red-50 text-red-600",onClick:()=>{const V=$t.find(q=>q.id===ye);V&&(We(null),_e(V))},children:" Borrar"})]})})]}),document.body),xt&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Pt(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-4xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Inventario (Lote)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Pt(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Ce,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto de ropa"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:V=>p(V.target.value),children:[i.jsx("option",{value:"",children:"(Opcional) Selecciona un producto"}),t.map(V=>i.jsxs("option",{value:V.id,children:[V.name,"  ",V.category,"  ",V.sku?`SKU: ${V.sku}`:""]},V.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del lote"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:x,onChange:V=>v(V.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (pzas)"}),i.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-full border p-2 rounded",value:y===0?"":y,onChange:V=>b(Math.max(0,parseInt(V.target.value||"0",10))),placeholder:""})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de compra (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:w===0?"":w,onChange:V=>j(Math.max(0,parseFloat(V.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:I===0?"":I,onChange:V=>C(Math.max(0,parseFloat(V.target.value||"0")))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:K,readOnly:!0,placeholder:"Se genera automticamente o se carga del producto",title:"Si el producto tiene SKU, se usa tal cual; si no, se genera por subcat/gnero/talla/color/marca."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:oe,readOnly:!0,onChange:V=>ie(V.target.value),placeholder:"XS/S/M/L/XL/10/12"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:Ae,readOnly:!0,onChange:V=>te(V.target.value),placeholder:"Negro, Azul, Rojo"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:Te,readOnly:!0,onChange:V=>Ue(V.target.value),placeholder:"Masculino, Femenino, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca / Origen (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:O,onChange:V=>H(V.target.value),placeholder:"Shein, Usado, Otro"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo del cliente (opcional)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: LOTE-SHEIN-SEP-01",value:G,onChange:V=>{const q=V.target.value;vy.test(q)&&L(q)},title:"Solo letras, nmeros, punto, guion y guion_bajo (mx 32)"}),!vy.test(G)&&G.length>0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Formato invlido"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:T,onChange:V=>P(V.target.value),maxLength:500,placeholder:"Ej: Camisita veranera, tela delgada, tirantes"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[T.length,"/500"]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total factura (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:Vo(S),readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Total esperado (auto)"}),i.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:Vo(B),readOnly:!0})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Pt(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar lote"})]})]})]})]}),document.body),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const aLe=["Camisa","Blusa","Vestido","Jean","Pantaln","Short","Falda","Conjunto","Abrigo","Suter","Accesorio"],sLe=["Negro","Blanco","Azul","Rojo","Verde","Gris","Beige","Rosa","Amarillo","Marrn","Morado","Naranja"],iLe=["XS","S","M","L","XL","2XL"],oLe=["2","4","6","8","10","12","14"],lLe=["26","28","30","32","34","36","38"],cLe=["Shein","Usado","Otro"],uLe=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function n_(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function dLe(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function fLe(t){const e="ROP",r=n_(t.subcat).slice(0,3)||"GEN",n=dLe(t.gender),a=n_(t.color).slice(0,3)||"COL",s=n_(t.size)||"TLL",o=n_(t.brand).slice(0,4)||"BRD";return`${e}-${r}-${n}-${a}-${s}-${o}`}const hLe=/^[A-Za-z0-9._-]{0,32}$/;function ALe(){const[t,e]=g.useState(""),[r,n]=g.useState("Camisa"),[a,s]=g.useState(""),[o,l]=g.useState(""),[c,u]=g.useState("Shein"),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState("0"),[I,C]=g.useState(""),[S,E]=g.useState(""),B=g.useMemo(()=>{const L=Number(w||0),W=Number(y||0);return Math.floor(L*W*100)/100},[w,y]),[k,T]=g.useState([]),[P,K]=g.useState(!0),[le,oe]=g.useState(""),{refreshKey:ie,refresh:Ae}=Mc(),[te,Te]=g.useState(!1),Ue=g.useMemo(()=>r.toLowerCase()==="jean"?lLe:d==="NINO"||d==="NINA"?oLe:iLe,[r,d]);g.useEffect(()=>{p(fLe({subcat:r,gender:d,color:o,size:a,brand:c}))},[r,d,o,a,c]),g.useEffect(()=>{(async()=>{K(!0);const L=sr(bt(je,"products_clothes"),In("createdAt","desc")),W=await Ht(L),X=[];W.forEach(D=>{const Q=D.data();X.push({id:D.id,name:Q.name??"(sin nombre)",category:Q.category??"",measurement:Q.measurement??"unidad",sku:Q.sku??"",size:Q.size||"",color:Q.color||"",brand:Q.brand||"",gender:Q.gender||"",clientCode:Q.clientCode||"",notes:Q.notes||"",createdAt:Q.createdAt??xr.now()})}),T(X),K(!1)})()},[ie]);const O=()=>{e(""),n("Camisa"),s(""),l(""),u("Shein"),f(""),h(""),v(""),b(""),j("0"),C(""),E("")},H=async L=>{if(L.preventDefault(),oe(""),!t.trim()){oe("Ingresa el nombre del producto.");return}if(A&&!hLe.test(A)){oe("Cdigo del cliente invlido");return}const W=Number(w||0),X=Number(y||0);if(W<0){oe("La cantidad de piezas debe ser 0 o mayor.");return}if(X<0){oe("El precio de venta no puede ser negativo.");return}try{const D=await Wn(bt(je,"products_clothes"),{name:t.trim(),category:r,measurement:"unidad",sku:m,size:a||"",color:o||"",brand:c||"",gender:d||"",clientCode:A||"",notes:x||"",createdAt:xr.now(),price:X||0});if(T(Q=>[{id:D.id,name:t.trim(),category:r,measurement:"unidad",sku:m,size:a||"",color:o||"",brand:c||"",gender:d||"",clientCode:A||"",notes:x||"",createdAt:xr.now()},...Q]),W>0){const Q=new Date().toISOString().slice(0,10),Z=I||Q;await Wn(bt(je,"inventory_clothes_batches"),{productId:D.id,productName:t.trim(),category:r,unit:"unidad",quantity:W,remaining:W,purchasePrice:0,salePrice:X||0,invoiceTotal:0,expectedTotal:B||0,date:Z,createdAt:xr.now(),status:"PENDIENTE",notes:S||"",sku:m||"",size:a||"",color:o||"",gender:d||"",brand:c||"",clientCode:A||""})}oe(W>0?" Producto creado y lote de inventario registrado":" Producto de ropa creado"),O()}catch(D){console.error(D),oe(" Error al crear producto")}},G=async L=>{confirm(`Eliminar el producto "${L.name}"?`)&&(await zn(Xt(je,"products_clothes",L.id)),T(X=>X.filter(D=>D.id!==L.id)))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Productos de Ropa"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Rc,{onClick:Ae,loading:P}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{Te(!0)},children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]})]}),te&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo producto de ropa"}),i.jsxs("form",{onSubmit:H,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:t,onChange:L=>e(L.target.value),placeholder:"Ej: Blusa floral"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Subcategora"}),i.jsx("select",{className:"w-full border p-2 rounded",value:r,onChange:L=>n(L.target.value),children:aLe.map(L=>i.jsx("option",{value:L,children:L},L))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border p-2 rounded",value:d,onChange:L=>f(L.target.value),children:uLe.map(L=>i.jsx("option",{value:L,children:L||""},L))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:a,onChange:L=>s(L.target.value),children:[i.jsx("option",{value:"",children:""}),Ue.map(L=>i.jsx("option",{value:L,children:L},L))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:L=>l(L.target.value),children:[i.jsx("option",{value:"",children:""}),sLe.map(L=>i.jsx("option",{value:L,children:L},L))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Marca"}),i.jsx("select",{className:"w-full border p-2 rounded",value:c,onChange:L=>u(L.target.value),children:cLe.map(L=>i.jsx("option",{value:L,children:L},L))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),i.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:m,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:A,onChange:L=>h(L.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",step:"0.01",min:0,value:y,onChange:L=>b(L.target.value),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad de piezas (crea lote si > 0)"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"number",min:0,value:w,onChange:L=>j(L.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),i.jsx("input",{className:"w-full border p-2 rounded",type:"date",value:I,onChange:L=>C(L.target.value)})]}),i.jsxs("div",{className:"md:col-span-2 flex items-center justify-between border-t pt-3 mt-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Medicin:"})," unidad"]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total esperado (auto): "}),isNaN(B)?"":B.toFixed(2)]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:O,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar"}),i.jsx("button",{type:"button",onClick:()=>Te(!1),className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Subcat."}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Talla"}),i.jsx("th",{className:"p-2 border",children:"Color"}),i.jsx("th",{className:"p-2 border",children:"Marca"}),i.jsx("th",{className:"p-2 border",children:"Gnero"}),i.jsx("th",{className:"p-2 border",children:"Cdigo Cliente"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:P?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):k.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin productos"})}):k.map(L=>{var W;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(W=L.createdAt)!=null&&W.toDate?L.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:L.category}),i.jsx("td",{className:"p-2 border",children:L.name}),i.jsx("td",{className:"p-2 border",children:L.sku}),i.jsx("td",{className:"p-2 border",children:L.size||""}),i.jsx("td",{className:"p-2 border",children:L.color||""}),i.jsx("td",{className:"p-2 border",children:L.brand||""}),i.jsx("td",{className:"p-2 border",children:L.gender||""}),i.jsx("td",{className:"p-2 border",children:L.clientCode||""}),i.jsx("td",{className:"p-2 border",children:L.notes||""}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>G(L),children:"Borrar"})})]},L.id)})})]})}),le&&i.jsx("p",{className:"mt-2 text-sm",children:le})]})}async function mLe(t){const{productId:e,quantity:r,saleDate:n,saleId:a}=t,s=Math.max(0,Math.floor(Number(r||0)));if(!e||s<=0)throw new Error("Parmetros invlidos para allocateSaleFIFOClothes");const o=sr(bt(je,"inventory_clothes_batches"),Ar("productId","==",e)),u=(await Ht(o)).docs.map(f=>({id:f.id,data:f.data()})).sort((f,A)=>{var v,y;const h=String(f.data.date||""),m=String(A.data.date||"");if(h!==m)return h<m?-1:1;const p=((v=f.data.createdAt)==null?void 0:v.seconds)??0,x=((y=A.data.createdAt)==null?void 0:y.seconds)??0;return p-x}).map(f=>Xt(je,"inventory_clothes_batches",f.id)),d=[];return await qs(je,async f=>{const A=await Promise.all(u.map(m=>f.get(m)));let h=s;for(let m=0;m<u.length&&h>0;m++){const p=u[m],x=A[m];if(!x.exists())continue;const v=x.data(),y=Math.max(0,Math.floor(Number(v.quantity||0))),b=Number.isFinite(Number(v.remaining))?Math.max(0,Math.floor(Number(v.remaining||0))):y;if(b<=0)continue;const w=Math.min(b,h),j=Math.max(0,b-w);f.update(p,{remaining:j}),d.push({batchId:p.id,qty:w,batchDate:String(v.date||""),productName:String(v.productName||"")}),h-=w}if(h>0)throw new Error(`Inventario insuficiente. Faltan ${h} unidades.`);if(a)for(const m of d)await Wn(bt(je,"batch_clothes_allocations"),{saleId:a,saleDate:n,productId:e,productName:m.productName??"",batchId:m.batchId,batchDate:m.batchDate??"",quantity:m.qty,createdAt:xr.now()})}),{allocations:d}}async function cF(t){const e=Xt(je,"sales_clothes",t),r=await Cs(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),a=[];if(Array.isArray(n.items)&&n.items.length>0){const l={};if(n.allocationsByItem&&typeof n.allocationsByItem=="object")for(const c of Object.keys(n.allocationsByItem)){const u=n.allocationsByItem[c],d=String((u==null?void 0:u.productId)||c||"");if(!d)continue;const f=Array.isArray(u==null?void 0:u.allocations)?u.allocations:[];l[d]=f.map(A=>({batchId:String(A.batchId),qty:Math.max(0,Math.floor(Number(A.qty||A.quantity||0)))}))}if(Array.isArray(n.allocationsByItem))for(const c of n.allocationsByItem){const u=String((c==null?void 0:c.productId)||"");if(!u)continue;const d=Array.isArray(c==null?void 0:c.allocations)?c.allocations:[];l[u]=d.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))}))}for(const c of n.items){const u=String((c==null?void 0:c.productId)||"");if(!u)continue;const d=Math.max(0,Math.floor(Number((c==null?void 0:c.qty)||(c==null?void 0:c.quantity)||0))),f=Array.isArray(c==null?void 0:c.allocations)?c.allocations.map(A=>({batchId:String(A.batchId),qty:Math.max(0,Math.floor(Number(A.qty||A.quantity||0)))})):l[u]||[];a.push({productId:u,productName:String((c==null?void 0:c.productName)||""),qty:d,allocations:f.length?f:void 0})}}else{const l=n.item||{},c=String(l.productId||n.productId||""),u=Math.max(0,Math.floor(Number(l.qty??n.quantity??0))),d=Array.isArray(n.allocations)?n.allocations.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))})):[];c&&u>0&&a.push({productId:c,productName:String(l.productName||n.productName||""),qty:u,allocations:d.length?d:void 0})}return a.length===0?(await qs(je,async l=>{l.delete(e)}),{restored:0}):a.every(l=>Array.isArray(l.allocations)&&l.allocations.length>0)?(await qs(je,async c=>{const u=[];for(const f of a)for(const A of f.allocations||[])u.push({ref:Xt(je,"inventory_clothes_batches",A.batchId),addBack:Math.max(0,Math.floor(Number(A.qty||0)))});const d=await Promise.all(u.map(f=>c.get(f.ref)));for(let f=0;f<u.length;f++){const A=d[f];if(!A.exists())continue;const h=A.data(),m=Math.max(0,Math.floor(Number(h.remaining||0)));c.update(u[f].ref,{remaining:m+u[f].addBack})}c.delete(e)}),{restored:a.reduce((c,u)=>c+(u.allocations||[]).reduce((d,f)=>d+f.qty,0),0)}):(await qs(je,async l=>{const c={};for(const h of a){if(!h.productId||h.qty<=0)continue;const m=sr(bt(je,"inventory_clothes_batches"),Ar("productId","==",h.productId)),x=(await Ht(m)).docs.map(v=>{const y=v.data(),b=Math.max(0,Math.floor(Number(y.quantity||0))),w=Number.isFinite(Number(y.remaining))?Math.max(0,Math.floor(Number(y.remaining||0))):b;return{id:v.id,date:String(y.date||""),quantity:b,remaining:w}}).sort((v,y)=>v.date.localeCompare(y.date));c[h.productId]=x}const u=[];for(const h of a){if(!h.productId||h.qty<=0)continue;if(Array.isArray(h.allocations)&&h.allocations.length>0){for(const x of h.allocations)u.push({id:x.batchId,addBack:Math.max(0,Math.floor(Number(x.qty||0)))});continue}const m=c[h.productId]||[];let p=h.qty;for(const x of m){if(p<=0)break;const v=Math.max(0,x.quantity-x.remaining);if(v<=0)continue;const y=Math.min(v,p);u.push({id:x.id,addBack:y}),p-=y}for(const x of m){if(p<=0)break;const v=Math.min(p,h.qty);u.push({id:x.id,addBack:v}),p-=v}}const d={};for(const h of u)d[h.id]=(d[h.id]||0)+Math.max(0,Math.floor(Number(h.addBack||0)));const f=Object.keys(d).map(h=>Xt(je,"inventory_clothes_batches",h)),A=await Promise.all(f.map(h=>l.get(h)));for(let h=0;h<f.length;h++){const m=A[h];if(!m.exists())continue;const p=m.data(),x=Math.max(0,Math.floor(Number(p.remaining||0))),v=Math.max(0,Math.floor(Number(d[f[h].id]||0)));l.update(f[h],{remaining:x+v})}l.delete(e)}),{restored:a.reduce((l,c)=>l+c.qty,0)})}const y$=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],kh=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function a_(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function b$(t){const e=sr(bt(je,"ar_movements"),Ar("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>zn(Xt(je,"ar_movements",n.id))))}function pLe(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(null),[o,l]=g.useState([]),c=async Le=>{e(!0),n(!0),s(Le),l([]);try{const pe=(await Ht(sr(bt(je,"sales_clothes"),Ar("__name__","==",Le)))).docs[0],He=pe==null?void 0:pe.data(),ee=(Array.isArray(He==null?void 0:He.items)?He.items:He!=null&&He.item?[He.item]:[]).map(_e=>({productName:String(_e.productName||""),qty:Number(_e.qty||0),unitPrice:Number(_e.unitPrice||0),discount:Number(_e.discount||0),total:Number(_e.total||0)}));l(ee)}catch(Ce){console.error(Ce)}finally{n(!1)}},[u,d]=g.useState(""),[f,A]=g.useState("+505 "),[h,m]=g.useState(""),[p,x]=g.useState(""),[v,y]=g.useState("ACTIVO"),[b,w]=g.useState(0),[j,I]=g.useState([]),[C,S]=g.useState(!0),[E,B]=g.useState(""),[k,T]=g.useState(null),[P,K]=g.useState(""),[le,oe]=g.useState("+505 "),[ie,Ae]=g.useState(""),[te,Te]=g.useState(""),[Ue,O]=g.useState("ACTIVO"),[H,G]=g.useState(0),[L,W]=g.useState(!1),[X,D]=g.useState(null),[Q,Z]=g.useState(!1),[be,U]=g.useState([]),[ze,re]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0}),[J,Re]=g.useState(!1),[ke,Be]=g.useState(0),[Ye,ot]=g.useState(new Date().toISOString().slice(0,10)),[Ct,jt]=g.useState(""),[Ot,Tt]=g.useState(!1),[Qt,Ft]=g.useState(null),[Qe,De]=g.useState(""),[Je,dt]=g.useState(0),[ce,we]=g.useState(""),[ue,ne]=g.useState(!1);g.useEffect(()=>{(async()=>{const Le=sr(bt(je,"customers_clothes"),In("createdAt","desc")),Ce=await Ht(Le),pe=[];Ce.forEach(He=>{const he=He.data();pe.push({id:He.id,name:he.name??"",phone:he.phone??"+505 ",place:he.place??"",notes:he.notes??"",status:he.status??"ACTIVO",creditLimit:Number(he.creditLimit??0),createdAt:he.createdAt??xr.now(),balance:0})});for(const He of pe)try{const he=sr(bt(je,"ar_movements"),Ar("customerId","==",He.id)),ee=await Ht(he);let _e=0;ee.forEach(R=>_e+=Number(R.data().amount||0)),He.balance=_e}catch{He.balance=0}I(pe),S(!1)})()},[]);const Ve=()=>{d(""),A("+505 "),m(""),x(""),y("ACTIVO"),w(0)},it=async Le=>{if(Le.preventDefault(),B(""),!u.trim()){B("Ingresa el nombre.");return}const Ce=a_(f);if(Ce.length<6){B("Telfono incompleto.");return}try{const pe=await Wn(bt(je,"customers_clothes"),{name:u.trim(),phone:Ce,place:h||"",notes:p||"",status:v,creditLimit:Number(b||0),createdAt:xr.now()});I(He=>[{id:pe.id,name:u.trim(),phone:Ce,place:h||"",notes:p||"",status:v,creditLimit:Number(b||0),createdAt:xr.now(),balance:0},...He]),Ve(),ne(!1),B(" Cliente creado")}catch(pe){console.error(pe),B(" Error al crear cliente")}},vt=Le=>{T(Le.id),K(Le.name),oe(Le.phone||"+505 "),Ae(Le.place||""),Te(Le.notes||""),O(Le.status||"ACTIVO"),G(Number(Le.creditLimit||0))},me=()=>{T(null),K(""),oe("+505 "),Ae(""),Te(""),O("ACTIVO"),G(0)},Ee=async()=>{if(!k)return;const Le=a_(le);if(!P.trim()){B("Ingresa el nombre.");return}try{await kn(Xt(je,"customers_clothes",k),{name:P.trim(),phone:Le,place:ie||"",notes:te||"",status:Ue,creditLimit:Number(H||0)}),I(Ce=>Ce.map(pe=>pe.id===k?{...pe,name:P.trim(),phone:Le,place:ie||"",notes:te||"",status:Ue,creditLimit:Number(H||0)}:pe)),me(),B(" Cliente actualizado")}catch(Ce){console.error(Ce),B(" Error al actualizar")}},ye=async Le=>{if(confirm(`Eliminar al cliente "${Le.name}"?
Se devolvern al inventario todas las prendas de sus compras y se borrarn sus movimientos.`))try{S(!0);const pe=sr(bt(je,"sales_clothes"),Ar("customerId","==",Le.id)),He=await Ht(pe);for(const _e of He.docs){const R=_e.id;try{await cF(R)}catch(V){console.warn("restoreSaleAndDeleteClothes error",V);try{await zn(Xt(je,"sales_clothes",R))}catch{}}await b$(R)}const he=sr(bt(je,"ar_movements"),Ar("customerId","==",Le.id)),ee=await Ht(he);await Promise.all(ee.docs.map(_e=>zn(Xt(je,"ar_movements",_e.id)))),await zn(Xt(je,"customers_clothes",Le.id)),I(_e=>_e.filter(R=>R.id!==Le.id)),B(" Cliente eliminado y prendas devueltas al inventario")}catch(pe){console.error(pe),B(" No se pudo eliminar el cliente.")}finally{S(!1)}},We=async Le=>{D(Le),U([]),re({saldoActual:0,totalAbonado:0,totalCargos:0}),W(!0),Re(!1),Be(0),ot(new Date().toISOString().slice(0,10)),jt(""),Ft(null),Z(!0);try{const Ce=sr(bt(je,"ar_movements"),Ar("customerId","==",Le.id)),pe=await Ht(Ce),He=[];pe.forEach(he=>{var _e,R;const ee=he.data();He.push({id:he.id,date:ee.date??((R=(_e=ee.createdAt)==null?void 0:_e.toDate)!=null&&R.call(_e)?ee.createdAt.toDate().toISOString().slice(0,10):""),type:ee.type??"CARGO",amount:Number(ee.amount||0),ref:ee.ref||{},comment:ee.comment||"",createdAt:ee.createdAt})}),He.sort((he,ee)=>{var V,q;if(he.date!==ee.date)return he.date.localeCompare(ee.date);const _e=((V=he.createdAt)==null?void 0:V.seconds)||0,R=((q=ee.createdAt)==null?void 0:q.seconds)||0;return _e-R}),U(He),ge(He)}catch(Ce){console.error(Ce),B(" No se pudo cargar el estado de cuenta")}finally{Z(!1)}},ge=Le=>{const Ce=Le.reduce((he,ee)=>he+(Number(ee.amount)||0),0),pe=Le.filter(he=>Number(he.amount)<0).reduce((he,ee)=>he+Math.abs(Number(ee.amount)||0),0),He=Le.filter(he=>Number(he.amount)>0).reduce((he,ee)=>he+Number(ee.amount)||0,0);re({saldoActual:Ce,totalAbonado:pe,totalCargos:He})},Ie=async()=>{if(!X)return;B("");const Le=Number(ke||0);if(!(Le>0)){B("Ingresa un monto de abono mayor a 0.");return}const Ce=parseFloat(Le.toFixed(2));if(!Ye){B("Selecciona la fecha del abono.");return}try{Tt(!0);const pe={customerId:X.id,type:"ABONO",amount:-Ce,date:Ye,comment:Ct||"",createdAt:xr.now()},he={id:(await Wn(bt(je,"ar_movements"),pe)).id,date:Ye,type:"ABONO",amount:-Ce,comment:Ct||"",createdAt:xr.now()},ee=[...be,he].sort((_e,R)=>{var se,Ne;if(_e.date!==R.date)return _e.date.localeCompare(R.date);const V=((se=_e.createdAt)==null?void 0:se.seconds)||0,q=((Ne=R.createdAt)==null?void 0:Ne.seconds)||0;return V-q});U(ee),ge(ee),I(_e=>_e.map(R=>R.id===X.id?{...R,balance:(R.balance||0)-Ce}:R)),D(_e=>_e&&{..._e,balance:(_e.balance||0)-Ce}),Be(0),jt(""),ot(new Date().toISOString().slice(0,10)),Re(!1),B(" Abono registrado")}catch(pe){console.error(pe),B(" Error al registrar el abono")}finally{Tt(!1)}},xt=Le=>{Ft(Le.id),De(Le.date||new Date().toISOString().slice(0,10)),dt(Math.abs(Number(Le.amount||0))),we(Le.comment||"")},Pt=()=>{Ft(null),De(""),dt(0),we("")},It=async()=>{if(!Qt)return;const Le=be.findIndex(he=>he.id===Qt);if(Le===-1)return;const Ce=be[Le],pe=Number(Je||0);if(!(pe>0)){B("El monto debe ser mayor a 0.");return}const He=Ce.type==="ABONO"?-parseFloat(pe.toFixed(2)):+parseFloat(pe.toFixed(2));try{await kn(Xt(je,"ar_movements",Qt),{date:Qe,amount:He,comment:ce||""});const he=[...be];he[Le]={...Ce,date:Qe,amount:He,comment:ce||""},he.sort((_e,R)=>{var se,Ne;if(_e.date!==R.date)return _e.date.localeCompare(R.date);const V=((se=_e.createdAt)==null?void 0:se.seconds)||0,q=((Ne=R.createdAt)==null?void 0:Ne.seconds)||0;return V-q}),U(he),ge(he);const ee=he.reduce((_e,R)=>_e+(Number(R.amount)||0),0);I(_e=>_e.map(R=>R.id===(X==null?void 0:X.id)?{...R,balance:ee}:R)),D(_e=>_e&&{..._e,balance:ee}),Pt(),B(" Movimiento actualizado")}catch(he){console.error(he),B(" Error al actualizar movimiento")}},Ut=async Le=>{var pe,He;if(confirm(`Eliminar este movimiento (${Le.type==="ABONO"?"Abono":"Compra"}) del ${Le.date}?${Le.type==="CARGO"&&((pe=Le.ref)!=null&&pe.saleId)?`
Se devolvern al inventario las prendas de esa venta.`:""}`))try{if(S(!0),Le.type==="CARGO"&&((He=Le.ref)!=null&&He.saleId)){try{await cF(Le.ref.saleId)}catch(_e){console.warn("restoreSaleAndDeleteClothes error",_e),S(!1),B(" No se pudo devolver inventario de la venta.");return}await b$(Le.ref.saleId)}else await zn(Xt(je,"ar_movements",Le.id));const he=be.filter(_e=>{var R,V;return Le.type==="CARGO"&&((R=Le.ref)!=null&&R.saleId)?((V=_e.ref)==null?void 0:V.saleId)!==Le.ref.saleId:_e.id!==Le.id});U(he),ge(he);const ee=he.reduce((_e,R)=>_e+(Number(R.amount)||0),0);I(_e=>_e.map(R=>R.id===(X==null?void 0:X.id)?{...R,balance:ee}:R)),D(_e=>_e&&{..._e,balance:ee}),B(" Movimiento eliminado")}catch(he){console.error(he),B(" Error al eliminar movimiento")}finally{S(!1)}},$t=g.useMemo(()=>[...j].sort((Le,Ce)=>{var pe,He;return Le.status!==Ce.status?Le.status==="BLOQUEADO"?1:-1:(((pe=Ce.createdAt)==null?void 0:pe.seconds)||0)-(((He=Le.createdAt)==null?void 0:He.seconds)||0)}),[j]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Ropa)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>ne(!0),type:"button",children:"Crear Cliente"})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:C?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):$t.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin clientes"})}):$t.map(Le=>{var pe;const Ce=k===Le.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(pe=Le.createdAt)!=null&&pe.toDate?Le.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsx("input",{className:"w-full border p-1 rounded",value:P,onChange:He=>K(He.target.value)}):Le.name}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsx("input",{className:"w-full border p-1 rounded",value:le,onChange:He=>oe(a_(He.target.value))}):Le.phone}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsxs("select",{className:"w-full border p-1 rounded",value:ie,onChange:He=>Ae(He.target.value),children:[i.jsx("option",{value:"",children:""}),y$.map(He=>i.jsx("option",{value:He,children:He},He))]}):Le.place||""}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsxs("select",{className:"w-full border p-1 rounded",value:Ue,onChange:He=>O(He.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Le.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Le.status})}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(H)?"":H,onChange:He=>G(Math.max(0,Number(He.target.value||0)))}):kh(Le.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:kh(Le.balance||0)}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:te,onChange:He=>Te(He.target.value),maxLength:500}):i.jsx("span",{title:Le.notes||"",children:(Le.notes||"").length>40?(Le.notes||"").slice(0,40)+"":Le.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Ce?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Ee,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:me,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>vt(Le),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>ye(Le),children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>We(Le),title:"Ver compras y abonos",children:"Estado de cuenta"})]})})})]},Le.id)})})]})}),E&&i.jsx("p",{className:"mt-2 text-sm",children:E}),ue&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>ne(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ne(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:it,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:u,onChange:Le=>d(Le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:f,onChange:Le=>A(a_(Le.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:Le=>m(Le.target.value),children:[i.jsx("option",{value:"",children:""}),y$.map(Le=>i.jsx("option",{value:Le,children:Le},Le))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:Le=>y(Le.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:b===0?"":b,onChange:Le=>w(Math.max(0,Number(Le.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:p,onChange:Le=>x(Le.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[p.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ne(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),L&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(X==null?void 0:X.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{Be(0),ot(new Date().toISOString().slice(0,10)),jt(""),Re(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>W(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:kh(ze.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:kh(ze.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:kh(ze.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:Q?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):be.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):be.map(Le=>{var pe,He;const Ce=Qt===Le.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ce?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:Qe,onChange:he=>De(he.target.value)}):Le.date||""}),i.jsx("td",{className:"p-2 border",children:Le.amount>=0?(pe=Le.ref)!=null&&pe.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver piezas de esta compra",onClick:()=>c(Le.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(He=Le.ref)!=null&&He.saleId?`Venta #${Le.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsx("input",{className:"w-full border p-1 rounded",value:ce,onChange:he=>we(he.target.value),placeholder:"Comentario"}):i.jsx("span",{title:Le.comment||"",children:(Le.comment||"").length>40?(Le.comment||"").slice(0,40)+"":Le.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:Ce?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Je)?"":Je,onChange:he=>{const ee=Number(he.target.value||0),_e=Number.isFinite(ee)?Math.max(0,parseFloat(ee.toFixed(2))):0;dt(_e)},placeholder:"0.00",title:Le.type==="ABONO"?"Se guardar como negativo":"Se guardar como positivo"}):kh(Le.amount)}),i.jsx("td",{className:"p-2 border",children:Ce?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:It,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Pt,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>xt(Le),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Ut(Le),children:"Borrar"})]})})]},Le.id)})})]})})]})}),J&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(X==null?void 0:X.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Ye,onChange:Le=>ot(Le.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto del abono"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ke===0?"":ke,onChange:Le=>{const Ce=Number(Le.target.value||0),pe=Number.isFinite(Ce)?Math.max(0,parseFloat(Ce.toFixed(2))):0;Be(pe)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se guarda con 2 decimales (se registrar como ABONO negativo)."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Ct,onChange:Le=>jt(Le.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[Ct.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Re(!1),disabled:Ot,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:Ie,disabled:Ot,children:Ot?"Guardando...":"Guardar abono"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",a?` #${a}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((Le,Ce)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:Le.productName}),i.jsx("td",{className:"p-2 border text-right",children:Le.qty}),i.jsx("td",{className:"p-2 border text-right",children:kh(Le.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:kh(Le.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:kh(Le.total)})]},Ce))})]})})]})})]})}const yx=t=>`C$ ${(Number(t)||0).toFixed(2)}`,gLe=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"];async function xLe(t){if(!t)return 0;const e=sr(bt(je,"inventory_clothes_batches"),Ar("productId","==",t)),r=await Ht(e);let n="0000-00-00",a=-1,s=0;return r.forEach(o=>{const l=o.data(),c=String(l.date||"0000-00-00"),u=Number(l.salePrice||0),d=l.createdAt,f=((d==null?void 0:d.seconds)??0)*1e3+((d==null?void 0:d.nanoseconds)??0)/1e6;c>n?(n=c,a=f,s=u):c===n&&f>a&&(a=f,s=u)}),Number(s||0)}async function w$(t){if(!t)return 0;const e=sr(bt(je,"inventory_clothes_batches"),Ar("productId","==",t)),r=await Ht(e);let n=0;return r.forEach(a=>n+=Number(a.data().remaining||0)),n}function N$(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function vLe({role:t="",roles:e}={role:""}){const r=e&&e.length?e:t;Sn(r,"admin"),Sn(r,"vendedor_ropa");const[n,a]=g.useState([]),[s,o]=g.useState([]),[l,c]=g.useState({}),[u,d]=g.useState("CONTADO"),[f,A]=g.useState(""),[h,m]=g.useState(""),[p,x]=g.useState(new Date().toISOString().slice(0,10)),[v,y]=g.useState(""),[b,w]=g.useState([]),j=g.useMemo(()=>b.reduce((ke,Be)=>ke+(Be.qty||0),0),[b]),I=g.useMemo(()=>{const ke=b.reduce((Be,Ye)=>{const ot=Math.max(0,(Number(Ye.unitPrice)||0)*(Ye.qty||0)-(Number(Ye.discount)||0));return Be+ot},0);return Math.floor(ke*100)/100},[b]),[C,S]=g.useState(0),[E,B]=g.useState(""),[k,T]=g.useState(!1),[P,K]=g.useState(!1),[le,oe]=g.useState(""),[ie,Ae]=g.useState("+505 "),[te,Te]=g.useState(""),[Ue,O]=g.useState(""),[H,G]=g.useState("ACTIVO"),[L,W]=g.useState(0),X=()=>{oe(""),Ae("+505 "),Te(""),O(""),G("ACTIVO"),W(0)};g.useEffect(()=>{(async()=>{const ke=sr(bt(je,"customers_clothes"),In("createdAt","desc")),Be=await Ht(ke),Ye=[];Be.forEach(Ft=>{const Qe=Ft.data();Ye.push({id:Ft.id,name:Qe.name??"",phone:Qe.phone??"+505 ",place:Qe.place??"",status:Qe.status??"ACTIVO",creditLimit:Number(Qe.creditLimit??0),balance:0})});for(const Ft of Ye)try{const Qe=sr(bt(je,"ar_movements"),Ar("customerId","==",Ft.id)),De=await Ht(Qe);let Je=0;De.forEach(dt=>Je+=Number(dt.data().amount||0)),Ft.balance=Je}catch{Ft.balance=0}a(Ye);const ot=sr(bt(je,"products_clothes"),In("createdAt","desc")),Ct=await Ht(ot),jt=[];Ct.forEach(Ft=>{const Qe=Ft.data();jt.push({id:Ft.id,name:Qe.name??"(sin nombre)",sku:Qe.sku??""})}),o(jt);const Ot=sr(bt(je,"inventory_clothes_batches"),Ar("remaining",">",0)),Tt=await Ht(Ot),Qt={};Tt.forEach(Ft=>{const Qe=Ft.data(),De=Qe.productId||"",Je=Number(Qe.remaining||0);De&&(Qt[De]=(Qt[De]||0)+Je)}),c(Qt)})()},[]);const D=g.useMemo(()=>n.find(ke=>ke.id===f),[n,f]),Q=(D==null?void 0:D.balance)||0,Z=u==="CREDITO"?Q+Math.max(0,Number(I||0))-Math.max(0,Number(C||0)):0,be=async ke=>{if(!ke)return;if(b.some(jt=>jt.productId===ke)){y("");return}const Be=s.find(jt=>jt.id===ke);if(!Be){y("");return}let Ye=await xLe(ke);Ye||(Ye=Number((Be==null?void 0:Be.price)||0));const ot=await w$(ke),Ct={productId:ke,productName:Be.name||"",sku:Be.sku||"",unitPrice:Number(Ye)||0,available:Number(ot)||0,qty:0,discount:0};w(jt=>[...jt,Ct]),y("")},U=(ke,Be)=>{w(Ye=>Ye.map(ot=>{if(ot.productId!==ke)return ot;if(Be==="")return{...ot,qty:0};const Ct=Math.max(0,Math.floor(Number(Be)));return{...ot,qty:Ct}}))},ze=(ke,Be)=>{w(Ye=>Ye.map(ot=>{if(ot.productId!==ke)return ot;if(Be==="")return{...ot,discount:0};const Ct=Math.max(0,Math.floor(Number(Be)));return{...ot,discount:Ct}}))},re=ke=>w(Be=>Be.filter(Ye=>Ye.productId!==ke)),J=async()=>{if(!p)return"Selecciona la fecha.";if(b.length===0)return"Agrega al menos un producto.";const ke=b.filter(Be=>(Be.qty||0)>0);if(ke.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(I>0))return"El total debe ser mayor a cero.";if(u==="CONTADO"){if(!h.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!f)return"Selecciona un cliente (crdito).";if(C<0)return"El pago inicial no puede ser negativo.";if(C>I)return"El pago inicial no puede superar el total.";if((D==null?void 0:D.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const Be of ke){const Ye=await w$(Be.productId);if(Be.qty>Ye)return`Inventario insuficiente para "${Be.productName}". Disponible: ${Ye} unidades.`;const ot=(Number(Be.unitPrice)||0)*(Be.qty||0),Ct=Number(Be.discount)||0;if(!Number.isInteger(Ct)||Ct<0)return`El descuento en "${Be.productName}" debe ser entero y  0.`;if(Ct>ot)return`El descuento en "${Be.productName}" no puede exceder C$ ${ot.toFixed(2)}.`}return null},Re=async ke=>{ke.preventDefault(),B("");const Be=await J();if(Be){B(" "+Be);return}try{T(!0);const Ye=b.filter(Ot=>(Ot.qty||0)>0).map(Ot=>{const Tt=(Number(Ot.unitPrice)||0)*(Ot.qty||0),Qt=Math.max(0,Math.floor(Number(Ot.discount)||0)),Ft=Math.max(0,Tt-Qt);return{productId:Ot.productId,productName:Ot.productName,sku:Ot.sku||"",qty:Ot.qty,unitPrice:Number(Ot.unitPrice)||0,discount:Qt,total:Math.floor(Ft*100)/100}}),ot={type:u,date:p,createdAt:xr.now(),itemsTotal:Number(I)||0,total:Number(I)||0,quantity:Number(j)||0,items:Ye};u==="CONTADO"?ot.customerName=h.trim():(ot.customerId=f,ot.downPayment=Number(C)||0);const Ct=await Wn(bt(je,"sales_clothes"),ot);if(u==="CREDITO"&&f){const Ot={customerId:f,date:p,createdAt:xr.now(),ref:{saleId:Ct.id}};await Wn(bt(je,"ar_movements"),{...Ot,type:"CARGO",amount:Number(I)||0}),Number(C)>0&&await Wn(bt(je,"ar_movements"),{...Ot,type:"ABONO",amount:-Number(C)})}const jt={};for(const Ot of Ye)if(Ot.qty>0){const{allocations:Tt}=await mLe({productId:Ot.productId,quantity:Ot.qty,saleDate:p,saleId:Ct.id});jt[Ot.productId]={productId:Ot.productId,allocations:Tt}}await kn(Xt(je,"sales_clothes",Ct.id),{allocationsByItem:jt}),d("CONTADO"),A(""),m(""),x(new Date().toISOString().slice(0,10)),w([]),S(0),u==="CREDITO"&&f&&a(Ot=>Ot.map(Tt=>Tt.id===f?{...Tt,balance:(Tt.balance||0)+(Number(I)||0)-(Number(C)||0)}:Tt)),B(" Venta registrada"),(async()=>{const Ot=sr(bt(je,"inventory_clothes_batches"),Ar("remaining",">",0)),Tt=await Ht(Ot),Qt={};Tt.forEach(Ft=>{const Qe=Ft.data(),De=Qe.productId||"",Je=Number(Qe.remaining||0);De&&(Qt[De]=(Qt[De]||0)+Je)}),c(Qt)})()}catch(Ye){console.error(Ye),B(" Error al guardar la venta")}finally{T(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas (Ropa)"}),i.jsxs("form",{onSubmit:Re,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:u,onChange:ke=>d(ke.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),u==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:h,onChange:ke=>m(ke.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("select",{className:"flex-1 border p-2 rounded",value:f,onChange:ke=>A(ke.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),n.map(ke=>i.jsxs("option",{value:ke.status==="ACTIVO"?ke.id:"",disabled:ke.status==="BLOQUEADO",children:[ke.name," | ",ke.phone," | Saldo: ",yx(ke.balance||0)]},ke.id))]}),i.jsx("button",{type:"button",className:"px-20 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>K(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:yx(Q)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:C===0?"":C,onChange:ke=>S(Math.max(0,Number(ke.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:yx(Z)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:p,onChange:ke=>x(ke.target.value)})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:async ke=>{const Be=ke.target.value;y(Be),await be(Be)},children:[i.jsx("option",{value:"",children:"Selecciona un producto"}),s.map(ke=>{const Be=b.some(Ct=>Ct.productId===ke.id),Ye=l[ke.id]||0,ot=Be||Ye<=0;return i.jsxs("option",{value:ot?"":ke.id,disabled:ot,children:[ke.name," ",ke.sku?` ${ke.sku}`:""," ",Ye>0?`(disp: ${Ye})`:"(sin stock)",Be?" (seleccionado)":""]},ke.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Productos sin existencias se muestran en gris y no se pueden seleccionar."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsxs("div",{className:"border rounded overflow-hidden",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),b.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):b.map(ke=>{const Be=Math.max(0,(ke.available||0)-(ke.qty||0)),Ye=(Number(ke.unitPrice)||0)*(ke.qty||0),ot=Math.max(0,Ye-(Number(ke.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[ke.productName,ke.sku?`  ${ke.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:yx(ke.unitPrice)}),i.jsx("div",{className:"col-span-2 text-right",children:Be}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(ke.qty)||ke.qty===0?"":ke.qty,onChange:Ct=>U(ke.productId,Ct.target.value),inputMode:"numeric",placeholder:"0",title:"Cantidad de piezas"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(ke.discount)||ke.discount===0?"":ke.discount,onChange:Ct=>ze(ke.productId,Ct.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento entero (C$)"})}),i.jsx("div",{className:"col-span-1 text-right",children:yx(ot)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>re(ke.productId),title:"Quitar producto",children:""})})]},ke.productId)})]}),b.length>0&&i.jsxs("div",{className:"flex justify-end gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Piezas totales: "}),i.jsx("span",{className:"font-semibold",children:j})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:yx(I)})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:k,children:k?"Guardando...":"Registrar venta"})})]}),E&&i.jsx("p",{className:"mt-2 text-sm",children:E}),P&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-xl p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:le,onChange:ke=>oe(ke.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:ie,onChange:ke=>Ae(N$(ke.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:te,onChange:ke=>Te(ke.target.value),children:[i.jsx("option",{value:"",children:""}),gLe.map(ke=>i.jsx("option",{value:ke,children:ke},ke))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:H,onChange:ke=>G(ke.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:L===0?"":L,onChange:ke=>W(Math.max(0,Number(ke.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Ue,onChange:ke=>O(ke.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{X(),K(!1)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{if(B(""),!le.trim()){B("Ingresa el nombre del nuevo cliente.");return}const ke=N$(ie);try{const Be=await Wn(bt(je,"customers_clothes"),{name:le.trim(),phone:ke,place:te||"",notes:Ue||"",status:H,creditLimit:Number(L||0),createdAt:xr.now()}),Ye={id:Be.id,name:le.trim(),phone:ke,place:te||"",status:H,creditLimit:Number(L||0),balance:0};a(ot=>[Ye,...ot]),A(Be.id),X(),K(!1),B(" Cliente creado")}catch(Be){console.error(Be),B(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),k&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const xo=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function xE(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?Ur(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function yLe(t,e){const r=xE(t);if(!r)return null;if(Array.isArray(t.items))return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??0),items:t.items.map(o=>({productId:String(o.productId||""),productName:String(o.productName||""),sku:o.sku||"",qty:Number(o.qty||0),unitPrice:Number(o.unitPrice??(Number(o.total||0)/Math.max(1,Number(o.qty||0))||0)),discount:Number(o.discount||0)})),customerId:t.customerId||void 0,customerName:t.customerName||void 0};const n=t.item||{},a=Number(t.quantity??n.qty??0),s=Number(t.total??t.itemsTotal??n.total??0);return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??s??0),items:[{productId:String(n.productId||t.productId||""),productName:String(n.productName||t.productName||""),sku:n.sku||t.sku||"",qty:a,unitPrice:Number(n.unitPrice??(s&&a?s/a:0)),discount:Number(n.discount||0)}],customerId:t.customerId||void 0,customerName:t.customerName||void 0}}function bLe(t,e,r,n){const a={};for(const l of t)a[l.productId]||(a[l.productId]={productName:l.productName,lots:[]}),a[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(a))a[l].lots.sort((c,u)=>c.date.localeCompare(u.date));const s=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of s)for(const c of l.items||[]){const u=a[c.productId];if(!u)continue;let d=Number(c.qty||0);if(!(d<=0))for(const f of u.lots){if(d<=0)break;if(f.qtyLeft<=0)continue;const A=Math.min(f.qtyLeft,d);l.date>=r&&l.date<=n&&(o+=A*f.cost),f.qtyLeft-=A,d-=A}}return o}function wLe(){const{refreshKey:t,refresh:e}=Mc(),[r,n]=g.useState(Ur(Qd(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[o,l]=g.useState([]),[c,u]=g.useState([]),[d,f]=g.useState([]),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,j]=g.useState(""),[I,C]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState([]),[T,P]=g.useState(!1),[K,le]=g.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});g.useEffect(()=>{(async()=>{b(!0),j("");try{const O=await Ht(bt(je,"sales_clothes")),H=[],G=[];O.forEach(re=>{const J=re.data(),Re=yLe(J,re.id);Re&&(Re.date<=a&&H.push(Re),Re.date>=r&&Re.date<=a&&G.push(Re))}),u(H),l(G);const L=await Ht(bt(je,"inventory_clothes_batches")),W=[];L.forEach(re=>{const J=re.data(),Re=xE(J);!Re||Re>a||W.push({id:re.id,productId:J.productId,productName:J.productName||"",date:Re,quantity:Number(J.quantity||0),remaining:Number(J.remaining||0),purchasePrice:Number(J.purchasePrice||0)})}),f(W);const X=await Ht(bt(je,"expenses_clothes")),D=[];X.forEach(re=>{const J=re.data(),Re=xE(J);Re&&Re>=r&&Re<=a&&D.push({id:re.id,date:Re,category:J.category||"",description:J.description||"",amount:Number(J.amount||0),status:J.status||""})}),h(D);const Q=await Ht(bt(je,"ar_movements")),Z=[],be={};Q.forEach(re=>{const J=re.data(),Re=xE(J);if(!Re)return;const ke=J.customerId,Be=Number(J.amount||0);ke&&(be[ke]=(be[ke]||0)+Be),J.type==="ABONO"&&Re>=r&&Re<=a&&Z.push({id:re.id,customerId:ke,type:"ABONO",amount:Be,date:Re})}),p(Z);const U=await Ht(bt(je,"customers_clothes")),ze=[];U.forEach(re=>{const J=re.data();ze.push({id:re.id,name:J.name||"",balance:be[re.id]||0})}),v(ze)}catch(O){console.error(O),j(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,a,t]);const oe=g.useMemo(()=>{try{return bLe(d,c,r,a)}catch(O){return console.error(O),0}},[d,c,r,a]),ie=g.useMemo(()=>{const O=o.reduce((be,U)=>be+(U.total||0),0),H=A.reduce((be,U)=>be+(U.amount||0),0),G=O-oe,L=G-H,W=m.reduce((be,U)=>be+Math.abs(U.amount||0),0),X=x.filter(be=>(be.balance||0)>0),D=X.reduce((be,U)=>be+(U.balance||0),0);let Q=0,Z=0;for(const be of o){const U=(be.items||[]).reduce((ze,re)=>ze+(Number(re.qty)||0),0);be.type==="CONTADO"?Q+=U:Z+=U}return{ventasTotales:O,costoMercaderia:oe,gastosPeriodo:H,gananciaAntes:G,gananciaDespues:L,abonosRecibidos:W,saldosPendientes:D,clientesConSaldo:X.length,prendasCash:Q,prendasCredito:Z}},[o,A,m,x,oe]),Ae=g.useMemo(()=>{const O={};for(const H of o){if(H.type!=="CREDITO"||!H.customerId)continue;const G=(H.items||[]).reduce((L,W)=>L+(Number(W.qty)||0),0);O[H.customerId]=(O[H.customerId]||0)+G}return x.filter(H=>(H.balance||0)>0).map(H=>({customerId:H.id,name:H.name,prendasCredito:O[H.id]||0,saldo:H.balance||0})).sort((H,G)=>G.saldo-H.saldo)},[x,o]),te=g.useMemo(()=>{const O={};return x.forEach(H=>O[H.id]=H.name),O},[x]),Te=g.useMemo(()=>[...o].sort((O,H)=>H.date.localeCompare(O.date)).map(O=>{var L;const H=(O.items||[]).reduce((W,X)=>W+(Number(X.qty)||0),0);let G="Cash";return O.type==="CREDITO"&&O.customerId?G=te[O.customerId]||"":O.type==="CONTADO"&&(G=((L=O.customerName)==null?void 0:L.trim())||"Cash"),{id:O.id,date:O.date,type:O.type==="CREDITO"?"Crdito":"Cash",customer:G,piezas:H,total:Number(O.total||0)}}),[o,te]),Ue=async O=>{C(!0),E({id:O.customerId,name:O.name}),k([]),P(!0),le({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const H=[];let G=0,L=0,W=0;for(const Z of o)if(!(Z.type!=="CREDITO"||Z.customerId!==O.customerId))for(const be of Z.items||[]){const U=Number(be.qty||0),ze=Number(be.unitPrice||0),re=U*ze,J=Math.max(0,Number(be.discount||0)),Re=Math.max(0,re-J);H.push({saleId:Z.id,date:Z.date,productName:be.productName,sku:be.sku||"",qty:U,unitPrice:ze,lineTotal:re,discount:J,lineFinal:Re}),G+=re,L+=J,W+=Re}let X=0;for(const Z of m)Z.customerId===O.customerId&&(X+=Math.abs(Z.amount||0));const D=x.find(Z=>Z.id===O.customerId),Q=(D==null?void 0:D.balance)||0;k(H),le({totalBruto:G,totalDescuento:L,totalFiado:W,saldoActual:Q,abonadoPeriodo:X})}catch(H){console.error(H),j(" No se pudo cargar el detalle del cliente.")}finally{P(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Ropa)"}),i.jsx(Rc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:O=>n(O.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:O=>s(O.target.value)})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(ie.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Cash + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(ie.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia antes de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:xo(ie.gananciaAntes)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos del Negocio"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(ie.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia despus de Gastos"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:xo(ie.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(ie.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(ie.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:ie.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:ie.prendasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Crdito (vendidas)"}),i.jsx("div",{className:"text-xl font-semibold",children:ie.prendasCredito})]})]}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado por cliente"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Prendas Crdito (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo actual"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Cargando"})}):Ae.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Sin clientes con saldo"})}):Ae.map(O=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ue({customerId:O.customerId,name:O.name}),title:"Ver piezas fiadas del periodo",children:O.prendasCredito})}),i.jsx("td",{className:"p-2 border font-semibold",children:xo(O.saldo)})]},O.customerId))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):Te.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin transacciones en el rango seleccionado."})}):Te.map(O=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.date}),i.jsx("td",{className:"p-2 border",children:O.customer}),i.jsx("td",{className:"p-2 border",children:O.type}),i.jsx("td",{className:"p-2 border",children:O.piezas}),i.jsx("td",{className:"p-2 border",children:xo(O.total)})]},O.id))})]})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((O,H)=>O.date.localeCompare(H.date)).map(O=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.date}),i.jsx("td",{className:"p-2 border",children:O.category||""}),i.jsx("td",{className:"p-2 border",children:O.description?i.jsx("span",{title:O.description,children:O.description.length>40?O.description.slice(0,40)+"":O.description}):""}),i.jsx("td",{className:"p-2 border",children:xo(O.amount)}),i.jsx("td",{className:"p-2 border",children:O.status||""})]},O.id))})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w}),I&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle del cliente  ",(S==null?void 0:S.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>C(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total Bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(K.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(K.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Total Fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(K.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(K.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:xo(K.abonadoPeriodo)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Pieza"}),i.jsx("th",{className:"p-2 border",children:"SKU"}),i.jsx("th",{className:"p-2 border",children:"Cant."}),i.jsx("th",{className:"p-2 border",children:"P. Unit"}),i.jsx("th",{className:"p-2 border",children:"Monto"})," ",i.jsx("th",{className:"p-2 border",children:"Descuento"})," ",i.jsx("th",{className:"p-2 border",children:"Monto final"})," "]})}),i.jsx("tbody",{children:T?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin piezas fiadas en el periodo."})}):B.sort((O,H)=>O.date.localeCompare(H.date)).map((O,H)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:O.date}),i.jsx("td",{className:"p-2 border",children:O.productName}),i.jsx("td",{className:"p-2 border",children:O.sku||""}),i.jsx("td",{className:"p-2 border",children:O.qty}),i.jsx("td",{className:"p-2 border",children:xo(O.unitPrice)}),i.jsx("td",{className:"p-2 border",children:xo(O.lineTotal)}),i.jsx("td",{className:"p-2 border",children:xo(O.discount)}),i.jsx("td",{className:"p-2 border",children:xo(O.lineFinal)})]},`${O.saleId}-${H}`))})]})})]})})]})}const C$=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],s_=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function NLe(){const[t,e]=g.useState(Ur(Qd(new Date),"yyyy-MM-dd")),[r,n]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Ur(new Date,"yyyy-MM-dd")),[o,l]=g.useState(""),[c,u]=g.useState(""),[d,f]=g.useState(0),[A,h]=g.useState("PENDIENTE"),[m,p]=g.useState(""),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,j]=g.useState(""),[I,C]=g.useState(null),[S,E]=g.useState(""),[B,k]=g.useState(""),[T,P]=g.useState(""),[K,le]=g.useState(0),[oe,ie]=g.useState("PENDIENTE"),[Ae,te]=g.useState("");g.useEffect(()=>{(async()=>{b(!0);try{const D=sr(bt(je,"expenses_clothes"),In("date","desc")),Q=await Ht(D),Z=[];Q.forEach(be=>{const U=be.data();Z.push({id:be.id,date:U.date||Ur(new Date,"yyyy-MM-dd"),category:U.category||"",description:U.description||"",amount:Number(U.amount||0),status:U.status||"PENDIENTE",notes:U.notes||"",createdAt:U.createdAt??xr.now()})}),v(Z)}catch(D){console.error(D),j(" Error al cargar gastos")}finally{b(!1)}})()},[]);const Te=g.useMemo(()=>x.filter(D=>!(t&&D.date<t||r&&D.date>r)),[x,t,r]),Ue=g.useMemo(()=>{const D=Te.reduce((be,U)=>be+(U.amount||0),0),Q=Te.filter(be=>be.status==="PAGADO").reduce((be,U)=>be+(U.amount||0),0),Z=D-Q;return{total:D,pagado:Q,pendiente:Z}},[Te]),O=()=>{s(Ur(new Date,"yyyy-MM-dd")),l(""),u(""),f(0),h("PENDIENTE"),p("")},H=async D=>{if(D.preventDefault(),j(""),!o){j("Selecciona una categora.");return}if(!c.trim()){j("Ingresa una descripcin.");return}if(!d||d<=0){j("Ingresa un monto vlido.");return}try{const Q=await Wn(bt(je,"expenses_clothes"),{date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:xr.now()});v(Z=>[{id:Q.id,date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:xr.now()},...Z]),O(),j(" Gasto registrado")}catch(Q){console.error(Q),j(" Error al guardar gasto")}},G=D=>{C(D.id),E(D.date),k(D.category||""),P(D.description||""),le(Number(D.amount||0)),ie(D.status||"PENDIENTE"),te(D.notes||"")},L=()=>{C(null),E(""),k(""),P(""),le(0),ie("PENDIENTE"),te("")},W=async()=>{if(I){if(!B){j("Selecciona una categora.");return}if(!T.trim()){j("Ingresa una descripcin.");return}if(!K||K<=0){j("Ingresa un monto vlido.");return}try{await kn(Xt(je,"expenses_clothes",I),{date:S,category:B,description:T.trim(),amount:Number(K.toFixed(2)),status:oe,notes:Ae||""}),v(D=>D.map(Q=>Q.id===I?{...Q,date:S,category:B,description:T.trim(),amount:Number(K.toFixed(2)),status:oe,notes:Ae||""}:Q)),L(),j(" Gasto actualizado")}catch(D){console.error(D),j(" Error al actualizar gasto")}}},X=async D=>{confirm(`Eliminar el gasto "${D.description}"?`)&&(await zn(Xt(je,"expenses_clothes",D.id)),v(Z=>Z.filter(be=>be.id!==D.id)),j(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:D=>e(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:D=>n(D.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",s_(Ue.total)]}),i.jsxs("div",{children:["Pagado: ",s_(Ue.pagado)]}),i.jsxs("div",{children:["Pendiente: ",s_(Ue.pendiente)]})]})]}),i.jsxs("form",{onSubmit:H,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:a,onChange:D=>s(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:D=>l(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),C$.map(D=>i.jsx("option",{value:D,children:D},D))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:D=>u(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:d===0?"":d,onChange:D=>f(Math.max(0,Number(D.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:A,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:D=>p(D.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Te.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):Te.slice().sort((D,Q)=>D.date.localeCompare(Q.date)).map(D=>{const Q=I===D.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:Z=>E(Z.target.value)}):D.date}),i.jsx("td",{className:"p-2 border",children:Q?i.jsxs("select",{className:"w-full border p-1 rounded",value:B,onChange:Z=>k(Z.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),C$.map(Z=>i.jsx("option",{value:Z,children:Z},Z))]}):D.category||""}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:Z=>P(Z.target.value)}):i.jsx("span",{title:D.description,children:D.description.length>40?D.description.slice(0,40)+"":D.description})}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(K)?"":K,onChange:Z=>le(Math.max(0,Number(Z.target.value||0)))}):s_(D.amount)}),i.jsx("td",{className:"p-2 border",children:Q?i.jsxs("select",{className:"w-full border p-1 rounded",value:oe,onChange:Z=>ie(Z.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:Ae,onChange:Z=>te(Z.target.value),maxLength:500}):i.jsx("span",{title:D.notes||"",children:(D.notes||"").length>40?(D.notes||"").slice(0,40)+"":D.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Q?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:W,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:L,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>G(D),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>X(D),children:"Borrar"})]})})})]},D.id)})})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w})]})}const Jd=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function CLe(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?Ur(t.createdAt.toDate(),"yyyy-MM-dd"):""}function _Le(t,e){const r=CLe(t);if(!r)return null;const n=t.item||{},a=Number((n==null?void 0:n.qty)??t.quantity??0)||0,s=Number((n==null?void 0:n.total)??t.total??0)||0,o=Number((n==null?void 0:n.unitPrice)??(a>0?s/a:0))||0;return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total||0),quantity:Number(t.quantity||a||0),customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),item:{productId:String((n==null?void 0:n.productId)||t.productId||""),productName:String((n==null?void 0:n.productName)||t.productName||""),sku:(n==null?void 0:n.sku)||t.sku||"",qty:a,unitPrice:o,total:a*o}}}async function ELe(t,e){if(e<=0)return;const r=sr(bt(je,"inventory_clothes_batches"),Ar("productId","==",t)),n=await Ht(r),a=[];n.forEach(o=>{const l=o.data();a.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),a.sort((o,l)=>o.date.localeCompare(l.date));let s=e;for(const o of a){if(s<=0)break;if(o.remaining<=0)continue;const l=Math.min(o.remaining,s);s-=l,await kn(Xt(je,"inventory_clothes_batches",o.id),{remaining:Math.max(0,Number((o.remaining-l).toFixed(0)))})}s>0&&console.warn("consumeFIFO: falt inventario",s)}async function SLe(t,e){if(e<=0)return;const r=sr(bt(je,"inventory_clothes_batches"),Ar("productId","==",t)),n=await Ht(r),a=[];n.forEach(o=>{const l=o.data();a.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),a.sort((o,l)=>o.date.localeCompare(l.date));let s=e;for(const o of a){if(s<=0)break;const l=Math.max(0,o.quantity-o.remaining);if(l<=0)continue;const c=Math.min(l,s);s-=c,await kn(Xt(je,"inventory_clothes_batches",o.id),{remaining:Number((o.remaining+c).toFixed(0))})}s>0&&console.warn("restoreFIFO: no se devolvi todo",s)}async function bse(t){const e=sr(bt(je,"ar_movements"),Ar("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>zn(Xt(je,"ar_movements",n.id))))}async function ILe(t,e,r){if(await bse(t.id),t.type!=="CREDITO"||!t.customerId)return;const n={customerId:t.customerId,date:t.date,createdAt:xr.now(),ref:{saleId:t.id}},{addDoc:a}=await oA(async()=>{const{addDoc:o}=await Promise.resolve().then(()=>ebe);return{addDoc:o}},void 0);await a(bt(je,"ar_movements"),{...n,type:"CARGO",amount:Number(e)||0});const s=Math.max(0,Number(r??t.downPayment??0));s>0&&await a(bt(je,"ar_movements"),{...n,type:"ABONO",amount:-s})}function jLe(){const[t,e]=g.useState(!1),[r,n]=g.useState(!1),[a,s]=g.useState(null),[o,l]=g.useState([]),c=async re=>{e(!0),n(!0),s(re),l([]);try{const Re=(await Ht(sr(bt(je,"sales_clothes"),Ar("__name__","==",re)))).docs[0],ke=Re==null?void 0:Re.data(),Ye=(Array.isArray(ke==null?void 0:ke.items)?ke.items:ke!=null&&ke.item?[ke.item]:[]).map(ot=>({productName:String(ot.productName||""),qty:Number(ot.qty||0),unitPrice:Number(ot.unitPrice||0),discount:Number(ot.discount||0),total:Number(ot.total||0)}));l(Ye)}catch(J){console.error(J)}finally{n(!1)}},[u,d]=g.useState(Ur(new Date,"yyyy-MM-01")),[f,A]=g.useState(Ur(new Date,"yyyy-MM-dd")),[h,m]=g.useState([]),[p,x]=g.useState([]),[v,y]=g.useState(!0),[b,w]=g.useState(""),[j,I]=g.useState(""),[C,S]=g.useState(""),[E,B]=g.useState(null),[k,T]=g.useState(!1),[P,K]=g.useState(null),[le,oe]=g.useState(0),ie=15,[Ae,te]=g.useState(1),Te=g.useMemo(()=>{const re={};return h.forEach(J=>re[J.id]=J.name),re},[h]);g.useEffect(()=>{(async()=>{y(!0),w("");try{const re=await Ht(bt(je,"customers_clothes")),J=[];re.forEach(Be=>J.push({id:Be.id,name:Be.data().name||""})),m(J);const Re=await Ht(sr(bt(je,"sales_clothes"),In("createdAt","desc"))),ke=[];Re.forEach(Be=>{const Ye=_Le(Be.data(),Be.id);Ye&&Ye.date>=u&&Ye.date<=f&&ke.push(Ye)}),x(ke.sort((Be,Ye)=>Ye.date.localeCompare(Be.date))),te(1)}catch(re){console.error(re),w(" Error cargando transacciones.")}finally{y(!1)}})()},[u,f]);const Ue=g.useMemo(()=>p.filter(re=>!(j&&re.customerId!==j||C&&re.type!==C)),[p,j,C]),O=g.useMemo(()=>{let re=0,J=0,Re=0,ke=0;for(const Be of Ue)Be.type==="CONTADO"?(re+=Be.item.qty,Re+=Be.total):(J+=Be.item.qty,ke+=Be.total);return{piezasCash:re,piezasCredito:J,montoCash:Re,montoCredito:ke}},[Ue]),H=Math.max(1,Math.ceil(Ue.length/ie)),G=g.useMemo(()=>{const re=(Ae-1)*ie;return Ue.slice(re,re+ie)},[Ue,Ae]),L=re=>{B(null),K(re),oe(re.item.qty||0),T(!0)},W=async re=>{if(B(null),!!window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{y(!0),await cF(re.id),await bse(re.id),x(J=>J.filter(Re=>Re.id!==re.id)),w(" Venta eliminada")}catch(J){console.error(J),w(" No se pudo eliminar la venta.")}finally{y(!1)}},X=async()=>{if(!P)return;const re=Number(P.item.qty||0),J=Math.max(1,Math.floor(Number(le)||0));if(J===re){T(!1);return}const Re=Number(P.item.unitPrice||0),ke=Number((Re*J).toFixed(2));try{y(!0);const Be=J-re;Be>0?await ELe(P.item.productId,Be):Be<0&&await SLe(P.item.productId,-Be);const Ye=Xt(je,"sales_clothes",P.id);await kn(Ye,{quantity:J,total:ke,itemsTotal:ke,"item.qty":J,"item.total":ke,updatedAt:xr.now()});const ot=Math.min(Number(P.downPayment||0),ke);await ILe(P,ke,ot),x(Ct=>Ct.map(jt=>jt.id===P.id?{...jt,quantity:J,total:ke,item:{...jt.item,qty:J,total:ke},downPayment:ot}:jt)),w(" Venta actualizada"),T(!1)}catch(Be){console.error(Be),w(" No se pudo actualizar la venta.")}finally{y(!1)}},D=()=>{const re=`Reporte de transacciones (Ropa)  ${u} a ${f}`,J=Ye=>(Ye||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Re=Ue.map(Ye=>{const ot=Ye.customerName||(Ye.customerId?Te[Ye.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${Ye.date}</td>
          <td>${J(ot)}</td>
          <td>${Ye.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${Ye.item.qty}</td>
          <td style="text-align:right">${Jd(Ye.total)}</td>
        </tr>`}).join(""),ke=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${J(re)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${J(re)}</h1>
      <div class="kpis">
        <div><b>Piezas Cash:</b> ${O.piezasCash}</div>
        <div><b>Piezas Crdito:</b> ${O.piezasCredito}</div>
        <div><b>Monto Cash:</b> ${Jd(O.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${Jd(O.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Piezas</th><th>Monto</th>
      </tr></thead><tbody>
      ${Re||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,Be=window.open("","_blank");Be&&(Be.document.open(),Be.document.write(ke),Be.document.close())},Q=()=>te(1),Z=()=>te(re=>Math.max(1,re-1)),be=()=>te(re=>Math.min(H,re+1)),U=()=>te(H),ze=()=>{const re=[];if(H<=7)for(let Re=1;Re<=H;Re++)re.push(Re);else{const Re=Math.max(1,Ae-2),ke=Math.min(H,Ae+2);re.push(1),Re>2&&re.push(-1);for(let Be=Re;Be<=ke;Be++)Be!==1&&Be!==H&&re.push(Be);ke<H-1&&re.push(-2),re.push(H)}return i.jsxs("div",{className:"flex items-center gap-1 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Q,disabled:Ae===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Z,disabled:Ae===1,children:" Anterior"}),re.map((Re,ke)=>typeof Re=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${Re===Ae?"bg-blue-600 text-white":""}`,onClick:()=>te(Re),children:Re},ke):i.jsx("span",{className:"px-2",children:""},ke)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:be,disabled:Ae===H,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:U,disabled:Ae===H,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",Ae," de ",H,"  ",Ue.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Reporte de transacciones (Ropa)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:re=>{d(re.target.value),te(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:re=>{A(re.target.value),te(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[220px]",value:j,onChange:re=>{I(re.target.value),te(1)},children:[i.jsx("option",{value:"",children:"Todos"}),h.map(re=>i.jsx("option",{value:re.id,children:re.name},re.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:C,onChange:re=>{S(re.target.value),te(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsx("button",{className:"ml-auto px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:D,children:"Exportar PDF"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:O.piezasCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:O.piezasCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Jd(O.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Jd(O.montoCredito)})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Piezas"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:v?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):G.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin transacciones en el rango."})}):G.map(re=>{const J=re.customerName||(re.customerId?Te[re.customerId]:"")||"Nombre cliente";return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:re.date}),i.jsx("td",{className:"p-2 border",children:J}),i.jsx("td",{className:"p-2 border",children:re.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver piezas de esta transaccin",onClick:()=>c(re.id),children:re.item.qty})}),i.jsx("td",{className:"p-2 border",children:Jd(re.total)}),i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>B(Re=>Re===re.id?null:re.id),title:"Acciones",children:""}),E===re.id&&i.jsxs("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:[i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>L(re),children:"Editar"}),i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>W(re),children:"Eliminar"})]})]})]},re.id)})})]}),ze()]}),b&&i.jsx("p",{className:"mt-2 text-sm",children:b}),k&&P&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-md p-4",children:[i.jsx("h3",{className:"text-lg font-bold mb-2",children:"Editar venta"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("div",{className:"font-semibold",children:[P.item.productName," ",P.item.sku?` ${P.item.sku}`:""]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (piezas)"}),i.jsx("input",{type:"number",step:"1",min:1,className:"w-full border p-2 rounded",value:le,onChange:re=>oe(Math.max(1,Math.floor(Number(re.target.value||0))))})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Unit"}),i.jsx("div",{className:"text-lg font-semibold",children:Jd(P.item.unitPrice)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Nuevo total"}),i.jsx("div",{className:"text-lg font-semibold",children:Jd(Number(P.item.unitPrice)*Number(le||0))})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{T(!1),K(null)},children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:X,children:"Guardar cambios"})]})]})}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",a?` #${a}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((re,J)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:re.productName}),i.jsx("td",{className:"p-2 border text-right",children:re.qty}),i.jsx("td",{className:"p-2 border text-right",children:Jd(re.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Jd(re.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Jd(re.total)})]},J))})]})})]})})]})}const _$=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],qc=t=>`C$ ${(Number(t)||0).toFixed(2)}`,x0=t=>Math.round((Number(t)||0)*100)/100,PLe=new Set(["PAGADA","PAGADO","CERRADA","CERRADO","LIQUIDADA","LIQUIDADO"]),yy=t=>{const e=String(t||"").trim().toUpperCase();return PLe.has(e)?"PAGADA":"PENDIENTE"};function i_(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function E$(t){const e=sr(bt(je,"ar_movements_pollo"),Ar("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>zn(Xt(je,"ar_movements_pollo",n.id))))}function TLe({role:t="",roles:e,sellerPolloId:r="",currentUserEmail:n}){const a=e&&e.length?e:t,s=String(r||"").trim(),o=Sn(a,"vendedor_pollo"),l=Sn(a,"admin"),[c,u]=g.useState([]),[d,f]=g.useState(!1),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState(!1),[I,C]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState([]),T=async fe=>{var et;j(!0),C(!0),E(fe),k([]);try{const nt=await Cs(Xt(je,"salesV2",fe));let ct=null;if(nt.exists()?ct=nt.data():ct=(et=(await Ht(sr(bt(je,"salesV2"),Ar("name","==",fe)))).docs[0])==null?void 0:et.data(),!ct){k([]);return}let ve=[];if(Array.isArray(ct.items)&&ct.items.length>0)ve=ct.items;else if(ct.items&&typeof ct.items=="object")try{ve=Object.values(ct.items)}catch{ve=[]}else ct.item?ve=[ct.item]:Array.isArray(ct.products)&&ct.products.length>0?ve=ct.products:Array.isArray(ct.lines)&&ct.lines.length>0?ve=ct.lines:Array.isArray(ct.detalles)&&ct.detalles.length>0?ve=ct.detalles:(ct.productName||ct.product)&&(ve=[{productName:ct.productName||ct.product||"",qty:ct.qty??ct.quantity??ct.lbs??0,unitPrice:ct.unitPrice??ct.price??0,discount:ct.discount??0,total:ct.total??ct.amount??0}]);const ft=Mt=>{if(Mt==null)return NaN;if(typeof Mt=="number")return Mt;let Yt=String(Mt).trim();if(!Yt)return NaN;if(Yt=Yt.replace(/[^0-9.,-]/g,""),!Yt)return NaN;Yt.indexOf(".")>-1&&Yt.indexOf(",")>-1?Yt=Yt.replace(/,/g,""):Yt.indexOf(",")>-1&&Yt.indexOf(".")===-1&&(Yt=Yt.replace(/,/g,"."));const ar=Number(Yt);return Number.isNaN(ar)?NaN:ar},St=new Set;for(const Mt of ve)if(Array.isArray(Mt==null?void 0:Mt.allocations))for(const Yt of Mt.allocations){const ar=String((Yt==null?void 0:Yt.batchId)||"").trim();ar&&St.add(ar)}else if(Mt!=null&&Mt.allocations&&typeof Mt.allocations=="object")try{for(const Yt of Object.values(Mt.allocations)){const ar=String((Yt==null?void 0:Yt.batchId)||"").trim();ar&&St.add(ar)}}catch{}if(Array.isArray(ct==null?void 0:ct.allocations))for(const Mt of ct.allocations){const Yt=String((Mt==null?void 0:Mt.batchId)||"").trim();Yt&&St.add(Yt)}const wt={};St.size>0&&await Promise.all(Array.from(St).map(async Mt=>{try{const Yt=await Cs(Xt(je,"inventory_batches",Mt));if(Yt.exists()){const ar=Yt.data();wt[Mt]=Number(ar.salePrice??ar.sale_price??ar.price??0)}}catch{}}));const yt=new Set;for(const Mt of ve){const Yt=String(Mt.productId||"").trim();Yt&&yt.add(Yt)}const Et={};yt.size>0&&await Promise.all(Array.from(yt).map(async Mt=>{try{const Yt=await Cs(Xt(je,"products",Mt));if(Yt.exists()){const ar=Yt.data();Et[Mt]=Number(ar.salePrice??ar.price??0)}}catch{}}));const qt=ve.map(Mt=>{const Yt=String(Mt.productName||Mt.product||Mt.name||"(sin nombre)"),ar=Number(Mt.qty??Mt.quantity??Mt.lbs??Mt.weight??0)||0,vr=ft(Mt.total??Mt.lineFinal??Mt.amount??Mt.monto??Mt.line_total)||0;let ur=0;const Dt=[Mt.unitPrice,Mt.unitPricePackage,Mt.salePrice,Mt.sale_price,Mt.price,Mt.unit_price,Mt.pricePerUnit,Mt.price_per_unit];for(const Sr of Dt){const pr=ft(Sr);if(!Number.isNaN(pr)&&pr!==0){ur=pr;break}}if(!ur){const Sr=(ct==null?void 0:ct.salePrice)??(ct==null?void 0:ct.sale_price)??(ct==null?void 0:ct.unitPrice)??(ct==null?void 0:ct.unit_price)??(ct==null?void 0:ct.price)??(ct==null?void 0:ct.pricePerUnit),pr=ft(Sr);!Number.isNaN(pr)&&pr!==0&&(ur=pr)}if(!ur){const Sr=Array.isArray(Mt.allocations)?Mt.allocations[0]:Mt.allocations&&typeof Mt.allocations=="object"?Object.values(Mt.allocations)[0]:null,pr=Sr?String(Sr.batchId||"").trim():"";pr&&wt[pr]&&(ur=wt[pr]||0)}!ur&&Mt.productId&&(ur=Et[String(Mt.productId)]||0),(!ur||ur===0)&&vr>0&&ar>0&&(ur=vr/ar);const Yr=ft(Mt.discount??Mt.desc??0)||0;let Vr=vr;return(!Vr||Vr===0)&&(Vr=Number(ur*ar||0)),Vr=Number(Vr)||0,{productName:Yt,qty:ar,unitPrice:ur,discount:Yr,total:Vr}});k(qt)}catch(nt){console.error(nt)}finally{C(!1)}},[P,K]=g.useState(""),[le,oe]=g.useState("+505 "),[ie,Ae]=g.useState(""),[te,Te]=g.useState(""),[Ue,O]=g.useState("ACTIVO"),[H,G]=g.useState(0),[L,W]=g.useState(""),[X,D]=g.useState(0),[Q,Z]=g.useState([]),[be,U]=g.useState(!0),[ze,re]=g.useState(""),[J,Re]=g.useState(null),[ke,Be]=g.useState(""),[Ye,ot]=g.useState("+505 "),[Ct,jt]=g.useState(""),[Ot,Tt]=g.useState(""),[Qt,Ft]=g.useState("ACTIVO"),[Qe,De]=g.useState(0),[Je,dt]=g.useState(""),[ce,we]=g.useState(!1),[ue,ne]=g.useState(null),[Ve,it]=g.useState(!1),[vt,me]=g.useState([]),[Ee,ye]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),[We,ge]=g.useState(!1),[Ie,xt]=g.useState(0),[Pt,It]=g.useState(new Date().toISOString().slice(0,10)),[Ut,$t]=g.useState(""),[Le,Ce]=g.useState(!1),[pe,He]=g.useState(null),[he,ee]=g.useState(""),[_e,R]=g.useState(0),[V,q]=g.useState(""),[se,Ne]=g.useState(null),[Me,Ke]=g.useState(!1),[Pe,rt]=g.useState(null),[lt,ht]=g.useState(!1),[kt,de]=g.useState(!1),[qe,at]=g.useState(null);g.useEffect(()=>{(async()=>{try{if(U(!0),o&&!s){Z([]),re(" Este usuario no tiene vendedor asociado (sellerPolloId vaco).");return}const fe=await Ht(bt(je,"sellers_candies")),et=[];fe.forEach(ft=>{const St=ft.data();et.push({id:ft.id,name:String(St.name||"")})}),u(et);const nt=o?sr(bt(je,"customers_pollo"),Ar("vendorId","==",s),In("createdAt","desc")):sr(bt(je,"customers_pollo"),In("createdAt","desc")),ct=await Ht(nt),ve=[];ct.forEach(ft=>{const St=ft.data();ve.push({id:ft.id,name:St.name??"",phone:St.phone??"+505 ",place:St.place??"",notes:St.notes??"",status:St.status??"ACTIVO",creditLimit:Number(St.creditLimit??0),createdAt:St.createdAt??xr.now(),balance:0,vendorId:St.vendorId||"",vendorName:St.vendorName||"",initialDebt:Number(St.initialDebt||0),lastAbonoDate:"",lastAbonoAmount:0})});for(const ft of ve)try{const St=sr(bt(je,"ar_movements_pollo"),Ar("customerId","==",ft.id)),wt=await Ht(St);let yt=0,Et=null,qt=!1;wt.forEach(vr=>{var Yr,Vr,Sr;const ur=vr.data(),Dt=Number(ur.amount||0);if(yt+=Dt,Dt>0&&yy(ur.debtStatus??ur.creditStatus??ur.cycleStatus??ur.status)==="PENDIENTE"&&(qt=!0),Dt<0){const pr=ur.date??((Vr=(Yr=ur.createdAt)==null?void 0:Yr.toDate)!=null&&Vr.call(Yr)?ur.createdAt.toDate().toISOString().slice(0,10):""),jr=(Sr=ur.createdAt)!=null&&Sr.seconds?Number(ur.createdAt.seconds):0;(!Et||jr>=Et.ts)&&(Et={date:pr,amount:Math.abs(Dt),ts:jr})}});const Mt=Number(ft.initialDebt||0),Yt=x0(Mt+yt);ft.balance=Yt,(qt||Yt>0)&&Et?(ft.lastAbonoDate=Et.date,ft.lastAbonoAmount=Et.amount):(ft.lastAbonoDate="",ft.lastAbonoAmount=0)}catch{ft.balance=Number(ft.initialDebt||0),ft.lastAbonoDate="",ft.lastAbonoAmount=0}Z(ve)}catch(fe){console.error(fe),re(" Error cargando clientes.")}finally{U(!1)}})()},[o,s]);const st=()=>{K(""),oe("+505 "),Ae(""),Te(""),O("ACTIVO"),G(0),W(""),D(0)},Nt=async fe=>{var ve;if(fe.preventDefault(),re(""),!P.trim()){re("Ingresa el nombre.");return}const et=i_(le);if(et.length<6){re("Telfono incompleto.");return}const nt=o?s:String(L||""),ct=nt&&((ve=c.find(ft=>ft.id===nt))==null?void 0:ve.name)||"";try{const ft=Number(X||0),St=await Wn(bt(je,"customers_pollo"),{name:P.trim(),phone:et,place:ie||"",notes:te||"",status:Ue,creditLimit:Number(H||0),vendorId:nt,vendorName:ct,initialDebt:ft,createdAt:xr.now()});Z(wt=>[{id:St.id,name:P.trim(),phone:et,place:ie||"",notes:te||"",status:Ue,creditLimit:Number(H||0),vendorId:nt,vendorName:ct,initialDebt:ft,createdAt:xr.now(),balance:ft,lastAbonoDate:"",lastAbonoAmount:0},...wt]),st(),Ke(!1),re(" Cliente creado")}catch(ft){console.error(ft),re(" Error al crear cliente")}},Rt=fe=>{if(o){re(" No permitido: vendedores no editan clientes desde el listado.");return}Re(fe.id),Be(fe.name),ot(fe.phone||"+505 "),jt(fe.place||""),Tt(fe.notes||""),Ft(fe.status||"ACTIVO"),De(Number(fe.creditLimit||0)),dt(String(fe.vendorId||""))},nr=()=>{Re(null),Be(""),ot("+505 "),jt(""),Tt(""),Ft("ACTIVO"),De(0),dt("")},_r=async()=>{var St;if(o){re(" No permitido.");return}if(!J)return;const fe=i_(Ye);if(!ke.trim()){re("Ingresa el nombre.");return}const et=Q.find(wt=>wt.id===J),nt=String((et==null?void 0:et.vendorId)||""),ct=o?s:String(Je||"");if(o&&nt&&nt!==s){re(" Este cliente pertenece a otro vendedor.");return}if(l&&nt&&ct&&nt!==ct){re(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const ve=o?s:String(Je||""),ft=ve&&((St=c.find(wt=>wt.id===ve))==null?void 0:St.name)||"";try{await kn(Xt(je,"customers_pollo",J),{name:ke.trim(),phone:fe,place:Ct||"",notes:Ot||"",status:Qt,creditLimit:Number(Qe||0),vendorId:ve,vendorName:ft}),Z(wt=>wt.map(yt=>yt.id===J?{...yt,name:ke.trim(),phone:fe,place:Ct||"",notes:Ot||"",status:Qt,creditLimit:Number(Qe||0),vendorId:ve,vendorName:ft}:yt)),nr(),re(" Cliente actualizado")}catch(wt){console.error(wt),re(" Error al actualizar")}},$r=async fe=>{if(confirm(`Eliminar al cliente "${fe.name}"?
Se borrarn todas sus ventas y movimientos.`))try{U(!0);const nt=sr(bt(je,"salesV2"),Ar("customerId","==",fe.id)),ct=await Ht(nt);for(const St of ct.docs){const wt=St.id;try{await zn(Xt(je,"salesV2",wt))}catch(yt){console.warn("delete sale error",yt)}await E$(wt)}const ve=sr(bt(je,"ar_movements_pollo"),Ar("customerId","==",fe.id)),ft=await Ht(ve);await Promise.all(ft.docs.map(St=>zn(Xt(je,"ar_movements_pollo",St.id)))),await zn(Xt(je,"customers_pollo",fe.id)),Z(St=>St.filter(wt=>wt.id!==fe.id)),re(" Cliente eliminado y registros borrados")}catch(nt){console.error(nt),re(" No se pudo eliminar el cliente.")}finally{U(!1)}},or=(fe,et)=>{const nt=fe.reduce((St,wt)=>St+(Number(wt.amount)||0),0),ct=fe.filter(St=>Number(St.amount)<0).reduce((St,wt)=>St+Math.abs(Number(wt.amount)||0),0),ve=fe.filter(St=>Number(St.amount)>0).reduce((St,wt)=>St+(Number(wt.amount)||0),0),ft=Number(et||0)+nt;ye({saldoActual:ft,totalAbonado:ct,totalCargos:Number(et||0)+ve,saldoRestante:ft})},kr=async fe=>{ne(fe),me([]),ye({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),we(!0),ht(!1),de(!1),at(null),ge(!1),xt(0),It(new Date().toISOString().slice(0,10)),$t(""),He(null),it(!0);try{const et=sr(bt(je,"ar_movements_pollo"),Ar("customerId","==",fe.id)),nt=await Ht(et),ct=[];nt.forEach(ve=>{var yt,Et;const ft=ve.data(),St=ft.date??((Et=(yt=ft.createdAt)==null?void 0:yt.toDate)!=null&&Et.call(yt)?ft.createdAt.toDate().toISOString().slice(0,10):""),wt=Number(ft.amount||0);ct.push({id:ve.id,date:St,type:ft.type??(wt<0?"ABONO":"CARGO"),amount:wt,ref:ft.ref||{},comment:ft.comment||"",createdAt:ft.createdAt,debtStatus:yy(ft.debtStatus??ft.creditStatus??ft.cycleStatus??ft.status)})}),ct.sort((ve,ft)=>{var yt,Et;if(ve.date!==ft.date)return ve.date.localeCompare(ft.date);const St=((yt=ve.createdAt)==null?void 0:yt.seconds)||0,wt=((Et=ft.createdAt)==null?void 0:Et.seconds)||0;return St-wt}),me(ct),or(ct,Number(fe.initialDebt||0))}catch(et){console.error(et),re(" No se pudo cargar el estado de cuenta")}finally{it(!1)}},en=(fe,et)=>x0(et||0)>0?!0:fe.some(nt=>nt.type==="CARGO"&&yy(nt.debtStatus)==="PENDIENTE"),rn=fe=>{const et=fe.filter(nt=>Number(nt.amount)<0).map(nt=>{var ct;return{date:nt.date,amount:Math.abs(Number(nt.amount||0)),ts:((ct=nt.createdAt)==null?void 0:ct.seconds)||0}}).sort((nt,ct)=>(nt.ts||0)-(ct.ts||0));return et.length?et[et.length-1]:null},Er=async()=>{if(!ue)return;re("");const fe=Number(Ie||0);if(!(fe>0)){re("Ingresa un monto de abono mayor a 0.");return}const et=parseFloat(fe.toFixed(2));if(!Pt){re("Selecciona la fecha del abono.");return}try{Ce(!0);const nt={customerId:ue.id,type:"ABONO",amount:-et,date:Pt,comment:Ut||"",createdAt:xr.now()},ve={id:(await Wn(bt(je,"ar_movements_pollo"),nt)).id,date:Pt,type:"ABONO",amount:-et,comment:Ut||"",createdAt:xr.now()},ft=[...vt,ve].sort((Et,qt)=>{var ar,vr;if(Et.date!==qt.date)return Et.date.localeCompare(qt.date);const Mt=((ar=Et.createdAt)==null?void 0:ar.seconds)||0,Yt=((vr=qt.createdAt)==null?void 0:vr.seconds)||0;return Mt-Yt});me(ft),or(ft,Number(ue.initialDebt||0));const St=ft.reduce((Et,qt)=>Et+(Number(qt.amount)||0),0),wt=x0(Number(ue.initialDebt||0)+St),yt=en(ft,wt);Z(Et=>Et.map(qt=>{if(qt.id!==ue.id)return qt;const Mt=x0((qt.balance||0)-et);return{...qt,balance:Mt,lastAbonoDate:yt?Pt:"",lastAbonoAmount:yt?et:0}})),ne(Et=>Et&&{...Et,balance:x0((Et.balance||0)-et),lastAbonoDate:yt?Pt:"",lastAbonoAmount:yt?et:0}),xt(0),$t(""),It(new Date().toISOString().slice(0,10)),ge(!1),re(" Abono registrado")}catch(nt){console.error(nt),re(" Error al registrar el abono")}finally{Ce(!1)}},Se=fe=>{He(fe.id),ee(fe.date||new Date().toISOString().slice(0,10)),R(Math.abs(Number(fe.amount||0))),q(fe.comment||"")},gt=()=>{He(null),ee(""),R(0),q("")},er=async()=>{if(!pe||!ue)return;const fe=vt.findIndex(ve=>ve.id===pe);if(fe===-1)return;const et=vt[fe],nt=Number(_e||0);if(!(nt>0)){re("El monto debe ser mayor a 0.");return}const ct=et.type==="ABONO"?-parseFloat(nt.toFixed(2)):+parseFloat(nt.toFixed(2));try{await kn(Xt(je,"ar_movements_pollo",pe),{date:he,amount:ct,comment:V||""});const ve=[...vt];ve[fe]={...et,date:he,amount:ct,comment:V||""},ve.sort((Et,qt)=>{var ar,vr;if(Et.date!==qt.date)return Et.date.localeCompare(qt.date);const Mt=((ar=Et.createdAt)==null?void 0:ar.seconds)||0,Yt=((vr=qt.createdAt)==null?void 0:vr.seconds)||0;return Mt-Yt}),me(ve),or(ve,Number(ue.initialDebt||0));const ft=ve.reduce((Et,qt)=>Et+(Number(qt.amount)||0),0),St=x0(Number(ue.initialDebt||0)+ft),wt=en(ve,St),yt=wt?rn(ve):null;Z(Et=>Et.map(qt=>qt.id===ue.id?{...qt,balance:St,lastAbonoDate:wt&&yt?yt.date:"",lastAbonoAmount:wt&&yt?yt.amount:0}:qt)),ne(Et=>Et&&{...Et,balance:St,lastAbonoDate:wt&&yt?yt.date:"",lastAbonoAmount:wt&&yt?yt.amount:0}),gt(),re(" Movimiento actualizado")}catch(ve){console.error(ve),re(" Error al actualizar movimiento")}},Mr=async fe=>{var nt,ct;if(confirm(`Eliminar este movimiento (${fe.type==="ABONO"?"Abono":"Compra"}) del ${fe.date}?${fe.type==="CARGO"&&((nt=fe.ref)!=null&&nt.saleId)?`
Se borrarn los registros de esa venta.`:""}`)&&ue)try{if(U(!0),fe.type==="CARGO"&&((ct=fe.ref)!=null&&ct.saleId)){try{await zn(Xt(je,"salesV2",fe.ref.saleId))}catch(Et){console.warn("delete sale error",Et),U(!1),re(" No se pudo borrar la venta asociada.");return}await E$(fe.ref.saleId)}else await zn(Xt(je,"ar_movements_pollo",fe.id));const ve=vt.filter(Et=>{var qt,Mt;return fe.type==="CARGO"&&((qt=fe.ref)!=null&&qt.saleId)?((Mt=Et.ref)==null?void 0:Mt.saleId)!==fe.ref.saleId:Et.id!==fe.id});me(ve),or(ve,Number(ue.initialDebt||0));const ft=ve.reduce((Et,qt)=>Et+(Number(qt.amount)||0),0),St=x0(Number(ue.initialDebt||0)+ft),wt=en(ve,St),yt=wt?rn(ve):null;Z(Et=>Et.map(qt=>qt.id===ue.id?{...qt,balance:St,lastAbonoDate:wt&&yt?yt.date:"",lastAbonoAmount:wt&&yt?yt.amount:0}:qt)),ne(Et=>Et&&{...Et,balance:St,lastAbonoDate:wt&&yt?yt.date:"",lastAbonoAmount:wt&&yt?yt.amount:0}),at(null),re(" Movimiento eliminado")}catch(ve){console.error(ve),re(" Error al eliminar movimiento")}finally{U(!1)}},Or=async fe=>{if(fe.type!=="CARGO")return;const et=yy(fe.debtStatus)==="PAGADA"?"PENDIENTE":"PAGADA";try{Ne(fe.id),await kn(Xt(je,"ar_movements_pollo",fe.id),{debtStatus:et});const nt=vt.map(ct=>ct.id===fe.id?{...ct,debtStatus:et}:ct);if(me(nt),ue){or(nt,Number(ue.initialDebt||0));const ct=nt.reduce((wt,yt)=>wt+(Number(yt.amount)||0),0),ve=x0(Number(ue.initialDebt||0)+ct),ft=en(nt,ve),St=ft?rn(nt):null;Z(wt=>wt.map(yt=>yt.id===ue.id?{...yt,balance:ve,lastAbonoDate:ft&&St?St.date:"",lastAbonoAmount:ft&&St?St.amount:0}:yt)),ne(wt=>wt&&{...wt,balance:ve,lastAbonoDate:ft&&St?St.date:"",lastAbonoAmount:ft&&St?St.amount:0})}re(et==="PAGADA"?" Compra marcada como pagada":" Compra marcada como pendiente")}catch(nt){console.error(nt),re(" No se pudo actualizar el estado de la compra")}finally{Ne(null)}},ir=g.useMemo(()=>[...Q].sort((fe,et)=>{var nt,ct;return fe.status!==et.status?fe.status==="BLOQUEADO"?1:-1:(((nt=et.createdAt)==null?void 0:nt.seconds)||0)-(((ct=fe.createdAt)==null?void 0:ct.seconds)||0)}),[Q]),br=fe=>fe==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700",wr=g.useMemo(()=>{const fe=A.trim().toLowerCase(),et=x.trim()===""?null:Number(x),nt=y.trim()===""?null:Number(y);return ir.filter(ct=>{const ve=!fe||String(ct.name||"").toLowerCase().includes(fe),ft=!m||ct.status===m,St=Number(ct.balance||0),wt=et===null||!Number.isNaN(et)&&St>=et,yt=nt===null||!Number.isNaN(nt)&&St<=nt;return ve&&ft&&wt&&yt})},[ir,A,m,x,y]),Xr=g.useMemo(()=>wr.reduce((fe,et)=>fe+Number(et.balance||0),0),[wr]),Ir=g.useMemo(()=>wr.filter(fe=>fe.status==="ACTIVO").length,[wr]),Pr=wr.length,fn=()=>{h(""),p(""),v(""),b("")};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Pollo)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{Ke(!0),o&&W(s)},type:"button",children:"Crear Cliente"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[i.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[i.jsx("div",{className:"text-xs uppercase tracking-wide text-gray-600",children:"Saldo pendiente"}),i.jsx("div",{className:"text-2xl font-semibold",children:qc(Xr)}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Calculado sobre los clientes filtrados"})]}),i.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[i.jsx("div",{className:"text-xs uppercase tracking-wide text-gray-600",children:"Clientes activos"}),i.jsx("div",{className:"text-2xl font-semibold",children:Ir}),i.jsxs("p",{className:"text-[11px] text-gray-500 mt-1",children:["De un total de ",Pr]})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm p-4 mb-4",children:[i.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Filtrar cliente"}),i.jsx("input",{className:"w-full border rounded px-3 py-2",placeholder:"Nombre, telfono o nota",value:A,onChange:fe=>h(fe.target.value)})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded border bg-gray-50 hover:bg-gray-100",onClick:()=>f(fe=>!fe),children:d?"Ocultar filtros":"Ms filtros"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded border bg-white hover:bg-gray-50",onClick:fn,children:"Limpiar"})]})]}),d&&i.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border rounded px-3 py-2",value:m,onChange:fe=>p(fe.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"ACTIVO",children:"Activo"}),i.jsx("option",{value:"BLOQUEADO",children:"Bloqueado"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Saldo mnimo"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-3 py-2",value:x,onChange:fe=>v(fe.target.value),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Saldo mximo"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-3 py-2",value:y,onChange:fe=>b(fe.target.value),placeholder:"0.00"})]})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:be?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):wr.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):wr.map(fe=>{var nt;const et=J===fe.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(nt=fe.createdAt)!=null&&nt.toDate?fe.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:et?i.jsx("input",{className:"w-full border p-1 rounded",value:ke,onChange:ct=>Be(ct.target.value)}):i.jsx("div",{className:"font-medium",children:fe.name})}),i.jsx("td",{className:"p-2 border",children:et?i.jsx("input",{className:"w-full border p-1 rounded",value:Ye,onChange:ct=>ot(i_(ct.target.value))}):fe.phone}),i.jsx("td",{className:"p-2 border",children:et?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:o?s:Je,onChange:ct=>dt(ct.target.value),disabled:o,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(ct=>i.jsx("option",{value:ct.id,children:ct.name},ct.id))]}):fe.vendorName||""}),i.jsx("td",{className:"p-2 border",children:et?i.jsxs("select",{className:"w-full border p-1 rounded",value:Ct,onChange:ct=>jt(ct.target.value),children:[i.jsx("option",{value:"",children:""}),_$.map(ct=>i.jsx("option",{value:ct,children:ct},ct))]}):fe.place||""}),i.jsx("td",{className:"p-2 border",children:et?i.jsxs("select",{className:"w-full border p-1 rounded",value:Qt,onChange:ct=>Ft(ct.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${br(fe.status)}`,children:fe.status})}),i.jsx("td",{className:"p-2 border",children:et?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Qe)?"":Qe,onChange:ct=>De(Math.max(0,Number(ct.target.value||0)))}):qc(fe.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:qc(fe.balance||0)}),i.jsx("td",{className:"p-2 border",children:et?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Ot,onChange:ct=>Tt(ct.target.value),maxLength:500}):i.jsx("span",{title:fe.notes||"",children:(fe.notes||"").length>40?(fe.notes||"").slice(0,40)+"":fe.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:et?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:_r,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:nr,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Rt(fe),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>$r(fe),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>kr(fe),children:"Estado de cuenta"})]})})})]},fe.id)})})]})}),i.jsx("div",{className:"md:hidden space-y-2",children:be?i.jsx("div",{className:"p-4 text-center text-sm text-gray-600",children:"Cargando"}):wr.length===0?i.jsx("div",{className:"p-4 text-center text-sm text-gray-600",children:"Sin clientes"}):wr.map(fe=>i.jsxs("div",{className:"border rounded-lg bg-white p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-base",children:fe.name}),i.jsx("div",{className:"text-xs text-gray-600",children:fe.phone||""}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Vendedor:"," ",i.jsx("span",{className:"font-medium",children:fe.vendorName||""})]})]}),i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${br(fe.status)}`,children:fe.status})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Saldo"}),i.jsx("div",{className:"font-semibold",children:qc(fe.balance||0)})]}),i.jsxs("div",{className:"border rounded p-2 bg-gray-50",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Lmite"}),i.jsx("div",{className:"font-semibold",children:qc(fe.creditLimit||0)})]})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["ltimo abono:"," ",i.jsx("span",{className:"font-medium",children:fe.lastAbonoDate?`${fe.lastAbonoDate} (${qc(fe.lastAbonoAmount||0)})`:""})]}),fe.notes?i.jsxs("div",{className:"mt-2 text-xs text-gray-700",children:[i.jsx("span",{className:"font-semibold",children:"Nota:"})," ",(fe.notes||"").length>80?(fe.notes||"").slice(0,80)+"":fe.notes]}):null,i.jsxs("div",{className:"mt-3 flex gap-2 flex-wrap",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white text-sm",onClick:()=>kr(fe),children:"Estado de cuenta"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-yellow-600 text-white text-sm",onClick:()=>Rt(fe),disabled:o,title:o?"Vendedor no edita":"Editar",children:"Editar"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-red-600 text-white text-sm disabled:opacity-50",onClick:()=>$r(fe),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"})]})]},fe.id))})]}),ze&&i.jsx("p",{className:"mt-2 text-sm",children:ze}),Me&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Ke(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ke(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Nt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:P,onChange:fe=>K(fe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:le,onChange:fe=>oe(i_(fe.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ie,onChange:fe=>Ae(fe.target.value),children:[i.jsx("option",{value:"",children:""}),_$.map(fe=>i.jsx("option",{value:fe,children:fe},fe))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Ue,onChange:fe=>O(fe.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o?s:L,onChange:fe=>W(fe.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(fe=>i.jsx("option",{value:fe.id,children:fe.name},fe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:X===0?"":X,onChange:fe=>D(Math.max(0,Number(fe.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor cuenta como saldo desde el inicio."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:H===0?"":H,onChange:fe=>G(Math.max(0,Number(fe.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:te,onChange:fe=>Te(fe.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[te.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ke(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),ce&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[50]",style:{zIndex:50},children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>we(!1)}),i.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-full max-w-5xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 gap-3",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(ue==null?void 0:ue.name)||""]}),i.jsxs("div",{className:"flex gap-2 shrink-0",children:[i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{xt(0),It(new Date().toISOString().slice(0,10)),$t(""),ge(!0)},children:"Abonar"}),i.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>we(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:qc(Number((ue==null?void 0:ue.initialDebt)||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:qc(Ee.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:qc(Ee.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:qc(Ee.saldoRestante)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Estado compra"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:Ve?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):vt.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):vt.map(fe=>{var ct;const et=pe===fe.id,nt=yy(fe.debtStatus);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:et?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:he,onChange:ve=>ee(ve.target.value)}):fe.date||""}),i.jsx("td",{className:"p-2 border",children:fe.amount>=0?(ct=fe.ref)!=null&&ct.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",onClick:()=>T(fe.ref.saleId),children:"COMPRA (Ver detalle)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (Ver detalle)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:fe.type==="CARGO"?i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${nt==="PAGADA"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:nt==="PAGADA"?"Pagada":"Pendiente"}):""}),i.jsx("td",{className:"p-2 border",children:et?i.jsx("input",{className:"w-full border p-1 rounded",value:V,onChange:ve=>q(ve.target.value)}):i.jsx("span",{title:fe.comment||"",children:(fe.comment||"").length>40?(fe.comment||"").slice(0,40)+"":fe.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:et?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(_e)?"":_e,onChange:ve=>R(Number(ve.target.value||0))}):qc(fe.amount)}),i.jsx("td",{className:"p-2 border",children:et?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:er,children:"Guardar"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:gt,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Se(fe),children:"Editar"}),fe.type==="CARGO"&&i.jsx("button",{type:"button",className:`px-2 py-1 rounded text-white ${nt==="PAGADA"?"bg-gray-600 hover:bg-gray-700":"bg-emerald-600 hover:bg-emerald-700"} disabled:opacity-50`,onClick:()=>Or(fe),disabled:se===fe.id,children:nt==="PAGADA"?"Marcar pendiente":"Marcar pagada"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Mr(fe),children:"Borrar"})]})})]},fe.id)})})]})})]})}),w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",style:{zIndex:60},children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos vendidos"," "]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>j(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:I?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):B.map((fe,et)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:fe.productName}),i.jsx("td",{className:"p-2 border text-right",children:fe.qty}),i.jsx("td",{className:"p-2 border text-right",children:qc(fe.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:qc(fe.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:qc(fe.total)})]},et))})]})})]})})]}),document.body),We&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[90]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(ue==null?void 0:ue.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:Pt,onChange:fe=>It(fe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Ie===0?"":Ie,onChange:fe=>{const et=Number(fe.target.value||0),nt=Number.isFinite(et)?Math.max(0,parseFloat(et.toFixed(2))):0;xt(nt)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se registrar como ABONO (negativo) con 2 decimales."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Ut,onChange:fe=>$t(fe.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[Ut.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ge(!1),disabled:Le,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:Er,disabled:Le,children:Le?"Guardando...":"Guardar abono"})]})]})})]})}function BLe(t,e){var r=Object.setPrototypeOf;r?r(t,e):t.__proto__=e}function kLe(t,e){e===void 0&&(e=t.constructor);var r=Error.captureStackTrace;r&&r(t,e)}var FLe=function(){var t=function(r,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,s){a.__proto__=s}||function(a,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(a[o]=s[o])},t(r,n)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),OLe=function(t){FLe(e,t);function e(r,n){var a=this.constructor,s=t.call(this,r,n)||this;return Object.defineProperty(s,"name",{value:a.name,enumerable:!1,configurable:!0}),BLe(s,a.prototype),kLe(s),s}return e}(Error),DLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),du=function(t){DLe(e,t);function e(r){r===void 0&&(r=void 0);var n=t.call(this,r)||this;return n.message=r,n}return e.prototype.getKind=function(){var r=this.constructor;return r.kind},e.kind="Exception",e}(OLe),RLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Vi=function(t){RLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ArgumentException",e}(du),MLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Pn=function(t){MLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IllegalArgumentException",e}(du),wse=function(){function t(e){if(this.binarizer=e,e===null)throw new Pn("Binarizer must be non-null.")}return t.prototype.getWidth=function(){return this.binarizer.getWidth()},t.prototype.getHeight=function(){return this.binarizer.getHeight()},t.prototype.getBlackRow=function(e,r){return this.binarizer.getBlackRow(e,r)},t.prototype.getBlackMatrix=function(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},t.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},t.prototype.crop=function(e,r,n,a){var s=this.binarizer.getLuminanceSource().crop(e,r,n,a);return new t(this.binarizer.createBinarizer(s))},t.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},t.prototype.rotateCounterClockwise=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new t(this.binarizer.createBinarizer(e))},t.prototype.rotateCounterClockwise45=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new t(this.binarizer.createBinarizer(e))},t.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return""}},t}(),LLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lo=function(t){LLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getChecksumInstance=function(){return new e},e.kind="ChecksumException",e}(du),ULe=function(){function t(e){this.source=e}return t.prototype.getLuminanceSource=function(){return this.source},t.prototype.getWidth=function(){return this.source.getWidth()},t.prototype.getHeight=function(){return this.source.getHeight()},t}(),ws=function(){function t(){}return t.arraycopy=function(e,r,n,a,s){for(;s--;)n[a++]=e[r++]},t.currentTimeMillis=function(){return Date.now()},t}(),QLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),MR=function(t){QLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IndexOutOfBoundsException",e}(du),VLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),S$=function(t){VLe(e,t);function e(r,n){r===void 0&&(r=void 0),n===void 0&&(n=void 0);var a=t.call(this,n)||this;return a.index=r,a.message=n,a}return e.kind="ArrayIndexOutOfBoundsException",e}(MR),HLe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Bo=function(){function t(){}return t.fill=function(e,r){for(var n=0,a=e.length;n<a;n++)e[n]=r},t.fillWithin=function(e,r,n,a){t.rangeCheck(e.length,r,n);for(var s=r;s<n;s++)e[s]=a},t.rangeCheck=function(e,r,n){if(r>n)throw new Pn("fromIndex("+r+") > toIndex("+n+")");if(r<0)throw new S$(r);if(n>e)throw new S$(n)},t.asList=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e},t.create=function(e,r,n){var a=Array.from({length:e});return a.map(function(s){return Array.from({length:r}).fill(n)})},t.createInt32Array=function(e,r,n){var a=Array.from({length:e});return a.map(function(s){return Int32Array.from({length:r}).fill(n)})},t.equals=function(e,r){if(!e||!r||!e.length||!r.length||e.length!==r.length)return!1;for(var n=0,a=e.length;n<a;n++)if(e[n]!==r[n])return!1;return!0},t.hashCode=function(e){var r,n;if(e===null)return 0;var a=1;try{for(var s=HLe(e),o=s.next();!o.done;o=s.next()){var l=o.value;a=31*a+l}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},t.fillUint8Array=function(e,r){for(var n=0;n!==e.length;n++)e[n]=r},t.copyOf=function(e,r){return e.slice(0,r)},t.copyOfUint8Array=function(e,r){if(e.length<=r){var n=new Uint8Array(r);return n.set(e),n}return e.slice(0,r)},t.copyOfRange=function(e,r,n){var a=n-r,s=new Int32Array(a);return ws.arraycopy(e,r,s,0,a),s},t.binarySearch=function(e,r,n){n===void 0&&(n=t.numberComparator);for(var a=0,s=e.length-1;a<=s;){var o=s+a>>1,l=n(r,e[o]);if(l>0)a=o+1;else if(l<0)s=o-1;else return o}return-a-1},t.numberComparator=function(e,r){return e-r},t}(),sa=function(){function t(){}return t.numberOfTrailingZeros=function(e){var r;if(e===0)return 32;var n=31;return r=e<<16,r!==0&&(n-=16,e=r),r=e<<8,r!==0&&(n-=8,e=r),r=e<<4,r!==0&&(n-=4,e=r),r=e<<2,r!==0&&(n-=2,e=r),n-(e<<1>>>31)},t.numberOfLeadingZeros=function(e){if(e===0)return 32;var r=1;return e>>>16||(r+=16,e<<=16),e>>>24||(r+=8,e<<=8),e>>>28||(r+=4,e<<=4),e>>>30||(r+=2,e<<=2),r-=e>>>31,r},t.toHexString=function(e){return e.toString(16)},t.toBinaryString=function(e){return String(parseInt(String(e),2))},t.bitCount=function(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63},t.truncDivision=function(e,r){return Math.trunc(e/r)},t.parseInt=function(e,r){return r===void 0&&(r=void 0),parseInt(e,r)},t.MIN_VALUE_32_BITS=-2147483648,t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t}(),tl=function(){function t(e,r){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,r==null?this.bits=t.makeArray(e):this.bits=r)}return t.prototype.getSize=function(){return this.size},t.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},t.prototype.ensureCapacity=function(e){if(e>this.bits.length*32){var r=t.makeArray(e);ws.arraycopy(this.bits,0,r,0,this.bits.length),this.bits=r}},t.prototype.get=function(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0},t.prototype.set=function(e){this.bits[Math.floor(e/32)]|=1<<(e&31)},t.prototype.flip=function(e){this.bits[Math.floor(e/32)]^=1<<(e&31)},t.prototype.getNextSet=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,a=Math.floor(e/32),s=n[a];s&=~((1<<(e&31))-1);for(var o=n.length;s===0;){if(++a===o)return r;s=n[a]}var l=a*32+sa.numberOfTrailingZeros(s);return l>r?r:l},t.prototype.getNextUnset=function(e){var r=this.size;if(e>=r)return r;var n=this.bits,a=Math.floor(e/32),s=~n[a];s&=~((1<<(e&31))-1);for(var o=n.length;s===0;){if(++a===o)return r;s=~n[a]}var l=a*32+sa.numberOfTrailingZeros(s);return l>r?r:l},t.prototype.setBulk=function(e,r){this.bits[Math.floor(e/32)]=r},t.prototype.setRange=function(e,r){if(r<e||e<0||r>this.size)throw new Pn;if(r!==e){r--;for(var n=Math.floor(e/32),a=Math.floor(r/32),s=this.bits,o=n;o<=a;o++){var l=o>n?0:e&31,c=o<a?31:r&31,u=(2<<c)-(1<<l);s[o]|=u}}},t.prototype.clear=function(){for(var e=this.bits.length,r=this.bits,n=0;n<e;n++)r[n]=0},t.prototype.isRange=function(e,r,n){if(r<e||e<0||r>this.size)throw new Pn;if(r===e)return!0;r--;for(var a=Math.floor(e/32),s=Math.floor(r/32),o=this.bits,l=a;l<=s;l++){var c=l>a?0:e&31,u=l<s?31:r&31,d=(2<<u)-(1<<c)&4294967295;if((o[l]&d)!==(n?d:0))return!1}return!0},t.prototype.appendBit=function(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++},t.prototype.appendBits=function(e,r){if(r<0||r>32)throw new Pn("Num bits must be between 0 and 32");this.ensureCapacity(this.size+r);for(var n=r;n>0;n--)this.appendBit((e>>n-1&1)===1)},t.prototype.appendBitArray=function(e){var r=e.size;this.ensureCapacity(this.size+r);for(var n=0;n<r;n++)this.appendBit(e.get(n))},t.prototype.xor=function(e){if(this.size!==e.size)throw new Pn("Sizes don't match");for(var r=this.bits,n=0,a=r.length;n<a;n++)r[n]^=e.bits[n]},t.prototype.toBytes=function(e,r,n,a){for(var s=0;s<a;s++){for(var o=0,l=0;l<8;l++)this.get(e)&&(o|=1<<7-l),e++;r[n+s]=o}},t.prototype.getBitArray=function(){return this.bits},t.prototype.reverse=function(){for(var e=new Int32Array(this.bits.length),r=Math.floor((this.size-1)/32),n=r+1,a=this.bits,s=0;s<n;s++){var o=a[s];o=o>>1&1431655765|(o&1431655765)<<1,o=o>>2&858993459|(o&858993459)<<2,o=o>>4&252645135|(o&252645135)<<4,o=o>>8&16711935|(o&16711935)<<8,o=o>>16&65535|(o&65535)<<16,e[r-s]=o}if(this.size!==n*32){for(var l=n*32-this.size,c=e[0]>>>l,s=1;s<n;s++){var u=e[s];c|=u<<32-l,e[s-1]=c,c=u>>>l}e[n-1]=c}this.bits=e},t.makeArray=function(e){return new Int32Array(Math.floor((e+31)/32))},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.size===r.size&&Bo.equals(this.bits,r.bits)},t.prototype.hashCode=function(){return 31*this.size+Bo.hashCode(this.bits)},t.prototype.toString=function(){for(var e="",r=0,n=this.size;r<n;r++)r&7||(e+=" "),e+=this.get(r)?"X":".";return e},t.prototype.clone=function(){return new t(this.size,this.bits.slice())},t.prototype.toArray=function(){for(var e=[],r=0,n=this.size;r<n;r++)e.push(this.get(r));return e},t}(),uF;(function(t){t[t.OTHER=0]="OTHER",t[t.PURE_BARCODE=1]="PURE_BARCODE",t[t.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",t[t.TRY_HARDER=3]="TRY_HARDER",t[t.CHARACTER_SET=4]="CHARACTER_SET",t[t.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",t[t.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",t[t.ENABLE_CODE_39_EXTENDED_MODE=7]="ENABLE_CODE_39_EXTENDED_MODE",t[t.ASSUME_GS1=8]="ASSUME_GS1",t[t.RETURN_CODABAR_START_END=9]="RETURN_CODABAR_START_END",t[t.NEED_RESULT_POINT_CALLBACK=10]="NEED_RESULT_POINT_CALLBACK",t[t.ALLOWED_EAN_EXTENSIONS=11]="ALLOWED_EAN_EXTENSIONS"})(uF||(uF={}));const Ns=uF;var $Le=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),qr=function(t){$Le(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getFormatInstance=function(){return new e},e.kind="FormatException",e}(du),GLe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},qa;(function(t){t[t.Cp437=0]="Cp437",t[t.ISO8859_1=1]="ISO8859_1",t[t.ISO8859_2=2]="ISO8859_2",t[t.ISO8859_3=3]="ISO8859_3",t[t.ISO8859_4=4]="ISO8859_4",t[t.ISO8859_5=5]="ISO8859_5",t[t.ISO8859_6=6]="ISO8859_6",t[t.ISO8859_7=7]="ISO8859_7",t[t.ISO8859_8=8]="ISO8859_8",t[t.ISO8859_9=9]="ISO8859_9",t[t.ISO8859_10=10]="ISO8859_10",t[t.ISO8859_11=11]="ISO8859_11",t[t.ISO8859_13=12]="ISO8859_13",t[t.ISO8859_14=13]="ISO8859_14",t[t.ISO8859_15=14]="ISO8859_15",t[t.ISO8859_16=15]="ISO8859_16",t[t.SJIS=16]="SJIS",t[t.Cp1250=17]="Cp1250",t[t.Cp1251=18]="Cp1251",t[t.Cp1252=19]="Cp1252",t[t.Cp1256=20]="Cp1256",t[t.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",t[t.UTF8=22]="UTF8",t[t.ASCII=23]="ASCII",t[t.Big5=24]="Big5",t[t.GB18030=25]="GB18030",t[t.EUC_KR=26]="EUC_KR"})(qa||(qa={}));var Po=function(){function t(e,r,n){for(var a,s,o=[],l=3;l<arguments.length;l++)o[l-3]=arguments[l];this.valueIdentifier=e,this.name=n,typeof r=="number"?this.values=Int32Array.from([r]):this.values=r,this.otherEncodingNames=o,t.VALUE_IDENTIFIER_TO_ECI.set(e,this),t.NAME_TO_ECI.set(n,this);for(var c=this.values,u=0,d=c.length;u!==d;u++){var f=c[u];t.VALUES_TO_ECI.set(f,this)}try{for(var A=GLe(o),h=A.next();!h.done;h=A.next()){var m=h.value;t.NAME_TO_ECI.set(m,this)}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}}return t.prototype.getValueIdentifier=function(){return this.valueIdentifier},t.prototype.getName=function(){return this.name},t.prototype.getValue=function(){return this.values[0]},t.getCharacterSetECIByValue=function(e){if(e<0||e>=900)throw new qr("incorect value");var r=t.VALUES_TO_ECI.get(e);if(r===void 0)throw new qr("incorect value");return r},t.getCharacterSetECIByName=function(e){var r=t.NAME_TO_ECI.get(e);if(r===void 0)throw new qr("incorect value");return r},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.getName()===r.getName()},t.VALUE_IDENTIFIER_TO_ECI=new Map,t.VALUES_TO_ECI=new Map,t.NAME_TO_ECI=new Map,t.Cp437=new t(qa.Cp437,Int32Array.from([0,2]),"Cp437"),t.ISO8859_1=new t(qa.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),t.ISO8859_2=new t(qa.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),t.ISO8859_3=new t(qa.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),t.ISO8859_4=new t(qa.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),t.ISO8859_5=new t(qa.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),t.ISO8859_6=new t(qa.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),t.ISO8859_7=new t(qa.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),t.ISO8859_8=new t(qa.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),t.ISO8859_9=new t(qa.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),t.ISO8859_10=new t(qa.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),t.ISO8859_11=new t(qa.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),t.ISO8859_13=new t(qa.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),t.ISO8859_14=new t(qa.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),t.ISO8859_15=new t(qa.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),t.ISO8859_16=new t(qa.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),t.SJIS=new t(qa.SJIS,20,"SJIS","Shift_JIS"),t.Cp1250=new t(qa.Cp1250,21,"Cp1250","windows-1250"),t.Cp1251=new t(qa.Cp1251,22,"Cp1251","windows-1251"),t.Cp1252=new t(qa.Cp1252,23,"Cp1252","windows-1252"),t.Cp1256=new t(qa.Cp1256,24,"Cp1256","windows-1256"),t.UnicodeBigUnmarked=new t(qa.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),t.UTF8=new t(qa.UTF8,26,"UTF8","UTF-8"),t.ASCII=new t(qa.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),t.Big5=new t(qa.Big5,28,"Big5"),t.GB18030=new t(qa.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),t.EUC_KR=new t(qa.EUC_KR,30,"EUC_KR","EUC-KR"),t}(),KLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vE=function(t){KLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="UnsupportedOperationException",e}(du),Bd=function(){function t(){}return t.decode=function(e,r){var n=this.encodingName(r);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)},t.shouldDecodeOnFallback=function(e){return!t.isBrowser()&&e==="ISO-8859-1"},t.encode=function(e,r){var n=this.encodingName(r);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)},t.isBrowser=function(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"},t.encodingName=function(e){return typeof e=="string"?e:e.getName()},t.encodingCharacterSet=function(e){return e instanceof Po?e:Po.getCharacterSetECIByName(e)},t.decodeFallback=function(e,r){var n=this.encodingCharacterSet(r);if(t.isDecodeFallbackSupported(n)){for(var a="",s=0,o=e.length;s<o;s++){var l=e[s].toString(16);l.length<2&&(l="0"+l),a+="%"+l}return decodeURIComponent(a)}if(n.equals(Po.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new vE("Encoding "+this.encodingName(r)+" not supported by fallback.")},t.isDecodeFallbackSupported=function(e){return e.equals(Po.UTF8)||e.equals(Po.ISO8859_1)||e.equals(Po.ASCII)},t.encodeFallback=function(e){for(var r=btoa(unescape(encodeURIComponent(e))),n=r.split(""),a=[],s=0;s<n.length;s++)a.push(n[s].charCodeAt(0));return new Uint8Array(a)},t}(),ba=function(){function t(){}return t.castAsNonUtf8Char=function(e,r){r===void 0&&(r=null);var n=r?r.getName():this.ISO88591;return Bd.decode(new Uint8Array([e]),n)},t.guessEncoding=function(e,r){if(r!=null&&r.get(Ns.CHARACTER_SET)!==void 0)return r.get(Ns.CHARACTER_SET).toString();for(var n=e.length,a=!0,s=!0,o=!0,l=0,c=0,u=0,d=0,f=0,A=0,h=0,m=0,p=0,x=0,v=0,y=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191,b=0;b<n&&(a||s||o);b++){var w=e[b]&255;o&&(l>0?w&128?l--:o=!1:w&128&&(w&64?(l++,w&32?(l++,w&16?(l++,w&8?o=!1:d++):u++):c++):o=!1)),a&&(w>127&&w<160?a=!1:w>159&&(w<192||w===215||w===247)&&v++),s&&(f>0?w<64||w===127||w>252?s=!1:f--:w===128||w===160||w>239?s=!1:w>160&&w<224?(A++,m=0,h++,h>p&&(p=h)):w>127?(f++,h=0,m++,m>x&&(x=m)):(h=0,m=0))}return o&&l>0&&(o=!1),s&&f>0&&(s=!1),o&&(y||c+u+d>0)?t.UTF8:s&&(t.ASSUME_SHIFT_JIS||p>=3||x>=3)?t.SHIFT_JIS:a&&s?p===2&&A===2||v*10>=n?t.SHIFT_JIS:t.ISO88591:a?t.ISO88591:s?t.SHIFT_JIS:o?t.UTF8:t.PLATFORM_DEFAULT_ENCODING},t.format=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a=-1;function s(l,c,u,d,f,A){if(l==="%%")return"%";if(r[++a]!==void 0){l=d?parseInt(d.substr(1)):void 0;var h=f?parseInt(f.substr(1)):void 0,m;switch(A){case"s":m=r[a];break;case"c":m=r[a][0];break;case"f":m=parseFloat(r[a]).toFixed(l);break;case"p":m=parseFloat(r[a]).toPrecision(l);break;case"e":m=parseFloat(r[a]).toExponential(l);break;case"x":m=parseInt(r[a]).toString(h||16);break;case"d":m=parseFloat(parseInt(r[a],h||10).toPrecision(l)).toFixed(0);break}m=typeof m=="object"?JSON.stringify(m):(+m).toString(h);for(var p=parseInt(u),x=u&&u[0]+""=="0"?"0":" ";m.length<p;)m=c!==void 0?m+x:x+m;return m}}var o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(o,s)},t.getBytes=function(e,r){return Bd.encode(e,r)},t.getCharCode=function(e,r){return r===void 0&&(r=0),e.charCodeAt(r)},t.getCharAt=function(e){return String.fromCharCode(e)},t.SHIFT_JIS=Po.SJIS.getName(),t.GB2312="GB2312",t.ISO88591=Po.ISO8859_1.getName(),t.EUC_JP="EUC_JP",t.UTF8=Po.UTF8.getName(),t.PLATFORM_DEFAULT_ENCODING=t.UTF8,t.ASSUME_SHIFT_JIS=!1,t}(),ta=function(){function t(e){e===void 0&&(e=""),this.value=e}return t.prototype.enableDecoding=function(e){return this.encoding=e,this},t.prototype.append=function(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=ba.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this},t.prototype.appendChars=function(e,r,n){for(var a=r;r<r+n;a++)this.append(e[a]);return this},t.prototype.length=function(){return this.value.length},t.prototype.charAt=function(e){return this.value.charAt(e)},t.prototype.deleteCharAt=function(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)},t.prototype.setCharAt=function(e,r){this.value=this.value.substr(0,e)+r+this.value.substr(e+1)},t.prototype.substring=function(e,r){return this.value.substring(e,r)},t.prototype.setLengthToZero=function(){this.value=""},t.prototype.toString=function(){return this.value},t.prototype.insert=function(e,r){this.value=this.value.substring(0,e)+r+this.value.substring(e)},t}(),ch=function(){function t(e,r,n,a){if(this.width=e,this.height=r,this.rowSize=n,this.bits=a,r==null&&(r=e),this.height=r,e<1||r<1)throw new Pn("Both dimensions must be greater than 0");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,a==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return t.parseFromBooleanArray=function(e){for(var r=e.length,n=e[0].length,a=new t(n,r),s=0;s<r;s++)for(var o=e[s],l=0;l<n;l++)o[l]&&a.set(l,s);return a},t.parseFromString=function(e,r,n){if(e===null)throw new Pn("stringRepresentation cannot be null");for(var a=new Array(e.length),s=0,o=0,l=-1,c=0,u=0;u<e.length;)if(e.charAt(u)===`
`||e.charAt(u)==="\r"){if(s>o){if(l===-1)l=s-o;else if(s-o!==l)throw new Pn("row lengths do not match");o=s,c++}u++}else if(e.substring(u,u+r.length)===r)u+=r.length,a[s]=!0,s++;else if(e.substring(u,u+n.length)===n)u+=n.length,a[s]=!1,s++;else throw new Pn("illegal character encountered: "+e.substring(u));if(s>o){if(l===-1)l=s-o;else if(s-o!==l)throw new Pn("row lengths do not match");c++}for(var d=new t(l,c),f=0;f<s;f++)a[f]&&d.set(Math.floor(f%l),Math.floor(f/l));return d},t.prototype.get=function(e,r){var n=r*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0},t.prototype.set=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295},t.prototype.unset=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)},t.prototype.flip=function(e,r){var n=r*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295},t.prototype.xor=function(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new Pn("input matrix dimensions do not match");for(var r=new tl(Math.floor(this.width/32)+1),n=this.rowSize,a=this.bits,s=0,o=this.height;s<o;s++)for(var l=s*n,c=e.getRow(s,r).getBitArray(),u=0;u<n;u++)a[l+u]^=c[u]},t.prototype.clear=function(){for(var e=this.bits,r=e.length,n=0;n<r;n++)e[n]=0},t.prototype.setRegion=function(e,r,n,a){if(r<0||e<0)throw new Pn("Left and top must be nonnegative");if(a<1||n<1)throw new Pn("Height and width must be at least 1");var s=e+n,o=r+a;if(o>this.height||s>this.width)throw new Pn("The region must fit inside the matrix");for(var l=this.rowSize,c=this.bits,u=r;u<o;u++)for(var d=u*l,f=e;f<s;f++)c[d+Math.floor(f/32)]|=1<<(f&31)&4294967295},t.prototype.getRow=function(e,r){r==null||r.getSize()<this.width?r=new tl(this.width):r.clear();for(var n=this.rowSize,a=this.bits,s=e*n,o=0;o<n;o++)r.setBulk(o*32,a[s+o]);return r},t.prototype.setRow=function(e,r){ws.arraycopy(r.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)},t.prototype.rotate180=function(){for(var e=this.getWidth(),r=this.getHeight(),n=new tl(e),a=new tl(e),s=0,o=Math.floor((r+1)/2);s<o;s++)n=this.getRow(s,n),a=this.getRow(r-1-s,a),n.reverse(),a.reverse(),this.setRow(s,a),this.setRow(r-1-s,n)},t.prototype.getEnclosingRectangle=function(){for(var e=this.width,r=this.height,n=this.rowSize,a=this.bits,s=e,o=r,l=-1,c=-1,u=0;u<r;u++)for(var d=0;d<n;d++){var f=a[u*n+d];if(f!==0){if(u<o&&(o=u),u>c&&(c=u),d*32<s){for(var A=0;!(f<<31-A&4294967295);)A++;d*32+A<s&&(s=d*32+A)}if(d*32+31>l){for(var A=31;!(f>>>A);)A--;d*32+A>l&&(l=d*32+A)}}}return l<s||c<o?null:Int32Array.from([s,o,l-s+1,c-o+1])},t.prototype.getTopLeftOnBit=function(){for(var e=this.rowSize,r=this.bits,n=0;n<r.length&&r[n]===0;)n++;if(n===r.length)return null;for(var a=n/e,s=n%e*32,o=r[n],l=0;!(o<<31-l&4294967295);)l++;return s+=l,Int32Array.from([s,a])},t.prototype.getBottomRightOnBit=function(){for(var e=this.rowSize,r=this.bits,n=r.length-1;n>=0&&r[n]===0;)n--;if(n<0)return null;for(var a=Math.floor(n/e),s=Math.floor(n%e)*32,o=r[n],l=31;!(o>>>l);)l--;return s+=l,Int32Array.from([s,a])},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getRowSize=function(){return this.rowSize},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.width===r.width&&this.height===r.height&&this.rowSize===r.rowSize&&Bo.equals(this.bits,r.bits)},t.prototype.hashCode=function(){var e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+Bo.hashCode(this.bits),e},t.prototype.toString=function(e,r,n){return e===void 0&&(e="X "),r===void 0&&(r="  "),n===void 0&&(n=`
`),this.buildToString(e,r,n)},t.prototype.buildToString=function(e,r,n){for(var a=new ta,s=0,o=this.height;s<o;s++){for(var l=0,c=this.width;l<c;l++)a.append(this.get(l,s)?e:r);a.append(n)}return a.toString()},t.prototype.clone=function(){return new t(this.width,this.height,this.rowSize,this.bits.slice())},t}(),qLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lr=function(t){qLe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.getNotFoundInstance=function(){return new e},e.kind="NotFoundException",e}(du),zLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),WLe=function(t){zLe(e,t);function e(r){var n=t.call(this,r)||this;return n.luminances=e.EMPTY,n.buckets=new Int32Array(e.LUMINANCE_BUCKETS),n}return e.prototype.getBlackRow=function(r,n){var a=this.getLuminanceSource(),s=a.getWidth();n==null||n.getSize()<s?n=new tl(s):n.clear(),this.initArrays(s);for(var o=a.getRow(r,this.luminances),l=this.buckets,c=0;c<s;c++)l[(o[c]&255)>>e.LUMINANCE_SHIFT]++;var u=e.estimateBlackPoint(l);if(s<3)for(var c=0;c<s;c++)(o[c]&255)<u&&n.set(c);else for(var d=o[0]&255,f=o[1]&255,c=1;c<s-1;c++){var A=o[c+1]&255;(f*4-d-A)/2<u&&n.set(c),d=f,f=A}return n},e.prototype.getBlackMatrix=function(){var r=this.getLuminanceSource(),n=r.getWidth(),a=r.getHeight(),s=new ch(n,a);this.initArrays(n);for(var o=this.buckets,l=1;l<5;l++)for(var c=Math.floor(a*l/5),u=r.getRow(c,this.luminances),d=Math.floor(n*4/5),f=Math.floor(n/5);f<d;f++){var A=u[f]&255;o[A>>e.LUMINANCE_SHIFT]++}for(var h=e.estimateBlackPoint(o),m=r.getMatrix(),l=0;l<a;l++)for(var p=l*n,f=0;f<n;f++){var A=m[p+f]&255;A<h&&s.set(f,l)}return s},e.prototype.createBinarizer=function(r){return new e(r)},e.prototype.initArrays=function(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));for(var n=this.buckets,a=0;a<e.LUMINANCE_BUCKETS;a++)n[a]=0},e.estimateBlackPoint=function(r){for(var n=r.length,a=0,s=0,o=0,l=0;l<n;l++)r[l]>o&&(s=l,o=r[l]),r[l]>a&&(a=r[l]);for(var c=0,u=0,l=0;l<n;l++){var d=l-s,f=r[l]*d*d;f>u&&(c=l,u=f)}if(s>c){var A=s;s=c,c=A}if(c-s<=n/16)throw new lr;for(var h=c-1,m=-1,l=c-1;l>s;l--){var p=l-s,f=p*p*(c-l)*(a-r[l]);f>m&&(h=l,m=f)}return h<<e.LUMINANCE_SHIFT},e.LUMINANCE_BITS=5,e.LUMINANCE_SHIFT=8-e.LUMINANCE_BITS,e.LUMINANCE_BUCKETS=1<<e.LUMINANCE_BITS,e.EMPTY=Uint8ClampedArray.from([0]),e}(ULe),XLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Nse=function(t){XLe(e,t);function e(r){var n=t.call(this,r)||this;return n.matrix=null,n}return e.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var r=this.getLuminanceSource(),n=r.getWidth(),a=r.getHeight();if(n>=e.MINIMUM_DIMENSION&&a>=e.MINIMUM_DIMENSION){var s=r.getMatrix(),o=n>>e.BLOCK_SIZE_POWER;n&e.BLOCK_SIZE_MASK&&o++;var l=a>>e.BLOCK_SIZE_POWER;a&e.BLOCK_SIZE_MASK&&l++;var c=e.calculateBlackPoints(s,o,l,n,a),u=new ch(n,a);e.calculateThresholdForBlock(s,o,l,n,a,c,u),this.matrix=u}else this.matrix=t.prototype.getBlackMatrix.call(this);return this.matrix},e.prototype.createBinarizer=function(r){return new e(r)},e.calculateThresholdForBlock=function(r,n,a,s,o,l,c){for(var u=o-e.BLOCK_SIZE,d=s-e.BLOCK_SIZE,f=0;f<a;f++){var A=f<<e.BLOCK_SIZE_POWER;A>u&&(A=u);for(var h=e.cap(f,2,a-3),m=0;m<n;m++){var p=m<<e.BLOCK_SIZE_POWER;p>d&&(p=d);for(var x=e.cap(m,2,n-3),v=0,y=-2;y<=2;y++){var b=l[h+y];v+=b[x-2]+b[x-1]+b[x]+b[x+1]+b[x+2]}var w=v/25;e.thresholdBlock(r,p,A,w,s,c)}}},e.cap=function(r,n,a){return r<n?n:r>a?a:r},e.thresholdBlock=function(r,n,a,s,o,l){for(var c=0,u=a*o+n;c<e.BLOCK_SIZE;c++,u+=o)for(var d=0;d<e.BLOCK_SIZE;d++)(r[u+d]&255)<=s&&l.set(n+d,a+c)},e.calculateBlackPoints=function(r,n,a,s,o){for(var l=o-e.BLOCK_SIZE,c=s-e.BLOCK_SIZE,u=new Array(a),d=0;d<a;d++){u[d]=new Int32Array(n);var f=d<<e.BLOCK_SIZE_POWER;f>l&&(f=l);for(var A=0;A<n;A++){var h=A<<e.BLOCK_SIZE_POWER;h>c&&(h=c);for(var m=0,p=255,x=0,v=0,y=f*s+h;v<e.BLOCK_SIZE;v++,y+=s){for(var b=0;b<e.BLOCK_SIZE;b++){var w=r[y+b]&255;m+=w,w<p&&(p=w),w>x&&(x=w)}if(x-p>e.MIN_DYNAMIC_RANGE)for(v++,y+=s;v<e.BLOCK_SIZE;v++,y+=s)for(var b=0;b<e.BLOCK_SIZE;b++)m+=r[y+b]&255}var j=m>>e.BLOCK_SIZE_POWER*2;if(x-p<=e.MIN_DYNAMIC_RANGE&&(j=p/2,d>0&&A>0)){var I=(u[d-1][A]+2*u[d][A-1]+u[d-1][A-1])/4;p<I&&(j=I)}u[d][A]=j}}return u},e.BLOCK_SIZE_POWER=3,e.BLOCK_SIZE=1<<e.BLOCK_SIZE_POWER,e.BLOCK_SIZE_MASK=e.BLOCK_SIZE-1,e.MINIMUM_DIMENSION=e.BLOCK_SIZE*5,e.MIN_DYNAMIC_RANGE=24,e}(WLe),qw=function(){function t(e,r){this.width=e,this.height=r}return t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.isCropSupported=function(){return!1},t.prototype.crop=function(e,r,n,a){throw new vE("This luminance source does not support cropping.")},t.prototype.isRotateSupported=function(){return!1},t.prototype.rotateCounterClockwise=function(){throw new vE("This luminance source does not support rotation by 90 degrees.")},t.prototype.rotateCounterClockwise45=function(){throw new vE("This luminance source does not support rotation by 45 degrees.")},t.prototype.toString=function(){for(var e=new Uint8ClampedArray(this.width),r=new ta,n=0;n<this.height;n++){for(var a=this.getRow(n,e),s=0;s<this.width;s++){var o=a[s]&255,l=void 0;o<64?l="#":o<128?l="+":o<192?l=".":l=" ",r.append(l)}r.append(`
`)}return r.toString()},t}(),YLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vP=function(t){YLe(e,t);function e(r){var n=t.call(this,r.getWidth(),r.getHeight())||this;return n.delegate=r,n}return e.prototype.getRow=function(r,n){for(var a=this.delegate.getRow(r,n),s=this.getWidth(),o=0;o<s;o++)a[o]=255-(a[o]&255);return a},e.prototype.getMatrix=function(){for(var r=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),a=new Uint8ClampedArray(n),s=0;s<n;s++)a[s]=255-(r[s]&255);return a},e.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},e.prototype.crop=function(r,n,a,s){return new e(this.delegate.crop(r,n,a,s))},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.invert=function(){return this.delegate},e.prototype.rotateCounterClockwise=function(){return new e(this.delegate.rotateCounterClockwise())},e.prototype.rotateCounterClockwise45=function(){return new e(this.delegate.rotateCounterClockwise45())},e}(qw),JLe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ZLe=function(t){JLe(e,t);function e(r,n){n===void 0&&(n=!1);var a=t.call(this,r.width,r.height)||this;return a.canvas=r,a.tempCanvasElement=null,a.buffer=e.makeBufferFromCanvasImageData(r,n),a}return e.makeBufferFromCanvasImageData=function(r,n){n===void 0&&(n=!1);var a=r.getContext("2d").getImageData(0,0,r.width,r.height);return e.toGrayscaleBuffer(a.data,r.width,r.height,n)},e.toGrayscaleBuffer=function(r,n,a,s){s===void 0&&(s=!1);var o=new Uint8ClampedArray(n*a);if(e.FRAME_INDEX=!e.FRAME_INDEX,e.FRAME_INDEX||!s)for(var l=0,c=0,u=r.length;l<u;l+=4,c++){var d=void 0,f=r[l+3];if(f===0)d=255;else{var A=r[l],h=r[l+1],m=r[l+2];d=306*A+601*h+117*m+512>>10}o[c]=d}else for(var l=0,c=0,p=r.length;l<p;l+=4,c++){var d=void 0,f=r[l+3];if(f===0)d=255;else{var A=r[l],h=r[l+1],m=r[l+2];d=306*A+601*h+117*m+512>>10}o[c]=255-d}return o},e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth(),s=r*a;return n===null?n=this.buffer.slice(s,s+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(s,s+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return t.prototype.crop.call(this,r,n,a,s),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement},e.prototype.rotate=function(r){var n=this.getTempCanvasElement(),a=n.getContext("2d"),s=r*e.DEGREE_TO_RADIANS,o=this.canvas.width,l=this.canvas.height,c=Math.ceil(Math.abs(Math.cos(s))*o+Math.abs(Math.sin(s))*l),u=Math.ceil(Math.abs(Math.sin(s))*o+Math.abs(Math.cos(s))*l);return n.width=c,n.height=u,a.translate(c/2,u/2),a.rotate(s),a.drawImage(this.canvas,o/-2,l/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.prototype.invert=function(){return new vP(this)},e.DEGREE_TO_RADIANS=Math.PI/180,e.FRAME_INDEX=!0,e}(qw),eUe=function(){function t(e,r,n){this.deviceId=e,this.label=r,this.kind="videoinput",this.groupId=n||void 0}return t.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}},t}(),pc=function(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})},gc=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},tUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},C1=function(){function t(e,r,n){r===void 0&&(r=500),this.reader=e,this.timeBetweenScansMillis=r,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}return Object.defineProperty(t.prototype,"hasNavigator",{get:function(){return typeof navigator<"u"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canEnumerateDevices",{get:function(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(e){this._timeBetweenDecodingAttempts=e<0?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hints",{get:function(){return this._hints},set:function(e){this._hints=e||null},enumerable:!1,configurable:!0}),t.prototype.listVideoInputDevices=function(){return pc(this,void 0,void 0,function(){var e,r,n,a,s,o,l,c,u,d,f,A;return gc(this,function(h){switch(h.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=h.sent(),r=[];try{for(n=tUe(e),a=n.next();!a.done;a=n.next())s=a.value,o=s.kind==="video"?"videoinput":s.kind,o==="videoinput"&&(l=s.deviceId||s.id,c=s.label||"Video device "+(r.length+1),u=s.groupId,d={deviceId:l,label:c,kind:o,groupId:u},r.push(d))}catch(m){f={error:m}}finally{try{a&&!a.done&&(A=n.return)&&A.call(n)}finally{if(f)throw f.error}}return[2,r]}})})},t.prototype.getVideoInputDevices=function(){return pc(this,void 0,void 0,function(){var e;return gc(this,function(r){switch(r.label){case 0:return[4,this.listVideoInputDevices()];case 1:return e=r.sent(),[2,e.map(function(n){return new eUe(n.deviceId,n.label)})]}})})},t.prototype.findDeviceById=function(e){return pc(this,void 0,void 0,function(){var r;return gc(this,function(n){switch(n.label){case 0:return[4,this.listVideoInputDevices()];case 1:return r=n.sent(),r?[2,r.find(function(a){return a.deviceId===e})]:[2,null]}})})},t.prototype.decodeFromInputVideoDevice=function(e,r){return pc(this,void 0,void 0,function(){return gc(this,function(n){switch(n.label){case 0:return[4,this.decodeOnceFromVideoDevice(e,r)];case 1:return[2,n.sent()]}})})},t.prototype.decodeOnceFromVideoDevice=function(e,r){return pc(this,void 0,void 0,function(){var n,a;return gc(this,function(s){switch(s.label){case 0:return this.reset(),e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,r)];case 1:return[2,s.sent()]}})})},t.prototype.decodeOnceFromConstraints=function(e,r){return pc(this,void 0,void 0,function(){var n;return gc(this,function(a){switch(a.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromStream=function(e,r){return pc(this,void 0,void 0,function(){var n,a;return gc(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,r)];case 1:return n=s.sent(),[4,this.decodeOnce(n)];case 2:return a=s.sent(),[2,a]}})})},t.prototype.decodeFromInputVideoDeviceContinuously=function(e,r,n){return pc(this,void 0,void 0,function(){return gc(this,function(a){switch(a.label){case 0:return[4,this.decodeFromVideoDevice(e,r,n)];case 1:return[2,a.sent()]}})})},t.prototype.decodeFromVideoDevice=function(e,r,n){return pc(this,void 0,void 0,function(){var a,s;return gc(this,function(o){switch(o.label){case 0:return e?a={deviceId:{exact:e}}:a={facingMode:"environment"},s={video:a},[4,this.decodeFromConstraints(s,r,n)];case 1:return[2,o.sent()]}})})},t.prototype.decodeFromConstraints=function(e,r,n){return pc(this,void 0,void 0,function(){var a;return gc(this,function(s){switch(s.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return a=s.sent(),[4,this.decodeFromStream(a,r,n)];case 2:return[2,s.sent()]}})})},t.prototype.decodeFromStream=function(e,r,n){return pc(this,void 0,void 0,function(){var a;return gc(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,r)];case 1:return a=s.sent(),[4,this.decodeContinuously(a,n)];case 2:return[2,s.sent()]}})})},t.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},t.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},t.prototype.attachStreamToVideo=function(e,r){return pc(this,void 0,void 0,function(){var n;return gc(this,function(a){switch(a.label){case 0:return n=this.prepareVideoElement(r),this.addVideoSource(n,e),this.videoElement=n,this.stream=e,[4,this.playVideoOnLoadAsync(n)];case 1:return a.sent(),[2,n]}})})},t.prototype.playVideoOnLoadAsync=function(e){var r=this;return new Promise(function(n,a){return r.playVideoOnLoad(e,function(){return n()})})},t.prototype.playVideoOnLoad=function(e,r){var n=this;this.videoEndedListener=function(){return n.stopStreams()},this.videoCanPlayListener=function(){return n.tryPlayVideo(e)},e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",r),this.tryPlayVideo(e)},t.prototype.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2},t.prototype.tryPlayVideo=function(e){return pc(this,void 0,void 0,function(){return gc(this,function(r){switch(r.label){case 0:if(this.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.play()];case 2:return r.sent(),[3,4];case 3:return r.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},t.prototype.getMediaElement=function(e,r){var n=document.getElementById(e);if(!n)throw new Vi("element with id '"+e+"' not found");if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new Vi("element with id '"+e+"' must be an "+r+" element");return n},t.prototype.decodeFromImage=function(e,r){if(!e&&!r)throw new Vi("either imageElement with a src set or an url must be provided");return r&&!e?this.decodeFromImageUrl(r):this.decodeFromImageElement(e)},t.prototype.decodeFromVideo=function(e,r){if(!e&&!r)throw new Vi("Either an element with a src set or an URL must be provided");return r&&!e?this.decodeFromVideoUrl(r):this.decodeFromVideoElement(e)},t.prototype.decodeFromVideoContinuously=function(e,r,n){if(e===void 0&&r===void 0)throw new Vi("Either an element with a src set or an URL must be provided");return r&&!e?this.decodeFromVideoUrlContinuously(r,n):this.decodeFromVideoElementContinuously(e,n)},t.prototype.decodeFromImageElement=function(e){if(!e)throw new Vi("An image element must be provided.");this.reset();var r=this.prepareImageElement(e);this.imageElement=r;var n;return this.isImageLoaded(r)?n=this.decodeOnce(r,!1,!0):n=this._decodeOnLoadImage(r),n},t.prototype.decodeFromVideoElement=function(e){var r=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(r)},t.prototype.decodeFromVideoElementContinuously=function(e,r){var n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,r)},t.prototype._decodeFromVideoElementSetup=function(e){if(!e)throw new Vi("A video element must be provided.");this.reset();var r=this.prepareVideoElement(e);return this.videoElement=r,r},t.prototype.decodeFromImageUrl=function(e){if(!e)throw new Vi("An URL must be provided.");this.reset();var r=this.prepareImageElement();this.imageElement=r;var n=this._decodeOnLoadImage(r);return r.src=e,n},t.prototype.decodeFromVideoUrl=function(e){if(!e)throw new Vi("An URL must be provided.");this.reset();var r=this.prepareVideoElement(),n=this.decodeFromVideoElement(r);return r.src=e,n},t.prototype.decodeFromVideoUrlContinuously=function(e,r){if(!e)throw new Vi("An URL must be provided.");this.reset();var n=this.prepareVideoElement(),a=this.decodeFromVideoElementContinuously(n,r);return n.src=e,a},t.prototype._decodeOnLoadImage=function(e){var r=this;return new Promise(function(n,a){r.imageLoadedListener=function(){return r.decodeOnce(e,!1,!0).then(n,a)},e.addEventListener("load",r.imageLoadedListener)})},t.prototype._decodeOnLoadVideo=function(e){return pc(this,void 0,void 0,function(){return gc(this,function(r){switch(r.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return r.sent(),[4,this.decodeOnce(e)];case 2:return[2,r.sent()]}})})},t.prototype._decodeOnLoadVideoContinuously=function(e,r){return pc(this,void 0,void 0,function(){return gc(this,function(n){switch(n.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return n.sent(),this.decodeContinuously(e,r),[2]}})})},t.prototype.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},t.prototype.prepareImageElement=function(e){var r;return typeof e>"u"&&(r=document.createElement("img"),r.width=200,r.height=200),typeof e=="string"&&(r=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(r=e),r},t.prototype.prepareVideoElement=function(e){var r;return!e&&typeof document<"u"&&(r=document.createElement("video"),r.width=200,r.height=200),typeof e=="string"&&(r=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(r=e),r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r},t.prototype.decodeOnce=function(e,r,n){var a=this;r===void 0&&(r=!0),n===void 0&&(n=!0),this._stopAsyncDecode=!1;var s=function(o,l){if(a._stopAsyncDecode){l(new lr("Video stream has ended before any code could be detected.")),a._stopAsyncDecode=void 0;return}try{var c=a.decode(e);o(c)}catch(A){var u=r&&A instanceof lr,d=A instanceof lo||A instanceof qr,f=d&&n;if(u||f)return setTimeout(s,a._timeBetweenDecodingAttempts,o,l);l(A)}};return new Promise(function(o,l){return s(o,l)})},t.prototype.decodeContinuously=function(e,r){var n=this;this._stopContinuousDecode=!1;var a=function(){if(n._stopContinuousDecode){n._stopContinuousDecode=void 0;return}try{var s=n.decode(e);r(s,null),setTimeout(a,n.timeBetweenScansMillis)}catch(c){r(null,c);var o=c instanceof lo||c instanceof qr,l=c instanceof lr;(o||l)&&setTimeout(a,n._timeBetweenDecodingAttempts)}};a()},t.prototype.decode=function(e){var r=this.createBinaryBitmap(e);return this.decodeBitmap(r)},t.prototype.createBinaryBitmap=function(e){this.getCaptureCanvasContext(e);var r=!1;e instanceof HTMLVideoElement?(this.drawFrameOnCanvas(e),r=!0):this.drawImageOnCanvas(e);var n=this.getCaptureCanvas(e),a=new ZLe(n,r),s=new Nse(a);return new wse(s)},t.prototype.getCaptureCanvasContext=function(e){if(!this.captureCanvasContext){var r=this.getCaptureCanvas(e),n=void 0;try{n=r.getContext("2d",{willReadFrequently:!0})}catch{n=r.getContext("2d")}this.captureCanvasContext=n}return this.captureCanvasContext},t.prototype.getCaptureCanvas=function(e){if(!this.captureCanvas){var r=this.createCaptureCanvas(e);this.captureCanvas=r}return this.captureCanvas},t.prototype.drawFrameOnCanvas=function(e,r,n){r===void 0&&(r={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)},t.prototype.drawImageOnCanvas=function(e,r,n){r===void 0&&(r={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)},t.prototype.decodeBitmap=function(e){return this.reader.decode(e,this._hints)},t.prototype.createCaptureCanvas=function(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;var r=document.createElement("canvas"),n,a;return typeof e<"u"&&(e instanceof HTMLVideoElement?(n=e.videoWidth,a=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,a=e.naturalHeight||e.height)),r.style.width=n+"px",r.style.height=a+"px",r.width=n,r.height=a,r},t.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(e){return e.stop()}),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()},t.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},t.prototype._destroyVideoElement=function(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},t.prototype._destroyImageElement=function(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},t.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},t.prototype.addVideoSource=function(e,r){try{e.srcObject=r}catch{e.src=URL.createObjectURL(r)}},t.prototype.cleanVideoSource=function(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")},t}(),dc=function(){function t(e,r,n,a,s,o){n===void 0&&(n=r==null?0:8*r.length),o===void 0&&(o=ws.currentTimeMillis()),this.text=e,this.rawBytes=r,this.numBits=n,this.resultPoints=a,this.format=s,this.timestamp=o,this.text=e,this.rawBytes=r,n==null?this.numBits=r==null?0:8*r.length:this.numBits=n,this.resultPoints=a,this.format=s,this.resultMetadata=null,o==null?this.timestamp=ws.currentTimeMillis():this.timestamp=o}return t.prototype.getText=function(){return this.text},t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.getBarcodeFormat=function(){return this.format},t.prototype.getResultMetadata=function(){return this.resultMetadata},t.prototype.putMetadata=function(e,r){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,r)},t.prototype.putAllMetadata=function(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))},t.prototype.addResultPoints=function(e){var r=this.resultPoints;if(r===null)this.resultPoints=e;else if(e!==null&&e.length>0){var n=new Array(r.length+e.length);ws.arraycopy(r,0,n,0,r.length),ws.arraycopy(e,0,n,r.length,e.length),this.resultPoints=n}},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.toString=function(){return this.text},t}(),dF;(function(t){t[t.AZTEC=0]="AZTEC",t[t.CODABAR=1]="CODABAR",t[t.CODE_39=2]="CODE_39",t[t.CODE_93=3]="CODE_93",t[t.CODE_128=4]="CODE_128",t[t.DATA_MATRIX=5]="DATA_MATRIX",t[t.EAN_8=6]="EAN_8",t[t.EAN_13=7]="EAN_13",t[t.ITF=8]="ITF",t[t.MAXICODE=9]="MAXICODE",t[t.PDF_417=10]="PDF_417",t[t.QR_CODE=11]="QR_CODE",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(dF||(dF={}));const jn=dF;var fF;(function(t){t[t.OTHER=0]="OTHER",t[t.ORIENTATION=1]="ORIENTATION",t[t.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",t[t.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",t[t.ISSUE_NUMBER=4]="ISSUE_NUMBER",t[t.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",t[t.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",t[t.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",t[t.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",t[t.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",t[t.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(fF||(fF={}));const Pl=fF;var yP=function(){function t(e,r,n,a,s,o){s===void 0&&(s=-1),o===void 0&&(o=-1),this.rawBytes=e,this.text=r,this.byteSegments=n,this.ecLevel=a,this.structuredAppendSequenceNumber=s,this.structuredAppendParity=o,this.numBits=e==null?0:8*e.length}return t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.setNumBits=function(e){this.numBits=e},t.prototype.getText=function(){return this.text},t.prototype.getByteSegments=function(){return this.byteSegments},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getErrorsCorrected=function(){return this.errorsCorrected},t.prototype.setErrorsCorrected=function(e){this.errorsCorrected=e},t.prototype.getErasures=function(){return this.erasures},t.prototype.setErasures=function(e){this.erasures=e},t.prototype.getOther=function(){return this.other},t.prototype.setOther=function(e){this.other=e},t.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},t.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},t.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},t}(),Zy=function(){function t(){}return t.prototype.exp=function(e){return this.expTable[e]},t.prototype.log=function(e){if(e===0)throw new Pn;return this.logTable[e]},t.addOrSubtract=function(e,r){return e^r},t}(),mm=function(){function t(e,r){if(r.length===0)throw new Pn;this.field=e;var n=r.length;if(n>1&&r[0]===0){for(var a=1;a<n&&r[a]===0;)a++;a===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-a),ws.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return this.coefficients[0]===0},t.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},t.prototype.evaluateAt=function(e){if(e===0)return this.getCoefficient(0);var r=this.coefficients,n;if(e===1){n=0;for(var a=0,s=r.length;a!==s;a++){var o=r[a];n=Zy.addOrSubtract(n,o)}return n}n=r[0];for(var l=r.length,c=this.field,a=1;a<l;a++)n=Zy.addOrSubtract(c.multiply(e,n),r[a]);return n},t.prototype.addOrSubtract=function(e){if(!this.field.equals(e.field))throw new Pn("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;var r=this.coefficients,n=e.coefficients;if(r.length>n.length){var a=r;r=n,n=a}var s=new Int32Array(n.length),o=n.length-r.length;ws.arraycopy(n,0,s,0,o);for(var l=o;l<n.length;l++)s[l]=Zy.addOrSubtract(r[l-o],n[l]);return new t(this.field,s)},t.prototype.multiply=function(e){if(!this.field.equals(e.field))throw new Pn("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();for(var r=this.coefficients,n=r.length,a=e.coefficients,s=a.length,o=new Int32Array(n+s-1),l=this.field,c=0;c<n;c++)for(var u=r[c],d=0;d<s;d++)o[c+d]=Zy.addOrSubtract(o[c+d],l.multiply(u,a[d]));return new t(l,o)},t.prototype.multiplyScalar=function(e){if(e===0)return this.field.getZero();if(e===1)return this;for(var r=this.coefficients.length,n=this.field,a=new Int32Array(r),s=this.coefficients,o=0;o<r;o++)a[o]=n.multiply(s[o],e);return new t(n,a)},t.prototype.multiplyByMonomial=function(e,r){if(e<0)throw new Pn;if(r===0)return this.field.getZero();for(var n=this.coefficients,a=n.length,s=new Int32Array(a+e),o=this.field,l=0;l<a;l++)s[l]=o.multiply(n[l],r);return new t(o,s)},t.prototype.divide=function(e){if(!this.field.equals(e.field))throw new Pn("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new Pn("Divide by 0");for(var r=this.field,n=r.getZero(),a=this,s=e.getCoefficient(e.getDegree()),o=r.inverse(s);a.getDegree()>=e.getDegree()&&!a.isZero();){var l=a.getDegree()-e.getDegree(),c=r.multiply(a.getCoefficient(a.getDegree()),o),u=e.multiplyByMonomial(l,c),d=r.buildMonomial(l,c);n=n.addOrSubtract(d),a=a.addOrSubtract(u)}return[n,a]},t.prototype.toString=function(){for(var e="",r=this.getDegree();r>=0;r--){var n=this.getCoefficient(r);if(n!==0){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),r===0||n!==1){var a=this.field.log(n);a===0?e+="1":a===1?e+="a":(e+="a^",e+=a)}r!==0&&(r===1?e+="x":(e+="x^",e+=r))}}return e},t}(),rUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Cse=function(t){rUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ArithmeticException",e}(du),nUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),tu=function(t){nUe(e,t);function e(r,n,a){var s=t.call(this)||this;s.primitive=r,s.size=n,s.generatorBase=a;for(var o=new Int32Array(n),l=1,c=0;c<n;c++)o[c]=l,l*=2,l>=n&&(l^=r,l&=n-1);s.expTable=o;for(var u=new Int32Array(n),c=0;c<n-1;c++)u[o[c]]=c;return s.logTable=u,s.zero=new mm(s,Int32Array.from([0])),s.one=new mm(s,Int32Array.from([1])),s}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(r,n){if(r<0)throw new Pn;if(n===0)return this.zero;var a=new Int32Array(r+1);return a[0]=n,new mm(this,a)},e.prototype.inverse=function(r){if(r===0)throw new Cse;return this.expTable[this.size-this.logTable[r]-1]},e.prototype.multiply=function(r,n){return r===0||n===0?0:this.expTable[(this.logTable[r]+this.logTable[n])%(this.size-1)]},e.prototype.getSize=function(){return this.size},e.prototype.getGeneratorBase=function(){return this.generatorBase},e.prototype.toString=function(){return"GF(0x"+sa.toHexString(this.primitive)+","+this.size+")"},e.prototype.equals=function(r){return r===this},e.AZTEC_DATA_12=new e(4201,4096,1),e.AZTEC_DATA_10=new e(1033,1024,1),e.AZTEC_DATA_6=new e(67,64,1),e.AZTEC_PARAM=new e(19,16,1),e.QR_CODE_FIELD_256=new e(285,256,0),e.DATA_MATRIX_FIELD_256=new e(301,256,1),e.AZTEC_DATA_8=e.DATA_MATRIX_FIELD_256,e.MAXICODE_FIELD_64=e.AZTEC_DATA_6,e}(Zy),aUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),o_=function(t){aUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ReedSolomonException",e}(du),sUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),zw=function(t){sUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="IllegalStateException",e}(du),bP=function(){function t(e){this.field=e}return t.prototype.decode=function(e,r){for(var n=this.field,a=new mm(n,e),s=new Int32Array(r),o=!0,l=0;l<r;l++){var c=a.evaluateAt(n.exp(l+n.getGeneratorBase()));s[s.length-1-l]=c,c!==0&&(o=!1)}if(!o)for(var u=new mm(n,s),d=this.runEuclideanAlgorithm(n.buildMonomial(r,1),u,r),f=d[0],A=d[1],h=this.findErrorLocations(f),m=this.findErrorMagnitudes(A,h),l=0;l<h.length;l++){var p=e.length-1-n.log(h[l]);if(p<0)throw new o_("Bad error location");e[p]=tu.addOrSubtract(e[p],m[l])}},t.prototype.runEuclideanAlgorithm=function(e,r,n){if(e.getDegree()<r.getDegree()){var a=e;e=r,r=a}for(var s=this.field,o=e,l=r,c=s.getZero(),u=s.getOne();l.getDegree()>=(n/2|0);){var d=o,f=c;if(o=l,c=u,o.isZero())throw new o_("r_{i-1} was zero");l=d;for(var A=s.getZero(),h=o.getCoefficient(o.getDegree()),m=s.inverse(h);l.getDegree()>=o.getDegree()&&!l.isZero();){var p=l.getDegree()-o.getDegree(),x=s.multiply(l.getCoefficient(l.getDegree()),m);A=A.addOrSubtract(s.buildMonomial(p,x)),l=l.addOrSubtract(o.multiplyByMonomial(p,x))}if(u=A.multiply(c).addOrSubtract(f),l.getDegree()>=o.getDegree())throw new zw("Division algorithm failed to reduce polynomial?")}var v=u.getCoefficient(0);if(v===0)throw new o_("sigmaTilde(0) was zero");var y=s.inverse(v),b=u.multiplyScalar(y),w=l.multiplyScalar(y);return[b,w]},t.prototype.findErrorLocations=function(e){var r=e.getDegree();if(r===1)return Int32Array.from([e.getCoefficient(1)]);for(var n=new Int32Array(r),a=0,s=this.field,o=1;o<s.getSize()&&a<r;o++)e.evaluateAt(o)===0&&(n[a]=s.inverse(o),a++);if(a!==r)throw new o_("Error locator degree does not match number of roots");return n},t.prototype.findErrorMagnitudes=function(e,r){for(var n=r.length,a=new Int32Array(n),s=this.field,o=0;o<n;o++){for(var l=s.inverse(r[o]),c=1,u=0;u<n;u++)if(o!==u){var d=s.multiply(r[u],l),f=d&1?d&-2:d|1;c=s.multiply(c,f)}a[o]=s.multiply(e.evaluateAt(l),s.inverse(c)),s.getGeneratorBase()!==0&&(a[o]=s.multiply(a[o],l))}return a},t}(),xl;(function(t){t[t.UPPER=0]="UPPER",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.DIGIT=3]="DIGIT",t[t.PUNCT=4]="PUNCT",t[t.BINARY=5]="BINARY"})(xl||(xl={}));var I$=function(){function t(){}return t.prototype.decode=function(e){this.ddata=e;var r=e.getBits(),n=this.extractBits(r),a=this.correctBits(n),s=t.convertBoolArrayToByteArray(a),o=t.getEncodedData(a),l=new yP(s,o,null,null);return l.setNumBits(a.length),l},t.highLevelDecode=function(e){return this.getEncodedData(e)},t.getEncodedData=function(e){for(var r=e.length,n=xl.UPPER,a=xl.UPPER,s="",o=0;o<r;)if(a===xl.BINARY){if(r-o<5)break;var l=t.readCode(e,o,5);if(o+=5,l===0){if(r-o<11)break;l=t.readCode(e,o,11)+31,o+=11}for(var c=0;c<l;c++){if(r-o<8){o=r;break}var u=t.readCode(e,o,8);s+=ba.castAsNonUtf8Char(u),o+=8}a=n}else{var d=a===xl.DIGIT?4:5;if(r-o<d)break;var u=t.readCode(e,o,d);o+=d;var f=t.getCharacter(a,u);f.startsWith("CTRL_")?(n=a,a=t.getTable(f.charAt(5)),f.charAt(6)==="L"&&(n=a)):(s+=f,a=n)}return s},t.getTable=function(e){switch(e){case"L":return xl.LOWER;case"P":return xl.PUNCT;case"M":return xl.MIXED;case"D":return xl.DIGIT;case"B":return xl.BINARY;case"U":default:return xl.UPPER}},t.getCharacter=function(e,r){switch(e){case xl.UPPER:return t.UPPER_TABLE[r];case xl.LOWER:return t.LOWER_TABLE[r];case xl.MIXED:return t.MIXED_TABLE[r];case xl.PUNCT:return t.PUNCT_TABLE[r];case xl.DIGIT:return t.DIGIT_TABLE[r];default:throw new zw("Bad table")}},t.prototype.correctBits=function(e){var r,n;this.ddata.getNbLayers()<=2?(n=6,r=tu.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,r=tu.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,r=tu.AZTEC_DATA_10):(n=12,r=tu.AZTEC_DATA_12);var a=this.ddata.getNbDatablocks(),s=e.length/n;if(s<a)throw new qr;for(var o=e.length%n,l=new Int32Array(s),c=0;c<s;c++,o+=n)l[c]=t.readCode(e,o,n);try{var u=new bP(r);u.decode(l,s-a)}catch(x){throw new qr(x)}for(var d=(1<<n)-1,f=0,c=0;c<a;c++){var A=l[c];if(A===0||A===d)throw new qr;(A===1||A===d-1)&&f++}for(var h=new Array(a*n-f),m=0,c=0;c<a;c++){var A=l[c];if(A===1||A===d-1)h.fill(A>1,m,m+n-1),m+=n-1;else for(var p=n-1;p>=0;--p)h[m++]=(A&1<<p)!==0}return h},t.prototype.extractBits=function(e){var r=this.ddata.isCompact(),n=this.ddata.getNbLayers(),a=(r?11:14)+n*4,s=new Int32Array(a),o=new Array(this.totalBitsInLayer(n,r));if(r)for(var l=0;l<s.length;l++)s[l]=l;else for(var c=a+1+2*sa.truncDivision(sa.truncDivision(a,2)-1,15),u=a/2,d=sa.truncDivision(c,2),l=0;l<u;l++){var f=l+sa.truncDivision(l,15);s[u-l-1]=d-f-1,s[u+l]=d+f+1}for(var l=0,A=0;l<n;l++){for(var h=(n-l)*4+(r?9:12),m=l*2,p=a-1-m,x=0;x<h;x++)for(var v=x*2,y=0;y<2;y++)o[A+v+y]=e.get(s[m+y],s[m+x]),o[A+2*h+v+y]=e.get(s[m+x],s[p-y]),o[A+4*h+v+y]=e.get(s[p-y],s[p-x]),o[A+6*h+v+y]=e.get(s[p-x],s[m+y]);A+=h*8}return o},t.readCode=function(e,r,n){for(var a=0,s=r;s<r+n;s++)a<<=1,e[s]&&(a|=1);return a},t.readByte=function(e,r){var n=e.length-r;return n>=8?t.readCode(e,r,8):t.readCode(e,r,n)<<8-n},t.convertBoolArrayToByteArray=function(e){for(var r=new Uint8Array((e.length+7)/8),n=0;n<r.length;n++)r[n]=t.readByte(e,8*n);return r},t.prototype.totalBitsInLayer=function(e,r){return((r?88:112)+16*e)*e},t.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],t.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],t.MIXED_TABLE=["CTRL_PS"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],t.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],t.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],t}(),ja=function(){function t(){}return t.round=function(e){return isNaN(e)?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0},t.distance=function(e,r,n,a){var s=e-n,o=r-a;return Math.sqrt(s*s+o*o)},t.sum=function(e){for(var r=0,n=0,a=e.length;n!==a;n++){var s=e[n];r+=s}return r},t}(),hF=function(){function t(){}return t.floatToIntBits=function(e){return e},t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t}(),An=function(){function t(e,r){this.x=e,this.y=r}return t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.equals=function(e){if(e instanceof t){var r=e;return this.x===r.x&&this.y===r.y}return!1},t.prototype.hashCode=function(){return 31*hF.floatToIntBits(this.x)+hF.floatToIntBits(this.y)},t.prototype.toString=function(){return"("+this.x+","+this.y+")"},t.orderBestPatterns=function(e){var r=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),a=this.distance(e[0],e[2]),s,o,l;if(n>=r&&n>=a?(o=e[0],s=e[1],l=e[2]):a>=n&&a>=r?(o=e[1],s=e[0],l=e[2]):(o=e[2],s=e[0],l=e[1]),this.crossProductZ(s,o,l)<0){var c=s;s=l,l=c}e[0]=s,e[1]=o,e[2]=l},t.distance=function(e,r){return ja.distance(e.x,e.y,r.x,r.y)},t.crossProductZ=function(e,r,n){var a=r.x,s=r.y;return(n.x-a)*(e.y-s)-(n.y-s)*(e.x-a)},t}(),LR=function(){function t(e,r){this.bits=e,this.points=r}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t}(),iUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),oUe=function(t){iUe(e,t);function e(r,n,a,s,o){var l=t.call(this,r,n)||this;return l.compact=a,l.nbDatablocks=s,l.nbLayers=o,l}return e.prototype.getNbLayers=function(){return this.nbLayers},e.prototype.getNbDatablocks=function(){return this.nbDatablocks},e.prototype.isCompact=function(){return this.compact},e}(LR),AF=function(){function t(e,r,n,a){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),r==null&&(r=t.INIT_SIZE),n==null&&(n=e.getWidth()/2|0),a==null&&(a=e.getHeight()/2|0);var s=r/2|0;if(this.leftInit=n-s,this.rightInit=n+s,this.upInit=a-s,this.downInit=a+s,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new lr}return t.prototype.detect=function(){for(var e=this.leftInit,r=this.rightInit,n=this.upInit,a=this.downInit,s=!1,o=!0,l=!1,c=!1,u=!1,d=!1,f=!1,A=this.width,h=this.height;o;){o=!1;for(var m=!0;(m||!c)&&r<A;)m=this.containsBlackPoint(n,a,r,!1),m?(r++,o=!0,c=!0):c||r++;if(r>=A){s=!0;break}for(var p=!0;(p||!u)&&a<h;)p=this.containsBlackPoint(e,r,a,!0),p?(a++,o=!0,u=!0):u||a++;if(a>=h){s=!0;break}for(var x=!0;(x||!d)&&e>=0;)x=this.containsBlackPoint(n,a,e,!1),x?(e--,o=!0,d=!0):d||e--;if(e<0){s=!0;break}for(var v=!0;(v||!f)&&n>=0;)v=this.containsBlackPoint(e,r,n,!0),v?(n--,o=!0,f=!0):f||n--;if(n<0){s=!0;break}o&&(l=!0)}if(!s&&l){for(var y=r-e,b=null,w=1;b===null&&w<y;w++)b=this.getBlackPointOnSegment(e,a-w,e+w,a);if(b==null)throw new lr;for(var j=null,w=1;j===null&&w<y;w++)j=this.getBlackPointOnSegment(e,n+w,e+w,n);if(j==null)throw new lr;for(var I=null,w=1;I===null&&w<y;w++)I=this.getBlackPointOnSegment(r,n+w,r-w,n);if(I==null)throw new lr;for(var C=null,w=1;C===null&&w<y;w++)C=this.getBlackPointOnSegment(r,a-w,r-w,a);if(C==null)throw new lr;return this.centerEdges(C,b,I,j)}else throw new lr},t.prototype.getBlackPointOnSegment=function(e,r,n,a){for(var s=ja.round(ja.distance(e,r,n,a)),o=(n-e)/s,l=(a-r)/s,c=this.image,u=0;u<s;u++){var d=ja.round(e+u*o),f=ja.round(r+u*l);if(c.get(d,f))return new An(d,f)}return null},t.prototype.centerEdges=function(e,r,n,a){var s=e.getX(),o=e.getY(),l=r.getX(),c=r.getY(),u=n.getX(),d=n.getY(),f=a.getX(),A=a.getY(),h=t.CORR;return s<this.width/2?[new An(f-h,A+h),new An(l+h,c+h),new An(u-h,d-h),new An(s+h,o-h)]:[new An(f+h,A+h),new An(l+h,c-h),new An(u-h,d+h),new An(s-h,o-h)]},t.prototype.containsBlackPoint=function(e,r,n,a){var s=this.image;if(a){for(var o=e;o<=r;o++)if(s.get(o,n))return!0}else for(var l=e;l<=r;l++)if(s.get(n,l))return!0;return!1},t.INIT_SIZE=10,t.CORR=1,t}(),j$=function(){function t(){}return t.checkAndNudgePoints=function(e,r){for(var n=e.getWidth(),a=e.getHeight(),s=!0,o=0;o<r.length&&s;o+=2){var l=Math.floor(r[o]),c=Math.floor(r[o+1]);if(l<-1||l>n||c<-1||c>a)throw new lr;s=!1,l===-1?(r[o]=0,s=!0):l===n&&(r[o]=n-1,s=!0),c===-1?(r[o+1]=0,s=!0):c===a&&(r[o+1]=a-1,s=!0)}s=!0;for(var o=r.length-2;o>=0&&s;o-=2){var l=Math.floor(r[o]),c=Math.floor(r[o+1]);if(l<-1||l>n||c<-1||c>a)throw new lr;s=!1,l===-1?(r[o]=0,s=!0):l===n&&(r[o]=n-1,s=!0),c===-1?(r[o+1]=0,s=!0):c===a&&(r[o+1]=a-1,s=!0)}},t}(),_se=function(){function t(e,r,n,a,s,o,l,c,u){this.a11=e,this.a21=r,this.a31=n,this.a12=a,this.a22=s,this.a32=o,this.a13=l,this.a23=c,this.a33=u}return t.quadrilateralToQuadrilateral=function(e,r,n,a,s,o,l,c,u,d,f,A,h,m,p,x){var v=t.quadrilateralToSquare(e,r,n,a,s,o,l,c),y=t.squareToQuadrilateral(u,d,f,A,h,m,p,x);return y.times(v)},t.prototype.transformPoints=function(e){for(var r=e.length,n=this.a11,a=this.a12,s=this.a13,o=this.a21,l=this.a22,c=this.a23,u=this.a31,d=this.a32,f=this.a33,A=0;A<r;A+=2){var h=e[A],m=e[A+1],p=s*h+c*m+f;e[A]=(n*h+o*m+u)/p,e[A+1]=(a*h+l*m+d)/p}},t.prototype.transformPointsWithValues=function(e,r){for(var n=this.a11,a=this.a12,s=this.a13,o=this.a21,l=this.a22,c=this.a23,u=this.a31,d=this.a32,f=this.a33,A=e.length,h=0;h<A;h++){var m=e[h],p=r[h],x=s*m+c*p+f;e[h]=(n*m+o*p+u)/x,r[h]=(a*m+l*p+d)/x}},t.squareToQuadrilateral=function(e,r,n,a,s,o,l,c){var u=e-n+s-l,d=r-a+o-c;if(u===0&&d===0)return new t(n-e,s-n,e,a-r,o-a,r,0,0,1);var f=n-s,A=l-s,h=a-o,m=c-o,p=f*m-A*h,x=(u*m-A*d)/p,v=(f*d-u*h)/p;return new t(n-e+x*n,l-e+v*l,e,a-r+x*a,c-r+v*c,r,x,v,1)},t.quadrilateralToSquare=function(e,r,n,a,s,o,l,c){return t.squareToQuadrilateral(e,r,n,a,s,o,l,c).buildAdjoint()},t.prototype.buildAdjoint=function(){return new t(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},t.prototype.times=function(e){return new t(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)},t}(),lUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),cUe=function(t){lUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.sampleGrid=function(r,n,a,s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w){var j=_se.quadrilateralToQuadrilateral(s,o,l,c,u,d,f,A,h,m,p,x,v,y,b,w);return this.sampleGridWithTransform(r,n,a,j)},e.prototype.sampleGridWithTransform=function(r,n,a,s){if(n<=0||a<=0)throw new lr;for(var o=new ch(n,a),l=new Float32Array(2*n),c=0;c<a;c++){for(var u=l.length,d=c+.5,f=0;f<u;f+=2)l[f]=f/2+.5,l[f+1]=d;s.transformPoints(l),j$.checkAndNudgePoints(r,l);try{for(var f=0;f<u;f+=2)r.get(Math.floor(l[f]),Math.floor(l[f+1]))&&o.set(f/2,c)}catch{throw new lr}}return o},e}(j$),UR=function(){function t(){}return t.setGridSampler=function(e){t.gridSampler=e},t.getInstance=function(){return t.gridSampler},t.gridSampler=new cUe,t}(),zc=function(){function t(e,r){this.x=e,this.y=r}return t.prototype.toResultPoint=function(){return new An(this.getX(),this.getY())},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t}(),uUe=function(){function t(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}return t.prototype.detect=function(){return this.detectMirror(!1)},t.prototype.detectMirror=function(e){var r=this.getMatrixCenter(),n=this.getBullsEyeCorners(r);if(e){var a=n[0];n[0]=n[2],n[2]=a}this.extractParameters(n);var s=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),o=this.getMatrixCornerPoints(n);return new oUe(s,o,this.compact,this.nbDataBlocks,this.nbLayers)},t.prototype.extractParameters=function(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new lr;var r=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],r),this.sampleLine(e[1],e[2],r),this.sampleLine(e[2],e[3],r),this.sampleLine(e[3],e[0],r)]);this.shift=this.getRotation(n,r);for(var a=0,s=0;s<4;s++){var o=n[(this.shift+s)%4];this.compact?(a<<=7,a+=o>>1&127):(a<<=10,a+=(o>>2&992)+(o>>1&31))}var l=this.getCorrectedParameterData(a,this.compact);this.compact?(this.nbLayers=(l>>6)+1,this.nbDataBlocks=(l&63)+1):(this.nbLayers=(l>>11)+1,this.nbDataBlocks=(l&2047)+1)},t.prototype.getRotation=function(e,r){var n=0;e.forEach(function(s,o,l){var c=(s>>r-2<<1)+(s&1);n=(n<<3)+c}),n=((n&1)<<11)+(n>>1);for(var a=0;a<4;a++)if(sa.bitCount(n^this.EXPECTED_CORNER_BITS[a])<=2)return a;throw new lr},t.prototype.getCorrectedParameterData=function(e,r){var n,a;r?(n=7,a=2):(n=10,a=4);for(var s=n-a,o=new Int32Array(n),l=n-1;l>=0;--l)o[l]=e&15,e>>=4;try{var c=new bP(tu.AZTEC_PARAM);c.decode(o,s)}catch{throw new lr}for(var u=0,l=0;l<a;l++)u=(u<<4)+o[l];return u},t.prototype.getBullsEyeCorners=function(e){var r=e,n=e,a=e,s=e,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var l=this.getFirstDifferent(r,o,1,-1),c=this.getFirstDifferent(n,o,1,1),u=this.getFirstDifferent(a,o,-1,1),d=this.getFirstDifferent(s,o,-1,-1);if(this.nbCenterLayers>2){var f=this.distancePoint(d,l)*this.nbCenterLayers/(this.distancePoint(s,r)*(this.nbCenterLayers+2));if(f<.75||f>1.25||!this.isWhiteOrBlackRectangle(l,c,u,d))break}r=l,n=c,a=u,s=d,o=!o}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new lr;this.compact=this.nbCenterLayers===5;var A=new An(r.getX()+.5,r.getY()-.5),h=new An(n.getX()+.5,n.getY()+.5),m=new An(a.getX()-.5,a.getY()+.5),p=new An(s.getX()-.5,s.getY()-.5);return this.expandSquare([A,h,m,p],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},t.prototype.getMatrixCenter=function(){var e,r,n,a;try{var s=new AF(this.image).detect();e=s[0],r=s[1],n=s[2],a=s[3]}catch{var o=this.image.getWidth()/2,l=this.image.getHeight()/2;e=this.getFirstDifferent(new zc(o+7,l-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new zc(o+7,l+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new zc(o-7,l+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new zc(o-7,l-7),!1,-1,-1).toResultPoint()}var c=ja.round((e.getX()+a.getX()+r.getX()+n.getX())/4),u=ja.round((e.getY()+a.getY()+r.getY()+n.getY())/4);try{var s=new AF(this.image,15,c,u).detect();e=s[0],r=s[1],n=s[2],a=s[3]}catch{e=this.getFirstDifferent(new zc(c+7,u-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new zc(c+7,u+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new zc(c-7,u+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new zc(c-7,u-7),!1,-1,-1).toResultPoint()}return c=ja.round((e.getX()+a.getX()+r.getX()+n.getX())/4),u=ja.round((e.getY()+a.getY()+r.getY()+n.getY())/4),new zc(c,u)},t.prototype.getMatrixCornerPoints=function(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())},t.prototype.sampleGrid=function(e,r,n,a,s){var o=UR.getInstance(),l=this.getDimension(),c=l/2-this.nbCenterLayers,u=l/2+this.nbCenterLayers;return o.sampleGrid(e,l,l,c,c,u,c,u,u,c,u,r.getX(),r.getY(),n.getX(),n.getY(),a.getX(),a.getY(),s.getX(),s.getY())},t.prototype.sampleLine=function(e,r,n){for(var a=0,s=this.distanceResultPoint(e,r),o=s/n,l=e.getX(),c=e.getY(),u=o*(r.getX()-e.getX())/s,d=o*(r.getY()-e.getY())/s,f=0;f<n;f++)this.image.get(ja.round(l+f*u),ja.round(c+f*d))&&(a|=1<<n-f-1);return a},t.prototype.isWhiteOrBlackRectangle=function(e,r,n,a){var s=3;e=new zc(e.getX()-s,e.getY()+s),r=new zc(r.getX()-s,r.getY()-s),n=new zc(n.getX()+s,n.getY()-s),a=new zc(a.getX()+s,a.getY()+s);var o=this.getColor(a,e);if(o===0)return!1;var l=this.getColor(e,r);return l!==o||(l=this.getColor(r,n),l!==o)?!1:(l=this.getColor(n,a),l===o)},t.prototype.getColor=function(e,r){for(var n=this.distancePoint(e,r),a=(r.getX()-e.getX())/n,s=(r.getY()-e.getY())/n,o=0,l=e.getX(),c=e.getY(),u=this.image.get(e.getX(),e.getY()),d=Math.ceil(n),f=0;f<d;f++)l+=a,c+=s,this.image.get(ja.round(l),ja.round(c))!==u&&o++;var A=o/n;return A>.1&&A<.9?0:A<=.1===u?1:-1},t.prototype.getFirstDifferent=function(e,r,n,a){for(var s=e.getX()+n,o=e.getY()+a;this.isValid(s,o)&&this.image.get(s,o)===r;)s+=n,o+=a;for(s-=n,o-=a;this.isValid(s,o)&&this.image.get(s,o)===r;)s+=n;for(s-=n;this.isValid(s,o)&&this.image.get(s,o)===r;)o+=a;return o-=a,new zc(s,o)},t.prototype.expandSquare=function(e,r,n){var a=n/(2*r),s=e[0].getX()-e[2].getX(),o=e[0].getY()-e[2].getY(),l=(e[0].getX()+e[2].getX())/2,c=(e[0].getY()+e[2].getY())/2,u=new An(l+a*s,c+a*o),d=new An(l-a*s,c-a*o);s=e[1].getX()-e[3].getX(),o=e[1].getY()-e[3].getY(),l=(e[1].getX()+e[3].getX())/2,c=(e[1].getY()+e[3].getY())/2;var f=new An(l+a*s,c+a*o),A=new An(l-a*s,c-a*o),h=[u,f,d,A];return h},t.prototype.isValid=function(e,r){return e>=0&&e<this.image.getWidth()&&r>0&&r<this.image.getHeight()},t.prototype.isValidPoint=function(e){var r=ja.round(e.getX()),n=ja.round(e.getY());return this.isValid(r,n)},t.prototype.distancePoint=function(e,r){return ja.distance(e.getX(),e.getY(),r.getX(),r.getY())},t.prototype.distanceResultPoint=function(e,r){return ja.distance(e.getX(),e.getY(),r.getX(),r.getY())},t.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(sa.truncDivision(this.nbLayers-4,8)+1)+15},t}(),tI=function(){function t(){}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n=null,a=new uUe(e.getBlackMatrix()),s=null,o=null;try{var l=a.detectMirror(!1);s=l.getPoints(),this.reportFoundResultPoints(r,s),o=new I$().decode(l)}catch(f){n=f}if(o==null)try{var l=a.detectMirror(!0);s=l.getPoints(),this.reportFoundResultPoints(r,s),o=new I$().decode(l)}catch(f){throw n??f}var c=new dc(o.getText(),o.getRawBytes(),o.getNumBits(),s,jn.AZTEC,ws.currentTimeMillis()),u=o.getByteSegments();u!=null&&c.putMetadata(Pl.BYTE_SEGMENTS,u);var d=o.getECLevel();return d!=null&&c.putMetadata(Pl.ERROR_CORRECTION_LEVEL,d),c},t.prototype.reportFoundResultPoints=function(e,r){if(e!=null){var n=e.get(Ns.NEED_RESULT_POINT_CALLBACK);n!=null&&r.forEach(function(a,s,o){n.foundPossibleResultPoint(a)})}},t.prototype.reset=function(){},t}(),dUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){dUe(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new tI,r)||this}return e})(C1);var Fo=function(){function t(){}return t.prototype.decode=function(e,r){try{return this.doDecode(e,r)}catch{var n=r&&r.get(Ns.TRY_HARDER)===!0;if(n&&e.isRotateSupported()){var a=e.rotateCounterClockwise(),s=this.doDecode(a,r),o=s.getResultMetadata(),l=270;o!==null&&o.get(Pl.ORIENTATION)===!0&&(l=l+o.get(Pl.ORIENTATION)%360),s.putMetadata(Pl.ORIENTATION,l);var c=s.getResultPoints();if(c!==null)for(var u=a.getHeight(),d=0;d<c.length;d++)c[d]=new An(u-c[d].getY()-1,c[d].getX());return s}else throw new lr}},t.prototype.reset=function(){},t.prototype.doDecode=function(e,r){var n=e.getWidth(),a=e.getHeight(),s=new tl(n),o=r&&r.get(Ns.TRY_HARDER)===!0,l=Math.max(1,a>>(o?8:5)),c;o?c=a:c=15;for(var u=Math.trunc(a/2),d=0;d<c;d++){var f=Math.trunc((d+1)/2),A=(d&1)===0,h=u+l*(A?f:-f);if(h<0||h>=a)break;try{s=e.getBlackRow(h,s)}catch{continue}for(var m=function(y){if(y===1&&(s.reverse(),r&&r.get(Ns.NEED_RESULT_POINT_CALLBACK)===!0)){var b=new Map;r.forEach(function(I,C){return b.set(C,I)}),b.delete(Ns.NEED_RESULT_POINT_CALLBACK),r=b}try{var w=p.decodeRow(h,s,r);if(y===1){w.putMetadata(Pl.ORIENTATION,180);var j=w.getResultPoints();j!==null&&(j[0]=new An(n-j[0].getX()-1,j[0].getY()),j[1]=new An(n-j[1].getX()-1,j[1].getY()))}return{value:w}}catch{}},p=this,x=0;x<2;x++){var v=m(x);if(typeof v=="object")return v.value}}throw new lr},t.recordPattern=function(e,r,n){for(var a=n.length,s=0;s<a;s++)n[s]=0;var o=e.getSize();if(r>=o)throw new lr;for(var l=!e.get(r),c=0,u=r;u<o;){if(e.get(u)!==l)n[c]++;else{if(++c===a)break;n[c]=1,l=!l}u++}if(!(c===a||c===a-1&&u===o))throw new lr},t.recordPatternInReverse=function(e,r,n){for(var a=n.length,s=e.get(r);r>0&&a>=0;)e.get(--r)!==s&&(a--,s=!s);if(a>=0)throw new lr;t.recordPattern(e,r+1,n)},t.patternMatchVariance=function(e,r,n){for(var a=e.length,s=0,o=0,l=0;l<a;l++)s+=e[l],o+=r[l];if(s<o)return Number.POSITIVE_INFINITY;var c=s/o;n*=c;for(var u=0,d=0;d<a;d++){var f=e[d],A=r[d]*c,h=f>A?f-A:A-f;if(h>n)return Number.POSITIVE_INFINITY;u+=h}return u/s},t}(),fUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),P$=function(t){fUe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.findStartPattern=function(r){for(var n=r.getSize(),a=r.getNextSet(0),s=0,o=Int32Array.from([0,0,0,0,0,0]),l=a,c=!1,u=6,d=a;d<n;d++)if(r.get(d)!==c)o[s]++;else{if(s===u-1){for(var f=e.MAX_AVG_VARIANCE,A=-1,h=e.CODE_START_A;h<=e.CODE_START_C;h++){var m=Fo.patternMatchVariance(o,e.CODE_PATTERNS[h],e.MAX_INDIVIDUAL_VARIANCE);m<f&&(f=m,A=h)}if(A>=0&&r.isRange(Math.max(0,l-(d-l)/2),l,!1))return Int32Array.from([l,d,A]);l+=o[0]+o[1],o=o.slice(2,o.length),o[s-1]=0,o[s]=0,s--}else s++;o[s]=1,c=!c}throw new lr},e.decodeCode=function(r,n,a){Fo.recordPattern(r,a,n);for(var s=e.MAX_AVG_VARIANCE,o=-1,l=0;l<e.CODE_PATTERNS.length;l++){var c=e.CODE_PATTERNS[l],u=this.patternMatchVariance(n,c,e.MAX_INDIVIDUAL_VARIANCE);u<s&&(s=u,o=l)}if(o>=0)return o;throw new lr},e.prototype.decodeRow=function(r,n,a){var s=a&&a.get(Ns.ASSUME_GS1)===!0,o=e.findStartPattern(n),l=o[2],c=0,u=new Uint8Array(20);u[c++]=l;var d;switch(l){case e.CODE_START_A:d=e.CODE_CODE_A;break;case e.CODE_START_B:d=e.CODE_CODE_B;break;case e.CODE_START_C:d=e.CODE_CODE_C;break;default:throw new qr}for(var f=!1,A=!1,h="",m=o[0],p=o[1],x=Int32Array.from([0,0,0,0,0,0]),v=0,y=0,b=l,w=0,j=!0,I=!1,C=!1;!f;){var S=A;switch(A=!1,v=y,y=e.decodeCode(n,x,p),u[c++]=y,y!==e.CODE_STOP&&(j=!0),y!==e.CODE_STOP&&(w++,b+=w*y),m=p,p+=x.reduce(function(ie,Ae){return ie+Ae},0),y){case e.CODE_START_A:case e.CODE_START_B:case e.CODE_START_C:throw new qr}switch(d){case e.CODE_CODE_A:if(y<64)C===I?h+=String.fromCharCode(32+y):h+=String.fromCharCode(32+y+128),C=!1;else if(y<96)C===I?h+=String.fromCharCode(y-64):h+=String.fromCharCode(y+64),C=!1;else switch(y!==e.CODE_STOP&&(j=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_A:!I&&C?(I=!0,C=!1):I&&C?(I=!1,C=!1):C=!0;break;case e.CODE_SHIFT:A=!0,d=e.CODE_CODE_B;break;case e.CODE_CODE_B:d=e.CODE_CODE_B;break;case e.CODE_CODE_C:d=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_B:if(y<96)C===I?h+=String.fromCharCode(32+y):h+=String.fromCharCode(32+y+128),C=!1;else switch(y!==e.CODE_STOP&&(j=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_B:!I&&C?(I=!0,C=!1):I&&C?(I=!1,C=!1):C=!0;break;case e.CODE_SHIFT:A=!0,d=e.CODE_CODE_A;break;case e.CODE_CODE_A:d=e.CODE_CODE_A;break;case e.CODE_CODE_C:d=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_C:if(y<100)y<10&&(h+="0"),h+=y;else switch(y!==e.CODE_STOP&&(j=!1),y){case e.CODE_FNC_1:s&&(h.length===0?h+="]C1":h+="");break;case e.CODE_CODE_A:d=e.CODE_CODE_A;break;case e.CODE_CODE_B:d=e.CODE_CODE_B;break;case e.CODE_STOP:f=!0;break}break}S&&(d=d===e.CODE_CODE_A?e.CODE_CODE_B:e.CODE_CODE_A)}var E=p-m;if(p=n.getNextUnset(p),!n.isRange(p,Math.min(n.getSize(),p+(p-m)/2),!1))throw new lr;if(b-=w*v,b%103!==v)throw new lo;var B=h.length;if(B===0)throw new lr;B>0&&j&&(d===e.CODE_CODE_C?h=h.substring(0,B-2):h=h.substring(0,B-1));for(var k=(o[1]+o[0])/2,T=m+E/2,P=u.length,K=new Uint8Array(P),le=0;le<P;le++)K[le]=u[le];var oe=[new An(k,r),new An(T,r)];return new dc(h,K,0,oe,jn.CODE_128,new Date().getTime())},e.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],e.MAX_AVG_VARIANCE=.25,e.MAX_INDIVIDUAL_VARIANCE=.7,e.CODE_SHIFT=98,e.CODE_CODE_C=99,e.CODE_CODE_B=100,e.CODE_CODE_A=101,e.CODE_FNC_1=102,e.CODE_FNC_2=97,e.CODE_FNC_3=96,e.CODE_FNC_4_A=101,e.CODE_FNC_4_B=100,e.CODE_START_A=103,e.CODE_START_B=104,e.CODE_START_C=105,e.CODE_STOP=106,e}(Fo),hUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),G5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},T$=function(t){hUe(e,t);function e(r,n){r===void 0&&(r=!1),n===void 0&&(n=!1);var a=t.call(this)||this;return a.usingCheckDigit=r,a.extendedMode=n,a.decodeRowResult="",a.counters=new Int32Array(9),a}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.counters;u.fill(0),this.decodeRowResult="";var d=e.findAsteriskPattern(n,u),f=n.getNextSet(d[1]),A=n.getSize(),h,m;do{e.recordPattern(n,f,u);var p=e.toNarrowWidePattern(u);if(p<0)throw new lr;h=e.patternToChar(p),this.decodeRowResult+=h,m=f;try{for(var x=(s=void 0,G5(u)),v=x.next();!v.done;v=x.next()){var y=v.value;f+=y}}catch(P){s={error:P}}finally{try{v&&!v.done&&(o=x.return)&&o.call(x)}finally{if(s)throw s.error}}f=n.getNextSet(f)}while(h!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var b=0;try{for(var w=G5(u),j=w.next();!j.done;j=w.next()){var y=j.value;b+=y}}catch(P){l={error:P}}finally{try{j&&!j.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}var I=f-m-b;if(f!==A&&I*2<b)throw new lr;if(this.usingCheckDigit){for(var C=this.decodeRowResult.length-1,S=0,E=0;E<C;E++)S+=e.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(E));if(this.decodeRowResult.charAt(C)!==e.ALPHABET_STRING.charAt(S%43))throw new lo;this.decodeRowResult=this.decodeRowResult.substring(0,C)}if(this.decodeRowResult.length===0)throw new lr;var B;this.extendedMode?B=e.decodeExtended(this.decodeRowResult):B=this.decodeRowResult;var k=(d[1]+d[0])/2,T=m+b/2;return new dc(B,null,0,[new An(k,r),new An(T,r)],jn.CODE_39,new Date().getTime())},e.findAsteriskPattern=function(r,n){for(var a=r.getSize(),s=r.getNextSet(0),o=0,l=s,c=!1,u=n.length,d=s;d<a;d++)if(r.get(d)!==c)n[o]++;else{if(o===u-1){if(this.toNarrowWidePattern(n)===e.ASTERISK_ENCODING&&r.isRange(Math.max(0,l-Math.floor((d-l)/2)),l,!1))return[l,d];l+=n[0]+n[1],n.copyWithin(0,2,2+o-1),n[o-1]=0,n[o]=0,o--}else o++;n[o]=1,c=!c}throw new lr},e.toNarrowWidePattern=function(r){var n,a,s=r.length,o=0,l;do{var c=2147483647;try{for(var u=(n=void 0,G5(r)),d=u.next();!d.done;d=u.next()){var f=d.value;f<c&&f>o&&(c=f)}}catch(p){n={error:p}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}o=c,l=0;for(var A=0,h=0,m=0;m<s;m++){var f=r[m];f>o&&(h|=1<<s-1-m,l++,A+=f)}if(l===3){for(var m=0;m<s&&l>0;m++){var f=r[m];if(f>o&&(l--,f*2>=A))return-1}return h}}while(l>3);return-1},e.patternToChar=function(r){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===r)return e.ALPHABET_STRING.charAt(n);if(r===e.ASTERISK_ENCODING)return"*";throw new lr},e.decodeExtended=function(r){for(var n=r.length,a="",s=0;s<n;s++){var o=r.charAt(s);if(o==="+"||o==="$"||o==="%"||o==="/"){var l=r.charAt(s+1),c="\0";switch(o){case"+":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)+32);else throw new qr;break;case"$":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)-64);else throw new qr;break;case"%":if(l>="A"&&l<="E")c=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")c=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")c=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")c="\0";else if(l==="V")c="@";else if(l==="W")c="`";else if(l==="X"||l==="Y"||l==="Z")c="";else throw new qr;break;case"/":if(l>="A"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")c=":";else throw new qr;break}a+=c,s++}else a+=o}return a},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",e.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],e.ASTERISK_ENCODING=148,e}(Fo),AUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),K5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},B$=function(t){AUe(e,t);function e(){var r=t.call(this)||this;return r.decodeRowResult="",r.counters=new Int32Array(6),r}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.findAsteriskPattern(n),d=n.getNextSet(u[1]),f=n.getSize(),A=this.counters;A.fill(0),this.decodeRowResult="";var h,m;do{e.recordPattern(n,d,A);var p=this.toPattern(A);if(p<0)throw new lr;h=this.patternToChar(p),this.decodeRowResult+=h,m=d;try{for(var x=(s=void 0,K5(A)),v=x.next();!v.done;v=x.next()){var y=v.value;d+=y}}catch(E){s={error:E}}finally{try{v&&!v.done&&(o=x.return)&&o.call(x)}finally{if(s)throw s.error}}d=n.getNextSet(d)}while(h!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var b=0;try{for(var w=K5(A),j=w.next();!j.done;j=w.next()){var y=j.value;b+=y}}catch(E){l={error:E}}finally{try{j&&!j.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}if(d===f||!n.get(d))throw new lr;if(this.decodeRowResult.length<2)throw new lr;this.checkChecksums(this.decodeRowResult),this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-2);var I=this.decodeExtended(this.decodeRowResult),C=(u[1]+u[0])/2,S=m+b/2;return new dc(I,null,0,[new An(C,r),new An(S,r)],jn.CODE_93,new Date().getTime())},e.prototype.findAsteriskPattern=function(r){var n=r.getSize(),a=r.getNextSet(0);this.counters.fill(0);for(var s=this.counters,o=a,l=!1,c=s.length,u=0,d=a;d<n;d++)if(r.get(d)!==l)s[u]++;else{if(u===c-1){if(this.toPattern(s)===e.ASTERISK_ENCODING)return new Int32Array([o,d]);o+=s[0]+s[1],s.copyWithin(0,2,2+u-1),s[u-1]=0,s[u]=0,u--}else u++;s[u]=1,l=!l}throw new lr},e.prototype.toPattern=function(r){var n,a,s=0;try{for(var o=K5(r),l=o.next();!l.done;l=o.next()){var c=l.value;s+=c}}catch(m){n={error:m}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}for(var u=0,d=r.length,f=0;f<d;f++){var A=Math.round(r[f]*9/s);if(A<1||A>4)return-1;if(f&1)u<<=A;else for(var h=0;h<A;h++)u=u<<1|1}return u},e.prototype.patternToChar=function(r){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===r)return e.ALPHABET_STRING.charAt(n);throw new lr},e.prototype.decodeExtended=function(r){for(var n=r.length,a="",s=0;s<n;s++){var o=r.charAt(s);if(o>="a"&&o<="d"){if(s>=n-1)throw new qr;var l=r.charAt(s+1),c="\0";switch(o){case"d":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)+32);else throw new qr;break;case"a":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)-64);else throw new qr;break;case"b":if(l>="A"&&l<="E")c=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")c=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")c=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")c="\0";else if(l==="V")c="@";else if(l==="W")c="`";else if(l>="X"&&l<="Z")c="";else throw new qr;break;case"c":if(l>="A"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")c=":";else throw new qr;break}a+=c,s++}else a+=o}return a},e.prototype.checkChecksums=function(r){var n=r.length;this.checkOneChecksum(r,n-2,20),this.checkOneChecksum(r,n-1,15)},e.prototype.checkOneChecksum=function(r,n,a){for(var s=1,o=0,l=n-1;l>=0;l--)o+=s*e.ALPHABET_STRING.indexOf(r.charAt(l)),++s>a&&(s=1);if(r.charAt(n)!==e.ALPHABET_STRING[o%47])throw new lo},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*",e.CHARACTER_ENCODINGS=[276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350],e.ASTERISK_ENCODING=e.CHARACTER_ENCODINGS[47],e}(Fo),mUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),pUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},k$=function(t){mUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.narrowLineWidth=-1,r}return e.prototype.decodeRow=function(r,n,a){var s,o,l=this.decodeStart(n),c=this.decodeEnd(n),u=new ta;e.decodeMiddle(n,l[1],c[0],u);var d=u.toString(),f=null;a!=null&&(f=a.get(Ns.ALLOWED_LENGTHS)),f==null&&(f=e.DEFAULT_ALLOWED_LENGTHS);var A=d.length,h=!1,m=0;try{for(var p=pUe(f),x=p.next();!x.done;x=p.next()){var v=x.value;if(A===v){h=!0;break}v>m&&(m=v)}}catch(w){s={error:w}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}if(!h&&A>m&&(h=!0),!h)throw new qr;var y=[new An(l[1],r),new An(c[0],r)],b=new dc(d,null,0,y,jn.ITF,new Date().getTime());return b},e.decodeMiddle=function(r,n,a,s){var o=new Int32Array(10),l=new Int32Array(5),c=new Int32Array(5);for(o.fill(0),l.fill(0),c.fill(0);n<a;){Fo.recordPattern(r,n,o);for(var u=0;u<5;u++){var d=2*u;l[u]=o[d],c[u]=o[d+1]}var f=e.decodeDigit(l);s.append(f.toString()),f=this.decodeDigit(c),s.append(f.toString()),o.forEach(function(A){n+=A})}},e.prototype.decodeStart=function(r){var n=e.skipWhiteSpace(r),a=e.findGuardPattern(r,n,e.START_PATTERN);return this.narrowLineWidth=(a[1]-a[0])/4,this.validateQuietZone(r,a[0]),a},e.prototype.validateQuietZone=function(r,n){var a=this.narrowLineWidth*10;a=a<n?a:n;for(var s=n-1;a>0&&s>=0&&!r.get(s);s--)a--;if(a!==0)throw new lr},e.skipWhiteSpace=function(r){var n=r.getSize(),a=r.getNextSet(0);if(a===n)throw new lr;return a},e.prototype.decodeEnd=function(r){r.reverse();try{var n=e.skipWhiteSpace(r),a=void 0;try{a=e.findGuardPattern(r,n,e.END_PATTERN_REVERSED[0])}catch(o){o instanceof lr&&(a=e.findGuardPattern(r,n,e.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,a[0]);var s=a[0];return a[0]=r.getSize()-a[1],a[1]=r.getSize()-s,a}finally{r.reverse()}},e.findGuardPattern=function(r,n,a){var s=a.length,o=new Int32Array(s),l=r.getSize(),c=!1,u=0,d=n;o.fill(0);for(var f=n;f<l;f++)if(r.get(f)!==c)o[u]++;else{if(u===s-1){if(Fo.patternMatchVariance(o,a,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return[d,f];d+=o[0]+o[1],ws.arraycopy(o,2,o,0,u-1),o[u-1]=0,o[u]=0,u--}else u++;o[u]=1,c=!c}throw new lr},e.decodeDigit=function(r){for(var n=e.MAX_AVG_VARIANCE,a=-1,s=e.PATTERNS.length,o=0;o<s;o++){var l=e.PATTERNS[o],c=Fo.patternMatchVariance(r,l,e.MAX_INDIVIDUAL_VARIANCE);c<n?(n=c,a=o):c===n&&(a=-1)}if(a>=0)return a%10;throw new lr},e.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],e.MAX_AVG_VARIANCE=.38,e.MAX_INDIVIDUAL_VARIANCE=.5,e.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],e.START_PATTERN=Int32Array.from([1,1,1,1]),e.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],e}(Fo),gUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Gv=function(t){gUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.decodeRowStringBuffer="",r}return e.findStartGuardPattern=function(r){for(var n=!1,a,s=0,o=Int32Array.from([0,0,0]);!n;){o=Int32Array.from([0,0,0]),a=e.findGuardPattern(r,s,!1,this.START_END_PATTERN,o);var l=a[0];s=a[1];var c=l-(s-l);c>=0&&(n=r.isRange(c,l,!1))}return a},e.checkChecksum=function(r){return e.checkStandardUPCEANChecksum(r)},e.checkStandardUPCEANChecksum=function(r){var n=r.length;if(n===0)return!1;var a=parseInt(r.charAt(n-1),10);return e.getStandardUPCEANChecksum(r.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(r){for(var n=r.length,a=0,s=n-1;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new qr;a+=o}a*=3;for(var s=n-2;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new qr;a+=o}return(1e3-a)%10},e.decodeEnd=function(r,n){return e.findGuardPattern(r,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e.findGuardPatternWithoutCounters=function(r,n,a,s){return this.findGuardPattern(r,n,a,s,new Int32Array(s.length))},e.findGuardPattern=function(r,n,a,s,o){var l=r.getSize();n=a?r.getNextUnset(n):r.getNextSet(n);for(var c=0,u=n,d=s.length,f=a,A=n;A<l;A++)if(r.get(A)!==f)o[c]++;else{if(c===d-1){if(Fo.patternMatchVariance(o,s,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return Int32Array.from([u,A]);u+=o[0]+o[1];for(var h=o.slice(2,o.length),m=0;m<c-1;m++)o[m]=h[m];o[c-1]=0,o[c]=0,c--}else c++;o[c]=1,f=!f}throw new lr},e.decodeDigit=function(r,n,a,s){this.recordPattern(r,a,n);for(var o=this.MAX_AVG_VARIANCE,l=-1,c=s.length,u=0;u<c;u++){var d=s[u],f=Fo.patternMatchVariance(n,d,e.MAX_INDIVIDUAL_VARIANCE);f<o&&(o=f,l=u)}if(l>=0)return l;throw new lr},e.MAX_AVG_VARIANCE=.48,e.MAX_INDIVIDUAL_VARIANCE=.7,e.START_END_PATTERN=Int32Array.from([1,1,1]),e.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),e.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])],e}(Fo),xUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vUe=function(){function t(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return t.prototype.decodeRow=function(e,r,n){var a=this.decodeRowStringBuffer,s=this.decodeMiddle(r,n,a),o=a.toString(),l=t.parseExtensionString(o),c=[new An((n[0]+n[1])/2,e),new An(s,e)],u=new dc(o,null,0,c,jn.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&u.putAllMetadata(l),u},t.prototype.decodeMiddle=function(e,r,n){var a,s,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var l=e.getSize(),c=r[1],u=0,d=0;d<5&&c<l;d++){var f=Gv.decodeDigit(e,o,c,Gv.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var A=(a=void 0,xUe(o)),h=A.next();!h.done;h=A.next()){var m=h.value;c+=m}}catch(x){a={error:x}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}f>=10&&(u|=1<<4-d),d!==4&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(n.length!==5)throw new lr;var p=this.determineCheckDigit(u);if(t.extensionChecksum(n.toString())!==p)throw new lr;return c},t.extensionChecksum=function(e){for(var r=e.length,n=0,a=r-2;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;n*=3;for(var a=r-1;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;return n*=3,n%10},t.prototype.determineCheckDigit=function(e){for(var r=0;r<10;r++)if(e===this.CHECK_DIGIT_ENCODINGS[r])return r;throw new lr},t.parseExtensionString=function(e){if(e.length!==5)return null;var r=t.parseExtension5String(e);return r==null?null:new Map([[Pl.SUGGESTED_PRICE,r]])},t.parseExtension5String=function(e){var r;switch(e.charAt(0)){case"0":r="";break;case"5":r="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}r="";break;default:r="";break}var n=parseInt(e.substring(1)),a=(n/100).toString(),s=n%100,o=s<10?"0"+s:s.toString();return r+a+"."+o},t}(),yUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},bUe=function(){function t(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return t.prototype.decodeRow=function(e,r,n){var a=this.decodeRowStringBuffer,s=this.decodeMiddle(r,n,a),o=a.toString(),l=t.parseExtensionString(o),c=[new An((n[0]+n[1])/2,e),new An(s,e)],u=new dc(o,null,0,c,jn.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&u.putAllMetadata(l),u},t.prototype.decodeMiddle=function(e,r,n){var a,s,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var l=e.getSize(),c=r[1],u=0,d=0;d<2&&c<l;d++){var f=Gv.decodeDigit(e,o,c,Gv.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var A=(a=void 0,yUe(o)),h=A.next();!h.done;h=A.next()){var m=h.value;c+=m}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}f>=10&&(u|=1<<1-d),d!==1&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(n.length!==2)throw new lr;if(parseInt(n.toString())%4!==u)throw new lr;return c},t.parseExtensionString=function(e){return e.length!==2?null:new Map([[Pl.ISSUE_NUMBER,parseInt(e)]])},t}(),wUe=function(){function t(){}return t.decodeRow=function(e,r,n){var a=Gv.findGuardPattern(r,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{var s=new vUe;return s.decodeRow(e,r,a)}catch{var o=new bUe;return o.decodeRow(e,r,a)}},t.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]),t}(),NUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Eo=function(t){NUe(e,t);function e(){var r=t.call(this)||this;r.decodeRowStringBuffer="",e.L_AND_G_PATTERNS=e.L_PATTERNS.map(function(l){return Int32Array.from(l)});for(var n=10;n<20;n++){for(var a=e.L_PATTERNS[n-10],s=new Int32Array(a.length),o=0;o<a.length;o++)s[o]=a[a.length-o-1];e.L_AND_G_PATTERNS[n]=s}return r}return e.prototype.decodeRow=function(r,n,a){var s=e.findStartGuardPattern(n),o=a==null?null:a.get(Ns.NEED_RESULT_POINT_CALLBACK);if(o!=null){var l=new An((s[0]+s[1])/2,r);o.foundPossibleResultPoint(l)}var c=this.decodeMiddle(n,s,this.decodeRowStringBuffer),u=c.rowOffset,d=c.resultString;if(o!=null){var f=new An(u,r);o.foundPossibleResultPoint(f)}var A=e.decodeEnd(n,u);if(o!=null){var h=new An((A[0]+A[1])/2,r);o.foundPossibleResultPoint(h)}var m=A[1],p=m+(m-A[0]);if(p>=n.getSize()||!n.isRange(m,p,!1))throw new lr;var x=d.toString();if(x.length<8)throw new qr;if(!e.checkChecksum(x))throw new lo;var v=(s[1]+s[0])/2,y=(A[1]+A[0])/2,b=this.getBarcodeFormat(),w=[new An(v,r),new An(y,r)],j=new dc(x,null,0,w,b,new Date().getTime()),I=0;try{var C=wUe.decodeRow(r,n,A[1]);j.putMetadata(Pl.UPC_EAN_EXTENSION,C.getText()),j.putAllMetadata(C.getResultMetadata()),j.addResultPoints(C.getResultPoints()),I=C.getText().length}catch{}var S=a==null?null:a.get(Ns.ALLOWED_EAN_EXTENSIONS);if(S!=null){var E=!1;for(var B in S)if(I.toString()===B){E=!0;break}if(!E)throw new lr}return b===jn.EAN_13||jn.UPC_A,j},e.checkChecksum=function(r){return e.checkStandardUPCEANChecksum(r)},e.checkStandardUPCEANChecksum=function(r){var n=r.length;if(n===0)return!1;var a=parseInt(r.charAt(n-1),10);return e.getStandardUPCEANChecksum(r.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(r){for(var n=r.length,a=0,s=n-1;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new qr;a+=o}a*=3;for(var s=n-2;s>=0;s-=2){var o=r.charAt(s).charCodeAt(0)-48;if(o<0||o>9)throw new qr;a+=o}return(1e3-a)%10},e.decodeEnd=function(r,n){return e.findGuardPattern(r,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e}(Gv),CUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),F$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},mF=function(t){CUe(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=Int32Array.from([0,0,0,0]),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l,c,u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;for(var d=r.getSize(),f=n[1],A=0,h=0;h<6&&f<d;h++){var m=Eo.decodeDigit(r,u,f,Eo.L_AND_G_PATTERNS);a+=String.fromCharCode(48+m%10);try{for(var p=(s=void 0,F$(u)),x=p.next();!x.done;x=p.next()){var v=x.value;f+=v}}catch(j){s={error:j}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}m>=10&&(A|=1<<5-h)}a=e.determineFirstDigit(a,A);var y=Eo.findGuardPattern(r,f,!0,Eo.MIDDLE_PATTERN,new Int32Array(Eo.MIDDLE_PATTERN.length).fill(0));f=y[1];for(var h=0;h<6&&f<d;h++){var m=Eo.decodeDigit(r,u,f,Eo.L_PATTERNS);a+=String.fromCharCode(48+m);try{for(var b=(l=void 0,F$(u)),w=b.next();!w.done;w=b.next()){var v=w.value;f+=v}}catch(C){l={error:C}}finally{try{w&&!w.done&&(c=b.return)&&c.call(b)}finally{if(l)throw l.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return jn.EAN_13},e.determineFirstDigit=function(r,n){for(var a=0;a<10;a++)if(n===this.FIRST_DIGIT_ENCODINGS[a])return r=String.fromCharCode(48+a)+r,r;throw new lr},e.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],e}(Eo),_Ue=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),O$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},D$=function(t){_Ue(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=Int32Array.from([0,0,0,0]),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l,c,u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;for(var d=r.getSize(),f=n[1],A=0;A<4&&f<d;A++){var h=Eo.decodeDigit(r,u,f,Eo.L_PATTERNS);a+=String.fromCharCode(48+h);try{for(var m=(s=void 0,O$(u)),p=m.next();!p.done;p=m.next()){var x=p.value;f+=x}}catch(w){s={error:w}}finally{try{p&&!p.done&&(o=m.return)&&o.call(m)}finally{if(s)throw s.error}}}var v=Eo.findGuardPattern(r,f,!0,Eo.MIDDLE_PATTERN,new Int32Array(Eo.MIDDLE_PATTERN.length).fill(0));f=v[1];for(var A=0;A<4&&f<d;A++){var h=Eo.decodeDigit(r,u,f,Eo.L_PATTERNS);a+=String.fromCharCode(48+h);try{for(var y=(l=void 0,O$(u)),b=y.next();!b.done;b=y.next()){var x=b.value;f+=x}}catch(I){l={error:I}}finally{try{b&&!b.done&&(c=y.return)&&c.call(y)}finally{if(l)throw l.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return jn.EAN_8},e}(Eo),EUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),R$=function(t){EUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.ean13Reader=new mF,r}return e.prototype.getBarcodeFormat=function(){return jn.UPC_A},e.prototype.decode=function(r,n){return this.maybeReturnResult(this.ean13Reader.decode(r))},e.prototype.decodeRow=function(r,n,a){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,n,a))},e.prototype.decodeMiddle=function(r,n,a){return this.ean13Reader.decodeMiddle(r,n,a)},e.prototype.maybeReturnResult=function(r){var n=r.getText();if(n.charAt(0)==="0"){var a=new dc(n.substring(1),null,null,r.getResultPoints(),jn.UPC_A);return r.getResultMetadata()!=null&&a.putAllMetadata(r.getResultMetadata()),a}else throw new lr},e.prototype.reset=function(){this.ean13Reader.reset()},e}(Eo),SUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),IUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},M$=function(t){SUe(e,t);function e(){var r=t.call(this)||this;return r.decodeMiddleCounters=new Int32Array(4),r}return e.prototype.decodeMiddle=function(r,n,a){var s,o,l=this.decodeMiddleCounters.map(function(x){return x});l[0]=0,l[1]=0,l[2]=0,l[3]=0;for(var c=r.getSize(),u=n[1],d=0,f=0;f<6&&u<c;f++){var A=e.decodeDigit(r,l,u,e.L_AND_G_PATTERNS);a+=String.fromCharCode(48+A%10);try{for(var h=(s=void 0,IUe(l)),m=h.next();!m.done;m=h.next()){var p=m.value;u+=p}}catch(x){s={error:x}}finally{try{m&&!m.done&&(o=h.return)&&o.call(h)}finally{if(s)throw s.error}}A>=10&&(d|=1<<5-f)}return e.determineNumSysAndCheckDigit(new ta(a),d),u},e.prototype.decodeEnd=function(r,n){return e.findGuardPatternWithoutCounters(r,n,!0,e.MIDDLE_END_PATTERN)},e.prototype.checkChecksum=function(r){return Eo.checkChecksum(e.convertUPCEtoUPCA(r))},e.determineNumSysAndCheckDigit=function(r,n){for(var a=0;a<=1;a++)for(var s=0;s<10;s++)if(n===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[a][s]){r.insert(0,"0"+a),r.append("0"+s);return}throw lr.getNotFoundInstance()},e.prototype.getBarcodeFormat=function(){return jn.UPC_E},e.convertUPCEtoUPCA=function(r){var n=r.slice(1,7).split("").map(function(o){return o.charCodeAt(0)}),a=new ta;a.append(r.charAt(0));var s=n[5];switch(s){case 0:case 1:case 2:a.appendChars(n,0,2),a.append(s),a.append("0000"),a.appendChars(n,2,3);break;case 3:a.appendChars(n,0,3),a.append("00000"),a.appendChars(n,3,2);break;case 4:a.appendChars(n,0,4),a.append("00000"),a.append(n[4]);break;default:a.appendChars(n,0,5),a.append("0000"),a.append(s);break}return r.length>=8&&a.append(r.charAt(7)),a.toString()},e.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],e}(Eo),jUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),L$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},q5=function(t){jUe(e,t);function e(r){var n=t.call(this)||this,a=r==null?null:r.get(Ns.POSSIBLE_FORMATS),s=[];return a!=null&&(a.indexOf(jn.EAN_13)>-1&&s.push(new mF),a.indexOf(jn.UPC_A)>-1&&s.push(new R$),a.indexOf(jn.EAN_8)>-1&&s.push(new D$),a.indexOf(jn.UPC_E)>-1&&s.push(new M$)),s.length===0&&(s.push(new mF),s.push(new R$),s.push(new D$),s.push(new M$)),n.readers=s,n}return e.prototype.decodeRow=function(r,n,a){var s,o;try{for(var l=L$(this.readers),c=l.next();!c.done;c=l.next()){var u=c.value;try{var d=u.decodeRow(r,n,a),f=d.getBarcodeFormat()===jn.EAN_13&&d.getText().charAt(0)==="0",A=a==null?null:a.get(Ns.POSSIBLE_FORMATS),h=A==null||A.includes(jn.UPC_A);if(f&&h){var m=d.getRawBytes(),p=new dc(d.getText().substring(1),m,m?m.length:null,d.getResultPoints(),jn.UPC_A);return p.putAllMetadata(d.getResultMetadata()),p}return d}catch{}}}catch(x){s={error:x}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(s)throw s.error}}throw new lr},e.prototype.reset=function(){var r,n;try{for(var a=L$(this.readers),s=a.next();!s.done;s=a.next()){var o=s.value;o.reset()}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e}(Fo),PUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),TUe=function(t){PUe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.CODA_BAR_CHAR_SET={nnnnnww:"0",nnnnwwn:"1",nnnwnnw:"2",wwnnnnn:"3",nnwnnwn:"4",wnnnnwn:"5",nwnnnnw:"6",nwnnwnn:"7",nwwnnnn:"8",wnnwnnn:"9",nnnwwnn:"-",nnwwnnn:"$",wnnnwnw:":",wnwnnnw:"/",wnwnwnn:".",nnwwwww:"+",nnwwnwn:"A",nwnwnnw:"B",nnnwnww:"C",nnnwwwn:"D"},r}return e.prototype.decodeRow=function(r,n,a){var s=this.getValidRowData(n);if(!s)throw new lr;var o=this.codaBarDecodeRow(s.row);if(!o)throw new lr;return new dc(o,null,0,[new An(s.left,r),new An(s.right,r)],jn.CODABAR,new Date().getTime())},e.prototype.getValidRowData=function(r){var n=r.toArray(),a=n.indexOf(!0);if(a===-1)return null;var s=n.lastIndexOf(!0);if(s<=a)return null;n=n.slice(a,s+1);for(var o=[],l=n[0],c=1,u=1;u<n.length;u++)n[u]===l?c++:(l=n[u],o.push(c),c=1);return o.push(c),o.length<23&&(o.length+1)%8!==0?null:{row:o,left:a,right:s}},e.prototype.codaBarDecodeRow=function(r){for(var n=[],a=Math.ceil(r.reduce(function(c,u){return(c+u)/2},0));r.length>0;){var s=r.splice(0,8).splice(0,7),o=s.map(function(c){return c<a?"n":"w"}).join("");if(this.CODA_BAR_CHAR_SET[o]===void 0)return null;n.push(this.CODA_BAR_CHAR_SET[o])}var l=n.join("");return this.validCodaBarString(l)?l:null},e.prototype.validCodaBarString=function(r){var n=/^[A-D].{1,}[A-D]$/;return n.test(r)},e}(Fo),BUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),kUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ap=function(t){BUe(e,t);function e(){var r=t.call(this)||this;return r.decodeFinderCounters=new Int32Array(4),r.dataCharacterCounters=new Int32Array(8),r.oddRoundingErrors=new Array(4),r.evenRoundingErrors=new Array(4),r.oddCounts=new Array(r.dataCharacterCounters.length/2),r.evenCounts=new Array(r.dataCharacterCounters.length/2),r}return e.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},e.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},e.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},e.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},e.prototype.getOddCounts=function(){return this.oddCounts},e.prototype.getEvenCounts=function(){return this.evenCounts},e.prototype.parseFinderValue=function(r,n){for(var a=0;a<n.length;a++)if(Fo.patternMatchVariance(r,n[a],e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return a;throw new lr},e.count=function(r){return ja.sum(new Int32Array(r))},e.increment=function(r,n){for(var a=0,s=n[0],o=1;o<r.length;o++)n[o]>s&&(s=n[o],a=o);r[a]++},e.decrement=function(r,n){for(var a=0,s=n[0],o=1;o<r.length;o++)n[o]<s&&(s=n[o],a=o);r[a]--},e.isFinderPattern=function(r){var n,a,s=r[0]+r[1],o=s+r[2]+r[3],l=s/o;if(l>=e.MIN_FINDER_PATTERN_RATIO&&l<=e.MAX_FINDER_PATTERN_RATIO){var c=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;try{for(var d=kUe(r),f=d.next();!f.done;f=d.next()){var A=f.value;A>u&&(u=A),A<c&&(c=A)}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}return u<10*c}return!1},e.MAX_AVG_VARIANCE=.2,e.MAX_INDIVIDUAL_VARIANCE=.45,e.MIN_FINDER_PATTERN_RATIO=9.5/12,e.MAX_FINDER_PATTERN_RATIO=12.5/14,e}(Fo),rI=function(){function t(e,r){this.value=e,this.checksumPortion=r}return t.prototype.getValue=function(){return this.value},t.prototype.getChecksumPortion=function(){return this.checksumPortion},t.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value&&this.checksumPortion===r.checksumPortion},t.prototype.hashCode=function(){return this.value^this.checksumPortion},t}(),Ese=function(){function t(e,r,n,a,s){this.value=e,this.startEnd=r,this.value=e,this.startEnd=r,this.resultPoints=new Array,this.resultPoints.push(new An(n,s)),this.resultPoints.push(new An(a,s))}return t.prototype.getValue=function(){return this.value},t.prototype.getStartEnd=function(){return this.startEnd},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.prototype.hashCode=function(){return this.value},t}(),FUe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Jx=function(){function t(){}return t.getRSSvalue=function(e,r,n){var a,s,o=0;try{for(var l=FUe(e),c=l.next();!c.done;c=l.next()){var u=c.value;o+=u}}catch(y){a={error:y}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}for(var d=0,f=0,A=e.length,h=0;h<A-1;h++){var m=void 0;for(m=1,f|=1<<h;m<e[h];m++,f&=~(1<<h)){var p=t.combins(o-m-1,A-h-2);if(n&&f===0&&o-m-(A-h-1)>=A-h-1&&(p-=t.combins(o-m-(A-h),A-h-2)),A-h-1>1){for(var x=0,v=o-m-(A-h-2);v>r;v--)x+=t.combins(o-m-v-1,A-h-3);p-=x*(A-1-h)}else o-m>r&&p--;d+=p}o-=m}return d},t.combins=function(e,r){var n,a;e-r>r?(a=r,n=e-r):(a=e-r,n=r);for(var s=1,o=1,l=e;l>n;l--)s*=l,o<=a&&(s/=o,o++);for(;o<=a;)s/=o,o++;return s},t}(),OUe=function(){function t(){}return t.buildBitArray=function(e){var r=e.length*2-1;e[e.length-1].getRightChar()==null&&(r-=1);for(var n=12*r,a=new tl(n),s=0,o=e[0],l=o.getRightChar().getValue(),c=11;c>=0;--c)l&1<<c&&a.set(s),s++;for(var c=1;c<e.length;++c){for(var u=e[c],d=u.getLeftChar().getValue(),f=11;f>=0;--f)d&1<<f&&a.set(s),s++;if(u.getRightChar()!==null)for(var A=u.getRightChar().getValue(),f=11;f>=0;--f)A&1<<f&&a.set(s),s++}return a},t}(),rp=function(){function t(e,r){r?this.decodedInformation=null:(this.finished=e,this.decodedInformation=r)}return t.prototype.getDecodedInformation=function(){return this.decodedInformation},t.prototype.isFinished=function(){return this.finished},t}(),QR=function(){function t(e){this.newPosition=e}return t.prototype.getNewPosition=function(){return this.newPosition},t}(),DUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Zd=function(t){DUe(e,t);function e(r,n){var a=t.call(this,r)||this;return a.value=n,a}return e.prototype.getValue=function(){return this.value},e.prototype.isFNC1=function(){return this.value===e.FNC1},e.FNC1="$",e}(QR),RUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),np=function(t){RUe(e,t);function e(r,n,a){var s=t.call(this,r)||this;return a?(s.remaining=!0,s.remainingValue=s.remainingValue):(s.remaining=!1,s.remainingValue=0),s.newString=n,s}return e.prototype.getNewString=function(){return this.newString},e.prototype.isRemaining=function(){return this.remaining},e.prototype.getRemainingValue=function(){return this.remainingValue},e}(QR),MUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),bx=function(t){MUe(e,t);function e(r,n,a){var s=t.call(this,r)||this;if(n<0||n>10||a<0||a>10)throw new qr;return s.firstDigit=n,s.secondDigit=a,s}return e.prototype.getFirstDigit=function(){return this.firstDigit},e.prototype.getSecondDigit=function(){return this.secondDigit},e.prototype.getValue=function(){return this.firstDigit*10+this.secondDigit},e.prototype.isFirstDigitFNC1=function(){return this.firstDigit===e.FNC1},e.prototype.isSecondDigitFNC1=function(){return this.secondDigit===e.FNC1},e.prototype.isAnyFNC1=function(){return this.firstDigit===e.FNC1||this.secondDigit===e.FNC1},e.FNC1=10,e}(QR),l_=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},LUe=function(){function t(){}return t.parseFieldsInGeneralPurpose=function(e){var r,n,a,s,o,l,c,u;if(!e)return null;if(e.length<2)throw new lr;var d=e.substring(0,2);try{for(var f=l_(t.TWO_DIGIT_DATA_LENGTH),A=f.next();!A.done;A=f.next()){var h=A.value;if(h[0]===d)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(2,h[2],e):t.processFixedAI(2,h[1],e)}}catch(I){r={error:I}}finally{try{A&&!A.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}if(e.length<3)throw new lr;var m=e.substring(0,3);try{for(var p=l_(t.THREE_DIGIT_DATA_LENGTH),x=p.next();!x.done;x=p.next()){var h=x.value;if(h[0]===m)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(3,h[2],e):t.processFixedAI(3,h[1],e)}}catch(I){a={error:I}}finally{try{x&&!x.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}try{for(var v=l_(t.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),y=v.next();!y.done;y=v.next()){var h=y.value;if(h[0]===m)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(4,h[2],e):t.processFixedAI(4,h[1],e)}}catch(I){o={error:I}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(o)throw o.error}}if(e.length<4)throw new lr;var b=e.substring(0,4);try{for(var w=l_(t.FOUR_DIGIT_DATA_LENGTH),j=w.next();!j.done;j=w.next()){var h=j.value;if(h[0]===b)return h[1]===t.VARIABLE_LENGTH?t.processVariableAI(4,h[2],e):t.processFixedAI(4,h[1],e)}}catch(I){c={error:I}}finally{try{j&&!j.done&&(u=w.return)&&u.call(w)}finally{if(c)throw c.error}}throw new lr},t.processFixedAI=function(e,r,n){if(n.length<e)throw new lr;var a=n.substring(0,e);if(n.length<e+r)throw new lr;var s=n.substring(e,e+r),o=n.substring(e+r),l="("+a+")"+s,c=t.parseFieldsInGeneralPurpose(o);return c==null?l:l+c},t.processVariableAI=function(e,r,n){var a=n.substring(0,e),s;n.length<e+r?s=n.length:s=e+r;var o=n.substring(e,s),l=n.substring(s),c="("+a+")"+o,u=t.parseFieldsInGeneralPurpose(l);return u==null?c:c+u},t.VARIABLE_LENGTH=[],t.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",t.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",t.VARIABLE_LENGTH,20],["22",t.VARIABLE_LENGTH,29],["30",t.VARIABLE_LENGTH,8],["37",t.VARIABLE_LENGTH,8],["90",t.VARIABLE_LENGTH,30],["91",t.VARIABLE_LENGTH,30],["92",t.VARIABLE_LENGTH,30],["93",t.VARIABLE_LENGTH,30],["94",t.VARIABLE_LENGTH,30],["95",t.VARIABLE_LENGTH,30],["96",t.VARIABLE_LENGTH,30],["97",t.VARIABLE_LENGTH,3],["98",t.VARIABLE_LENGTH,30],["99",t.VARIABLE_LENGTH,30]],t.THREE_DIGIT_DATA_LENGTH=[["240",t.VARIABLE_LENGTH,30],["241",t.VARIABLE_LENGTH,30],["242",t.VARIABLE_LENGTH,6],["250",t.VARIABLE_LENGTH,30],["251",t.VARIABLE_LENGTH,30],["253",t.VARIABLE_LENGTH,17],["254",t.VARIABLE_LENGTH,20],["400",t.VARIABLE_LENGTH,30],["401",t.VARIABLE_LENGTH,30],["402",17],["403",t.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",t.VARIABLE_LENGTH,20],["421",t.VARIABLE_LENGTH,15],["422",3],["423",t.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],t.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",t.VARIABLE_LENGTH,15],["391",t.VARIABLE_LENGTH,18],["392",t.VARIABLE_LENGTH,15],["393",t.VARIABLE_LENGTH,18],["703",t.VARIABLE_LENGTH,30]],t.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",t.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",t.VARIABLE_LENGTH,20],["8003",t.VARIABLE_LENGTH,30],["8004",t.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",t.VARIABLE_LENGTH,30],["8008",t.VARIABLE_LENGTH,12],["8018",18],["8020",t.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",t.VARIABLE_LENGTH,70],["8200",t.VARIABLE_LENGTH,70]],t}(),yE=function(){function t(e){this.buffer=new ta,this.information=e}return t.prototype.decodeAllCodes=function(e,r){var n=r,a=null;do{var s=this.decodeGeneralPurposeField(n,a),o=LUe.parseFieldsInGeneralPurpose(s.getNewString());if(o!=null&&e.append(o),s.isRemaining()?a=""+s.getRemainingValue():a=null,n===s.getNewPosition())break;n=s.getNewPosition()}while(!0);return e.toString()},t.prototype.isStillNumeric=function(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(var r=e;r<e+3;++r)if(this.information.get(r))return!0;return this.information.get(e+3)},t.prototype.decodeNumeric=function(e){if(e+7>this.information.getSize()){var r=this.extractNumericValueFromBitArray(e,4);return r===0?new bx(this.information.getSize(),bx.FNC1,bx.FNC1):new bx(this.information.getSize(),r-1,bx.FNC1)}var n=this.extractNumericValueFromBitArray(e,7),a=(n-8)/11,s=(n-8)%11;return new bx(e+7,a,s)},t.prototype.extractNumericValueFromBitArray=function(e,r){return t.extractNumericValueFromBitArray(this.information,e,r)},t.extractNumericValueFromBitArray=function(e,r,n){for(var a=0,s=0;s<n;++s)e.get(r+s)&&(a|=1<<n-s-1);return a},t.prototype.decodeGeneralPurposeField=function(e,r){this.buffer.setLengthToZero(),r!=null&&this.buffer.append(r),this.current.setPosition(e);var n=this.parseBlocks();return n!=null&&n.isRemaining()?new np(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new np(this.current.getPosition(),this.buffer.toString())},t.prototype.parseBlocks=function(){var e,r;do{var n=this.current.getPosition();this.current.isAlpha()?(r=this.parseAlphaBlock(),e=r.isFinished()):this.current.isIsoIec646()?(r=this.parseIsoIec646Block(),e=r.isFinished()):(r=this.parseNumericBlock(),e=r.isFinished());var a=n!==this.current.getPosition();if(!a&&!e)break}while(!e);return r.getDecodedInformation()},t.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){var r=void 0;return e.isSecondDigitFNC1()?r=new np(this.current.getPosition(),this.buffer.toString()):r=new np(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new rp(!0,r)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){var r=new np(this.current.getPosition(),this.buffer.toString());return new rp(!0,r)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new rp(!1)},t.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var r=new np(this.current.getPosition(),this.buffer.toString());return new rp(!0,r)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new rp(!1)},t.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var r=new np(this.current.getPosition(),this.buffer.toString());return new rp(!0,r)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new rp(!1)},t.prototype.isStillIsoIec646=function(e){if(e+5>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,5);if(r>=5&&r<16)return!0;if(e+7>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;var a=this.extractNumericValueFromBitArray(e,8);return a>=232&&a<253},t.prototype.decodeIsoIec646=function(e){var r=this.extractNumericValueFromBitArray(e,5);if(r===15)return new Zd(e+5,Zd.FNC1);if(r>=5&&r<15)return new Zd(e+5,"0"+(r-5));var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new Zd(e+7,""+(n+1));if(n>=90&&n<116)return new Zd(e+7,""+(n+7));var a=this.extractNumericValueFromBitArray(e,8),s;switch(a){case 232:s="!";break;case 233:s='"';break;case 234:s="%";break;case 235:s="&";break;case 236:s="'";break;case 237:s="(";break;case 238:s=")";break;case 239:s="*";break;case 240:s="+";break;case 241:s=",";break;case 242:s="-";break;case 243:s=".";break;case 244:s="/";break;case 245:s=":";break;case 246:s=";";break;case 247:s="<";break;case 248:s="=";break;case 249:s=">";break;case 250:s="?";break;case 251:s="_";break;case 252:s=" ";break;default:throw new qr}return new Zd(e+8,s)},t.prototype.isStillAlpha=function(e){if(e+5>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(e,5);if(r>=5&&r<16)return!0;if(e+6>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63},t.prototype.decodeAlphanumeric=function(e){var r=this.extractNumericValueFromBitArray(e,5);if(r===15)return new Zd(e+5,Zd.FNC1);if(r>=5&&r<15)return new Zd(e+5,"0"+(r-5));var n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new Zd(e+6,""+(n+33));var a;switch(n){case 58:a="*";break;case 59:a=",";break;case 60:a="-";break;case 61:a=".";break;case 62:a="/";break;default:throw new zw("Decoding invalid alphanumeric value: "+n)}return new Zd(e+6,a)},t.prototype.isAlphaTo646ToAlphaLatch=function(e){if(e+1>this.information.getSize())return!1;for(var r=0;r<5&&r+e<this.information.getSize();++r)if(r===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+r))return!1;return!0},t.prototype.isAlphaOr646ToNumericLatch=function(e){if(e+3>this.information.getSize())return!1;for(var r=e;r<e+3;++r)if(this.information.get(r))return!1;return!0},t.prototype.isNumericToAlphaNumericLatch=function(e){if(e+1>this.information.getSize())return!1;for(var r=0;r<4&&r+e<this.information.getSize();++r)if(this.information.get(e+r))return!1;return!0},t}(),Sse=function(){function t(e){this.information=e,this.generalDecoder=new yE(e)}return t.prototype.getInformation=function(){return this.information},t.prototype.getGeneralDecoder=function(){return this.generalDecoder},t}(),UUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lf=function(t){UUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.encodeCompressedGtin=function(r,n){r.append("(01)");var a=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,n,a)},e.prototype.encodeCompressedGtinWithoutAI=function(r,n,a){for(var s=0;s<4;++s){var o=this.getGeneralDecoder().extractNumericValueFromBitArray(n+10*s,10);o/100===0&&r.append("0"),o/10===0&&r.append("0"),r.append(o)}e.appendCheckDigit(r,a)},e.appendCheckDigit=function(r,n){for(var a=0,s=0;s<13;s++){var o=r.charAt(s+n).charCodeAt(0)-48;a+=s&1?o:3*o}a=10-a%10,a===10&&(a=0),r.append(a)},e.GTIN_SIZE=40,e}(Sse),QUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),VUe=function(t){QUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){var r=new ta;r.append("(01)");var n=r.length(),a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE,4);return r.append(a),this.encodeCompressedGtinWithoutAI(r,e.HEADER_SIZE+4,n),this.getGeneralDecoder().decodeAllCodes(r,e.HEADER_SIZE+44)},e.HEADER_SIZE=4,e}(lf),HUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$Ue=function(t){HUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){var r=new ta;return this.getGeneralDecoder().decodeAllCodes(r,e.HEADER_SIZE)},e.HEADER_SIZE=5,e}(Sse),GUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),bE=function(t){GUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.encodeCompressedWeight=function(r,n,a){var s=this.getGeneralDecoder().extractNumericValueFromBitArray(n,a);this.addWeightCode(r,s);for(var o=this.checkWeight(s),l=1e5,c=0;c<5;++c)o/l===0&&r.append("0"),l/=10;r.append(o)},e}(lf),KUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ise=function(t){KUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+bE.GTIN_SIZE+e.WEIGHT_SIZE)throw new lr;var r=new ta;return this.encodeCompressedGtin(r,e.HEADER_SIZE),this.encodeCompressedWeight(r,e.HEADER_SIZE+bE.GTIN_SIZE,e.WEIGHT_SIZE),r.toString()},e.HEADER_SIZE=5,e.WEIGHT_SIZE=15,e}(bE),qUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),zUe=function(t){qUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.addWeightCode=function(r,n){r.append("(3103)")},e.prototype.checkWeight=function(r){return r},e}(Ise),WUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),XUe=function(t){WUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.addWeightCode=function(r,n){n<1e4?r.append("(3202)"):r.append("(3203)")},e.prototype.checkWeight=function(r){return r<1e4?r:r-1e4},e}(Ise),YUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),JUe=function(t){YUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+lf.GTIN_SIZE)throw new lr;var r=new ta;this.encodeCompressedGtin(r,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+lf.GTIN_SIZE,e.LAST_DIGIT_SIZE);r.append("(392"),r.append(n),r.append(")");var a=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+lf.GTIN_SIZE+e.LAST_DIGIT_SIZE,null);return r.append(a.getNewString()),r.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e}(lf),ZUe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),e7e=function(t){ZUe(e,t);function e(r){return t.call(this,r)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+lf.GTIN_SIZE)throw new lr;var r=new ta;this.encodeCompressedGtin(r,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+lf.GTIN_SIZE,e.LAST_DIGIT_SIZE);r.append("(393"),r.append(n),r.append(")");var a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+lf.GTIN_SIZE+e.LAST_DIGIT_SIZE,e.FIRST_THREE_DIGITS_SIZE);a/100===0&&r.append("0"),a/10===0&&r.append("0"),r.append(a);var s=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+lf.GTIN_SIZE+e.LAST_DIGIT_SIZE+e.FIRST_THREE_DIGITS_SIZE,null);return r.append(s.getNewString()),r.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e.FIRST_THREE_DIGITS_SIZE=10,e}(lf),t7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),v0=function(t){t7e(e,t);function e(r,n,a){var s=t.call(this,r)||this;return s.dateCode=a,s.firstAIdigits=n,s}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE+e.DATE_SIZE)throw new lr;var r=new ta;return this.encodeCompressedGtin(r,e.HEADER_SIZE),this.encodeCompressedWeight(r,e.HEADER_SIZE+e.GTIN_SIZE,e.WEIGHT_SIZE),this.encodeCompressedDate(r,e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE),r.toString()},e.prototype.encodeCompressedDate=function(r,n){var a=this.getGeneralDecoder().extractNumericValueFromBitArray(n,e.DATE_SIZE);if(a!==38400){r.append("("),r.append(this.dateCode),r.append(")");var s=a%32;a/=32;var o=a%12+1;a/=12;var l=a;l/10===0&&r.append("0"),r.append(l),o/10===0&&r.append("0"),r.append(o),s/10===0&&r.append("0"),r.append(s)}},e.prototype.addWeightCode=function(r,n){r.append("("),r.append(this.firstAIdigits),r.append(n/1e5),r.append(")")},e.prototype.checkWeight=function(r){return r%1e5},e.HEADER_SIZE=8,e.WEIGHT_SIZE=20,e.DATE_SIZE=16,e}(bE);function r7e(t){try{if(t.get(1))return new VUe(t);if(!t.get(2))return new $Ue(t);var e=yE.extractNumericValueFromBitArray(t,1,4);switch(e){case 4:return new zUe(t);case 5:return new XUe(t)}var r=yE.extractNumericValueFromBitArray(t,1,5);switch(r){case 12:return new JUe(t);case 13:return new e7e(t)}var n=yE.extractNumericValueFromBitArray(t,1,7);switch(n){case 56:return new v0(t,"310","11");case 57:return new v0(t,"320","11");case 58:return new v0(t,"310","13");case 59:return new v0(t,"320","13");case 60:return new v0(t,"310","15");case 61:return new v0(t,"320","15");case 62:return new v0(t,"310","17");case 63:return new v0(t,"320","17")}}catch(a){throw console.log(a),new zw("unknown decoder: "+t)}}var U$=function(){function t(e,r,n,a){this.leftchar=e,this.rightchar=r,this.finderpattern=n,this.maybeLast=a}return t.prototype.mayBeLast=function(){return this.maybeLast},t.prototype.getLeftChar=function(){return this.leftchar},t.prototype.getRightChar=function(){return this.rightchar},t.prototype.getFinderPattern=function(){return this.finderpattern},t.prototype.mustBeLast=function(){return this.rightchar==null},t.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"},t.equals=function(e,r){return e instanceof t?t.equalsOrNull(e.leftchar,r.leftchar)&&t.equalsOrNull(e.rightchar,r.rightchar)&&t.equalsOrNull(e.finderpattern,r.finderpattern):!1},t.equalsOrNull=function(e,r){return e===null?r===null:t.equals(e,r)},t.prototype.hashCode=function(){var e=this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue();return e},t}(),n7e=function(){function t(e,r,n){this.pairs=e,this.rowNumber=r,this.wasReversed=n}return t.prototype.getPairs=function(){return this.pairs},t.prototype.getRowNumber=function(){return this.rowNumber},t.prototype.isReversed=function(){return this.wasReversed},t.prototype.isEquivalent=function(e){return this.checkEqualitity(this,e)},t.prototype.toString=function(){return"{ "+this.pairs+" }"},t.prototype.equals=function(e,r){return e instanceof t?this.checkEqualitity(e,r)&&e.wasReversed===r.wasReversed:!1},t.prototype.checkEqualitity=function(e,r){if(!(!e||!r)){var n;return e.forEach(function(a,s){r.forEach(function(o){a.getLeftChar().getValue()===o.getLeftChar().getValue()&&a.getRightChar().getValue()===o.getRightChar().getValue()&&a.getFinderPatter().getValue()===o.getFinderPatter().getValue()&&(n=!0)})}),n}},t}(),a7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),y0=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s7e=function(t){a7e(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.pairs=new Array(e.MAX_PAIRS),r.rows=new Array,r.startEnd=[2],r}return e.prototype.decodeRow=function(r,n,a){this.pairs.length=0,this.startFromEven=!1;try{return e.constructResult(this.decodeRow2pairs(r,n))}catch{}return this.pairs.length=0,this.startFromEven=!0,e.constructResult(this.decodeRow2pairs(r,n))},e.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},e.prototype.decodeRow2pairs=function(r,n){for(var a=!1;!a;)try{this.pairs.push(this.retrieveNextPair(n,this.pairs,r))}catch(l){if(l instanceof lr){if(!this.pairs.length)throw new lr;a=!0}}if(this.checkChecksum())return this.pairs;var s;if(this.rows.length?s=!0:s=!1,this.storeRow(r,!1),s){var o=this.checkRowsBoolean(!1);if(o!=null||(o=this.checkRowsBoolean(!0),o!=null))return o}throw new lr},e.prototype.checkRowsBoolean=function(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());var n=null;try{n=this.checkRows(new Array,0)}catch(a){console.log(a)}return r&&(this.rows=this.rows.reverse()),n},e.prototype.checkRows=function(r,n){for(var a,s,o=n;o<this.rows.length;o++){var l=this.rows[o];this.pairs.length=0;try{for(var c=(a=void 0,y0(r)),u=c.next();!u.done;u=c.next()){var d=u.value;this.pairs.push(d.getPairs())}}catch(A){a={error:A}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}if(this.pairs.push(l.getPairs()),!!e.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var f=new Array(r);f.push(l);try{return this.checkRows(f,o+1)}catch(A){console.log(A)}}}throw new lr},e.isValidSequence=function(r){var n,a;try{for(var s=y0(e.FINDER_PATTERN_SEQUENCES),o=s.next();!o.done;o=s.next()){var l=o.value;if(!(r.length>l.length)){for(var c=!0,u=0;u<r.length;u++)if(r[u].getFinderPattern().getValue()!==l[u]){c=!1;break}if(c)return!0}}}catch(d){n={error:d}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return!1},e.prototype.storeRow=function(r,n){for(var a=0,s=!1,o=!1;a<this.rows.length;){var l=this.rows[a];if(l.getRowNumber()>r){o=l.isEquivalent(this.pairs);break}s=l.isEquivalent(this.pairs),a++}o||s||e.isPartialRow(this.pairs,this.rows)||(this.rows.push(a,new n7e(this.pairs,r,n)),this.removePartialRows(this.pairs,this.rows))},e.prototype.removePartialRows=function(r,n){var a,s,o,l,c,u;try{for(var d=y0(n),f=d.next();!f.done;f=d.next()){var A=f.value;if(A.getPairs().length!==r.length){var h=!0;try{for(var m=(o=void 0,y0(A.getPairs())),p=m.next();!p.done;p=m.next()){var x=p.value,v=!1;try{for(var y=(c=void 0,y0(r)),b=y.next();!b.done;b=y.next()){var w=b.value;if(U$.equals(x,w)){v=!0;break}}}catch(j){c={error:j}}finally{try{b&&!b.done&&(u=y.return)&&u.call(y)}finally{if(c)throw c.error}}v||(h=!1)}}catch(j){o={error:j}}finally{try{p&&!p.done&&(l=m.return)&&l.call(m)}finally{if(o)throw o.error}}}}}catch(j){a={error:j}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}},e.isPartialRow=function(r,n){var a,s,o,l,c,u;try{for(var d=y0(n),f=d.next();!f.done;f=d.next()){var A=f.value,h=!0;try{for(var m=(o=void 0,y0(r)),p=m.next();!p.done;p=m.next()){var x=p.value,v=!1;try{for(var y=(c=void 0,y0(A.getPairs())),b=y.next();!b.done;b=y.next()){var w=b.value;if(x.equals(w)){v=!0;break}}}catch(j){c={error:j}}finally{try{b&&!b.done&&(u=y.return)&&u.call(y)}finally{if(c)throw c.error}}if(!v){h=!1;break}}}catch(j){o={error:j}}finally{try{p&&!p.done&&(l=m.return)&&l.call(m)}finally{if(o)throw o.error}}if(h)return!0}}catch(j){a={error:j}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}return!1},e.prototype.getRows=function(){return this.rows},e.constructResult=function(r){var n=OUe.buildBitArray(r),a=r7e(n),s=a.parseInformation(),o=r[0].getFinderPattern().getResultPoints(),l=r[r.length-1].getFinderPattern().getResultPoints(),c=[o[0],o[1],l[0],l[1]];return new dc(s,null,null,c,jn.RSS_EXPANDED,null)},e.prototype.checkChecksum=function(){var r=this.pairs.get(0),n=r.getLeftChar(),a=r.getRightChar();if(a===null)return!1;for(var s=a.getChecksumPortion(),o=2,l=1;l<this.pairs.size();++l){var c=this.pairs.get(l);s+=c.getLeftChar().getChecksumPortion(),o++;var u=c.getRightChar();u!=null&&(s+=u.getChecksumPortion(),o++)}s%=211;var d=211*(o-4)+s;return d===n.getValue()},e.getNextSecondBar=function(r,n){var a;return r.get(n)?(a=r.getNextUnset(n),a=r.getNextSet(a)):(a=r.getNextSet(n),a=r.getNextUnset(a)),a},e.prototype.retrieveNextPair=function(r,n,a){var s=n.length%2===0;this.startFromEven&&(s=!s);var o,l=!0,c=-1;do this.findNextPair(r,n,c),o=this.parseFoundFinderPattern(r,a,s),o===null?c=e.getNextSecondBar(r,this.startEnd[0]):l=!1;while(l);var u=this.decodeDataCharacter(r,o,s,!0);if(!this.isEmptyPair(n)&&n[n.length-1].mustBeLast())throw new lr;var d;try{d=this.decodeDataCharacter(r,o,s,!1)}catch(f){d=null,console.log(f)}return new U$(u,d,o,!0)},e.prototype.isEmptyPair=function(r){return r.length===0},e.prototype.findNextPair=function(r,n,a){var s=this.getDecodeFinderCounters();s[0]=0,s[1]=0,s[2]=0,s[3]=0;var o=r.getSize(),l;if(a>=0)l=a;else if(this.isEmptyPair(n))l=0;else{var c=n[n.length-1];l=c.getFinderPattern().getStartEnd()[1]}var u=n.length%2!==0;this.startFromEven&&(u=!u);for(var d=!1;l<o&&(d=!r.get(l),!!d);)l++;for(var f=0,A=l,h=l;h<o;h++)if(r.get(h)!==d)s[f]++;else{if(f===3){if(u&&e.reverseCounters(s),e.isFinderPattern(s)){this.startEnd[0]=A,this.startEnd[1]=h;return}u&&e.reverseCounters(s),A+=s[0]+s[1],s[0]=s[2],s[1]=s[3],s[2]=0,s[3]=0,f--}else f++;s[f]=1,d=!d}throw new lr},e.reverseCounters=function(r){for(var n=r.length,a=0;a<n/2;++a){var s=r[a];r[a]=r[n-a-1],r[n-a-1]=s}},e.prototype.parseFoundFinderPattern=function(r,n,a){var s,o,l;if(a){for(var c=this.startEnd[0]-1;c>=0&&!r.get(c);)c--;c++,s=this.startEnd[0]-c,o=c,l=this.startEnd[1]}else o=this.startEnd[0],l=r.getNextUnset(this.startEnd[1]+1),s=l-this.startEnd[1];var u=this.getDecodeFinderCounters();ws.arraycopy(u,0,u,1,u.length-1),u[0]=s;var d;try{d=this.parseFinderValue(u,e.FINDER_PATTERNS)}catch{return null}return new Ese(d,[o,l],o,l,n)},e.prototype.decodeDataCharacter=function(r,n,a,s){for(var o=this.getDataCharacterCounters(),l=0;l<o.length;l++)o[l]=0;if(s)e.recordPatternInReverse(r,n.getStartEnd()[0],o);else{e.recordPattern(r,n.getStartEnd()[1],o);for(var c=0,u=o.length-1;c<u;c++,u--){var d=o[c];o[c]=o[u],o[u]=d}}var f=17,A=ja.sum(new Int32Array(o))/f,h=(n.getStartEnd()[1]-n.getStartEnd()[0])/15;if(Math.abs(A-h)/h>.3)throw new lr;for(var m=this.getOddCounts(),p=this.getEvenCounts(),x=this.getOddRoundingErrors(),v=this.getEvenRoundingErrors(),c=0;c<o.length;c++){var y=1*o[c]/A,b=y+.5;if(b<1){if(y<.3)throw new lr;b=1}else if(b>8){if(y>8.7)throw new lr;b=8}var w=c/2;c&1?(p[w]=b,v[w]=y-b):(m[w]=b,x[w]=y-b)}this.adjustOddEvenCounts(f);for(var j=4*n.getValue()+(a?0:2)+(s?0:1)-1,I=0,C=0,c=m.length-1;c>=0;c--){if(e.isNotA1left(n,a,s)){var S=e.WEIGHTS[j][2*c];C+=m[c]*S}I+=m[c]}for(var E=0,c=p.length-1;c>=0;c--)if(e.isNotA1left(n,a,s)){var S=e.WEIGHTS[j][2*c+1];E+=p[c]*S}var B=C+E;if(I&1||I>13||I<4)throw new lr;var k=(13-I)/2,T=e.SYMBOL_WIDEST[k],P=9-T,K=Jx.getRSSvalue(m,T,!0),le=Jx.getRSSvalue(p,P,!1),oe=e.EVEN_TOTAL_SUBSET[k],ie=e.GSUM[k],Ae=K*oe+le+ie;return new rI(Ae,B)},e.isNotA1left=function(r,n,a){return!(r.getValue()===0&&n&&a)},e.prototype.adjustOddEvenCounts=function(r){var n=ja.sum(new Int32Array(this.getOddCounts())),a=ja.sum(new Int32Array(this.getEvenCounts())),s=!1,o=!1;n>13?o=!0:n<4&&(s=!0);var l=!1,c=!1;a>13?c=!0:a<4&&(l=!0);var u=n+a-r,d=(n&1)===1,f=(a&1)===0;if(u===1)if(d){if(f)throw new lr;o=!0}else{if(!f)throw new lr;c=!0}else if(u===-1)if(d){if(f)throw new lr;s=!0}else{if(!f)throw new lr;l=!0}else if(u===0){if(d){if(!f)throw new lr;n<a?(s=!0,c=!0):(o=!0,l=!0)}else if(f)throw new lr}else throw new lr;if(s){if(o)throw new lr;e.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&e.decrement(this.getOddCounts(),this.getOddRoundingErrors()),l){if(c)throw new lr;e.increment(this.getEvenCounts(),this.getOddRoundingErrors())}c&&e.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.SYMBOL_WIDEST=[7,5,4,3,1],e.EVEN_TOTAL_SUBSET=[4,20,52,104,204],e.GSUM=[0,348,1388,2948,3988],e.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],e.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],e.FINDER_PAT_A=0,e.FINDER_PAT_B=1,e.FINDER_PAT_C=2,e.FINDER_PAT_D=3,e.FINDER_PAT_E=4,e.FINDER_PAT_F=5,e.FINDER_PATTERN_SEQUENCES=[[e.FINDER_PAT_A,e.FINDER_PAT_A],[e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B],[e.FINDER_PAT_A,e.FINDER_PAT_C,e.FINDER_PAT_B,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_C],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F]],e.MAX_PAIRS=11,e}(Ap),i7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),o7e=function(t){i7e(e,t);function e(r,n,a){var s=t.call(this,r,n)||this;return s.count=0,s.finderPattern=a,s}return e.prototype.getFinderPattern=function(){return this.finderPattern},e.prototype.getCount=function(){return this.count},e.prototype.incrementCount=function(){this.count++},e}(rI),l7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),z5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Q$=function(t){l7e(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.possibleLeftPairs=[],r.possibleRightPairs=[],r}return e.prototype.decodeRow=function(r,n,a){var s,o,l,c,u=this.decodePair(n,!1,r,a);e.addOrTally(this.possibleLeftPairs,u),n.reverse();var d=this.decodePair(n,!0,r,a);e.addOrTally(this.possibleRightPairs,d),n.reverse();try{for(var f=z5(this.possibleLeftPairs),A=f.next();!A.done;A=f.next()){var h=A.value;if(h.getCount()>1)try{for(var m=(l=void 0,z5(this.possibleRightPairs)),p=m.next();!p.done;p=m.next()){var x=p.value;if(x.getCount()>1&&e.checkChecksum(h,x))return e.constructResult(h,x)}}catch(v){l={error:v}}finally{try{p&&!p.done&&(c=m.return)&&c.call(m)}finally{if(l)throw l.error}}}}catch(v){s={error:v}}finally{try{A&&!A.done&&(o=f.return)&&o.call(f)}finally{if(s)throw s.error}}throw new lr},e.addOrTally=function(r,n){var a,s;if(n!=null){var o=!1;try{for(var l=z5(r),c=l.next();!c.done;c=l.next()){var u=c.value;if(u.getValue()===n.getValue()){u.incrementCount(),o=!0;break}}}catch(d){a={error:d}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}o||r.push(n)}},e.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},e.constructResult=function(r,n){for(var a=4537077*r.getValue()+n.getValue(),s=new String(a).toString(),o=new ta,l=13-s.length;l>0;l--)o.append("0");o.append(s);for(var c=0,l=0;l<13;l++){var u=o.charAt(l).charCodeAt(0)-48;c+=l&1?u:3*u}c=10-c%10,c===10&&(c=0),o.append(c.toString());var d=r.getFinderPattern().getResultPoints(),f=n.getFinderPattern().getResultPoints();return new dc(o.toString(),null,0,[d[0],d[1],f[0],f[1]],jn.RSS_14,new Date().getTime())},e.checkChecksum=function(r,n){var a=(r.getChecksumPortion()+16*n.getChecksumPortion())%79,s=9*r.getFinderPattern().getValue()+n.getFinderPattern().getValue();return s>72&&s--,s>8&&s--,a===s},e.prototype.decodePair=function(r,n,a,s){try{var o=this.findFinderPattern(r,n),l=this.parseFoundFinderPattern(r,a,n,o),c=s==null?null:s.get(Ns.NEED_RESULT_POINT_CALLBACK);if(c!=null){var u=(o[0]+o[1])/2;n&&(u=r.getSize()-1-u),c.foundPossibleResultPoint(new An(u,a))}var d=this.decodeDataCharacter(r,l,!0),f=this.decodeDataCharacter(r,l,!1);return new o7e(1597*d.getValue()+f.getValue(),d.getChecksumPortion()+4*f.getChecksumPortion(),l)}catch{return null}},e.prototype.decodeDataCharacter=function(r,n,a){for(var s=this.getDataCharacterCounters(),o=0;o<s.length;o++)s[o]=0;if(a)Fo.recordPatternInReverse(r,n.getStartEnd()[0],s);else{Fo.recordPattern(r,n.getStartEnd()[1]+1,s);for(var l=0,c=s.length-1;l<c;l++,c--){var u=s[l];s[l]=s[c],s[c]=u}}for(var d=a?16:15,f=ja.sum(new Int32Array(s))/d,A=this.getOddCounts(),h=this.getEvenCounts(),m=this.getOddRoundingErrors(),p=this.getEvenRoundingErrors(),l=0;l<s.length;l++){var x=s[l]/f,v=Math.floor(x+.5);v<1?v=1:v>8&&(v=8);var y=Math.floor(l/2);l&1?(h[y]=v,p[y]=x-v):(A[y]=v,m[y]=x-v)}this.adjustOddEvenCounts(a,d);for(var b=0,w=0,l=A.length-1;l>=0;l--)w*=9,w+=A[l],b+=A[l];for(var j=0,I=0,l=h.length-1;l>=0;l--)j*=9,j+=h[l],I+=h[l];var C=w+3*j;if(a){if(b&1||b>12||b<4)throw new lr;var S=(12-b)/2,E=e.OUTSIDE_ODD_WIDEST[S],B=9-E,k=Jx.getRSSvalue(A,E,!1),T=Jx.getRSSvalue(h,B,!0),P=e.OUTSIDE_EVEN_TOTAL_SUBSET[S],K=e.OUTSIDE_GSUM[S];return new rI(k*P+T+K,C)}else{if(I&1||I>10||I<4)throw new lr;var S=(10-I)/2,E=e.INSIDE_ODD_WIDEST[S],B=9-E,k=Jx.getRSSvalue(A,E,!0),T=Jx.getRSSvalue(h,B,!1),le=e.INSIDE_ODD_TOTAL_SUBSET[S],K=e.INSIDE_GSUM[S];return new rI(T*le+k+K,C)}},e.prototype.findFinderPattern=function(r,n){var a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;for(var s=r.getSize(),o=!1,l=0;l<s&&(o=!r.get(l),n!==o);)l++;for(var c=0,u=l,d=l;d<s;d++)if(r.get(d)!==o)a[c]++;else{if(c===3){if(Ap.isFinderPattern(a))return[u,d];u+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,c--}else c++;a[c]=1,o=!o}throw new lr},e.prototype.parseFoundFinderPattern=function(r,n,a,s){for(var o=r.get(s[0]),l=s[0]-1;l>=0&&o!==r.get(l);)l--;l++;var c=s[0]-l,u=this.getDecodeFinderCounters(),d=new Int32Array(u.length);ws.arraycopy(u,0,d,1,u.length-1),d[0]=c;var f=this.parseFinderValue(d,e.FINDER_PATTERNS),A=l,h=s[1];return a&&(A=r.getSize()-1-A,h=r.getSize()-1-h),new Ese(f,[l,s[1]],A,h,n)},e.prototype.adjustOddEvenCounts=function(r,n){var a=ja.sum(new Int32Array(this.getOddCounts())),s=ja.sum(new Int32Array(this.getEvenCounts())),o=!1,l=!1,c=!1,u=!1;r?(a>12?l=!0:a<4&&(o=!0),s>12?u=!0:s<4&&(c=!0)):(a>11?l=!0:a<5&&(o=!0),s>10?u=!0:s<4&&(c=!0));var d=a+s-n,f=(a&1)===(r?1:0),A=(s&1)===1;if(d===1)if(f){if(A)throw new lr;l=!0}else{if(!A)throw new lr;u=!0}else if(d===-1)if(f){if(A)throw new lr;o=!0}else{if(!A)throw new lr;c=!0}else if(d===0){if(f){if(!A)throw new lr;a<s?(o=!0,u=!0):(l=!0,c=!0)}else if(A)throw new lr}else throw new lr;if(o){if(l)throw new lr;Ap.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(l&&Ap.decrement(this.getOddCounts(),this.getOddRoundingErrors()),c){if(u)throw new lr;Ap.increment(this.getEvenCounts(),this.getOddRoundingErrors())}u&&Ap.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],e.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],e.OUTSIDE_GSUM=[0,161,961,2015,2715],e.INSIDE_GSUM=[0,336,1036,1516],e.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],e.INSIDE_ODD_WIDEST=[2,4,6,8],e.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],e}(Ap),c7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Zx=function(t){c7e(e,t);function e(r){var n=t.call(this)||this;n.readers=[];var a=r?r.get(Ns.POSSIBLE_FORMATS):null,s=r&&r.get(Ns.ASSUME_CODE_39_CHECK_DIGIT)!==void 0,o=r&&r.get(Ns.ENABLE_CODE_39_EXTENDED_MODE)!==void 0;return a&&((a.includes(jn.EAN_13)||a.includes(jn.UPC_A)||a.includes(jn.EAN_8)||a.includes(jn.UPC_E))&&n.readers.push(new q5(r)),a.includes(jn.CODE_39)&&n.readers.push(new T$(s,o)),a.includes(jn.CODE_93)&&n.readers.push(new B$),a.includes(jn.CODE_128)&&n.readers.push(new P$),a.includes(jn.ITF)&&n.readers.push(new k$),a.includes(jn.CODABAR)&&n.readers.push(new TUe),a.includes(jn.RSS_14)&&n.readers.push(new Q$),a.includes(jn.RSS_EXPANDED)&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),n.readers.push(new s7e))),n.readers.length===0&&(n.readers.push(new q5(r)),n.readers.push(new T$),n.readers.push(new B$),n.readers.push(new q5(r)),n.readers.push(new P$),n.readers.push(new k$),n.readers.push(new Q$)),n}return e.prototype.decodeRow=function(r,n,a){for(var s=0;s<this.readers.length;s++)try{return this.readers[s].decodeRow(r,n,a)}catch{}throw new lr},e.prototype.reset=function(){this.readers.forEach(function(r){return r.reset()})},e}(Fo),u7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){u7e(e,t);function e(r,n){return r===void 0&&(r=500),t.call(this,new Zx(n),r,n)||this}return e})(C1);var V$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},La=function(){function t(e,r,n){this.ecCodewords=e,this.ecBlocks=[r],n&&this.ecBlocks.push(n)}return t.prototype.getECCodewords=function(){return this.ecCodewords},t.prototype.getECBlocks=function(){return this.ecBlocks},t}(),Fa=function(){function t(e,r){this.count=e,this.dataCodewords=r}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t}(),d7e=function(){function t(e,r,n,a,s,o){var l,c;this.versionNumber=e,this.symbolSizeRows=r,this.symbolSizeColumns=n,this.dataRegionSizeRows=a,this.dataRegionSizeColumns=s,this.ecBlocks=o;var u=0,d=o.getECCodewords(),f=o.getECBlocks();try{for(var A=V$(f),h=A.next();!h.done;h=A.next()){var m=h.value;u+=m.getCount()*(m.getDataCodewords()+d)}}catch(p){l={error:p}}finally{try{h&&!h.done&&(c=A.return)&&c.call(A)}finally{if(l)throw l.error}}this.totalCodewords=u}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},t.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},t.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},t.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getECBlocks=function(){return this.ecBlocks},t.getVersionForDimensions=function(e,r){var n,a;if(e&1||r&1)throw new qr;try{for(var s=V$(t.VERSIONS),o=s.next();!o.done;o=s.next()){var l=o.value;if(l.symbolSizeRows===e&&l.symbolSizeColumns===r)return l}}catch(c){n={error:c}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}throw new qr},t.prototype.toString=function(){return""+this.versionNumber},t.buildVersions=function(){return[new t(1,10,10,8,8,new La(5,new Fa(1,3))),new t(2,12,12,10,10,new La(7,new Fa(1,5))),new t(3,14,14,12,12,new La(10,new Fa(1,8))),new t(4,16,16,14,14,new La(12,new Fa(1,12))),new t(5,18,18,16,16,new La(14,new Fa(1,18))),new t(6,20,20,18,18,new La(18,new Fa(1,22))),new t(7,22,22,20,20,new La(20,new Fa(1,30))),new t(8,24,24,22,22,new La(24,new Fa(1,36))),new t(9,26,26,24,24,new La(28,new Fa(1,44))),new t(10,32,32,14,14,new La(36,new Fa(1,62))),new t(11,36,36,16,16,new La(42,new Fa(1,86))),new t(12,40,40,18,18,new La(48,new Fa(1,114))),new t(13,44,44,20,20,new La(56,new Fa(1,144))),new t(14,48,48,22,22,new La(68,new Fa(1,174))),new t(15,52,52,24,24,new La(42,new Fa(2,102))),new t(16,64,64,14,14,new La(56,new Fa(2,140))),new t(17,72,72,16,16,new La(36,new Fa(4,92))),new t(18,80,80,18,18,new La(48,new Fa(4,114))),new t(19,88,88,20,20,new La(56,new Fa(4,144))),new t(20,96,96,22,22,new La(68,new Fa(4,174))),new t(21,104,104,24,24,new La(56,new Fa(6,136))),new t(22,120,120,18,18,new La(68,new Fa(6,175))),new t(23,132,132,20,20,new La(62,new Fa(8,163))),new t(24,144,144,22,22,new La(62,new Fa(8,156),new Fa(2,155))),new t(25,8,18,6,16,new La(7,new Fa(1,5))),new t(26,8,32,6,14,new La(11,new Fa(1,10))),new t(27,12,26,10,24,new La(14,new Fa(1,16))),new t(28,12,36,10,16,new La(18,new Fa(1,22))),new t(29,16,36,14,16,new La(24,new Fa(1,32))),new t(30,16,48,14,22,new La(28,new Fa(1,49)))]},t.VERSIONS=t.buildVersions(),t}(),f7e=function(){function t(e){var r=e.getHeight();if(r<8||r>144||r&1)throw new qr;this.version=t.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new ch(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return t.prototype.getVersion=function(){return this.version},t.readVersion=function(e){var r=e.getHeight(),n=e.getWidth();return d7e.getVersionForDimensions(r,n)},t.prototype.readCodewords=function(){var e=new Int8Array(this.version.getTotalCodewords()),r=0,n=4,a=0,s=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth(),l=!1,c=!1,u=!1,d=!1;do if(n===s&&a===0&&!l)e[r++]=this.readCorner1(s,o)&255,n-=2,a+=2,l=!0;else if(n===s-2&&a===0&&o&3&&!c)e[r++]=this.readCorner2(s,o)&255,n-=2,a+=2,c=!0;else if(n===s+4&&a===2&&!(o&7)&&!u)e[r++]=this.readCorner3(s,o)&255,n-=2,a+=2,u=!0;else if(n===s-2&&a===0&&(o&7)===4&&!d)e[r++]=this.readCorner4(s,o)&255,n-=2,a+=2,d=!0;else{do n<s&&a>=0&&!this.readMappingMatrix.get(a,n)&&(e[r++]=this.readUtah(n,a,s,o)&255),n-=2,a+=2;while(n>=0&&a<o);n+=1,a+=3;do n>=0&&a<o&&!this.readMappingMatrix.get(a,n)&&(e[r++]=this.readUtah(n,a,s,o)&255),n+=2,a-=2;while(n<s&&a>=0);n+=3,a+=1}while(n<s||a<o);if(r!==this.version.getTotalCodewords())throw new qr;return e},t.prototype.readModule=function(e,r,n,a){return e<0&&(e+=n,r+=4-(n+4&7)),r<0&&(r+=a,e+=4-(a+4&7)),this.readMappingMatrix.set(r,e),this.mappingBitMatrix.get(r,e)},t.prototype.readUtah=function(e,r,n,a){var s=0;return this.readModule(e-2,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e-2,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e-1,r,n,a)&&(s|=1),s<<=1,this.readModule(e,r-2,n,a)&&(s|=1),s<<=1,this.readModule(e,r-1,n,a)&&(s|=1),s<<=1,this.readModule(e,r,n,a)&&(s|=1),s},t.prototype.readCorner1=function(e,r){var n=0;return this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,1,e,r)&&(n|=1),n<<=1,this.readModule(e-1,2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(2,r-1,e,r)&&(n|=1),n<<=1,this.readModule(3,r-1,e,r)&&(n|=1),n},t.prototype.readCorner2=function(e,r){var n=0;return this.readModule(e-3,0,e,r)&&(n|=1),n<<=1,this.readModule(e-2,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(0,r-4,e,r)&&(n|=1),n<<=1,this.readModule(0,r-3,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n},t.prototype.readCorner3=function(e,r){var n=0;return this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(0,r-3,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-3,e,r)&&(n|=1),n<<=1,this.readModule(1,r-2,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n},t.prototype.readCorner4=function(e,r){var n=0;return this.readModule(e-3,0,e,r)&&(n|=1),n<<=1,this.readModule(e-2,0,e,r)&&(n|=1),n<<=1,this.readModule(e-1,0,e,r)&&(n|=1),n<<=1,this.readModule(0,r-2,e,r)&&(n|=1),n<<=1,this.readModule(0,r-1,e,r)&&(n|=1),n<<=1,this.readModule(1,r-1,e,r)&&(n|=1),n<<=1,this.readModule(2,r-1,e,r)&&(n|=1),n<<=1,this.readModule(3,r-1,e,r)&&(n|=1),n},t.prototype.extractDataRegion=function(e){var r=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==r)throw new Pn("Dimension of bitMatrix must match the version size");for(var a=this.version.getDataRegionSizeRows(),s=this.version.getDataRegionSizeColumns(),o=r/a|0,l=n/s|0,c=o*a,u=l*s,d=new ch(u,c),f=0;f<o;++f)for(var A=f*a,h=0;h<l;++h)for(var m=h*s,p=0;p<a;++p)for(var x=f*(a+2)+1+p,v=A+p,y=0;y<s;++y){var b=h*(s+2)+1+y;if(e.get(b,x)){var w=m+y;d.set(w,v)}}return d},t}(),H$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},h7e=function(){function t(e,r){this.numDataCodewords=e,this.codewords=r}return t.getDataBlocks=function(e,r){var n,a,s,o,l=r.getECBlocks(),c=0,u=l.getECBlocks();try{for(var d=H$(u),f=d.next();!f.done;f=d.next()){var A=f.value;c+=A.getCount()}}catch(K){n={error:K}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}var h=new Array(c),m=0;try{for(var p=H$(u),x=p.next();!x.done;x=p.next())for(var A=x.value,v=0;v<A.getCount();v++){var y=A.getDataCodewords(),b=l.getECCodewords()+y;h[m++]=new t(y,new Uint8Array(b))}}catch(K){s={error:K}}finally{try{x&&!x.done&&(o=p.return)&&o.call(p)}finally{if(s)throw s.error}}for(var w=h[0].codewords.length,j=w-l.getECCodewords(),I=j-1,C=0,v=0;v<I;v++)for(var S=0;S<m;S++)h[S].codewords[v]=e[C++];for(var E=r.getVersionNumber()===24,B=E?8:m,S=0;S<B;S++)h[S].codewords[j-1]=e[C++];for(var k=h[0].codewords.length,v=j;v<k;v++)for(var S=0;S<m;S++){var T=E?(S+8)%m:S,P=E&&T>7?v-1:v;h[T].codewords[P]=e[C++]}if(C!==e.length)throw new Pn;return h},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t}(),jse=function(){function t(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}return t.prototype.getBitOffset=function(){return this.bitOffset},t.prototype.getByteOffset=function(){return this.byteOffset},t.prototype.readBits=function(e){if(e<1||e>32||e>this.available())throw new Pn(""+e);var r=0,n=this.bitOffset,a=this.byteOffset,s=this.bytes;if(n>0){var o=8-n,l=e<o?e:o,c=o-l,u=255>>8-l<<c;r=(s[a]&u)>>c,e-=l,n+=l,n===8&&(n=0,a++)}if(e>0){for(;e>=8;)r=r<<8|s[a]&255,a++,e-=8;if(e>0){var c=8-e,u=255>>c<<c;r=r<<e|(s[a]&u)>>c,n+=e}}return this.bitOffset=n,this.byteOffset=a,r},t.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},t}(),bo;(function(t){t[t.PAD_ENCODE=0]="PAD_ENCODE",t[t.ASCII_ENCODE=1]="ASCII_ENCODE",t[t.C40_ENCODE=2]="C40_ENCODE",t[t.TEXT_ENCODE=3]="TEXT_ENCODE",t[t.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",t[t.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",t[t.BASE256_ENCODE=6]="BASE256_ENCODE"})(bo||(bo={}));var A7e=function(){function t(){}return t.decode=function(e){var r=new jse(e),n=new ta,a=new ta,s=new Array,o=bo.ASCII_ENCODE;do if(o===bo.ASCII_ENCODE)o=this.decodeAsciiSegment(r,n,a);else{switch(o){case bo.C40_ENCODE:this.decodeC40Segment(r,n);break;case bo.TEXT_ENCODE:this.decodeTextSegment(r,n);break;case bo.ANSIX12_ENCODE:this.decodeAnsiX12Segment(r,n);break;case bo.EDIFACT_ENCODE:this.decodeEdifactSegment(r,n);break;case bo.BASE256_ENCODE:this.decodeBase256Segment(r,n,s);break;default:throw new qr}o=bo.ASCII_ENCODE}while(o!==bo.PAD_ENCODE&&r.available()>0);return a.length()>0&&n.append(a.toString()),new yP(e,n.toString(),s.length===0?null:s,null)},t.decodeAsciiSegment=function(e,r,n){var a=!1;do{var s=e.readBits(8);if(s===0)throw new qr;if(s<=128)return a&&(s+=128),r.append(String.fromCharCode(s-1)),bo.ASCII_ENCODE;if(s===129)return bo.PAD_ENCODE;if(s<=229){var o=s-130;o<10&&r.append("0"),r.append(""+o)}else switch(s){case 230:return bo.C40_ENCODE;case 231:return bo.BASE256_ENCODE;case 232:r.append("");break;case 233:case 234:break;case 235:a=!0;break;case 236:r.append("[)>05"),n.insert(0,"");break;case 237:r.append("[)>06"),n.insert(0,"");break;case 238:return bo.ANSIX12_ENCODE;case 239:return bo.TEXT_ENCODE;case 240:return bo.EDIFACT_ENCODE;case 241:break;default:if(s!==254||e.available()!==0)throw new qr;break}}while(e.available()>0);return bo.ASCII_ENCODE},t.decodeC40Segment=function(e,r){var n=!1,a=[],s=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var l=0;l<3;l++){var c=a[l];switch(s){case 0:if(c<3)s=c+1;else if(c<this.C40_BASIC_SET_CHARS.length){var u=this.C40_BASIC_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else throw new qr;break;case 1:n?(r.append(String.fromCharCode(c+128)),n=!1):r.append(String.fromCharCode(c)),s=0;break;case 2:if(c<this.C40_SHIFT2_SET_CHARS.length){var u=this.C40_SHIFT2_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else switch(c){case 27:r.append("");break;case 30:n=!0;break;default:throw new qr}s=0;break;case 3:n?(r.append(String.fromCharCode(c+224)),n=!1):r.append(String.fromCharCode(c+96)),s=0;break;default:throw new qr}}}while(e.available()>0)},t.decodeTextSegment=function(e,r){var n=!1,a=[],s=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var l=0;l<3;l++){var c=a[l];switch(s){case 0:if(c<3)s=c+1;else if(c<this.TEXT_BASIC_SET_CHARS.length){var u=this.TEXT_BASIC_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else throw new qr;break;case 1:n?(r.append(String.fromCharCode(c+128)),n=!1):r.append(String.fromCharCode(c)),s=0;break;case 2:if(c<this.TEXT_SHIFT2_SET_CHARS.length){var u=this.TEXT_SHIFT2_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u)}else switch(c){case 27:r.append("");break;case 30:n=!0;break;default:throw new qr}s=0;break;case 3:if(c<this.TEXT_SHIFT3_SET_CHARS.length){var u=this.TEXT_SHIFT3_SET_CHARS[c];n?(r.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):r.append(u),s=0}else throw new qr;break;default:throw new qr}}}while(e.available()>0)},t.decodeAnsiX12Segment=function(e,r){var n=[];do{if(e.available()===8)return;var a=e.readBits(8);if(a===254)return;this.parseTwoBytes(a,e.readBits(8),n);for(var s=0;s<3;s++){var o=n[s];switch(o){case 0:r.append("\r");break;case 1:r.append("*");break;case 2:r.append(">");break;case 3:r.append(" ");break;default:if(o<14)r.append(String.fromCharCode(o+44));else if(o<40)r.append(String.fromCharCode(o+51));else throw new qr;break}}}while(e.available()>0)},t.parseTwoBytes=function(e,r,n){var a=(e<<8)+r-1,s=Math.floor(a/1600);n[0]=s,a-=s*1600,s=Math.floor(a/40),n[1]=s,n[2]=a-s*40},t.decodeEdifactSegment=function(e,r){do{if(e.available()<=16)return;for(var n=0;n<4;n++){var a=e.readBits(6);if(a===31){var s=8-e.getBitOffset();s!==8&&e.readBits(s);return}a&32||(a|=64),r.append(String.fromCharCode(a))}}while(e.available()>0)},t.decodeBase256Segment=function(e,r,n){var a=1+e.getByteOffset(),s=this.unrandomize255State(e.readBits(8),a++),o;if(s===0?o=e.available()/8|0:s<250?o=s:o=250*(s-249)+this.unrandomize255State(e.readBits(8),a++),o<0)throw new qr;for(var l=new Uint8Array(o),c=0;c<o;c++){if(e.available()<8)throw new qr;l[c]=this.unrandomize255State(e.readBits(8),a++)}n.push(l);try{r.append(Bd.decode(l,ba.ISO88591))}catch(u){throw new zw("Platform does not support required encoding: "+u.message)}},t.unrandomize255State=function(e,r){var n=149*r%255+1,a=e-n;return a>=0?a:a+256},t.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],t.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],t.TEXT_SHIFT2_SET_CHARS=t.C40_SHIFT2_SET_CHARS,t.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""],t}(),m7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},p7e=function(){function t(){this.rsDecoder=new bP(tu.DATA_MATRIX_FIELD_256)}return t.prototype.decode=function(e){var r,n,a=new f7e(e),s=a.getVersion(),o=a.readCodewords(),l=h7e.getDataBlocks(o,s),c=0;try{for(var u=m7e(l),d=u.next();!d.done;d=u.next()){var f=d.value;c+=f.getNumDataCodewords()}}catch(b){r={error:b}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}for(var A=new Uint8Array(c),h=l.length,m=0;m<h;m++){var p=l[m],x=p.getCodewords(),v=p.getNumDataCodewords();this.correctErrors(x,v);for(var y=0;y<v;y++)A[y*h+m]=x[y]}return A7e.decode(A)},t.prototype.correctErrors=function(e,r){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-r)}catch{throw new lo}for(var a=0;a<r;a++)e[a]=n[a]},t}(),g7e=function(){function t(e){this.image=e,this.rectangleDetector=new AF(this.image)}return t.prototype.detect=function(){var e=this.rectangleDetector.detect(),r=this.detectSolid1(e);if(r=this.detectSolid2(r),r[3]=this.correctTopRight(r),!r[3])throw new lr;r=this.shiftToModuleCenter(r);var n=r[0],a=r[1],s=r[2],o=r[3],l=this.transitionsBetween(n,o)+1,c=this.transitionsBetween(s,o)+1;(l&1)===1&&(l+=1),(c&1)===1&&(c+=1),4*l<7*c&&4*c<7*l&&(l=c=Math.max(l,c));var u=t.sampleGrid(this.image,n,a,s,o,l,c);return new LR(u,[n,a,s,o])},t.shiftPoint=function(e,r,n){var a=(r.getX()-e.getX())/(n+1),s=(r.getY()-e.getY())/(n+1);return new An(e.getX()+a,e.getY()+s)},t.moveAway=function(e,r,n){var a=e.getX(),s=e.getY();return a<r?a-=1:a+=1,s<n?s-=1:s+=1,new An(a,s)},t.prototype.detectSolid1=function(e){var r=e[0],n=e[1],a=e[3],s=e[2],o=this.transitionsBetween(r,n),l=this.transitionsBetween(n,a),c=this.transitionsBetween(a,s),u=this.transitionsBetween(s,r),d=o,f=[s,r,n,a];return d>l&&(d=l,f[0]=r,f[1]=n,f[2]=a,f[3]=s),d>c&&(d=c,f[0]=n,f[1]=a,f[2]=s,f[3]=r),d>u&&(f[0]=a,f[1]=s,f[2]=r,f[3]=n),f},t.prototype.detectSolid2=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s),l=t.shiftPoint(n,a,(o+1)*4),c=t.shiftPoint(a,n,(o+1)*4),u=this.transitionsBetween(l,r),d=this.transitionsBetween(c,s);return u<d?(e[0]=r,e[1]=n,e[2]=a,e[3]=s):(e[0]=n,e[1]=a,e[2]=s,e[3]=r),e},t.prototype.correctTopRight=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s),l=this.transitionsBetween(n,s),c=t.shiftPoint(r,n,(l+1)*4),u=t.shiftPoint(a,n,(o+1)*4);o=this.transitionsBetween(c,s),l=this.transitionsBetween(u,s);var d=new An(s.getX()+(a.getX()-n.getX())/(o+1),s.getY()+(a.getY()-n.getY())/(o+1)),f=new An(s.getX()+(r.getX()-n.getX())/(l+1),s.getY()+(r.getY()-n.getY())/(l+1));if(!this.isValid(d))return this.isValid(f)?f:null;if(!this.isValid(f))return d;var A=this.transitionsBetween(c,d)+this.transitionsBetween(u,d),h=this.transitionsBetween(c,f)+this.transitionsBetween(u,f);return A>h?d:f},t.prototype.shiftToModuleCenter=function(e){var r=e[0],n=e[1],a=e[2],s=e[3],o=this.transitionsBetween(r,s)+1,l=this.transitionsBetween(a,s)+1,c=t.shiftPoint(r,n,l*4),u=t.shiftPoint(a,n,o*4);o=this.transitionsBetween(c,s)+1,l=this.transitionsBetween(u,s)+1,(o&1)===1&&(o+=1),(l&1)===1&&(l+=1);var d=(r.getX()+n.getX()+a.getX()+s.getX())/4,f=(r.getY()+n.getY()+a.getY()+s.getY())/4;r=t.moveAway(r,d,f),n=t.moveAway(n,d,f),a=t.moveAway(a,d,f),s=t.moveAway(s,d,f);var A,h;return c=t.shiftPoint(r,n,l*4),c=t.shiftPoint(c,s,o*4),A=t.shiftPoint(n,r,l*4),A=t.shiftPoint(A,a,o*4),u=t.shiftPoint(a,s,l*4),u=t.shiftPoint(u,n,o*4),h=t.shiftPoint(s,a,l*4),h=t.shiftPoint(h,r,o*4),[c,A,u,h]},t.prototype.isValid=function(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()},t.sampleGrid=function(e,r,n,a,s,o,l){var c=UR.getInstance();return c.sampleGrid(e,o,l,.5,.5,o-.5,.5,o-.5,l-.5,.5,l-.5,r.getX(),r.getY(),s.getX(),s.getY(),a.getX(),a.getY(),n.getX(),n.getY())},t.prototype.transitionsBetween=function(e,r){var n=Math.trunc(e.getX()),a=Math.trunc(e.getY()),s=Math.trunc(r.getX()),o=Math.trunc(r.getY()),l=Math.abs(o-a)>Math.abs(s-n);if(l){var c=n;n=a,a=c,c=s,s=o,o=c}for(var u=Math.abs(s-n),d=Math.abs(o-a),f=-u/2,A=a<o?1:-1,h=n<s?1:-1,m=0,p=this.image.get(l?a:n,l?n:a),x=n,v=a;x!==s;x+=h){var y=this.image.get(l?v:x,l?x:v);if(y!==p&&(m++,p=y),f+=d,f>0){if(v===o)break;v+=A,f-=u}}return m},t}(),nI=function(){function t(){this.decoder=new p7e}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n,a;if(r!=null&&r.has(Ns.PURE_BARCODE)){var s=t.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(s),a=t.NO_POINTS}else{var o=new g7e(e.getBlackMatrix()).detect();n=this.decoder.decode(o.getBits()),a=o.getPoints()}var l=n.getRawBytes(),c=new dc(n.getText(),l,8*l.length,a,jn.DATA_MATRIX,ws.currentTimeMillis()),u=n.getByteSegments();u!=null&&c.putMetadata(Pl.BYTE_SEGMENTS,u);var d=n.getECLevel();return d!=null&&c.putMetadata(Pl.ERROR_CORRECTION_LEVEL,d),c},t.prototype.reset=function(){},t.extractPureBits=function(e){var r=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(r==null||n==null)throw new lr;var a=this.moduleSize(r,e),s=r[1],o=n[1],l=r[0],c=n[0],u=(c-l+1)/a,d=(o-s+1)/a;if(u<=0||d<=0)throw new lr;var f=a/2;s+=f,l+=f;for(var A=new ch(u,d),h=0;h<d;h++)for(var m=s+h*a,p=0;p<u;p++)e.get(l+p*a,m)&&A.set(p,h);return A},t.moduleSize=function(e,r){for(var n=r.getWidth(),a=e[0],s=e[1];a<n&&r.get(a,s);)a++;if(a===n)throw new lr;var o=a-e[0];if(o===0)throw new lr;return o},t.NO_POINTS=[],t}(),x7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){x7e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new nI,r)||this}return e})(C1);var ev;(function(t){t[t.L=0]="L",t[t.M=1]="M",t[t.Q=2]="Q",t[t.H=3]="H"})(ev||(ev={}));var v7e=function(){function t(e,r,n){this.value=e,this.stringValue=r,this.bits=n,t.FOR_BITS.set(n,this),t.FOR_VALUE.set(e,this)}return t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.fromString=function(e){switch(e){case"L":return t.L;case"M":return t.M;case"Q":return t.Q;case"H":return t.H;default:throw new Vi(e+"not available")}},t.prototype.toString=function(){return this.stringValue},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.forBits=function(e){if(e<0||e>=t.FOR_BITS.size)throw new Pn;return t.FOR_BITS.get(e)},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.L=new t(ev.L,"L",1),t.M=new t(ev.M,"M",0),t.Q=new t(ev.Q,"Q",3),t.H=new t(ev.H,"H",2),t}(),y7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Pse=function(){function t(e){this.errorCorrectionLevel=v7e.forBits(e>>3&3),this.dataMask=e&7}return t.numBitsDiffering=function(e,r){return sa.bitCount(e^r)},t.decodeFormatInformation=function(e,r){var n=t.doDecodeFormatInformation(e,r);return n!==null?n:t.doDecodeFormatInformation(e^t.FORMAT_INFO_MASK_QR,r^t.FORMAT_INFO_MASK_QR)},t.doDecodeFormatInformation=function(e,r){var n,a,s=Number.MAX_SAFE_INTEGER,o=0;try{for(var l=y7e(t.FORMAT_INFO_DECODE_LOOKUP),c=l.next();!c.done;c=l.next()){var u=c.value,d=u[0];if(d===e||d===r)return new t(u[1]);var f=t.numBitsDiffering(e,d);f<s&&(o=u[1],s=f),e!==r&&(f=t.numBitsDiffering(r,d),f<s&&(o=u[1],s=f))}}catch(A){n={error:A}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return s<=3?new t(o):null},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getDataMask=function(){return this.dataMask},t.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.errorCorrectionLevel===r.errorCorrectionLevel&&this.dataMask===r.dataMask},t.FORMAT_INFO_MASK_QR=21522,t.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],t}(),b7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},zt=function(){function t(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.ecCodewordsPerBlock=e,this.ecBlocks=r}return t.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},t.prototype.getNumBlocks=function(){var e,r,n=0,a=this.ecBlocks;try{for(var s=b7e(a),o=s.next();!o.done;o=s.next()){var l=o.value;n+=l.getCount()}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return n},t.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},t.prototype.getECBlocks=function(){return this.ecBlocks},t}(),ut=function(){function t(e,r){this.count=e,this.dataCodewords=r}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t}(),w7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},zp=function(){function t(e,r){for(var n,a,s=[],o=2;o<arguments.length;o++)s[o-2]=arguments[o];this.versionNumber=e,this.alignmentPatternCenters=r,this.ecBlocks=s;var l=0,c=s[0].getECCodewordsPerBlock(),u=s[0].getECBlocks();try{for(var d=w7e(u),f=d.next();!f.done;f=d.next()){var A=f.value;l+=A.getCount()*(A.getDataCodewords()+c)}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}this.totalCodewords=l}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},t.prototype.getECBlocksForLevel=function(e){return this.ecBlocks[e.getValue()]},t.getProvisionalVersionForDimension=function(e){if(e%4!==1)throw new qr;try{return this.getVersionForNumber((e-17)/4)}catch{throw new qr}},t.getVersionForNumber=function(e){if(e<1||e>40)throw new Pn;return t.VERSIONS[e-1]},t.decodeVersionInformation=function(e){for(var r=Number.MAX_SAFE_INTEGER,n=0,a=0;a<t.VERSION_DECODE_INFO.length;a++){var s=t.VERSION_DECODE_INFO[a];if(s===e)return t.getVersionForNumber(a+7);var o=Pse.numBitsDiffering(e,s);o<r&&(n=a+7,r=o)}return r<=3?t.getVersionForNumber(n):null},t.prototype.buildFunctionPattern=function(){var e=this.getDimensionForVersion(),r=new ch(e);r.setRegion(0,0,9,9),r.setRegion(e-8,0,8,9),r.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,a=0;a<n;a++)for(var s=this.alignmentPatternCenters[a]-2,o=0;o<n;o++)a===0&&(o===0||o===n-1)||a===n-1&&o===0||r.setRegion(this.alignmentPatternCenters[o]-2,s,5,5);return r.setRegion(6,9,1,e-17),r.setRegion(9,6,e-17,1),this.versionNumber>6&&(r.setRegion(e-11,0,3,6),r.setRegion(0,e-11,6,3)),r},t.prototype.toString=function(){return""+this.versionNumber},t.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),t.VERSIONS=[new t(1,new Int32Array(0),new zt(7,new ut(1,19)),new zt(10,new ut(1,16)),new zt(13,new ut(1,13)),new zt(17,new ut(1,9))),new t(2,Int32Array.from([6,18]),new zt(10,new ut(1,34)),new zt(16,new ut(1,28)),new zt(22,new ut(1,22)),new zt(28,new ut(1,16))),new t(3,Int32Array.from([6,22]),new zt(15,new ut(1,55)),new zt(26,new ut(1,44)),new zt(18,new ut(2,17)),new zt(22,new ut(2,13))),new t(4,Int32Array.from([6,26]),new zt(20,new ut(1,80)),new zt(18,new ut(2,32)),new zt(26,new ut(2,24)),new zt(16,new ut(4,9))),new t(5,Int32Array.from([6,30]),new zt(26,new ut(1,108)),new zt(24,new ut(2,43)),new zt(18,new ut(2,15),new ut(2,16)),new zt(22,new ut(2,11),new ut(2,12))),new t(6,Int32Array.from([6,34]),new zt(18,new ut(2,68)),new zt(16,new ut(4,27)),new zt(24,new ut(4,19)),new zt(28,new ut(4,15))),new t(7,Int32Array.from([6,22,38]),new zt(20,new ut(2,78)),new zt(18,new ut(4,31)),new zt(18,new ut(2,14),new ut(4,15)),new zt(26,new ut(4,13),new ut(1,14))),new t(8,Int32Array.from([6,24,42]),new zt(24,new ut(2,97)),new zt(22,new ut(2,38),new ut(2,39)),new zt(22,new ut(4,18),new ut(2,19)),new zt(26,new ut(4,14),new ut(2,15))),new t(9,Int32Array.from([6,26,46]),new zt(30,new ut(2,116)),new zt(22,new ut(3,36),new ut(2,37)),new zt(20,new ut(4,16),new ut(4,17)),new zt(24,new ut(4,12),new ut(4,13))),new t(10,Int32Array.from([6,28,50]),new zt(18,new ut(2,68),new ut(2,69)),new zt(26,new ut(4,43),new ut(1,44)),new zt(24,new ut(6,19),new ut(2,20)),new zt(28,new ut(6,15),new ut(2,16))),new t(11,Int32Array.from([6,30,54]),new zt(20,new ut(4,81)),new zt(30,new ut(1,50),new ut(4,51)),new zt(28,new ut(4,22),new ut(4,23)),new zt(24,new ut(3,12),new ut(8,13))),new t(12,Int32Array.from([6,32,58]),new zt(24,new ut(2,92),new ut(2,93)),new zt(22,new ut(6,36),new ut(2,37)),new zt(26,new ut(4,20),new ut(6,21)),new zt(28,new ut(7,14),new ut(4,15))),new t(13,Int32Array.from([6,34,62]),new zt(26,new ut(4,107)),new zt(22,new ut(8,37),new ut(1,38)),new zt(24,new ut(8,20),new ut(4,21)),new zt(22,new ut(12,11),new ut(4,12))),new t(14,Int32Array.from([6,26,46,66]),new zt(30,new ut(3,115),new ut(1,116)),new zt(24,new ut(4,40),new ut(5,41)),new zt(20,new ut(11,16),new ut(5,17)),new zt(24,new ut(11,12),new ut(5,13))),new t(15,Int32Array.from([6,26,48,70]),new zt(22,new ut(5,87),new ut(1,88)),new zt(24,new ut(5,41),new ut(5,42)),new zt(30,new ut(5,24),new ut(7,25)),new zt(24,new ut(11,12),new ut(7,13))),new t(16,Int32Array.from([6,26,50,74]),new zt(24,new ut(5,98),new ut(1,99)),new zt(28,new ut(7,45),new ut(3,46)),new zt(24,new ut(15,19),new ut(2,20)),new zt(30,new ut(3,15),new ut(13,16))),new t(17,Int32Array.from([6,30,54,78]),new zt(28,new ut(1,107),new ut(5,108)),new zt(28,new ut(10,46),new ut(1,47)),new zt(28,new ut(1,22),new ut(15,23)),new zt(28,new ut(2,14),new ut(17,15))),new t(18,Int32Array.from([6,30,56,82]),new zt(30,new ut(5,120),new ut(1,121)),new zt(26,new ut(9,43),new ut(4,44)),new zt(28,new ut(17,22),new ut(1,23)),new zt(28,new ut(2,14),new ut(19,15))),new t(19,Int32Array.from([6,30,58,86]),new zt(28,new ut(3,113),new ut(4,114)),new zt(26,new ut(3,44),new ut(11,45)),new zt(26,new ut(17,21),new ut(4,22)),new zt(26,new ut(9,13),new ut(16,14))),new t(20,Int32Array.from([6,34,62,90]),new zt(28,new ut(3,107),new ut(5,108)),new zt(26,new ut(3,41),new ut(13,42)),new zt(30,new ut(15,24),new ut(5,25)),new zt(28,new ut(15,15),new ut(10,16))),new t(21,Int32Array.from([6,28,50,72,94]),new zt(28,new ut(4,116),new ut(4,117)),new zt(26,new ut(17,42)),new zt(28,new ut(17,22),new ut(6,23)),new zt(30,new ut(19,16),new ut(6,17))),new t(22,Int32Array.from([6,26,50,74,98]),new zt(28,new ut(2,111),new ut(7,112)),new zt(28,new ut(17,46)),new zt(30,new ut(7,24),new ut(16,25)),new zt(24,new ut(34,13))),new t(23,Int32Array.from([6,30,54,78,102]),new zt(30,new ut(4,121),new ut(5,122)),new zt(28,new ut(4,47),new ut(14,48)),new zt(30,new ut(11,24),new ut(14,25)),new zt(30,new ut(16,15),new ut(14,16))),new t(24,Int32Array.from([6,28,54,80,106]),new zt(30,new ut(6,117),new ut(4,118)),new zt(28,new ut(6,45),new ut(14,46)),new zt(30,new ut(11,24),new ut(16,25)),new zt(30,new ut(30,16),new ut(2,17))),new t(25,Int32Array.from([6,32,58,84,110]),new zt(26,new ut(8,106),new ut(4,107)),new zt(28,new ut(8,47),new ut(13,48)),new zt(30,new ut(7,24),new ut(22,25)),new zt(30,new ut(22,15),new ut(13,16))),new t(26,Int32Array.from([6,30,58,86,114]),new zt(28,new ut(10,114),new ut(2,115)),new zt(28,new ut(19,46),new ut(4,47)),new zt(28,new ut(28,22),new ut(6,23)),new zt(30,new ut(33,16),new ut(4,17))),new t(27,Int32Array.from([6,34,62,90,118]),new zt(30,new ut(8,122),new ut(4,123)),new zt(28,new ut(22,45),new ut(3,46)),new zt(30,new ut(8,23),new ut(26,24)),new zt(30,new ut(12,15),new ut(28,16))),new t(28,Int32Array.from([6,26,50,74,98,122]),new zt(30,new ut(3,117),new ut(10,118)),new zt(28,new ut(3,45),new ut(23,46)),new zt(30,new ut(4,24),new ut(31,25)),new zt(30,new ut(11,15),new ut(31,16))),new t(29,Int32Array.from([6,30,54,78,102,126]),new zt(30,new ut(7,116),new ut(7,117)),new zt(28,new ut(21,45),new ut(7,46)),new zt(30,new ut(1,23),new ut(37,24)),new zt(30,new ut(19,15),new ut(26,16))),new t(30,Int32Array.from([6,26,52,78,104,130]),new zt(30,new ut(5,115),new ut(10,116)),new zt(28,new ut(19,47),new ut(10,48)),new zt(30,new ut(15,24),new ut(25,25)),new zt(30,new ut(23,15),new ut(25,16))),new t(31,Int32Array.from([6,30,56,82,108,134]),new zt(30,new ut(13,115),new ut(3,116)),new zt(28,new ut(2,46),new ut(29,47)),new zt(30,new ut(42,24),new ut(1,25)),new zt(30,new ut(23,15),new ut(28,16))),new t(32,Int32Array.from([6,34,60,86,112,138]),new zt(30,new ut(17,115)),new zt(28,new ut(10,46),new ut(23,47)),new zt(30,new ut(10,24),new ut(35,25)),new zt(30,new ut(19,15),new ut(35,16))),new t(33,Int32Array.from([6,30,58,86,114,142]),new zt(30,new ut(17,115),new ut(1,116)),new zt(28,new ut(14,46),new ut(21,47)),new zt(30,new ut(29,24),new ut(19,25)),new zt(30,new ut(11,15),new ut(46,16))),new t(34,Int32Array.from([6,34,62,90,118,146]),new zt(30,new ut(13,115),new ut(6,116)),new zt(28,new ut(14,46),new ut(23,47)),new zt(30,new ut(44,24),new ut(7,25)),new zt(30,new ut(59,16),new ut(1,17))),new t(35,Int32Array.from([6,30,54,78,102,126,150]),new zt(30,new ut(12,121),new ut(7,122)),new zt(28,new ut(12,47),new ut(26,48)),new zt(30,new ut(39,24),new ut(14,25)),new zt(30,new ut(22,15),new ut(41,16))),new t(36,Int32Array.from([6,24,50,76,102,128,154]),new zt(30,new ut(6,121),new ut(14,122)),new zt(28,new ut(6,47),new ut(34,48)),new zt(30,new ut(46,24),new ut(10,25)),new zt(30,new ut(2,15),new ut(64,16))),new t(37,Int32Array.from([6,28,54,80,106,132,158]),new zt(30,new ut(17,122),new ut(4,123)),new zt(28,new ut(29,46),new ut(14,47)),new zt(30,new ut(49,24),new ut(10,25)),new zt(30,new ut(24,15),new ut(46,16))),new t(38,Int32Array.from([6,32,58,84,110,136,162]),new zt(30,new ut(4,122),new ut(18,123)),new zt(28,new ut(13,46),new ut(32,47)),new zt(30,new ut(48,24),new ut(14,25)),new zt(30,new ut(42,15),new ut(32,16))),new t(39,Int32Array.from([6,26,54,82,110,138,166]),new zt(30,new ut(20,117),new ut(4,118)),new zt(28,new ut(40,47),new ut(7,48)),new zt(30,new ut(43,24),new ut(22,25)),new zt(30,new ut(10,15),new ut(67,16))),new t(40,Int32Array.from([6,30,58,86,114,142,170]),new zt(30,new ut(19,118),new ut(6,119)),new zt(28,new ut(18,47),new ut(31,48)),new zt(30,new ut(34,24),new ut(34,25)),new zt(30,new ut(20,15),new ut(61,16)))],t}(),Go;(function(t){t[t.DATA_MASK_000=0]="DATA_MASK_000",t[t.DATA_MASK_001=1]="DATA_MASK_001",t[t.DATA_MASK_010=2]="DATA_MASK_010",t[t.DATA_MASK_011=3]="DATA_MASK_011",t[t.DATA_MASK_100=4]="DATA_MASK_100",t[t.DATA_MASK_101=5]="DATA_MASK_101",t[t.DATA_MASK_110=6]="DATA_MASK_110",t[t.DATA_MASK_111=7]="DATA_MASK_111"})(Go||(Go={}));var $$=function(){function t(e,r){this.value=e,this.isMasked=r}return t.prototype.unmaskBitMatrix=function(e,r){for(var n=0;n<r;n++)for(var a=0;a<r;a++)this.isMasked(n,a)&&e.flip(a,n)},t.values=new Map([[Go.DATA_MASK_000,new t(Go.DATA_MASK_000,function(e,r){return(e+r&1)===0})],[Go.DATA_MASK_001,new t(Go.DATA_MASK_001,function(e,r){return(e&1)===0})],[Go.DATA_MASK_010,new t(Go.DATA_MASK_010,function(e,r){return r%3===0})],[Go.DATA_MASK_011,new t(Go.DATA_MASK_011,function(e,r){return(e+r)%3===0})],[Go.DATA_MASK_100,new t(Go.DATA_MASK_100,function(e,r){return(Math.floor(e/2)+Math.floor(r/3)&1)===0})],[Go.DATA_MASK_101,new t(Go.DATA_MASK_101,function(e,r){return e*r%6===0})],[Go.DATA_MASK_110,new t(Go.DATA_MASK_110,function(e,r){return e*r%6<3})],[Go.DATA_MASK_111,new t(Go.DATA_MASK_111,function(e,r){return(e+r+e*r%3&1)===0})]]),t}(),N7e=function(){function t(e){var r=e.getHeight();if(r<21||(r&3)!==1)throw new qr;this.bitMatrix=e}return t.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;for(var e=0,r=0;r<6;r++)e=this.copyBit(r,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);for(var a=this.bitMatrix.getHeight(),s=0,o=a-7,n=a-1;n>=o;n--)s=this.copyBit(8,n,s);for(var r=a-8;r<a;r++)s=this.copyBit(r,8,s);if(this.parsedFormatInfo=Pse.decodeFormatInformation(e,s),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new qr},t.prototype.readVersion=function(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;var e=this.bitMatrix.getHeight(),r=Math.floor((e-17)/4);if(r<=6)return zp.getVersionForNumber(r);for(var n=0,a=e-11,s=5;s>=0;s--)for(var o=e-9;o>=a;o--)n=this.copyBit(o,s,n);var l=zp.decodeVersionInformation(n);if(l!==null&&l.getDimensionForVersion()===e)return this.parsedVersion=l,l;n=0;for(var o=5;o>=0;o--)for(var s=e-9;s>=a;s--)n=this.copyBit(o,s,n);if(l=zp.decodeVersionInformation(n),l!==null&&l.getDimensionForVersion()===e)return this.parsedVersion=l,l;throw new qr},t.prototype.copyBit=function(e,r,n){var a=this.isMirror?this.bitMatrix.get(r,e):this.bitMatrix.get(e,r);return a?n<<1|1:n<<1},t.prototype.readCodewords=function(){var e=this.readFormatInformation(),r=this.readVersion(),n=$$.values.get(e.getDataMask()),a=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,a);for(var s=r.buildFunctionPattern(),o=!0,l=new Uint8Array(r.getTotalCodewords()),c=0,u=0,d=0,f=a-1;f>0;f-=2){f===6&&f--;for(var A=0;A<a;A++)for(var h=o?a-1-A:A,m=0;m<2;m++)s.get(f-m,h)||(d++,u<<=1,this.bitMatrix.get(f-m,h)&&(u|=1),d===8&&(l[c++]=u,d=0,u=0));o=!o}if(c!==r.getTotalCodewords())throw new qr;return l},t.prototype.remask=function(){if(this.parsedFormatInfo!==null){var e=$$.values.get(this.parsedFormatInfo.getDataMask()),r=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,r)}},t.prototype.setMirror=function(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e},t.prototype.mirror=function(){for(var e=this.bitMatrix,r=0,n=e.getWidth();r<n;r++)for(var a=r+1,s=e.getHeight();a<s;a++)e.get(r,a)!==e.get(a,r)&&(e.flip(a,r),e.flip(r,a))},t}(),G$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},C7e=function(){function t(e,r){this.numDataCodewords=e,this.codewords=r}return t.getDataBlocks=function(e,r,n){var a,s,o,l;if(e.length!==r.getTotalCodewords())throw new Pn;var c=r.getECBlocksForLevel(n),u=0,d=c.getECBlocks();try{for(var f=G$(d),A=f.next();!A.done;A=f.next()){var h=A.value;u+=h.getCount()}}catch(P){a={error:P}}finally{try{A&&!A.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}var m=new Array(u),p=0;try{for(var x=G$(d),v=x.next();!v.done;v=x.next())for(var h=v.value,y=0;y<h.getCount();y++){var b=h.getDataCodewords(),w=c.getECCodewordsPerBlock()+b;m[p++]=new t(b,new Uint8Array(w))}}catch(P){o={error:P}}finally{try{v&&!v.done&&(l=x.return)&&l.call(x)}finally{if(o)throw o.error}}for(var j=m[0].codewords.length,I=m.length-1;I>=0;){var C=m[I].codewords.length;if(C===j)break;I--}I++;for(var S=j-c.getECCodewordsPerBlock(),E=0,y=0;y<S;y++)for(var B=0;B<p;B++)m[B].codewords[y]=e[E++];for(var B=I;B<p;B++)m[B].codewords[S]=e[E++];for(var k=m[0].codewords.length,y=S;y<k;y++)for(var B=0;B<p;B++){var T=B<I?y:y+1;m[B].codewords[T]=e[E++]}return m},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t}(),Ad;(function(t){t[t.TERMINATOR=0]="TERMINATOR",t[t.NUMERIC=1]="NUMERIC",t[t.ALPHANUMERIC=2]="ALPHANUMERIC",t[t.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",t[t.BYTE=4]="BYTE",t[t.ECI=5]="ECI",t[t.KANJI=6]="KANJI",t[t.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",t[t.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",t[t.HANZI=9]="HANZI"})(Ad||(Ad={}));var Ps=function(){function t(e,r,n,a){this.value=e,this.stringValue=r,this.characterCountBitsForVersions=n,this.bits=a,t.FOR_BITS.set(a,this),t.FOR_VALUE.set(e,this)}return t.forBits=function(e){var r=t.FOR_BITS.get(e);if(r===void 0)throw new Pn;return r},t.prototype.getCharacterCountBits=function(e){var r=e.getVersionNumber(),n;return r<=9?n=0:r<=26?n=1:n=2,this.characterCountBitsForVersions[n]},t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.prototype.toString=function(){return this.stringValue},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.TERMINATOR=new t(Ad.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),t.NUMERIC=new t(Ad.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),t.ALPHANUMERIC=new t(Ad.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),t.STRUCTURED_APPEND=new t(Ad.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),t.BYTE=new t(Ad.BYTE,"BYTE",Int32Array.from([8,16,16]),4),t.ECI=new t(Ad.ECI,"ECI",Int32Array.from([0,0,0]),7),t.KANJI=new t(Ad.KANJI,"KANJI",Int32Array.from([8,10,12]),8),t.FNC1_FIRST_POSITION=new t(Ad.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),t.FNC1_SECOND_POSITION=new t(Ad.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),t.HANZI=new t(Ad.HANZI,"HANZI",Int32Array.from([8,10,12]),13),t}(),_7e=function(){function t(){}return t.decode=function(e,r,n,a){var s=new jse(e),o=new ta,l=new Array,c=-1,u=-1;try{var d=null,f=!1,A=void 0;do{if(s.available()<4)A=Ps.TERMINATOR;else{var h=s.readBits(4);A=Ps.forBits(h)}switch(A){case Ps.TERMINATOR:break;case Ps.FNC1_FIRST_POSITION:case Ps.FNC1_SECOND_POSITION:f=!0;break;case Ps.STRUCTURED_APPEND:if(s.available()<16)throw new qr;c=s.readBits(8),u=s.readBits(8);break;case Ps.ECI:var m=t.parseECIValue(s);if(d=Po.getCharacterSetECIByValue(m),d===null)throw new qr;break;case Ps.HANZI:var p=s.readBits(4),x=s.readBits(A.getCharacterCountBits(r));p===t.GB2312_SUBSET&&t.decodeHanziSegment(s,o,x);break;default:var v=s.readBits(A.getCharacterCountBits(r));switch(A){case Ps.NUMERIC:t.decodeNumericSegment(s,o,v);break;case Ps.ALPHANUMERIC:t.decodeAlphanumericSegment(s,o,v,f);break;case Ps.BYTE:t.decodeByteSegment(s,o,v,d,l,a);break;case Ps.KANJI:t.decodeKanjiSegment(s,o,v);break;default:throw new qr}break}}while(A!==Ps.TERMINATOR)}catch{throw new qr}return new yP(e,o.toString(),l.length===0?null:l,n===null?null:n.toString(),c,u)},t.decodeHanziSegment=function(e,r,n){if(n*13>e.available())throw new qr;for(var a=new Uint8Array(2*n),s=0;n>0;){var o=e.readBits(13),l=o/96<<8&4294967295|o%96;l<959?l+=41377:l+=42657,a[s]=l>>8&255,a[s+1]=l&255,s+=2,n--}try{r.append(Bd.decode(a,ba.GB2312))}catch(c){throw new qr(c)}},t.decodeKanjiSegment=function(e,r,n){if(n*13>e.available())throw new qr;for(var a=new Uint8Array(2*n),s=0;n>0;){var o=e.readBits(13),l=o/192<<8&4294967295|o%192;l<7936?l+=33088:l+=49472,a[s]=l>>8,a[s+1]=l,s+=2,n--}try{r.append(Bd.decode(a,ba.SHIFT_JIS))}catch(c){throw new qr(c)}},t.decodeByteSegment=function(e,r,n,a,s,o){if(8*n>e.available())throw new qr;for(var l=new Uint8Array(n),c=0;c<n;c++)l[c]=e.readBits(8);var u;a===null?u=ba.guessEncoding(l,o):u=a.getName();try{r.append(Bd.decode(l,u))}catch(d){throw new qr(d)}s.push(l)},t.toAlphaNumericChar=function(e){if(e>=t.ALPHANUMERIC_CHARS.length)throw new qr;return t.ALPHANUMERIC_CHARS[e]},t.decodeAlphanumericSegment=function(e,r,n,a){for(var s=r.length();n>1;){if(e.available()<11)throw new qr;var o=e.readBits(11);r.append(t.toAlphaNumericChar(Math.floor(o/45))),r.append(t.toAlphaNumericChar(o%45)),n-=2}if(n===1){if(e.available()<6)throw new qr;r.append(t.toAlphaNumericChar(e.readBits(6)))}if(a)for(var l=s;l<r.length();l++)r.charAt(l)==="%"&&(l<r.length()-1&&r.charAt(l+1)==="%"?r.deleteCharAt(l+1):r.setCharAt(l,""))},t.decodeNumericSegment=function(e,r,n){for(;n>=3;){if(e.available()<10)throw new qr;var a=e.readBits(10);if(a>=1e3)throw new qr;r.append(t.toAlphaNumericChar(Math.floor(a/100))),r.append(t.toAlphaNumericChar(Math.floor(a/10)%10)),r.append(t.toAlphaNumericChar(a%10)),n-=3}if(n===2){if(e.available()<7)throw new qr;var s=e.readBits(7);if(s>=100)throw new qr;r.append(t.toAlphaNumericChar(Math.floor(s/10))),r.append(t.toAlphaNumericChar(s%10))}else if(n===1){if(e.available()<4)throw new qr;var o=e.readBits(4);if(o>=10)throw new qr;r.append(t.toAlphaNumericChar(o))}},t.parseECIValue=function(e){var r=e.readBits(8);if(!(r&128))return r&127;if((r&192)===128){var n=e.readBits(8);return(r&63)<<8&4294967295|n}if((r&224)===192){var a=e.readBits(16);return(r&31)<<16&4294967295|a}throw new qr},t.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",t.GB2312_SUBSET=1,t}(),Tse=function(){function t(e){this.mirrored=e}return t.prototype.isMirrored=function(){return this.mirrored},t.prototype.applyMirroredCorrection=function(e){if(!(!this.mirrored||e===null||e.length<3)){var r=e[0];e[0]=e[2],e[2]=r}},t}(),K$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},E7e=function(){function t(){this.rsDecoder=new bP(tu.QR_CODE_FIELD_256)}return t.prototype.decodeBooleanArray=function(e,r){return this.decodeBitMatrix(ch.parseFromBooleanArray(e),r)},t.prototype.decodeBitMatrix=function(e,r){var n=new N7e(e),a=null;try{return this.decodeBitMatrixParser(n,r)}catch(o){a=o}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();var s=this.decodeBitMatrixParser(n,r);return s.setOther(new Tse(!0)),s}catch(o){throw a!==null?a:o}},t.prototype.decodeBitMatrixParser=function(e,r){var n,a,s,o,l=e.readVersion(),c=e.readFormatInformation().getErrorCorrectionLevel(),u=e.readCodewords(),d=C7e.getDataBlocks(u,l,c),f=0;try{for(var A=K$(d),h=A.next();!h.done;h=A.next()){var m=h.value;f+=m.getNumDataCodewords()}}catch(I){n={error:I}}finally{try{h&&!h.done&&(a=A.return)&&a.call(A)}finally{if(n)throw n.error}}var p=new Uint8Array(f),x=0;try{for(var v=K$(d),y=v.next();!y.done;y=v.next()){var m=y.value,b=m.getCodewords(),w=m.getNumDataCodewords();this.correctErrors(b,w);for(var j=0;j<w;j++)p[x++]=b[j]}}catch(I){s={error:I}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(s)throw s.error}}return _7e.decode(p,l,c,r)},t.prototype.correctErrors=function(e,r){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-r)}catch{throw new lo}for(var a=0;a<r;a++)e[a]=n[a]},t}(),S7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),I7e=function(t){S7e(e,t);function e(r,n,a){var s=t.call(this,r,n)||this;return s.estimatedModuleSize=a,s}return e.prototype.aboutEquals=function(r,n,a){if(Math.abs(n-this.getY())<=r&&Math.abs(a-this.getX())<=r){var s=Math.abs(r-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(r,n,a){var s=(this.getX()+n)/2,o=(this.getY()+r)/2,l=(this.estimatedModuleSize+a)/2;return new e(s,o,l)},e}(An),j7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},P7e=function(){function t(e,r,n,a,s,o,l){this.image=e,this.startX=r,this.startY=n,this.width=a,this.height=s,this.moduleSize=o,this.resultPointCallback=l,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return t.prototype.find=function(){for(var e=this.startX,r=this.height,n=this.width,a=e+n,s=this.startY+r/2,o=new Int32Array(3),l=this.image,c=0;c<r;c++){var u=s+(c&1?-Math.floor((c+1)/2):Math.floor((c+1)/2));o[0]=0,o[1]=0,o[2]=0;for(var d=e;d<a&&!l.get(d,u);)d++;for(var f=0;d<a;){if(l.get(d,u))if(f===1)o[1]++;else if(f===2){if(this.foundPatternCross(o)){var A=this.handlePossibleCenter(o,u,d);if(A!==null)return A}o[0]=o[2],o[1]=1,o[2]=0,f=1}else o[++f]++;else f===1&&f++,o[f]++;d++}if(this.foundPatternCross(o)){var A=this.handlePossibleCenter(o,u,a);if(A!==null)return A}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new lr},t.centerFromEnd=function(e,r){return r-e[2]-e[1]/2},t.prototype.foundPatternCross=function(e){for(var r=this.moduleSize,n=r/2,a=0;a<3;a++)if(Math.abs(r-e[a])>=n)return!1;return!0},t.prototype.crossCheckVertical=function(e,r,n,a){var s=this.image,o=s.getHeight(),l=this.crossCheckStateCount;l[0]=0,l[1]=0,l[2]=0;for(var c=e;c>=0&&s.get(r,c)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&!s.get(r,c)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(r,c)&&l[1]<=n;)l[1]++,c++;if(c===o||l[1]>n)return NaN;for(;c<o&&!s.get(r,c)&&l[2]<=n;)l[2]++,c++;if(l[2]>n)return NaN;var u=l[0]+l[1]+l[2];return 5*Math.abs(u-a)>=2*a?NaN:this.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.handlePossibleCenter=function(e,r,n){var a,s,o=e[0]+e[1]+e[2],l=t.centerFromEnd(e,n),c=this.crossCheckVertical(r,l,2*e[1],o);if(!isNaN(c)){var u=(e[0]+e[1]+e[2])/3;try{for(var d=j7e(this.possibleCenters),f=d.next();!f.done;f=d.next()){var A=f.value;if(A.aboutEquals(u,c,l))return A.combineEstimate(c,l,u)}}catch(m){a={error:m}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}var h=new I7e(l,c,u);this.possibleCenters.push(h),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(h)}return null},t}(),T7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),B7e=function(t){T7e(e,t);function e(r,n,a,s){var o=t.call(this,r,n)||this;return o.estimatedModuleSize=a,o.count=s,s===void 0&&(o.count=1),o}return e.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},e.prototype.getCount=function(){return this.count},e.prototype.aboutEquals=function(r,n,a){if(Math.abs(n-this.getY())<=r&&Math.abs(a-this.getX())<=r){var s=Math.abs(r-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(r,n,a){var s=this.count+1,o=(this.count*this.getX()+n)/s,l=(this.count*this.getY()+r)/s,c=(this.count*this.estimatedModuleSize+a)/s;return new e(o,l,c,s)},e}(An),k7e=function(){function t(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}return t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t}(),by=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},F7e=function(){function t(e,r){this.image=e,this.resultPointCallback=r,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=r}return t.prototype.getImage=function(){return this.image},t.prototype.getPossibleCenters=function(){return this.possibleCenters},t.prototype.find=function(e){var r=e!=null&&e.get(Ns.TRY_HARDER)!==void 0,n=e!=null&&e.get(Ns.PURE_BARCODE)!==void 0,a=this.image,s=a.getHeight(),o=a.getWidth(),l=Math.floor(3*s/(4*t.MAX_MODULES));(l<t.MIN_SKIP||r)&&(l=t.MIN_SKIP);for(var c=!1,u=new Int32Array(5),d=l-1;d<s&&!c;d+=l){u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0;for(var f=0,A=0;A<o;A++)if(a.get(A,d))(f&1)===1&&f++,u[f]++;else if(f&1)u[f]++;else if(f===4)if(t.foundPatternCross(u)){var h=this.handlePossibleCenter(u,d,A,n);if(h===!0)if(l=2,this.hasSkipped===!0)c=this.haveMultiplyConfirmedCenters();else{var m=this.findRowSkip();m>u[2]&&(d+=m-u[2]-l,A=o-1)}else{u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,f=3;continue}f=0,u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0}else u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,f=3;else u[++f]++;if(t.foundPatternCross(u)){var h=this.handlePossibleCenter(u,d,o,n);h===!0&&(l=u[0],this.hasSkipped&&(c=this.haveMultiplyConfirmedCenters()))}}var p=this.selectBestPatterns();return An.orderBestPatterns(p),new k7e(p)},t.centerFromEnd=function(e,r){return r-e[4]-e[3]-e[2]/2},t.foundPatternCross=function(e){for(var r=0,n=0;n<5;n++){var a=e[n];if(a===0)return!1;r+=a}if(r<7)return!1;var s=r/7,o=s/2;return Math.abs(s-e[0])<o&&Math.abs(s-e[1])<o&&Math.abs(3*s-e[2])<3*o&&Math.abs(s-e[3])<o&&Math.abs(s-e[4])<o},t.prototype.getCrossCheckStateCount=function(){var e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e},t.prototype.crossCheckDiagonal=function(e,r,n,a){for(var s=this.getCrossCheckStateCount(),o=0,l=this.image;e>=o&&r>=o&&l.get(r-o,e-o);)s[2]++,o++;if(e<o||r<o)return!1;for(;e>=o&&r>=o&&!l.get(r-o,e-o)&&s[1]<=n;)s[1]++,o++;if(e<o||r<o||s[1]>n)return!1;for(;e>=o&&r>=o&&l.get(r-o,e-o)&&s[0]<=n;)s[0]++,o++;if(s[0]>n)return!1;var c=l.getHeight(),u=l.getWidth();for(o=1;e+o<c&&r+o<u&&l.get(r+o,e+o);)s[2]++,o++;if(e+o>=c||r+o>=u)return!1;for(;e+o<c&&r+o<u&&!l.get(r+o,e+o)&&s[3]<n;)s[3]++,o++;if(e+o>=c||r+o>=u||s[3]>=n)return!1;for(;e+o<c&&r+o<u&&l.get(r+o,e+o)&&s[4]<n;)s[4]++,o++;if(s[4]>=n)return!1;var d=s[0]+s[1]+s[2]+s[3]+s[4];return Math.abs(d-a)<2*a&&t.foundPatternCross(s)},t.prototype.crossCheckVertical=function(e,r,n,a){for(var s=this.image,o=s.getHeight(),l=this.getCrossCheckStateCount(),c=e;c>=0&&s.get(r,c);)l[2]++,c--;if(c<0)return NaN;for(;c>=0&&!s.get(r,c)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&s.get(r,c)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(r,c);)l[2]++,c++;if(c===o)return NaN;for(;c<o&&!s.get(r,c)&&l[3]<n;)l[3]++,c++;if(c===o||l[3]>=n)return NaN;for(;c<o&&s.get(r,c)&&l[4]<n;)l[4]++,c++;if(l[4]>=n)return NaN;var u=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(u-a)>=2*a?NaN:t.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.crossCheckHorizontal=function(e,r,n,a){for(var s=this.image,o=s.getWidth(),l=this.getCrossCheckStateCount(),c=e;c>=0&&s.get(c,r);)l[2]++,c--;if(c<0)return NaN;for(;c>=0&&!s.get(c,r)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&s.get(c,r)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=e+1;c<o&&s.get(c,r);)l[2]++,c++;if(c===o)return NaN;for(;c<o&&!s.get(c,r)&&l[3]<n;)l[3]++,c++;if(c===o||l[3]>=n)return NaN;for(;c<o&&s.get(c,r)&&l[4]<n;)l[4]++,c++;if(l[4]>=n)return NaN;var u=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(u-a)>=a?NaN:t.foundPatternCross(l)?t.centerFromEnd(l,c):NaN},t.prototype.handlePossibleCenter=function(e,r,n,a){var s=e[0]+e[1]+e[2]+e[3]+e[4],o=t.centerFromEnd(e,n),l=this.crossCheckVertical(r,Math.floor(o),e[2],s);if(!isNaN(l)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(l),e[2],s),!isNaN(o)&&(!a||this.crossCheckDiagonal(Math.floor(l),Math.floor(o),e[2],s)))){for(var c=s/7,u=!1,d=this.possibleCenters,f=0,A=d.length;f<A;f++){var h=d[f];if(h.aboutEquals(c,l,o)){d[f]=h.combineEstimate(l,o,c),u=!0;break}}if(!u){var m=new B7e(o,l,c);d.push(m),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(m)}return!0}return!1},t.prototype.findRowSkip=function(){var e,r,n=this.possibleCenters.length;if(n<=1)return 0;var a=null;try{for(var s=by(this.possibleCenters),o=s.next();!o.done;o=s.next()){var l=o.value;if(l.getCount()>=t.CENTER_QUORUM)if(a==null)a=l;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-l.getX())-Math.abs(a.getY()-l.getY()))/2)}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return 0},t.prototype.haveMultiplyConfirmedCenters=function(){var e,r,n,a,s=0,o=0,l=this.possibleCenters.length;try{for(var c=by(this.possibleCenters),u=c.next();!u.done;u=c.next()){var d=u.value;d.getCount()>=t.CENTER_QUORUM&&(s++,o+=d.getEstimatedModuleSize())}}catch(p){e={error:p}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}if(s<3)return!1;var f=o/l,A=0;try{for(var h=by(this.possibleCenters),m=h.next();!m.done;m=h.next()){var d=m.value;A+=Math.abs(d.getEstimatedModuleSize()-f)}}catch(p){n={error:p}}finally{try{m&&!m.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}return A<=.05*o},t.prototype.selectBestPatterns=function(){var e,r,n,a,s=this.possibleCenters.length;if(s<3)throw new lr;var o=this.possibleCenters,l;if(s>3){var c=0,u=0;try{for(var d=by(this.possibleCenters),f=d.next();!f.done;f=d.next()){var A=f.value,h=A.getEstimatedModuleSize();c+=h,u+=h*h}}catch(j){e={error:j}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(e)throw e.error}}l=c/s;var m=Math.sqrt(u/s-l*l);o.sort(function(j,I){var C=Math.abs(I.getEstimatedModuleSize()-l),S=Math.abs(j.getEstimatedModuleSize()-l);return C<S?-1:C>S?1:0});for(var p=Math.max(.2*l,m),x=0;x<o.length&&o.length>3;x++){var v=o[x];Math.abs(v.getEstimatedModuleSize()-l)>p&&(o.splice(x,1),x--)}}if(o.length>3){var c=0;try{for(var y=by(o),b=y.next();!b.done;b=y.next()){var w=b.value;c+=w.getEstimatedModuleSize()}}catch(I){n={error:I}}finally{try{b&&!b.done&&(a=y.return)&&a.call(y)}finally{if(n)throw n.error}}l=c/o.length,o.sort(function(I,C){if(C.getCount()===I.getCount()){var S=Math.abs(C.getEstimatedModuleSize()-l),E=Math.abs(I.getEstimatedModuleSize()-l);return S<E?1:S>E?-1:0}else return C.getCount()-I.getCount()}),o.splice(3)}return[o[0],o[1],o[2]]},t.CENTER_QUORUM=2,t.MIN_SKIP=3,t.MAX_MODULES=57,t}(),O7e=function(){function t(e){this.image=e}return t.prototype.getImage=function(){return this.image},t.prototype.getResultPointCallback=function(){return this.resultPointCallback},t.prototype.detect=function(e){this.resultPointCallback=e==null?null:e.get(Ns.NEED_RESULT_POINT_CALLBACK);var r=new F7e(this.image,this.resultPointCallback),n=r.find(e);return this.processFinderPatternInfo(n)},t.prototype.processFinderPatternInfo=function(e){var r=e.getTopLeft(),n=e.getTopRight(),a=e.getBottomLeft(),s=this.calculateModuleSize(r,n,a);if(s<1)throw new lr("No pattern found in proccess finder.");var o=t.computeDimension(r,n,a,s),l=zp.getProvisionalVersionForDimension(o),c=l.getDimensionForVersion()-7,u=null;if(l.getAlignmentPatternCenters().length>0)for(var d=n.getX()-r.getX()+a.getX(),f=n.getY()-r.getY()+a.getY(),A=1-3/c,h=Math.floor(r.getX()+A*(d-r.getX())),m=Math.floor(r.getY()+A*(f-r.getY())),p=4;p<=16;p<<=1)try{u=this.findAlignmentInRegion(s,h,m,p);break}catch(b){if(!(b instanceof lr))throw b}var x=t.createTransform(r,n,a,u,o),v=t.sampleGrid(this.image,x,o),y;return u===null?y=[a,r,n]:y=[a,r,n,u],new LR(v,y)},t.createTransform=function(e,r,n,a,s){var o=s-3.5,l,c,u,d;return a!==null?(l=a.getX(),c=a.getY(),u=o-3,d=u):(l=r.getX()-e.getX()+n.getX(),c=r.getY()-e.getY()+n.getY(),u=o,d=o),_se.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,u,d,3.5,o,e.getX(),e.getY(),r.getX(),r.getY(),l,c,n.getX(),n.getY())},t.sampleGrid=function(e,r,n){var a=UR.getInstance();return a.sampleGridWithTransform(e,n,n,r)},t.computeDimension=function(e,r,n,a){var s=ja.round(An.distance(e,r)/a),o=ja.round(An.distance(e,n)/a),l=Math.floor((s+o)/2)+7;switch(l&3){case 0:l++;break;case 2:l--;break;case 3:throw new lr("Dimensions could be not found.")}return l},t.prototype.calculateModuleSize=function(e,r,n){return(this.calculateModuleSizeOneWay(e,r)+this.calculateModuleSizeOneWay(e,n))/2},t.prototype.calculateModuleSizeOneWay=function(e,r){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(r.getX()),Math.floor(r.getY())),a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?a/7:isNaN(a)?n/7:(n+a)/14},t.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,r,n,a){var s=this.sizeOfBlackWhiteBlackRun(e,r,n,a),o=1,l=e-(n-e);l<0?(o=e/(e-l),l=0):l>=this.image.getWidth()&&(o=(this.image.getWidth()-1-e)/(l-e),l=this.image.getWidth()-1);var c=Math.floor(r-(a-r)*o);return o=1,c<0?(o=r/(r-c),c=0):c>=this.image.getHeight()&&(o=(this.image.getHeight()-1-r)/(c-r),c=this.image.getHeight()-1),l=Math.floor(e+(l-e)*o),s+=this.sizeOfBlackWhiteBlackRun(e,r,l,c),s-1},t.prototype.sizeOfBlackWhiteBlackRun=function(e,r,n,a){var s=Math.abs(a-r)>Math.abs(n-e);if(s){var o=e;e=r,r=o,o=n,n=a,a=o}for(var l=Math.abs(n-e),c=Math.abs(a-r),u=-l/2,d=e<n?1:-1,f=r<a?1:-1,A=0,h=n+d,m=e,p=r;m!==h;m+=d){var x=s?p:m,v=s?m:p;if(A===1===this.image.get(x,v)){if(A===2)return ja.distance(m,p,e,r);A++}if(u+=c,u>0){if(p===a)break;p+=f,u-=l}}return A===2?ja.distance(n+d,a,e,r):NaN},t.prototype.findAlignmentInRegion=function(e,r,n,a){var s=Math.floor(a*e),o=Math.max(0,r-s),l=Math.min(this.image.getWidth()-1,r+s);if(l-o<e*3)throw new lr("Alignment top exceeds estimated module size.");var c=Math.max(0,n-s),u=Math.min(this.image.getHeight()-1,n+s);if(u-c<e*3)throw new lr("Alignment bottom exceeds estimated module size.");var d=new P7e(this.image,o,c,l-o,u-c,e,this.resultPointCallback);return d.find()},t}(),aI=function(){function t(){this.decoder=new E7e}return t.prototype.getDecoder=function(){return this.decoder},t.prototype.decode=function(e,r){var n,a;if(r!=null&&r.get(Ns.PURE_BARCODE)!==void 0){var s=t.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(s,r),a=t.NO_POINTS}else{var o=new O7e(e.getBlackMatrix()).detect(r);n=this.decoder.decodeBitMatrix(o.getBits(),r),a=o.getPoints()}n.getOther()instanceof Tse&&n.getOther().applyMirroredCorrection(a);var l=new dc(n.getText(),n.getRawBytes(),void 0,a,jn.QR_CODE,void 0),c=n.getByteSegments();c!==null&&l.putMetadata(Pl.BYTE_SEGMENTS,c);var u=n.getECLevel();return u!==null&&l.putMetadata(Pl.ERROR_CORRECTION_LEVEL,u),n.hasStructuredAppend()&&(l.putMetadata(Pl.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),l.putMetadata(Pl.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),l},t.prototype.reset=function(){},t.extractPureBits=function(e){var r=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(r===null||n===null)throw new lr;var a=this.moduleSize(r,e),s=r[1],o=n[1],l=r[0],c=n[0];if(l>=c||s>=o)throw new lr;if(o-s!==c-l&&(c=l+(o-s),c>=e.getWidth()))throw new lr;var u=Math.round((c-l+1)/a),d=Math.round((o-s+1)/a);if(u<=0||d<=0)throw new lr;if(d!==u)throw new lr;var f=Math.floor(a/2);s+=f,l+=f;var A=l+Math.floor((u-1)*a)-c;if(A>0){if(A>f)throw new lr;l-=A}var h=s+Math.floor((d-1)*a)-o;if(h>0){if(h>f)throw new lr;s-=h}for(var m=new ch(u,d),p=0;p<d;p++)for(var x=s+Math.floor(p*a),v=0;v<u;v++)e.get(l+Math.floor(v*a),x)&&m.set(v,p);return m},t.moduleSize=function(e,r){for(var n=r.getHeight(),a=r.getWidth(),s=e[0],o=e[1],l=!0,c=0;s<a&&o<n;){if(l!==r.get(s,o)){if(++c===5)break;l=!l}s++,o++}if(s===a||o===n)throw new lr;return(s-e[0])/7},t.NO_POINTS=new Array,t}(),D7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Na=function(){function t(){}return t.prototype.PDF417Common=function(){},t.getBitCountSum=function(e){return ja.sum(e)},t.toIntArray=function(e){var r,n;if(e==null||!e.length)return t.EMPTY_INT_ARRAY;var a=new Int32Array(e.length),s=0;try{for(var o=D7e(e),l=o.next();!l.done;l=o.next()){var c=l.value;a[s++]=c}}catch(u){r={error:u}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a},t.getCodeword=function(e){var r=Bo.binarySearch(t.SYMBOL_TABLE,e&262143);return r<0?-1:(t.CODEWORD_TABLE[r]-1)%t.NUMBER_OF_CODEWORDS},t.NUMBER_OF_CODEWORDS=929,t.MAX_CODEWORDS_IN_BARCODE=t.NUMBER_OF_CODEWORDS-1,t.MIN_ROWS_IN_BARCODE=3,t.MAX_ROWS_IN_BARCODE=90,t.MODULES_IN_CODEWORD=17,t.MODULES_IN_STOP_PATTERN=18,t.BARS_IN_MODULE=8,t.EMPTY_INT_ARRAY=new Int32Array([]),t.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),t.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),t}(),R7e=function(){function t(e,r){this.bits=e,this.points=r}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t}(),M7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},L7e=function(){function t(){}return t.detectMultiple=function(e,r,n){var a=e.getBlackMatrix(),s=t.detect(n,a);return s.length||(a=a.clone(),a.rotate180(),s=t.detect(n,a)),new R7e(a,s)},t.detect=function(e,r){for(var n,a,s=new Array,o=0,l=0,c=!1;o<r.getHeight();){var u=t.findVertices(r,o,l);if(u[0]==null&&u[3]==null){if(!c)break;c=!1,l=0;try{for(var d=(n=void 0,M7e(s)),f=d.next();!f.done;f=d.next()){var A=f.value;A[1]!=null&&(o=Math.trunc(Math.max(o,A[1].getY()))),A[3]!=null&&(o=Math.max(o,Math.trunc(A[3].getY())))}}catch(h){n={error:h}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}o+=t.ROW_STEP;continue}if(c=!0,s.push(u),!e)break;u[2]!=null?(l=Math.trunc(u[2].getX()),o=Math.trunc(u[2].getY())):(l=Math.trunc(u[4].getX()),o=Math.trunc(u[4].getY()))}return s},t.findVertices=function(e,r,n){var a=e.getHeight(),s=e.getWidth(),o=new Array(8);return t.copyToResult(o,t.findRowsWithPattern(e,a,s,r,n,t.START_PATTERN),t.INDEXES_START_PATTERN),o[4]!=null&&(n=Math.trunc(o[4].getX()),r=Math.trunc(o[4].getY())),t.copyToResult(o,t.findRowsWithPattern(e,a,s,r,n,t.STOP_PATTERN),t.INDEXES_STOP_PATTERN),o},t.copyToResult=function(e,r,n){for(var a=0;a<n.length;a++)e[n[a]]=r[a]},t.findRowsWithPattern=function(e,r,n,a,s,o){for(var l=new Array(4),c=!1,u=new Int32Array(o.length);a<r;a+=t.ROW_STEP){var d=t.findGuardPattern(e,s,a,n,!1,o,u);if(d!=null){for(;a>0;){var f=t.findGuardPattern(e,s,--a,n,!1,o,u);if(f!=null)d=f;else{a++;break}}l[0]=new An(d[0],a),l[1]=new An(d[1],a),c=!0;break}}var A=a+1;if(c){for(var h=0,f=Int32Array.from([Math.trunc(l[0].getX()),Math.trunc(l[1].getX())]);A<r;A++){var d=t.findGuardPattern(e,f[0],A,n,!1,o,u);if(d!=null&&Math.abs(f[0]-d[0])<t.MAX_PATTERN_DRIFT&&Math.abs(f[1]-d[1])<t.MAX_PATTERN_DRIFT)f=d,h=0;else{if(h>t.SKIPPED_ROW_COUNT_MAX)break;h++}}A-=h+1,l[2]=new An(f[0],A),l[3]=new An(f[1],A)}return A-a<t.BARCODE_MIN_HEIGHT&&Bo.fill(l,null),l},t.findGuardPattern=function(e,r,n,a,s,o,l){Bo.fillWithin(l,0,l.length,0);for(var c=r,u=0;e.get(c,n)&&c>0&&u++<t.MAX_PIXEL_DRIFT;)c--;for(var d=c,f=0,A=o.length,h=s;d<a;d++){var m=e.get(d,n);if(m!==h)l[f]++;else{if(f===A-1){if(t.patternMatchVariance(l,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return new Int32Array([c,d]);c+=l[0]+l[1],ws.arraycopy(l,2,l,0,f-1),l[f-1]=0,l[f]=0,f--}else f++;l[f]=1,h=!h}}return f===A-1&&t.patternMatchVariance(l,o,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE?new Int32Array([c,d-1]):null},t.patternMatchVariance=function(e,r,n){for(var a=e.length,s=0,o=0,l=0;l<a;l++)s+=e[l],o+=r[l];if(s<o)return 1/0;var c=s/o;n*=c;for(var u=0,d=0;d<a;d++){var f=e[d],A=r[d]*c,h=f>A?f-A:A-f;if(h>n)return 1/0;u+=h}return u/s},t.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),t.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),t.MAX_AVG_VARIANCE=.42,t.MAX_INDIVIDUAL_VARIANCE=.8,t.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),t.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),t.MAX_PIXEL_DRIFT=3,t.MAX_PATTERN_DRIFT=5,t.SKIPPED_ROW_COUNT_MAX=25,t.ROW_STEP=5,t.BARCODE_MIN_HEIGHT=10,t}(),U7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Tp=function(){function t(e,r){if(r.length===0)throw new Pn;this.field=e;var n=r.length;if(n>1&&r[0]===0){for(var a=1;a<n&&r[a]===0;)a++;a===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-a),ws.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return this.coefficients[0]===0},t.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},t.prototype.evaluateAt=function(e){var r,n;if(e===0)return this.getCoefficient(0);if(e===1){var a=0;try{for(var s=U7e(this.coefficients),o=s.next();!o.done;o=s.next()){var l=o.value;a=this.field.add(a,l)}}catch(f){r={error:f}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a}for(var c=this.coefficients[0],u=this.coefficients.length,d=1;d<u;d++)c=this.field.add(this.field.multiply(e,c),this.coefficients[d]);return c},t.prototype.add=function(e){if(!this.field.equals(e.field))throw new Pn("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;var r=this.coefficients,n=e.coefficients;if(r.length>n.length){var a=r;r=n,n=a}var s=new Int32Array(n.length),o=n.length-r.length;ws.arraycopy(n,0,s,0,o);for(var l=o;l<n.length;l++)s[l]=this.field.add(r[l-o],n[l]);return new t(this.field,s)},t.prototype.subtract=function(e){if(!this.field.equals(e.field))throw new Pn("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())},t.prototype.multiply=function(e){return e instanceof t?this.multiplyOther(e):this.multiplyScalar(e)},t.prototype.multiplyOther=function(e){if(!this.field.equals(e.field))throw new Pn("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new t(this.field,new Int32Array([0]));for(var r=this.coefficients,n=r.length,a=e.coefficients,s=a.length,o=new Int32Array(n+s-1),l=0;l<n;l++)for(var c=r[l],u=0;u<s;u++)o[l+u]=this.field.add(o[l+u],this.field.multiply(c,a[u]));return new t(this.field,o)},t.prototype.negative=function(){for(var e=this.coefficients.length,r=new Int32Array(e),n=0;n<e;n++)r[n]=this.field.subtract(0,this.coefficients[n]);return new t(this.field,r)},t.prototype.multiplyScalar=function(e){if(e===0)return new t(this.field,new Int32Array([0]));if(e===1)return this;for(var r=this.coefficients.length,n=new Int32Array(r),a=0;a<r;a++)n[a]=this.field.multiply(this.coefficients[a],e);return new t(this.field,n)},t.prototype.multiplyByMonomial=function(e,r){if(e<0)throw new Pn;if(r===0)return new t(this.field,new Int32Array([0]));for(var n=this.coefficients.length,a=new Int32Array(n+e),s=0;s<n;s++)a[s]=this.field.multiply(this.coefficients[s],r);return new t(this.field,a)},t.prototype.toString=function(){for(var e=new ta,r=this.getDegree();r>=0;r--){var n=this.getCoefficient(r);n!==0&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),(r===0||n!==1)&&e.append(n),r!==0&&(r===1?e.append("x"):(e.append("x^"),e.append(r))))}return e.toString()},t}(),Q7e=function(){function t(){}return t.prototype.add=function(e,r){return(e+r)%this.modulus},t.prototype.subtract=function(e,r){return(this.modulus+e-r)%this.modulus},t.prototype.exp=function(e){return this.expTable[e]},t.prototype.log=function(e){if(e===0)throw new Pn;return this.logTable[e]},t.prototype.inverse=function(e){if(e===0)throw new Cse;return this.expTable[this.modulus-this.logTable[e]-1]},t.prototype.multiply=function(e,r){return e===0||r===0?0:this.expTable[(this.logTable[e]+this.logTable[r])%(this.modulus-1)]},t.prototype.getSize=function(){return this.modulus},t.prototype.equals=function(e){return e===this},t}(),V7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),H7e=function(t){V7e(e,t);function e(r,n){var a=t.call(this)||this;a.modulus=r,a.expTable=new Int32Array(r),a.logTable=new Int32Array(r);for(var s=1,o=0;o<r;o++)a.expTable[o]=s,s=s*n%r;for(var o=0;o<r-1;o++)a.logTable[a.expTable[o]]=o;return a.zero=new Tp(a,new Int32Array([0])),a.one=new Tp(a,new Int32Array([1])),a}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(r,n){if(r<0)throw new Pn;if(n===0)return this.zero;var a=new Int32Array(r+1);return a[0]=n,new Tp(this,a)},e.PDF417_GF=new e(Na.NUMBER_OF_CODEWORDS,3),e}(Q7e),$7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},G7e=function(){function t(){this.field=H7e.PDF417_GF}return t.prototype.decode=function(e,r,n){for(var a,s,o=new Tp(this.field,e),l=new Int32Array(r),c=!1,u=r;u>0;u--){var d=o.evaluateAt(this.field.exp(u));l[r-u]=d,d!==0&&(c=!0)}if(!c)return 0;var f=this.field.getOne();if(n!=null)try{for(var A=$7e(n),h=A.next();!h.done;h=A.next()){var m=h.value,p=this.field.exp(e.length-1-m),x=new Tp(this.field,new Int32Array([this.field.subtract(0,p),1]));f=f.multiply(x)}}catch(S){a={error:S}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}for(var v=new Tp(this.field,l),y=this.runEuclideanAlgorithm(this.field.buildMonomial(r,1),v,r),b=y[0],w=y[1],j=this.findErrorLocations(b),I=this.findErrorMagnitudes(w,b,j),u=0;u<j.length;u++){var C=e.length-1-this.field.log(j[u]);if(C<0)throw lo.getChecksumInstance();e[C]=this.field.subtract(e[C],I[u])}return j.length},t.prototype.runEuclideanAlgorithm=function(e,r,n){if(e.getDegree()<r.getDegree()){var a=e;e=r,r=a}for(var s=e,o=r,l=this.field.getZero(),c=this.field.getOne();o.getDegree()>=Math.round(n/2);){var u=s,d=l;if(s=o,l=c,s.isZero())throw lo.getChecksumInstance();o=u;for(var f=this.field.getZero(),A=s.getCoefficient(s.getDegree()),h=this.field.inverse(A);o.getDegree()>=s.getDegree()&&!o.isZero();){var m=o.getDegree()-s.getDegree(),p=this.field.multiply(o.getCoefficient(o.getDegree()),h);f=f.add(this.field.buildMonomial(m,p)),o=o.subtract(s.multiplyByMonomial(m,p))}c=f.multiply(l).subtract(d).negative()}var x=c.getCoefficient(0);if(x===0)throw lo.getChecksumInstance();var v=this.field.inverse(x),y=c.multiply(v),b=o.multiply(v);return[y,b]},t.prototype.findErrorLocations=function(e){for(var r=e.getDegree(),n=new Int32Array(r),a=0,s=1;s<this.field.getSize()&&a<r;s++)e.evaluateAt(s)===0&&(n[a]=this.field.inverse(s),a++);if(a!==r)throw lo.getChecksumInstance();return n},t.prototype.findErrorMagnitudes=function(e,r,n){for(var a=r.getDegree(),s=new Int32Array(a),o=1;o<=a;o++)s[a-o]=this.field.multiply(o,r.getCoefficient(o));for(var l=new Tp(this.field,s),c=n.length,u=new Int32Array(c),o=0;o<c;o++){var d=this.field.inverse(n[o]),f=this.field.subtract(0,e.evaluateAt(d)),A=this.field.inverse(l.evaluateAt(d));u[o]=this.field.multiply(f,A)}return u},t}(),pF=function(){function t(e,r,n,a,s){e instanceof t?this.constructor_2(e):this.constructor_1(e,r,n,a,s)}return t.prototype.constructor_1=function(e,r,n,a,s){var o=r==null||n==null,l=a==null||s==null;if(o&&l)throw new lr;o?(r=new An(0,a.getY()),n=new An(0,s.getY())):l&&(a=new An(e.getWidth()-1,r.getY()),s=new An(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=r,this.bottomLeft=n,this.topRight=a,this.bottomRight=s,this.minX=Math.trunc(Math.min(r.getX(),n.getX())),this.maxX=Math.trunc(Math.max(a.getX(),s.getX())),this.minY=Math.trunc(Math.min(r.getY(),a.getY())),this.maxY=Math.trunc(Math.max(n.getY(),s.getY()))},t.prototype.constructor_2=function(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()},t.merge=function(e,r){return e==null?r:r==null?e:new t(e.image,e.topLeft,e.bottomLeft,r.topRight,r.bottomRight)},t.prototype.addMissingRows=function(e,r,n){var a=this.topLeft,s=this.bottomLeft,o=this.topRight,l=this.bottomRight;if(e>0){var c=n?this.topLeft:this.topRight,u=Math.trunc(c.getY()-e);u<0&&(u=0);var d=new An(c.getX(),u);n?a=d:o=d}if(r>0){var f=n?this.bottomLeft:this.bottomRight,A=Math.trunc(f.getY()+r);A>=this.image.getHeight()&&(A=this.image.getHeight()-1);var h=new An(f.getX(),A);n?s=h:l=h}return new t(this.image,a,s,o,l)},t.prototype.getMinX=function(){return this.minX},t.prototype.getMaxX=function(){return this.maxX},t.prototype.getMinY=function(){return this.minY},t.prototype.getMaxY=function(){return this.maxY},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getBottomRight=function(){return this.bottomRight},t}(),K7e=function(){function t(e,r,n,a){this.columnCount=e,this.errorCorrectionLevel=a,this.rowCountUpperPart=r,this.rowCountLowerPart=n,this.rowCount=r+n}return t.prototype.getColumnCount=function(){return this.columnCount},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getRowCount=function(){return this.rowCount},t.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},t.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart},t}(),VR=function(){function t(){this.buffer=""}return t.form=function(e,r){var n=-1;function a(o,l,c,u,d,f){if(o==="%%")return"%";if(r[++n]!==void 0){o=u?parseInt(u.substr(1)):void 0;var A=d?parseInt(d.substr(1)):void 0,h;switch(f){case"s":h=r[n];break;case"c":h=r[n][0];break;case"f":h=parseFloat(r[n]).toFixed(o);break;case"p":h=parseFloat(r[n]).toPrecision(o);break;case"e":h=parseFloat(r[n]).toExponential(o);break;case"x":h=parseInt(r[n]).toString(A||16);break;case"d":h=parseFloat(parseInt(r[n],A||10).toPrecision(o)).toFixed(0);break}h=typeof h=="object"?JSON.stringify(h):(+h).toString(A);for(var m=parseInt(c),p=c&&c[0]+""=="0"?"0":" ";h.length<m;)h=l!==void 0?h+p:p+h;return h}}var s=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(s,a)},t.prototype.format=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.buffer+=t.form(e,r)},t.prototype.toString=function(){return this.buffer},t}(),q7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Bse=function(){function t(e){this.boundingBox=new pF(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}return t.prototype.getCodewordNearby=function(e){var r=this.getCodeword(e);if(r!=null)return r;for(var n=1;n<t.MAX_NEARBY_DISTANCE;n++){var a=this.imageRowToCodewordIndex(e)-n;if(a>=0&&(r=this.codewords[a],r!=null)||(a=this.imageRowToCodewordIndex(e)+n,a<this.codewords.length&&(r=this.codewords[a],r!=null)))return r}return null},t.prototype.imageRowToCodewordIndex=function(e){return e-this.boundingBox.getMinY()},t.prototype.setCodeword=function(e,r){this.codewords[this.imageRowToCodewordIndex(e)]=r},t.prototype.getCodeword=function(e){return this.codewords[this.imageRowToCodewordIndex(e)]},t.prototype.getBoundingBox=function(){return this.boundingBox},t.prototype.getCodewords=function(){return this.codewords},t.prototype.toString=function(){var e,r,n=new VR,a=0;try{for(var s=q7e(this.codewords),o=s.next();!o.done;o=s.next()){var l=o.value;if(l==null){n.format("%3d:    |   %n",a++);continue}n.format("%3d: %3d|%3d%n",a++,l.getRowNumber(),l.getValue())}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return n.toString()},t.MAX_NEARBY_DISTANCE=5,t}(),z7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},W7e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),a,s=[],o;try{for(;(e===void 0||e-- >0)&&!(a=n.next()).done;)s.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s},eb=function(){function t(){this.values=new Map}return t.prototype.setValue=function(e){e=Math.trunc(e);var r=this.values.get(e);r==null&&(r=0),r++,this.values.set(e,r)},t.prototype.getValue=function(){var e,r,n=-1,a=new Array,s=function(f,A){var h={getKey:function(){return f},getValue:function(){return A}};h.getValue()>n?(n=h.getValue(),a=[],a.push(h.getKey())):h.getValue()===n&&a.push(h.getKey())};try{for(var o=z7e(this.values.entries()),l=o.next();!l.done;l=o.next()){var c=W7e(l.value,2),u=c[0],d=c[1];s(u,d)}}catch(f){e={error:f}}finally{try{l&&!l.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return Na.toIntArray(a)},t.prototype.getConfidence=function(e){return this.values.get(e)},t}(),X7e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),W5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},q$=function(t){X7e(e,t);function e(r,n){var a=t.call(this,r)||this;return a._isLeft=n,a}return e.prototype.setRowNumbers=function(){var r,n;try{for(var a=W5(this.getCodewords()),s=a.next();!s.done;s=a.next()){var o=s.value;o!=null&&o.setRowNumberAsRowIndicatorColumn()}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e.prototype.adjustCompleteIndicatorColumnRowNumbers=function(r){var n=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(n,r);for(var a=this.getBoundingBox(),s=this._isLeft?a.getTopLeft():a.getTopRight(),o=this._isLeft?a.getBottomLeft():a.getBottomRight(),l=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=this.imageRowToCodewordIndex(Math.trunc(o.getY())),u=-1,d=1,f=0,A=l;A<c;A++)if(n[A]!=null){var h=n[A],m=h.getRowNumber()-u;if(m===0)f++;else if(m===1)d=Math.max(d,f),f=1,u=h.getRowNumber();else if(m<0||h.getRowNumber()>=r.getRowCount()||m>A)n[A]=null;else{var p=void 0;d>2?p=(d-2)*m:p=m;for(var x=p>=A,v=1;v<=p&&!x;v++)x=n[A-v]!=null;x?n[A]=null:(u=h.getRowNumber(),f=1)}}},e.prototype.getRowHeights=function(){var r,n,a=this.getBarcodeMetadata();if(a==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(a);var s=new Int32Array(a.getRowCount());try{for(var o=W5(this.getCodewords()),l=o.next();!l.done;l=o.next()){var c=l.value;if(c!=null){var u=c.getRowNumber();if(u>=s.length)continue;s[u]++}}}catch(d){r={error:d}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s},e.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(r){for(var n=this.getBoundingBox(),a=this._isLeft?n.getTopLeft():n.getTopRight(),s=this._isLeft?n.getBottomLeft():n.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(a.getY())),l=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=this.getCodewords(),u=-1,d=o;d<l;d++)if(c[d]!=null){var f=c[d];f.setRowNumberAsRowIndicatorColumn();var A=f.getRowNumber()-u;A===0||(A===1?u=f.getRowNumber():f.getRowNumber()>=r.getRowCount()?c[d]=null:u=f.getRowNumber())}},e.prototype.getBarcodeMetadata=function(){var r,n,a=this.getCodewords(),s=new eb,o=new eb,l=new eb,c=new eb;try{for(var u=W5(a),d=u.next();!d.done;d=u.next()){var f=d.value;if(f!=null){f.setRowNumberAsRowIndicatorColumn();var A=f.getValue()%30,h=f.getRowNumber();switch(this._isLeft||(h+=2),h%3){case 0:o.setValue(A*3+1);break;case 1:c.setValue(A/3),l.setValue(A%3);break;case 2:s.setValue(A+1);break}}}}catch(p){r={error:p}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}if(s.getValue().length===0||o.getValue().length===0||l.getValue().length===0||c.getValue().length===0||s.getValue()[0]<1||o.getValue()[0]+l.getValue()[0]<Na.MIN_ROWS_IN_BARCODE||o.getValue()[0]+l.getValue()[0]>Na.MAX_ROWS_IN_BARCODE)return null;var m=new K7e(s.getValue()[0],o.getValue()[0],l.getValue()[0],c.getValue()[0]);return this.removeIncorrectCodewords(a,m),m},e.prototype.removeIncorrectCodewords=function(r,n){for(var a=0;a<r.length;a++){var s=r[a];if(r[a]!=null){var o=s.getValue()%30,l=s.getRowNumber();if(l>n.getRowCount()){r[a]=null;continue}switch(this._isLeft||(l+=2),l%3){case 0:o*3+1!==n.getRowCountUpperPart()&&(r[a]=null);break;case 1:(Math.trunc(o/3)!==n.getErrorCorrectionLevel()||o%3!==n.getRowCountLowerPart())&&(r[a]=null);break;case 2:o+1!==n.getColumnCount()&&(r[a]=null);break}}}},e.prototype.isLeft=function(){return this._isLeft},e.prototype.toString=function(){return"IsLeft: "+this._isLeft+`
`+t.prototype.toString.call(this)},e}(Bse),Y7e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},J7e=function(){function t(e,r){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=r,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}return t.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);var e=Na.MAX_CODEWORDS_IN_BARCODE,r;do r=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<r);return this.detectionResultColumns},t.prototype.adjustIndicatorColumnRowNumbers=function(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},t.prototype.adjustRowNumbersAndGetCount=function(){var e=this.adjustRowNumbersByRow();if(e===0)return 0;for(var r=1;r<this.barcodeColumnCount+1;r++)for(var n=this.detectionResultColumns[r].getCodewords(),a=0;a<n.length;a++)n[a]!=null&&(n[a].hasValidRowNumber()||this.adjustRowNumbers(r,a,n));return e},t.prototype.adjustRowNumbersByRow=function(){this.adjustRowNumbersFromBothRI();var e=this.adjustRowNumbersFromLRI();return e+this.adjustRowNumbersFromRRI()},t.prototype.adjustRowNumbersFromBothRI=function(){if(!(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)){for(var e=this.detectionResultColumns[0].getCodewords(),r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<e.length;n++)if(e[n]!=null&&r[n]!=null&&e[n].getRowNumber()===r[n].getRowNumber())for(var a=1;a<=this.barcodeColumnCount;a++){var s=this.detectionResultColumns[a].getCodewords()[n];s!=null&&(s.setRowNumber(e[n].getRowNumber()),s.hasValidRowNumber()||(this.detectionResultColumns[a].getCodewords()[n]=null))}}},t.prototype.adjustRowNumbersFromRRI=function(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;for(var e=0,r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<r.length;n++)if(r[n]!=null)for(var a=r[n].getRowNumber(),s=0,o=this.barcodeColumnCount+1;o>0&&s<this.ADJUST_ROW_NUMBER_SKIP;o--){var l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(s=t.adjustRowNumberIfValid(a,s,l),l.hasValidRowNumber()||e++)}return e},t.prototype.adjustRowNumbersFromLRI=function(){if(this.detectionResultColumns[0]==null)return 0;for(var e=0,r=this.detectionResultColumns[0].getCodewords(),n=0;n<r.length;n++)if(r[n]!=null)for(var a=r[n].getRowNumber(),s=0,o=1;o<this.barcodeColumnCount+1&&s<this.ADJUST_ROW_NUMBER_SKIP;o++){var l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(s=t.adjustRowNumberIfValid(a,s,l),l.hasValidRowNumber()||e++)}return e},t.adjustRowNumberIfValid=function(e,r,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),r=0):++r),r},t.prototype.adjustRowNumbers=function(e,r,n){var a,s;if(this.detectionResultColumns[e-1]!=null){var o=n[r],l=this.detectionResultColumns[e-1].getCodewords(),c=l;this.detectionResultColumns[e+1]!=null&&(c=this.detectionResultColumns[e+1].getCodewords());var u=new Array(14);u[2]=l[r],u[3]=c[r],r>0&&(u[0]=n[r-1],u[4]=l[r-1],u[5]=c[r-1]),r>1&&(u[8]=n[r-2],u[10]=l[r-2],u[11]=c[r-2]),r<n.length-1&&(u[1]=n[r+1],u[6]=l[r+1],u[7]=c[r+1]),r<n.length-2&&(u[9]=n[r+2],u[12]=l[r+2],u[13]=c[r+2]);try{for(var d=Y7e(u),f=d.next();!f.done;f=d.next()){var A=f.value;if(t.adjustRowNumber(o,A))return}}catch(h){a={error:h}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}}},t.adjustRowNumber=function(e,r){return r==null?!1:r.hasValidRowNumber()&&r.getBucket()===e.getBucket()?(e.setRowNumber(r.getRowNumber()),!0):!1},t.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},t.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},t.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},t.prototype.setBoundingBox=function(e){this.boundingBox=e},t.prototype.getBoundingBox=function(){return this.boundingBox},t.prototype.setDetectionResultColumn=function(e,r){this.detectionResultColumns[e]=r},t.prototype.getDetectionResultColumn=function(e){return this.detectionResultColumns[e]},t.prototype.toString=function(){var e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);for(var r=new VR,n=0;n<e.getCodewords().length;n++){r.format("CW %3d:",n);for(var a=0;a<this.barcodeColumnCount+2;a++){if(this.detectionResultColumns[a]==null){r.format("    |   ");continue}var s=this.detectionResultColumns[a].getCodewords()[n];if(s==null){r.format("    |   ");continue}r.format(" %3d|%3d",s.getRowNumber(),s.getValue())}r.format("%n")}return r.toString()},t}(),Z7e=function(){function t(e,r,n,a){this.rowNumber=t.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(r),this.bucket=Math.trunc(n),this.value=Math.trunc(a)}return t.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},t.prototype.isValidRowNumber=function(e){return e!==t.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3},t.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))},t.prototype.getWidth=function(){return this.endX-this.startX},t.prototype.getStartX=function(){return this.startX},t.prototype.getEndX=function(){return this.endX},t.prototype.getBucket=function(){return this.bucket},t.prototype.getValue=function(){return this.value},t.prototype.getRowNumber=function(){return this.rowNumber},t.prototype.setRowNumber=function(e){this.rowNumber=e},t.prototype.toString=function(){return this.rowNumber+"|"+this.value},t.BARCODE_ROW_UNKNOWN=-1,t}(),e9e=function(){function t(){}return t.initialize=function(){for(var e=0;e<Na.SYMBOL_TABLE.length;e++)for(var r=Na.SYMBOL_TABLE[e],n=r&1,a=0;a<Na.BARS_IN_MODULE;a++){for(var s=0;(r&1)===n;)s+=1,r>>=1;n=r&1,t.RATIOS_TABLE[e]||(t.RATIOS_TABLE[e]=new Array(Na.BARS_IN_MODULE)),t.RATIOS_TABLE[e][Na.BARS_IN_MODULE-a-1]=Math.fround(s/Na.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},t.getDecodedValue=function(e){var r=t.getDecodedCodewordValue(t.sampleBitCounts(e));return r!==-1?r:t.getClosestDecodedValue(e)},t.sampleBitCounts=function(e){for(var r=ja.sum(e),n=new Int32Array(Na.BARS_IN_MODULE),a=0,s=0,o=0;o<Na.MODULES_IN_CODEWORD;o++){var l=r/(2*Na.MODULES_IN_CODEWORD)+o*r/Na.MODULES_IN_CODEWORD;s+e[a]<=l&&(s+=e[a],a++),n[a]++}return n},t.getDecodedCodewordValue=function(e){var r=t.getBitValue(e);return Na.getCodeword(r)===-1?-1:r},t.getBitValue=function(e){for(var r=0,n=0;n<e.length;n++)for(var a=0;a<e[n];a++)r=r<<1|(n%2===0?1:0);return Math.trunc(r)},t.getClosestDecodedValue=function(e){var r=ja.sum(e),n=new Array(Na.BARS_IN_MODULE);if(r>1)for(var a=0;a<n.length;a++)n[a]=Math.fround(e[a]/r);var s=hF.MAX_VALUE,o=-1;this.bSymbolTableReady||t.initialize();for(var l=0;l<t.RATIOS_TABLE.length;l++){for(var c=0,u=t.RATIOS_TABLE[l],d=0;d<Na.BARS_IN_MODULE;d++){var f=Math.fround(u[d]-n[d]);if(c+=Math.fround(f*f),c>=s)break}c<s&&(s=c,o=Na.SYMBOL_TABLE[l])}return o},t.bSymbolTableReady=!1,t.RATIOS_TABLE=new Array(Na.SYMBOL_TABLE.length).map(function(e){return new Array(Na.BARS_IN_MODULE)}),t}(),t9e=function(){function t(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}return t.prototype.getSegmentIndex=function(){return this.segmentIndex},t.prototype.setSegmentIndex=function(e){this.segmentIndex=e},t.prototype.getFileId=function(){return this.fileId},t.prototype.setFileId=function(e){this.fileId=e},t.prototype.getOptionalData=function(){return this.optionalData},t.prototype.setOptionalData=function(e){this.optionalData=e},t.prototype.isLastSegment=function(){return this.lastSegment},t.prototype.setLastSegment=function(e){this.lastSegment=e},t.prototype.getSegmentCount=function(){return this.segmentCount},t.prototype.setSegmentCount=function(e){this.segmentCount=e},t.prototype.getSender=function(){return this.sender||null},t.prototype.setSender=function(e){this.sender=e},t.prototype.getAddressee=function(){return this.addressee||null},t.prototype.setAddressee=function(e){this.addressee=e},t.prototype.getFileName=function(){return this.fileName},t.prototype.setFileName=function(e){this.fileName=e},t.prototype.getFileSize=function(){return this.fileSize},t.prototype.setFileSize=function(e){this.fileSize=e},t.prototype.getChecksum=function(){return this.checksum},t.prototype.setChecksum=function(e){this.checksum=e},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.setTimestamp=function(e){this.timestamp=e},t}(),z$=function(){function t(){}return t.parseLong=function(e,r){return r===void 0&&(r=void 0),parseInt(e,r)},t}(),r9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),n9e=function(t){r9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="NullPointerException",e}(du),a9e=function(){function t(){}return t.prototype.writeBytes=function(e){this.writeBytesOffset(e,0,e.length)},t.prototype.writeBytesOffset=function(e,r,n){if(e==null)throw new n9e;if(r<0||r>e.length||n<0||r+n>e.length||r+n<0)throw new MR;if(n===0)return;for(var a=0;a<n;a++)this.write(e[r+a])},t.prototype.flush=function(){},t.prototype.close=function(){},t}(),s9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),i9e=function(t){s9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(du),o9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),l9e=function(t){o9e(e,t);function e(r){r===void 0&&(r=32);var n=t.call(this)||this;if(n.count=0,r<0)throw new Pn("Negative initial size: "+r);return n.buf=new Uint8Array(r),n}return e.prototype.ensureCapacity=function(r){r-this.buf.length>0&&this.grow(r)},e.prototype.grow=function(r){var n=this.buf.length,a=n<<1;if(a-r<0&&(a=r),a<0){if(r<0)throw new i9e;a=sa.MAX_VALUE}this.buf=Bo.copyOfUint8Array(this.buf,a)},e.prototype.write=function(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1},e.prototype.writeBytesOffset=function(r,n,a){if(n<0||n>r.length||a<0||n+a-r.length>0)throw new MR;this.ensureCapacity(this.count+a),ws.arraycopy(r,n,this.buf,this.count,a),this.count+=a},e.prototype.writeTo=function(r){r.writeBytesOffset(this.buf,0,this.count)},e.prototype.reset=function(){this.count=0},e.prototype.toByteArray=function(){return Bo.copyOfUint8Array(this.buf,this.count)},e.prototype.size=function(){return this.count},e.prototype.toString=function(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()},e.prototype.toString_void=function(){return new String(this.buf).toString()},e.prototype.toString_string=function(r){return new String(this.buf).toString()},e.prototype.toString_number=function(r){return new String(this.buf).toString()},e.prototype.close=function(){},e}(a9e),is;(function(t){t[t.ALPHA=0]="ALPHA",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.PUNCT=3]="PUNCT",t[t.ALPHA_SHIFT=4]="ALPHA_SHIFT",t[t.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(is||(is={}));function kse(){if(typeof window<"u")return window.BigInt||null;if(typeof global<"u")return global.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}var c_;function P0(t){if(typeof c_>"u"&&(c_=kse()),c_===null)throw new Error("BigInt is not supported!");return c_(t)}function c9e(){var t=[];t[0]=P0(1);var e=P0(900);t[1]=e;for(var r=2;r<16;r++)t[r]=t[r-1]*e;return t}var u9e=function(){function t(){}return t.decode=function(e,r){var n=new ta(""),a=Po.ISO8859_1;n.enableDecoding(a);for(var s=1,o=e[s++],l=new t9e;s<e[0];){switch(o){case t.TEXT_COMPACTION_MODE_LATCH:s=t.textCompaction(e,s,n);break;case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:s=t.byteCompaction(o,e,a,s,n);break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s++]);break;case t.NUMERIC_COMPACTION_MODE_LATCH:s=t.numericCompaction(e,s,n);break;case t.ECI_CHARSET:Po.getCharacterSetECIByValue(e[s++]);break;case t.ECI_GENERAL_PURPOSE:s+=2;break;case t.ECI_USER_DEFINED:s++;break;case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:s=t.decodeMacroBlock(e,s,l);break;case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:throw new qr;default:s--,s=t.textCompaction(e,s,n);break}if(s<e.length)o=e[s++];else throw qr.getFormatInstance()}if(n.length()===0)throw qr.getFormatInstance();var c=new yP(null,n.toString(),null,r);return c.setOther(l),c},t.decodeMacroBlock=function(e,r,n){if(r+t.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw qr.getFormatInstance();for(var a=new Int32Array(t.NUMBER_OF_SEQUENCE_CODEWORDS),s=0;s<t.NUMBER_OF_SEQUENCE_CODEWORDS;s++,r++)a[s]=e[r];n.setSegmentIndex(sa.parseInt(t.decodeBase900toBase10(a,t.NUMBER_OF_SEQUENCE_CODEWORDS)));var o=new ta;r=t.textCompaction(e,r,o),n.setFileId(o.toString());var l=-1;for(e[r]===t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(l=r+1);r<e[0];)switch(e[r]){case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(r++,e[r]){case t.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var c=new ta;r=t.textCompaction(e,r+1,c),n.setFileName(c.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_SENDER:var u=new ta;r=t.textCompaction(e,r+1,u),n.setSender(u.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var d=new ta;r=t.textCompaction(e,r+1,d),n.setAddressee(d.toString());break;case t.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:var f=new ta;r=t.numericCompaction(e,r+1,f),n.setSegmentCount(sa.parseInt(f.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var A=new ta;r=t.numericCompaction(e,r+1,A),n.setTimestamp(z$.parseLong(A.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:var h=new ta;r=t.numericCompaction(e,r+1,h),n.setChecksum(sa.parseInt(h.toString()));break;case t.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var m=new ta;r=t.numericCompaction(e,r+1,m),n.setFileSize(z$.parseLong(m.toString()));break;default:throw qr.getFormatInstance()}break;case t.MACRO_PDF417_TERMINATOR:r++,n.setLastSegment(!0);break;default:throw qr.getFormatInstance()}if(l!==-1){var p=r-l;n.isLastSegment()&&p--,n.setOptionalData(Bo.copyOfRange(e,l,l+p))}return r},t.textCompaction=function(e,r,n){for(var a=new Int32Array((e[0]-r)*2),s=new Int32Array((e[0]-r)*2),o=0,l=!1;r<e[0]&&!l;){var c=e[r++];if(c<t.TEXT_COMPACTION_MODE_LATCH)a[o]=c/30,a[o+1]=c%30,o+=2;else switch(c){case t.TEXT_COMPACTION_MODE_LATCH:a[o++]=t.TEXT_COMPACTION_MODE_LATCH;break;case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:r--,l=!0;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a[o]=t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,c=e[r++],s[o]=c,o++;break}}return t.decodeTextCompaction(a,s,o,n),r},t.decodeTextCompaction=function(e,r,n,a){for(var s=is.ALPHA,o=is.ALPHA,l=0;l<n;){var c=e[l],u="";switch(s){case is.ALPHA:if(c<26)u=String.fromCharCode(65+c);else switch(c){case 26:u=" ";break;case t.LL:s=is.LOWER;break;case t.ML:s=is.MIXED;break;case t.PS:o=s,s=is.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.LOWER:if(c<26)u=String.fromCharCode(97+c);else switch(c){case 26:u=" ";break;case t.AS:o=s,s=is.ALPHA_SHIFT;break;case t.ML:s=is.MIXED;break;case t.PS:o=s,s=is.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.MIXED:if(c<t.PL)u=t.MIXED_CHARS[c];else switch(c){case t.PL:s=is.PUNCT;break;case 26:u=" ";break;case t.LL:s=is.LOWER;break;case t.AL:s=is.ALPHA;break;case t.PS:o=s,s=is.PUNCT_SHIFT;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.PUNCT:if(c<t.PAL)u=t.PUNCT_CHARS[c];else switch(c){case t.PAL:s=is.ALPHA;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.ALPHA_SHIFT:if(s=o,c<26)u=String.fromCharCode(65+c);else switch(c){case 26:u=" ";break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break;case is.PUNCT_SHIFT:if(s=o,c<t.PAL)u=t.PUNCT_CHARS[c];else switch(c){case t.PAL:s=is.ALPHA;break;case t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case t.TEXT_COMPACTION_MODE_LATCH:s=is.ALPHA;break}break}u!==""&&a.append(u),l++}},t.byteCompaction=function(e,r,n,a,s){var o=new l9e,l=0,c=0,u=!1;switch(e){case t.BYTE_COMPACTION_MODE_LATCH:for(var d=new Int32Array(6),f=r[a++];a<r[0]&&!u;)switch(d[l++]=f,c=900*c+f,f=r[a++],f){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:a--,u=!0;break;default:if(l%5===0&&l>0){for(var A=0;A<6;++A)o.write(Number(P0(c)>>P0(8*(5-A))));c=0,l=0}break}a===r[0]&&f<t.TEXT_COMPACTION_MODE_LATCH&&(d[l++]=f);for(var h=0;h<l;h++)o.write(d[h]);break;case t.BYTE_COMPACTION_MODE_LATCH_6:for(;a<r[0]&&!u;){var m=r[a++];if(m<t.TEXT_COMPACTION_MODE_LATCH)l++,c=900*c+m;else switch(m){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.NUMERIC_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:a--,u=!0;break}if(l%5===0&&l>0){for(var A=0;A<6;++A)o.write(Number(P0(c)>>P0(8*(5-A))));c=0,l=0}}break}return s.append(Bd.decode(o.toByteArray(),n)),a},t.numericCompaction=function(e,r,n){for(var a=0,s=!1,o=new Int32Array(t.MAX_NUMERIC_CODEWORDS);r<e[0]&&!s;){var l=e[r++];if(r===e[0]&&(s=!0),l<t.TEXT_COMPACTION_MODE_LATCH)o[a]=l,a++;else switch(l){case t.TEXT_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH:case t.BYTE_COMPACTION_MODE_LATCH_6:case t.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case t.MACRO_PDF417_TERMINATOR:r--,s=!0;break}(a%t.MAX_NUMERIC_CODEWORDS===0||l===t.NUMERIC_COMPACTION_MODE_LATCH||s)&&a>0&&(n.append(t.decodeBase900toBase10(o,a)),a=0)}return r},t.decodeBase900toBase10=function(e,r){for(var n=P0(0),a=0;a<r;a++)n+=t.EXP900[r-a-1]*P0(e[a]);var s=n.toString();if(s.charAt(0)!=="1")throw new qr;return s.substring(1)},t.TEXT_COMPACTION_MODE_LATCH=900,t.BYTE_COMPACTION_MODE_LATCH=901,t.NUMERIC_COMPACTION_MODE_LATCH=902,t.BYTE_COMPACTION_MODE_LATCH_6=924,t.ECI_USER_DEFINED=925,t.ECI_GENERAL_PURPOSE=926,t.ECI_CHARSET=927,t.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,t.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,t.MACRO_PDF417_TERMINATOR=922,t.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,t.MAX_NUMERIC_CODEWORDS=15,t.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,t.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,t.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,t.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,t.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,t.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,t.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,t.PL=25,t.LL=27,t.AS=27,t.ML=28,t.AL=28,t.PS=29,t.PAL=29,t.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,t.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",t.EXP900=kse()?c9e():[],t.NUMBER_OF_SEQUENCE_CODEWORDS=2,t}(),wy=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},d9e=function(){function t(){}return t.decode=function(e,r,n,a,s,o,l){for(var c=new pF(e,r,n,a,s),u=null,d=null,f,A=!0;;A=!1){if(r!=null&&(u=t.getRowIndicatorColumn(e,c,r,!0,o,l)),a!=null&&(d=t.getRowIndicatorColumn(e,c,a,!1,o,l)),f=t.merge(u,d),f==null)throw lr.getNotFoundInstance();var h=f.getBoundingBox();if(A&&h!=null&&(h.getMinY()<c.getMinY()||h.getMaxY()>c.getMaxY()))c=h;else break}f.setBoundingBox(c);var m=f.getBarcodeColumnCount()+1;f.setDetectionResultColumn(0,u),f.setDetectionResultColumn(m,d);for(var p=u!=null,x=1;x<=m;x++){var v=p?x:m-x;if(f.getDetectionResultColumn(v)===void 0){var y=void 0;v===0||v===m?y=new q$(c,v===0):y=new Bse(c),f.setDetectionResultColumn(v,y);for(var b=-1,w=b,j=c.getMinY();j<=c.getMaxY();j++){if(b=t.getStartColumn(f,v,j,p),b<0||b>c.getMaxX()){if(w===-1)continue;b=w}var I=t.detectCodeword(e,c.getMinX(),c.getMaxX(),p,b,j,o,l);I!=null&&(y.setCodeword(j,I),w=b,o=Math.min(o,I.getWidth()),l=Math.max(l,I.getWidth()))}}}return t.createDecoderResult(f)},t.merge=function(e,r){if(e==null&&r==null)return null;var n=t.getBarcodeMetadata(e,r);if(n==null)return null;var a=pF.merge(t.adjustBoundingBox(e),t.adjustBoundingBox(r));return new J7e(n,a)},t.adjustBoundingBox=function(e){var r,n;if(e==null)return null;var a=e.getRowHeights();if(a==null)return null;var s=t.getMax(a),o=0;try{for(var l=wy(a),c=l.next();!c.done;c=l.next()){var u=c.value;if(o+=s-u,u>0)break}}catch(h){r={error:h}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}for(var d=e.getCodewords(),f=0;o>0&&d[f]==null;f++)o--;for(var A=0,f=a.length-1;f>=0&&(A+=s-a[f],!(a[f]>0));f--);for(var f=d.length-1;A>0&&d[f]==null;f--)A--;return e.getBoundingBox().addMissingRows(o,A,e.isLeft())},t.getMax=function(e){var r,n,a=-1;try{for(var s=wy(e),o=s.next();!o.done;o=s.next()){var l=o.value;a=Math.max(a,l)}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a},t.getBarcodeMetadata=function(e,r){var n;if(e==null||(n=e.getBarcodeMetadata())==null)return r==null?null:r.getBarcodeMetadata();var a;return r==null||(a=r.getBarcodeMetadata())==null?n:n.getColumnCount()!==a.getColumnCount()&&n.getErrorCorrectionLevel()!==a.getErrorCorrectionLevel()&&n.getRowCount()!==a.getRowCount()?null:n},t.getRowIndicatorColumn=function(e,r,n,a,s,o){for(var l=new q$(r,a),c=0;c<2;c++)for(var u=c===0?1:-1,d=Math.trunc(Math.trunc(n.getX())),f=Math.trunc(Math.trunc(n.getY()));f<=r.getMaxY()&&f>=r.getMinY();f+=u){var A=t.detectCodeword(e,0,e.getWidth(),a,d,f,s,o);A!=null&&(l.setCodeword(f,A),a?d=A.getStartX():d=A.getEndX())}return l},t.adjustCodewordCount=function(e,r){var n=r[0][1],a=n.getValue(),s=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-t.getNumberOfECCodeWords(e.getBarcodeECLevel());if(a.length===0){if(s<1||s>Na.MAX_CODEWORDS_IN_BARCODE)throw lr.getNotFoundInstance();n.setValue(s)}else a[0]!==s&&n.setValue(s)},t.createDecoderResult=function(e){var r=t.createBarcodeMatrix(e);t.adjustCodewordCount(e,r);for(var n=new Array,a=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),s=[],o=new Array,l=0;l<e.getBarcodeRowCount();l++)for(var c=0;c<e.getBarcodeColumnCount();c++){var u=r[l][c+1].getValue(),d=l*e.getBarcodeColumnCount()+c;u.length===0?n.push(d):u.length===1?a[d]=u[0]:(o.push(d),s.push(u))}for(var f=new Array(s.length),A=0;A<f.length;A++)f[A]=s[A];return t.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),a,Na.toIntArray(n),Na.toIntArray(o),f)},t.createDecoderResultFromAmbiguousValues=function(e,r,n,a,s){for(var o=new Int32Array(a.length),l=100;l-- >0;){for(var c=0;c<o.length;c++)r[a[c]]=s[c][o[c]];try{return t.decodeCodewords(r,e,n)}catch(d){var u=d instanceof lo;if(!u)throw d}if(o.length===0)throw lo.getChecksumInstance();for(var c=0;c<o.length;c++)if(o[c]<s[c].length-1){o[c]++;break}else if(o[c]=0,c===o.length-1)throw lo.getChecksumInstance()}throw lo.getChecksumInstance()},t.createBarcodeMatrix=function(e){for(var r,n,a,s,o=Array.from({length:e.getBarcodeRowCount()},function(){return new Array(e.getBarcodeColumnCount()+2)}),l=0;l<o.length;l++)for(var c=0;c<o[l].length;c++)o[l][c]=new eb;var u=0;try{for(var d=wy(e.getDetectionResultColumns()),f=d.next();!f.done;f=d.next()){var A=f.value;if(A!=null)try{for(var h=(a=void 0,wy(A.getCodewords())),m=h.next();!m.done;m=h.next()){var p=m.value;if(p!=null){var x=p.getRowNumber();if(x>=0){if(x>=o.length)continue;o[x][u].setValue(p.getValue())}}}}catch(v){a={error:v}}finally{try{m&&!m.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}u++}}catch(v){r={error:v}}finally{try{f&&!f.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}return o},t.isValidBarcodeColumn=function(e,r){return r>=0&&r<=e.getBarcodeColumnCount()+1},t.getStartColumn=function(e,r,n,a){var s,o,l=a?1:-1,c=null;if(t.isValidBarcodeColumn(e,r-l)&&(c=e.getDetectionResultColumn(r-l).getCodeword(n)),c!=null)return a?c.getEndX():c.getStartX();if(c=e.getDetectionResultColumn(r).getCodewordNearby(n),c!=null)return a?c.getStartX():c.getEndX();if(t.isValidBarcodeColumn(e,r-l)&&(c=e.getDetectionResultColumn(r-l).getCodewordNearby(n)),c!=null)return a?c.getEndX():c.getStartX();for(var u=0;t.isValidBarcodeColumn(e,r-l);){r-=l;try{for(var d=(s=void 0,wy(e.getDetectionResultColumn(r).getCodewords())),f=d.next();!f.done;f=d.next()){var A=f.value;if(A!=null)return(a?A.getEndX():A.getStartX())+l*u*(A.getEndX()-A.getStartX())}}catch(h){s={error:h}}finally{try{f&&!f.done&&(o=d.return)&&o.call(d)}finally{if(s)throw s.error}}u++}return a?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()},t.detectCodeword=function(e,r,n,a,s,o,l,c){s=t.adjustCodewordStartColumn(e,r,n,a,s,o);var u=t.getModuleBitCount(e,r,n,a,s,o);if(u==null)return null;var d,f=ja.sum(u);if(a)d=s+f;else{for(var A=0;A<u.length/2;A++){var h=u[A];u[A]=u[u.length-1-A],u[u.length-1-A]=h}d=s,s=d-f}if(!t.checkCodewordSkew(f,l,c))return null;var m=e9e.getDecodedValue(u),p=Na.getCodeword(m);return p===-1?null:new Z7e(s,d,t.getCodewordBucketNumber(m),p)},t.getModuleBitCount=function(e,r,n,a,s,o){for(var l=s,c=new Int32Array(8),u=0,d=a?1:-1,f=a;(a?l<n:l>=r)&&u<c.length;)e.get(l,o)===f?(c[u]++,l+=d):(u++,f=!f);return u===c.length||l===(a?n:r)&&u===c.length-1?c:null},t.getNumberOfECCodeWords=function(e){return 2<<e},t.adjustCodewordStartColumn=function(e,r,n,a,s,o){for(var l=s,c=a?-1:1,u=0;u<2;u++){for(;(a?l>=r:l<n)&&a===e.get(l,o);){if(Math.abs(s-l)>t.CODEWORD_SKEW_SIZE)return s;l+=c}c=-c,a=!a}return l},t.checkCodewordSkew=function(e,r,n){return r-t.CODEWORD_SKEW_SIZE<=e&&e<=n+t.CODEWORD_SKEW_SIZE},t.decodeCodewords=function(e,r,n){if(e.length===0)throw qr.getFormatInstance();var a=1<<r+1,s=t.correctErrors(e,n,a);t.verifyCodewordCount(e,a);var o=u9e.decode(e,""+r);return o.setErrorsCorrected(s),o.setErasures(n.length),o},t.correctErrors=function(e,r,n){if(r!=null&&r.length>n/2+t.MAX_ERRORS||n<0||n>t.MAX_EC_CODEWORDS)throw lo.getChecksumInstance();return t.errorCorrection.decode(e,n,r)},t.verifyCodewordCount=function(e,r){if(e.length<4)throw qr.getFormatInstance();var n=e[0];if(n>e.length)throw qr.getFormatInstance();if(n===0)if(r<e.length)e[0]=e.length-r;else throw qr.getFormatInstance()},t.getBitCountForCodeword=function(e){for(var r=new Int32Array(8),n=0,a=r.length-1;!((e&1)!==n&&(n=e&1,a--,a<0));)r[a]++,e>>=1;return r},t.getCodewordBucketNumber=function(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)},t.getCodewordBucketNumber_number=function(e){return t.getCodewordBucketNumber(t.getBitCountForCodeword(e))},t.getCodewordBucketNumber_Int32Array=function(e){return(e[0]-e[2]+e[4]-e[6]+9)%9},t.toString=function(e){for(var r=new VR,n=0;n<e.length;n++){r.format("Row %2d: ",n);for(var a=0;a<e[n].length;a++){var s=e[n][a];s.getValue().length===0?r.format("        ",null):r.format("%4d(%2d)",s.getValue()[0],s.getConfidence(s.getValue()[0]))}r.format("%n")}return r.toString()},t.CODEWORD_SKEW_SIZE=2,t.MAX_ERRORS=3,t.MAX_EC_CODEWORDS=512,t.errorCorrection=new G7e,t}(),f9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},sI=function(){function t(){}return t.prototype.decode=function(e,r){r===void 0&&(r=null);var n=t.decode(e,r,!1);if(n==null||n.length===0||n[0]==null)throw lr.getNotFoundInstance();return n[0]},t.prototype.decodeMultiple=function(e,r){r===void 0&&(r=null);try{return t.decode(e,r,!0)}catch(n){throw n instanceof qr||n instanceof lo?lr.getNotFoundInstance():n}},t.decode=function(e,r,n){var a,s,o=new Array,l=L7e.detectMultiple(e,r,n);try{for(var c=f9e(l.getPoints()),u=c.next();!u.done;u=c.next()){var d=u.value,f=d9e.decode(l.getBits(),d[4],d[5],d[6],d[7],t.getMinCodewordWidth(d),t.getMaxCodewordWidth(d)),A=new dc(f.getText(),f.getRawBytes(),void 0,d,jn.PDF_417);A.putMetadata(Pl.ERROR_CORRECTION_LEVEL,f.getECLevel());var h=f.getOther();h!=null&&A.putMetadata(Pl.PDF417_EXTRA_METADATA,h),o.push(A)}}catch(m){a={error:m}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}return o.map(function(m){return m})},t.getMaxWidth=function(e,r){return e==null||r==null?0:Math.trunc(Math.abs(e.getX()-r.getX()))},t.getMinWidth=function(e,r){return e==null||r==null?sa.MAX_VALUE:Math.trunc(Math.abs(e.getX()-r.getX()))},t.getMaxCodewordWidth=function(e){return Math.floor(Math.max(Math.max(t.getMaxWidth(e[0],e[4]),t.getMaxWidth(e[6],e[2])*Na.MODULES_IN_CODEWORD/Na.MODULES_IN_STOP_PATTERN),Math.max(t.getMaxWidth(e[1],e[5]),t.getMaxWidth(e[7],e[3])*Na.MODULES_IN_CODEWORD/Na.MODULES_IN_STOP_PATTERN)))},t.getMinCodewordWidth=function(e){return Math.floor(Math.min(Math.min(t.getMinWidth(e[0],e[4]),t.getMinWidth(e[6],e[2])*Na.MODULES_IN_CODEWORD/Na.MODULES_IN_STOP_PATTERN),Math.min(t.getMinWidth(e[1],e[5]),t.getMinWidth(e[7],e[3])*Na.MODULES_IN_CODEWORD/Na.MODULES_IN_STOP_PATTERN)))},t.prototype.reset=function(){},t}(),h9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),W$=function(t){h9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="ReaderException",e}(du),X$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Fse=function(){function t(){}return t.prototype.decode=function(e,r){return this.setHints(r),this.decodeInternal(e)},t.prototype.decodeWithState=function(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)},t.prototype.setHints=function(e){this.hints=e;var r=e!=null&&e.get(Ns.TRY_HARDER)!==void 0,n=e==null?null:e.get(Ns.POSSIBLE_FORMATS),a=new Array;if(n!=null){var s=n.some(function(o){return o===jn.UPC_A||o===jn.UPC_E||o===jn.EAN_13||o===jn.EAN_8||o===jn.CODABAR||o===jn.CODE_39||o===jn.CODE_93||o===jn.CODE_128||o===jn.ITF||o===jn.RSS_14||o===jn.RSS_EXPANDED});s&&!r&&a.push(new Zx(e)),n.includes(jn.QR_CODE)&&a.push(new aI),n.includes(jn.DATA_MATRIX)&&a.push(new nI),n.includes(jn.AZTEC)&&a.push(new tI),n.includes(jn.PDF_417)&&a.push(new sI),s&&r&&a.push(new Zx(e))}a.length===0&&(r||a.push(new Zx(e)),a.push(new aI),a.push(new nI),a.push(new tI),a.push(new sI),r&&a.push(new Zx(e))),this.readers=a},t.prototype.reset=function(){var e,r;if(this.readers!==null)try{for(var n=X$(this.readers),a=n.next();!a.done;a=n.next()){var s=a.value;s.reset()}}catch(o){e={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.decodeInternal=function(e){var r,n;if(this.readers===null)throw new W$("No readers where selected, nothing can be read.");try{for(var a=X$(this.readers),s=a.next();!s.done;s=a.next()){var o=s.value;try{return o.decode(e,this.hints)}catch(l){if(l instanceof W$)continue}}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}throw new lr("No MultiFormat Readers were able to detect the code.")},t}(),A9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){A9e(e,t);function e(r,n){r===void 0&&(r=null),n===void 0&&(n=500);var a=this,s=new Fse;return s.setHints(r),a=t.call(this,s,n)||this,a}return e.prototype.decodeBitmap=function(r){return this.reader.decodeWithState(r)},e})(C1);var m9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){m9e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new sI,r)||this}return e})(C1);var p9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){p9e(e,t);function e(r){return r===void 0&&(r=500),t.call(this,new aI,r)||this}return e})(C1);var gF;(function(t){t[t.ERROR_CORRECTION=0]="ERROR_CORRECTION",t[t.CHARACTER_SET=1]="CHARACTER_SET",t[t.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",t[t.DATA_MATRIX_COMPACT=3]="DATA_MATRIX_COMPACT",t[t.MIN_SIZE=4]="MIN_SIZE",t[t.MAX_SIZE=5]="MAX_SIZE",t[t.MARGIN=6]="MARGIN",t[t.PDF417_COMPACT=7]="PDF417_COMPACT",t[t.PDF417_COMPACTION=8]="PDF417_COMPACTION",t[t.PDF417_DIMENSIONS=9]="PDF417_DIMENSIONS",t[t.AZTEC_LAYERS=10]="AZTEC_LAYERS",t[t.QR_VERSION=11]="QR_VERSION",t[t.GS1_FORMAT=12]="GS1_FORMAT",t[t.FORCE_C40=13]="FORCE_C40"})(gF||(gF={}));const u_=gF;var Ose=function(){function t(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new mm(e,Int32Array.from([1])))}return t.prototype.buildGenerator=function(e){var r=this.cachedGenerators;if(e>=r.length)for(var n=r[r.length-1],a=this.field,s=r.length;s<=e;s++){var o=n.multiply(new mm(a,Int32Array.from([1,a.exp(s-1+a.getGeneratorBase())])));r.push(o),n=o}return r[e]},t.prototype.encode=function(e,r){if(r===0)throw new Pn("No error correction bytes");var n=e.length-r;if(n<=0)throw new Pn("No data bytes provided");var a=this.buildGenerator(r),s=new Int32Array(n);ws.arraycopy(e,0,s,0,n);var o=new mm(this.field,s);o=o.multiplyByMonomial(r,1);for(var l=o.divide(a)[1],c=l.getCoefficients(),u=r-c.length,d=0;d<u;d++)e[n+d]=0;ws.arraycopy(c,0,e,n+u,c.length)},t}(),tb=function(){function t(){}return t.applyMaskPenaltyRule1=function(e){return t.applyMaskPenaltyRule1Internal(e,!0)+t.applyMaskPenaltyRule1Internal(e,!1)},t.applyMaskPenaltyRule2=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s-1;o++)for(var l=n[o],c=0;c<a-1;c++){var u=l[c];u===l[c+1]&&u===n[o+1][c]&&u===n[o+1][c+1]&&r++}return t.N2*r},t.applyMaskPenaltyRule3=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s;o++)for(var l=0;l<a;l++){var c=n[o];l+6<a&&c[l]===1&&c[l+1]===0&&c[l+2]===1&&c[l+3]===1&&c[l+4]===1&&c[l+5]===0&&c[l+6]===1&&(t.isWhiteHorizontal(c,l-4,l)||t.isWhiteHorizontal(c,l+7,l+11))&&r++,o+6<s&&n[o][l]===1&&n[o+1][l]===0&&n[o+2][l]===1&&n[o+3][l]===1&&n[o+4][l]===1&&n[o+5][l]===0&&n[o+6][l]===1&&(t.isWhiteVertical(n,l,o-4,o)||t.isWhiteVertical(n,l,o+7,o+11))&&r++}return r*t.N3},t.isWhiteHorizontal=function(e,r,n){r=Math.max(r,0),n=Math.min(n,e.length);for(var a=r;a<n;a++)if(e[a]===1)return!1;return!0},t.isWhiteVertical=function(e,r,n,a){n=Math.max(n,0),a=Math.min(a,e.length);for(var s=n;s<a;s++)if(e[s][r]===1)return!1;return!0},t.applyMaskPenaltyRule4=function(e){for(var r=0,n=e.getArray(),a=e.getWidth(),s=e.getHeight(),o=0;o<s;o++)for(var l=n[o],c=0;c<a;c++)l[c]===1&&r++;var u=e.getHeight()*e.getWidth(),d=Math.floor(Math.abs(r*2-u)*10/u);return d*t.N4},t.getDataMaskBit=function(e,r,n){var a,s;switch(e){case 0:a=n+r&1;break;case 1:a=n&1;break;case 2:a=r%3;break;case 3:a=(n+r)%3;break;case 4:a=Math.floor(n/2)+Math.floor(r/3)&1;break;case 5:s=n*r,a=(s&1)+s%3;break;case 6:s=n*r,a=(s&1)+s%3&1;break;case 7:s=n*r,a=s%3+(n+r&1)&1;break;default:throw new Pn("Invalid mask pattern: "+e)}return a===0},t.applyMaskPenaltyRule1Internal=function(e,r){for(var n=0,a=r?e.getHeight():e.getWidth(),s=r?e.getWidth():e.getHeight(),o=e.getArray(),l=0;l<a;l++){for(var c=0,u=-1,d=0;d<s;d++){var f=r?o[l][d]:o[d][l];f===u?c++:(c>=5&&(n+=t.N1+(c-5)),c=1,u=f)}c>=5&&(n+=t.N1+(c-5))}return n},t.N1=3,t.N2=3,t.N3=40,t.N4=10,t}(),g9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},x9e=function(){function t(e,r){this.width=e,this.height=r;for(var n=new Array(r),a=0;a!==r;a++)n[a]=new Uint8Array(e);this.bytes=n}return t.prototype.getHeight=function(){return this.height},t.prototype.getWidth=function(){return this.width},t.prototype.get=function(e,r){return this.bytes[r][e]},t.prototype.getArray=function(){return this.bytes},t.prototype.setNumber=function(e,r,n){this.bytes[r][e]=n},t.prototype.setBoolean=function(e,r,n){this.bytes[r][e]=n?1:0},t.prototype.clear=function(e){var r,n;try{for(var a=g9e(this.bytes),s=a.next();!s.done;s=a.next()){var o=s.value;Bo.fill(o,e)}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;if(this.width!==r.width||this.height!==r.height)return!1;for(var n=0,a=this.height;n<a;++n)for(var s=this.bytes[n],o=r.bytes[n],l=0,c=this.width;l<c;++l)if(s[l]!==o[l])return!1;return!0},t.prototype.toString=function(){for(var e=new ta,r=0,n=this.height;r<n;++r){for(var a=this.bytes[r],s=0,o=this.width;s<o;++s)switch(a[s]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()},t}(),xF=function(){function t(){this.maskPattern=-1}return t.prototype.getMode=function(){return this.mode},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getVersion=function(){return this.version},t.prototype.getMaskPattern=function(){return this.maskPattern},t.prototype.getMatrix=function(){return this.matrix},t.prototype.toString=function(){var e=new ta;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()},t.prototype.setMode=function(e){this.mode=e},t.prototype.setECLevel=function(e){this.ecLevel=e},t.prototype.setVersion=function(e){this.version=e},t.prototype.setMaskPattern=function(e){this.maskPattern=e},t.prototype.setMatrix=function(e){this.matrix=e},t.isValidMaskPattern=function(e){return e>=0&&e<t.NUM_MASK_PATTERNS},t.NUM_MASK_PATTERNS=8,t}(),v9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),js=function(t){v9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.kind="WriterException",e}(du),Y$=function(){function t(){}return t.clearMatrix=function(e){e.clear(255)},t.buildMatrix=function(e,r,n,a,s){t.clearMatrix(s),t.embedBasicPatterns(n,s),t.embedTypeInfo(r,a,s),t.maybeEmbedVersionInfo(n,s),t.embedDataBits(e,a,s)},t.embedBasicPatterns=function(e,r){t.embedPositionDetectionPatternsAndSeparators(r),t.embedDarkDotAtLeftBottomCorner(r),t.maybeEmbedPositionAdjustmentPatterns(e,r),t.embedTimingPatterns(r)},t.embedTypeInfo=function(e,r,n){var a=new tl;t.makeTypeInfoBits(e,r,a);for(var s=0,o=a.getSize();s<o;++s){var l=a.get(a.getSize()-1-s),c=t.TYPE_INFO_COORDINATES[s],u=c[0],d=c[1];if(n.setBoolean(u,d,l),s<8){var f=n.getWidth()-s-1,A=8;n.setBoolean(f,A,l)}else{var f=8,A=n.getHeight()-7+(s-8);n.setBoolean(f,A,l)}}},t.maybeEmbedVersionInfo=function(e,r){if(!(e.getVersionNumber()<7)){var n=new tl;t.makeVersionInfoBits(e,n);for(var a=6*3-1,s=0;s<6;++s)for(var o=0;o<3;++o){var l=n.get(a);a--,r.setBoolean(s,r.getHeight()-11+o,l),r.setBoolean(r.getHeight()-11+o,s,l)}}},t.embedDataBits=function(e,r,n){for(var a=0,s=-1,o=n.getWidth()-1,l=n.getHeight()-1;o>0;){for(o===6&&(o-=1);l>=0&&l<n.getHeight();){for(var c=0;c<2;++c){var u=o-c;if(t.isEmpty(n.get(u,l))){var d=void 0;a<e.getSize()?(d=e.get(a),++a):d=!1,r!==255&&tb.getDataMaskBit(r,u,l)&&(d=!d),n.setBoolean(u,l,d)}}l+=s}s=-s,l+=s,o-=2}if(a!==e.getSize())throw new js("Not all bits consumed: "+a+"/"+e.getSize())},t.findMSBSet=function(e){return 32-sa.numberOfLeadingZeros(e)},t.calculateBCHCode=function(e,r){if(r===0)throw new Pn("0 polynomial");var n=t.findMSBSet(r);for(e<<=n-1;t.findMSBSet(e)>=n;)e^=r<<t.findMSBSet(e)-n;return e},t.makeTypeInfoBits=function(e,r,n){if(!xF.isValidMaskPattern(r))throw new js("Invalid mask pattern");var a=e.getBits()<<3|r;n.appendBits(a,5);var s=t.calculateBCHCode(a,t.TYPE_INFO_POLY);n.appendBits(s,10);var o=new tl;if(o.appendBits(t.TYPE_INFO_MASK_PATTERN,15),n.xor(o),n.getSize()!==15)throw new js("should not happen but we got: "+n.getSize())},t.makeVersionInfoBits=function(e,r){r.appendBits(e.getVersionNumber(),6);var n=t.calculateBCHCode(e.getVersionNumber(),t.VERSION_INFO_POLY);if(r.appendBits(n,12),r.getSize()!==18)throw new js("should not happen but we got: "+r.getSize())},t.isEmpty=function(e){return e===255},t.embedTimingPatterns=function(e){for(var r=8;r<e.getWidth()-8;++r){var n=(r+1)%2;t.isEmpty(e.get(r,6))&&e.setNumber(r,6,n),t.isEmpty(e.get(6,r))&&e.setNumber(6,r,n)}},t.embedDarkDotAtLeftBottomCorner=function(e){if(e.get(8,e.getHeight()-8)===0)throw new js;e.setNumber(8,e.getHeight()-8,1)},t.embedHorizontalSeparationPattern=function(e,r,n){for(var a=0;a<8;++a){if(!t.isEmpty(n.get(e+a,r)))throw new js;n.setNumber(e+a,r,0)}},t.embedVerticalSeparationPattern=function(e,r,n){for(var a=0;a<7;++a){if(!t.isEmpty(n.get(e,r+a)))throw new js;n.setNumber(e,r+a,0)}},t.embedPositionAdjustmentPattern=function(e,r,n){for(var a=0;a<5;++a)for(var s=t.POSITION_ADJUSTMENT_PATTERN[a],o=0;o<5;++o)n.setNumber(e+o,r+a,s[o])},t.embedPositionDetectionPattern=function(e,r,n){for(var a=0;a<7;++a)for(var s=t.POSITION_DETECTION_PATTERN[a],o=0;o<7;++o)n.setNumber(e+o,r+a,s[o])},t.embedPositionDetectionPatternsAndSeparators=function(e){var r=t.POSITION_DETECTION_PATTERN[0].length;t.embedPositionDetectionPattern(0,0,e),t.embedPositionDetectionPattern(e.getWidth()-r,0,e),t.embedPositionDetectionPattern(0,e.getWidth()-r,e);var n=8;t.embedHorizontalSeparationPattern(0,n-1,e),t.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),t.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);var a=7;t.embedVerticalSeparationPattern(a,0,e),t.embedVerticalSeparationPattern(e.getHeight()-a-1,0,e),t.embedVerticalSeparationPattern(a,e.getHeight()-a,e)},t.maybeEmbedPositionAdjustmentPatterns=function(e,r){if(!(e.getVersionNumber()<2))for(var n=e.getVersionNumber()-1,a=t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n],s=0,o=a.length;s!==o;s++){var l=a[s];if(l>=0)for(var c=0;c!==o;c++){var u=a[c];u>=0&&t.isEmpty(r.get(u,l))&&t.embedPositionAdjustmentPattern(u-2,l-2,r)}}},t.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),t.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),t.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),t.VERSION_INFO_POLY=7973,t.TYPE_INFO_POLY=1335,t.TYPE_INFO_MASK_PATTERN=21522,t}(),y9e=function(){function t(e,r){this.dataBytes=e,this.errorCorrectionBytes=r}return t.prototype.getDataBytes=function(){return this.dataBytes},t.prototype.getErrorCorrectionBytes=function(){return this.errorCorrectionBytes},t}(),J$=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function t(){}return t.calculateMaskPenalty=function(e){return tb.applyMaskPenaltyRule1(e)+tb.applyMaskPenaltyRule2(e)+tb.applyMaskPenaltyRule3(e)+tb.applyMaskPenaltyRule4(e)},t.encode=function(e,r,n){n===void 0&&(n=null);var a=t.DEFAULT_BYTE_MODE_ENCODING,s=n!==null&&n.get(u_.CHARACTER_SET)!==void 0;s&&(a=n.get(u_.CHARACTER_SET).toString());var o=this.chooseMode(e,a),l=new tl;if(o===Ps.BYTE&&(s||t.DEFAULT_BYTE_MODE_ENCODING!==a)){var c=Po.getCharacterSetECIByName(a);c!==void 0&&this.appendECI(c,l)}this.appendModeInfo(o,l);var u=new tl;this.appendBytes(e,o,u,a);var d;if(n!==null&&n.get(u_.QR_VERSION)!==void 0){var f=Number.parseInt(n.get(u_.QR_VERSION).toString(),10);d=zp.getVersionForNumber(f);var A=this.calculateBitsNeeded(o,l,u,d);if(!this.willFit(A,d,r))throw new js("Data too big for requested version")}else d=this.recommendVersion(r,o,l,u);var h=new tl;h.appendBitArray(l);var m=o===Ps.BYTE?u.getSizeInBytes():e.length;this.appendLengthInfo(m,d,o,h),h.appendBitArray(u);var p=d.getECBlocksForLevel(r),x=d.getTotalCodewords()-p.getTotalECCodewords();this.terminateBits(x,h);var v=this.interleaveWithECBytes(h,d.getTotalCodewords(),x,p.getNumBlocks()),y=new xF;y.setECLevel(r),y.setMode(o),y.setVersion(d);var b=d.getDimensionForVersion(),w=new x9e(b,b),j=this.chooseMaskPattern(v,r,d,w);return y.setMaskPattern(j),Y$.buildMatrix(v,r,d,j,w),y.setMatrix(w),y},t.recommendVersion=function(e,r,n,a){var s=this.calculateBitsNeeded(r,n,a,zp.getVersionForNumber(1)),o=this.chooseVersion(s,e),l=this.calculateBitsNeeded(r,n,a,o);return this.chooseVersion(l,e)},t.calculateBitsNeeded=function(e,r,n,a){return r.getSize()+e.getCharacterCountBits(a)+n.getSize()},t.getAlphanumericCode=function(e){return e<t.ALPHANUMERIC_TABLE.length?t.ALPHANUMERIC_TABLE[e]:-1},t.chooseMode=function(e,r){if(r===void 0&&(r=null),Po.SJIS.getName()===r&&this.isOnlyDoubleByteKanji(e))return Ps.KANJI;for(var n=!1,a=!1,s=0,o=e.length;s<o;++s){var l=e.charAt(s);if(t.isDigit(l))n=!0;else if(this.getAlphanumericCode(l.charCodeAt(0))!==-1)a=!0;else return Ps.BYTE}return a?Ps.ALPHANUMERIC:n?Ps.NUMERIC:Ps.BYTE},t.isOnlyDoubleByteKanji=function(e){var r;try{r=Bd.encode(e,Po.SJIS)}catch{return!1}var n=r.length;if(n%2!==0)return!1;for(var a=0;a<n;a+=2){var s=r[a]&255;if((s<129||s>159)&&(s<224||s>235))return!1}return!0},t.chooseMaskPattern=function(e,r,n,a){for(var s=Number.MAX_SAFE_INTEGER,o=-1,l=0;l<xF.NUM_MASK_PATTERNS;l++){Y$.buildMatrix(e,r,n,l,a);var c=this.calculateMaskPenalty(a);c<s&&(s=c,o=l)}return o},t.chooseVersion=function(e,r){for(var n=1;n<=40;n++){var a=zp.getVersionForNumber(n);if(t.willFit(e,a,r))return a}throw new js("Data too big")},t.willFit=function(e,r,n){var a=r.getTotalCodewords(),s=r.getECBlocksForLevel(n),o=s.getTotalECCodewords(),l=a-o,c=(e+7)/8;return l>=c},t.terminateBits=function(e,r){var n=e*8;if(r.getSize()>n)throw new js("data bits cannot fit in the QR Code"+r.getSize()+" > "+n);for(var a=0;a<4&&r.getSize()<n;++a)r.appendBit(!1);var s=r.getSize()&7;if(s>0)for(var a=s;a<8;a++)r.appendBit(!1);for(var o=e-r.getSizeInBytes(),a=0;a<o;++a)r.appendBits(a&1?17:236,8);if(r.getSize()!==n)throw new js("Bits size does not equal capacity")},t.getNumDataBytesAndNumECBytesForBlockID=function(e,r,n,a,s,o){if(a>=n)throw new js("Block ID too large");var l=e%n,c=n-l,u=Math.floor(e/n),d=u+1,f=Math.floor(r/n),A=f+1,h=u-f,m=d-A;if(h!==m)throw new js("EC bytes mismatch");if(n!==c+l)throw new js("RS blocks mismatch");if(e!==(f+h)*c+(A+m)*l)throw new js("Total bytes mismatch");a<c?(s[0]=f,o[0]=h):(s[0]=A,o[0]=m)},t.interleaveWithECBytes=function(e,r,n,a){var s,o,l,c;if(e.getSizeInBytes()!==n)throw new js("Number of bits and data bytes does not match");for(var u=0,d=0,f=0,A=new Array,h=0;h<a;++h){var m=new Int32Array(1),p=new Int32Array(1);t.getNumDataBytesAndNumECBytesForBlockID(r,n,a,h,m,p);var x=m[0],v=new Uint8Array(x);e.toBytes(8*u,v,0,x);var y=t.generateECBytes(v,p[0]);A.push(new y9e(v,y)),d=Math.max(d,x),f=Math.max(f,y.length),u+=m[0]}if(n!==u)throw new js("Data bytes does not match offset");for(var b=new tl,h=0;h<d;++h)try{for(var w=(s=void 0,J$(A)),j=w.next();!j.done;j=w.next()){var I=j.value,v=I.getDataBytes();h<v.length&&b.appendBits(v[h],8)}}catch(B){s={error:B}}finally{try{j&&!j.done&&(o=w.return)&&o.call(w)}finally{if(s)throw s.error}}for(var h=0;h<f;++h)try{for(var C=(l=void 0,J$(A)),S=C.next();!S.done;S=C.next()){var I=S.value,y=I.getErrorCorrectionBytes();h<y.length&&b.appendBits(y[h],8)}}catch(B){l={error:B}}finally{try{S&&!S.done&&(c=C.return)&&c.call(C)}finally{if(l)throw l.error}}if(r!==b.getSizeInBytes())throw new js("Interleaving error: "+r+" and "+b.getSizeInBytes()+" differ.");return b},t.generateECBytes=function(e,r){for(var n=e.length,a=new Int32Array(n+r),s=0;s<n;s++)a[s]=e[s]&255;new Ose(tu.QR_CODE_FIELD_256).encode(a,r);for(var o=new Uint8Array(r),s=0;s<r;s++)o[s]=a[n+s];return o},t.appendModeInfo=function(e,r){r.appendBits(e.getBits(),4)},t.appendLengthInfo=function(e,r,n,a){var s=n.getCharacterCountBits(r);if(e>=1<<s)throw new js(e+" is bigger than "+((1<<s)-1));a.appendBits(e,s)},t.appendBytes=function(e,r,n,a){switch(r){case Ps.NUMERIC:t.appendNumericBytes(e,n);break;case Ps.ALPHANUMERIC:t.appendAlphanumericBytes(e,n);break;case Ps.BYTE:t.append8BitBytes(e,n,a);break;case Ps.KANJI:t.appendKanjiBytes(e,n);break;default:throw new js("Invalid mode: "+r)}},t.getDigit=function(e){return e.charCodeAt(0)-48},t.isDigit=function(e){var r=t.getDigit(e);return r>=0&&r<=9},t.appendNumericBytes=function(e,r){for(var n=e.length,a=0;a<n;){var s=t.getDigit(e.charAt(a));if(a+2<n){var o=t.getDigit(e.charAt(a+1)),l=t.getDigit(e.charAt(a+2));r.appendBits(s*100+o*10+l,10),a+=3}else if(a+1<n){var o=t.getDigit(e.charAt(a+1));r.appendBits(s*10+o,7),a+=2}else r.appendBits(s,4),a++}},t.appendAlphanumericBytes=function(e,r){for(var n=e.length,a=0;a<n;){var s=t.getAlphanumericCode(e.charCodeAt(a));if(s===-1)throw new js;if(a+1<n){var o=t.getAlphanumericCode(e.charCodeAt(a+1));if(o===-1)throw new js;r.appendBits(s*45+o,11),a+=2}else r.appendBits(s,6),a++}},t.append8BitBytes=function(e,r,n){var a;try{a=Bd.encode(e,n)}catch(c){throw new js(c)}for(var s=0,o=a.length;s!==o;s++){var l=a[s];r.appendBits(l,8)}},t.appendKanjiBytes=function(e,r){var n;try{n=Bd.encode(e,Po.SJIS)}catch(f){throw new js(f)}for(var a=n.length,s=0;s<a;s+=2){var o=n[s]&255,l=n[s+1]&255,c=o<<8&4294967295|l,u=-1;if(c>=33088&&c<=40956?u=c-33088:c>=57408&&c<=60351&&(u=c-49472),u===-1)throw new js("Invalid byte sequence");var d=(u>>8)*192+(u&255);r.appendBits(d,13)}},t.appendECI=function(e,r){r.appendBits(Ps.ECI.getBits(),4),r.appendBits(e.getValue(),8)},t.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),t.DEFAULT_BYTE_MODE_ENCODING=Po.UTF8.getName(),t})();var b9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){b9e(e,t);function e(r,n,a,s,o,l,c,u){var d=t.call(this,l,c)||this;if(d.yuvData=r,d.dataWidth=n,d.dataHeight=a,d.left=s,d.top=o,s+l>n||o+c>a)throw new Pn("Crop rectangle does not fit within image data.");return u&&d.reverseHorizontal(l,c),d}return e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var s=(r+this.top)*this.dataWidth+this.left;return ws.arraycopy(this.yuvData,s,n,0,a),n},e.prototype.getMatrix=function(){var r=this.getWidth(),n=this.getHeight();if(r===this.dataWidth&&n===this.dataHeight)return this.yuvData;var a=r*n,s=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return ws.arraycopy(this.yuvData,o,s,0,a),s;for(var l=0;l<n;l++){var c=l*r;ws.arraycopy(this.yuvData,o,s,c,r),o+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return new e(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+n,a,s,!1)},e.prototype.renderThumbnail=function(){for(var r=this.getWidth()/e.THUMBNAIL_SCALE_FACTOR,n=this.getHeight()/e.THUMBNAIL_SCALE_FACTOR,a=new Int32Array(r*n),s=this.yuvData,o=this.top*this.dataWidth+this.left,l=0;l<n;l++){for(var c=l*r,u=0;u<r;u++){var d=s[o+u*e.THUMBNAIL_SCALE_FACTOR]&255;a[c+u]=4278190080|d*65793}o+=this.dataWidth*e.THUMBNAIL_SCALE_FACTOR}return a},e.prototype.getThumbnailWidth=function(){return this.getWidth()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.getThumbnailHeight=function(){return this.getHeight()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.reverseHorizontal=function(r,n){for(var a=this.yuvData,s=0,o=this.top*this.dataWidth+this.left;s<n;s++,o+=this.dataWidth)for(var l=o+r/2,c=o,u=o+r-1;c<l;c++,u--){var d=a[c];a[c]=a[u],a[u]=d}},e.prototype.invert=function(){return new vP(this)},e.THUMBNAIL_SCALE_FACTOR=2,e})(qw);var w9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){w9e(e,t);function e(r,n,a,s,o,l,c){var u=t.call(this,n,a)||this;if(u.dataWidth=s,u.dataHeight=o,u.left=l,u.top=c,r.BYTES_PER_ELEMENT===4){for(var d=n*a,f=new Uint8ClampedArray(d),A=0;A<d;A++){var h=r[A],m=h>>16&255,p=h>>7&510,x=h&255;f[A]=(m+p+x)/4&255}u.luminances=f}else u.luminances=r;if(s===void 0&&(u.dataWidth=n),o===void 0&&(u.dataHeight=a),l===void 0&&(u.left=0),c===void 0&&(u.top=0),u.left+n>u.dataWidth||u.top+a>u.dataHeight)throw new Pn("Crop rectangle does not fit within image data.");return u}return e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var s=(r+this.top)*this.dataWidth+this.left;return ws.arraycopy(this.luminances,s,n,0,a),n},e.prototype.getMatrix=function(){var r=this.getWidth(),n=this.getHeight();if(r===this.dataWidth&&n===this.dataHeight)return this.luminances;var a=r*n,s=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return ws.arraycopy(this.luminances,o,s,0,a),s;for(var l=0;l<n;l++){var c=l*r;ws.arraycopy(this.luminances,o,s,c,r),o+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return new e(this.luminances,a,s,this.dataWidth,this.dataHeight,this.left+r,this.top+n)},e.prototype.invert=function(){return new vP(this)},e})(qw);var N9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),C9e=function(t){N9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.forName=function(r){return this.getCharacterSetECIByName(r)},e}(Po),_9e=function(){function t(){}return t.ISO_8859_1=Po.ISO8859_1,t}(),vF,E9e=301,S9e=function(t,e){for(var r=1,n=0;n<255;n++)e[n]=r,t[r]=n,r*=2,r>=256&&(r^=E9e);return{LOG:t,ALOG:e}};vF=S9e([],[]),vF.LOG;vF.ALOG;var Z$;(function(t){t[t.FORCE_NONE=0]="FORCE_NONE",t[t.FORCE_SQUARE=1]="FORCE_SQUARE",t[t.FORCE_RECTANGLE=2]="FORCE_RECTANGLE"})(Z$||(Z$={}));var eG=129,Dse=230,I9e=231,j9e=235,P9e=236,T9e=237,B9e=238,k9e=239,F9e=240,X5=254,O9e=254,tG="[)>05",rG="[)>06",nG="",Xa=0,vl=1,vc=2,wo=3,zo=4,Xl=5,D9e=function(){function t(){}return t.prototype.getEncodingMode=function(){return Xa},t.prototype.encode=function(e){var r=cf.determineConsecutiveDigitCount(e.getMessage(),e.pos);if(r>=2)e.writeCodeword(this.encodeASCIIDigits(e.getMessage().charCodeAt(e.pos),e.getMessage().charCodeAt(e.pos+1))),e.pos+=2;else{var n=e.getCurrentChar(),a=cf.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode())switch(a){case Xl:e.writeCodeword(I9e),e.signalEncoderChange(Xl);return;case vl:e.writeCodeword(Dse),e.signalEncoderChange(vl);return;case wo:e.writeCodeword(B9e),e.signalEncoderChange(wo);break;case vc:e.writeCodeword(k9e),e.signalEncoderChange(vc);break;case zo:e.writeCodeword(F9e),e.signalEncoderChange(zo);break;default:throw new Error("Illegal mode: "+a)}else cf.isExtendedASCII(n)?(e.writeCodeword(j9e),e.writeCodeword(n-128+1),e.pos++):(e.writeCodeword(n+1),e.pos++)}},t.prototype.encodeASCIIDigits=function(e,r){if(cf.isDigit(e)&&cf.isDigit(r)){var n=(e-48)*10+(r-48);return n+130}throw new Error("not digits: "+e+r)},t}(),R9e=function(){function t(){}return t.prototype.getEncodingMode=function(){return Xl},t.prototype.encode=function(e){var r=new ta;for(r.append(0);e.hasMoreCharacters();){var n=e.getCurrentChar();r.append(n),e.pos++;var a=cf.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode()){e.signalEncoderChange(Xa);break}}var s=r.length()-1,o=1,l=e.getCodewordCount()+s+o;e.updateSymbolInfo(l);var c=e.getSymbolInfo().getDataCapacity()-l>0;if(e.hasMoreCharacters()||c)if(s<=249)r.setCharAt(0,ba.getCharAt(s));else if(s<=1555)r.setCharAt(0,ba.getCharAt(Math.floor(s/250)+249)),r.insert(1,ba.getCharAt(s%250));else throw new Error("Message length not in valid ranges: "+s);for(var u=0,n=r.length();u<n;u++)e.writeCodeword(this.randomize255State(r.charAt(u).charCodeAt(0),e.getCodewordCount()+1))},t.prototype.randomize255State=function(e,r){var n=149*r%255+1,a=e+n;return a<=255?a:a-256},t}(),HR=function(){function t(){}return t.prototype.getEncodingMode=function(){return vl},t.prototype.encodeMaximal=function(e){for(var r=new ta,n=0,a=e.pos,s=0;e.hasMoreCharacters();){var o=e.getCurrentChar();e.pos++,n=this.encodeChar(o,r),r.length()%3===0&&(a=e.pos,s=r.length())}if(s!==r.length()){var l=Math.floor(r.length()/3*2),c=Math.floor(e.getCodewordCount()+l+1);e.updateSymbolInfo(c);var u=e.getSymbolInfo().getDataCapacity()-c,d=Math.floor(r.length()%3);(d===2&&u!==2||d===1&&(n>3||u!==1))&&(e.pos=a)}r.length()>0&&e.writeCodeword(Dse),this.handleEOD(e,r)},t.prototype.encode=function(e){for(var r=new ta;e.hasMoreCharacters();){var n=e.getCurrentChar();e.pos++;var a=this.encodeChar(n,r),s=Math.floor(r.length()/3)*2,o=e.getCodewordCount()+s;e.updateSymbolInfo(o);var l=e.getSymbolInfo().getDataCapacity()-o;if(!e.hasMoreCharacters()){var c=new ta;for(r.length()%3===2&&l!==2&&(a=this.backtrackOneCharacter(e,r,c,a));r.length()%3===1&&(a>3||l!==1);)a=this.backtrackOneCharacter(e,r,c,a);break}var u=r.length();if(u%3===0){var d=cf.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(d!==this.getEncodingMode()){e.signalEncoderChange(Xa);break}}}this.handleEOD(e,r)},t.prototype.backtrackOneCharacter=function(e,r,n,a){var s=r.length(),o=r.toString().substring(0,s-a);r.setLengthToZero(),r.append(o),e.pos--;var l=e.getCurrentChar();return a=this.encodeChar(l,n),e.resetSymbolInfo(),a},t.prototype.writeNextTriplet=function(e,r){e.writeCodewords(this.encodeToCodewords(r.toString()));var n=r.toString().substring(3);r.setLengthToZero(),r.append(n)},t.prototype.handleEOD=function(e,r){var n=Math.floor(r.length()/3*2),a=r.length()%3,s=e.getCodewordCount()+n;e.updateSymbolInfo(s);var o=e.getSymbolInfo().getDataCapacity()-s;if(a===2){for(r.append("\0");r.length()>=3;)this.writeNextTriplet(e,r);e.hasMoreCharacters()&&e.writeCodeword(X5)}else if(o===1&&a===1){for(;r.length()>=3;)this.writeNextTriplet(e,r);e.hasMoreCharacters()&&e.writeCodeword(X5),e.pos--}else if(a===0){for(;r.length()>=3;)this.writeNextTriplet(e,r);(o>0||e.hasMoreCharacters())&&e.writeCodeword(X5)}else throw new Error("Unexpected case. Please report!");e.signalEncoderChange(Xa)},t.prototype.encodeChar=function(e,r){if(e===32)return r.append(3),1;if(e>=48&&e<=57)return r.append(e-48+4),1;if(e>=65&&e<=90)return r.append(e-65+14),1;if(e<32)return r.append(0),r.append(e),2;if(e<=47)return r.append(1),r.append(e-33),2;if(e<=64)return r.append(1),r.append(e-58+15),2;if(e<=95)return r.append(1),r.append(e-91+22),2;if(e<=127)return r.append(2),r.append(e-96),2;r.append("1");var n=2;return n+=this.encodeChar(e-128,r),n},t.prototype.encodeToCodewords=function(e){var r=1600*e.charCodeAt(0)+40*e.charCodeAt(1)+e.charCodeAt(2)+1,n=r/256,a=r%256,s=new ta;return s.append(n),s.append(a),s.toString()},t}(),M9e=function(){function t(){}return t.prototype.getEncodingMode=function(){return zo},t.prototype.encode=function(e){for(var r=new ta;e.hasMoreCharacters();){var n=e.getCurrentChar();this.encodeChar(n,r),e.pos++;var a=r.length();if(a>=4){e.writeCodewords(this.encodeToCodewords(r.toString()));var s=r.toString().substring(4);r.setLengthToZero(),r.append(s);var o=cf.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){e.signalEncoderChange(Xa);break}}}r.append(ba.getCharAt(31)),this.handleEOD(e,r)},t.prototype.handleEOD=function(e,r){try{var n=r.length();if(n===0)return;if(n===1){e.updateSymbolInfo();var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount(),s=e.getRemainingCharacters();if(s>a&&(e.updateSymbolInfo(e.getCodewordCount()+1),a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount()),s<=a&&a<=2)return}if(n>4)throw new Error("Count must not exceed 4");var o=n-1,l=this.encodeToCodewords(r.toString()),c=!e.hasMoreCharacters(),u=c&&o<=2;if(o<=2){e.updateSymbolInfo(e.getCodewordCount()+o);var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount();a>=3&&(u=!1,e.updateSymbolInfo(e.getCodewordCount()+l.length))}u?(e.resetSymbolInfo(),e.pos-=o):e.writeCodewords(l)}finally{e.signalEncoderChange(Xa)}},t.prototype.encodeChar=function(e,r){e>=32&&e<=63?r.append(e):e>=64&&e<=94?r.append(ba.getCharAt(e-64)):cf.illegalCharacter(ba.getCharAt(e))},t.prototype.encodeToCodewords=function(e){var r=e.length;if(r===0)throw new Error("StringBuilder must not be empty");var n=e.charAt(0).charCodeAt(0),a=r>=2?e.charAt(1).charCodeAt(0):0,s=r>=3?e.charAt(2).charCodeAt(0):0,o=r>=4?e.charAt(3).charCodeAt(0):0,l=(n<<18)+(a<<12)+(s<<6)+o,c=l>>16&255,u=l>>8&255,d=l&255,f=new ta;return f.append(c),r>=2&&f.append(u),r>=3&&f.append(d),f.toString()},t}(),L9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),U9e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Da=function(){function t(e,r,n,a,s,o,l,c){l===void 0&&(l=0),c===void 0&&(c=0),this.rectangular=e,this.dataCapacity=r,this.errorCodewords=n,this.matrixWidth=a,this.matrixHeight=s,this.dataRegions=o,this.rsBlockData=l,this.rsBlockError=c}return t.lookup=function(e,r,n,a,s){var o,l;r===void 0&&(r=0),n===void 0&&(n=null),a===void 0&&(a=null),s===void 0&&(s=!0);try{for(var c=U9e(V9e),u=c.next();!u.done;u=c.next()){var d=u.value;if(!(r===1&&d.rectangular)&&!(r===2&&!d.rectangular)&&!(n!=null&&(d.getSymbolWidth()<n.getWidth()||d.getSymbolHeight()<n.getHeight()))&&!(a!=null&&(d.getSymbolWidth()>a.getWidth()||d.getSymbolHeight()>a.getHeight()))&&e<=d.dataCapacity)return d}}catch(f){o={error:f}}finally{try{u&&!u.done&&(l=c.return)&&l.call(c)}finally{if(o)throw o.error}}if(s)throw new Error("Can't find a symbol arrangement that matches the message. Data codewords: "+e);return null},t.prototype.getHorizontalDataRegions=function(){switch(this.dataRegions){case 1:return 1;case 2:case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},t.prototype.getVerticalDataRegions=function(){switch(this.dataRegions){case 1:case 2:return 1;case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},t.prototype.getSymbolDataWidth=function(){return this.getHorizontalDataRegions()*this.matrixWidth},t.prototype.getSymbolDataHeight=function(){return this.getVerticalDataRegions()*this.matrixHeight},t.prototype.getSymbolWidth=function(){return this.getSymbolDataWidth()+this.getHorizontalDataRegions()*2},t.prototype.getSymbolHeight=function(){return this.getSymbolDataHeight()+this.getVerticalDataRegions()*2},t.prototype.getCodewordCount=function(){return this.dataCapacity+this.errorCodewords},t.prototype.getInterleavedBlockCount=function(){return this.rsBlockData?this.dataCapacity/this.rsBlockData:1},t.prototype.getDataCapacity=function(){return this.dataCapacity},t.prototype.getErrorCodewords=function(){return this.errorCodewords},t.prototype.getDataLengthForInterleavedBlock=function(e){return this.rsBlockData},t.prototype.getErrorLengthForInterleavedBlock=function(e){return this.rsBlockError},t}(),Q9e=function(t){L9e(e,t);function e(){return t.call(this,!1,1558,620,22,22,36,-1,62)||this}return e.prototype.getInterleavedBlockCount=function(){return 10},e.prototype.getDataLengthForInterleavedBlock=function(r){return r<=8?156:155},e}(Da),V9e=[new Da(!1,3,5,8,8,1),new Da(!1,5,7,10,10,1),new Da(!0,5,7,16,6,1),new Da(!1,8,10,12,12,1),new Da(!0,10,11,14,6,2),new Da(!1,12,12,14,14,1),new Da(!0,16,14,24,10,1),new Da(!1,18,14,16,16,1),new Da(!1,22,18,18,18,1),new Da(!0,22,18,16,10,2),new Da(!1,30,20,20,20,1),new Da(!0,32,24,16,14,2),new Da(!1,36,24,22,22,1),new Da(!1,44,28,24,24,1),new Da(!0,49,28,22,14,2),new Da(!1,62,36,14,14,4),new Da(!1,86,42,16,16,4),new Da(!1,114,48,18,18,4),new Da(!1,144,56,20,20,4),new Da(!1,174,68,22,22,4),new Da(!1,204,84,24,24,4,102,42),new Da(!1,280,112,14,14,16,140,56),new Da(!1,368,144,16,16,16,92,36),new Da(!1,456,192,18,18,16,114,48),new Da(!1,576,224,20,20,16,144,56),new Da(!1,696,272,22,22,16,174,68),new Da(!1,816,336,24,24,16,136,56),new Da(!1,1050,408,18,18,36,175,68),new Da(!1,1304,496,20,20,36,163,62),new Q9e],H9e=function(){function t(e){this.msg=e,this.pos=0,this.skipAtEnd=0;for(var r=e.split("").map(function(l){return l.charCodeAt(0)}),n=new ta,a=0,s=r.length;a<s;a++){var o=String.fromCharCode(r[a]&255);if(o==="?"&&e.charAt(a)!=="?")throw new Error("Message contains characters outside ISO-8859-1 encoding.");n.append(o)}this.msg=n.toString(),this.shape=0,this.codewords=new ta,this.newEncoding=-1}return t.prototype.setSymbolShape=function(e){this.shape=e},t.prototype.setSizeConstraints=function(e,r){this.minSize=e,this.maxSize=r},t.prototype.getMessage=function(){return this.msg},t.prototype.setSkipAtEnd=function(e){this.skipAtEnd=e},t.prototype.getCurrentChar=function(){return this.msg.charCodeAt(this.pos)},t.prototype.getCurrent=function(){return this.msg.charCodeAt(this.pos)},t.prototype.getCodewords=function(){return this.codewords},t.prototype.writeCodewords=function(e){this.codewords.append(e)},t.prototype.writeCodeword=function(e){this.codewords.append(e)},t.prototype.getCodewordCount=function(){return this.codewords.length()},t.prototype.getNewEncoding=function(){return this.newEncoding},t.prototype.signalEncoderChange=function(e){this.newEncoding=e},t.prototype.resetEncoderSignal=function(){this.newEncoding=-1},t.prototype.hasMoreCharacters=function(){return this.pos<this.getTotalMessageCharCount()},t.prototype.getTotalMessageCharCount=function(){return this.msg.length-this.skipAtEnd},t.prototype.getRemainingCharacters=function(){return this.getTotalMessageCharCount()-this.pos},t.prototype.getSymbolInfo=function(){return this.symbolInfo},t.prototype.updateSymbolInfo=function(e){e===void 0&&(e=this.getCodewordCount()),(this.symbolInfo==null||e>this.symbolInfo.getDataCapacity())&&(this.symbolInfo=Da.lookup(e,this.shape,this.minSize,this.maxSize,!0))},t.prototype.resetSymbolInfo=function(){this.symbolInfo=null},t}(),$9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),G9e=function(t){$9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return wo},e.prototype.encode=function(r){for(var n=new ta;r.hasMoreCharacters();){var a=r.getCurrentChar();r.pos++,this.encodeChar(a,n);var s=n.length();if(s%3===0){this.writeNextTriplet(r,n);var o=cf.lookAheadTest(r.getMessage(),r.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){r.signalEncoderChange(Xa);break}}}this.handleEOD(r,n)},e.prototype.encodeChar=function(r,n){switch(r){case 13:n.append(0);break;case 42:n.append(1);break;case 62:n.append(2);break;case 32:n.append(3);break;default:r>=48&&r<=57?n.append(r-48+4):r>=65&&r<=90?n.append(r-65+14):cf.illegalCharacter(ba.getCharAt(r));break}return 1},e.prototype.handleEOD=function(r,n){r.updateSymbolInfo();var a=r.getSymbolInfo().getDataCapacity()-r.getCodewordCount(),s=n.length();r.pos-=s,(r.getRemainingCharacters()>1||a>1||r.getRemainingCharacters()!==a)&&r.writeCodeword(O9e),r.getNewEncoding()<0&&r.signalEncoderChange(Xa)},e}(HR),K9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),q9e=function(t){K9e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return vc},e.prototype.encodeChar=function(r,n){if(r===32)return n.append(3),1;if(r>=48&&r<=57)return n.append(r-48+4),1;if(r>=97&&r<=122)return n.append(r-97+14),1;if(r<32)return n.append(0),n.append(r),2;if(r<=47)return n.append(1),n.append(r-33),2;if(r<=64)return n.append(1),n.append(r-58+15),2;if(r>=91&&r<=95)return n.append(1),n.append(r-91+22),2;if(r===96)return n.append(2),n.append(0),2;if(r<=90)return n.append(2),n.append(r-65+1),2;if(r<=127)return n.append(2),n.append(r-123+27),2;n.append("1");var a=2;return a+=this.encodeChar(r-128,n),a},e}(HR),cf=function(){function t(){}return t.randomize253State=function(e){var r=149*e%253+1,n=eG+r;return n<=254?n:n-254},t.encodeHighLevel=function(e,r,n,a,s){r===void 0&&(r=0),n===void 0&&(n=null),a===void 0&&(a=null),s===void 0&&(s=!1);var o=new HR,l=[new D9e,o,new q9e,new G9e,new M9e,new R9e],c=new H9e(e);c.setSymbolShape(r),c.setSizeConstraints(n,a),e.startsWith(tG)&&e.endsWith(nG)?(c.writeCodeword(P9e),c.setSkipAtEnd(2),c.pos+=tG.length):e.startsWith(rG)&&e.endsWith(nG)&&(c.writeCodeword(T9e),c.setSkipAtEnd(2),c.pos+=rG.length);var u=Xa;for(s&&(o.encodeMaximal(c),u=c.getNewEncoding(),c.resetEncoderSignal());c.hasMoreCharacters();)l[u].encode(c),c.getNewEncoding()>=0&&(u=c.getNewEncoding(),c.resetEncoderSignal());var d=c.getCodewordCount();c.updateSymbolInfo();var f=c.getSymbolInfo().getDataCapacity();d<f&&u!==Xa&&u!==Xl&&u!==zo&&c.writeCodeword("");var A=c.getCodewords();for(A.length()<f&&A.append(eG);A.length()<f;)A.append(this.randomize253State(A.length()+1));return c.getCodewords().toString()},t.lookAheadTest=function(e,r,n){var a=this.lookAheadTestIntern(e,r,n);if(n===wo&&a===wo){for(var s=Math.min(r+3,e.length),o=r;o<s;o++)if(!this.isNativeX12(e.charCodeAt(o)))return Xa}else if(n===zo&&a===zo){for(var s=Math.min(r+4,e.length),o=r;o<s;o++)if(!this.isNativeEDIFACT(e.charCodeAt(o)))return Xa}return a},t.lookAheadTestIntern=function(e,r,n){if(r>=e.length)return n;var a;n===Xa?a=[0,1,1,1,1,1.25]:(a=[1,2,2,2,2,2.25],a[n]=0);for(var s=0,o=new Uint8Array(6),l=[];;){if(r+s===e.length){Bo.fill(o,0),Bo.fill(l,0);var c=this.findMinimums(a,l,sa.MAX_VALUE,o),u=this.getMinimumCount(o);if(l[Xa]===c)return Xa;if(u===1){if(o[Xl]>0)return Xl;if(o[zo]>0)return zo;if(o[vc]>0)return vc;if(o[wo]>0)return wo}return vl}var d=e.charCodeAt(r+s);if(s++,this.isDigit(d)?a[Xa]+=.5:this.isExtendedASCII(d)?(a[Xa]=Math.ceil(a[Xa]),a[Xa]+=2):(a[Xa]=Math.ceil(a[Xa]),a[Xa]++),this.isNativeC40(d)?a[vl]+=2/3:this.isExtendedASCII(d)?a[vl]+=8/3:a[vl]+=4/3,this.isNativeText(d)?a[vc]+=2/3:this.isExtendedASCII(d)?a[vc]+=8/3:a[vc]+=4/3,this.isNativeX12(d)?a[wo]+=2/3:this.isExtendedASCII(d)?a[wo]+=13/3:a[wo]+=10/3,this.isNativeEDIFACT(d)?a[zo]+=3/4:this.isExtendedASCII(d)?a[zo]+=17/4:a[zo]+=13/4,this.isSpecialB256(d)?a[Xl]+=4:a[Xl]++,s>=4){if(Bo.fill(o,0),Bo.fill(l,0),this.findMinimums(a,l,sa.MAX_VALUE,o),l[Xa]<this.min(l[Xl],l[vl],l[vc],l[wo],l[zo]))return Xa;if(l[Xl]<l[Xa]||l[Xl]+1<this.min(l[vl],l[vc],l[wo],l[zo]))return Xl;if(l[zo]+1<this.min(l[Xl],l[vl],l[vc],l[wo],l[Xa]))return zo;if(l[vc]+1<this.min(l[Xl],l[vl],l[zo],l[wo],l[Xa]))return vc;if(l[wo]+1<this.min(l[Xl],l[vl],l[zo],l[vc],l[Xa]))return wo;if(l[vl]+1<this.min(l[Xa],l[Xl],l[zo],l[vc])){if(l[vl]<l[wo])return vl;if(l[vl]===l[wo]){for(var f=r+s+1;f<e.length;){var A=e.charCodeAt(f);if(this.isX12TermSep(A))return wo;if(!this.isNativeX12(A))break;f++}return vl}}}}},t.min=function(e,r,n,a,s){var o=Math.min(e,Math.min(r,Math.min(n,a)));return s===void 0?o:Math.min(o,s)},t.findMinimums=function(e,r,n,a){for(var s=0;s<6;s++){var o=r[s]=Math.ceil(e[s]);n>o&&(n=o,Bo.fill(a,0)),n===o&&(a[s]=a[s]+1)}return n},t.getMinimumCount=function(e){for(var r=0,n=0;n<6;n++)r+=e[n];return r||0},t.isDigit=function(e){return e>=48&&e<=57},t.isExtendedASCII=function(e){return e>=128&&e<=255},t.isNativeC40=function(e){return e===32||e>=48&&e<=57||e>=65&&e<=90},t.isNativeText=function(e){return e===32||e>=48&&e<=57||e>=97&&e<=122},t.isNativeX12=function(e){return this.isX12TermSep(e)||e===32||e>=48&&e<=57||e>=65&&e<=90},t.isX12TermSep=function(e){return e===13||e===42||e===62},t.isNativeEDIFACT=function(e){return e>=32&&e<=94},t.isSpecialB256=function(e){return!1},t.determineConsecutiveDigitCount=function(e,r){r===void 0&&(r=0);for(var n=e.length,a=r;a<n&&this.isDigit(e.charCodeAt(a));)a++;return a-r},t.illegalCharacter=function(e){var r=sa.toHexString(e.charCodeAt(0));throw r="0000".substring(0,4-r.length)+r,new Error("Illegal character: "+e+" (0x"+r+")")},t}(),Y5=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},aG=function(){function t(e){this.charset=e,this.name=e.name}return t.prototype.canEncode=function(e){try{return Bd.encode(e,this.charset)!=null}catch{return!1}},t}(),z9e=function(){function t(e,r,n){var a,s,o,l,c,u;this.ENCODERS=["IBM437","ISO-8859-2","ISO-8859-3","ISO-8859-4","ISO-8859-5","ISO-8859-6","ISO-8859-7","ISO-8859-8","ISO-8859-9","ISO-8859-10","ISO-8859-11","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","windows-1250","windows-1251","windows-1252","windows-1256","Shift_JIS"].map(function(E){return new aG(C9e.forName(E))}),this.encoders=[];var d=[];d.push(new aG(_9e.ISO_8859_1));for(var f=r!=null&&r.name.startsWith("UTF"),A=0;A<e.length;A++){var h=!1;try{for(var m=(a=void 0,Y5(d)),p=m.next();!p.done;p=m.next()){var x=p.value,v=e.charAt(A),y=v.charCodeAt(0);if(y===n||x.canEncode(v)){h=!0;break}}}catch(E){a={error:E}}finally{try{p&&!p.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}if(!h)try{for(var b=(o=void 0,Y5(this.ENCODERS)),w=b.next();!w.done;w=b.next()){var x=w.value;if(x.canEncode(e.charAt(A))){d.push(x),h=!0;break}}}catch(E){o={error:E}}finally{try{w&&!w.done&&(l=b.return)&&l.call(b)}finally{if(o)throw o.error}}h||(f=!0)}if(d.length===1&&!f)this.encoders=[d[0]];else{this.encoders=[];var j=0;try{for(var I=Y5(d),C=I.next();!C.done;C=I.next()){var x=C.value;this.encoders[j++]=x}}catch(E){c={error:E}}finally{try{C&&!C.done&&(u=I.return)&&u.call(I)}finally{if(c)throw c.error}}}var S=-1;if(r!=null){for(var A=0;A<this.encoders.length;A++)if(this.encoders[A]!=null&&r.name===this.encoders[A].name){S=A;break}}this.priorityEncoderIndex=S}return t.prototype.length=function(){return this.encoders.length},t.prototype.getCharsetName=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].name},t.prototype.getCharset=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].charset},t.prototype.getECIValue=function(e){return this.encoders[e].charset.getValueIdentifier()},t.prototype.getPriorityEncoderIndex=function(){return this.priorityEncoderIndex},t.prototype.canEncode=function(e,r){if(!(r<this.length()))throw new Error("index must be less than length");return!0},t.prototype.encode=function(e,r){if(!(r<this.length()))throw new Error("index must be less than length");return Bd.encode(ba.getCharAt(e),this.encoders[r].name)},t}(),W9e=3,X9e=function(){function t(e,r,n){this.fnc1=n;var a=new z9e(e,r,n);if(a.length()===1)for(var s=0;s<this.bytes.length;s++){var o=e.charAt(s).charCodeAt(0);this.bytes[s]=o===n?1e3:o}else this.bytes=this.encodeMinimally(e,a,n)}return t.prototype.getFNC1Character=function(){return this.fnc1},t.prototype.length=function(){return this.bytes.length},t.prototype.haveNCharacters=function(e,r){if(e+r-1>=this.bytes.length)return!1;for(var n=0;n<r;n++)if(this.isECI(e+n))return!1;return!0},t.prototype.charAt=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(this.isECI(e))throw new Error("value at "+e+" is not a character but an ECI");return this.isFNC1(e)?this.fnc1:this.bytes[e]},t.prototype.subSequence=function(e,r){if(e<0||e>r||r>this.length())throw new Error(""+e);for(var n=new ta,a=e;a<r;a++){if(this.isECI(a))throw new Error("value at "+a+" is not a character but an ECI");n.append(this.charAt(a))}return n.toString()},t.prototype.isECI=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]>255&&this.bytes[e]<=999},t.prototype.isFNC1=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]===1e3},t.prototype.getECIValue=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(!this.isECI(e))throw new Error("value at "+e+" is not an ECI but a character");return this.bytes[e]-256},t.prototype.addEdge=function(e,r,n){(e[r][n.encoderIndex]==null||e[r][n.encoderIndex].cachedTotalSize>n.cachedTotalSize)&&(e[r][n.encoderIndex]=n)},t.prototype.addEdges=function(e,r,n,a,s,o){var l=e.charAt(a).charCodeAt(0),c=0,u=r.length();r.getPriorityEncoderIndex()>=0&&(l===o||r.canEncode(l,r.getPriorityEncoderIndex()))&&(c=r.getPriorityEncoderIndex(),u=c+1);for(var d=c;d<u;d++)(l===o||r.canEncode(l,d))&&this.addEdge(n,a+1,new sG(l,r,d,s,o))},t.prototype.encodeMinimally=function(e,r,n){var a=e.length,s=new sG[a+1][r.length()];this.addEdges(e,r,s,0,null,n);for(var o=1;o<=a;o++){for(var l=0;l<r.length();l++)s[o][l]!=null&&o<a&&this.addEdges(e,r,s,o,s[o][l],n);for(var l=0;l<r.length();l++)s[o-1][l]=null}for(var c=-1,u=sa.MAX_VALUE,l=0;l<r.length();l++)if(s[a][l]!=null){var d=s[a][l];d.cachedTotalSize<u&&(u=d.cachedTotalSize,c=l)}if(c<0)throw new Error('Failed to encode "'+e+'"');for(var f=[],A=s[a][c];A!=null;){if(A.isFNC1())f.unshift(1e3);else for(var h=r.encode(A.c,A.encoderIndex),o=h.length-1;o>=0;o--)f.unshift(h[o]&255);var m=A.previous===null?0:A.previous.encoderIndex;m!==A.encoderIndex&&f.unshift(256+r.getECIValue(A.encoderIndex)),A=A.previous}for(var p=[],o=0;o<p.length;o++)p[o]=f[o];return p},t}(),sG=function(){function t(e,r,n,a,s){this.c=e,this.encoderSet=r,this.encoderIndex=n,this.previous=a,this.fnc1=s,this.c=e===s?1e3:e;var o=this.isFNC1()?1:r.encode(e,n).length,l=a===null?0:a.encoderIndex;l!==n&&(o+=W9e),a!=null&&(o+=a.cachedTotalSize),this.cachedTotalSize=o}return t.prototype.isFNC1=function(){return this.c===1e3},t}(),Y9e=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var iG;(function(t){t[t.ASCII=0]="ASCII",t[t.C40=1]="C40",t[t.TEXT=2]="TEXT",t[t.X12=3]="X12",t[t.EDF=4]="EDF",t[t.B256=5]="B256"})(iG||(iG={}));(function(t){Y9e(e,t);function e(r,n,a,s,o){var l=t.call(this,r,n,a)||this;return l.shape=s,l.macroId=o,l}return e.prototype.getMacroId=function(){return this.macroId},e.prototype.getShapeHint=function(){return this.shape},e})(X9e);var J9e=function(){function t(){}return t.prototype.isCompact=function(){return this.compact},t.prototype.setCompact=function(e){this.compact=e},t.prototype.getSize=function(){return this.size},t.prototype.setSize=function(e){this.size=e},t.prototype.getLayers=function(){return this.layers},t.prototype.setLayers=function(e){this.layers=e},t.prototype.getCodeWords=function(){return this.codeWords},t.prototype.setCodeWords=function(e){this.codeWords=e},t.prototype.getMatrix=function(){return this.matrix},t.prototype.setMatrix=function(e){this.matrix=e},t}(),oG=function(){function t(){}return t.singletonList=function(e){return[e]},t.min=function(e,r){return e.sort(r)[0]},t}(),Z9e=function(){function t(e){this.previous=e}return t.prototype.getPrevious=function(){return this.previous},t}(),eQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$R=function(t){eQe(e,t);function e(r,n,a){var s=t.call(this,r)||this;return s.value=n,s.bitCount=a,s}return e.prototype.appendTo=function(r,n){r.appendBits(this.value,this.bitCount)},e.prototype.add=function(r,n){return new e(this,r,n)},e.prototype.addBinaryShift=function(r,n){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new e(this,r,n)},e.prototype.toString=function(){var r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+sa.toBinaryString(r|1<<this.bitCount).substring(1)+">"},e}(Z9e),tQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),rQe=function(t){tQe(e,t);function e(r,n,a){var s=t.call(this,r,0,0)||this;return s.binaryShiftStart=n,s.binaryShiftByteCount=a,s}return e.prototype.appendTo=function(r,n){for(var a=0;a<this.binaryShiftByteCount;a++)(a===0||a===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):a===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(n[this.binaryShiftStart+a],8)},e.prototype.addBinaryShift=function(r,n){return new e(this,r,n)},e.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"},e}($R);function nQe(t,e,r){return new rQe(t,e,r)}function Ny(t,e,r){return new $R(t,e,r)}var aQe=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],pm=0,iI=1,Ed=2,Rse=3,th=4,sQe=new $R(null,0,0),J5=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])],iQe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function oQe(t){var e,r;try{for(var n=iQe(t),a=n.next();!a.done;a=n.next()){var s=a.value;Bo.fill(s,-1)}}catch(o){e={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return t[pm][th]=0,t[iI][th]=0,t[iI][pm]=28,t[Rse][th]=0,t[Ed][th]=0,t[Ed][pm]=15,t}var Mse=oQe(Bo.createInt32Array(6,6)),lQe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},cQe=function(){function t(e,r,n,a){this.token=e,this.mode=r,this.binaryShiftByteCount=n,this.bitCount=a}return t.prototype.getMode=function(){return this.mode},t.prototype.getToken=function(){return this.token},t.prototype.getBinaryShiftByteCount=function(){return this.binaryShiftByteCount},t.prototype.getBitCount=function(){return this.bitCount},t.prototype.latchAndAppend=function(e,r){var n=this.bitCount,a=this.token;if(e!==this.mode){var s=J5[this.mode][e];a=Ny(a,s&65535,s>>16),n+=s>>16}var o=e===Ed?4:5;return a=Ny(a,r,o),new t(a,e,0,n+o)},t.prototype.shiftAndAppend=function(e,r){var n=this.token,a=this.mode===Ed?4:5;return n=Ny(n,Mse[this.mode][e],a),n=Ny(n,r,5),new t(n,this.mode,0,this.bitCount+a+5)},t.prototype.addBinaryShiftChar=function(e){var r=this.token,n=this.mode,a=this.bitCount;if(this.mode===th||this.mode===Ed){var s=J5[n][pm];r=Ny(r,s&65535,s>>16),a+=s>>16,n=pm}var o=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,l=new t(r,n,this.binaryShiftByteCount+1,a+o);return l.binaryShiftByteCount===2078&&(l=l.endBinaryShift(e+1)),l},t.prototype.endBinaryShift=function(e){if(this.binaryShiftByteCount===0)return this;var r=this.token;return r=nQe(r,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new t(r,this.mode,0,this.bitCount)},t.prototype.isBetterThanOrEqualTo=function(e){var r=this.bitCount+(J5[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?r+=t.calculateBinaryShiftCost(e)-t.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(r+=10),r<=e.bitCount},t.prototype.toBitArray=function(e){for(var r,n,a=[],s=this.endBinaryShift(e.length).token;s!==null;s=s.getPrevious())a.unshift(s);var o=new tl;try{for(var l=lQe(a),c=l.next();!c.done;c=l.next()){var u=c.value;u.appendTo(o,e)}}catch(d){r={error:d}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},t.prototype.toString=function(){return ba.format("%s bits=%d bytes=%d",aQe[this.mode],this.bitCount,this.binaryShiftByteCount)},t.calculateBinaryShiftCost=function(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0},t.INITIAL_STATE=new t(sQe,pm,0,0),t}();function uQe(t){var e=ba.getCharCode(" "),r=ba.getCharCode("."),n=ba.getCharCode(",");t[pm][e]=1;for(var a=ba.getCharCode("Z"),s=ba.getCharCode("A"),o=s;o<=a;o++)t[pm][o]=o-s+2;t[iI][e]=1;for(var l=ba.getCharCode("z"),c=ba.getCharCode("a"),o=c;o<=l;o++)t[iI][o]=o-c+2;t[Ed][e]=1;for(var u=ba.getCharCode("9"),d=ba.getCharCode("0"),o=d;o<=u;o++)t[Ed][o]=o-d+2;t[Ed][n]=12,t[Ed][r]=13;for(var f=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""],A=0;A<f.length;A++)t[Rse][ba.getCharCode(f[A])]=A;for(var h=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"],A=0;A<h.length;A++)ba.getCharCode(h[A])>0&&(t[th][ba.getCharCode(h[A])]=A);return t}var Z5=uQe(Bo.createInt32Array(5,256)),d_=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},dQe=function(){function t(e){this.text=e}return t.prototype.encode=function(){for(var e=ba.getCharCode(" "),r=ba.getCharCode(`
`),n=oG.singletonList(cQe.INITIAL_STATE),a=0;a<this.text.length;a++){var s=void 0,o=a+1<this.text.length?this.text[a+1]:0;switch(this.text[a]){case ba.getCharCode("\r"):s=o===r?2:0;break;case ba.getCharCode("."):s=o===e?3:0;break;case ba.getCharCode(","):s=o===e?4:0;break;case ba.getCharCode(":"):s=o===e?5:0;break;default:s=0}s>0?(n=t.updateStateListForPair(n,a,s),a++):n=this.updateStateListForChar(n,a)}var l=oG.min(n,function(c,u){return c.getBitCount()-u.getBitCount()});return l.toBitArray(this.text)},t.prototype.updateStateListForChar=function(e,r){var n,a,s=[];try{for(var o=d_(e),l=o.next();!l.done;l=o.next()){var c=l.value;this.updateStateForChar(c,r,s)}}catch(u){n={error:u}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return t.simplifyStates(s)},t.prototype.updateStateForChar=function(e,r,n){for(var a=this.text[r]&255,s=Z5[e.getMode()][a]>0,o=null,l=0;l<=th;l++){var c=Z5[l][a];if(c>0){if(o==null&&(o=e.endBinaryShift(r)),!s||l===e.getMode()||l===Ed){var u=o.latchAndAppend(l,c);n.push(u)}if(!s&&Mse[e.getMode()][l]>=0){var d=o.shiftAndAppend(l,c);n.push(d)}}}if(e.getBinaryShiftByteCount()>0||Z5[e.getMode()][a]===0){var f=e.addBinaryShiftChar(r);n.push(f)}},t.updateStateListForPair=function(e,r,n){var a,s,o=[];try{for(var l=d_(e),c=l.next();!c.done;c=l.next()){var u=c.value;this.updateStateForPair(u,r,n,o)}}catch(d){a={error:d}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}return this.simplifyStates(o)},t.updateStateForPair=function(e,r,n,a){var s=e.endBinaryShift(r);if(a.push(s.latchAndAppend(th,n)),e.getMode()!==th&&a.push(s.shiftAndAppend(th,n)),n===3||n===4){var o=s.latchAndAppend(Ed,16-n).latchAndAppend(Ed,1);a.push(o)}if(e.getBinaryShiftByteCount()>0){var l=e.addBinaryShiftChar(r).addBinaryShiftChar(r+1);a.push(l)}},t.simplifyStates=function(e){var r,n,a,s,o=[];try{for(var l=d_(e),c=l.next();!c.done;c=l.next()){var u=c.value,d=!0,f=function(x){if(x.isBetterThanOrEqualTo(u))return d=!1,"break";u.isBetterThanOrEqualTo(x)&&(o=o.filter(function(v){return v!==x}))};try{for(var A=(a=void 0,d_(o)),h=A.next();!h.done;h=A.next()){var m=h.value,p=f(m);if(p==="break")break}}catch(x){a={error:x}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}d&&o.push(u)}}catch(x){r={error:x}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},t}(),fQe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function t(){}return t.encodeBytes=function(e){return t.encode(e,t.DEFAULT_EC_PERCENT,t.DEFAULT_AZTEC_LAYERS)},t.encode=function(e,r,n){var a=new dQe(e).encode(),s=sa.truncDivision(a.getSize()*r,100)+11,o=a.getSize()+s,l,c,u,d,f;if(n!==t.DEFAULT_AZTEC_LAYERS){if(l=n<0,c=Math.abs(n),c>(l?t.MAX_NB_BITS_COMPACT:t.MAX_NB_BITS))throw new Pn(ba.format("Illegal value %s for layers",n));u=t.totalBitsInLayer(c,l),d=t.WORD_SIZE[c];var A=u-u%d;if(f=t.stuffBits(a,d),f.getSize()+s>A)throw new Pn("Data to large for user specified layer");if(l&&f.getSize()>d*64)throw new Pn("Data to large for user specified layer")}else{d=0,f=null;for(var h=0;;h++){if(h>t.MAX_NB_BITS)throw new Pn("Data too large for an Aztec code");if(l=h<=3,c=l?h+1:h,u=t.totalBitsInLayer(c,l),!(o>u)){(f==null||d!==t.WORD_SIZE[c])&&(d=t.WORD_SIZE[c],f=t.stuffBits(a,d));var A=u-u%d;if(!(l&&f.getSize()>d*64)&&f.getSize()+s<=A)break}}}var m=t.generateCheckWords(f,u,d),p=f.getSize()/d,x=t.generateModeMessage(l,c,p),v=(l?11:14)+c*4,y=new Int32Array(v),b;if(l){b=v;for(var h=0;h<y.length;h++)y[h]=h}else{b=v+1+2*sa.truncDivision(sa.truncDivision(v,2)-1,15);for(var w=sa.truncDivision(v,2),j=sa.truncDivision(b,2),h=0;h<w;h++){var I=h+sa.truncDivision(h,15);y[w-h-1]=j-I-1,y[w+h]=j+I+1}}for(var C=new ch(b),h=0,S=0;h<c;h++){for(var E=(c-h)*4+(l?9:12),B=0;B<E;B++)for(var k=B*2,T=0;T<2;T++)m.get(S+k+T)&&C.set(y[h*2+T],y[h*2+B]),m.get(S+E*2+k+T)&&C.set(y[h*2+B],y[v-1-h*2-T]),m.get(S+E*4+k+T)&&C.set(y[v-1-h*2-T],y[v-1-h*2-B]),m.get(S+E*6+k+T)&&C.set(y[v-1-h*2-B],y[h*2+T]);S+=E*8}if(t.drawModeMessage(C,l,b,x),l)t.drawBullsEye(C,sa.truncDivision(b,2),5);else{t.drawBullsEye(C,sa.truncDivision(b,2),7);for(var h=0,B=0;h<sa.truncDivision(v,2)-1;h+=15,B+=16)for(var T=sa.truncDivision(b,2)&1;T<b;T+=2)C.set(sa.truncDivision(b,2)-B,T),C.set(sa.truncDivision(b,2)+B,T),C.set(T,sa.truncDivision(b,2)-B),C.set(T,sa.truncDivision(b,2)+B)}var P=new J9e;return P.setCompact(l),P.setSize(b),P.setLayers(c),P.setCodeWords(p),P.setMatrix(C),P},t.drawBullsEye=function(e,r,n){for(var a=0;a<n;a+=2)for(var s=r-a;s<=r+a;s++)e.set(s,r-a),e.set(s,r+a),e.set(r-a,s),e.set(r+a,s);e.set(r-n,r-n),e.set(r-n+1,r-n),e.set(r-n,r-n+1),e.set(r+n,r-n),e.set(r+n,r-n+1),e.set(r+n,r+n-1)},t.generateModeMessage=function(e,r,n){var a=new tl;return e?(a.appendBits(r-1,2),a.appendBits(n-1,6),a=t.generateCheckWords(a,28,4)):(a.appendBits(r-1,5),a.appendBits(n-1,11),a=t.generateCheckWords(a,40,4)),a},t.drawModeMessage=function(e,r,n,a){var s=sa.truncDivision(n,2);if(r)for(var o=0;o<7;o++){var l=s-3+o;a.get(o)&&e.set(l,s-5),a.get(o+7)&&e.set(s+5,l),a.get(20-o)&&e.set(l,s+5),a.get(27-o)&&e.set(s-5,l)}else for(var o=0;o<10;o++){var l=s-5+o+sa.truncDivision(o,5);a.get(o)&&e.set(l,s-7),a.get(o+10)&&e.set(s+7,l),a.get(29-o)&&e.set(l,s+7),a.get(39-o)&&e.set(s-7,l)}},t.generateCheckWords=function(e,r,n){var a,s,o=e.getSize()/n,l=new Ose(t.getGF(n)),c=sa.truncDivision(r,n),u=t.bitsToWords(e,n,c);l.encode(u,c-o);var d=r%n,f=new tl;f.appendBits(0,d);try{for(var A=fQe(Array.from(u)),h=A.next();!h.done;h=A.next()){var m=h.value;f.appendBits(m,n)}}catch(p){a={error:p}}finally{try{h&&!h.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}return f},t.bitsToWords=function(e,r,n){var a=new Int32Array(n),s,o;for(s=0,o=e.getSize()/r;s<o;s++){for(var l=0,c=0;c<r;c++)l|=e.get(s*r+c)?1<<r-c-1:0;a[s]=l}return a},t.getGF=function(e){switch(e){case 4:return tu.AZTEC_PARAM;case 6:return tu.AZTEC_DATA_6;case 8:return tu.AZTEC_DATA_8;case 10:return tu.AZTEC_DATA_10;case 12:return tu.AZTEC_DATA_12;default:throw new Pn("Unsupported word size "+e)}},t.stuffBits=function(e,r){for(var n=new tl,a=e.getSize(),s=(1<<r)-2,o=0;o<a;o+=r){for(var l=0,c=0;c<r;c++)(o+c>=a||e.get(o+c))&&(l|=1<<r-1-c);(l&s)===s?(n.appendBits(l&s,r),o--):l&s?n.appendBits(l,r):(n.appendBits(l|1,r),o--)}return n},t.totalBitsInLayer=function(e,r){return((r?88:112)+16*e)*e},t.DEFAULT_EC_PERCENT=33,t.DEFAULT_AZTEC_LAYERS=0,t.MAX_NB_BITS=32,t.MAX_NB_BITS_COMPACT=4,t.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]),t})();var hQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),AQe=function(t){hQe(e,t);function e(r){var n=t.call(this,r.width,r.height)||this;return n.canvas=r,n.tempCanvasElement=null,n.buffer=e.makeBufferFromCanvasImageData(r),n}return e.makeBufferFromCanvasImageData=function(r){var n;try{n=r.getContext("2d",{willReadFrequently:!0})}catch{n=r.getContext("2d")}if(!n)throw new Error("Couldn't get canvas context.");var a=n.getImageData(0,0,r.width,r.height);return e.toGrayscaleBuffer(a.data,r.width,r.height)},e.toGrayscaleBuffer=function(r,n,a){for(var s=new Uint8ClampedArray(n*a),o=0,l=0,c=r.length;o<c;o+=4,l++){var u=void 0,d=r[o+3];if(d===0)u=255;else{var f=r[o],A=r[o+1],h=r[o+2];u=306*f+601*A+117*h+512>>10}s[l]=u}return s},e.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Pn("Requested row is outside the image: "+r);var a=this.getWidth(),s=r*a;return n===null?n=this.buffer.slice(s,s+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(s,s+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(r,n,a,s){return t.prototype.crop.call(this,r,n,a,s),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.invert=function(){return new vP(this)},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement},e.prototype.rotate=function(r){var n=this.getTempCanvasElement();if(!n)throw new Error("Could not create a Canvas element.");var a=r*e.DEGREE_TO_RADIANS,s=this.canvas.width,o=this.canvas.height,l=Math.ceil(Math.abs(Math.cos(a))*s+Math.abs(Math.sin(a))*o),c=Math.ceil(Math.abs(Math.sin(a))*s+Math.abs(Math.cos(a))*o);n.width=l,n.height=c;var u=n.getContext("2d");if(!u)throw new Error("Could not create a Canvas Context element.");return u.translate(l/2,c/2),u.rotate(a),u.drawImage(this.canvas,s/-2,o/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.DEGREE_TO_RADIANS=Math.PI/180,e}(qw);function Lse(){return typeof navigator<"u"}function mQe(){return Lse()&&!!navigator.mediaDevices}function pQe(){return!!(mQe()&&navigator.mediaDevices.enumerateDevices)}var tv=function(){return tv=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},tv.apply(this,arguments)},ri=function(t,e,r,n){function a(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})},ni=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=u[0]&2?a.return:u[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,u[1])).done)return s;switch(a=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},eT=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},gQe={delayBetweenScanAttempts:500,delayBetweenScanSuccess:500,tryPlayVideoTimeout:5e3},_1=function(){function t(e,r,n){r===void 0&&(r=new Map),n===void 0&&(n={}),this.reader=e,this.hints=r,this.options=tv(tv({},gQe),n)}return Object.defineProperty(t.prototype,"possibleFormats",{set:function(e){this.hints.set(Ns.POSSIBLE_FORMATS,e)},enumerable:!1,configurable:!0}),t.addVideoSource=function(e,r){try{e.srcObject=r}catch{console.error("got interrupted by new loading request")}},t.mediaStreamSetTorch=function(e,r){return ri(this,void 0,void 0,function(){return ni(this,function(n){switch(n.label){case 0:return[4,e.applyConstraints({advanced:[{fillLightMode:r?"flash":"off",torch:!!r}]})];case 1:return n.sent(),[2]}})})},t.mediaStreamIsTorchCompatible=function(e){var r,n,a=e.getVideoTracks();try{for(var s=eT(a),o=s.next();!o.done;o=s.next()){var l=o.value;if(t.mediaStreamIsTorchCompatibleTrack(l))return!0}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return!1},t.mediaStreamIsTorchCompatibleTrack=function(e){try{var r=e.getCapabilities();return"torch"in r}catch(n){return console.error(n),console.warn("Your browser may be not fully compatible with WebRTC and/or ImageCapture specs. Torch will not be available."),!1}},t.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&e.readyState>2},t.getMediaElement=function(e,r){var n=document.getElementById(e);if(!n)throw new Vi("element with id '".concat(e,"' not found"));if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new Vi("element with id '".concat(e,"' must be an ").concat(r," element"));return n},t.createVideoElement=function(e){if(e instanceof HTMLVideoElement)return e;if(typeof e=="string")return t.getMediaElement(e,"video");if(!e&&typeof document<"u"){var r=document.createElement("video");return r.width=200,r.height=200,r}throw new Error("Couldn't get videoElement from videoSource!")},t.prepareImageElement=function(e){if(e instanceof HTMLImageElement)return e;if(typeof e=="string")return t.getMediaElement(e,"img");if(typeof e>"u"){var r=document.createElement("img");return r.width=200,r.height=200,r}throw new Error("Couldn't get imageElement from imageSource!")},t.prepareVideoElement=function(e){var r=t.createVideoElement(e);return r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r},t.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},t.createBinaryBitmapFromCanvas=function(e){var r=new AQe(e),n=new Nse(r);return new wse(n)},t.drawImageOnCanvas=function(e,r){e.drawImage(r,0,0)},t.getMediaElementDimensions=function(e){if(e instanceof HTMLVideoElement)return{height:e.videoHeight,width:e.videoWidth};if(e instanceof HTMLImageElement)return{height:e.naturalHeight||e.height,width:e.naturalWidth||e.width};throw new Error("Couldn't find the Source's dimensions!")},t.createCaptureCanvas=function(e){if(!e)throw new Vi("Cannot create a capture canvas without a media element.");if(typeof document>"u")throw new Error(`The page "Document" is undefined, make sure you're running in a browser.`);var r=document.createElement("canvas"),n=t.getMediaElementDimensions(e),a=n.width,s=n.height;return r.style.width=a+"px",r.style.height=s+"px",r.width=a,r.height=s,r},t.tryPlayVideo=function(e){return ri(this,void 0,void 0,function(){var r;return ni(this,function(n){switch(n.label){case 0:if(e!=null&&e.ended)return console.error("Trying to play video that has ended."),[2,!1];if(t.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2,!0];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.play()];case 2:return n.sent(),[2,!0];case 3:return r=n.sent(),console.warn("It was not possible to play the video.",r),[2,!1];case 4:return[2]}})})},t.createCanvasFromMediaElement=function(e){var r=t.createCaptureCanvas(e),n=r.getContext("2d");if(!n)throw new Error("Couldn't find Canvas 2D Context.");return t.drawImageOnCanvas(n,e),r},t.createBinaryBitmapFromMediaElem=function(e){var r=t.createCanvasFromMediaElement(e);return t.createBinaryBitmapFromCanvas(r)},t.destroyImageElement=function(e){e.src="",e.removeAttribute("src"),e=void 0},t.listVideoInputDevices=function(){return ri(this,void 0,void 0,function(){var e,r,n,a,s,o,l,c,u,d,f,A;return ni(this,function(h){switch(h.label){case 0:if(!Lse())throw new Error("Can't enumerate devices, navigator is not present.");if(!pQe())throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=h.sent(),r=[];try{for(n=eT(e),a=n.next();!a.done;a=n.next())s=a.value,o=s.kind==="video"?"videoinput":s.kind,o==="videoinput"&&(l=s.deviceId||s.id,c=s.label||"Video device ".concat(r.length+1),u=s.groupId,d={deviceId:l,label:c,kind:o,groupId:u},r.push(d))}catch(m){f={error:m}}finally{try{a&&!a.done&&(A=n.return)&&A.call(n)}finally{if(f)throw f.error}}return[2,r]}})})},t.findDeviceById=function(e){return ri(this,void 0,void 0,function(){var r;return ni(this,function(n){switch(n.label){case 0:return[4,t.listVideoInputDevices()];case 1:return r=n.sent(),r?[2,r.find(function(a){return a.deviceId===e})]:[2]}})})},t.cleanVideoSource=function(e){if(e){try{e.srcObject=null}catch{e.src=""}e&&e.removeAttribute("src")}},t.releaseAllStreams=function(){t.streamTracker.length!==0&&t.streamTracker.forEach(function(e){e.getTracks().forEach(function(r){return r.stop()})}),t.streamTracker=[]},t.playVideoOnLoadAsync=function(e,r){return ri(this,void 0,void 0,function(){var n;return ni(this,function(a){switch(a.label){case 0:return[4,t.tryPlayVideo(e)];case 1:return n=a.sent(),n?[2,!0]:[2,new Promise(function(s,o){var l=setTimeout(function(){t.isVideoPlaying(e)||(o(!1),e.removeEventListener("canplay",c))},r),c=function(){t.tryPlayVideo(e).then(function(u){clearTimeout(l),e.removeEventListener("canplay",c),s(u)})};e.addEventListener("canplay",c)})]}})})},t.attachStreamToVideo=function(e,r,n){return n===void 0&&(n=5e3),ri(this,void 0,void 0,function(){var a;return ni(this,function(s){switch(s.label){case 0:return a=t.prepareVideoElement(r),t.addVideoSource(a,e),[4,t.playVideoOnLoadAsync(a,n)];case 1:return s.sent(),[2,a]}})})},t._waitImageLoad=function(e){return new Promise(function(r,n){var a=1e4,s=setTimeout(function(){t.isImageLoaded(e)||(e.removeEventListener("load",o),n())},a),o=function(){clearTimeout(s),e.removeEventListener("load",o),r()};e.addEventListener("load",o)})},t.checkCallbackFnOrThrow=function(e){if(!e)throw new Vi("`callbackFn` is a required parameter, you cannot capture results without it.")},t.disposeMediaStream=function(e){e.getVideoTracks().forEach(function(r){return r.stop()}),e=void 0},t.prototype.decode=function(e){var r=t.createCanvasFromMediaElement(e);return this.decodeFromCanvas(r)},t.prototype.decodeBitmap=function(e){return this.reader.decode(e,this.hints)},t.prototype.decodeFromCanvas=function(e){var r=t.createBinaryBitmapFromCanvas(e);return this.decodeBitmap(r)},t.prototype.decodeFromImageElement=function(e){return ri(this,void 0,void 0,function(){var r;return ni(this,function(n){switch(n.label){case 0:if(!e)throw new Vi("An image element must be provided.");return r=t.prepareImageElement(e),[4,this._decodeOnLoadImage(r)];case 1:return[2,n.sent()]}})})},t.prototype.decodeFromImageUrl=function(e){return ri(this,void 0,void 0,function(){var r;return ni(this,function(n){switch(n.label){case 0:if(!e)throw new Vi("An URL must be provided.");r=t.prepareImageElement(),r.src=e,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.decodeFromImageElement(r)];case 2:return[2,n.sent()];case 3:return t.destroyImageElement(r),[7];case 4:return[2]}})})},t.prototype.decodeFromConstraints=function(e,r,n){return ri(this,void 0,void 0,function(){var a,s;return ni(this,function(o){switch(o.label){case 0:return t.checkCallbackFnOrThrow(n),[4,this.getUserMedia(e)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.decodeFromStream(a,r,n)];case 3:return[2,o.sent()];case 4:throw s=o.sent(),t.disposeMediaStream(a),s;case 5:return[2]}})})},t.prototype.decodeFromStream=function(e,r,n){return ri(this,void 0,void 0,function(){var a,s,o,l,c,u,d,f,A,h=this;return ni(this,function(m){switch(m.label){case 0:return t.checkCallbackFnOrThrow(n),a=this.options.tryPlayVideoTimeout,[4,t.attachStreamToVideo(e,r,a)];case 1:return s=m.sent(),o=function(){t.disposeMediaStream(e),t.cleanVideoSource(s)},l=this.scan(s,n,o),c=e.getVideoTracks(),u=tv(tv({},l),{stop:function(){l.stop()},streamVideoConstraintsApply:function(p,x){return ri(this,void 0,void 0,function(){var v,y,b,w,j,I,C;return ni(this,function(S){switch(S.label){case 0:v=x?c.filter(x):c,S.label=1;case 1:S.trys.push([1,6,7,8]),y=eT(v),b=y.next(),S.label=2;case 2:return b.done?[3,5]:(w=b.value,[4,w.applyConstraints(p)]);case 3:S.sent(),S.label=4;case 4:return b=y.next(),[3,2];case 5:return[3,8];case 6:return j=S.sent(),I={error:j},[3,8];case 7:try{b&&!b.done&&(C=y.return)&&C.call(y)}finally{if(I)throw I.error}return[7];case 8:return[2]}})})},streamVideoConstraintsGet:function(p){return c.find(p).getConstraints()},streamVideoSettingsGet:function(p){return c.find(p).getSettings()},streamVideoCapabilitiesGet:function(p){return c.find(p).getCapabilities()}}),d=t.mediaStreamIsTorchCompatible(e),d&&(f=c==null?void 0:c.find(function(p){return t.mediaStreamIsTorchCompatibleTrack(p)}),A=function(p){return ri(h,void 0,void 0,function(){return ni(this,function(x){switch(x.label){case 0:return[4,t.mediaStreamSetTorch(f,p)];case 1:return x.sent(),[2]}})})},u.switchTorch=A,u.stop=function(){return ri(h,void 0,void 0,function(){return ni(this,function(p){switch(p.label){case 0:return l.stop(),[4,A(!1)];case 1:return p.sent(),[2]}})})}),[2,u]}})})},t.prototype.decodeFromVideoDevice=function(e,r,n){return ri(this,void 0,void 0,function(){var a,s;return ni(this,function(o){switch(o.label){case 0:return t.checkCallbackFnOrThrow(n),e?a={deviceId:{exact:e}}:a={facingMode:"environment"},s={video:a},[4,this.decodeFromConstraints(s,r,n)];case 1:return[2,o.sent()]}})})},t.prototype.decodeFromVideoElement=function(e,r){return ri(this,void 0,void 0,function(){var n,a;return ni(this,function(s){switch(s.label){case 0:if(t.checkCallbackFnOrThrow(r),!e)throw new Vi("A video element must be provided.");return n=t.prepareVideoElement(e),a=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(n,a)];case 1:return s.sent(),[2,this.scan(n,r)]}})})},t.prototype.decodeFromVideoUrl=function(e,r){return ri(this,void 0,void 0,function(){var n,a,s,o;return ni(this,function(l){switch(l.label){case 0:if(t.checkCallbackFnOrThrow(r),!e)throw new Vi("An URL must be provided.");return n=t.prepareVideoElement(),n.src=e,a=function(){t.cleanVideoSource(n)},s=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(n,s)];case 1:return l.sent(),o=this.scan(n,r,a),[2,o]}})})},t.prototype.decodeOnceFromConstraints=function(e,r){return ri(this,void 0,void 0,function(){var n;return ni(this,function(a){switch(a.label){case 0:return[4,this.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromStream=function(e,r){return ri(this,void 0,void 0,function(){var n,a,s;return ni(this,function(o){switch(o.label){case 0:return n=!!r,[4,t.attachStreamToVideo(e,r)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,,4,5]),[4,this.scanOneResult(a)];case 3:return s=o.sent(),[2,s];case 4:return n||t.cleanVideoSource(a),[7];case 5:return[2]}})})},t.prototype.decodeOnceFromVideoDevice=function(e,r){return ri(this,void 0,void 0,function(){var n,a;return ni(this,function(s){switch(s.label){case 0:return e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,r)];case 1:return[2,s.sent()]}})})},t.prototype.decodeOnceFromVideoElement=function(e){return ri(this,void 0,void 0,function(){var r,n;return ni(this,function(a){switch(a.label){case 0:if(!e)throw new Vi("A video element must be provided.");return r=t.prepareVideoElement(e),n=this.options.tryPlayVideoTimeout,[4,t.playVideoOnLoadAsync(r,n)];case 1:return a.sent(),[4,this.scanOneResult(r)];case 2:return[2,a.sent()]}})})},t.prototype.decodeOnceFromVideoUrl=function(e){return ri(this,void 0,void 0,function(){var r,n;return ni(this,function(a){switch(a.label){case 0:if(!e)throw new Vi("An URL must be provided.");r=t.prepareVideoElement(),r.src=e,n=this.decodeOnceFromVideoElement(r),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,n];case 2:return[2,a.sent()];case 3:return t.cleanVideoSource(r),[7];case 4:return[2]}})})},t.prototype.scanOneResult=function(e,r,n,a){var s=this;return r===void 0&&(r=!0),n===void 0&&(n=!0),a===void 0&&(a=!0),new Promise(function(o,l){s.scan(e,function(c,u,d){if(c){o(c),d.stop();return}if(u){if(u instanceof lr&&r||u instanceof lo&&n||u instanceof qr&&a)return;d.stop(),l(u)}})})},t.prototype.scan=function(e,r,n){var a=this;t.checkCallbackFnOrThrow(r);var s=t.createCaptureCanvas(e),o;try{o=s.getContext("2d",{willReadFrequently:!0})}catch{o=s.getContext("2d")}if(!o)throw new Error("Couldn't create canvas for visual element scan.");var l=function(){o=void 0,s=void 0},c=!1,u,d=function(){c=!0,clearTimeout(u),l(),n&&n()},f={stop:d},A=function(){if(!c)try{t.drawImageOnCanvas(o,e);var h=a.decodeFromCanvas(s);r(h,void 0,f),u=setTimeout(A,a.options.delayBetweenScanSuccess)}catch(v){r(void 0,v,f);var m=v instanceof lo,p=v instanceof qr,x=v instanceof lr;if(m||p||x){u=setTimeout(A,a.options.delayBetweenScanAttempts);return}l(),n&&n(v)}};return A(),f},t.prototype._decodeOnLoadImage=function(e){return ri(this,void 0,void 0,function(){var r;return ni(this,function(n){switch(n.label){case 0:return r=t.isImageLoaded(e),r?[3,2]:[4,t._waitImageLoad(e)];case 1:n.sent(),n.label=2;case 2:return[2,this.decode(e)]}})})},t.prototype.getUserMedia=function(e){return ri(this,void 0,void 0,function(){var r;return ni(this,function(n){switch(n.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return r=n.sent(),t.streamTracker.push(r),[2,r]}})})},t.streamTracker=[],t}(),xQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){xQe(e,t);function e(r,n){return t.call(this,new tI,r,n)||this}return e})(_1);var vQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){vQe(e,t);function e(r,n){return t.call(this,new Zx(r),r,n)||this}return e})(_1);var yQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){yQe(e,t);function e(r,n){return t.call(this,new nI,r,n)||this}return e})(_1);var bQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),K2=function(t){bQe(e,t);function e(r,n){var a=this,s=new Fse;return s.setHints(r),a=t.call(this,s,r,n)||this,a.reader=s,a}return Object.defineProperty(e.prototype,"possibleFormats",{set:function(r){this.hints.set(Ns.POSSIBLE_FORMATS,r),this.reader.setHints(this.hints)},enumerable:!1,configurable:!0}),e.prototype.decodeBitmap=function(r){return this.reader.decodeWithState(r)},e.prototype.setHints=function(r){this.hints=r,this.reader.setHints(this.hints)},e}(_1),wQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){wQe(e,t);function e(r,n){return t.call(this,new sI,r,n)||this}return e})(_1);var NQe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(t){NQe(e,t);function e(r,n){return t.call(this,new aI,r,n)||this}return e})(_1);const tT=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function os(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function Mh(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function b0(t,e=1){const r=Math.floor(Mh(t,e));return r>0?r:e}function CQe(t){return Object.values(t||{}).every(r=>os(r)==="")}function ap(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(a=>n.set(os(a),a));for(const a of e){const s=n.get(os(a));if(s!=null)return t[s]}}function _Qe({open:t,code:e,onClose:r}){return t?i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-sm rounded-2xl shadow-lg border p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"font-bold text-lg",children:"Cdigo de barras"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:r,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-3",children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Valor"}),i.jsx("div",{className:"text-xl font-mono font-semibold break-all",children:e})]}),i.jsx("div",{className:"mt-3 flex gap-2 justify-end",children:i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:()=>{var n;try{(n=navigator.clipboard)==null||n.writeText(e)}catch{}},children:"Copiar"})})]})}):null}function EQe({open:t,onClose:e,onDetected:r}){const n=g.useRef(null),a=g.useRef(null),[s,o]=g.useState(""),l=g.useRef("");return g.useEffect(()=>{if(!t)return;let c=!1;const u=new K2,d=()=>{var A,h,m;try{(A=a.current)==null||A.stop()}catch{}a.current=null;try{const p=(h=n.current)==null?void 0:h.srcObject;(m=p==null?void 0:p.getTracks)==null||m.call(p).forEach(x=>x.stop())}catch{}try{n.current&&(n.current.srcObject=null)}catch{}};return(async()=>{o("");try{if(!n.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(m=>m.stop())}catch{}const A=await u.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},n.current,h=>{if(!c&&h){const m=String(h.getText()||"").trim().replace(/\s+/g,"");if(!m||m===l.current)return;l.current=m,d(),r(m),e()}});a.current=A}catch(A){const h=String((A==null?void 0:A.message)||""),m=String((A==null?void 0:A.name)||"");h.toLowerCase().includes("permission")||m==="NotAllowedError"?o("Permiso de cmara denegado."):m==="NotFoundError"||h.toLowerCase().includes("notfound")?o("No se encontr cmara en este dispositivo."):h.toLowerCase().includes("secure")||h.toLowerCase().includes("https")?o("La cmara requiere HTTPS (sitio seguro)."):o(h||"No se pudo iniciar el escner.")}})(),()=>{c=!0,d()}},[t,e,r]),t?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:e,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:n,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),s&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:s}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}function SQe(){const{refreshKey:t,refresh:e}=Mc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState(0),[m,p]=g.useState(1),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState(null),[I,C]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState(0),[T,P]=g.useState(1),[K,le]=g.useState(""),[oe,ie]=g.useState(""),[Ae,te]=g.useState(""),[Te,Ue]=g.useState(""),[O,H]=g.useState(""),[G,L]=g.useState(!1),[W,X]=g.useState(""),[D,Q]=g.useState(!1),[Z,be]=g.useState("create"),[U,ze]=g.useState(!1),[re,J]=g.useState(""),[Re,ke]=g.useState([]),[Be,Ye]=g.useState([]),[ot,Ct]=g.useState(!1),[jt,Ot]=g.useState(!1);g.useEffect(()=>{var lt;const Pe=window.matchMedia("(max-width: 900px)"),rt=()=>Ot(Pe.matches);return rt(),(lt=Pe.addEventListener)==null||lt.call(Pe,"change",rt),()=>{var ht;return(ht=Pe.removeEventListener)==null?void 0:ht.call(Pe,"change",rt)}},[]);const[Tt,Qt]=g.useState(!0),[Ft,Qe]=g.useState(!0);g.useEffect(()=>{jt?(Qt(!1),Qe(!1)):(Qt(!0),Qe(!0))},[jt]);const[De,Je]=g.useState(null),[dt,ce]=g.useState({}),we=g.useRef(!1),ue=g.useRef(null);g.useEffect(()=>{n(!0),s("");const Pe=bt(je,"products_candies"),rt=sr(Pe,In("name","asc")),lt=Pd(rt,ht=>{const kt=[],de={};ht.forEach(st=>{const Nt=st.data(),Rt=String(Nt.barcode||"").trim()||void 0;Rt&&(de[st.id]=Rt),kt.push({id:st.id,name:Nt.name||"",category:Nt.category||"",providerPrice:Number(Nt.providerPrice||0),unitsPerPackage:Number(Nt.unitsPerPackage||1),barcode:Rt,packaging:String(Nt.packaging||Nt.empaque||"").trim()||void 0,createdAt:Nt.createdAt})});const qe=ne.current||{};let at=!1;for(const st of Object.keys(de))if((de[st]||"")!==(qe[st]||"")){at=!0;break}l(kt),ne.current=de,n(!1),!Ve.current&&at&&(s(" Catlogo actualizado."),setTimeout(()=>s(""),3e3)),Ve.current=!1},ht=>{console.error(ht),s(" Error sincronizando catlogo de dulces."),n(!1)});return()=>lt()},[t]);const ne=g.useRef({}),Ve=g.useRef(!0),it=g.useMemo(()=>{const Pe=os(Ae),rt=String(Te||"").trim(),lt=String(O||"").trim().toLowerCase();return lt?o.filter(ht=>String(ht.packaging||"").trim().toLowerCase()===lt):!Pe&&!rt?o:o.filter(ht=>{const kt=`${ht.category} ${ht.name}`.toLowerCase(),de=Pe?kt.includes(Pe):!0,qe=String(ht.barcode||""),at=rt?qe.includes(rt):!0;return de&&at})},[o,Ae,Te,O]),vt=7,[me,Ee]=g.useState(1),ye=g.useMemo(()=>{const Pe={};return it.forEach(rt=>{const lt=String(rt.category||"(sin categora)").trim()||"(sin categora)";Pe[lt]||(Pe[lt]=[]),Pe[lt].push(rt)}),Object.entries(Pe).map(([rt,lt])=>({category:rt,rows:lt.sort((ht,kt)=>ht.name.localeCompare(kt.name,"es"))})).sort((rt,lt)=>rt.category.localeCompare(lt.category,"es"))},[it]),We=Math.max(1,Math.ceil((jt?ye.length:it.length)/vt)),ge=g.useMemo(()=>{const Pe=(me-1)*vt;return it.slice(Pe,Pe+vt)},[it,me]),Ie=g.useMemo(()=>{const Pe=(me-1)*vt;return ye.slice(Pe,Pe+vt)},[ye,me]);g.useEffect(()=>{Ee(1)},[Ae,Te,O]),g.useEffect(()=>{Ee(Pe=>Math.min(Pe,We))},[We]);const xt=()=>Ee(1),Pt=()=>Ee(Pe=>Math.max(1,Pe-1)),It=()=>Ee(Pe=>Math.min(We,Pe+1)),Ut=()=>Ee(We),$t=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:xt,disabled:me===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Pt,disabled:me===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",me," de ",We]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:It,disabled:me===We,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ut,disabled:me===We,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[it.length," producto(s)"]})]}),Le=Pe=>{ce(rt=>({...rt,[Pe]:!rt[Pe]}))},Ce=g.useMemo(()=>{const Pe=new Set;return o.forEach(rt=>{const lt=String(rt.category||"").trim();lt&&Pe.add(lt)}),Array.from(Pe).sort((rt,lt)=>rt.localeCompare(lt,"es"))},[o]),pe=()=>{u(""),f(""),h(0),p(1),v(""),b("")},He=async Pe=>{if(Pe.preventDefault(),we.current||r)return;s("");const rt=String(c||"").trim(),lt=String(d||"").trim(),ht=Math.max(0,Mh(A,0)),kt=b0(m,1),de=String(x||"").trim();if(!rt)return s(" La categora es requerida.");if(!lt)return s(" El nombre del producto es requerido.");if(ht<=0)return s(" El precio proveedor debe ser > 0.");if(kt<=0)return s(" Und x paquete debe ser > 0.");const qe=`${os(rt)}::${os(lt)}`,at=Date.now();if(ue.current&&ue.current.key===qe&&at-ue.current.ts<4e3){s(" Ya se est creando este producto.");return}if(o.some(Nt=>os(Nt.category)===os(rt)&&os(Nt.name)===os(lt)))return s(" Ya existe un producto con esa categora y nombre.");if(de&&o.some(Rt=>String(Rt.barcode||"")===de))return s(" Ya existe un producto con ese cdigo de barras.");we.current=!0,ue.current={key:qe,ts:at};try{if(n(!0),!(await Ht(sr(bt(je,"products_candies"),Ar("category","==",rt),Ar("name","==",lt),vS(1)))).empty){s(" Ya existe un producto con esa categora y nombre.");return}if(de&&!(await Ht(sr(bt(je,"products_candies"),Ar("barcode","==",de),vS(1)))).empty){s(" Ya existe un producto con ese cdigo de barras.");return}const Rt={category:rt,name:lt,providerPrice:ht,unitsPerPackage:kt,createdAt:xr.now()};de&&(Rt.barcode=de);const nr=String(y||"").trim();nr&&(Rt.packaging=nr),await Wn(bt(je,"products_candies"),Rt),s(" Producto creado."),pe()}catch(Nt){console.error(Nt),s(" Error creando producto.")}finally{n(!1),we.current=!1}},he=Pe=>{j(Pe.id),C(Pe.category),E(Pe.name),k(Pe.providerPrice),P(Pe.unitsPerPackage||1),le(String(Pe.barcode||"")),ie(String(Pe.packaging||"")),s("")},ee=()=>{j(null),C(""),E(""),k(0),P(1),le(""),ie("")},_e=async()=>{if(!w)return;s("");const Pe=String(I||"").trim(),rt=String(S||"").trim(),lt=Math.max(0,Mh(B,0)),ht=b0(T,1),kt=String(K||"").trim(),de=String(oe||"").trim();if(!Pe)return s(" La categora es requerida.");if(!rt)return s(" El nombre del producto es requerido.");if(lt<=0)return s(" El precio proveedor debe ser > 0.");if(ht<=0)return s(" Und x paquete debe ser > 0.");if(o.some(at=>at.id!==w&&os(at.category)===os(Pe)&&os(at.name)===os(rt)))return s(" Ya existe otro producto con esa categora y nombre.");if(kt&&o.some(st=>st.id!==w&&String(st.barcode||"")===kt))return s(" Ya existe otro producto con ese cdigo de barras.");try{n(!0);const at={category:Pe,name:rt,providerPrice:lt,unitsPerPackage:ht,updatedAt:xr.now()};at.barcode=kt||"",at.packaging=de||"",await kn(Xt(je,"products_candies",w),at),l(st=>st.map(Nt=>Nt.id===w?{...Nt,category:Pe,name:rt,providerPrice:lt,unitsPerPackage:ht,barcode:kt||void 0,packaging:de||void 0}:Nt).sort((Nt,Rt)=>Nt.name.localeCompare(Rt.name,"es"))),jt&&s(" Producto guardado."),ee()}catch(at){console.error(at),s(" Error actualizando producto.")}finally{n(!1)}},R=async Pe=>{if(confirm(`Eliminar "${Pe.name}" (${Pe.category}) del catlogo?`))try{n(!0),await zn(Xt(je,"products_candies",Pe.id)),l(lt=>lt.filter(ht=>ht.id!==Pe.id)),s(" Producto eliminado.")}catch(lt){console.error(lt),s(" Error eliminando producto.")}finally{n(!1)}},V=()=>{const Pe=[{Id:"",Categoria:"Gomitas",Producto:"Gomita Fresa",PrecioProveedor:120,UnidadesPorPaquete:24,Empaque:"Tarro",Codigo:"7445074183182"}],rt=Qa.json_to_sheet(Pe),lt=Qa.book_new();Qa.book_append_sheet(lt,rt,"Productos");const ht=gP(lt,{type:"array",bookType:"xlsx"}),kt=new Blob([ht],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),de=URL.createObjectURL(kt),qe=document.createElement("a");qe.href=de,qe.download="template_productos_dulces.xlsx",document.body.appendChild(qe),qe.click(),qe.remove(),URL.revokeObjectURL(de)},q=Pe=>{const rt=[],lt=[];Pe.forEach((kt,de)=>{if(!kt||typeof kt!="object"||CQe(kt))return;const qe=String(ap(kt,["Id","ID","productId","docId"])??"").trim(),at=String(ap(kt,["Categoria","Categora","Category","cat","category"])??"").trim(),st=String(ap(kt,["Producto","Product","Nombre","Name","producto","name"])??"").trim(),Nt=ap(kt,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Precio","Costo","providerPrice"]),Rt=ap(kt,["UnidadesPorPaquete","Und x Paquete","UnitsPerPackage","UPP","unitsPerPackage"]),nr=ap(kt,["Codigo","Cdigo","Barcode","barcode","EAN","UPC","Code"]),_r=String(nr??"").trim(),$r=ap(kt,["Empaque","Packaging","PackagingType","Pack","Formato"]),or=String($r??"").trim(),kr=Math.max(0,Mh(Nt,0)),en=b0(Rt,1),rn=de+2;at||lt.push(`Fila ${rn}: falta Categoria.`),st||lt.push(`Fila ${rn}: falta Producto/Nombre.`),kr<=0&&lt.push(`Fila ${rn}: PrecioProveedor debe ser > 0.`),en<=0&&lt.push(`Fila ${rn}: UnidadesPorPaquete debe ser > 0.`),at&&st&&kr>0&&en>0&&rt.push({id:qe||void 0,category:at,name:st,providerPrice:kr,unitsPerPackage:en,barcode:_r||void 0,packaging:or||void 0,_raw:kt})});const ht=new Map;for(const kt of rt){const de=kt.id?`id::${kt.id}`:`${os(kt.category)}::${os(kt.name)}`;ht.set(de,kt)}return{rows:Array.from(ht.values()),errors:lt}},se=async Pe=>{if(s(""),Ye([]),ke([]),J((Pe==null?void 0:Pe.name)||""),!Pe)return;const rt=Pe.name.toLowerCase(),lt=rt.endsWith(".xlsx")||rt.endsWith(".xls"),ht=rt.endsWith(".csv");if(!lt&&!ht){Ye(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{Ct(!0);const kt=new FileReader,de=await new Promise((_r,$r)=>{kt.onerror=()=>$r(new Error("No se pudo leer el archivo.")),kt.onload=()=>_r(kt.result),kt.readAsArrayBuffer(Pe)}),qe=$v(new Uint8Array(de),{type:"array"}),at=qe.SheetNames[0],st=qe.Sheets[at],Nt=Qa.sheet_to_json(st,{defval:""}),{rows:Rt,errors:nr}=q(Nt);ke(Rt),Ye(nr),Rt.length===0&&nr.length===0&&Ye(["No se encontraron filas vlidas para importar."])}catch(kt){console.error(kt),Ye(["Error leyendo el archivo. Revis que no est corrupto."])}finally{Ct(!1)}},Ne=(Pe,rt)=>{ke(lt=>{const ht=[...lt],kt=ht[Pe];return kt?(ht[Pe]={...kt,...rt},ht):lt})},Me=async()=>{if(s(""),Be.length>0){s(" Correg los errores antes de importar.");return}if(Re.length===0){s(" No hay filas para importar.");return}try{Ct(!0);const Pe={},rt={},lt={};o.forEach(qe=>{Pe[qe.id]=qe,rt[`${os(qe.category)}::${os(qe.name)}`]=qe;const at=String(qe.barcode||"").trim();at&&(lt[at]=qe)});const ht=Sc(je);let kt=0,de=0;for(const qe of Re){const at=String(qe.category||"").trim(),st=String(qe.name||"").trim(),Nt=Math.max(0,Mh(qe.providerPrice,0)),Rt=b0(qe.unitsPerPackage,1),nr=String(qe.barcode||"").trim();if(!at||!st||Nt<=0||Rt<=0)continue;let _r;if(qe.id&&Pe[qe.id])_r=Pe[qe.id];else{const $r=`${os(at)}::${os(st)}`;_r=rt[$r]}if(!_r&&nr&&lt[nr]&&(_r=lt[nr]),_r){const $r={category:at,name:st,providerPrice:Nt,unitsPerPackage:Rt,updatedAt:xr.now()};qe.barcode!=null&&($r.barcode=nr||""),qe.packaging!=null&&($r.packaging=String(qe.packaging||"")||""),ht.update(Xt(je,"products_candies",_r.id),$r),de+=1}else{const $r=Xt(bt(je,"products_candies")),or={category:at,name:st,providerPrice:Nt,unitsPerPackage:Rt,createdAt:xr.now()};nr&&(or.barcode=nr),qe.packaging&&(or.packaging=qe.packaging),ht.set($r,or),kt+=1}}await ht.commit(),s(` Importacin lista. Creados: ${kt}, Actualizados: ${de}`),ze(!1),ke([]),Ye([]),J(""),e()}catch(Pe){console.error(Pe),s(" Error importando productos a Firestore.")}finally{Ct(!1)}},Ke=g.useMemo(()=>{const Pe=new Set(o.map(de=>de.id)),rt=new Set(o.map(de=>`${os(de.category)}::${os(de.name)}`)),lt=new Set(o.map(de=>String(de.barcode||"").trim()).filter(Boolean));let ht=0,kt=0;for(const de of Re){if(de.id&&Pe.has(de.id)){ht+=1;continue}const qe=`${os(de.category)}::${os(de.name)}`;if(rt.has(qe)){ht+=1;continue}const at=String(de.barcode||"").trim();if(at&&lt.has(at)){ht+=1;continue}kt+=1}return{willCreate:kt,willUpdate:ht,total:Re.length}},[Re,o]);return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Catalogo"}),i.jsx("div",{className:"flex gap-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Rc,{onClick:e,loading:r||ot}),!jt&&i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-white border shadow-sm",onClick:()=>{ze(!0),ke([]),Ye([]),J("")},children:"Importar"})]})})]}),jt&&i.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-900 text-white",onClick:()=>Qt(Pe=>!Pe),children:Tt?"Ocultar creacin":"Crear producto"}),i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-white border shadow-sm",onClick:()=>{ze(!0),ke([]),Ye([]),J("")},children:"Importar"}),i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-200",onClick:()=>Qe(Pe=>!Pe),children:Ft?"Ocultar filtros":"Mostrar filtros"}),Ft&&i.jsxs("div",{className:"bg-white p-3 rounded shadow-sm border",children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:O,onChange:Pe=>H(Pe.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]})]}),Tt&&i.jsxs("form",{onSubmit:He,className:"bg-white p-3 rounded shadow border mb-4 grid grid-cols-1 md:grid-cols-6 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:Pe=>u(Pe.target.value),placeholder:"Ej: Gomitas"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:d,onChange:Pe=>f(Pe.target.value),placeholder:"Ej: Gomita Fresa"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:y,onChange:Pe=>b(Pe.target.value),children:[i.jsx("option",{value:"",children:"Seleccionar"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(A)?"":A,onChange:Pe=>h(Math.max(0,Mh(Pe.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Und x paquete"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:m,onChange:Pe=>p(b0(Pe.target.value,1))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo (opcional)"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"w-full border rounded px-2 py-1",value:x,onChange:Pe=>v(Pe.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white hover:bg-black whitespace-nowrap",onClick:()=>{be("create"),Q(!0)},children:"Escanear"})]})]}),i.jsxs("div",{className:"md:col-span-6 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:pe,children:"Limpiar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",disabled:r,children:"Crear producto"})]})]}),Ft&&i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-3 flex flex-col md:flex-row gap-3 items-center text-sm",children:[i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:Ae,onChange:Pe=>te(Pe.target.value),placeholder:"Buscar por categora o producto"}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{className:"block font-semibold",children:"Empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:O,onChange:Pe=>H(Pe.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]})]}),i.jsxs("div",{className:"w-full md:w-1/2",children:[i.jsx("label",{className:"block font-semibold",children:"Buscar por cdigo"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:Te,onChange:Pe=>Ue(Pe.target.value),placeholder:"Ej: 7445074183182"}),i.jsx("div",{className:"mt-2 md:mt-0",children:i.jsx("button",{type:"button",className:"w-full md:w-auto px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{be("search"),Q(!0),Qe(!0)},children:"Escanear producto"})}),i.jsx("div",{className:"mt-2 md:mt-0",children:i.jsx("button",{type:"button",className:"w-full md:w-auto px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{te(""),Ue("")},children:"Limpiar filtros"})})]}),i.jsxs("div",{className:"w-full md:w-auto text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos en catlogo"}),i.jsx("div",{className:"text-lg font-semibold",children:it.length})]})]}),jt?i.jsxs("div",{className:"space-y-2",children:[r?i.jsx("div",{className:"bg-white border rounded p-4 text-center",children:"Cargando"}):it.length===0?i.jsx("div",{className:"bg-white border rounded p-4 text-center",children:"Sin productos."}):i.jsx("div",{className:"space-y-3",children:Ie.map(Pe=>{const rt=!!dt[Pe.category];return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Le(Pe.category),"aria-expanded":rt,children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-bold truncate",children:Pe.category}),i.jsxs("div",{className:"text-xs text-gray-600",children:[Pe.rows.length," producto(s)"]})]}),i.jsx("span",{className:`transition-transform ${rt?"rotate-180":""}`,children:""})]}),rt&&i.jsx("div",{className:"border-t p-2 space-y-2",children:Pe.rows.map(lt=>{const ht=w===lt.id,kt=De===lt.id,de=!!String(lt.barcode||"").trim();return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>Je(qe=>qe===lt.id?null:lt.id),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-bold truncate",children:lt.name}),i.jsx("div",{className:"text-xs text-gray-600 truncate",children:lt.category})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio proveedor"}),i.jsx("div",{className:"font-bold tabular-nums",children:tT(lt.providerPrice)})]})]}),kt&&i.jsx("div",{className:"px-3 pb-3 border-t",children:i.jsxs("div",{className:"pt-3 space-y-2 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Categora"}),ht?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:I,onChange:qe=>C(qe.target.value)}):i.jsx("div",{className:"font-semibold",children:lt.category})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Und x paquete"}),ht?i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:T,onChange:qe=>P(b0(qe.target.value,1))}):i.jsx("div",{className:"font-semibold text-right tabular-nums",children:lt.unitsPerPackage})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Empaque"}),ht?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:oe,onChange:qe=>ie(qe.target.value),children:[i.jsx("option",{value:"",children:"Seleccionar"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):i.jsx("div",{className:"font-semibold",children:lt.packaging||""})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio proveedor"}),ht?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(B)?"":B,onChange:qe=>k(Math.max(0,Mh(qe.target.value,0)))}):i.jsx("div",{className:"font-semibold tabular-nums",children:tT(lt.providerPrice)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Cdigo"}),ht?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-1",value:K,onChange:qe=>le(qe.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{be("edit"),Q(!0)},children:"Escanear"})]}):de?i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",onClick:()=>{X(String(lt.barcode||"").trim()),L(!0)},children:"Ver cdigo"}):i.jsx("div",{className:"text-gray-600",children:"No"})]})]}),i.jsx("div",{className:"pt-2 flex gap-2",children:ht?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-blue-600 text-white",onClick:_e,type:"button",children:"Guardar"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{be("edit"),Q(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-gray-200",onClick:ee,type:"button",children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-yellow-400",onClick:()=>he(lt),type:"button",children:"Editar"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-red-600 text-white",onClick:()=>R(lt),type:"button",children:"Borrar"})]})})]})})]},lt.id)})})]},Pe.category)})}),!r&&it.length>0&&$t()]}):i.jsxs("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:[i.jsxs("table",{className:"min-w-[1050px] w-full text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-center",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):it.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin productos."})}):ge.map(Pe=>{const rt=w===Pe.id,lt=!!String(Pe.barcode||"").trim();return i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:rt?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:I,onChange:ht=>C(ht.target.value)}):Pe.category}),i.jsx("td",{className:"p-2 border",children:rt?i.jsx("input",{className:"w-full border rounded px-2 py-1",value:S,onChange:ht=>E(ht.target.value)}):Pe.name}),i.jsx("td",{className:"p-2 border",children:rt?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:oe,onChange:ht=>ie(ht.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):Pe.packaging||""}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:rt?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(B)?"":B,onChange:ht=>k(Math.max(0,Mh(ht.target.value,0)))}):tT(Pe.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:rt?i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:T,onChange:ht=>P(b0(ht.target.value,1))}):Pe.unitsPerPackage}),i.jsx("td",{className:"p-2 border text-center",children:rt?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("input",{className:"w-44 border rounded px-2 py-1",value:K,onChange:ht=>le(ht.target.value),placeholder:"EAN/UPC"}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-800 text-white hover:bg-black",onClick:()=>{be("edit"),Q(!0)},children:"Escanear"})]}):lt?i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",onClick:()=>{X(String(Pe.barcode||"").trim()),L(!0)},children:"S"}):i.jsx("span",{className:"px-2 py-1 rounded bg-gray-100 text-gray-600",children:"No"})}),i.jsx("td",{className:"p-2 border",children:rt?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:_e,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ee,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",onClick:()=>he(Pe),type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>R(Pe),type:"button",children:"Borrar"})]})})]},Pe.id)})})]}),!r&&it.length>0&&$t()]}),a?jt&&a===" Producto guardado."?i.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[i.jsx("div",{className:"flex-1 text-sm",children:a}),i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white",onClick:()=>{s(""),ee(),Q(!1)},children:"Aceptar"})]}):i.jsx("p",{className:"mt-2 text-sm",children:a}):null,i.jsx(_Qe,{open:G,code:W,onClose:()=>L(!1)}),i.jsx(EQe,{open:D,onClose:()=>Q(!1),onDetected:async Pe=>{const rt=String(Pe||"").trim();if(rt){if(Z==="edit"&&w){if(o.some(ht=>ht.id!==w&&String(ht.barcode||"")===rt)){s(" Ya existe otro producto con ese cdigo de barras."),le(rt),Q(!1);return}try{await kn(Xt(je,"products_candies",w),{barcode:rt}),l(ht=>ht.map(kt=>kt.id===w?{...kt,barcode:rt}:kt)),le(rt),jt&&s(" Producto guardado.")}catch(ht){console.error(ht),s(" Error guardando cdigo de barras.")}finally{Q(!1)}return}if(Z==="search"){Ue(rt),Q(!1);return}Z==="create"?v(Pe):le(Pe)}}}),U&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar productos (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ze(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas (flexible): Id (opcional), Categoria, Producto/Nombre, PrecioProveedor, UnidadesPorPaquete, Empaque (opcional), Codigo (opcional)."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:V,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:Pe=>{var rt;return se(((rt=Pe.target.files)==null?void 0:rt[0])||null)}}),re&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:re})]}),ot&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),Be.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:Be.slice(0,50).map((Pe,rt)=>i.jsx("li",{children:Pe},rt))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",Ke.total," filas (Crear:"," ",Ke.willCreate," / Actualizar:"," ",Ke.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:Me,disabled:ot||Re.length===0||Be.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1250px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Codigo (opcional)"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:Re.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):Re.slice(0,300).map((Pe,rt)=>{const lt=Pe.id?o.some(qe=>qe.id===Pe.id):!1,ht=o.some(qe=>`${os(qe.category)}::${os(qe.name)}`==`${os(Pe.category)}::${os(Pe.name)}`),kt=Pe.barcode?o.some(qe=>String(qe.barcode||"")===Pe.barcode):!1,de=lt||ht||kt;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Pe.id||"",onChange:qe=>Ne(rt,{id:qe.target.value.trim()||void 0}),placeholder:"docId (si quers update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Pe.category,onChange:qe=>Ne(rt,{category:qe.target.value}),list:"categories-list"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:Pe.name,onChange:qe=>Ne(rt,{name:qe.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(Pe.providerPrice)?"":Pe.providerPrice,onChange:qe=>Ne(rt,{providerPrice:Math.max(0,Mh(qe.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:Pe.unitsPerPackage,onChange:qe=>Ne(rt,{unitsPerPackage:b0(qe.target.value,1)})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Pe.packaging||"",onChange:qe=>Ne(rt,{packaging:qe.target.value.trim()||void 0}),placeholder:"Tarro, Bolsa..."})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:Pe.barcode||"",onChange:qe=>Ne(rt,{barcode:qe.target.value.trim()||void 0}),placeholder:"EAN/UPC (opcional)"})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${de?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:de?"ACTUALIZA":"CREA"})})]},`${Pe.id||""}-${rt}`)})})]}),i.jsx("datalist",{id:"categories-list",children:Ce.map(Pe=>i.jsx("option",{value:Pe},Pe))})]}),Re.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",Re.length," filas (el import importa todas)."]})]})]})})]})}function Use(t){const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=Number(t.totalUnits||0),n=Number(t.quantity||0),a=Number(t.packages||0);return r>0?Math.floor(r):n>0?Math.floor(n):a>0?Math.floor(a*e):0}function rT(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):Use(t)}const Qse=t=>Math.max(0,Math.floor(Number(t??0)));function IQe(t){return Qse(t.packages??t.totalPackages??t.packs??t.packagesInitial??t.initialPackages??0)}function jQe(t){return Qse(t.remainingPackages??t.remainingPacks??t.packsRemaining??t.packagesRemaining??t.remaining_packages??0)}async function yF(t){const e=String(t||"").trim();if(!e)return{created:0,skipped:0,updated:0,totalItems:0};let r=Xt(je,"candy_main_orders",e),n=await Cs(r);if(!n.exists()){const p=sr(bt(je,"candy_main_orders"),Ar("orderId","==",e)),x=await Ht(p);if(x.empty)throw new Error("Orden maestra no existe");r=x.docs[0].ref,n=x.docs[0]}const a=n.data(),s=r.id,o=Array.isArray(a.items)?a.items:[];if(!o.length)return{created:0,skipped:0,updated:0,totalItems:0};const l=await Ht(sr(bt(je,"inventory_candies"),Ar("orderId","==",s))),c=new Set,u=new Map;l.forEach(p=>{const x=p.data(),v=String(x.productId||"").trim();if(v&&c.add(v),!v)return;const y=u.get(v)||[];y.push({ref:p.ref,data:x}),u.set(v,y)});const d=Sc(je);let f=0,A=0,h=0;const m=String(a.date||"");for(const p of o){const x=String(p.id||p.productId||"").trim();if(!x)continue;const v=u.get(x)||[];if(v.length>0){if(v.length===1&&v.every(k=>{const T=Math.max(0,Math.floor(Number(k.data.remainingPackages||0))),P=Math.max(0,Math.floor(Number(k.data.remaining||0))),K=Math.max(0,Math.floor(Number(k.data.totalUnits||0)));return T<=0&&P<=0&&K<=0})){const k=v[0].ref,T=Math.max(1,Math.floor(Number(p.unitsPerPackage??p.units_per_package??p.upp??1))),P=Number(p.packages??p.totalPackages??p.packagesInitial??p.initialPackages??0),K=Number(p.remainingPackages??p.remainingPacks??p.packagesRemaining??0);let le=Math.max(0,Math.floor(P||0)),oe=Math.max(0,Math.floor(K||0));le<=0&&oe>0&&(le=oe),oe<=0&&(oe=le);const ie=le*T,Ae=oe*T;d.update(k,{productId:x,productName:String(p.name||p.productName||""),category:String(p.category||""),measurement:"unidad",quantity:ie,remaining:Ae,packages:le,remainingPackages:oe,unitsPerPackage:T,totalUnits:ie,providerPrice:Number(p.providerPrice??p.provider_price??p.priceProvider??p.costProvider??0),subtotal:Number(p.subtotal||0),totalRivas:Number(p.totalRivas||0),totalSanJorge:Number(p.totalSanJorge||0),totalIsla:Number(p.totalIsla||0),gainRivas:Number(p.gainRivas||0),gainSanJorge:Number(p.gainSanJorge||0),gainIsla:Number(p.gainIsla||0),unitPriceRivas:Number(p.unitPriceRivas||0),unitPriceSanJorge:Number(p.unitPriceSanJorge||0),unitPriceIsla:Number(p.unitPriceIsla||0),date:m,status:"PENDIENTE",orderId:s,updatedAt:xr.now()}),h+=1;continue}A+=1;continue}const y=Math.max(1,Math.floor(Number(p.unitsPerPackage??p.units_per_package??p.upp??1))),b=Number(p.packages??p.totalPackages??p.packagesInitial??p.initialPackages??0),w=Number(p.remainingPackages??p.remainingPacks??p.packagesRemaining??0);let j=Math.max(0,Math.floor(b||0)),I=Math.max(0,Math.floor(w||0));j<=0&&I>0&&(j=I),I<=0&&(I=j);const C=j*y,S=I*y,E=Xt(bt(je,"inventory_candies"));d.set(E,{productId:x,productName:String(p.name||p.productName||""),category:String(p.category||""),measurement:"unidad",quantity:C,remaining:S,packages:j,remainingPackages:I,unitsPerPackage:y,totalUnits:C,providerPrice:Number(p.providerPrice??p.provider_price??p.priceProvider??p.costProvider??0),subtotal:Number(p.subtotal||0),totalRivas:Number(p.totalRivas||0),totalSanJorge:Number(p.totalSanJorge||0),totalIsla:Number(p.totalIsla||0),gainRivas:Number(p.gainRivas||0),gainSanJorge:Number(p.gainSanJorge||0),gainIsla:Number(p.gainIsla||0),unitPriceRivas:Number(p.unitPriceRivas||0),unitPriceSanJorge:Number(p.unitPriceSanJorge||0),unitPriceIsla:Number(p.unitPriceIsla||0),date:m,createdAt:xr.now(),status:"PENDIENTE",orderId:s}),f+=1}return(f>0||h>0)&&await d.commit(),{created:f,skipped:A,updated:h,totalItems:o.length}}async function PQe(t){const e=Xt(je,"candy_main_orders",t);if((await Cs(e)).exists())return e;const n=sr(bt(je,"candy_main_orders"),Ar("orderId","==",t)),a=await Ht(n);return a.empty?null:Xt(je,"candy_main_orders",a.docs[0].id)}async function nT(t){if(!t)return;const e=await PQe(t);if(!e)return;const r=sr(bt(je,"inventory_candies"),Ar("orderId","==",t)),n=await Ht(r),a=new Map;n.forEach(l=>{const c=l.data(),u=String(c.productId||"");if(!u)return;const d=IQe(c),f=jQe(c),A=Math.max(1,Math.floor(Number(c.unitsPerPackage||1))),h=Number(c.providerPrice||0),m=Number(c.unitPriceRivas||0),p=Number(c.unitPriceSanJorge||0),x=Number(c.unitPriceIsla||0),v=h*d,y=m*d,b=p*d,w=x*d,j=y-v,I=b-v,C=w-v;a.has(u)||a.set(u,{productId:u,name:String(c.productName||""),category:String(c.category||""),unitsPerPackage:A,providerPrice:h,marginRivas:typeof c.marginRivas=="number"?Number(c.marginRivas):void 0,marginSanJorge:typeof c.marginSanJorge=="number"?Number(c.marginSanJorge):void 0,marginIsla:typeof c.marginIsla=="number"?Number(c.marginIsla):void 0,packages:0,remainingPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,unitPriceRivas:m||0,unitPriceSanJorge:p||0,unitPriceIsla:x||0,gainRivas:0,gainSanJorge:0,gainIsla:0});const S=a.get(u);S.packages+=d,S.remainingPackages+=f,S.subtotal+=v,S.totalRivas+=y,S.totalSanJorge+=b,S.totalIsla+=w,S.gainRivas+=j,S.gainSanJorge+=I,S.gainIsla+=C,S.providerPrice=h,S.unitPriceRivas=m||S.unitPriceRivas,S.unitPriceSanJorge=p||S.unitPriceSanJorge,S.unitPriceIsla=x||S.unitPriceIsla,S.unitsPerPackage=A||S.unitsPerPackage,S.name=String(c.productName||S.name),S.category=String(c.category||S.category)});const s=Array.from(a.values()).map(l=>({id:l.productId,name:l.name,category:l.category,providerPrice:l.providerPrice,unitsPerPackage:l.unitsPerPackage,packages:l.packages,remainingPackages:l.remainingPackages,marginRivas:l.marginRivas??void 0,marginSanJorge:l.marginSanJorge??void 0,marginIsla:l.marginIsla??void 0,subtotal:l.subtotal,totalRivas:l.totalRivas,totalSanJorge:l.totalSanJorge,totalIsla:l.totalIsla,unitPriceRivas:l.unitPriceRivas,unitPriceSanJorge:l.unitPriceSanJorge,unitPriceIsla:l.unitPriceIsla,gainRivas:l.gainRivas,gainSanJorge:l.gainSanJorge,gainIsla:l.gainIsla})),o=s.reduce((l,c)=>l+Number(c.packages||0),0);await kn(e,{totalPackages:o,items:s})}function TQe(t){const e=t==null?void 0:t.allocationsByItem;if(!e)return null;const r=[];if(Array.isArray(e))for(const n of e){const a=Array.isArray(n==null?void 0:n.allocations)?n.allocations:[];for(const s of a){const o=String(s.inventorySellerId||""),l=Math.max(0,Math.floor(Number(s.units??s.qty??s.quantity??0)));!o||l<=0||r.push({inventorySellerId:o,units:l})}}else if(typeof e=="object")for(const n of Object.keys(e)){const a=e[n],s=Array.isArray(a==null?void 0:a.allocations)?a.allocations:[];for(const o of s){const l=String(o.inventorySellerId||""),c=Math.max(0,Math.floor(Number(o.units??o.qty??o.quantity??0)));!l||c<=0||r.push({inventorySellerId:l,units:c})}}return r.length?{allocations:r}:null}async function q2(t){const e=t.split("#")[0],r=Xt(je,"sales_candies",e),n=await Cs(r);if(!n.exists())throw new Error("La venta no existe.");const a=n.data(),s=TQe(a);if(s&&s.allocations.length>0){let u=0;return await qs(je,async d=>{const f={};for(const p of s.allocations){const x=p.inventorySellerId,v=Math.max(0,Math.floor(Number(p.units||0)));!x||v<=0||(f[x]=(f[x]||0)+v,u+=v)}const h=Object.keys(f).map(p=>Xt(je,"inventory_candies_sellers",p)),m=await Promise.all(h.map(p=>d.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const v=x.data(),y=Number(v.remainingUnits??v.remaining??0),b=Math.max(0,Math.floor(Number(f[h[p].id]||0))),w=y+b,j=Math.max(1,Math.floor(Number(v.unitsPerPackage||1))),I=Math.floor(w/j);d.update(h[p],{remainingUnits:w,remainingPackages:I})}d.delete(r)}),{restored:u}}const o=[];if(Array.isArray(a.items)&&a.items.length>0){const u={};if(a.allocationsByItem&&typeof a.allocationsByItem=="object")for(const d of Object.keys(a.allocationsByItem)){const f=a.allocationsByItem[d],A=String((f==null?void 0:f.productId)||d||"");if(!A)continue;const h=Array.isArray(f==null?void 0:f.allocations)?f.allocations:[];u[A]=h.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))}))}if(Array.isArray(a.allocationsByItem))for(const d of a.allocationsByItem){const f=String((d==null?void 0:d.productId)||"");if(!f)continue;const A=Array.isArray(d==null?void 0:d.allocations)?d.allocations:[];u[f]=A.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))}))}for(const d of a.items){const f=String((d==null?void 0:d.productId)||"");if(!f)continue;const A=Math.max(0,Math.floor(Number((d==null?void 0:d.qty)||(d==null?void 0:d.quantity)||0))),h=Array.isArray(d==null?void 0:d.allocations)?d.allocations.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))})):u[f]||[];o.push({productId:f,productName:String((d==null?void 0:d.productName)||""),qty:A,allocations:h.length?h:void 0})}}else{const u=a.item||{},d=String(u.productId||a.productId||""),f=Math.max(0,Math.floor(Number(u.qty??a.quantity??0))),A=Array.isArray(a.allocations)?a.allocations.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))})):[];d&&f>0&&o.push({productId:d,productName:String(u.productName||a.productName||""),qty:f,allocations:A.length?A:void 0})}if(o.length===0)return await qs(je,async u=>{u.delete(r)}),{restored:0};if(o.every(u=>Array.isArray(u.allocations)&&u.allocations.length>0)){let u=0;return await qs(je,async d=>{const f=[];for(const h of o)for(const m of h.allocations||[]){const p=Math.max(0,Math.floor(Number(m.qty||0)));u+=p,f.push({ref:Xt(je,"inventory_candies",m.batchId),addBack:p})}const A=await Promise.all(f.map(h=>d.get(h.ref)));for(let h=0;h<f.length;h++){const m=A[h];if(!m.exists())continue;const p=m.data(),x=rT(p),v=Math.max(0,Math.floor(Number(f[h].addBack||0))),y=x+v,b=Math.max(1,Math.floor(Number(p.unitsPerPackage||1))),w=Math.floor(y/b);d.update(f[h].ref,{remaining:y,remainingPackages:w,packages:w})}d.delete(r)}),{restored:u}}let c=0;return await qs(je,async u=>{const d={};for(const p of o){if(!p.productId||p.qty<=0)continue;const x=sr(bt(je,"inventory_candies"),Ar("productId","==",p.productId)),y=(await Ht(x)).docs.map(b=>{const w=b.data(),j=Use(w),I=rT(w);return{id:b.id,date:String(w.date||""),baseUnits:j,remaining:I}}).sort((b,w)=>b.date.localeCompare(w.date));d[p.productId]=y}const f=[];for(const p of o){if(!p.productId||p.qty<=0)continue;if(Array.isArray(p.allocations)&&p.allocations.length>0){for(const y of p.allocations){const b=Math.max(0,Math.floor(Number(y.qty||0)));c+=b,f.push({id:y.batchId,addBack:b})}continue}const x=d[p.productId]||[];let v=p.qty;for(const y of x){if(v<=0)break;const b=Math.max(0,y.baseUnits-y.remaining);if(b<=0)continue;const w=Math.min(b,v);f.push({id:y.id,addBack:w}),c+=w,v-=w}for(const y of x){if(v<=0)break;const b=Math.min(v,p.qty);f.push({id:y.id,addBack:b}),c+=b,v-=b}}const A={};for(const p of f)A[p.id]=(A[p.id]||0)+Math.max(0,Math.floor(Number(p.addBack||0)));const h=Object.keys(A).map(p=>Xt(je,"inventory_candies",p)),m=await Promise.all(h.map(p=>u.get(p)));for(let p=0;p<h.length;p++){const x=m[p];if(!x.exists())continue;const v=x.data(),y=rT(v),b=Math.max(0,Math.floor(Number(A[h[p].id]||0))),w=y+b,j=Math.max(1,Math.floor(Number(v.unitsPerPackage||1))),I=Math.floor(w/j);u.update(h[p],{remaining:w,remainingPackages:I,packages:I})}u.delete(r)}),{restored:c}}async function BQe(t){return q2(t)}const xc=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function aT(t){return isFinite(t)?Math.round(t):0}function ef(t){return t.unitsPerPackage>0&&t.totalUnits>0?Math.floor(t.totalUnits/t.unitsPerPackage):Math.max(0,Math.floor(Number(t.packages||0)))}function sT(t){return typeof t.remainingPackages=="number"&&isFinite(t.remainingPackages)?Math.max(0,Math.floor(t.remainingPackages)):t.unitsPerPackage>0?Math.max(0,Math.floor(Number(t.remaining||0)/t.unitsPerPackage)):0}function kQe(t,e){var o,l;const r=String(t.date||""),n=String(e.date||"");if(r!==n)return n.localeCompare(r);const a=((o=t.createdAt)==null?void 0:o.seconds)??0;return(((l=e.createdAt)==null?void 0:l.seconds)??0)-a}function FQe(){const[t,e]=g.useState([]),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(Ur(Qd(new Date),"yyyy-MM-dd")),[d,f]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(null),[y,b]=g.useState(""),[w,j]=g.useState(0),[I,C]=g.useState(!1),[S,E]=g.useState(""),[B,k]=g.useState(""),[T,P]=g.useState([]);g.useEffect(()=>{(async()=>{try{s(!0);const W=await Ht(bt(je,"products_candies")),X=[];W.forEach(be=>{const U=be.data();X.push({id:be.id,name:U.name??"(sin nombre)",category:U.category??"(sin categora)"})}),e(X);const D=sr(bt(je,"inventory_candies"),In("date","desc")),Q=await Ht(D),Z=[];Q.forEach(be=>{const U=be.data(),ze=Number(U.unitsPerPackage||0),re=Number(U.totalUnits??U.quantity??(U.packages||0)*(U.unitsPerPackage||0)),J=Number(U.remaining??U.totalUnits??re??0);Z.push({id:be.id,productId:U.productId,productName:U.productName,category:U.category,measurement:U.measurement??"unidad",packages:Number(U.packages||0),unitsPerPackage:ze,totalUnits:re,remaining:J,remainingPackages:typeof U.remainingPackages=="number"?Number(U.remainingPackages):void 0,providerPrice:Number(U.providerPrice||0),subtotal:Number(U.subtotal||0),totalRivas:Number(U.totalRivas||0),totalSanJorge:Number(U.totalSanJorge||0),totalIsla:Number(U.totalIsla||0),gainRivas:Number(U.gainRivas||0),gainSanJorge:Number(U.gainSanJorge||0),gainIsla:Number(U.gainIsla||0),unitPriceRivas:Number(U.unitPriceRivas||0),unitPriceSanJorge:Number(U.unitPriceSanJorge||0),unitPriceIsla:Number(U.unitPriceIsla||0),date:U.date,createdAt:U.createdAt,status:U.status??"PENDIENTE",orderId:U.orderId??null})}),n(Z)}catch(W){console.error(W),l(" Error cargando inventario.")}finally{s(!1)}})()},[]);const K=g.useMemo(()=>r.filter(W=>!(c&&W.date<c||d&&W.date>d||A&&W.productId!==A||m&&String(W.category||"")!==m)),[r,c,d,A,m]),le=g.useMemo(()=>{const W=new Set;for(const X of t)X.category&&W.add(X.category);return Array.from(W).sort((X,D)=>X.localeCompare(D))},[t]),oe=g.useMemo(()=>{const W=K.reduce((U,ze)=>U+ef(ze),0),X=K.reduce((U,ze)=>U+sT(ze),0),D=K.reduce((U,ze)=>{const re=ef(ze);return U+Number(ze.providerPrice||0)*re},0),Q=K.reduce((U,ze)=>{const re=ef(ze);return U+Number(ze.unitPriceRivas||0)*re},0),Z=K.reduce((U,ze)=>{const re=ef(ze);return U+Number(ze.unitPriceSanJorge||0)*re},0),be=K.reduce((U,ze)=>{const re=ef(ze);return U+Number(ze.unitPriceIsla||0)*re},0);return{totalPaquetes:W,totalPaquetesRestantes:X,totalSubtotal:D,totalRivas:Q,totalSJ:Z,totalIsla:be}},[K]),ie=g.useMemo(()=>{let W=0,X=0;for(const D of K)D.status==="PENDIENTE"&&(W+=1),D.status==="PAGADO"&&(X+=1);return{totalLotes:K.length,pendientes:W,pagados:X}},[K]),Ae=g.useMemo(()=>{const W=new Map;for(const D of K){const Q=String(D.productId||"");Q&&(W.has(Q)||W.set(Q,{batches:[]}),W.get(Q).batches.push(D))}const X=[];for(const[D,Q]of W.entries()){const Z=[...Q.batches].sort(kQe),be=Z[0],U=Z.reduce((Tt,Qt)=>Tt+ef(Qt),0),ze=Z.reduce((Tt,Qt)=>Tt+sT(Qt),0),re=Number((be==null?void 0:be.providerPrice)||0),J=Number((be==null?void 0:be.unitPriceRivas)||0),Re=Number((be==null?void 0:be.unitPriceIsla)||0),ke=Z.reduce((Tt,Qt)=>{const Ft=ef(Qt);return Tt+Number(Qt.providerPrice||0)*Ft},0),Be=Z.reduce((Tt,Qt)=>{const Ft=ef(Qt);return Tt+Number(Qt.unitPriceRivas||0)*Ft},0),Ye=Z.reduce((Tt,Qt)=>{const Ft=ef(Qt);return Tt+Number(Qt.unitPriceIsla||0)*Ft},0),ot=Be-ke,Ct=Ye-ke;let jt="",Ot;for(const Tt of Z)(!jt||String(Tt.date||"")>jt)&&(jt=String(Tt.date||""),Ot=Tt.createdAt);X.push({productId:D,productName:(be==null?void 0:be.productName)||"",category:(be==null?void 0:be.category)||"",totalPackages:U,remainingPackages:ze,providerPrice:re,unitPriceRivas:J,unitPriceIsla:Re,subtotal:ke,totalRivas:Be,totalIsla:Ye,gainRivas:ot,gainIsla:Ct,lastDate:jt,lastCreatedAt:Ot,batchCount:Z.length})}return X.sort((D,Q)=>String(Q.lastDate).localeCompare(String(D.lastDate))),X},[K]),te=W=>{v(W.id),b(W.date),j(W.providerPrice),l("")},Te=()=>{v(null),b(""),j(0)},Ue=async()=>{if(!x)return;const W=r.find(Ye=>Ye.id===x);if(!W)return;if(w<0){l("El precio proveedor no puede ser negativo.");return}const X=ef(W),D=w*X,Q=X>0?D/.8:0,Z=X>0?D/.85:0,be=X>0?D/.7:0,U=Q-D,ze=Z-D,re=be-D,J=X>0?aT(Q/X):0,Re=X>0?aT(Z/X):0,ke=X>0?aT(be/X):0,Be=Xt(je,"inventory_candies",x);await kn(Be,{date:y,providerPrice:w,subtotal:D,totalRivas:Q,totalSanJorge:Z,totalIsla:be,gainRivas:U,gainSanJorge:ze,gainIsla:re,unitPriceRivas:J,unitPriceSanJorge:Re,unitPriceIsla:ke}),n(Ye=>Ye.map(ot=>ot.id===x?{...ot,date:y,providerPrice:w,subtotal:D,totalRivas:Q,totalSanJorge:Z,totalIsla:be,gainRivas:U,gainSanJorge:ze,gainIsla:re,unitPriceRivas:J,unitPriceSanJorge:Re,unitPriceIsla:ke}:ot)),W.orderId&&await nT(String(W.orderId)),l(" Lote de dulces actualizado"),Te()},O=async W=>{confirm(`Marcar PAGADO el lote del ${W.date} (${W.productName})?`)&&(await kn(Xt(je,"inventory_candies",W.id),{status:"PAGADO"}),n(D=>D.map(Q=>Q.id===W.id?{...Q,status:"PAGADO"}:Q)),l(" Lote marcado como pagado"))},H=async W=>{confirm(`Eliminar el lote del ${W.date} (${W.productName})?`)&&(await zn(Xt(je,"inventory_candies",W.id)),n(D=>D.filter(Q=>Q.id!==W.id)),W.orderId&&await nT(String(W.orderId)),l(" Lote eliminado"))},G=async(W,X)=>{try{s(!0),l("");const D=sr(bt(je,"inventory_candies"),Ar("productId","==",W),In("date","desc")),Q=await Ht(D),Z=[];Q.forEach(be=>{const U=be.data(),ze=Number(U.unitsPerPackage||0),re=Number(U.totalUnits??U.quantity??(U.packages||0)*(U.unitsPerPackage||0)),J=Number(U.remaining??U.totalUnits??re??0);Z.push({id:be.id,productId:U.productId,productName:U.productName,category:U.category,measurement:U.measurement??"unidad",packages:Number(U.packages||0),unitsPerPackage:ze,totalUnits:re,remaining:J,remainingPackages:typeof U.remainingPackages=="number"?Number(U.remainingPackages):void 0,providerPrice:Number(U.providerPrice||0),subtotal:Number(U.subtotal||0),totalRivas:Number(U.totalRivas||0),totalSanJorge:Number(U.totalSanJorge||0),totalIsla:Number(U.totalIsla||0),gainRivas:Number(U.gainRivas||0),gainSanJorge:Number(U.gainSanJorge||0),gainIsla:Number(U.gainIsla||0),unitPriceRivas:Number(U.unitPriceRivas||0),unitPriceSanJorge:Number(U.unitPriceSanJorge||0),unitPriceIsla:Number(U.unitPriceIsla||0),date:U.date,createdAt:U.createdAt,status:U.status??"PENDIENTE",orderId:U.orderId??null})}),E(W),k(X),P(Z),C(!0)}catch(D){console.error(D),l(" Error abriendo detalle del producto.")}finally{s(!1)}},L=async(W,X)=>{const D=r.filter(Z=>Z.productId===W);if(confirm(`Eliminar COMPLETAMENTE "${X}"?
Esto eliminar ${D.length} lote(s) de este producto.`))try{s(!0),l("");const Z=Array.from(new Set(D.map(be=>be.orderId?String(be.orderId):"").filter(Boolean)));for(const be of D)await zn(Xt(je,"inventory_candies",be.id));n(be=>be.filter(U=>U.productId!==W)),l(" Producto eliminado (todos sus lotes).");for(const be of Z)await nT(be);I&&S===W&&(C(!1),P([]),E(""),k(""))}catch(Z){console.error(Z),l(" Error eliminando lotes del producto.")}finally{s(!1)}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Productos"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:W=>u(W.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:W=>f(W.target.value)})]}),i.jsxs("div",{className:"flex flex-col min-w-[220px]",children:[i.jsx("label",{className:"font-semibold",children:"Categora"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:m,onChange:W=>p(W.target.value),children:[i.jsx("option",{value:"",children:"Todas"}),le.map(W=>i.jsx("option",{value:W,children:W},W))]})]}),i.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[i.jsx("label",{className:"font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:W=>h(W.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),t.map(W=>i.jsxs("option",{value:W.id,children:[W.name,"  ",W.category]},W.id))]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f(""),h(""),p("")},children:"Quitar filtro"})]}),i.jsx("div",{className:"bg-gray-50 p-2 rounded shadow border mb-2 text-xs md:text-sm",children:i.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes totales:"})," ",ie.totalLotes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pendientes:"})," ",ie.pendientes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Lotes pagados:"})," ",ie.pagados]})]})}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-1 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes ingresados:"})," ",oe.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",oe.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total:"})," ",xc(oe.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas:"})," ",xc(oe.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge:"})," ",xc(oe.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla:"})," ",xc(oe.totalIsla)]})]})}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Subtotal"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Rivas"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Isla"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"ltima fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap text-center",children:"Opciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Cargando"})}):Ae.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Sin productos"})}):Ae.map(W=>i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border",children:W.category||""}),i.jsxs("td",{className:"p-2 border max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:W.productName,children:W.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lotes: ",W.batchCount]})]}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:W.totalPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:W.remainingPackages}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:xc(W.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:xc(W.unitPriceRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:xc(W.unitPriceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:xc(W.subtotal)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:xc(W.totalRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:xc(W.totalIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:xc(W.gainRivas)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:xc(W.gainIsla)}),i.jsx("td",{className:"p-2 border",children:W.lastDate||""}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>G(W.productId,W.productName),children:"Detalle"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>L(W.productId,W.productName),children:"Borrar"})]})})]},W.productId))})]})})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o}),I&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-4 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold",children:"Detalle del producto"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[i.jsx("span",{className:"font-semibold",children:"Producto:"})," ",B||""," ",i.jsxs("span",{className:"ml-2",children:[i.jsx("span",{className:"font-semibold",children:"ID:"})," ",S]})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{C(!1),P([]),E(""),k(""),Te()},children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border text-left",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes ingresados"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border text-right",children:"Unidades"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio venta Isla"}),i.jsx("th",{className:"p-2 border",children:"Nmero orden"}),i.jsx("th",{className:"p-2 border",children:"Status"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{className:"whitespace-nowrap",children:T.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center text-gray-500",children:"Sin lotes"})}):T.map(W=>{const X=x===W.id,D=ef(W),Q=sT(W);return i.jsxs("tr",{className:"text-left",children:[i.jsx("td",{className:"p-2 border align-top",children:X?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:y,onChange:Z=>b(Z.target.value)}):W.date}),i.jsx("td",{className:"p-2 border align-top",children:W.category||""}),i.jsxs("td",{className:"p-2 border align-top max-w-[260px]",children:[i.jsx("span",{className:"block truncate",title:W.productName,children:W.productName}),i.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lote ID: ",W.id]})]}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:D}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Q}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:W.totalUnits}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:X?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(w)?"":w,onChange:Z=>j(Math.max(0,parseFloat(Z.target.value||"0")))}):xc(W.providerPrice)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:xc(W.unitPriceRivas)}),i.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:xc(W.unitPriceIsla)}),i.jsx("td",{className:"p-2 border align-top",children:W.orderId?String(W.orderId):""}),i.jsx("td",{className:"p-2 border align-top",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${W.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:W.status})}),i.jsx("td",{className:"p-2 border align-top",children:X?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Ue,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Te,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[W.status==="PENDIENTE"&&i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:()=>O(W),children:"Pagar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-black hover:bg-yellow-500 text-xs",onClick:()=>te(W),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>H(W),children:"Borrar"})]})})]},W.id)})})]})}),i.jsx("div",{className:"mt-3 flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>L(S,B),children:"Borrar producto (todos los lotes)"})})]})})]})}const iT=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Ho=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Cy(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function lG(t){const e=sr(bt(je,"ar_movements"),Ar("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>zn(Xt(je,"ar_movements",n.id))))}function OQe({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const a=e&&e.length?e:t,s=String(r||"").trim(),o=Sn(a,"vendedor_dulces"),l=Sn(a,"admin"),[c,u]=g.useState([]),[d,f]=g.useState(!1),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(""),[w,j]=g.useState(!1),[I,C]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState([]),T=async ve=>{var ft;j(!0),C(!0),E(ve),k([]);try{const St=await Cs(Xt(je,"sales_candies",ve));let wt=null;St.exists()?wt=St.data():wt=(ft=(await Ht(sr(bt(je,"sales_candies"),Ar("name","==",ve)))).docs[0])==null?void 0:ft.data();let yt=[];if(Array.isArray(wt==null?void 0:wt.items))yt=wt.items;else if(wt!=null&&wt.items&&typeof wt.items=="object")try{yt=Object.values(wt.items)}catch{yt=[]}else wt!=null&&wt.item&&(yt=[wt.item]);const Et=yt.map(qt=>({productName:String(qt.productName||""),qty:Number(qt.packages??qt.qty??qt.quantity??0),unitPrice:Number(qt.unitPricePackage??qt.unitPrice??qt.price??0),discount:Number(qt.discount||0),total:Number(qt.total??qt.lineFinal??qt.amount??0)}));k(Et)}catch(St){console.error(St)}finally{C(!1)}},[P,K]=g.useState(""),[le,oe]=g.useState("+505 "),[ie,Ae]=g.useState(""),[te,Te]=g.useState(""),[Ue,O]=g.useState("ACTIVO"),[H,G]=g.useState(0),[L,W]=g.useState(""),[X,D]=g.useState(0),[Q,Z]=g.useState([]),[be,U]=g.useState(!0),[ze,re]=g.useState(""),J=10,[Re,ke]=g.useState(1),[Be,Ye]=g.useState(null),[ot,Ct]=g.useState(""),[jt,Ot]=g.useState("+505 "),[Tt,Qt]=g.useState(""),[Ft,Qe]=g.useState(""),[De,Je]=g.useState("ACTIVO"),[dt,ce]=g.useState(0),[we,ue]=g.useState(""),[ne,Ve]=g.useState(!1),[it,vt]=g.useState(null),[me,Ee]=g.useState(!1),[ye,We]=g.useState([]),[ge,Ie]=g.useState({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),[xt,Pt]=g.useState(!1),[It,Ut]=g.useState(0),[$t,Le]=g.useState(new Date().toISOString().slice(0,10)),[Ce,pe]=g.useState(""),[He,he]=g.useState(!1),[ee,_e]=g.useState(null),[R,V]=g.useState(""),[q,se]=g.useState(0),[Ne,Me]=g.useState(""),[Ke,Pe]=g.useState(!1),[rt,lt]=g.useState(null),[ht,kt]=g.useState(!1),[de,qe]=g.useState(!1),[at,st]=g.useState(null);g.useEffect(()=>{(async()=>{try{if(U(!0),o&&!s){Z([]),re(" Este usuario no tiene vendedor asociado (sellerCandyId vaco).");return}const ve=await Ht(bt(je,"sellers_candies")),ft=[];ve.forEach(Et=>{const qt=Et.data(),Mt=String(qt.status||"ACTIVO");Mt==="ACTIVO"&&ft.push({id:Et.id,name:String(qt.name||""),status:Mt})}),u(ft);const St=o?sr(bt(je,"customers_candies"),Ar("vendorId","==",s),In("createdAt","desc")):sr(bt(je,"customers_candies"),In("createdAt","desc")),wt=await Ht(St),yt=[];wt.forEach(Et=>{const qt=Et.data();yt.push({id:Et.id,name:qt.name??"",phone:qt.phone??"+505 ",place:qt.place??"",notes:qt.notes??"",status:qt.status??"ACTIVO",creditLimit:Number(qt.creditLimit??0),createdAt:qt.createdAt??xr.now(),balance:0,sellerId:qt.sellerId||"",vendorId:qt.vendorId||"",vendorName:qt.vendorName||"",initialDebt:Number(qt.initialDebt||0),initialDebtDate:String(qt.initialDebtDate||"").trim(),lastAbonoDate:"",lastAbonoAmount:0})});for(const Et of yt)try{const qt=sr(bt(je,"ar_movements"),Ar("customerId","==",Et.id)),Mt=await Ht(qt);let Yt=0,ar=null;const vr=[];Mt.forEach(Yr=>{var jr,Tn,Nn;const Vr=Yr.data(),Sr=Number(Vr.amount||0);Yt+=Sr;const pr=Vr.date??((Tn=(jr=Vr.createdAt)==null?void 0:jr.toDate)!=null&&Tn.call(jr)?Vr.createdAt.toDate().toISOString().slice(0,10):"");if(vr.push({id:Yr.id,date:pr,type:Vr.type??(Sr<0?"ABONO":"CARGO"),amount:Sr,ref:Vr.ref||{},comment:Vr.comment||"",createdAt:Vr.createdAt}),Sr<0){const xn=(Nn=Vr.createdAt)!=null&&Nn.seconds?Number(Vr.createdAt.seconds):0;(!ar||xn>=ar.ts)&&(ar={date:pr,amount:Math.abs(Sr),ts:xn})}});const ur=Number(Et.initialDebt||0),Dt=kr(ur,String(Et.initialDebtDate||""),vr);Et.balance=Dt+Yt,ar?(Et.lastAbonoDate=ar==null?void 0:ar.date,Et.lastAbonoAmount=ar==null?void 0:ar.amount):(Et.lastAbonoDate="",Et.lastAbonoAmount=0)}catch{Et.balance=Number(Et.initialDebt||0),Et.lastAbonoDate="",Et.lastAbonoAmount=0}Z(yt)}catch(ve){console.error(ve),re(" Error cargando clientes.")}finally{U(!1)}})()},[o,s]);const Nt=()=>{K(""),oe("+505 "),Ae(""),Te(""),O("ACTIVO"),G(0),W(""),D(0)},Rt=async ve=>{var yt;if(ve.preventDefault(),re(""),!P.trim()){re("Ingresa el nombre.");return}const ft=Cy(le);if(ft.length<6){re("Telfono incompleto.");return}const St=o?s:String(L||"").trim(),wt=St&&((yt=c.find(Et=>Et.id===St))==null?void 0:yt.name)||"";try{const Et=Number(X||0),qt=await Wn(bt(je,"customers_candies"),{name:P.trim(),phone:ft,place:ie||"",notes:te||"",status:Ue,creditLimit:Number(H||0),vendorId:St,vendorName:wt,initialDebt:Et,createdAt:xr.now()});Z(Mt=>[{id:qt.id,name:P.trim(),phone:ft,place:ie||"",notes:te||"",status:Ue,creditLimit:Number(H||0),vendorId:St,vendorName:wt,initialDebt:Et,createdAt:xr.now(),balance:Et,lastAbonoDate:"",lastAbonoAmount:0},...Mt]),Nt(),Pe(!1),re(" Cliente creado")}catch(Et){console.error(Et),re(" Error al crear cliente")}},nr=ve=>{if(o){re(" No permitido: vendedores no editan clientes desde el listado.");return}Ye(ve.id),Ct(ve.name),Ot(ve.phone||"+505 "),Qt(ve.place||""),Qe(ve.notes||""),Je(ve.status||"ACTIVO"),ce(Number(ve.creditLimit||0)),ue(String(ve.vendorId||""))},_r=()=>{Ye(null),Ct(""),Ot("+505 "),Qt(""),Qe(""),Je("ACTIVO"),ce(0),ue("")},$r=async()=>{var qt;if(o){re(" No permitido.");return}if(!Be)return;const ve=Cy(jt);if(!ot.trim()){re("Ingresa el nombre.");return}const ft=Q.find(Mt=>Mt.id===Be),St=String((ft==null?void 0:ft.vendorId)||""),wt=o?s:String(we||"");if(o&&St&&St!==s){re(" Este cliente pertenece a otro vendedor.");return}if(l&&St&&wt&&St!==wt){re(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const yt=o?s:String(we||""),Et=yt&&((qt=c.find(Mt=>Mt.id===yt))==null?void 0:qt.name)||"";try{await kn(Xt(je,"customers_candies",Be),{name:ot.trim(),phone:ve,place:Tt||"",notes:Ft||"",status:De,creditLimit:Number(dt||0),vendorId:yt,vendorName:Et}),Z(Mt=>Mt.map(Yt=>Yt.id===Be?{...Yt,name:ot.trim(),phone:ve,place:Tt||"",notes:Ft||"",status:De,creditLimit:Number(dt||0),vendorId:yt,vendorName:Et}:Yt)),_r(),re(" Cliente actualizado")}catch(Mt){console.error(Mt),re(" Error al actualizar")}},or=async ve=>{if(confirm(`Eliminar al cliente "${ve.name}"?
Se devolvern al inventario todos los dulces de sus compras y se borrarn sus movimientos.`))try{U(!0);const St=sr(bt(je,"sales_candies"),Ar("customerId","==",ve.id)),wt=await Ht(St);for(const qt of wt.docs){const Mt=qt.id;try{await q2(Mt)}catch(Yt){console.warn("restoreSaleAndDeleteCandy error",Yt);try{await zn(Xt(je,"sales_candies",Mt))}catch{}}await lG(Mt)}const yt=sr(bt(je,"ar_movements"),Ar("customerId","==",ve.id)),Et=await Ht(yt);await Promise.all(Et.docs.map(qt=>zn(Xt(je,"ar_movements",qt.id)))),await zn(Xt(je,"customers_candies",ve.id)),Z(qt=>qt.filter(Mt=>Mt.id!==ve.id)),re(" Cliente eliminado y dulces devueltos al inventario")}catch(St){console.error(St),re(" No se pudo eliminar el cliente.")}finally{U(!1)}},kr=(ve,ft,St)=>{const wt=Number(ve||0);if(!wt)return 0;const yt=String(ft||"").trim();return yt&&St.some(qt=>{var ur;const Mt=Number(qt.amount||0);if(!(Mt>0))return!1;const Yt=Math.abs(Mt-wt)<.01,ar=String(qt.date||"").trim()===yt,vr=!!((ur=qt.ref)!=null&&ur.saleId);return Yt&&ar&&vr})?0:wt},en=(ve,ft,St)=>{const wt=ve.reduce((Yt,ar)=>Yt+(Number(ar.amount)||0),0),yt=ve.filter(Yt=>Number(Yt.amount)<0).reduce((Yt,ar)=>Yt+Math.abs(Number(ar.amount)||0),0),Et=ve.filter(Yt=>Number(Yt.amount)>0).reduce((Yt,ar)=>Yt+(Number(ar.amount)||0),0),qt=kr(ft,St,ve),Mt=Number(qt||0)+wt;Ie({saldoActual:Mt,totalAbonado:yt,totalCargos:Number(qt||0)+Et,saldoRestante:Mt})},rn=async ve=>{vt(ve),We([]),Ie({saldoActual:0,totalAbonado:0,totalCargos:0,saldoRestante:0}),Ve(!0),kt(!1),qe(!1),st(null),Pt(!1),Ut(0),Le(new Date().toISOString().slice(0,10)),pe(""),_e(null),Ee(!0);try{const ft=sr(bt(je,"ar_movements"),Ar("customerId","==",ve.id)),St=await Ht(ft),wt=[];St.forEach(yt=>{var Yt,ar;const Et=yt.data(),qt=Et.date??((ar=(Yt=Et.createdAt)==null?void 0:Yt.toDate)!=null&&ar.call(Yt)?Et.createdAt.toDate().toISOString().slice(0,10):""),Mt=Number(Et.amount||0);wt.push({id:yt.id,date:qt,type:Et.type??(Mt<0?"ABONO":"CARGO"),amount:Mt,ref:Et.ref||{},comment:Et.comment||"",createdAt:Et.createdAt})}),wt.sort((yt,Et)=>{var Yt,ar;if(yt.date!==Et.date)return yt.date.localeCompare(Et.date);const qt=((Yt=yt.createdAt)==null?void 0:Yt.seconds)||0,Mt=((ar=Et.createdAt)==null?void 0:ar.seconds)||0;return qt-Mt}),We(wt),en(wt,Number(ve.initialDebt||0),String(ve.initialDebtDate||""))}catch(ft){console.error(ft),re(" No se pudo cargar el estado de cuenta")}finally{Ee(!1)}},Er=ve=>{const ft=ve.filter(St=>Number(St.amount)<0).map(St=>{var wt;return{date:St.date,amount:Math.abs(Number(St.amount||0)),ts:((wt=St.createdAt)==null?void 0:wt.seconds)||0}}).sort((St,wt)=>(St.ts||0)-(wt.ts||0));return ft.length?ft[ft.length-1]:null},Se=g.useMemo(()=>kr(Number((it==null?void 0:it.initialDebt)||0),String((it==null?void 0:it.initialDebtDate)||""),ye),[it==null?void 0:it.initialDebt,it==null?void 0:it.initialDebtDate,ye]),gt=async()=>{if(!it)return;re("");const ve=Number(It||0);if(!(ve>0)){re("Ingresa un monto de abono mayor a 0.");return}const ft=parseFloat(ve.toFixed(2));if(!$t){re("Selecciona la fecha del abono.");return}try{he(!0);const St={customerId:it.id,type:"ABONO",amount:-ft,date:$t,comment:Ce||"",createdAt:xr.now()},yt={id:(await Wn(bt(je,"ar_movements"),St)).id,date:$t,type:"ABONO",amount:-ft,comment:Ce||"",createdAt:xr.now()},Et=[...ye,yt].sort((ar,vr)=>{var Yr,Vr;if(ar.date!==vr.date)return ar.date.localeCompare(vr.date);const ur=((Yr=ar.createdAt)==null?void 0:Yr.seconds)||0,Dt=((Vr=vr.createdAt)==null?void 0:Vr.seconds)||0;return ur-Dt});We(Et),en(Et,Number(it.initialDebt||0),String(it.initialDebtDate||""));const qt=Et.reduce((ar,vr)=>ar+(Number(vr.amount)||0),0),Mt=kr(Number(it.initialDebt||0),String(it.initialDebtDate||""),Et),Yt=Number(Mt||0)+qt;Z(ar=>ar.map(vr=>vr.id!==it.id?vr:{...vr,balance:Yt,lastAbonoDate:$t,lastAbonoAmount:ft})),vt(ar=>ar&&{...ar,balance:Yt,lastAbonoDate:$t,lastAbonoAmount:ft}),Ut(0),pe(""),Le(new Date().toISOString().slice(0,10)),Pt(!1),re(" Abono registrado")}catch(St){console.error(St),re(" Error al registrar el abono")}finally{he(!1)}},er=ve=>{_e(ve.id),V(ve.date||new Date().toISOString().slice(0,10)),se(Math.abs(Number(ve.amount||0))),Me(ve.comment||"")},Mr=()=>{_e(null),V(""),se(0),Me("")},Or=async()=>{if(!ee||!it)return;const ve=ye.findIndex(yt=>yt.id===ee);if(ve===-1)return;const ft=ye[ve],St=Number(q||0);if(!(St>0)){re("El monto debe ser mayor a 0.");return}const wt=ft.type==="ABONO"?-parseFloat(St.toFixed(2)):+parseFloat(St.toFixed(2));try{await kn(Xt(je,"ar_movements",ee),{date:R,amount:wt,comment:Ne||""});const yt=[...ye];yt[ve]={...ft,date:R,amount:wt,comment:Ne||""},yt.sort((ar,vr)=>{var Yr,Vr;if(ar.date!==vr.date)return ar.date.localeCompare(vr.date);const ur=((Yr=ar.createdAt)==null?void 0:Yr.seconds)||0,Dt=((Vr=vr.createdAt)==null?void 0:Vr.seconds)||0;return ur-Dt}),We(yt),en(yt,Number(it.initialDebt||0),String(it.initialDebtDate||""));const Et=yt.reduce((ar,vr)=>ar+(Number(vr.amount)||0),0),qt=kr(Number(it.initialDebt||0),String(it.initialDebtDate||""),yt),Mt=Number(qt||0)+Et,Yt=Er(yt);Z(ar=>ar.map(vr=>vr.id===it.id?{...vr,balance:Mt,lastAbonoDate:(Yt==null?void 0:Yt.date)||"",lastAbonoAmount:(Yt==null?void 0:Yt.amount)||0}:vr)),vt(ar=>ar&&{...ar,balance:Mt,lastAbonoDate:(Yt==null?void 0:Yt.date)||"",lastAbonoAmount:(Yt==null?void 0:Yt.amount)||0}),Mr(),re(" Movimiento actualizado")}catch(yt){console.error(yt),re(" Error al actualizar movimiento")}},ir=async ve=>{var St,wt;if(confirm(`Eliminar este movimiento (${ve.type==="ABONO"?"Abono":"Compra"}) del ${ve.date}?${ve.type==="CARGO"&&((St=ve.ref)!=null&&St.saleId)?`
Se devolvern al inventario los dulces de esa venta.`:""}`)&&it)try{if(U(!0),ve.type==="CARGO"&&((wt=ve.ref)!=null&&wt.saleId)){try{await q2(ve.ref.saleId)}catch(ar){console.warn("restoreSaleAndDeleteCandy error",ar),U(!1),re(" No se pudo devolver inventario de la venta.");return}await lG(ve.ref.saleId)}else await zn(Xt(je,"ar_movements",ve.id));const yt=ye.filter(ar=>{var vr,ur;return ve.type==="CARGO"&&((vr=ve.ref)!=null&&vr.saleId)?((ur=ar.ref)==null?void 0:ur.saleId)!==ve.ref.saleId:ar.id!==ve.id});We(yt),en(yt,Number(it.initialDebt||0),String(it.initialDebtDate||""));const Et=yt.reduce((ar,vr)=>ar+(Number(vr.amount)||0),0),qt=kr(Number(it.initialDebt||0),String(it.initialDebtDate||""),yt),Mt=Number(qt||0)+Et,Yt=Er(yt);Z(ar=>ar.map(vr=>vr.id===it.id?{...vr,balance:Mt,lastAbonoDate:(Yt==null?void 0:Yt.date)||"",lastAbonoAmount:(Yt==null?void 0:Yt.amount)||0}:vr)),vt(ar=>ar&&{...ar,balance:Mt,lastAbonoDate:(Yt==null?void 0:Yt.date)||"",lastAbonoAmount:(Yt==null?void 0:Yt.amount)||0}),st(null),re(" Movimiento eliminado")}catch(yt){console.error(yt),re(" Error al eliminar movimiento")}finally{U(!1)}},br=g.useMemo(()=>[...Q].sort((ve,ft)=>{var St,wt;return ve.status!==ft.status?ve.status==="BLOQUEADO"?1:-1:(((St=ft.createdAt)==null?void 0:St.seconds)||0)-(((wt=ve.createdAt)==null?void 0:wt.seconds)||0)}),[Q]),wr=ve=>ve==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700",Xr=g.useMemo(()=>{const ve=A.trim().toLowerCase(),ft=x.trim()===""?null:Number(x),St=y.trim()===""?null:Number(y);return br.filter(wt=>{const yt=!ve||String(wt.name||"").toLowerCase().includes(ve),Et=!m||wt.status===m,qt=Number(wt.balance||0),Mt=ft===null||!Number.isNaN(ft)&&qt>=ft,Yt=St===null||!Number.isNaN(St)&&qt<=St;return yt&&Et&&Mt&&Yt})},[br,A,m,x,y]),Ir=Math.max(1,Math.ceil(Xr.length/J)),Pr=g.useMemo(()=>{const ve=(Re-1)*J;return Xr.slice(ve,ve+J)},[Xr,Re]);g.useEffect(()=>{ke(1)},[A,m,x,y]);const fn=()=>ke(1),fe=()=>ke(ve=>Math.max(1,ve-1)),et=()=>ke(ve=>Math.min(Ir,ve+1)),nt=()=>ke(Ir),ct=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:fn,disabled:Re===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:fe,disabled:Re===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",Re," de ",Ir]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:et,disabled:Re===Ir,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:nt,disabled:Re===Ir,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[Xr.length," cliente(s)"]})]});return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Dulces)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{Pe(!0),o&&W(s)},type:"button",children:"Crear Cliente"})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 border w-full md:w-auto",onClick:()=>f(ve=>!ve),children:d?"Ocultar filtros":"Mostrar filtros"}),d&&i.jsxs("div",{className:"mt-2 bg-white border rounded-xl p-3 grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Cliente"}),i.jsx("input",{className:"w-full border p-2 rounded",value:A,onChange:ve=>h(ve.target.value),placeholder:"Buscar por nombre"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:ve=>p(ve.target.value||""),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Monto mn."}),i.jsx("input",{className:"w-full border p-2 rounded text-right",inputMode:"decimal",value:x,onChange:ve=>v(ve.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Monto mx."}),i.jsx("input",{className:"w-full border p-2 rounded text-right",inputMode:"decimal",value:y,onChange:ve=>b(ve.target.value),placeholder:""})]})]}),i.jsx("div",{className:"md:col-span-4 flex flex-wrap gap-2 justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 border",onClick:()=>{h(""),p(""),v(""),b("")},children:"Limpiar"})})]})]}),i.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[i.jsxs("div",{className:"hidden md:block",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Telfono"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Lugar"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Lmite"}),i.jsx("th",{className:"p-2 border",children:"Saldo"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:be?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):Pr.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):Pr.map(ve=>{var St;const ft=Be===ve.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:(St=ve.createdAt)!=null&&St.toDate?ve.createdAt.toDate().toISOString().slice(0,10):""}),i.jsx("td",{className:"p-2 border text-left",children:ft?i.jsx("input",{className:"w-full border p-1 rounded",value:ot,onChange:wt=>Ct(wt.target.value)}):i.jsx("div",{className:"font-medium",children:ve.name})}),i.jsx("td",{className:"p-2 border",children:ft?i.jsx("input",{className:"w-full border p-1 rounded",value:jt,onChange:wt=>Ot(Cy(wt.target.value))}):ve.phone}),i.jsx("td",{className:"p-2 border",children:ft?i.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:o?s:we,onChange:wt=>ue(wt.target.value),disabled:o,title:"Vendedor asociado",children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(wt=>i.jsx("option",{value:wt.id,children:wt.name},wt.id))]}):ve.vendorName||""}),i.jsx("td",{className:"p-2 border",children:ft?i.jsxs("select",{className:"w-full border p-1 rounded",value:Tt,onChange:wt=>Qt(wt.target.value),children:[i.jsx("option",{value:"",children:""}),iT.map(wt=>i.jsx("option",{value:wt,children:wt},wt))]}):ve.place||""}),i.jsx("td",{className:"p-2 border",children:ft?i.jsxs("select",{className:"w-full border p-1 rounded",value:De,onChange:wt=>Je(wt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${wr(ve.status)}`,children:ve.status})}),i.jsx("td",{className:"p-2 border",children:ft?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(dt)?"":dt,onChange:wt=>ce(Math.max(0,Number(wt.target.value||0)))}):Ho(ve.creditLimit||0)}),i.jsx("td",{className:"p-2 border font-semibold",children:Ho(ve.balance||0)}),i.jsx("td",{className:"p-2 border",children:ft?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Ft,onChange:wt=>Qe(wt.target.value),maxLength:500}):i.jsx("span",{title:ve.notes||"",children:(ve.notes||"").length>40?(ve.notes||"").slice(0,40)+"":ve.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:ft?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:$r,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:_r,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>nr(ve),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>or(ve),disabled:!l,title:l?"Borrar":"Solo admin",children:"Borrar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>rn(ve),children:"Estado de cuenta"})]})})})]},ve.id)})})]}),ct()]}),i.jsxs("div",{className:"md:hidden",children:[be?i.jsx("div",{className:"p-4 text-center text-sm",children:"Cargando"}):Pr.length===0?i.jsx("div",{className:"p-4 text-center text-sm",children:"Sin clientes"}):i.jsx("div",{className:"space-y-2",children:Pr.map(ve=>{const ft=rt===ve.id,St=Be===ve.id,wt=i.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] ${wr(ve.status)}`,children:ve.status});return i.jsxs("div",{className:"border rounded-2xl shadow-sm bg-white overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between gap-2 text-left",onClick:()=>{re(""),!St&&lt(yt=>yt===ve.id?null:ve.id)},children:[i.jsx("div",{className:"min-w-0 flex-1",children:i.jsx("div",{className:"truncate font-semibold",children:ve.name})}),i.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Pendiente"}),i.jsx("div",{className:"font-semibold leading-4",children:Ho(ve.balance||0)})]}),wt]})]}),ft&&i.jsxs("div",{className:"px-3 pb-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"ltimo abono"}),i.jsx("div",{className:"font-medium",children:ve.lastAbonoDate?ve.lastAbonoDate:""}),i.jsx("div",{className:"text-[12px] text-gray-700",children:ve.lastAbonoAmount?Ho(ve.lastAbonoAmount):""})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo pendiente"}),i.jsx("div",{className:"text-lg font-bold",children:Ho(ve.balance||0)})]})]}),St?i.jsxs("div",{className:"mt-3 space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded-xl",value:ot,onChange:yt=>Ct(yt.target.value)})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded-xl",value:jt,onChange:yt=>Ot(Cy(yt.target.value))})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:De,onChange:yt=>Je(yt.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:Tt,onChange:yt=>Qt(yt.target.value),children:[i.jsx("option",{value:"",children:""}),iT.map(yt=>i.jsx("option",{value:yt,children:yt},yt))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded-xl",value:o?s:we,onChange:yt=>ue(yt.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(yt=>i.jsx("option",{value:yt.id,children:yt.name},yt.id))]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Lmite"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded-xl text-right",value:Number.isNaN(dt)?"":dt,onChange:yt=>ce(Math.max(0,Number(yt.target.value||0)))})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded-xl min-h-24 resize-y",value:Ft,onChange:yt=>Qe(yt.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700",onClick:$r,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-gray-200 hover:bg-gray-300",onClick:()=>{_r(),lt(null)},type:"button",children:"Cancelar"})]})]}):i.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>nr(ve),type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>or(ve),disabled:!l,title:l?"Borrar":"Solo admin",type:"button",children:"Borrar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>rn(ve),type:"button",children:"Estado"})]})]})]},ve.id)})}),ct()]})]}),ze&&i.jsx("p",{className:"mt-2 text-sm",children:ze}),Ke&&Lu.createPortal(i.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Pe(!1)}),i.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Pe(!1),type:"button",children:"Cerrar"})]}),i.jsxs("form",{onSubmit:Rt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:P,onChange:ve=>K(ve.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:le,onChange:ve=>oe(Cy(ve.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:ie,onChange:ve=>Ae(ve.target.value),children:[i.jsx("option",{value:"",children:""}),iT.map(ve=>i.jsx("option",{value:ve,children:ve},ve))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Ue,onChange:ve=>O(ve.target.value),children:[i.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),i.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o?s:L,onChange:ve=>W(ve.target.value),disabled:o,children:[i.jsx("option",{value:"",children:" Sin vendedor "}),c.map(ve=>i.jsx("option",{value:ve.id,children:ve.name},ve.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:X===0?"":X,onChange:ve=>D(Math.max(0,Number(ve.target.value||0))),placeholder:"Ej: 1500"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor cuenta como saldo desde el inicio."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:H===0?"":H,onChange:ve=>G(Math.max(0,Number(ve.target.value||0))),placeholder:"Ej: 2000"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:te,onChange:ve=>Te(ve.target.value),maxLength:500,placeholder:"Notas del cliente"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[te.length,"/500"]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[i.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Pe(!1),children:"Cancelar"}),i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),ne&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4 max-h-[92vh] overflow-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(it==null?void 0:it.name)||""]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{Ut(0),Le(new Date().toISOString().slice(0,10)),pe(""),Pt(!0)},children:"Abonar"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Ve(!1),children:"Cerrar"})]})]}),i.jsxs("div",{className:"hidden md:block",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),i.jsx("div",{className:"text-xl font-semibold",children:Ho(Number(Se||0))})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:Ho(ge.saldoActual)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),i.jsx("div",{className:"text-xl font-semibold",children:Ho(ge.totalAbonado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),i.jsx("div",{className:"text-xl font-semibold",children:Ho(ge.saldoRestante)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Referencia"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:me?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):ye.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):ye.map(ve=>{var St,wt;const ft=ee===ve.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ft?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:R,onChange:yt=>V(yt.target.value)}):ve.date||""}),i.jsx("td",{className:"p-2 border",children:ve.amount>=0?(St=ve.ref)!=null&&St.saleId?i.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver dulces de esta compra",onClick:()=>T(ve.ref.saleId),children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):i.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),i.jsx("td",{className:"p-2 border",children:(wt=ve.ref)!=null&&wt.saleId?`Venta #${ve.ref.saleId}`:""}),i.jsx("td",{className:"p-2 border",children:ft?i.jsx("input",{className:"w-full border p-1 rounded",value:Ne,onChange:yt=>Me(yt.target.value),placeholder:"Comentario"}):i.jsx("span",{title:ve.comment||"",children:(ve.comment||"").length>40?(ve.comment||"").slice(0,40)+"":ve.comment||""})}),i.jsx("td",{className:"p-2 border font-semibold",children:ft?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(q)?"":q,onChange:yt=>{const Et=Number(yt.target.value||0),qt=Number.isFinite(Et)?Math.max(0,parseFloat(Et.toFixed(2))):0;se(qt)},placeholder:"0.00"}):Ho(ve.amount)}),i.jsx("td",{className:"p-2 border",children:ft?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Or,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Mr,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>er(ve),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>ir(ve),children:"Borrar"})]})})]},ve.id)})})]})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>kt(ve=>!ve),children:[i.jsx("div",{className:"font-semibold",children:"Estado de cuenta"}),i.jsx("div",{className:"text-sm text-gray-500",children:ht?"Ocultar":"Ver"})]}),ht&&i.jsxs("div",{className:"px-3 pb-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Deuda inicial"}),i.jsx("div",{className:"font-bold",children:Ho(Number(Se||0))})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo actual"}),i.jsx("div",{className:"font-bold",children:Ho(ge.saldoActual)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Total abonado"}),i.jsx("div",{className:"font-bold",children:Ho(ge.totalAbonado)})]}),i.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Saldo restante"}),i.jsx("div",{className:"font-bold",children:Ho(ge.saldoRestante)})]})]})]}),i.jsxs("div",{className:"border rounded-2xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>qe(ve=>!ve),children:[i.jsx("div",{className:"font-semibold",children:"Movimientos"}),i.jsx("div",{className:"text-sm text-gray-500",children:de?"Ocultar":"Ver"})]}),de&&i.jsx("div",{className:"px-3 pb-3 space-y-2",children:me?i.jsx("div",{className:"text-center text-sm p-3",children:"Cargando"}):ye.length===0?i.jsx("div",{className:"text-center text-sm p-3",children:"Sin movimientos"}):ye.map(ve=>{var Et,qt;const ft=at===ve.id,St=ee===ve.id,wt=ve.amount>=0?"CARGO":"ABONO",yt=ve.amount>=0?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700";return i.jsxs("div",{className:"border rounded-2xl overflow-hidden bg-white",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between gap-2 text-left",onClick:()=>{St||st(Mt=>Mt===ve.id?null:ve.id)},children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Fecha"}),i.jsx("div",{className:"font-semibold",children:ve.date||""})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] ${yt}`,children:wt}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[11px] text-gray-500 leading-3",children:"Monto"}),i.jsx("div",{className:"font-semibold",children:Ho(ve.amount)})]})]})]}),ft&&i.jsxs("div",{className:"px-3 pb-3 space-y-2",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Referencia"}),i.jsx("div",{className:"font-medium",children:(Et=ve.ref)!=null&&Et.saleId?`Venta #${ve.ref.saleId}`:""}),((qt=ve.ref)==null?void 0:qt.saleId)&&i.jsx("button",{type:"button",className:"mt-2 text-xs underline text-blue-600",onClick:()=>T(ve.ref.saleId),children:"Ver productos de la venta"})]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Comentario"}),St?i.jsx("input",{className:"w-full border p-2 rounded-xl",value:Ne,onChange:Mt=>Me(Mt.target.value),placeholder:"Comentario"}):i.jsx("div",{className:"font-medium",children:(ve.comment||"").trim()||""})]}),St&&i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded-xl",value:R,onChange:Mt=>V(Mt.target.value)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] text-gray-500",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded-xl text-right",value:Number.isNaN(q)?"":q,onChange:Mt=>{const Yt=Number(Mt.target.value||0),ar=Number.isFinite(Yt)?Math.max(0,parseFloat(Yt.toFixed(2))):0;se(ar)}})]})]}),St?i.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-1",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700",onClick:Or,type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl bg-gray-200 hover:bg-gray-300",onClick:Mr,type:"button",children:"Cancelar"})]}):i.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-1",children:[i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>er(ve),type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700",onClick:()=>ir(ve),type:"button",children:"Borrar"})]})]})]},ve.id)})})]})]}),xt&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(it==null?void 0:it.name)||""]}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:$t,onChange:ve=>Le(ve.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:It===0?"":It,onChange:ve=>{const ft=Number(ve.target.value||0),St=Number.isFinite(ft)?Math.max(0,parseFloat(ft.toFixed(2))):0;Ut(St)},placeholder:"0.00"}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se registrar como ABONO (negativo) con 2 decimales."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Ce,onChange:ve=>pe(ve.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[Ce.length,"/250"]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Pt(!1),disabled:He,children:"Cancelar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:gt,disabled:He,children:He?"Guardando...":"Guardar abono"})]})]})})]})}),w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Dulces vendidos"," ",S?` #${S}`:""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>j(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:I?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):B.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):B.map((ve,ft)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:ve.productName}),i.jsx("td",{className:"p-2 border text-right",children:ve.qty}),i.jsx("td",{className:"p-2 border text-right",children:Ho(ve.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:Ho(ve.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:Ho(ve.total)})]},ft))})]})})]})})]})}const Wc=t=>`C$ ${(Number(t)||0).toFixed(2)}`,DQe=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas","Pull","Tilgue","Balge","Santa Cruz","Moyogalpa","Santo Domingo","San Jos del Sur","San Fernando","Merida","La Paloma","San Lorenzo","San Carlos","San Miguel"];function RQe(t){switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function MQe(t){switch(t){case"Rivas":return"RIVAS";case"San Jorge":return"SAN_JORGE";case"Isla Ometepe":return"ISLA";default:return"RIVAS"}}function LQe(t){const{saleId:e,date:r,customerName:n,branch:a,items:s,total:o,vendorName:l,vendorCommissionPercent:c,vendorCommissionAmount:u}=t,d=new an;let f=12;if(d.setFontSize(16),d.text("Multiservicios Ortiz",10,f),f+=6,d.setFontSize(12),d.text("Recibo de venta certificada",10,f),f+=8,d.setFontSize(12),d.text(`Fecha: ${r}`,10,f),f+=5,d.text(`Cliente: ${n||"Cliente Mostrador"}`,10,f),f+=5,d.text(`Sucursal: ${RQe(a)}`,10,f),f+=5,d.text(`Autorizado: ${e}`,10,f),f+=5,l&&(d.text(`Vendedor: ${l}`,10,f),f+=5),typeof c=="number"){const A=Number(u||0).toFixed(2),h=c.toFixed(2);d.text(`Comisin vendedor: ${h}%  C$ ${A}`,10,f),f+=8}else f+=3;d.setFontSize(12),d.text("Producto",10,f),d.text("Paquetes",110,f,{align:"right"}),d.text("Precio.",150,f,{align:"right"}),d.text("Subtotal",190,f,{align:"right"}),f+=4,d.line(10,f,190,f),f+=4,s.forEach(A=>{f>270&&(d.addPage(),f=12);const h=(A.productName||"").length>50?A.productName.slice(0,47)+"...":A.productName;d.text(h,10,f),d.text(String(A.qty),110,f,{align:"right"}),d.text(`C$ ${Number(A.unitPrice||0).toFixed(2)}`,150,f,{align:"right"}),d.text(`C$ ${Number(A.total||0).toFixed(2)}`,190,f,{align:"right"}),f+=5}),f+=4,d.line(10,f,190,f),f+=6,d.setFontSize(13),d.text(`Total: C$ ${Number(o||0).toFixed(2)}`,190,f,{align:"right"}),f+=6,d.setFontSize(9),d.text("Gracias por su compra.",10,f),d.save(`venta_dulces_${e}.pdf`)}async function cG(t,e){if(!t||!e)return 0;const r=sr(bt(je,"inventory_candies_sellers"),Ar("sellerId","==",e),Ar("productId","==",t)),n=await Ht(r);let a=0;return n.forEach(s=>{const o=s.data(),l=Number(o.remainingUnits??o.remaining??o.totalUnits??0);l>0&&(a+=l)}),a}const uG=()=>{const t=new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,10)};async function UQe(t){const{productId:e,vendorId:r,quantityUnits:n,saleDate:a,saleId:s}=t;let o=Math.max(0,Math.floor(Number(n||0)));const l=[];if(!e||!r||o<=0)return{allocations:[]};const c=sr(bt(je,"inventory_candies_sellers"),Ar("sellerId","==",r),Ar("productId","==",e),Ar("remainingUnits",">",0),In("date","asc"),In("createdAt","asc")),u=await Ht(c);for(const d of u.docs){if(o<=0)break;const f=d.data(),A=Number(f.remainingUnits||0);if(A<=0)continue;const h=Math.min(A,o),m=A-h,p=Math.max(1,Math.floor(Number(f.unitsPerPackage||1))),x=Math.floor(m/p);await kn(d.ref,{remainingUnits:m,remainingPackages:x}),l.push({inventorySellerId:d.id,productId:e,units:h,saleDate:a,saleId:s}),o-=h}return o>0&&console.warn("[allocateSaleFIFOCandyFromVendor] No alcanz el inventario del vendedor, faltaron unidades.",{productId:e,vendorId:r,remaining:o}),{allocations:l}}function dG(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function QQe({role:t="",roles:e,sellerCandyId:r="",currentUserEmail:n}){const a=e&&e.length?e:t;Sn(a,"admin"),Sn(a,"vendedor_dulces");const[s,o]=g.useState([]),[l,c]=g.useState([]),[u,d]=g.useState([]),[f,A]=g.useState({}),[h,m]=g.useState("CONTADO"),[p,x]=g.useState("RIVAS"),[v,y]=g.useState(""),[b,w]=g.useState(""),[j,I]=g.useState(uG()),[C,S]=g.useState(""),[E,B]=g.useState(!1),[k,T]=g.useState(""),[P,K]=g.useState([]),[le,oe]=g.useState(!0),[ie,Ae]=g.useState(!1),te=g.useMemo(()=>P.reduce((pe,He)=>pe+(He.qtyPackages||0),0),[P]),Te=g.useMemo(()=>P.reduce((pe,He)=>pe+(He.qtyPackages||0)*(He.unitsPerPackage||1),0),[P]),Ue=g.useMemo(()=>{const pe=P.reduce((He,he)=>{const ee=(Number(he.pricePerPackage)||0)*(he.qtyPackages||0),_e=Number(he.discount)||0,R=Math.max(0,ee-_e);return He+R},0);return Math.floor(pe*100)/100},[P]),[O,H]=g.useState(0),[G,L]=g.useState(""),[W,X]=g.useState(!1),[D,Q]=g.useState(!1),[Z,be]=g.useState(""),[U,ze]=g.useState("+505 "),[re,J]=g.useState(""),[Re,ke]=g.useState(""),[Be,Ye]=g.useState("ACTIVO"),[ot,Ct]=g.useState(0),[jt,Ot]=g.useState(""),Tt=()=>{be(""),ze("+505 "),J(""),ke(""),Ye("ACTIVO"),Ct(0)},[Qt,Ft]=g.useState(!1),Qe=async pe=>{const He=String(pe||"").trim();if(!He)return;const he=Ut.find(V=>String(V.barcode||"")===He),ee=Ut.find(V=>String(V.sku||"")===He),_e=Ut.find(V=>String(V.id||"")===He),R=he||ee||_e||null;R?(await We(R.id),L(" Producto agregado desde escner."),setTimeout(()=>L(""),2500)):(L(" Cdigo no corresponde a ningn producto disponible."),setTimeout(()=>L(""),2500))};function De({open:pe,onClose:He,onDetected:he}){const ee=g.useRef(null),_e=g.useRef(null),[R,V]=g.useState(""),q=g.useRef("");return g.useEffect(()=>{if(!pe)return;let se=!1;const Ne=new K2,Me=()=>{var Pe,rt,lt;try{(Pe=_e.current)==null||Pe.stop()}catch{}_e.current=null;try{const ht=(rt=ee.current)==null?void 0:rt.srcObject;try{(lt=ht==null?void 0:ht.getTracks)==null||lt.call(ht).forEach(kt=>kt.stop())}catch{}}catch{}try{ee.current&&(ee.current.srcObject=null)}catch{}};return(async()=>{V("");try{if(!ee.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(lt=>lt.stop())}catch{}const Pe=await Ne.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},ee.current,rt=>{if(!se&&rt){const lt=String(rt.getText()||"").trim().replace(/\s+/g,"");if(!lt||lt===q.current)return;q.current=lt,Me(),he(lt),He()}});_e.current=Pe}catch(Pe){const rt=String((Pe==null?void 0:Pe.message)||""),lt=String((Pe==null?void 0:Pe.name)||"");rt.toLowerCase().includes("permission")||lt==="NotAllowedError"?V("Permiso de cmara denegado."):lt==="NotFoundError"||rt.toLowerCase().includes("notfound")?V("No se encontr cmara en este dispositivo."):rt.toLowerCase().includes("secure")||rt.toLowerCase().includes("https")?V("La cmara requiere HTTPS (sitio seguro)."):V(rt||"No se pudo iniciar el escner.")}})(),()=>{var Pe;se=!0;try{(Pe=_e.current)==null||Pe.stop()}catch{}_e.current=null}},[pe,He,he]),pe?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:He,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:ee,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),R&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:R}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}const Je=g.useMemo(()=>s.find(pe=>pe.id===v),[s,v]),dt=g.useMemo(()=>E&&C?s.filter(pe=>(pe.vendorId??pe.sellerId??"")===C):s,[s,E,C]),ce=(Je==null?void 0:Je.balance)||0,we=h==="CREDITO"?ce+Math.max(0,Number(Ue||0))-Math.max(0,Number(O||0)):0,ue=g.useMemo(()=>{if(h!=="CREDITO")return 0;const pe=Math.max(0,Number(ce||0))+Math.max(0,Number(Ue||0));return Math.floor(pe*100)/100},[h,ce,Ue]),ne=pe=>{const He=Math.max(0,Number(pe||0));return Math.min(He,ue)},Ve=g.useMemo(()=>u.find(pe=>pe.id===C)||null,[u,C]),it=(Ve==null?void 0:Ve.commissionPercent)||0,vt=g.useMemo(()=>{const pe=P.reduce((He,he)=>He+Number(he.margenVendedor||0),0);return Number(pe.toFixed(2))},[P]);g.useEffect(()=>{(async()=>{const pe=sr(bt(je,"customers_candies"),In("createdAt","desc")),He=await Ht(pe),he=[];He.forEach(V=>{const q=V.data();he.push({id:V.id,name:q.name??"",phone:q.phone??"+505 ",place:q.place??"",status:q.status??"ACTIVO",creditLimit:Number(q.creditLimit??0),balance:0,sellerId:q.sellerId??q.vendorId??"",vendorId:q.vendorId??q.sellerId??""})});for(const V of he)try{const q=sr(bt(je,"ar_movements"),Ar("customerId","==",V.id)),se=await Ht(q);let Ne=0;se.forEach(Ke=>Ne+=Number(Ke.data().amount||0));const Me=Number(V.initialDebt||0);V.balance=Ne+Me}catch{V.balance=0}o(he);const ee=sr(bt(je,"products_candies"),In("createdAt","desc")),_e=await Ht(ee),R=[];_e.forEach(V=>{const q=V.data();R.push({id:V.id,name:q.name??"(sin nombre)",sku:q.sku??"",unitsPerPackage:Number(q.unitsPerPackage??1),barcode:String(q.barcode||""),priceRivas:Number(q.unitPriceRivas??0),priceSanJorge:Number(q.unitPriceSanJorge??0),priceIsla:Number(q.unitPriceIsla??0),providerPrice:Number(q.providerPrice??0),providerPricePerUnit:Number(q.providerPricePerUnit??0)})}),c(R);try{const V=await Ht(bt(je,"sellers_candies")),q=[];V.forEach(se=>{const Ne=se.data(),Me=Ne.branch||"Rivas",Ke=MQe(Me);q.push({id:se.id,name:Ne.name??"(sin nombre)",branch:Ke,branchLabel:Me,commissionPercent:Number(Ne.commissionPercent??0)})}),d(q)}catch(V){console.error("Error cargando vendedores:",V)}A({})})()},[]),g.useEffect(()=>{var He,he;const pe=e&&e.length?e:t;if(pe&&((He=pe.includes)!=null&&He.call(pe,"vendedor_dulces"))&&r){S(r),B(!0);try{localStorage.setItem("pos_vendorId",r),localStorage.setItem("pos_role","VENDEDOR")}catch{}return}if(pe&&((he=pe.includes)!=null&&he.call(pe,"admin"))){B(!1);return}try{const ee=localStorage.getItem("pos_vendorId")||"",_e=localStorage.getItem("pos_role")||"";ee&&S(ee),_e.toUpperCase()==="VENDEDOR"&&B(!0)}catch{}},[t,r]);const me=async pe=>{if(!pe){A({});return}const He=sr(bt(je,"inventory_candies_sellers"),Ar("sellerId","==",pe)),he=await Ht(He),ee={};he.forEach(_e=>{const R=_e.data(),V=R.productId||"";if(!V)return;const q=Number(R.remainingUnits??R.remaining??R.totalUnits??0);q<=0||(ee[V]=(ee[V]||0)+q)}),A(ee),K(_e=>{const R=[];for(const V of _e){const q=ee[V.productId]??0;q>0&&R.push({...V,availableUnits:q})}return R})};g.useEffect(()=>{if(!C){A({});return}const pe=u.find(He=>He.id===C);pe&&x(pe.branch),me(C)},[C,u]),g.useEffect(()=>{K(pe=>pe.map(He=>{const he=l.find(_e=>_e.id===He.productId);if(!he)return He;const ee=p==="RIVAS"?he.priceRivas:p==="SAN_JORGE"?he.priceSanJorge:he.priceIsla;return{...He,pricePerPackage:Number(ee)||0}}))},[p,l]);async function Ee(pe){const{productId:He,vendorId:he,branch:ee}=pe;if(!He||!he)return 0;const _e=sr(bt(je,"inventory_candies_sellers"),Ar("sellerId","==",he),Ar("productId","==",He)),R=await Ht(_e);if(R.empty)return 0;const V=R.docs[0].data(),q=Number(V.unitPriceVendor??0);if(q>0)return q;const se=Number(ee==="RIVAS"?V.unitPriceRivas??0:ee==="SAN_JORGE"?V.unitPriceSanJorge??0:V.unitPriceIsla??0);return Number(se||0)}const ye=pe=>{const He=Number(it||0),he=Number(pe||0)*He/100;return Math.max(0,Number(he.toFixed(2)))},We=async pe=>{var Me;if(!pe)return;if(!C){L("Selecciona primero el vendedor para usar su inventario."),T("");return}if(P.some(Ke=>Ke.productId===pe)){T("");return}const He=l.find(Ke=>Ke.id===pe);if(!He){T("");return}const he=await cG(pe,C),ee=((Me=u.find(Ke=>Ke.id===C))==null?void 0:Me.branch)??p,_e=await Ee({productId:pe,vendorId:C,branch:ee}),V=await(async Ke=>{const{productId:Pe,vendorId:rt}=Ke;if(!Pe||!rt)return 0;try{const lt=sr(bt(je,"inventory_candies_sellers"),Ar("sellerId","==",rt),Ar("productId","==",Pe)),ht=await Ht(lt);if(ht.empty)return 0;const kt=ht.docs[0].data();return Number(kt.providerPrice??0)}catch{return 0}})({productId:pe,vendorId:C}),q=(()=>{const Ke=Number(He.providerPrice||0);if(Ke>0)return Ke;const Pe=Number(He.providerPricePerUnit||0);return Pe>0?Pe*Number(He.unitsPerPackage||1):0})(),se=Number(V||0)>0?Number(V||0):Number(q||0),Ne={productId:pe,productName:He.name||"",sku:He.sku||"",unitsPerPackage:He.unitsPerPackage||1,pricePerPackage:Number(_e)||0,availableUnits:Number(he)||0,qtyPackages:0,discount:0,providerPricePerPackage:Number(se)||0,margenVendedor:0,uBruta:0};K(Ke=>[...Ke,Ne]),T("")},ge=(pe,He)=>{K(he=>he.map(ee=>{if(ee.productId!==pe)return ee;if(He==="")return{...ee,qtyPackages:0};const _e=Math.max(0,Math.floor(Number(He))),R=f[pe]??ee.availableUnits??0,V=Math.max(1,Number(ee.unitsPerPackage||1)),q=Math.floor(R/V);let se=_e;_e>q&&(se=q,L(` Solo hay ${q} paquetes disponibles.`),setTimeout(()=>L(""),2500));const Ne=Number(ee.pricePerPackage||0)*se,Me=Number(ee.providerPricePerPackage||0)*se,Ke=Ne-Me,Pe=ye(Ke);return{...ee,qtyPackages:se,margenVendedor:Pe,uBruta:Ke}}))},Ie=(pe,He)=>{K(he=>he.map(ee=>{if(ee.productId!==pe)return ee;if(He==="")return{...ee,discount:0};const _e=Math.max(0,Math.floor(Number(He))),R=ee.qtyPackages||0,V=Number(ee.pricePerPackage||0)*R,q=Number(ee.providerPricePerPackage||0)*R,se=V-q,Ne=ye(se);return{...ee,discount:_e,margenVendedor:Ne,uBruta:se}}))},xt=pe=>K(He=>He.filter(he=>he.productId!==pe)),Pt=async()=>{if(!j)return"Selecciona la fecha.";if(!C)return"Selecciona el vendedor para esta venta.";if(P.length===0)return"Agrega al menos un producto.";const pe=P.filter(He=>(He.qtyPackages||0)>0);if(pe.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(Ue>0))return"El total debe ser mayor a cero.";if(h==="CONTADO"){if(!b.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!v)return"Selecciona un cliente (crdito).";if(O<0)return"El pago inicial no puede ser negativo.";if(O>ue)return"El pago inicial no puede superar el saldo a deber (saldo actual + venta).";if((Je==null?void 0:Je.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const He of pe){const he=He.unitsPerPackage||1,ee=(He.qtyPackages||0)*he,_e=await cG(He.productId,C),R=Math.floor(_e/he);if(ee>_e)return`Inventario insuficiente en el pedido del vendedor para "${He.productName}". Disponible: ${R} paquetes.`;const V=(Number(He.pricePerPackage)||0)*(He.qtyPackages||0),q=Number(He.discount)||0;if(!Number.isInteger(q)||q<0)return`El descuento en "${He.productName}" debe ser entero y  0.`;if(q>V)return`El descuento en "${He.productName}" no puede exceder C$ ${V.toFixed(2)}.`}return null},It=async pe=>{pe.preventDefault(),L("");const He=await Pt();if(He){L(" "+He);return}try{X(!0);const he=P.filter(q=>(q.qtyPackages||0)>0).map(q=>{const se=q.unitsPerPackage||1,Ne=q.qtyPackages||0,Me=Ne*se,Ke=(Number(q.pricePerPackage)||0)*(Ne||0),Pe=Math.max(0,Math.floor(Number(q.discount)||0)),rt=Math.max(0,Ke-Pe),lt=Number(q.providerPricePerPackage||0),ht=lt*Ne,kt=Ke-ht,de=ye(kt);return{productId:q.productId,productName:q.productName,sku:q.sku||"",qty:Me,packages:Ne,unitsPerPackage:se,branch:p,unitPricePackage:Number(q.pricePerPackage)||0,discount:Pe,total:Math.floor(rt*100)/100,providerPricePerPackage:lt,margenVendedor:de,uBruta:kt}}),ee={type:h,branch:p,date:j,createdAt:xr.now(),itemsTotal:Number(Ue)||0,total:Number(Ue)||0,quantity:Number(Te)||0,packagesTotal:Number(te)||0,items:he,vendorId:C},_e=u.find(q=>q.id===C);_e&&(ee.vendorName=_e.name,ee.vendorBranch=_e.branch,ee.vendorBranchLabel=_e.branchLabel,ee.vendorCommissionPercent=_e.commissionPercent||0,ee.vendorCommissionAmount=vt||0),h==="CONTADO"?ee.customerName=b.trim():(ee.customerId=v,ee.downPayment=Number(O)||0);const R=await Wn(bt(je,"sales_candies"),ee);if(h==="CONTADO"){const q=(b||"").trim();if(q)try{await Wn(bt(je,"cash_customers"),{name:q,date:j,branch:p,vendorId:C,createdAt:xr.now()})}catch(se){console.warn("No se pudo guardar cash_customer:",se)}}if(h==="CREDITO"&&v){const q={customerId:v,date:j,createdAt:xr.now(),ref:{saleId:R.id}};await Wn(bt(je,"ar_movements"),{...q,type:"CARGO",amount:Number(Ue)||0}),Number(O)>0&&await Wn(bt(je,"ar_movements"),{...q,type:"ABONO",amount:-Number(O)})}const V={};for(const q of he)if(q.qty>0){const{allocations:se}=await UQe({productId:q.productId,vendorId:C,quantityUnits:q.qty,saleDate:j,saleId:R.id});V[q.productId]={productId:q.productId,vendorId:C,allocations:se}}await kn(Xt(je,"sales_candies",R.id),{allocationsByItem:V});try{const q=h==="CONTADO"?b.trim()||"Cliente Mostrador":(Je==null?void 0:Je.name)||"Cliente crdito";LQe({saleId:R.id,date:j,customerName:q,branch:p,items:he.map(se=>({productName:se.productName,qty:se.packages,unitPrice:se.unitPricePackage,total:se.total})),total:Number(Ue)||0,vendorName:_e==null?void 0:_e.name,vendorCommissionPercent:(_e==null?void 0:_e.commissionPercent)||0,vendorCommissionAmount:vt})}catch(q){console.error("Error generando voucher PDF:",q)}m("CONTADO"),y(""),w(""),I(uG()),K([]),H(0),h==="CREDITO"&&v&&o(q=>q.map(se=>se.id===v?{...se,balance:(se.balance||0)+(Number(Ue)||0)-(Number(O)||0)}:se)),L(" Venta de dulces registrada"),C?await me(C):A({})}catch(he){console.error(he),L(" Error al guardar la venta de dulces")}finally{X(!1)}},Ut=g.useMemo(()=>l.filter(pe=>{const He=f[pe.id]||0,he=Math.max(1,Number(pe.unitsPerPackage||1));return Math.floor(He/he)>0}).sort((pe,He)=>(pe.name||"").localeCompare(He.name||"")),[l,f]),[$t,Le]=g.useState(""),Ce=g.useMemo(()=>{const pe=String($t||"").trim().toLowerCase();return pe?Ut.filter(He=>`${He.name||""} ${He.sku||""}`.toLowerCase().includes(pe)||String(He.id||"").includes(pe)):Ut},[$t,Ut]);return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Ventas (Dulces)"})}),i.jsxs("form",{onSubmit:It,className:"bg-white p-3 sm:p-4 rounded shadow border mb-6",children:[i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:pe=>m(pe.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),h==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:b,onChange:pe=>w(pe.target.value)})]}):i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[i.jsxs("select",{className:"w-full sm:flex-1 border p-2 rounded",value:v,onChange:pe=>y(pe.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),dt.map(pe=>i.jsxs("option",{value:pe.status==="ACTIVO"?pe.id:"",disabled:pe.status==="BLOQUEADO",children:[pe.name," | ",pe.phone," | Saldo: ",Wc(pe.balance||0)]},pe.id))]}),i.jsx("button",{type:"button",className:"w-full sm:w-auto px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>Q(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-lg font-semibold",children:Wc(ce)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:ue,className:"w-full border p-2 rounded",value:O===0?"":O,onChange:pe=>{const He=ne(pe.target.value);H(He)},placeholder:"0.00"})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-lg font-semibold",children:Wc(we)})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:j,onChange:pe=>I(pe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:C,onChange:pe=>{S(pe.target.value),K([])},disabled:E,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.map(pe=>i.jsxs("option",{value:pe.id,children:[pe.name,"  ",pe.branchLabel,"  ",pe.commissionPercent.toFixed(2),"%"," comisin"]},pe.id))]}),E&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor fijado por el usuario logueado."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Lista de precios / Sucursal"}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"RIVAS",checked:p==="RIVAS",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Rivas"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"SAN_JORGE",checked:p==="SAN_JORGE",readOnly:!0,disabled:!0}),i.jsx("span",{children:"San Jorge"})]}),i.jsxs("label",{className:"inline-flex items-center gap-1",children:[i.jsx("input",{type:"radio",className:"accent-blue-600",value:"ISLA",checked:p==="ISLA",readOnly:!0,disabled:!0}),i.jsx("span",{children:"Isla de Ometepe"})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"La sucursal se toma automticamente del vendedor seleccionado."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),i.jsxs("div",{className:"mt-1 mb-2 flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",placeholder:C?"Buscar producto por nombre o SKU":"Selecciona un vendedor primero",value:$t,onChange:pe=>Le(pe.target.value),disabled:!C}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>Ft(!0),disabled:!C,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[i.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"})]})})]}),i.jsxs("select",{className:"w-full border p-2 rounded",value:k,onChange:async pe=>{const He=pe.target.value;T(He),await We(He)},disabled:!C,children:[i.jsx("option",{value:"",children:C?"Selecciona un producto":"Selecciona un vendedor primero"}),Ce.map(pe=>{const He=P.some(R=>R.productId===pe.id),he=f[pe.id]||0,ee=Math.max(1,Number(pe.unitsPerPackage||1)),_e=Math.floor(he/ee);return _e<=0?null:i.jsxs("option",{value:He?"":pe.id,disabled:He,children:[pe.name," ",pe.sku?` ${pe.sku}`:""," (disp: ",_e," ","paq.)",He?" ":""]},pe.id)})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"El selector solo muestra productos disponibles del pedido del vendedor seleccionado (sin ceros)."})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("div",{className:"border rounded overflow-hidden min-w-[860px]",children:[i.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[i.jsx("div",{className:"col-span-4",children:"Producto"}),i.jsx("div",{className:"col-span-2 text-right",children:"Precio (paq.)"}),i.jsx("div",{className:"col-span-2 text-right",children:"Existencias (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Cantidad (paq.)"}),i.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),i.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),i.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),P.length===0?i.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):P.map(pe=>{const He=f[pe.productId]??pe.availableUnits??0,he=pe.unitsPerPackage?Math.floor(He/pe.unitsPerPackage):0,ee=Math.max(0,he-(pe.qtyPackages||0)),_e=(Number(pe.pricePerPackage)||0)*(pe.qtyPackages||0),R=Math.max(0,_e-(Number(pe.discount)||0));return i.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[i.jsx("div",{className:"col-span-4",children:i.jsxs("div",{className:"font-medium",children:[pe.productName,pe.sku?`  ${pe.sku}`:""]})}),i.jsx("div",{className:"col-span-2 text-right",children:Wc(pe.pricePerPackage)}),i.jsxs("div",{className:"col-span-2 text-right",children:[ee," paq."]}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(pe.qtyPackages)||pe.qtyPackages===0?"":pe.qtyPackages,onChange:V=>ge(pe.productId,V.target.value),inputMode:"numeric",placeholder:"0"})}),i.jsx("div",{className:"col-span-1",children:i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(pe.discount)||pe.discount===0?"":pe.discount,onChange:V=>Ie(pe.productId,V.target.value),inputMode:"numeric",placeholder:"0"})}),i.jsx("div",{className:"col-span-1 text-right",children:Wc(R)}),i.jsx("div",{className:"col-span-1 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>xt(pe.productId),title:"Quitar producto",children:""})})]},pe.productId)})]})}),P.length>0&&i.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-6 mt-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes totales: "}),i.jsx("span",{className:"font-semibold",children:te})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Total: "}),i.jsx("span",{className:"font-semibold",children:Wc(Ue)})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Comisin vendedor: "}),i.jsxs("span",{className:"font-semibold",children:[Wc(vt)," ",it?`(${it.toFixed(2)}%)`:""]})]})]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{type:"submit",className:"w-full sm:w-auto bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:W,children:W?"Guardando...":"Registrar venta"})})]}),i.jsxs("div",{className:"md:hidden space-y-3",children:[i.jsxs("div",{className:"bg-white rounded-xl border shadow",children:[i.jsxs("button",{type:"button",onClick:()=>oe(pe=>!pe),className:"w-full flex justify-between items-center p-3 font-semibold",children:["Datos de venta",i.jsx("span",{className:"text-lg",children:le?"":"+"})]}),le&&i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:j,onChange:pe=>I(pe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:pe=>m(pe.target.value),children:[i.jsx("option",{value:"CONTADO",children:"Contado"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),h==="CONTADO"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (Cash)"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mario Bergoglio",value:b,onChange:pe=>w(pe.target.value)})]}):i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("select",{className:"w-full border p-2 rounded",value:v,onChange:pe=>y(pe.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un cliente"}),dt.map(pe=>i.jsxs("option",{value:pe.status==="ACTIVO"?pe.id:"",disabled:pe.status==="BLOQUEADO",children:[pe.name," | Saldo: ",Wc(pe.balance||0)]},pe.id))]}),i.jsx("button",{type:"button",className:"w-full px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>Q(!0),children:"Crear Cliente"})]}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-base font-semibold",children:Wc(ce)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),i.jsx("div",{className:"text-base font-semibold",children:Wc(we)})]})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",max:ue,className:"w-full border p-2 rounded",value:O===0?"":O,onChange:pe=>{const He=ne(pe.target.value);H(He)},placeholder:"0.00"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:C,onChange:pe=>{S(pe.target.value),K([])},disabled:E,children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.map(pe=>i.jsxs("option",{value:pe.id,children:[pe.name,"  "," ",pe.commissionPercent.toFixed(2),"%"]},pe.id))]}),E&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor Logueado en esta app."})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl border shadow",children:[i.jsxs("button",{type:"button",onClick:()=>Ae(pe=>!pe),className:"w-full flex justify-between items-center p-3 font-semibold",children:["Agrega Productos",i.jsx("span",{className:"text-lg",children:ie?"":"+"})]}),ie&&i.jsxs("div",{className:"p-3 space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Productos"}),i.jsxs("div",{className:"mt-1 mb-2 flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",placeholder:C?"Buscar producto por nombre o SKU":"Selecciona un vendedor primero",value:$t,onChange:pe=>Le(pe.target.value),disabled:!C}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>Ft(!0),disabled:!C,children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[i.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"3",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"})]})})]}),i.jsxs("select",{className:"w-full border p-2 rounded",value:k,onChange:async pe=>{const He=pe.target.value;T(He),await We(He)},disabled:!C,children:[i.jsx("option",{value:"",children:C?"Selecciona un producto":"Selecciona un vendedor primero"}),Ce.map(pe=>{const He=P.some(R=>R.productId===pe.id),he=f[pe.id]||0,ee=Math.max(1,Number(pe.unitsPerPackage||1)),_e=Math.floor(he/ee);return _e<=0?null:i.jsxs("option",{value:He?"":pe.id,disabled:He,children:[pe.name," ",pe.sku?` ${pe.sku}`:""," (disp:"," ",_e," paq.)",He?" ":""]},pe.id)})]})]}),P.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"No hay productos agregados."}):i.jsx("div",{className:"space-y-2",children:P.map(pe=>{const He=f[pe.productId]??pe.availableUnits??0,he=pe.unitsPerPackage?Math.floor(He/pe.unitsPerPackage):0,ee=Math.max(0,he-(pe.qtyPackages||0)),_e=(Number(pe.pricePerPackage)||0)*(pe.qtyPackages||0),R=Math.max(0,_e-(Number(pe.discount)||0));return i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50 space-y-2",children:[i.jsxs("div",{className:"font-semibold leading-tight",children:[pe.productName,pe.sku?`  ${pe.sku}`:""]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"p-2 rounded border bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Precio x Paquete"}),i.jsx("div",{className:"font-bold",children:Wc(pe.pricePerPackage)})]}),i.jsxs("div",{className:"p-2 rounded border bg-white",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencias"}),i.jsxs("div",{className:"font-bold",children:[ee," paq."]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Cantidad Paquetes"}),i.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-2 rounded text-right",value:Number.isNaN(pe.qtyPackages)||pe.qtyPackages===0?"":pe.qtyPackages,onChange:V=>ge(pe.productId,V.target.value),inputMode:"numeric",placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Descuento"}),i.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-2 rounded text-right",value:Number.isNaN(pe.discount)||pe.discount===0?"":pe.discount,onChange:V=>Ie(pe.productId,V.target.value),inputMode:"numeric",placeholder:"0"})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"font-regular text-gray-600",children:["Total ",Wc(R)]}),i.jsxs("div",{className:"font-regular text-gray-600",children:["Comision ",Wc(pe.margenVendedor||0)]}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg bg-red-100 hover:bg-red-200",onClick:()=>xt(pe.productId),children:"Quitar"})]})]},pe.productId)})}),P.length>0&&i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-semibold",children:te})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total"}),i.jsx("div",{className:"font-semibold",children:Wc(Ue)})]})]})]})]}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 rounded-xl hover:bg-blue-700 disabled:opacity-60",disabled:W,children:W?"Guardando...":"Registrar venta"})]})]}),G&&i.jsx("p",{className:"mt-2 text-sm",children:G}),D&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-2 sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[98%] sm:w-[95%] max-w-xl p-3 sm:p-4 max-h-[92vh] overflow-auto",children:[i.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),i.jsx("input",{className:"w-full border p-2 rounded",value:Z,onChange:pe=>be(pe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),i.jsx("input",{className:"w-full border p-2 rounded",value:U,onChange:pe=>ze(dG(pe.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:re,onChange:pe=>J(pe.target.value),children:[i.jsx("option",{value:"",children:""}),DQe.map(pe=>i.jsx("option",{value:pe,children:pe},pe))]})]}),!E&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:jt,onChange:pe=>Ot(pe.target.value),children:[i.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.filter(pe=>(pe.status??"ACTIVO")==="ACTIVO").map(pe=>i.jsxs("option",{value:pe.id,children:[pe.name,"  ",pe.branchLabel]},pe.id))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Re,onChange:pe=>ke(pe.target.value),maxLength:500})]})]}),i.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-end gap-2",children:[i.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Tt(),Q(!1)},children:"Cancelar"}),i.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{var he;const pe=E?C||r:jt;if(!pe){L("Selecciona el vendedor para asociar este cliente.");return}if(L(""),!Z.trim()){L("Ingresa el nombre del nuevo cliente.");return}const He=dG(U);try{const ee=await Wn(bt(je,"customers_candies"),{name:Z.trim(),phone:He,place:re||"",notes:Re||"",status:Be,creditLimit:Number(ot||0),createdAt:xr.now(),sellerId:pe,vendorId:pe,vendorName:((he=u.find(R=>R.id===pe))==null?void 0:he.name)||""}),_e={id:ee.id,name:Z.trim(),phone:He,place:re||"",status:Be,creditLimit:Number(ot||0),balance:0,sellerId:pe};o(R=>[_e,...R]),y(ee.id),Tt(),Q(!1),L(" Cliente creado")}catch(ee){console.error(ee),L(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),i.jsx(De,{open:Qt,onClose:()=>Ft(!1),onDetected:Qe}),W&&i.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center p-2",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[i.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const fG=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],f_=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function VQe(){const[t,e]=g.useState(Ur(Qd(new Date),"yyyy-MM-dd")),[r,n]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Ur(new Date,"yyyy-MM-dd")),[o,l]=g.useState(""),[c,u]=g.useState(""),[d,f]=g.useState(0),[A,h]=g.useState("PENDIENTE"),[m,p]=g.useState(""),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,j]=g.useState(""),[I,C]=g.useState(null),[S,E]=g.useState(""),[B,k]=g.useState(""),[T,P]=g.useState(""),[K,le]=g.useState(0),[oe,ie]=g.useState("PENDIENTE"),[Ae,te]=g.useState("");g.useEffect(()=>{(async()=>{b(!0);try{const D=sr(bt(je,"expenses_candies"),In("date","desc")),Q=await Ht(D),Z=[];Q.forEach(be=>{const U=be.data();Z.push({id:be.id,date:U.date||Ur(new Date,"yyyy-MM-dd"),category:U.category||"",description:U.description||"",amount:Number(U.amount||0),status:U.status||"PENDIENTE",notes:U.notes||"",createdAt:U.createdAt??xr.now()})}),v(Z)}catch(D){console.error(D),j(" Error al cargar gastos")}finally{b(!1)}})()},[]);const Te=g.useMemo(()=>x.filter(D=>!(t&&D.date<t||r&&D.date>r)),[x,t,r]),Ue=g.useMemo(()=>{const D=Te.reduce((be,U)=>be+(U.amount||0),0),Q=Te.filter(be=>be.status==="PAGADO").reduce((be,U)=>be+(U.amount||0),0),Z=D-Q;return{total:D,pagado:Q,pendiente:Z}},[Te]),O=()=>{s(Ur(new Date,"yyyy-MM-dd")),l(""),u(""),f(0),h("PENDIENTE"),p("")},H=async D=>{if(D.preventDefault(),j(""),!o){j("Selecciona una categora.");return}if(!c.trim()){j("Ingresa una descripcin.");return}if(!d||d<=0){j("Ingresa un monto vlido.");return}try{const Q=await Wn(bt(je,"expenses_candies"),{date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:xr.now()});v(Z=>[{id:Q.id,date:a,category:o,description:c.trim(),amount:Number(d.toFixed(2)),status:A,notes:m||"",createdAt:xr.now()},...Z]),O(),j(" Gasto registrado")}catch(Q){console.error(Q),j(" Error al guardar gasto")}},G=D=>{C(D.id),E(D.date),k(D.category||""),P(D.description||""),le(Number(D.amount||0)),ie(D.status||"PENDIENTE"),te(D.notes||"")},L=()=>{C(null),E(""),k(""),P(""),le(0),ie("PENDIENTE"),te("")},W=async()=>{if(I){if(!B){j("Selecciona una categora.");return}if(!T.trim()){j("Ingresa una descripcin.");return}if(!K||K<=0){j("Ingresa un monto vlido.");return}try{await kn(Xt(je,"expenses_candies",I),{date:S,category:B,description:T.trim(),amount:Number(K.toFixed(2)),status:oe,notes:Ae||""}),v(D=>D.map(Q=>Q.id===I?{...Q,date:S,category:B,description:T.trim(),amount:Number(K.toFixed(2)),status:oe,notes:Ae||""}:Q)),L(),j(" Gasto actualizado")}catch(D){console.error(D),j(" Error al actualizar gasto")}}},X=async D=>{confirm(`Eliminar el gasto "${D.description}"?`)&&(await zn(Xt(je,"expenses_candies",D.id)),v(Z=>Z.filter(be=>be.id!==D.id)),j(" Gasto borrado"))};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Dulces)"}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:D=>e(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:D=>n(D.target.value)})]}),i.jsxs("div",{className:"ml-auto text-sm",children:[i.jsx("div",{className:"font-semibold",children:"Totales del rango"}),i.jsxs("div",{children:["Total: ",f_(Ue.total)]}),i.jsxs("div",{children:["Pagado: ",f_(Ue.pagado)]}),i.jsxs("div",{children:["Pendiente: ",f_(Ue.pendiente)]})]})]}),i.jsxs("form",{onSubmit:H,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:a,onChange:D=>s(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:D=>l(D.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),fG.map(D=>i.jsx("option",{value:D,children:D},D))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),i.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:D=>u(D.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:d===0?"":d,onChange:D=>f(Math.max(0,Number(D.target.value||0))),placeholder:"0.00"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:A,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:D=>p(D.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),i.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),i.jsx("div",{className:"md:col-span-2",children:i.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Comentario"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Te.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):Te.slice().sort((D,Q)=>D.date.localeCompare(Q.date)).map(D=>{const Q=I===D.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:S,onChange:Z=>E(Z.target.value)}):D.date}),i.jsx("td",{className:"p-2 border",children:Q?i.jsxs("select",{className:"w-full border p-1 rounded",value:B,onChange:Z=>k(Z.target.value),children:[i.jsx("option",{value:"",children:"Selecciona"}),fG.map(Z=>i.jsx("option",{value:Z,children:Z},Z))]}):D.category||""}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{className:"w-full border p-1 rounded",value:T,onChange:Z=>P(Z.target.value)}):i.jsx("span",{title:D.description,children:D.description.length>40?D.description.slice(0,40)+"":D.description})}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(K)?"":K,onChange:Z=>le(Math.max(0,Number(Z.target.value||0)))}):f_(D.amount)}),i.jsx("td",{className:"p-2 border",children:Q?i.jsxs("select",{className:"w-full border p-1 rounded",value:oe,onChange:Z=>ie(Z.target.value),children:[i.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),i.jsx("option",{value:"PAGADO",children:"Pagado"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:D.status})}),i.jsx("td",{className:"p-2 border",children:Q?i.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:Ae,onChange:Z=>te(Z.target.value),maxLength:500}):i.jsx("span",{title:D.notes||"",children:(D.notes||"").length>40?(D.notes||"").slice(0,40)+"":D.notes||""})}),i.jsx("td",{className:"p-2 border",children:i.jsx("div",{className:"flex gap-2 justify-center",children:Q?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:W,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:L,children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>G(D),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>X(D),children:"Borrar"})]})})})]},D.id)})})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w})]})}const vo=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function HQe(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?Ur(t.createdAt.toDate(),"yyyy-MM-dd"):""}function $Qe(t,e){var l,c,u;const r=HQe(t);if(!r)return null;let n=0,a=0;const s=Array.isArray(t.items)&&t.items.length>0?t.items:t.item?[t.item]:[],o=s.length?s.map(d=>String(d.productName||d.name||"").trim()).filter(Boolean):t.productName?[String(t.productName).trim()]:[];return s.length>0?(n=s.reduce((d,f)=>d+(Number(f.packages??f.qty??f.quantity??0)||0),0),a=Number(t.total??t.itemsTotal??0)||0,a||(a=s.reduce((d,f)=>d+(Number(f.total??f.lineFinal??0)||0),0))):(n=Number(t.packagesTotal??t.quantity??((l=t.item)==null?void 0:l.packages)??((c=t.item)==null?void 0:c.qty)??0)||0,a=Number(t.total??((u=t.item)==null?void 0:u.total)??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:a,quantity:n,customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),vendorId:t.vendorId||void 0,vendorName:t.vendorName||t.vendor||void 0,vendorCommissionPercent:Number(t.vendorCommissionPercent||0)||0,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0,productNames:o}}async function GQe(t){const e=(t||"").trim();if(!e)return;const r=sr(bt(je,"ar_movements"),Ar("ref.saleId","==",e)),n=await Ht(r);await Promise.all(n.docs.map(a=>zn(Xt(je,"ar_movements",a.id))))}function KQe({role:t="",sellerCandyId:e="",roles:r}){const n=r&&r.length?r:t,a=Sn(n,"vendedor_dulces"),s=Sn(n,"admin"),o=s?8:7,[l,c]=g.useState(!1),[u,d]=g.useState(!1),[f,A]=g.useState(null),[h,m]=g.useState([]),p=async ce=>{c(!0),d(!0),A(ce),m([]);try{const we=await Cs(Xt(je,"sales_candies",ce)),ue=we.exists()?we.data():null;if(!ue){m([]);return}const Ve=(Array.isArray(ue==null?void 0:ue.items)?ue.items:ue!=null&&ue.item?[ue.item]:[]).map(it=>({productName:String(it.productName||""),qty:Number(it.packages??it.qty??it.quantity??0),unitPrice:Number(it.unitPricePackage??it.unitPrice??0),discount:Number(it.discount||0),total:Number(it.total??it.lineFinal??0)}));m(Ve)}catch(we){console.error(we)}finally{d(!1)}},[x,v]=g.useState(Ur(new Date,"yyyy-MM-01")),[y,b]=g.useState(Ur(new Date,"yyyy-MM-dd")),[w,j]=g.useState([]),[I,C]=g.useState([]),[S,E]=g.useState(""),[B,k]=g.useState([]),[T,P]=g.useState(!0),[K,le]=g.useState(""),[oe,ie]=g.useState(""),[Ae,te]=g.useState(""),[Te,Ue]=g.useState(null),O=15,[H,G]=g.useState(1),[L,W]=g.useState(!1),[X,D]=g.useState(!1),[Q,Z]=g.useState(!1),[be,U]=g.useState(!1),ze=g.useMemo(()=>{const ce={};return w.forEach(we=>ce[we.id]=we.name),ce},[w]),re=g.useMemo(()=>{const ce={};return B.forEach(we=>{ce[we.id]=we}),ce},[B]),J=g.useMemo(()=>{const ce=new Set;return I.forEach(we=>{(we.productNames||[]).forEach(ue=>ce.add(ue))}),Array.from(ce).sort((we,ue)=>we.localeCompare(ue))},[I]),Re=ce=>{const we=Number(ce.vendorCommissionAmount||0);if(we>0)return we;if(!ce.vendorId)return 0;const ue=re[ce.vendorId];if(!ue||!ue.commissionPercent)return 0;const ne=(Number(ce.total)||0)*(Number(ue.commissionPercent)||0)/100;return Number(ne.toFixed(2))};g.useEffect(()=>{(async()=>{P(!0),le("");try{const ce=await Ht(bt(je,"customers_candies")),we=[];ce.forEach(vt=>we.push({id:vt.id,name:vt.data().name||""})),j(we);const ue=await Ht(bt(je,"sellers_candies")),ne=[];ue.forEach(vt=>{const me=vt.data();ne.push({id:vt.id,name:me.name||"",commissionPercent:Number(me.commissionPercent||0)})}),k(ne);const Ve=await Ht(sr(bt(je,"sales_candies"),In("createdAt","desc"))),it=[];Ve.forEach(vt=>{const me=$Qe(vt.data(),vt.id);me&&me.date>=x&&me.date<=y&&it.push(me)}),C(it.sort((vt,me)=>me.date.localeCompare(vt.date))),G(1)}catch(ce){console.error(ce),le(" Error cargando transacciones.")}finally{P(!1)}})()},[x,y]);const ke=g.useMemo(()=>I.filter(ce=>!(a&&(!e||!ce.vendorId||ce.vendorId!==e)||oe&&ce.customerId!==oe||Ae&&ce.type!==Ae||S&&(!ce.productNames||!ce.productNames.includes(S)))),[I,oe,Ae,S,a,e]),Be=g.useMemo(()=>{let ce=0,we=0,ue=0,ne=0,Ve=0,it=0;for(const vt of ke)vt.type==="CONTADO"?(ce+=vt.quantity,ue+=vt.total,Ve+=Re(vt)):(we+=vt.quantity,ne+=vt.total,it+=Re(vt));return{packsCash:ce,packsCredito:we,montoCash:ue,montoCredito:ne,comisionCash:Ve,comisionCredito:it}},[ke]),Ye=Math.max(1,Math.ceil(ke.length/O)),ot=g.useMemo(()=>{const ce=(H-1)*O;return ke.slice(ce,ce+O)},[ke,H]),Ct=g.useMemo(()=>ot.filter(ce=>ce.type==="CONTADO"),[ot]),jt=g.useMemo(()=>ot.filter(ce=>ce.type==="CREDITO"),[ot]),Ot=g.useMemo(()=>f&&I.find(ce=>ce.id===f)||null,[f,I]),Tt=async ce=>{if(s&&(Ue(null),!!window.confirm("Eliminar esta venta de dulces? Se restaurar el inventario asociado.")))try{P(!0);const we=ce.id.split("#")[0];await q2(we),await GQe(we),C(ue=>ue.filter(ne=>ne.id!==ce.id)),le(" Venta eliminada y saldo del cliente ajustado")}catch(we){console.error(we),le(" No se pudo eliminar la venta.")}finally{P(!1)}},Qt=()=>{const ce=`Ventas del dia  ${x} a ${y}`,we=it=>(it||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ue=ke.map(it=>{const vt=it.customerName||(it.customerId?ze[it.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${it.date}</td>
          <td>${we(vt)}</td>
          <td>${it.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${it.quantity}</td>
          <td style="text-align:right">${vo(it.total)}</td>
        </tr>`}).join(""),ne=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${we(ce)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${we(ce)}</h1>
      <div class="kpis">
        <div><b>Paquetes Cash:</b> ${Be.packsCash}</div>
        <div><b>Paquetes Crdito:</b> ${Be.packsCredito}</div>
        <div><b>Monto Cash:</b> ${vo(Be.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${vo(Be.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Paquetes</th><th>Monto</th>
      </tr></thead><tbody>
      ${ue||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,Ve=window.open("","_blank");Ve&&(Ve.document.open(),Ve.document.write(ne),Ve.document.close())},Ft=()=>G(1),Qe=()=>G(ce=>Math.max(1,ce-1)),De=()=>G(ce=>Math.min(Ye,ce+1)),Je=()=>G(Ye),dt=()=>{const ce=[];if(Ye<=7)for(let ue=1;ue<=Ye;ue++)ce.push(ue);else{const ue=Math.max(1,H-2),ne=Math.min(Ye,H+2);ce.push(1),ue>2&&ce.push(-1);for(let Ve=ue;Ve<=ne;Ve++)Ve!==1&&Ve!==Ye&&ce.push(Ve);ne<Ye-1&&ce.push(-2),ce.push(Ye)}return i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ft,disabled:H===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Qe,disabled:H===1,children:" Anterior"}),ce.map((ue,ne)=>typeof ue=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${ue===H?"bg-blue-600 text-white":""}`,onClick:()=>G(ue),children:ue},ne):i.jsx("span",{className:"px-2",children:""},ne)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:De,disabled:H===Ye,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Je,disabled:H===Ye,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",H," de ",Ye,"  ",ke.length," transaccin(es)"]})]})};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>W(ce=>!ce),"aria-expanded":L,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${L?"rotate-180":""}`,children:""})]}),L&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:x,onChange:ce=>{v(ce.target.value),G(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:y,onChange:ce=>{b(ce.target.value),G(1)}})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:oe,onChange:ce=>{ie(ce.target.value),G(1)},children:[i.jsx("option",{value:"",children:"Todos"}),w.map(ce=>i.jsx("option",{value:ce.id,children:ce.name},ce.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:Ae,onChange:ce=>{te(ce.target.value),G(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:S,onChange:ce=>{E(ce.target.value),G(1)},disabled:J.length===0,children:[i.jsx("option",{value:"",children:"Todos"}),J.map(ce=>i.jsx("option",{value:ce,children:ce},ce))]})]}),i.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 w-full",onClick:Qt,children:"Exportar PDF"})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>D(ce=>!ce),"aria-expanded":X,children:[i.jsx("span",{children:"Indicadores"}),i.jsx("span",{className:`transition-transform ${X?"rotate-180":""}`,children:""})]}),X&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Be.packsCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:Be.packsCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:vo(Be.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:vo(Be.montoCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:vo(Be.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:vo(Be.comisionCredito)})]})]})})]}),i.jsxs("div",{className:"block md:hidden space-y-3",children:[T?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Cargando"}):ot.length===0?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Sin transacciones en el rango."}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-xl shadow",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Z(ce=>!ce),"aria-expanded":Q,children:[i.jsx("span",{children:"Cash"}),i.jsx("span",{className:`transition-transform ${Q?"rotate-180":""}`,children:""})]}),Q&&i.jsx("div",{className:"p-3 border-t space-y-3",children:Ct.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones cash."}):Ct.map(ce=>{const we=ce.customerName||(ce.customerId?ze[ce.customerId]:"")||"Nombre cliente",ue=Re(ce);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:we}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:ce.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:"px-2 py-1 rounded-full border bg-green-50 border-green-200 text-green-700",children:"Cash"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Paquetes:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:ne=>{ne.preventDefault(),p(ce.id)},title:"Ver detalle",children:ce.quantity})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",vo(ce.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:we})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:ce.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:"Cash"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(ce.id),title:"Ver detalle",children:ce.quantity})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:vo(ce.total)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("span",{className:"font-medium",children:ue>0?vo(ue):""})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("span",{className:"font-medium",children:ce.vendorName||""})]}),s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>Ue(ne=>ne===ce.id?null:ce.id),children:" Acciones"}),Te===ce.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Tt(ce),children:"Eliminar"})]})]})})]})},ce.id)})})]}),i.jsxs("div",{className:"bg-white border rounded-xl shadow",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>U(ce=>!ce),"aria-expanded":be,children:[i.jsx("span",{children:"Crdito"}),i.jsx("span",{className:`transition-transform ${be?"rotate-180":""}`,children:""})]}),be&&i.jsx("div",{className:"p-3 border-t space-y-3",children:jt.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones crdito."}):jt.map(ce=>{const we=ce.customerName||(ce.customerId?ze[ce.customerId]:"")||"Nombre cliente",ue=Re(ce);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:we}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:ce.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:"px-2 py-1 rounded-full border bg-yellow-50 border-yellow-200 text-yellow-700",children:"Crdito"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Paquetes:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:ne=>{ne.preventDefault(),p(ce.id)},title:"Ver detalle",children:ce.quantity})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",vo(ce.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:we})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:ce.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:"Crdito"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(ce.id),title:"Ver detalle",children:ce.quantity})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:vo(ce.total)})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("span",{className:"font-medium",children:ue>0?vo(ue):""})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("span",{className:"font-medium",children:ce.vendorName||""})]}),s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>Ue(ne=>ne===ce.id?null:ce.id),children:" Acciones"}),Te===ce.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Tt(ce),children:"Eliminar"})]})]})})]})},ce.id)})})]})]}),i.jsx("div",{className:"bg-white p-3 rounded shadow border",children:dt()})]}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Comisin"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),s&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:T?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Cargando"})}):ot.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Sin transacciones en el rango."})}):ot.map(ce=>{const we=ce.customerName||(ce.customerId?ze[ce.customerId]:"")||"Nombre cliente",ue=Re(ce);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ce.date}),i.jsx("td",{className:"p-2 border",children:we}),i.jsx("td",{className:"p-2 border",children:ce.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>p(ce.id),children:ce.quantity})}),i.jsx("td",{className:"p-2 border",children:vo(ce.total)}),i.jsx("td",{className:"p-2 border",children:ue>0?vo(ue):""}),i.jsx("td",{className:"p-2 border",children:ce.vendorName||""}),s&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>Ue(ne=>ne===ce.id?null:ce.id),title:"Acciones",children:""}),Te===ce.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>Tt(ce),children:"Eliminar"})})]})]},ce.id)})})]}),dt()]}),K&&i.jsx("p",{className:"mt-2 text-sm",children:K}),l&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Productos/paquetes vendidos"," ",f?` #${f}`:""]}),Ot&&i.jsxs("div",{className:"text-sm text-gray-700 mt-1",children:["Comisin de vendedor:"," ",i.jsx("span",{className:"font-semibold",children:Re(Ot)>0?vo(Re(Ot)):""})]})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>c(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Paquetes"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:u?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):h.map((ce,we)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:ce.productName}),i.jsx("td",{className:"p-2 border text-right",children:ce.qty}),i.jsx("td",{className:"p-2 border text-right",children:vo(ce.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:vo(ce.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:vo(ce.total)})]},we))})]})})]})})]})}const wn=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function rb(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?Ur(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function qQe(t){if(Array.isArray(t==null?void 0:t.items))return t.items.map(n=>{const a=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||0,s=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(a>0?Number((n==null?void 0:n.total)??(n==null?void 0:n.lineFinal)??0)/a:0)||0;return{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:a,unitPrice:Number(s||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0),uBruta:Number((n==null?void 0:n.uBruta)??(n==null?void 0:n.grossProfit)??0)}});if(t!=null&&t.item){const n=t.item,a=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,s=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(a>0?Number((n==null?void 0:n.total)??(t==null?void 0:t.total)??0)/a:0)||0;return[{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:a,unitPrice:Number(s||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0),uBruta:Number((n==null?void 0:n.uBruta)??(n==null?void 0:n.grossProfit)??0)}]}const e=Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,r=e>0?Number((t==null?void 0:t.total)||0)/e:0;return e>0?[{productId:String((t==null?void 0:t.productId)||""),productName:String((t==null?void 0:t.productName)||""),sku:(t==null?void 0:t.sku)||"",qty:e,unitPrice:Number(r||0),discount:Number((t==null?void 0:t.discount)||0),vendorCommissionAmount:Number((t==null?void 0:t.vendorCommissionAmount)??(t==null?void 0:t.commissionAmount)??0),uBruta:Number((t==null?void 0:t.uBruta)??(t==null?void 0:t.grossProfit)??0)}]:[]}function zQe(t,e){const r=rb(t);if(!r)return null;const n=t.vendorId||t.sellerId||void 0,a=t.vendorName||t.sellerName||void 0,s=qQe(t);let o=Number(t.total??t.itemsTotal??0)||s.reduce((l,c)=>{const u=(Number(c.qty||0)||0)*(Number(c.unitPrice||0)||0),d=Math.max(0,Number(c.discount||0)),f=Math.max(0,u-d);return l+f},0);return o=Number(o||0),{id:e,date:r,type:t.type||"CONTADO",total:o,items:s,customerId:t.customerId||void 0,customerName:t.customerName||void 0,vendorId:n,vendorName:a,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0}}function WQe(t,e,r,n){const a={};for(const l of t)a[l.productId]||(a[l.productId]={productName:l.productName,lots:[]}),a[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(a))a[l].lots.sort((c,u)=>c.date.localeCompare(u.date));const s=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of s)for(const c of l.items||[]){const u=a[c.productId];if(!u)continue;let d=Number(c.qty||0);if(!(d<=0))for(const f of u.lots){if(d<=0)break;if(f.qtyLeft<=0)continue;const A=Math.min(f.qtyLeft,d);l.date>=r&&l.date<=n&&(o+=A*f.cost),f.qtyLeft-=A,d-=A}}return o}async function XQe(t){const e=sr(bt(je,"ar_movements"),Ar("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>zn(Xt(je,"ar_movements",n.id))))}function YQe(){const{refreshKey:t,refresh:e}=Mc(),[r,n]=g.useState(Ur(Qd(new Date),"yyyy-MM-dd")),[a,s]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[o,l]=g.useState([]),[c,u]=g.useState([]),[d,f]=g.useState([]),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState([]),[y,b]=g.useState(!0),[w,j]=g.useState(""),[I,C]=g.useState([]),[S,E]=g.useState({}),[B,k]=g.useState({}),[T,P]=g.useState(!1),[K,le]=g.useState(null),[oe,ie]=g.useState([]),[Ae,te]=g.useState(!1),[Te,Ue]=g.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0}),[O,H]=g.useState(!1),[G,L]=g.useState(""),[W,X]=g.useState([]),[D,Q]=g.useState(!1),[Z,be]=g.useState("CASH"),[U,ze]=g.useState(1),re=10,[J,Re]=g.useState(!1),[ke,Be]=g.useState(null);g.useEffect(()=>{(async()=>{try{const ne=await Ht(bt(je,"sellers_candies")),Ve=[];ne.forEach(it=>{const vt=it.data();Ve.push({id:it.id,name:vt.name||"",commissionPercent:Number(vt.commissionPercent||0)})}),C(Ve)}catch(ne){console.error("Error cargando sellers_candies",ne)}})()},[]);const Ye=g.useMemo(()=>{const ne={};return I.forEach(Ve=>{ne[Ve.id]=Ve}),ne},[I]);g.useEffect(()=>{(async()=>{b(!0),j("");try{const ne=await Ht(bt(je,"sales_candies")),Ve=[],it=[];ne.forEach(Le=>{const Ce=Le.data(),pe=zQe(Ce,Le.id);pe&&(pe.date<=a&&Ve.push(pe),pe.date>=r&&pe.date<=a&&it.push(pe))}),u(Ve),l(it);const vt=await Ht(bt(je,"inventory_candies")),me=[];vt.forEach(Le=>{const Ce=Le.data(),pe=rb(Ce);if(!pe||pe>a)return;const He=Math.max(1,Math.floor(Number(Ce.unitsPerPackage||1))),he=Number(Ce.totalUnits??Ce.quantity??0),ee=Number(Ce.packages??0),_e=Number(Ce.remaining??0),R=Number(Ce.remainingPackages??0),V=ee>0?ee:he>0?Math.floor(he/He):0,q=R>0?R:_e>0?Math.floor(_e/He):0;me.push({id:Le.id,productId:Ce.productId,productName:Ce.productName||"",date:pe,quantity:Number(V||0),remaining:Number(q||0),purchasePrice:Number(Ce.providerPrice||Ce.purchasePrice||0),unitsPerPackage:He})}),f(me);const Ee=await Ht(bt(je,"expenses_candies")),ye=[];Ee.forEach(Le=>{const Ce=Le.data(),pe=rb(Ce);pe&&pe>=r&&pe<=a&&ye.push({id:Le.id,date:pe,category:Ce.category||"",description:Ce.description||"",amount:Number(Ce.amount||0),status:Ce.status||""})}),h(ye);const We=await Ht(bt(je,"ar_movements")),ge=[],Ie={};We.forEach(Le=>{const Ce=Le.data(),pe=rb(Ce);if(!pe)return;const He=Ce.customerId,he=Number(Ce.amount||0);He&&(Ie[He]=(Ie[He]||0)+he),Ce.type==="ABONO"&&pe>=r&&pe<=a&&ge.push({id:Le.id,customerId:He,type:"ABONO",amount:he,date:pe})}),p(ge);const xt=await Ht(bt(je,"customers_candies")),Pt=[];xt.forEach(Le=>{const Ce=Le.data();Pt.push({id:Le.id,name:Ce.name||"",balance:Ie[Le.id]||0})}),v(Pt);const It=await Ht(bt(je,"inventory_candies_sellers")),Ut={},$t={};It.forEach(Le=>{const Ce=Le.data(),pe=rb(Ce);if(!pe||pe<r||pe>a)return;const He=Ce.sellerId||Ce.vendorId||"NO_VENDOR",he=Ce.productName||"",ee=Ce.sku||"",_e=Math.max(1,Math.floor(Number(Ce.unitsPerPackage||1))),R=Number(Ce.totalUnits??0),V=Number(Ce.packages??0),q=Number(Ce.remainingUnits??Ce.remaining??0),se=Number(Ce.remainingPackages??0),Ne=V>0?V:R>0?Math.floor(R/_e):0,Me=se>0?se:q>0?Math.floor(q/_e):0,Ke=Number(Ce.totalVendor??0),Pe=Number(Ce.uVendor??0),rt=Number(Ce.subtotal??0),lt=Number(Ce.uBruta??0),ht=Ne,kt=ht>0?Ke/ht:0,de=ht>0?Pe/ht:0,qe=ht>0?rt/ht:0,at=ht>0?lt>0?lt/ht:kt-qe:0;if(Ut[He]||(Ut[He]={associated:[],remaining:[]}),Ne>0){const st=Ne,Nt=st*kt,Rt=st*qe,nr=Nt,_r=st*de,$r=st*at;Ut[He].associated.push({saleId:Le.id,date:pe,productId:Ce.productId||Ce.id||"",productName:he,sku:ee,qty:st,unitPrice:kt,costTotal:Rt,lineTotal:Nt,discount:0,lineFinal:nr,grossProfit:$r,vendorCommissionAmount:_r,type:"ASSOCIATED"}),$t[He]=($t[He]||0)+st}if(Me>0){const st=Me,Nt=st*kt,Rt=st*qe,nr=Nt,_r=st*de,$r=st*at;Ut[He].remaining.push({saleId:Le.id,date:pe,productId:Ce.productId||Ce.id||"",productName:he,sku:ee,qty:st,unitPrice:kt,costTotal:Rt,lineTotal:Nt,discount:0,lineFinal:nr,grossProfit:$r,vendorCommissionAmount:_r,type:"REMAINING"})}}),E(Ut),k($t)}catch(ne){console.error(ne),j(" Error cargando datos del dashboard.")}finally{b(!1)}})()},[r,a,t]);const ot=g.useCallback((ne,Ve)=>{const it=Number(Ve.vendorCommissionAmount||0)||0;if(it>0)return it;const vt=Number(ne.vendorCommissionAmount||0)||0;if(vt<=0)return 0;const me=Number(Ve.qty||0),Ee=Number(Ve.unitPrice||0),ye=me*Ee,We=Math.max(0,Number(Ve.discount||0)),ge=Math.max(0,ye-We);return!ge||!ne.total?0:vt*ge/ne.total},[]),Ct=g.useMemo(()=>{try{return WQe(d,c,r,a)}catch(ne){return console.error(ne),0}},[d,c,r,a]),jt=g.useMemo(()=>{const ne=o.reduce((It,Ut)=>It+(Ut.total||0),0),Ve=A.reduce((It,Ut)=>It+(Ut.amount||0),0),it=ne-Ct,vt=it-Ve;let me=0;for(const It of o)for(const Ut of It.items||[]){const $t=Number(Ut.uBruta||0);Number.isFinite($t)&&(me+=$t)}const Ee=m.reduce((It,Ut)=>It+Math.abs(Ut.amount||0),0),ye=x.filter(It=>(It.balance||0)>0),We=ye.reduce((It,Ut)=>It+(Ut.balance||0),0);let ge=0,Ie=0,xt=0,Pt=0;for(const It of o){const Ut=(It.items||[]).reduce((Le,Ce)=>Le+(Number(Ce.qty)||0),0),$t=(It.items||[]).reduce((Le,Ce)=>Le+ot(It,Ce),0);It.type==="CONTADO"?(ge+=Ut,xt+=$t):(Ie+=Ut,Pt+=$t)}return{ventasTotales:ne,costoMercaderia:Ct,gastosPeriodo:Ve,gananciaAntes:it,utilidadBrutaOrdenes:me,gananciaDespues:vt,abonosRecibidos:Ee,saldosPendientes:We,clientesConSaldo:ye.length,paquetesCash:ge,paquetesCredito:Ie,comisionCash:xt,comisionCredito:Pt}},[o,A,m,x,Ct,ot,S]),Ot=g.useMemo(()=>{const ne={},Ve={};for(const it of o)if(!(it.type!=="CREDITO"||!it.customerId))for(const vt of it.items||[]){const me=Number(vt.qty||0),Ee=Number(vt.unitPrice||0),ye=me*Ee,We=Math.max(0,Number(vt.discount||0)),ge=Math.max(0,ye-We);ne[it.customerId]=(ne[it.customerId]||0)+me,Ve[it.customerId]=(Ve[it.customerId]||0)+ge}return x.filter(it=>(it.balance||0)>0).map(it=>({customerId:it.id,name:it.name,paquetesAsociados:ne[it.id]||0,saldoTotal:Ve[it.id]||0,saldoPendiente:it.balance||0})).sort((it,vt)=>vt.saldoPendiente-it.saldoPendiente)},[x,o]),Tt=g.useMemo(()=>{const ne={};return x.forEach(Ve=>ne[Ve.id]=Ve.name),ne},[x]),Qt=g.useMemo(()=>[...o].sort((ne,Ve)=>Ve.date.localeCompare(ne.date)).map(ne=>{var me;const Ve=(ne.items||[]).reduce((Ee,ye)=>Ee+(Number(ye.qty)||0),0);let it="Cash";ne.type==="CREDITO"&&ne.customerId?it=Tt[ne.customerId]||"":ne.type==="CONTADO"&&(it=((me=ne.customerName)==null?void 0:me.trim())||"Cash");const vt=Ve>0?ne.total/Ve:0;return{id:ne.id,date:ne.date,type:ne.type==="CREDITO"?"Crdito":"Cash",customer:it,paquetes:Ve,total:Number(ne.total||0),avgPrice:vt}}),[o,Tt]),Ft=g.useMemo(()=>{var Ve,it;const ne=new Map;for(const vt of o){const me=vt.vendorId||"NO_VENDOR",Ee=vt.vendorName||((Ve=Ye[me])==null?void 0:Ve.name)||"Sin vendedor";ne.has(me)||ne.set(me,{vendorId:me,vendorName:Ee,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0});const ye=ne.get(me);for(const We of vt.items||[]){const ge=Number(We.qty||0),Ie=Number(We.unitPrice||0),xt=ge*Ie,Pt=Math.max(0,Number(We.discount||0)),It=Math.max(0,xt-Pt),Ut=ot(vt,We);vt.type==="CONTADO"?(ye.paquetesVendidos+=ge,ye.totalVendido+=It,ye.comisionCash+=Ut):(ye.paquetesFiados+=ge,ye.totalFiado+=It,ye.comisionCredito+=Ut)}}for(const[vt,me]of Object.entries(B)){const Ee=ne.get(vt),ye=(Ee==null?void 0:Ee.vendorName)||((it=Ye[vt])==null?void 0:it.name)||"Sin vendedor",We=Ee||{vendorId:vt,vendorName:ye,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0};We.paquetesAsociados=me,We.paquetesRestantes=Math.max(me-We.paquetesVendidos-We.paquetesFiados,0),ne.set(vt,We)}return Array.from(ne.values()).sort((vt,me)=>me.totalVendido+me.totalFiado-(vt.totalVendido+vt.totalFiado))},[o,B,Ye,ot]),Qe=async ne=>{P(!0),le({id:ne.customerId,name:ne.name}),ie([]),te(!0),Ue({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const Ve=[];let it=0,vt=0,me=0;for(const ge of o)if(!(ge.type!=="CREDITO"||ge.customerId!==ne.customerId))for(const Ie of ge.items||[]){const xt=Number(Ie.qty||0),Pt=Number(Ie.unitPrice||0),It=xt*Pt,Ut=Math.max(0,Number(Ie.discount||0)),$t=Math.max(0,It-Ut);Ve.push({saleId:ge.id,date:ge.date,productName:Ie.productName,sku:Ie.sku||"",qty:xt,unitPrice:Pt,lineTotal:It,discount:Ut,lineFinal:$t}),it+=It,vt+=Ut,me+=$t}let Ee=0;for(const ge of m)ge.customerId===ne.customerId&&(Ee+=Math.abs(ge.amount||0));const ye=x.find(ge=>ge.id===ne.customerId),We=(ye==null?void 0:ye.balance)||0;ie(Ve),Ue({totalBruto:it,totalDescuento:vt,totalFiado:me,saldoActual:We,abonadoPeriodo:Ee})}catch(Ve){console.error(Ve),j(" No se pudo cargar el detalle del cliente.")}finally{te(!1)}},De=(ne,Ve,it)=>{H(!0),be(it),ze(1);let vt="";it==="ASSOCIATED"?vt=`Paquetes asociados  ${Ve}`:it==="REMAINING"?vt=`Paquetes restantes  ${Ve}`:it==="CASH"?vt=`Paquetes vendidos (Cash)  ${Ve}`:vt=`Paquetes fiados (Crdito)  ${Ve}`,L(vt),X([]),Q(!0);try{if(it==="ASSOCIATED"||it==="REMAINING"){const Ee=S[ne],ye=it==="ASSOCIATED"?(Ee==null?void 0:Ee.associated)||[]:(Ee==null?void 0:Ee.remaining)||[];X([...ye].sort((We,ge)=>(ge.qty||0)-(We.qty||0))),Q(!1);return}const me=[];for(const Ee of o)if(((Ee.vendorId||"NO_VENDOR")===ne||!Ee.vendorId&&ne==="NO_VENDOR")&&!(it==="CASH"&&Ee.type!=="CONTADO")&&!(it==="CREDIT"&&Ee.type!=="CREDITO"))for(const We of Ee.items||[]){const ge=Number(We.qty||0),Ie=Number(We.unitPrice||0),xt=ge*Ie,Pt=Math.max(0,Number(We.discount||0)),It=Math.max(0,xt-Pt),Ut=ot(Ee,We);me.push({saleId:Ee.id,date:Ee.date,productName:We.productName,sku:We.sku||"",qty:ge,unitPrice:Ie,lineTotal:xt,discount:Pt,lineFinal:It,vendorCommissionAmount:Ut,type:it})}X(me.sort((Ee,ye)=>Ee.date.localeCompare(ye.date)))}catch(me){console.error(me),j(" No se pudo cargar el detalle del vendedor.")}finally{Q(!1)}},Je=g.useMemo(()=>Z!=="ASSOCIATED"&&Z!=="REMAINING"?1:Math.max(1,Math.ceil(W.length/re)),[Z,W.length]),dt=g.useMemo(()=>{if(Z!=="ASSOCIATED"&&Z!=="REMAINING")return W;const ne=(U-1)*re;return W.slice(ne,ne+re)},[Z,U,W]),ce=Z==="ASSOCIATED"||Z==="REMAINING"?10:8;g.useEffect(()=>{Z!=="ASSOCIATED"&&Z!=="REMAINING"||U>Je&&ze(Je)},[Z,U,Je]);const we=ne=>{const Ve=o.find(it=>it.id===ne)||null;Be(Ve),Re(!0)},ue=async ne=>{if(window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{await q2(ne),await XQe(ne),l(Ve=>Ve.filter(it=>it.id!==ne)),u(Ve=>Ve.filter(it=>it.id!==ne)),Re(!1),Be(null)}catch(Ve){console.error(Ve),alert("No se pudo eliminar la venta. Revisa la consola para ms detalles.")}};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Dulces)"}),i.jsx(Rc,{onClick:e,loading:y})]}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:ne=>n(ne.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:a,onChange:ne=>s(ne.target.value)})]})]}),i.jsx("div",{className:"md:hidden mb-4",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",open:!0,children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"KPIs"}),i.jsx("div",{className:"p-3",children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(jt.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(jt.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:wn(jt.utilidadBrutaOrdenes||0)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(jt.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:wn(jt.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(jt.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(jt.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:jt.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:jt.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:jt.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(jt.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(jt.comisionCredito)})]})]})})]})}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-4",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(jt.ventasTotales)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(jt.costoMercaderia)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:wn(jt.utilidadBrutaOrdenes||0)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(jt.gastosPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),i.jsx("div",{className:"text-xl font-semibold text-green-600",children:wn(jt.gananciaDespues)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(jt.abonosRecibidos)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(jt.saldosPendientes)}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),i.jsx("div",{className:"text-xl font-semibold",children:jt.clientesConSaldo})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:jt.paquetesCash})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),i.jsx("div",{className:"text-xl font-semibold",children:jt.paquetesCredito})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(jt.comisionCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(jt.comisionCredito)})]})]}),i.jsx("div",{className:"md:hidden mb-6",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"Consolidado clientes y vendedores"}),i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border",children:"Saldo total"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Ot.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Ot.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ne.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Qe({customerId:ne.customerId,name:ne.name}),title:"Ver paquetes fiados del periodo",children:ne.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:wn(ne.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:wn(ne.saldoPendiente)})]},ne.customerId))})]})}),i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Ft.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):Ft.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ne.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>De(ne.vendorId,ne.vendorName,"ASSOCIATED"),children:ne.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>De(ne.vendorId,ne.vendorName,"REMAINING"),children:ne.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>De(ne.vendorId,ne.vendorName,"CASH"),children:ne.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:wn(ne.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:wn(ne.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>De(ne.vendorId,ne.vendorName,"CREDIT"),children:ne.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:wn(ne.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:wn(ne.comisionCredito)})]},ne.vendorId))})]})})]})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Paquetes asociados (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo total (periodo)"}),i.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):Ot.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):Ot.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ne.name}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Qe({customerId:ne.customerId,name:ne.name}),title:"Ver paquetes fiados del periodo",children:ne.paquetesAsociados})}),i.jsx("td",{className:"p-2 border",children:wn(ne.saldoTotal)}),i.jsx("td",{className:"p-2 border font-semibold",children:wn(ne.saldoPendiente)})]},ne.customerId))})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Consolidado vendedores"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Ft.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):Ft.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ne.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>De(ne.vendorId,ne.vendorName,"ASSOCIATED"),children:ne.paquetesAsociados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>De(ne.vendorId,ne.vendorName,"REMAINING"),children:ne.paquetesRestantes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>De(ne.vendorId,ne.vendorName,"CASH"),children:ne.paquetesVendidos})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:wn(ne.totalVendido)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:wn(ne.comisionCash)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>De(ne.vendorId,ne.vendorName,"CREDIT"),children:ne.paquetesFiados})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:wn(ne.totalFiado)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:wn(ne.comisionCredito)})]},ne.vendorId))})]})}),i.jsx("div",{className:"md:hidden mb-6",children:i.jsxs("details",{className:"bg-white border rounded-lg shadow",children:[i.jsx("summary",{className:"cursor-pointer px-3 py-2 font-semibold",children:"Transacciones y gastos"}),i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Qt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):Qt.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ne.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ne.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ne.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>we(ne.id),children:ne.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:wn(ne.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:wn(ne.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>ue(ne.id),children:"Eliminar"})})]},ne.id))})]})}),i.jsx("h3",{className:"text-base font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"bg-white p-2 rounded border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((ne,Ve)=>ne.date.localeCompare(Ve.date)).map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ne.date}),i.jsx("td",{className:"p-2 border",children:ne.category||""}),i.jsx("td",{className:"p-2 border",children:ne.description?i.jsx("span",{title:ne.description,children:ne.description.length>40?ne.description.slice(0,40)+"":ne.description}):""}),i.jsx("td",{className:"p-2 border",children:wn(ne.amount)}),i.jsx("td",{className:"p-2 border",children:ne.status||""})]},ne.id))})]})})]})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Transacciones del periodo"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Qt.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):Qt.map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ne.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ne.customer}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:ne.type}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>we(ne.id),children:ne.paquetes})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:wn(ne.avgPrice)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:wn(ne.total)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>ue(ne.id),children:"Eliminar"})})]},ne.id))})]})}),i.jsx("h3",{className:"hidden md:block text-lg font-semibold mb-2",children:"Gastos del periodo"}),i.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Estado"})]})}),i.jsx("tbody",{children:y?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):A.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):A.sort((ne,Ve)=>ne.date.localeCompare(Ve.date)).map(ne=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ne.date}),i.jsx("td",{className:"p-2 border",children:ne.category||""}),i.jsx("td",{className:"p-2 border",children:ne.description?i.jsx("span",{title:ne.description,children:ne.description.length>40?ne.description.slice(0,40)+"":ne.description}):""}),i.jsx("td",{className:"p-2 border",children:wn(ne.amount)}),i.jsx("td",{className:"p-2 border",children:ne.status||""})]},ne.id))})]})}),w&&i.jsx("p",{className:"mt-2 text-sm",children:w}),T&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle cliente  ",(K==null?void 0:K.name)||""]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>P(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total bruto (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(Te.totalBruto)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(Te.totalDescuento)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Monto total fiado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(Te.totalFiado)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(Te.abonadoPeriodo)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),i.jsx("div",{className:"text-xl font-semibold",children:wn(Te.saldoActual)})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha compra"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"})]})}),i.jsx("tbody",{children:Ae?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):oe.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin paquetes fiados en el periodo."})}):oe.sort((ne,Ve)=>ne.date.localeCompare(Ve.date)).map((ne,Ve)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ne.date}),i.jsx("td",{className:"p-2 border",children:ne.productName}),i.jsx("td",{className:"p-2 border",children:ne.qty}),i.jsx("td",{className:"p-2 border",children:wn(ne.unitPrice)}),i.jsx("td",{className:"p-2 border",children:wn(ne.lineTotal)}),i.jsx("td",{className:"p-2 border",children:wn(ne.discount)}),i.jsx("td",{className:"p-2 border",children:wn(ne.lineFinal)})]},`${ne.saleId}-${Ve}`))})]})})]})}),O&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h3",{className:"text-lg font-bold",children:G}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>H(!1),children:"Cerrar"})]}),(Z==="ASSOCIATED"||Z==="REMAINING")&&!D&&i.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2 text-sm",children:[i.jsxs("div",{className:"text-gray-600",children:["Pgina ",U," de ",Je]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{className:"px-3 py-1 rounded border bg-white hover:bg-gray-50 disabled:opacity-50",onClick:()=>ze(ne=>Math.max(1,ne-1)),disabled:U<=1,children:"Anterior"}),i.jsx("button",{className:"px-3 py-1 rounded border bg-white hover:bg-gray-50 disabled:opacity-50",onClick:()=>ze(ne=>Math.min(Je,ne+1)),disabled:U>=Je,children:"Siguiente"})]})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha Orden"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),Z==="ASSOCIATED"||Z==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"p-2 border",children:"Costo"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]}):i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Descuento"}),i.jsx("th",{className:"p-2 border",children:"Monto final"}),Z==="ASSOCIATED"||Z==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),i.jsx("th",{className:"p-2 border",children:"Utilidad vendedor"})]}):i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:D?i.jsx("tr",{children:i.jsx("td",{colSpan:ce,className:"p-4 text-center",children:"Cargando"})}):W.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:ce,className:"p-4 text-center",children:"Sin paquetes para este vendedor en el periodo."})}):dt.map((ne,Ve)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ne.date}),i.jsx("td",{className:"p-2 border",children:ne.productName}),i.jsx("td",{className:"p-2 border",children:ne.qty}),i.jsx("td",{className:"p-2 border",children:wn(ne.unitPrice)}),Z==="ASSOCIATED"||Z==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border",children:wn(ne.costTotal??0)}),i.jsx("td",{className:"p-2 border",children:wn(ne.lineTotal)})]}):i.jsx("td",{className:"p-2 border",children:wn(ne.lineTotal)}),i.jsx("td",{className:"p-2 border",children:wn(ne.discount)}),i.jsx("td",{className:"p-2 border",children:wn(ne.lineFinal)}),Z==="ASSOCIATED"||Z==="REMAINING"?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border",children:wn(ne.grossProfit||0)}),i.jsx("td",{className:"p-2 border",children:wn(ne.vendorCommissionAmount)})]}):i.jsx("td",{className:"p-2 border",children:wn(ne.vendorCommissionAmount)})]},`${ne.saleId}-${Ve}`))})]})})]})}),J&&ke&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-4xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h3",{className:"text-lg font-bold",children:["Detalle de venta  ",ke.date]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Re(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto mb-3",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio Paq"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),i.jsx("tbody",{children:(ke.items||[]).map((ne,Ve)=>{const it=Number(ne.qty||0),vt=Number(ne.unitPrice||0),me=it*vt,Ee=ot(ke,ne);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ne.productName}),i.jsx("td",{className:"p-2 border",children:it}),i.jsx("td",{className:"p-2 border",children:wn(vt)}),i.jsx("td",{className:"p-2 border",children:wn(me)}),i.jsx("td",{className:"p-2 border",children:wn(Ee)})]},Ve)})})]})}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-semibold",children:"Total venta:"}),wn(ke.total)]}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700",onClick:()=>ue(ke.id),children:"Eliminar venta"})]})]})})]})}const hG=["Rivas","Isla Ometepe","San Jorge"];function JQe(){const{refreshKey:t,refresh:e}=Mc(),[r,n]=g.useState([]),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(!1),[d,f]=g.useState(""),[A,h]=g.useState("0"),[m,p]=g.useState("Rivas"),[x,v]=g.useState(null),[y,b]=g.useState(""),[w,j]=g.useState("0"),[I,C]=g.useState("Rivas");g.useEffect(()=>{(async()=>{s(!0),l("");try{const K=sr(bt(je,"sellers_candies"),In("name","asc")),le=await Ht(K),oe=[];le.forEach(ie=>{const Ae=ie.data();oe.push({id:ie.id,name:Ae.name||"",commissionPercent:Number(Ae.commissionPercent||0),branch:Ae.branch||"Rivas",createdAt:Ae.createdAt||xr.now()})}),n(oe)}catch(K){console.error(K),l(" Error cargando vendedores.")}finally{s(!1)}})()},[t]);const S=()=>{f(""),h("0"),p("Rivas")},E=async K=>{K.preventDefault(),l("");const le=d.trim();if(!le){l("Ingresa el nombre y apellido del vendedor.");return}const oe=Number(A||0);if(oe<0){l("El margen no puede ser negativo.");return}try{const ie={name:le,commissionPercent:oe,branch:m,createdAt:xr.now()},Ae=await Wn(bt(je,"sellers_candies"),ie);n(te=>[{id:Ae.id,...ie},...te]),l(" Vendedor creado correctamente."),S(),u(!1)}catch(ie){console.error(ie),l(" Error al crear el vendedor.")}},B=K=>{v(K.id),b(K.name),j(K.commissionPercent.toString()),C(K.branch)},k=()=>{v(null),b(""),j("0"),C("Rivas")},T=async()=>{if(!x)return;l("");const K=y.trim();if(!K){l("El nombre y apellido no pueden estar vacos.");return}const le=Number(w||0);if(le<0){l("El margen no puede ser negativo.");return}try{await kn(Xt(je,"sellers_candies",x),{name:K,commissionPercent:le,branch:I}),n(oe=>oe.map(ie=>ie.id===x?{...ie,name:K,commissionPercent:le,branch:I}:ie)),l(" Vendedor actualizado."),k()}catch(oe){console.error(oe),l(" Error al actualizar el vendedor.")}},P=async K=>{if(window.confirm(`Eliminar al vendedor "${K.name}"? Esta accin no se puede deshacer.`))try{await zn(Xt(je,"sellers_candies",K.id)),n(oe=>oe.filter(ie=>ie.id!==K.id)),l(" Vendedor eliminado.")}catch(oe){console.error(oe),l(" Error al eliminar el vendedor.")}};return i.jsxs("div",{className:"max-w-5xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Vendedores de Dulces"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Rc,{onClick:e,loading:a}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>u(!0),children:[i.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo vendedor"]})]})]}),c&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[i.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo vendedor de dulces"}),i.jsxs("form",{onSubmit:E,className:"space-y-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre y apellido"}),i.jsx("input",{className:"w-full border p-2 rounded",value:d,onChange:K=>f(K.target.value),placeholder:"Ej: Juan Prez"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Margen del vendedor (% sobre U Aproximada)"}),i.jsx("input",{type:"number",step:"0.01",min:0,className:"w-full border p-2 rounded",value:A,onChange:K=>h(K.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Este porcentaje YA NO es comisin sobre venta. Se aplica as: U. Vendedor = U. Aproximada  (margen/100). U. Inversionista = U. Aproximada  U. Vendedor."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Sucursal"}),i.jsx("select",{className:"w-full border p-2 rounded",value:m,onChange:K=>p(K.target.value),children:hG.map(K=>i.jsx("option",{value:K,children:K},K))})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:()=>{S(),u(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),i.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar vendedor"})]})]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-3",children:i.jsxs("table",{className:"min-w-[700px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Nombre y apellido"}),i.jsx("th",{className:"p-2 border",children:"Margen (% U Aproximada)"}),i.jsx("th",{className:"p-2 border",children:"Sucursal"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin vendedores registrados."})}):r.map(K=>{const le=x===K.id;return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:le?i.jsx("input",{className:"border p-1 rounded text-xs w-full",value:y,onChange:oe=>b(oe.target.value)}):K.name}),i.jsx("td",{className:"p-2 border",children:le?i.jsx("input",{type:"number",step:"0.01",min:0,className:"border p-1 rounded text-xs w-24 text-right",value:w,onChange:oe=>j(oe.target.value)}):`${K.commissionPercent.toFixed(2)} %`}),i.jsx("td",{className:"p-2 border",children:le?i.jsx("select",{className:"border p-1 rounded text-xs",value:I,onChange:oe=>C(oe.target.value),children:hG.map(oe=>i.jsx("option",{value:oe,children:oe},oe))}):K.branch}),i.jsx("td",{className:"p-2 border",children:le?i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:T,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:k,children:"Cancelar"})]}):i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600 text-xs",onClick:()=>B(K),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>P(K),children:"Borrar"})]})})]},K.id)})})]})}),o&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const la=t=>Math.max(0,Math.floor(Number(t||0)));function z2(t){return Math.max(1,la(t.unitsPerPackage||1))}function AG(t){const e=Number(t.remaining);if(Number.isFinite(e)&&e>0)return Math.floor(e);const r=Number(t.remainingPackages??t.remainingPacks??t.packagesRemaining??0);if(Number.isFinite(r)&&r>0){const l=z2(t);return Math.floor(r*l)}const n=z2(t),a=Number(t.totalUnits||0),s=Number(t.quantity||0),o=Number(t.packages||0);return a>0?Math.floor(a):s>0?Math.floor(s):o>0?Math.floor(o*n):0}async function ZQe(t){const e=String(t.vendorInventoryId||"");let r=la(t.packagesToReturn);const n=!!t.deleteVendorAfter;if(!e||r<=0)return{restoredPackages:0,mode:"noop"};const a=sr(bt(je,"inventory_transfers_candies"),Ar("toVendorRowId","==",e)),s=await Ht(a);if(s.empty)return{restoredPackages:0,mode:"noop"};const o=s.docs.map(f=>({id:f.id,...f.data()})).filter(f=>String(f.fromVendorRowId||"").trim()!=="").sort((f,A)=>{var p,x;const h=Number(((p=f.createdAt)==null?void 0:p.seconds)??0);return Number(((x=A.createdAt)==null?void 0:x.seconds)??0)-h});if(!o.length)return{restoredPackages:0,mode:"noop"};const l=[];let c=r;for(const f of o){if(c<=0)break;const A=la(f.packagesMoved||0);if(A<=0)continue;const h=Math.min(c,A);h<=0||(l.push({fromVendorRowId:String(f.fromVendorRowId),packs:h}),c-=h)}if(!l.length)return{restoredPackages:0,mode:"noop"};const u=Xt(je,"inventory_candies_sellers",e),d=l.map(f=>Xt(je,"inventory_candies_sellers",f.fromVendorRowId));return await qs(je,async f=>{const A=await Promise.all(d.map(h=>f.get(h)));for(let h=0;h<l.length;h++){const m=d[h],p=A[h];if(!p.exists())continue;const x=p.data(),v=la(l[h].packs||0);if(v<=0)continue;const y=Math.max(1,la(x.unitsPerPackage||1)),b=v*y,w=Number(x.remainingPackages||0),j=Number(x.packages||0);f.update(m,{packages:Math.max(0,j+v),remainingPackages:Math.max(0,w+v),...y>0?{remainingUnits:Number(x.remainingUnits||0)+b}:{},transferDelta:Number(x.transferDelta||0)+v,updatedAt:xr.now()})}n&&f.delete(u)}),{restoredPackages:r-c,mode:"transfer"}}async function bF(t){const{orderId:e,productId:r}=t;let n=la(t.packagesToReturn);if(!e||!r||n<=0)return;const a=sr(bt(je,"inventory_candies"),Ar("orderId","==",e),Ar("productId","==",r),In("createdAt","asc")),s=await Ht(a);if(s.empty)return;const o=s.docs.map(l=>l.ref);await qs(je,async l=>{const c=await Promise.all(o.map(u=>l.get(u)));for(let u=0;u<o.length&&n>0;u++){const d=c[u];if(!d.exists())continue;const f=d.data(),A=z2(f),h=n*A,p=la(f.remaining??0)+h,x=Math.floor(p/A);l.update(o[u],{remaining:p,remainingPackages:x,packages:x,updatedAt:xr.now()}),n=0}})}async function wF(t){const{orderId:e,productId:r}=t,n=la(t.packagesToReturn);if(!e||!r||n<=0)return;const a=Xt(je,"candy_main_orders",e);await qs(je,async s=>{const o=await s.get(a);if(!o.exists())return;const l=o.data(),c=Array.isArray(l.items)?l.items:[];let u=!1;const d=c.map(f=>String((f==null?void 0:f.id)||"")!==String(r)?f:(u=!0,{...f,remainingPackages:la(f.remainingPackages)+n}));u&&s.update(a,{items:d,updatedAt:xr.now()})})}function NF(t){if(!Array.isArray(t))return[];const e=[];for(const r of t){const n=String((r==null?void 0:r.batchId)||""),a=String((r==null?void 0:r.masterOrderId)||(r==null?void 0:r.orderId)||""),s=la((r==null?void 0:r.units)??(r==null?void 0:r.qty)??(r==null?void 0:r.quantity)??0),o=Math.max(1,la((r==null?void 0:r.unitsPerPackage)||1));!n||!a||s<=0||e.push({batchId:n,masterOrderId:a,units:s,unitsPerPackage:o})}return e}function W2(t,e){const r=la(t),n=Math.max(1,la(e));return Math.floor(r/n)}async function mG(t){const e=String(t.productId||"");let r=la(t.packagesToAllocate);if(!e||r<=0)return{allocations:[]};const n=sr(bt(je,"inventory_candies"),Ar("productId","==",e)),a=await Ht(n);if(a.empty)throw new Error("No hay inventario para este producto.");const o=a.docs.map(c=>({id:c.id,data:c.data()})).sort((c,u)=>{var m,p;const d=String(c.data.date||""),f=String(u.data.date||"");if(d!==f)return d<f?-1:1;const A=((m=c.data.createdAt)==null?void 0:m.seconds)??0,h=((p=u.data.createdAt)==null?void 0:p.seconds)??0;return A-h}).map(c=>Xt(je,"inventory_candies",c.id)),l=[];return await qs(je,async c=>{const u=await Promise.all(o.map(y=>c.get(y))),d=[];let f=r;for(let y=0;y<o.length&&f>0;y++){const b=o[y],w=u[y];if(!w.exists())continue;const j=w.data(),I=z2(j),C=AG(j);if(C<=0)continue;const S=Math.floor(C/I);if(S<=0)continue;const E=Math.min(S,f),B=E*I,k=Math.max(0,C-B),T=Math.floor(k/I),P=String(j.orderId||"");if(!P)throw new Error("Lote sin orderId (orden maestra).");l.push({batchId:b.id,masterOrderId:P,units:B,unitsPerPackage:I}),d.push({ref:b,newRemUnits:k,newRemPacks:T}),f-=E}if(f>0)throw new Error(`Inventario insuficiente. Faltan ${f} paquetes.`);const A={};for(const y of l){const b=W2(y.units,y.unitsPerPackage);A[y.masterOrderId]=(A[y.masterOrderId]||0)+b}const h=new Map;for(let y=0;y<d.length;y++){const b=d[y];h.set(b.ref.id,b.newRemUnits)}const m={};for(let y=0;y<o.length;y++){const b=o[y],w=u[y];if(!w.exists())continue;const j=w.data(),I=String(j.orderId||""),C=String(j.productId||"");if(!I||!C)continue;const S=z2(j),E=h.get(b.id),B=typeof E=="number"?E:AG(j),k=Math.floor(B/S);m[I]||(m[I]={}),m[I][C]=(m[I][C]||0)+Math.max(0,k)}const p=Object.keys(A),x=p.map(y=>Xt(je,"candy_main_orders",y)),v=await Promise.all(x.map(y=>c.get(y)));for(let y=0;y<d.length;y++){const b=d[y];c.update(b.ref,{remaining:b.newRemUnits,remainingPackages:b.newRemPacks,packages:b.newRemPacks,updatedAt:xr.now()})}for(let y=0;y<x.length;y++){const b=v[y];if(!b.exists())throw new Error("Orden maestra no existe.");const w=b.data(),j=Array.isArray(w.items)?w.items:[],I=p[y];if(la(A[I]||0)<=0)continue;let S=!1;const E=j.map(B=>{var T;if(String((B==null?void 0:B.id)||"")!==e)return B;S=!0;const k=((T=m[I])==null?void 0:T[e])??la(B.remainingPackages||0);return{...B,remainingPackages:Math.max(0,la(k||0))}});S&&c.update(x[y],{items:E,updatedAt:xr.now()})}}),{allocations:l}}async function eVe(t){const e=String(t.vendorInventoryId||"");let r=la(t.packagesToReturn);if(!e)throw new Error("vendorInventoryId requerido");if(r<=0)return{restoredPackages:0,mode:"noop"};const n=Xt(je,"inventory_candies_sellers",e),a=await Cs(n);if(!a.exists())throw new Error("No existe la orden del vendedor");const s=a.data(),o=String(s.productId||"");if(!o)throw new Error("La orden del vendedor no tiene productId");if(!NF(s.masterAllocations||s.allocations||s.allocationsByBatch).length){const u=String(s.orderId||"");if(!u)throw new Error("La orden del vendedor no tiene orderId");return await bF({orderId:u,productId:o,packagesToReturn:r}),await wF({orderId:u,productId:o,packagesToReturn:r}),{restoredPackages:r,mode:"legacy"}}let c=0;return await qs(je,async u=>{const d=await u.get(n);if(!d.exists())throw new Error("No existe la orden del vendedor");const f=d.data(),A=String(f.productId||"");if(!A)throw new Error("Doc vendedor sin productId");let h=NF(f.masterAllocations||f.allocations||f.allocationsByBatch);if(!h.length)throw new Error("No hay masterAllocations guardadas en este doc (no se puede restaurar blindado).");const m=[];let p=r;for(let E=h.length-1;E>=0&&p>0;E--){const B=h[E],k=Math.max(1,la(B.unitsPerPackage||1)),T=W2(B.units,k);if(T<=0)continue;const P=Math.min(T,p),K=P*k;m.push({batchId:B.batchId,masterOrderId:B.masterOrderId,units:K,unitsPerPackage:k}),p-=P}const x=r-p;if(x<=0)return;c=x;const v=m.map(E=>Xt(je,"inventory_candies",E.batchId)),y={};for(const E of m){const B=W2(E.units,E.unitsPerPackage);B>0&&(y[E.masterOrderId]=(y[E.masterOrderId]||0)+B)}const w=Object.keys(y).map(E=>Xt(je,"candy_main_orders",E)),[j,I]=await Promise.all([Promise.all(v.map(E=>u.get(E))),Promise.all(w.map(E=>u.get(E)))]);for(let E=0;E<m.length;E++){const B=m[E],k=j[E];if(!k.exists())continue;const T=k.data(),P=Math.max(1,la(B.unitsPerPackage||T.unitsPerPackage||1)),K=la(B.units),oe=la(T.remaining??0)+K,ie=Math.floor(oe/P);u.update(v[E],{remaining:oe,remainingPackages:ie,packages:ie,updatedAt:xr.now()})}for(let E=0;E<w.length;E++){const B=I[E];if(!B.exists())continue;const k=w[E].id,T=la(y[k]||0);if(T<=0)continue;const P=B.data(),K=Array.isArray(P.items)?P.items:[];let le=!1;const oe=K.map(ie=>String((ie==null?void 0:ie.id)||"")!==String(A)?ie:(le=!0,{...ie,remainingPackages:la(ie.remainingPackages)+T}));le&&u.update(w[E],{items:oe,updatedAt:xr.now()})}const C=new Map;for(const E of m){const B=`${E.batchId}__${E.masterOrderId}__${E.unitsPerPackage}`;C.set(B,(C.get(B)||0)+la(E.units))}const S=[];for(const E of h){const B=Math.max(1,la(E.unitsPerPackage||1)),k=`${E.batchId}__${E.masterOrderId}__${B}`,T=la(C.get(k)||0);if(T<=0){S.push(E);continue}const K=la(E.units)-T;K>0&&S.push({...E,units:K,unitsPerPackage:B}),C.delete(k)}u.update(n,{masterAllocations:S,updatedAt:xr.now()})}),{restoredPackages:c,mode:"blind"}}async function pG(t){if(!t)throw new Error("vendorInventoryId requerido");const e=Xt(je,"inventory_candies_sellers",t),r=await Cs(e);if(!r.exists())throw new Error("No existe la orden del vendedor");const n=r.data(),a=String(n.productId||""),s=la(n.remainingPackages||n.packages||0),o=la(n.packages||n.remainingPackages||0),l=NF(n.masterAllocations||n.allocations||n.allocationsByBatch),c=await ZQe({vendorInventoryId:t,packagesToReturn:s,deleteVendorAfter:!1});if(!l.length){const d=String(n.orderId||"");if(!d)throw new Error("La orden del vendedor no tiene orderId");if(!a)throw new Error("La orden del vendedor no tiene productId");if(c.restoredPackages>0){const f=Math.max(0,s-c.restoredPackages);return f<=0?(await qs(je,async A=>{A.delete(e)}),{restoredPackages:c.restoredPackages,mode:"transfer"}):(await bF({orderId:d,productId:a,packagesToReturn:f}),await wF({orderId:d,productId:a,packagesToReturn:f}),await qs(je,async A=>{A.delete(e)}),{restoredPackages:c.restoredPackages+f,mode:"transfer+legacy"})}return o<=0?(await qs(je,async f=>{f.delete(e)}),{restoredPackages:0,mode:"legacy"}):(await bF({orderId:d,productId:a,packagesToReturn:o}),await wF({orderId:d,productId:a,packagesToReturn:o}),await qs(je,async f=>{f.delete(e)}),{restoredPackages:o,mode:"legacy"})}let u=0;return await qs(je,async d=>{const f={};for(const y of l){const b=Math.max(1,la(y.unitsPerPackage||1)),w=la(y.units),j=W2(w,b);j>0&&(f[y.masterOrderId]=(f[y.masterOrderId]||0)+j)}const A=l.map(y=>Xt(je,"inventory_candies",y.batchId)),m=Object.keys(f).map(y=>Xt(je,"candy_main_orders",y)),[p,x]=await Promise.all([Promise.all(A.map(y=>d.get(y))),Promise.all(m.map(y=>d.get(y)))]);let v=0;for(let y=0;y<l.length;y++){const b=l[y],w=p[y];if(!w.exists())continue;const j=w.data(),I=Math.max(1,la(b.unitsPerPackage||j.unitsPerPackage||1)),C=la(b.units),E=la(j.remaining??0)+C,B=Math.floor(E/I);d.update(A[y],{remaining:E,remainingPackages:B,packages:B,updatedAt:xr.now()});const k=W2(C,I);k>0&&(v+=k)}for(let y=0;y<m.length;y++){const b=x[y];if(!b.exists())continue;const w=m[y].id,j=la(f[w]||0);if(j<=0)continue;const I=b.data(),C=Array.isArray(I.items)?I.items:[];let S=!1;const E=C.map(B=>String((B==null?void 0:B.id)||"")!==String(a)?B:(S=!0,{...B,remainingPackages:la(B.remainingPackages)+j}));S&&d.update(m[y],{items:E,updatedAt:xr.now()})}d.delete(e),u=v}),{restoredPackages:u,mode:"blind"}}const oT=t=>`C$ ${(Number(t)||0).toFixed(2)}`,Vse=(t,e)=>`${t}__${e}`,tVe=t=>t?typeof t=="string"?t:t!=null&&t.seconds?new Date(t.seconds*1e3).toISOString().slice(0,10):t!=null&&t.toDate?t.toDate().toISOString().slice(0,10):"":"",rVe=t=>{const e=t.sellerId||"",r=tVe(t.date);return e&&r?Vse(e,r):t.orderId?t.orderId:t.id},gG=(t,e=!1)=>{if(!t)return null;const r=new Date(t);return Number.isNaN(r.getTime())?null:(e?r.setHours(23,59,59,999):r.setHours(0,0,0,0),r)},nVe=t=>{var e,r;if((e=t.createdAt)!=null&&e.toDate)return t.createdAt.toDate();if((r=t.createdAt)!=null&&r.seconds)return new Date(t.createdAt.seconds*1e3);if(t.date){const n=new Date(t.date);if(!Number.isNaN(n.getTime()))return n}return null},xG=t=>{const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"},CF=t=>{const e=Number(t||0);return!isFinite(e)||e<0?0:e},vG=(t,e)=>{const r=CF(e),n=Number(t||0)*(r/100),a=Number(t||0)-n;return{vendorMarginPercent:r,uVendor:n,uInvestor:a}},yG=(t,e)=>e?e==="RIVAS"?t.unitPriceRivas||0:e==="SAN_JORGE"?t.unitPriceSanJorge||0:t.unitPriceIsla||0:t.unitPriceIsla||0,bG=(t,e)=>e?e==="RIVAS"?t.grossProfitPerPackRivas||0:e==="SAN_JORGE"?t.grossProfitPerPackSanJorge||0:t.grossProfitPerPackIsla||0:t.grossProfitPerPackIsla||0,wG=(t,e)=>e?e==="RIVAS"?t.uApproxPerPackRivas||0:e==="SAN_JORGE"?t.uApproxPerPackSanJorge||0:t.uApproxPerPackIsla||0:t.uApproxPerPackIsla||0;function aVe({open:t,onClose:e,orders:r,rows:n,setRows:a,isAdmin:s,currentUserEmail:o,currentUserName:l,sellerCandyId:c,sellers:u,products:d,transferAgg:f,setTransferAgg:A,setTransferRowDeltas:h}){const[m,p]=g.useState(!1),[x,v]=g.useState([]),[y,b]=g.useState(""),[w,j]=g.useState(""),[I,C]=g.useState(""),[S,E]=g.useState(""),[B,k]=g.useState("0"),[T,P]=g.useState(""),[K,le]=g.useState(!1),[oe,ie]=g.useState(""),[Ae,te]=g.useState(!1),[Te,Ue]=g.useState(""),[O,H]=g.useState(()=>new Date().toISOString().slice(0,10)),[G,L]=g.useState(""),[W,X]=g.useState(()=>{const De=new Date;return new Date(De.getFullYear(),De.getMonth(),1).toISOString().slice(0,10)}),[D,Q]=g.useState(()=>new Date().toISOString().slice(0,10)),Z=g.useMemo(()=>{const De={};return u.forEach(Je=>{De[Je.id]=Je}),De},[u]),be=g.useMemo(()=>{const De={};return d.forEach(Je=>{De[Je.id]=Je}),De},[d]),U=Te&&Z[Te]||null,ze=g.useMemo(()=>r.map(De=>De.orderKey),[r]),re=g.useMemo(()=>{const De={};return r.forEach(Je=>De[Je.orderKey]=Je),De},[r]),J=n,Re=g.useMemo(()=>{const De={};return J.forEach(Je=>{const dt=rVe(Je),ce=new Set;dt&&ce.add(dt),Je.orderId&&ce.add(String(Je.orderId)),ce.add(Je.id),ce.forEach(we=>{De[we]||(De[we]=[]),De[we].push(Je)})}),De},[J]),ke=g.useMemo(()=>y?Re[y]||[]:[],[Re,y]),Be=g.useMemo(()=>ke.filter(De=>{const Je=De.remainingPackages??De.remaining??De.packages??0;return Number(Je||0)>0}),[ke]),Ye=g.useMemo(()=>{const De=G.trim().toLowerCase();return De?Be.filter(Je=>`${Je.category||""} ${Je.productName||""}`.toLowerCase().trim().includes(De)):Be},[Be,G]),ot=g.useMemo(()=>w&&J.find(De=>De.id===w)||null,[J,w]),Ct=g.useMemo(()=>{if(ot!=null&&ot.sellerId)return ot.sellerId;const De=re[y];return(De==null?void 0:De.sellerId)||""},[ot,re,y]),jt=g.useMemo(()=>I?Re[I]||[]:[],[Re,I]),Ot=g.useMemo(()=>ot?jt.filter(De=>De.productId===ot.productId):[],[jt,ot]),Tt=async()=>{try{p(!0);let De=[];if(!s&&c){const Je=sr(bt(je,"inventory_transfers_candies"),Ar("fromSellerId","==",c),In("createdAt","desc")),dt=sr(bt(je,"inventory_transfers_candies"),Ar("toSellerId","==",c),In("createdAt","desc")),[ce,we]=await Promise.all([Ht(Je),Ht(dt)]),ue=new Set,ne=Ve=>{Ve.forEach(it=>{if(ue.has(it.id))return;ue.add(it.id);const vt=it.data();De.push({id:it.id,...vt})})};ne(ce),ne(we),De.sort((Ve,it)=>{var Ee,ye;const vt=((Ee=Ve.createdAt)==null?void 0:Ee.seconds)||0;return(((ye=it.createdAt)==null?void 0:ye.seconds)||0)-vt})}else{const Je=sr(bt(je,"inventory_transfers_candies"),In("createdAt","desc"));(await Ht(Je)).forEach(ce=>{const we=ce.data();De.push({id:ce.id,...we})})}v(De)}catch{ie(" Error cargando traslados.")}finally{p(!1)}};g.useEffect(()=>{t&&Tt()},[t]);const Qt=g.useMemo(()=>{const De=gG(W),Je=gG(D,!0);return x.filter(dt=>{const ce=nVe(dt);return ce?!(De&&ce<De||Je&&ce>Je):!0})},[x,W,D]);g.useEffect(()=>{L("")},[y]),g.useEffect(()=>{if(Ae){if(!Te){const De=re[y];De!=null&&De.sellerId&&Ue(De.sellerId)}O||H(new Date().toISOString().slice(0,10))}},[Ae,Te,O,re,y]);const Ft=()=>{b(""),j(""),C(""),E(""),k("0"),P(""),te(!1),Ue(""),H(new Date().toISOString().slice(0,10))},Qe=async()=>{if(!s){ie("No tienes permiso para hacer traslados.");return}ie("");const De=Number(B||0);if(!(De>0)){ie("La cantidad de paquetes debe ser mayor a 0.");return}if(!T.trim()){ie("Debes escribir el motivo de la movida.");return}if(!y||!w){ie("Selecciona el pedido origen y el producto.");return}const Je=Ae;if(!Je&&!I){ie("Selecciona el pedido destino.");return}if(Je){if(!Te){ie("Selecciona el vendedor de la nueva orden.");return}if(!O){ie("Selecciona la fecha de la nueva orden.");return}}const dt=!Je&&I&&re[I]||null;if(!Je&&!dt){ie("Selecciona un pedido destino vlido.");return}const ce=dt?Z[dt.sellerId]||{id:dt.sellerId||"",name:dt.sellerName||"",email:dt.sellerEmail||"",branch:dt.branch,branchLabel:dt.branchLabel,commissionPercent:dt.vendorMarginPercent??dt.commissionPercent??0}:null,we=n.find(ge=>ge.id===w)||null,ue=!Je&&S&&n.find(ge=>ge.id===S)||null;if(!we){ie("No se encontr la fila origen/destino.");return}if(!Je&&ue&&w===S){ie("Origen y destino no pueden ser el mismo.");return}if(!Je&&ue&&we.productId!==ue.productId){ie("El producto destino no coincide con el producto origen.");return}if(Number(we.remainingPackages||0)<De){ie("El origen no tiene suficientes paquetes disponibles.");return}const ne=Je?U:null;if(Je&&!ne){ie("Selecciona un vendedor destino vlido.");return}const Ve=be[we.productId]||null,it=Je?xG((ne==null?void 0:ne.branch)||(ne==null?void 0:ne.branchLabel)):void 0,vt=!Je&&!S&&!!dt,me=Je||vt;let Ee=null,ye=null,We="";if(Je&&ne){const ge=CF(ne.commissionPercent??0),Ie=it,xt=Number((Ve==null?void 0:Ve.unitsPerPackage)??we.unitsPerPackage??0),Pt=xt>0?xt*De:0;Ve?yG(Ve,Ie):Number(we.unitPriceRivas||we.unitPriceIsla||0);const Ut=(Ve?bG(Ve,Ie):Number(we.grossProfit||0)/Math.max(1,we.packages||1))*De,$t=Ve?Number(Ve.logisticAllocatedPerPack||0)*De:Number(we.logisticAllocated||0),Ce=(Ve?wG(Ve,Ie):Number(we.uAproximada||0)/Math.max(1,we.packages||1))*De,pe=vG(Ut,ge),He=Number(Ut||0)-Number($t||0)-Number(pe.uVendor||0),he=((Ve==null?void 0:Ve.unitPriceRivas)||we.unitPriceRivas||0)*De,ee=((Ve==null?void 0:Ve.unitPriceSanJorge)||we.unitPriceSanJorge||0)*De,_e=((Ve==null?void 0:Ve.unitPriceIsla)||we.unitPriceIsla||0)*De;We=Vse(ne.id,O),Ee={sellerId:ne.id,sellerName:ne.name,sellerEmail:ne.email||"",branch:Ie||"",branchLabel:ne.branchLabel||"",productId:we.productId,productName:we.productName,category:we.category,orderId:We,date:O,packages:De,unitsPerPackage:xt,totalUnits:Pt,remainingPackages:De,remainingUnits:Pt,totalRivas:he,totalSanJorge:ee,totalIsla:_e,unitPriceRivas:(Ve==null?void 0:Ve.unitPriceRivas)||we.unitPriceRivas||0,unitPriceSanJorge:(Ve==null?void 0:Ve.unitPriceSanJorge)||we.unitPriceSanJorge||0,unitPriceIsla:(Ve==null?void 0:Ve.unitPriceIsla)||we.unitPriceIsla||0,grossProfit:Ut,logisticAllocated:$t,vendorMarginPercent:pe.vendorMarginPercent,uVendor:pe.uVendor,uInvestor:pe.uInvestor,uAproximada:Ce,uNeta:He,providerPrice:we.providerPrice,transferDelta:0}}if(vt&&dt){const ge=CF((ce==null?void 0:ce.commissionPercent)??dt.vendorMarginPercent??0),Ie=xG((ce==null?void 0:ce.branch)||(ce==null?void 0:ce.branchLabel)||dt.branch||dt.branchLabel),xt=Number((Ve==null?void 0:Ve.unitsPerPackage)??we.unitsPerPackage??0),Pt=xt>0?xt*De:0;Ve?yG(Ve,Ie):Number(we.unitPriceRivas||we.unitPriceIsla||0);const Ut=(Ve?bG(Ve,Ie):Number(we.grossProfit||0)/Math.max(1,we.packages||1))*De,$t=Ve?Number(Ve.logisticAllocatedPerPack||0)*De:Number(we.logisticAllocated||0),Ce=(Ve?wG(Ve,Ie):Number(we.uAproximada||0)/Math.max(1,we.packages||1))*De,pe=vG(Ut,ge),He=Number(Ut||0)-Number($t||0)-Number(pe.uVendor||0),he=((Ve==null?void 0:Ve.unitPriceRivas)||we.unitPriceRivas||0)*De,ee=((Ve==null?void 0:Ve.unitPriceSanJorge)||we.unitPriceSanJorge||0)*De,_e=((Ve==null?void 0:Ve.unitPriceIsla)||we.unitPriceIsla||0)*De;ye={sellerId:dt.sellerId,sellerName:(ce==null?void 0:ce.name)||dt.sellerName||"",sellerEmail:(ce==null?void 0:ce.email)||dt.sellerEmail||"",branch:Ie||dt.branch||"",branchLabel:(ce==null?void 0:ce.branchLabel)||dt.branchLabel||"",productId:we.productId,productName:we.productName,category:we.category,orderId:dt.orderKey||I,date:dt.date||new Date().toISOString().slice(0,10),packages:De,unitsPerPackage:xt,totalUnits:Pt,remainingPackages:De,remainingUnits:Pt,totalRivas:he,totalSanJorge:ee,totalIsla:_e,unitPriceRivas:(Ve==null?void 0:Ve.unitPriceRivas)||we.unitPriceRivas||0,unitPriceSanJorge:(Ve==null?void 0:Ve.unitPriceSanJorge)||we.unitPriceSanJorge||0,unitPriceIsla:(Ve==null?void 0:Ve.unitPriceIsla)||we.unitPriceIsla||0,grossProfit:Ut,logisticAllocated:$t,vendorMarginPercent:pe.vendorMarginPercent,uVendor:pe.uVendor,uInvestor:pe.uInvestor,uAproximada:Ce,uNeta:He,providerPrice:we.providerPrice,transferDelta:0}}try{le(!0);const ge=Xt(je,"inventory_candies_sellers",we.id),Ie=Je||vt?Xt(bt(je,"inventory_candies_sellers")):Xt(je,"inventory_candies_sellers",ue.id),xt=xr.now(),Pt=new Date().toISOString().slice(0,10);let It=null;await qs(je,async Ut=>{const $t=await Ut.get(ge);if(!$t.exists())throw new Error("Orden origen no existe.");const Le=$t.data(),Ce=Number(Le.remainingPackages||0);if(Ce<De)throw new Error("Origen no tiene suficientes paquetes.");let pe=null;if(!Je&&!vt){const V=await Ut.get(Ie);if(!V.exists())throw new Error("Orden destino no existe.");pe=V.data()}const He=Number(Le.unitsPerPackage||we.unitsPerPackage||0),he=He>0?De*He:0,ee=Number(Le.transferDelta||0);Ut.update(ge,{packages:Math.max(0,Number(Le.packages||0)-De),remainingPackages:Ce-De,...He>0?{remainingUnits:Number(Le.remainingUnits||0)-he}:{},updatedAt:xt,transferDelta:ee-De});let _e=null;if(Je){const V={...Ee,createdAt:xt,updatedAt:xt,remainingPackages:De,remainingUnits:Number((Ee==null?void 0:Ee.unitsPerPackage)||0)>0?De*Number((Ee==null?void 0:Ee.unitsPerPackage)||0):Ee==null?void 0:Ee.remainingUnits,transferDelta:0};Ut.set(Ie,V),_e=V,It={id:Ie.id,...V}}else if(vt&&ye){const V={...ye,createdAt:xt,updatedAt:xt,remainingPackages:De,remainingUnits:Number(ye.unitsPerPackage||0)>0?De*Number(ye.unitsPerPackage||0):ye.remainingUnits,transferDelta:0};Ut.set(Ie,V),_e=V,It={id:Ie.id,...V}}else{const V=pe,q=Number(V.unitsPerPackage||we.unitsPerPackage||0),se=q>0?De*q:0,Ne=Number(V.transferDelta||0);Ut.update(Ie,{packages:Math.max(0,Number(V.packages||0)+De),remainingPackages:Number(V.remainingPackages||0)+De,...q>0?{remainingUnits:Number(V.remainingUnits||0)+se}:{},updatedAt:xt,transferDelta:Ne+De}),_e={...V,remainingPackages:Number(V.remainingPackages||0)+De,remainingUnits:q>0?Number(V.remainingUnits||0)+se:V.remainingUnits,sellerId:V.sellerId,sellerName:V.sellerName,orderId:V.orderId||(ue==null?void 0:ue.id)||"",transferDelta:Ne+De}}const R=Xt(bt(je,"inventory_transfers_candies"));Ut.set(R,{createdAt:xt,date:Pt,createdByEmail:(o||"").trim(),createdByName:String(l||"").trim(),productId:String(Le.productId||""),productName:String(Le.productName||""),packagesMoved:De,providerPrice:Number(Le.providerPrice||0),unitPriceRivas:Number(Le.unitPriceRivas||0),unitPriceIsla:Number(Le.unitPriceIsla||0),fromSellerId:String(Le.sellerId||""),fromSellerName:String(Le.sellerName||""),fromOrderKey:String(Le.orderId||we.id||""),fromOrderLabel:String(Le.orderId||we.id||""),toSellerId:Je?(ne==null?void 0:ne.id)||"":String((_e==null?void 0:_e.sellerId)||""),toSellerName:Je?(ne==null?void 0:ne.name)||"":String((_e==null?void 0:_e.sellerName)||""),toOrderKey:Je?We:String((_e==null?void 0:_e.orderId)||I||""),toOrderLabel:Je?We:String((_e==null?void 0:_e.orderId)||I||""),fromVendorRowId:we.id,toVendorRowId:Je||vt?Ie.id:ue.id,comment:T.trim(),destRowWasNew:me})}),a(Ut=>{const $t=Ut.reduce((Le,Ce)=>{if(Ce.id===we.id){const pe=Number(Ce.unitsPerPackage||0),He=pe>0?De*pe:0;return Le.push({...Ce,packages:Math.max(0,Number(Ce.packages||0)-De),remainingPackages:Number(Ce.remainingPackages||0)-De,remainingUnits:pe>0?Number(Ce.remainingUnits||0)-He:Ce.remainingUnits,transferDelta:Number(Ce.transferDelta||0)-De}),Le}if(!Je&&ue&&Ce.id===ue.id){const pe=Number(Ce.unitsPerPackage||0),He=pe>0?De*pe:0;return Le.push({...Ce,packages:Math.max(0,Number(Ce.packages||0)+De),remainingPackages:Number(Ce.remainingPackages||0)+De,remainingUnits:pe>0?Number(Ce.remainingUnits||0)+He:Ce.remainingUnits,transferDelta:Number(Ce.transferDelta||0)+De}),Le}return Le.push(Ce),Le},[]);return It?[...$t,It]:$t}),await Tt(),A(Ut=>{const $t={...Ut},Le=y,Ce=Je?We:I;return Le&&($t[Le]=$t[Le]||{out:0,in:0},$t[Le].out+=De),Ce&&($t[Ce]=$t[Ce]||{out:0,in:0},$t[Ce].in+=De),$t}),h(Ut=>{const $t={...Ut};if(we.id&&($t[we.id]=($t[we.id]||0)-De),!me){const Le=vt||Je?It==null?void 0:It.id:ue==null?void 0:ue.id;Le&&($t[Le]=($t[Le]||0)+De)}return $t}),Ft(),ie(" Traslado realizado.")}catch(ge){ie((ge==null?void 0:ge.message)||" Error realizando el traslado.")}finally{le(!1)}};return t?i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[55]",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-7xl max-h-[90vh] overflow-y-auto text-sm relative",children:[K&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"bg-white border rounded-lg px-4 py-3 shadow text-sm font-semibold",children:"Guardando traslado..."})}),i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Traslado de paquetes"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{e(),Ft()},type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[i.jsx("div",{className:"text-sm font-semibold mb-2",children:"Crear traslado (requiere motivo)"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido origen"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:y,onChange:De=>{b(De.target.value),j(""),C(""),E(""),k("0")},disabled:!s,children:[i.jsx("option",{value:"",children:"Selecciona"}),ze.map(De=>{const Je=re[De];return i.jsxs("option",{value:De,children:["Vendedor: ",(Je==null?void 0:Je.sellerName)||"","  Existencias:"," ",(Je==null?void 0:Je.totalRemainingPackages)||"0"," Paquetes - Fecha Orden:"," ",(Je==null?void 0:Je.date)||""]},De)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (desde el pedido origen)"}),i.jsx("input",{type:"text",className:"mt-1 mb-2 w-full border p-2 rounded text-sm",placeholder:"Buscar producto...",value:G,onChange:De=>L(De.target.value),disabled:!s||!y}),i.jsxs("select",{className:"w-full border p-2 rounded",value:w,onChange:De=>{j(De.target.value),C(""),E(""),k("0")},disabled:!s||!y,children:[i.jsx("option",{value:"",children:"Selecciona"}),Ye.map(De=>i.jsxs("option",{value:De.id,children:[De.productName,"  Existencias:"," ",Number(De.remainingPackages??De.packages??0)," Paquetes - Precio Costo: $",De.providerPrice]},De.id))]})]}),!Ae&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Pedido destino"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:I,onChange:De=>{C(De.target.value),E("")},disabled:!s||!w,children:[i.jsx("option",{value:"",children:"Selecciona"}),ze.filter(De=>De!==y).map(De=>{const Je=re[De];return i.jsxs("option",{value:De,children:["Vendedor: ",(Je==null?void 0:Je.sellerName)||"","  Existencias:"," ",(Je==null?void 0:Je.totalRemainingPackages)||"0"," - Fecha Orden:"," ",(Je==null?void 0:Je.date)||""]},De)})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto destino (mismo producto)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:S,onChange:De=>E(De.target.value),disabled:!s||!I||!ot,children:[i.jsx("option",{value:"",children:"Selecciona"}),Ot.map(De=>i.jsxs("option",{value:De.id,children:["Tipo: ",De.category," - ",De.productName,"  Existencias:"," ",Number(De.remainingPackages??De.packages??0),"Paquetes - Precio Costo: $",De.providerPrice]},De.id))]}),I&&ot&&Ot.length===0&&i.jsx("div",{className:"text-xs text-red-600 mt-1",children:" El pedido destino no tiene este producto. Si dejas este campo vaco se crear automticamente al moverlo."}),I&&i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este campo es opcional; salo solo si el pedido ya tiene el producto y quieres sumar a esa fila."})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:Ae,onChange:De=>{const Je=De.target.checked;te(Je),Je&&(C(""),E(""))},disabled:!s}),i.jsx("span",{className:"text-sm font-semibold",children:"Crear nueva orden destino (independiente)"})]}),Ae&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor destino (nueva orden)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:Te,onChange:De=>Ue(De.target.value),disabled:!s,children:[i.jsx("option",{value:"",children:"Selecciona"}),u.map(De=>i.jsxs("option",{value:De.id,disabled:De.id===Ct,children:[De.name,De.id===Ct?" (origen)":""]},De.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de la nueva orden"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:O,onChange:De=>H(De.target.value),disabled:!s}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Esta orden ser independiente. Asegrate de usar una fecha que no tenga otro pedido activo para el mismo vendedor."})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad paquetes a mover"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:B,onChange:De=>k(De.target.value),disabled:!s||!w||!Ae&&!I})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Motivo de movida (obligatorio)"}),i.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:T,onChange:De=>P(De.target.value),disabled:!s,placeholder:"Ej: Se cambi de ruta por reorganizacin",maxLength:250})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",onClick:Ft,disabled:!s||K,children:"Limpiar"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60",onClick:Qe,disabled:!s||K||!w||!Ae&&!I||Number(B||0)<=0||!T.trim(),children:"Hacer traslado"})]}),oe&&i.jsx("div",{className:"text-sm text-red-600 mt-2",children:oe})]}),i.jsxs("div",{className:"bg-white rounded border overflow-x-auto",children:[i.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between p-2",children:[i.jsx("div",{className:"text-lg font-semibold",children:"Historial de traslados"}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:W,onChange:De=>X(De.target.value)}),i.jsx("span",{className:"text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:D,onChange:De=>Q(De.target.value)}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Tt,disabled:m,type:"button",children:m?"Cargando...":"Recargar"})]})]}),i.jsxs("table",{className:"min-w-[1400px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha y hora"}),i.jsx("th",{className:"p-2 border",children:"Usuario"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Cantidad paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio Rivas"}),i.jsx("th",{className:"p-2 border",children:"Precio Isla"}),i.jsx("th",{className:"p-2 border",children:"Desde vendedor"}),i.jsx("th",{className:"p-2 border",children:"Desde orden"}),i.jsx("th",{className:"p-2 border",children:"Hacia vendedor"}),i.jsx("th",{className:"p-2 border",children:"Hacia orden"}),i.jsx("th",{className:"p-2 border",children:"Motivo de movida"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):Qt.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin traslados"})}):Qt.map(De=>{var we,ue;const Je=((ue=(we=De.createdAt)==null?void 0:we.toDate)==null?void 0:ue.call(we))||(De.createdAt?new Date(De.createdAt.seconds*1e3):null),dt=Je?`${Je.toISOString().slice(0,10)} ${Je.toISOString().slice(11,19)}`:De.date||"",ce=(De.createdByName||"").trim()||(De.createdByEmail||"").trim()||"";return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:dt}),i.jsx("td",{className:"p-2 border",children:ce}),i.jsx("td",{className:"p-2 border text-left",children:De.productName||""}),i.jsx("td",{className:"p-2 border",children:Number(De.packagesMoved||0)}),i.jsx("td",{className:"p-2 border",children:oT(De.providerPrice||0)}),i.jsx("td",{className:"p-2 border",children:oT(De.unitPriceRivas||0)}),i.jsx("td",{className:"p-2 border",children:oT(De.unitPriceIsla||0)}),i.jsx("td",{className:"p-2 border",children:De.fromSellerName||""}),i.jsx("td",{className:"p-2 border",children:De.fromOrderLabel||De.fromOrderKey||""}),i.jsx("td",{className:"p-2 border",children:De.toSellerName||""}),i.jsx("td",{className:"p-2 border",children:De.toOrderLabel||De.toOrderKey||""}),i.jsx("td",{className:"p-2 border text-left",children:De.comment||""})]},De.id)})})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Nota: el traslado mueve EXISTENCIA (remainingPackages/remainingUnits) del pedido origen al destino."})]})}):null}const ai=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function NG(t){const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"}const Ni=t=>Math.max(0,Math.floor(Number(t||0))),nf=t=>{const e=Number(t||0);return!isFinite(e)||e<0?0:e},id=(t,e)=>{const r=nf(e),n=Number(t||0)*(r/100),a=Number(t||0)-n;return{vendorMarginPercent:r,uVendor:n,uInvestor:a}};function sVe({role:t="",sellerCandyId:e="",currentUserEmail:r,roles:n}){const{refreshKey:a,refresh:s}=Mc(),o=n&&n.length?n:t,l=!o||Sn(o,"admin"),c=Sn(o,"vendedor_dulces"),u=(r||"").trim().toLowerCase(),d=!l&&c,[f,A]=g.useState(!0),[h,m]=g.useState(""),[p,x]=g.useState([]),[v,y]=g.useState([]),[b,w]=g.useState({}),[j,I]=g.useState([]),C=g.useRef({});g.useEffect(()=>{const fe={};j.forEach(et=>{fe[et.id]=et}),C.current=fe},[j]);const[S,E]=g.useState(!1),[B,k]=g.useState(null),[T,P]=g.useState(""),[K,le]=g.useState(""),[oe,ie]=g.useState(""),[Ae,te]=g.useState(""),[Te,Ue]=g.useState("0"),[O,H]=g.useState([]),[G,L]=g.useState(""),[W,X]=g.useState(""),[D,Q]=g.useState(!1),[Z,be]=g.useState(!1),[U,ze]=g.useState(!1),re=20,[J,Re]=g.useState(1),ke=20,[Be,Ye]=g.useState(1),[ot,Ct]=g.useState({}),[jt,Ot]=g.useState(!1),[Tt,Qt]=g.useState({}),[Ft,Qe]=g.useState({}),[De,Je]=g.useState(!1),[dt,ce]=g.useState({}),[we,ue]=g.useState({}),ne=g.useMemo(()=>p.find(fe=>fe.id===T)||null,[T,p]);ne==null||ne.branch,g.useEffect(()=>{!S||!T||!O.length||H(fe=>fe.map(et=>{const nt=v.find(ur=>ur.id===et.productId)||null,ct=p.find(ur=>ur.id===T)||null,ve=ct==null?void 0:ct.branch,ft=Ni(et.packages),St=nt?Ie(nt,ve):Number(et.pricePerPackage||0),yt=(nt?xt(nt,ve):0)*ft,Et=nt?nt.logisticAllocatedPerPack*ft:Number(et.logisticAllocated||0),Mt=(nt?Pt(nt,ve):0)*ft,Yt=It(T),ar=et.vendorMarginPercent!=null&&String(et.vendorMarginPercent).trim()!==""?nf(et.vendorMarginPercent):Yt,vr=id(yt,ar);return{...et,pricePerPackage:St,totalExpected:St*ft,grossProfit:yt,logisticAllocated:Et,vendorMarginPercent:vr.vendorMarginPercent,uAproximada:Mt,uVendor:vr.uVendor,uInvestor:vr.uInvestor,totalRivas:((nt==null?void 0:nt.unitPriceRivas)||et.unitPriceRivas||0)*ft,totalSanJorge:((nt==null?void 0:nt.unitPriceSanJorge)||et.unitPriceSanJorge||0)*ft,totalIsla:((nt==null?void 0:nt.unitPriceIsla)||et.unitPriceIsla||0)*ft,unitPriceRivas:(nt==null?void 0:nt.unitPriceRivas)||et.unitPriceRivas||0,unitPriceSanJorge:(nt==null?void 0:nt.unitPriceSanJorge)||et.unitPriceSanJorge||0,unitPriceIsla:(nt==null?void 0:nt.unitPriceIsla)||et.unitPriceIsla||0}}))},[S,T,O.length,v,p]);const Ve=g.useMemo(()=>!c||!u?null:p.find(fe=>(fe.email||"").trim().toLowerCase()===u)||null,[c,u,p]);g.useMemo(()=>new Set(O.map(fe=>fe.productId)),[O]);const it=g.useMemo(()=>v.filter(fe=>(b[fe.id]??0)>1).sort((fe,et)=>`${fe.category} ${fe.name}`.localeCompare(`${et.category} ${et.name}`)),[v,b]),vt=g.useMemo(()=>{const fe=G.trim().toLowerCase();return fe?it.filter(et=>`${et.category??""} ${et.name??""}`.toLowerCase().includes(fe)):it},[it,G]),me=g.useMemo(()=>v.find(fe=>fe.id===Ae)||null,[Ae,v]),Ee=g.useMemo(()=>c&&Ve?j.filter(fe=>fe.sellerId===Ve.id):j,[j,c,Ve]),ye=async()=>{try{const fe=bt(je,"inventory_transfers_candies"),et=(yt,Et,qt,Mt)=>{Et&&(yt[Et]=yt[Et]||{out:0,in:0},yt[Et][qt]+=Mt)},nt=(yt,Et,qt)=>{const Mt=String(Et||"");Mt&&(yt[Mt]=(yt[Mt]||0)+qt)},ct={},ve={},ft=C.current,St=yt=>{var ur,Dt;if(yt.destRowWasNew!=null)return!!yt.destRowWasNew;const Et=String(yt.toVendorRowId||"");if(!Et)return!1;const qt=ft[Et];if(!qt)return!1;const Mt=Number(((ur=qt.createdAt)==null?void 0:ur.seconds)??0),Yt=Number(((Dt=yt.createdAt)==null?void 0:Dt.seconds)??0),ar=Mt>0&&Yt>0&&Math.abs(Mt-Yt)<=1,vr=Math.max(0,Number(qt.packages||0))===Math.max(0,Number(yt.packagesMoved||0));return ar&&vr},wt=yt=>{const Et=yt.data(),qt=Number(Et.packagesMoved||0);qt>0&&(et(ct,String(Et.fromOrderKey||""),"out",qt),et(ct,String(Et.toOrderKey||""),"in",qt),nt(ve,Et.fromVendorRowId,-qt),St(Et)||nt(ve,Et.toVendorRowId,qt))};if(!c)(await Ht(fe)).forEach(wt);else{const yt=sr(fe,Ar("fromSellerId","==",e)),Et=sr(fe,Ar("toSellerId","==",e)),[qt,Mt]=await Promise.all([Ht(yt),Ht(Et)]),Yt=new Set,ar=vr=>{vr.forEach(ur=>{Yt.has(ur.id)||(Yt.add(ur.id),wt(ur))})};ar(qt.docs),ar(Mt.docs)}Qt(ct),Qe(ve)}catch(fe){console.error(fe),Qt({}),Qe({})}};g.useEffect(()=>{(async()=>{A(!0),m("");try{const fe=await Ht(sr(bt(je,"sellers_candies"),In("name","asc"))),et=[];fe.forEach(ur=>{const Dt=ur.data(),Yr=Dt.branch||Dt.branchLabel||Dt.route||Dt.sucursal||Dt.location||"";et.push({id:ur.id,name:Dt.name||"",email:Dt.email||"",commissionPercent:Number(Dt.commissionPercent||0),branch:NG(Yr),branchLabel:Yr})}),x(et);const nt=await Ht(sr(bt(je,"candy_main_orders"),In("createdAt","desc"))),ct={},ve={},ft=(ur,Dt)=>`${ur}#${String(Dt).padStart(10,"0")}`;nt.forEach(ur=>{var pr;const Dt=ur.data(),Yr=Number(((pr=Dt.createdAt)==null?void 0:pr.seconds)??0),Vr=String(Dt.date||""),Sr=Array.isArray(Dt.items)?Dt.items:[];for(const jr of Sr){const Tn=String(jr.id||jr.productId||"");if(!Tn)continue;const Nn=Ni(jr.remainingPackages??jr.remainingPacks??0);Nn>0&&(ct[Tn]=(ct[Tn]||0)+Nn);const xn=Math.max(1,Ni(jr.packages??0)),ua=Number(jr.providerPrice??jr.provider_price??jr.priceProvider??jr.costProvider??0),ga=Number(jr.unitPriceRivas||0),Ji=Number(jr.unitPriceSanJorge||0),Zi=Number(jr.unitPriceIsla||0),Ol=Number(jr.gainRivas??jr.grossProfitRivas??jr.grossProfit??0),xa=Number(jr.gainSanJorge??jr.grossProfitSanJorge??jr.grossProfit??0),Qn=Number(jr.gainIsla??jr.grossProfitIsla??jr.grossProfit??0),hu=Number(jr.logisticAllocated??jr.prorrateo??jr.prorrateoLogistico??jr.gastos??0),eo=Number(jr.uAproximada??jr.uApprox??jr.netProfit??jr.vendorProfit??jr.gainVendor??0)/xn,Lc=hu/xn,Uc={id:Tn,name:String(jr.name||jr.productName||""),category:String(jr.category||""),unitsPerPackage:Ni(jr.unitsPerPackage??0),providerPrice:ua,unitPriceRivas:ga,unitPriceSanJorge:Ji,unitPriceIsla:Zi,grossProfitPerPackRivas:Ol/xn,grossProfitPerPackSanJorge:xa/xn,grossProfitPerPackIsla:Qn/xn,uApproxPerPackRivas:eo,uApproxPerPackSanJorge:eo,uApproxPerPackIsla:eo,logisticAllocatedPerPack:Lc,masterOrderId:ur.id,key:ft(Vr,Yr)},fc=ve[Tn];(!fc||Uc.key>fc.key)&&(ve[Tn]=Uc)}});const St=await Ht(sr(bt(je,"inventory_candies"),In("createdAt","desc"))),wt=ur=>{const Dt=Math.max(1,Ni(ur.unitsPerPackage||1)),Yr=Number(ur.remaining??0);if(Number.isFinite(Yr)&&Yr>0)return Math.floor(Yr/Dt);const Vr=Number(ur.remainingPackages??0);return Number.isFinite(Vr)&&Vr>0?Math.floor(Vr):0},yt={};St.forEach(ur=>{const Dt=ur.data(),Yr=String(Dt.productId||"");if(!Yr)return;const Vr=wt(Dt);Vr<=0||(yt[Yr]=(yt[Yr]||0)+Vr)});const Et={};(Object.keys(yt).length?Object.keys(yt):Object.keys(ct)).forEach(ur=>{const Dt=Object.keys(yt).length?yt[ur]:ct[ur];Et[ur]=Math.max(0,Ni(Dt))}),w(Et);const Mt=await Ht(c?sr(bt(je,"inventory_candies_sellers"),Ar("sellerId","==",e),In("createdAt","desc")):sr(bt(je,"inventory_candies_sellers"),In("createdAt","desc"))),Yt=Object.keys(ve).map(ur=>{const Dt=ve[ur];return{id:Dt.id,name:Dt.name,category:Dt.category,unitsPerPackage:Dt.unitsPerPackage,providerPrice:Dt.providerPrice,unitPriceRivas:Dt.unitPriceRivas,unitPriceSanJorge:Dt.unitPriceSanJorge,unitPriceIsla:Dt.unitPriceIsla,grossProfitPerPackRivas:Dt.grossProfitPerPackRivas,grossProfitPerPackSanJorge:Dt.grossProfitPerPackSanJorge,grossProfitPerPackIsla:Dt.grossProfitPerPackIsla,uApproxPerPackRivas:Dt.uApproxPerPackRivas,uApproxPerPackSanJorge:Dt.uApproxPerPackSanJorge,uApproxPerPackIsla:Dt.uApproxPerPackIsla,logisticAllocatedPerPack:Dt.logisticAllocatedPerPack,existingPacks:Et[Dt.id]??0,masterOrderId:Dt.masterOrderId}}).sort((ur,Dt)=>`${ur.category} ${ur.name}`.localeCompare(`${Dt.category} ${Dt.name}`));y(Yt);const ar=[];Mt.forEach(ur=>{const Dt=ur.data(),Yr=Object.prototype.hasOwnProperty.call(Dt,"transferDelta"),Vr=et.find(ua=>ua.id===Dt.sellerId)||null,Sr=nf(Dt.vendorMarginPercent??Dt.vendorMargin??Dt.commissionPercent??(Vr==null?void 0:Vr.commissionPercent)??0),pr=Number(Dt.uAproximada??Dt.uApprox??Dt.netProfit??Dt.uAprox??Dt.uApproxTotal??0),jr=Dt.uVendor??Dt.vendorProfit??Dt.gainVendor??0,Tn=Dt.uVendor!=null,Nn=id(Number(Dt.grossProfit??Dt.gainVendor??0),Sr),xn=Tn?{uAproximada:Number(pr||0),vendorMarginPercent:Sr,uVendor:Number(jr||0),uInvestor:Number(pr||0)-Number(jr||0)}:{uAproximada:Number(pr||0),vendorMarginPercent:Nn.vendorMarginPercent,uVendor:Nn.uVendor,uInvestor:Nn.uInvestor};ar.push({id:ur.id,sellerId:Dt.sellerId,sellerName:Dt.sellerName||"",orderName:Dt.orderName||"",productId:Dt.productId,productName:Dt.productName||"",category:Dt.category||"",orderId:Dt.orderId||null,packages:Number(Dt.packages||0),unitsPerPackage:Number(Dt.unitsPerPackage||0),totalUnits:Number(Dt.totalUnits||0),remainingPackages:Number(Dt.remainingPackages||0),remainingUnits:Number(Dt.remainingUnits||0),totalRivas:Number(Dt.totalRivas||0),totalSanJorge:Number(Dt.totalSanJorge||0),totalIsla:Number(Dt.totalIsla||0),unitPriceRivas:Number(Dt.unitPriceRivas||0),unitPriceSanJorge:Number(Dt.unitPriceSanJorge||0),unitPriceIsla:Number(Dt.unitPriceIsla||0),grossProfit:Number(Dt.grossProfit??Dt.gainVendor??0),logisticAllocated:Number(Dt.logisticAllocated??Dt.gastos??Dt.gasto??0),vendorMarginPercent:xn.vendorMarginPercent,uAproximada:xn.uAproximada,uVendor:xn.uVendor,uInvestor:xn.uInvestor,vendorProfit:Number(Dt.vendorProfit??xn.uVendor??0),transferDelta:Yr&&typeof Dt.transferDelta=="number"?Number(Dt.transferDelta||0):void 0,subtotal:Number(Dt.subtotal||0),providerPrice:Number(Dt.providerPrice||0),date:Dt.date||"",createdAt:Dt.createdAt||xr.now()})});const vr={};ar.forEach(ur=>{vr[ur.id]=ur}),C.current=vr,I(ar),await ye()}catch(fe){console.error(fe),m(" Error cargando datos de vendedores / pedidos.")}finally{A(!1)}})()},[a,t,e]);const We=(fe,et)=>`${fe}__${et}`,ge=fe=>fe.orderId||We(fe.sellerId,fe.date),Ie=(fe,et)=>et?et==="RIVAS"?fe.unitPriceRivas||0:et==="SAN_JORGE"?fe.unitPriceSanJorge||0:fe.unitPriceIsla||0:fe.unitPriceIsla||fe.unitPriceRivas||fe.unitPriceSanJorge||0,xt=(fe,et)=>et?et==="RIVAS"?fe.grossProfitPerPackRivas||0:et==="SAN_JORGE"?fe.grossProfitPerPackSanJorge||0:fe.grossProfitPerPackIsla||0:fe.grossProfitPerPackIsla||fe.grossProfitPerPackRivas||fe.grossProfitPerPackSanJorge||0,Pt=(fe,et)=>et?et==="RIVAS"?fe.uApproxPerPackRivas||0:et==="SAN_JORGE"?fe.uApproxPerPackSanJorge||0:fe.uApproxPerPackIsla||0:fe.uApproxPerPackIsla||fe.uApproxPerPackRivas||fe.uApproxPerPackSanJorge||0,It=fe=>{const et=p.find(nt=>nt.id===fe)||null;return nf((et==null?void 0:et.commissionPercent)??0)},Ut=fe=>{const et=Ft[fe.id];return typeof et=="number"&&Number.isFinite(et)?et:typeof fe.transferDelta=="number"?Number(fe.transferDelta||0):0},$t=fe=>{const et=Math.max(0,Number(fe.packages||0)),nt=Ut(fe);return Math.max(0,et+nt)},Le=fe=>{const et=Math.max(1,Ni(fe.unitsPerPackage||1)),nt=Number(fe.remaining??0);if(Number.isFinite(nt)&&nt>0)return Math.floor(nt/et);const ct=Number(fe.remainingPackages??0);return Number.isFinite(ct)&&ct>0?Math.floor(ct):0},Ce=async(fe,et)=>{const nt=String(fe||"").trim();if(!nt)return{byId:0,byName:0};const ct=await Ht(sr(bt(je,"inventory_candies"),Ar("productId","==",nt)));let ve=0;ct.forEach(yt=>{ve+=Le(yt.data())});const ft=Math.max(0,ve);let St=0;const wt=String(et||"").trim();return ft===0&&wt&&((await Ht(sr(bt(je,"inventory_candies"),Ar("productName","==",wt)))).forEach(Et=>{St+=Le(Et.data())}),St=Math.max(0,St)),{byId:ft,byName:St}},pe=g.useMemo(()=>{const fe=new Map;for(const nt of Ee){const ct=ge(nt),ve=fe.get(ct)||{orderKey:ct,sellerId:nt.sellerId,sellerName:nt.sellerName,orderName:nt.orderName||"",date:nt.date,totalPackages:0,totalActivePackages:0,totalRemainingPackages:0,totalExpected:0,totalExpectedActive:0,grossProfit:0,grossProfitActive:0,vendorProfit:0,vendorProfitActive:0,gastos:0,gastosActive:0,transferredOut:0,transferredIn:0},ft=Math.max(0,Number(nt.packages||0)),St=Math.max(0,Number(nt.remainingPackages||0)),wt=$t(nt),yt=ft>0?wt/ft:1;ve.totalPackages+=ft,ve.totalRemainingPackages+=St,ve.totalActivePackages+=wt;const Et=p.find(Nn=>Nn.id===nt.sellerId)||null,qt=Et==null?void 0:Et.branch,Mt=v.find(Nn=>Nn.id===String(nt.productId))||null,Yt=Mt?Ie(Mt,qt):Number(qt==="RIVAS"?nt.unitPriceRivas||0:qt==="SAN_JORGE"?nt.unitPriceSanJorge||0:nt.unitPriceIsla||0),ar=Yt*ft,vr=Yt*wt;ve.totalExpected+=Number(ar||0),ve.totalExpectedActive+=Number(vr||0);const ur=Mt?xt(Mt,qt):ft>0?Number(nt.grossProfit||0)/ft:0,Dt=ur*ft,Yr=ur*wt;ve.grossProfit+=Number(Dt||0),ve.grossProfitActive+=Number(Yr||0);const Vr=typeof(Mt==null?void 0:Mt.logisticAllocatedPerPack)=="number"?Number(Mt.logisticAllocatedPerPack||0):(()=>{const Nn=Number(nt.logisticAllocated??nt.gastos??nt.gasto??0),xn=ft>0?ft:wt||1;return xn>0?Nn/xn:0})(),Sr=Vr*ft,pr=Vr*wt;ve.gastos=(ve.gastos||0)+Number(Sr||0),ve.gastosActive=(ve.gastosActive||0)+Number(pr||0);const jr=It(nt.sellerId),Tn=id(Dt,jr);ve.vendorProfit+=Number(Tn.uVendor||0),ve.vendorProfitActive+=Number(Tn.uVendor||0)*yt,fe.set(ct,ve)}const et=[];for(const nt of fe.values()){const ct=Tt[nt.orderKey]||{out:0,in:0};nt.transferredOut=ct.out||0,nt.transferredIn=ct.in||0,Number.isFinite(nt.totalExpectedActive)||(nt.totalExpectedActive=nt.totalExpected),Number.isFinite(nt.grossProfitActive)||(nt.grossProfitActive=nt.grossProfit),Number.isFinite(nt.vendorProfitActive)||(nt.vendorProfitActive=nt.vendorProfit),Number.isFinite(nt.gastosActive||0)||(nt.gastosActive=nt.gastos),et.push(nt)}return et.sort((nt,ct)=>(ct.date||"").localeCompare(nt.date||"")),et},[Ee,p,Tt,v,Ft]),He=g.useMemo(()=>Math.max(1,Math.ceil(pe.length/re)),[pe.length]);g.useEffect(()=>{J>He&&Re(He)},[He]);const he=g.useMemo(()=>{const fe=(J-1)*re;return pe.slice(fe,fe+re)},[pe,J]),ee=()=>Re(fe=>Math.max(1,fe-1)),_e=()=>Re(fe=>Math.min(He,fe+1)),R=g.useMemo(()=>{const fe=W.trim().toLowerCase();return fe?O.filter(et=>{const nt=String(et.productName||"").toLowerCase(),ct=String(et.category||"").toLowerCase();return nt.includes(fe)||ct.includes(fe)}):O},[O,W]),V=g.useMemo(()=>Math.max(1,Math.ceil(R.length/ke)),[R.length]);g.useEffect(()=>{Be>V&&Ye(V)},[V]);const q=g.useMemo(()=>{const fe=(Be-1)*ke;return R.slice(fe,fe+ke)},[R,Be]),se=g.useMemo(()=>{const fe=new Map;for(const et of q){const nt=(et.category||"Sin categora").trim()||"Sin categora",ct=fe.get(nt)||[];ct.push(et),fe.set(nt,ct)}return Array.from(fe.entries())},[q]),Ne=fe=>{Ct(et=>({...et,[fe]:!et[fe]}))},Me=()=>Ye(fe=>Math.max(1,fe-1)),Ke=()=>Ye(fe=>Math.min(V,fe+1)),Pe=fe=>{ce(et=>({...et,[fe]:!0}))},rt=fe=>{ce(et=>({...et,[fe]:!1}))},lt=fe=>{ue(et=>({...et,[fe]:!0}))},ht=fe=>{ue(et=>({...et,[fe]:!1}))},kt=fe=>{const et=Math.max(0,Number(fe.packages||0)),nt=Number(fe.transferDelta||0);return Math.max(0,et+nt)},de=fe=>{const et=Math.max(0,Number(fe.packages||0)),nt=kt(fe);return et===0?nt>0?1:0:nt/et},qe=(fe,et)=>Number(et||0)*de(fe),at=fe=>Number(fe.logisticAllocated??fe.logisticAllocated??fe.gastos??fe.gasto??0),st=fe=>{const et=qe(fe,Number(fe.totalExpected||0)),nt=qe(fe,Number(fe.grossProfit||0)),ct=qe(fe,at(fe)),ve=qe(fe,Number(fe.uVendor||0)),ft=nt-ct-ve;return{totalExpected:et,grossProfit:nt,gastos:ct,uVendor:ve,uNeta:ft}},Nt=g.useMemo(()=>O.reduce((fe,et)=>{const nt=Math.max(0,Number(et.packages||0)),ct=kt(et),ve=st(et);return fe.totalPackages+=nt,fe.totalActivePackages+=ct,fe.totalExpected+=ve.totalExpected,fe.grossProfit+=ve.grossProfit,fe.gastosTotal+=ve.gastos,fe.uVendor+=ve.uVendor,fe},{totalPackages:0,totalActivePackages:0,totalExpected:0,grossProfit:0,gastosTotal:0,uVendor:0}),[O]),Rt=g.useMemo(()=>Nt.grossProfit-Nt.gastosTotal-Nt.uVendor,[Nt.grossProfit,Nt.gastosTotal,Nt.uVendor]),nr=()=>{k(null),P(""),le(""),ie(""),te(""),Ue("0"),H([]),L(""),Ye(1),ce({}),ue({})},_r=()=>{m(""),nr(),c&&Ve&&P(Ve.id);const fe=new Date,et=fe.getFullYear(),nt=String(fe.getMonth()+1).padStart(2,"0"),ct=String(fe.getDate()).padStart(2,"0");le(`${et}-${nt}-${ct}`),ie(""),E(!0)},$r=()=>{E(!1)},or=fe=>{m(""),nr(),k(fe);const[et,nt]=fe.split("__");P(et||""),le(nt||"");const ct=Ee.filter(yt=>ge(yt)===fe),ve=ct[0]||null;ie((ve==null?void 0:ve.orderName)||"");const ft=p.find(yt=>yt.id===et)||null,St=ft==null?void 0:ft.branch,wt=ct.map(yt=>{const Et=v.find(Tn=>Tn.id===String(yt.productId))||null,qt=Number(yt.unitPriceRivas||(Et==null?void 0:Et.unitPriceRivas)||0),Mt=Number(yt.unitPriceSanJorge||(Et==null?void 0:Et.unitPriceSanJorge)||0),Yt=Number(yt.unitPriceIsla||(Et==null?void 0:Et.unitPriceIsla)||0),ar=Number(yt.packages||0),vr=St==="RIVAS"?qt:St==="SAN_JORGE"?Mt:Yt,ur=Number(yt.totalRivas||0),Dt=Number(yt.totalSanJorge||0),Yr=Number(yt.totalIsla||0),Vr=St==="RIVAS"?ur:St==="SAN_JORGE"?Dt:Yr,Sr=nf(yt.vendorMarginPercent??It(et)),pr=id(Number(yt.grossProfit||0),Sr),jr=Number(yt.logisticAllocated??yt.gastos??0)||(Et?Et.logisticAllocatedPerPack*ar:0);return{id:yt.id,productId:String(yt.productId||""),productName:yt.productName||(Et==null?void 0:Et.name)||"",category:yt.category||(Et==null?void 0:Et.category)||"",unitsPerPackage:Number(yt.unitsPerPackage||(Et==null?void 0:Et.unitsPerPackage)||0),packages:ar,totalExpected:Vr,pricePerPackage:vr,grossProfit:Number(yt.grossProfit||0),logisticAllocated:jr,vendorMarginPercent:pr.vendorMarginPercent,uAproximada:Number(yt.uAproximada||0),uVendor:Number(yt.uVendor??pr.uVendor??0),uInvestor:Number(yt.uInvestor??pr.uInvestor??0),totalRivas:ur,totalSanJorge:Dt,totalIsla:Yr,unitPriceRivas:qt,unitPriceSanJorge:Mt,unitPriceIsla:Yt,providerPrice:Number(yt.providerPrice||0),remainingPackages:Number(yt.remainingPackages||0),transferDelta:Ut(yt)}});H(wt),E(!0)},kr=()=>{if(m(""),!T)return m(" Seleccion un vendedor.");if(!K)return m(" Seleccion una fecha.");if(!Ae)return m(" Seleccion un producto.");const fe=Ni(Te);if(fe<=0)return m(" Paquetes debe ser > 0.");const et=v.find(vr=>vr.id===Ae);if(!et)return m(" Producto no encontrado.");if(O.some(vr=>vr.productId===et.id))return m(" Ese producto ya est agregado al pedido.");const nt=p.find(vr=>vr.id===T)||null,ct=nt==null?void 0:nt.branch,ve=Ie(et,ct),ft=xt(et,ct),wt=Pt(et,ct)*fe,yt=ve*fe,Et=ft*fe,qt=et.logisticAllocatedPerPack*fe,Mt=It(T),Yt=id(Et,Mt),ar={id:`tmp_${Date.now()}_${Math.random().toString(16).slice(2)}`,productId:et.id,productName:et.name,category:et.category,unitsPerPackage:et.unitsPerPackage,packages:fe,totalExpected:yt,pricePerPackage:ve,grossProfit:Et,logisticAllocated:qt,providerPrice:et.providerPrice,vendorMarginPercent:Yt.vendorMarginPercent,uAproximada:wt,uVendor:Yt.uVendor,uInvestor:Yt.uInvestor,totalRivas:(et.unitPriceRivas||0)*fe,totalSanJorge:(et.unitPriceSanJorge||0)*fe,totalIsla:(et.unitPriceIsla||0)*fe,unitPriceRivas:et.unitPriceRivas||0,unitPriceSanJorge:et.unitPriceSanJorge||0,unitPriceIsla:et.unitPriceIsla||0,remainingPackages:fe,transferDelta:0};H(vr=>[ar,...vr]),te(""),Ue("0"),Ye(1)},en=fe=>{H(et=>et.filter(nt=>nt.id!==fe))},rn=(fe,et)=>{const nt=Math.max(0,Ni(et));H(ct=>ct.map(ve=>{if(ve.id!==fe)return ve;const ft=v.find(Yr=>Yr.id===ve.productId),St=p.find(Yr=>Yr.id===T)||null,wt=St==null?void 0:St.branch,yt=ft?Ie(ft,wt):ve.pricePerPackage||0,qt=(ft?xt(ft,wt):0)*nt,Mt=ft?ft.logisticAllocatedPerPack*nt:ve.logisticAllocated||0,ar=(ft?Pt(ft,wt):0)*nt,vr=ve.vendorMarginPercent!=null?ve.vendorMarginPercent:It(T),ur=id(qt,vr),Dt=String(ve.id||"").startsWith("tmp_")||Number(ve.remainingPackages||0)===Number(ve.packages||0);return{...ve,packages:nt,pricePerPackage:yt,totalExpected:yt*nt,grossProfit:qt,logisticAllocated:Mt,providerPrice:(ft==null?void 0:ft.providerPrice)??ve.providerPrice??Number(ve.providerPrice||0),vendorMarginPercent:ur.vendorMarginPercent,uAproximada:ar,uVendor:ur.uVendor,uInvestor:ur.uInvestor,totalRivas:((ft==null?void 0:ft.unitPriceRivas)||ve.unitPriceRivas||0)*nt,totalSanJorge:((ft==null?void 0:ft.unitPriceSanJorge)||ve.unitPriceSanJorge||0)*nt,totalIsla:((ft==null?void 0:ft.unitPriceIsla)||ve.unitPriceIsla||0)*nt,remainingPackages:Dt?nt:ve.remainingPackages}}))},Er=(fe,et)=>{const nt=nf(et);H(ct=>ct.map(ve=>{if(ve.id!==fe)return ve;const ft=v.find(ar=>ar.id===ve.productId),St=p.find(ar=>ar.id===T)||null,wt=St==null?void 0:St.branch,yt=Ni(ve.packages),qt=(ft?Pt(ft,wt):0)*yt,Mt=Number(ve.grossProfit||0),Yt=id(Mt,nt);return{...ve,vendorMarginPercent:Yt.vendorMarginPercent,uAproximada:qt,uVendor:Yt.uVendor,uInvestor:Yt.uInvestor}}))},Se=async()=>{if(l&&!Z)try{be(!0),m("");const fe=j;if(!fe.length){m(" No hay documentos para actualizar.");return}const et=wt=>v.find(yt=>yt.id===wt)||null,nt=wt=>{const yt=p.find(Et=>Et.id===wt)||null;return yt==null?void 0:yt.branch},ct=(wt,yt)=>Math.abs(Number(wt||0)-Number(yt||0))>.01;let ve=Sc(je),ft=0,St=0;for(const wt of fe){const yt=nt(wt.sellerId)||"ISLA",Et=Math.max(1,Number(wt.unitsPerPackage||0)||1),qt=Number(wt.totalUnits||0),Mt=Number(wt.remainingUnits||0),ar=Math.max(0,qt-Mt)/Et,vr=Number(wt.remainingPackages||0),ur=Math.max(0,vr+ar),Dt=et(String(wt.productId||"")),Yr=Dt&&ur>0?xt(Dt,yt)*ur:Number(wt.grossProfit||0),Vr=Dt&&ur>0?Dt.logisticAllocatedPerPack*ur:Number(wt.logisticAllocated||0),Sr=Dt?Pt(Dt,yt):0,pr=ur>0?Sr*ur:0,jr=wt.vendorMarginPercent!=null?nf(wt.vendorMarginPercent):It(wt.sellerId),Tn=id(Yr,jr),Nn=Tn.uVendor,xn=Tn.uInvestor,ua=Yr-Vr-Nn;if(!(ct(wt.packages,ur)||wt.uVendor==null||wt.uNeta==null||wt.uAproximada==null||wt.uInvestor==null||wt.logisticAllocated==null||ct(wt.uVendor,Nn)||ct(wt.uNeta,ua)||ct(wt.uAproximada,pr)||ct(wt.uInvestor,xn)||ct(wt.logisticAllocated,Vr)))continue;const Ji=Xt(je,"inventory_candies_sellers",wt.id);ve.update(Ji,{packages:ur,vendorMarginPercent:jr,grossProfit:Yr,logisticAllocated:Vr,uAproximada:pr,uVendor:Nn,uInvestor:xn,uNeta:ua,vendorProfit:Nn,updatedAt:xr.now()}),ft+=1,St+=1,ft>=400&&(await ve.commit(),ve=Sc(je),ft=0)}ft>0&&await ve.commit(),m(` Actualizados ${St} documentos.`),s()}catch(fe){console.error(fe),m(" Error actualizando documentos.")}finally{be(!1)}},gt=(fe,et,nt="Hoja1")=>{const ct=Qa.book_new(),ve=Qa.aoa_to_sheet(et);Qa.book_append_sheet(ct,ve,nt),$2(ct,fe)},er=()=>{if(!l){m(" Solo admin puede exportar Excel.");return}const fe=["Vendedor","Sucursal","Fecha","Producto ID","Producto","Categora","Paquetes","Paquetes restantes","Precio paquete","Precio proveedor","Total esperado","U. Bruta","U. Vendedor","U. Neta","P. Rivas","P. San Jorge","P. Isla","Total Rivas","Total San Jorge","Total Isla","Unidades x paquete","vendorMarginPercent","uVendor"],et=p.find(ft=>ft.id===T)||null,nt=(et==null?void 0:et.branch)||NG(et==null?void 0:et.branchLabel)||"",ct=[fe,...O.map(ft=>{const{totalExpected:St,grossProfit:wt,uVendor:yt,uNeta:Et}=st(ft);return[(et==null?void 0:et.name)||"",String(nt),K||"",ft.productId,ft.productName,ft.category,Number(ft.packages||0),Number(ft.remainingPackages||0),Number(ft.pricePerPackage||0),Number(ft.providerPrice||0),Number(St||0),Number(wt||0),Number(yt||0),Number(Et||0),Number(ft.unitPriceRivas||0),Number(ft.unitPriceSanJorge||0),Number(ft.unitPriceIsla||0),Number(ft.totalRivas||0),Number(ft.totalSanJorge||0),Number(ft.totalIsla||0),Number(ft.unitsPerPackage||0),Number(ft.vendorMarginPercent||0),Number(ft.uVendor||0)]})],ve=`vendor_order_items_${((et==null?void 0:et.name)||"vendedor").replace(/\s+/g,"_")}_${K||"sin_fecha"}.xlsx`;gt(ve,ct,"Productos")},Mr=()=>{const fe=["productId","productName","category","Existentes","Paquetes","vendorMarginPercent","uNeta"],et=v.map(ct=>({id:ct.id,name:ct.name,category:ct.category,existentes:Number(ct.existingPacks||0)})).filter(ct=>ct.existentes>0).sort((ct,ve)=>`${ct.category} ${ct.name}`.localeCompare(`${ve.category} ${ve.name}`)),nt=[fe,...et.map(ct=>[ct.id,ct.name,ct.category,ct.existentes,"","",""])];gt("plantilla_orden_vendedor.xlsx",nt,"Plantilla")},Or=async fe=>{try{m("");const et=await fe.arrayBuffer(),nt=$v(et,{type:"array"}),ct=nt.SheetNames||[],ve=nt.Sheets.Plantilla||nt.Sheets.Productos||nt.Sheets[ct[0]];if(!ve)return m(" Archivo sin hojas.");const ft=Qa.sheet_to_json(ve,{header:1,defval:""});if(!ft.length)return m(" Archivo vaco.");const St=(ft[0]||[]).map(vr=>String(vr||"").trim().toLowerCase()),wt=St.findIndex(vr=>vr==="productid"||vr==="producto id"||vr==="id"),yt=St.findIndex(vr=>vr==="paquetes"||vr==="packages"),Et=St.findIndex(vr=>vr==="vendormarginpercent"||vr==="vendor_margin_percent"||vr==="marginvendorpercent"||vr==="margen"||vr==="margen vendedor"||vr==="margen_del_vendedor");if(wt<0||yt<0)return m(" Plantilla invlida: debe tener columnas productId y Paquetes.");if(!T)return m(" Seleccion un vendedor antes de importar.");if(!K)return m(" Seleccion una fecha antes de importar.");const qt=p.find(vr=>vr.id===T)||null,Mt=qt==null?void 0:qt.branch,Yt=It(T),ar=[];for(let vr=1;vr<ft.length;vr++){const ur=ft[vr]||[],Dt=String(ur[wt]||"").trim();if(!Dt)continue;const Yr=Ni(ur[yt]);if(Yr<=0)continue;const Vr=v.find(Qn=>Qn.id===Dt);if(!Vr)continue;const Sr=Et>=0?nf(ur[Et]):0,pr=Et>=0&&String(ur[Et]??"").trim()!==""?Sr:Yt,jr=Ie(Vr,Mt),Tn=xt(Vr,Mt),Nn=jr*Yr,xn=Tn*Yr,ua=Vr.logisticAllocatedPerPack*Yr,Ji=Pt(Vr,Mt)*Yr,Zi=id(xn,pr),Ol=O.find(Qn=>Qn.productId===Dt);if(Ol){const Qn=Et>=0&&String(ur[Et]??"").trim()!==""?pr:Ol.vendorMarginPercent,hu=id(xn,Qn);H(Dl=>Dl.map(eo=>eo.id===Ol.id?{...eo,packages:Yr,pricePerPackage:jr,totalExpected:Nn,grossProfit:xn,logisticAllocated:ua,vendorMarginPercent:hu.vendorMarginPercent,uAproximada:Ji,uVendor:hu.uVendor,uInvestor:hu.uInvestor,totalRivas:(Vr.unitPriceRivas||0)*Yr,totalSanJorge:(Vr.unitPriceSanJorge||0)*Yr,totalIsla:(Vr.unitPriceIsla||0)*Yr}:eo));continue}const xa={id:`tmp_${Date.now()}_${Math.random().toString(16).slice(2)}`,productId:Vr.id,productName:Vr.name,category:Vr.category,unitsPerPackage:Vr.unitsPerPackage,packages:Yr,pricePerPackage:jr,totalExpected:Nn,grossProfit:xn,logisticAllocated:ua,providerPrice:Vr.providerPrice,vendorMarginPercent:Zi.vendorMarginPercent,uAproximada:Ji,uVendor:Zi.uVendor,uInvestor:Zi.uInvestor,totalRivas:(Vr.unitPriceRivas||0)*Yr,totalSanJorge:(Vr.unitPriceSanJorge||0)*Yr,totalIsla:(Vr.unitPriceIsla||0)*Yr,unitPriceRivas:Vr.unitPriceRivas||0,unitPriceSanJorge:Vr.unitPriceSanJorge||0,unitPriceIsla:Vr.unitPriceIsla||0,remainingPackages:Yr};ar.push(xa)}if(!ar.length)return m(" No se encontraron filas con Paquetes > 0.");H(vr=>[...ar,...vr]),Ye(1),m(` Importados ${ar.length} productos desde plantilla.`)}catch(et){console.error(et),m(" Error importando Excel.")}},ir=async()=>{var fe;try{if(m(""),d)return m(" Solo lectura.");if(!T)return m(" Seleccion un vendedor.");if(!K)return m(" Seleccion una fecha.");if(!O.length)return m(" Agreg al menos 1 producto.");const et=p.find(Sr=>Sr.id===T)||null;if(!et)return m(" Vendedor invlido.");const nt=et.branch,ct=B?Ee.filter(Sr=>ge(Sr)===B):[],ve=String(((fe=ct[0])==null?void 0:fe.orderName)||"").trim(),ft=String(oe||"").trim(),St=B?ve!==ft:ft!=="",wt=Sr=>String(Sr??"").trim(),yt=new Map;ct.forEach(Sr=>yt.set(wt(Sr.productId),Sr));const Et=Sr=>yt.get(wt(Sr))||null,qt=Sr=>{const pr=Et(Sr.productId),jr=Ni(Sr.packages),Tn=pr?Ni(pr.packages):0,Nn=!pr||jr!==Tn,xn=nf(pr?pr.vendorMarginPercent:Sr.vendorMarginPercent),ua=nf(Sr.vendorMarginPercent);return{prev:pr,newPacks:jr,oldPacks:Tn,packsChanged:Nn,marginChanged:pr?xn!==ua:!0}},Mt=B?O.filter(Sr=>{const pr=qt(Sr);return!pr.prev||pr.packsChanged||pr.marginChanged}):O;for(const Sr of Mt){const pr=Ni(Sr.packages),jr=B?Et(Sr.productId):null,Tn=jr?Ni(jr.packages):0,Nn=pr-Tn;if(Nn>0){let xn=b[Sr.productId]??0;const ua=v.find(ga=>ga.id===Sr.productId)||null;if(Nn>xn&&(ua!=null&&ua.masterOrderId))try{await yF(ua.masterOrderId);const ga=await Ce(Sr.productId,Sr.productName);xn=ga.byId,w(Ji=>({...Ji,[Sr.productId]:ga.byId}))}catch{}if(Nn>xn){const ga=await Ce(Sr.productId,Sr.productName);return ga.byId===0&&ga.byName>0?m(` "${Sr.productName}" no tiene inventario por ID (${Sr.productId}). Pero existe por nombre: ${ga.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`):m(` "${Sr.productName}" excede existencias de orden maestra. Existentes: ${ga.byId} (faltan ${Nn})`)}}}Q(!0);const Yt=xr.now(),ar=We(T,K),vr=It(T),ur=new Set(O.map(Sr=>String(Sr.id||""))),Dt=B?ct.filter(Sr=>!ur.has(String(Sr.id||""))):[];if(B&&Mt.length===0&&!Dt.length&&!St)return Q(!1),m(" No hay cambios para guardar.");if(B&&Mt.length===0&&!Dt.length&&St){const Sr=Sc(je);ct.forEach(pr=>{Sr.update(Xt(je,"inventory_candies_sellers",pr.id),{orderName:ft,updatedAt:xr.now()})}),await Sr.commit(),I(pr=>pr.map(jr=>ge(jr)===B?{...jr,orderName:ft}:jr)),m(" Pedido guardado."),E(!1),nr(),s();return}if(B){const Sr=[];for(const pr of Dt)await pG(pr.id),Sr.push(pr.id);Sr.length&&I(pr=>pr.filter(jr=>!Sr.includes(jr.id)));for(const pr of O){const jr=Et(pr.productId);if(!jr)continue;const Tn=Ni(pr.packages),Nn=Ni(jr.packages),xn=Tn-Nn;if(xn<0){const ua=Math.abs(xn),ga=Ni(jr.remainingPackages);if(ua>ga)return m(` No pods bajar "${pr.productName}" en ${ua} porque solo quedan ${ga} paquetes restantes.`);await eVe({vendorInventoryId:jr.id,packagesToReturn:ua})}}}const Yr=new Map;let Vr="";for(const Sr of Mt){const pr=qt(Sr),jr=pr.newPacks-pr.oldPacks;if(pr.packsChanged&&jr>0)try{const{allocations:Tn}=await mG({productId:Sr.productId,packagesToAllocate:jr});Yr.set(Sr.productId,Tn||[])}catch{const Nn=v.find(xn=>xn.id===Sr.productId)||null;if(Nn!=null&&Nn.masterOrderId)try{await yF(Nn.masterOrderId);const{allocations:xn}=await mG({productId:Sr.productId,packagesToAllocate:jr});Yr.set(Sr.productId,xn||[]);continue}catch{const ua=await Ce(Sr.productId,Sr.productName);ua.byId===0&&ua.byName>0?Vr=` "${Sr.productName}" no tiene inventario por ID (${Sr.productId}). Pero existe por nombre: ${ua.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`:Vr=` No hay paquetes disponibles en orden maestra para "${Sr.productName}". Disponibles: ${ua.byId}.`;break}{const xn=await Ce(Sr.productId,Sr.productName);xn.byId===0&&xn.byName>0?Vr=` "${Sr.productName}" no tiene inventario por ID (${Sr.productId}). Pero existe por nombre: ${xn.byName} paquetes. Revisa que el productId del inventario coincida con el catlogo.`:Vr=` No hay paquetes disponibles en orden maestra para "${Sr.productName}". Disponibles: ${xn.byId}.`}break}}if(Vr)return Q(!1),m(Vr);if(await qs(je,async Sr=>{for(const pr of Mt){const jr=qt(pr),Tn=jr.prev;if(B&&Tn&&!jr.packsChanged){const M=pr.vendorMarginPercent!=null?pr.vendorMarginPercent:vr,Fe=Number(Tn.grossProfit??pr.grossProfit??0),At=Number(Tn.logisticAllocated??pr.logisticAllocated??0),_t=id(Fe,M),Vt=Number(Fe||0)-Number(At||0)-Number(_t.uVendor||0),hr=Xt(je,"inventory_candies_sellers",pr.id);Sr.update(hr,{vendorMarginPercent:_t.vendorMarginPercent,uVendor:_t.uVendor,uInvestor:_t.uInvestor,uNeta:Vt,vendorProfit:_t.uVendor});continue}const Nn=Ni(pr.packages),xn=Ni(pr.unitsPerPackage),ua=Nn*xn,ga=Tn?Ni(Tn.packages):0,Ji=Tn?Ni(Tn.remainingPackages):0,Zi=Nn-ga,Ol=Tn?Math.max(0,Ji+Zi):Nn,xa=Ol*xn,Qn=v.find(M=>M.id===pr.productId),hu=Qn?Ie(Qn,nt):Number(pr.pricePerPackage||0),eo=(Qn?xt(Qn,nt):0)*Nn,Lc=Qn?Qn.logisticAllocatedPerPack*Nn:pr.logisticAllocated||0,fc=(Qn?Pt(Qn,nt):0)*Nn,ll=pr.vendorMarginPercent!=null?pr.vendorMarginPercent:vr,Au=id(eo,ll),qA=Number(eo||0)-Number(Lc||0)-Number(Au.uVendor||0),cl=((Qn==null?void 0:Qn.unitPriceRivas)||pr.unitPriceRivas||0)*Nn,Qc=((Qn==null?void 0:Qn.unitPriceSanJorge)||pr.unitPriceSanJorge||0)*Nn,Bf=((Qn==null?void 0:Qn.unitPriceIsla)||pr.unitPriceIsla||0)*Nn,ho={sellerId:et.id,sellerName:et.name,sellerEmail:et.email||"",branch:et.branch||"",branchLabel:et.branchLabel||"",orderName:String(oe||"").trim(),productId:pr.productId,productName:pr.productName,category:pr.category,orderId:ar,date:K,createdAt:Yt,packages:Nn,unitsPerPackage:xn,totalUnits:ua,remainingPackages:Ol,remainingUnits:xa,totalRivas:cl,totalSanJorge:Qc,totalIsla:Bf,unitPriceRivas:(Qn==null?void 0:Qn.unitPriceRivas)||pr.unitPriceRivas||0,unitPriceSanJorge:(Qn==null?void 0:Qn.unitPriceSanJorge)||pr.unitPriceSanJorge||0,unitPriceIsla:(Qn==null?void 0:Qn.unitPriceIsla)||pr.unitPriceIsla||0,grossProfit:eo,logisticAllocated:Lc,vendorMarginPercent:Au.vendorMarginPercent,uVendor:Au.uVendor,uNeta:qA,uAproximada:fc,uInvestor:Au.uInvestor,providerPrice:Number(pr.providerPrice??(Qn==null?void 0:Qn.providerPrice)??0),vendorProfit:Au.uVendor,transferDelta:Tn?Number(Tn.transferDelta||0):0},Wu=Yr.get(pr.productId)||[];if(B)if(String(pr.id||"").startsWith("tmp_")){const M=Xt(bt(je,"inventory_candies_sellers"));ho.masterAllocations=Wu,Sr.set(M,ho)}else{const M=Xt(je,"inventory_candies_sellers",pr.id);Wu.length>0&&(ho.masterAllocations=Fee(...Wu)),Sr.set(M,ho,{merge:!0})}else{const M=Xt(bt(je,"inventory_candies_sellers"));ho.masterAllocations=Wu,Sr.set(M,ho)}}}),B&&St){const Sr=new Set(Dt.map(jr=>jr.id)),pr=Sc(je);ct.forEach(jr=>{Sr.has(jr.id)||pr.update(Xt(je,"inventory_candies_sellers",jr.id),{orderName:ft,updatedAt:xr.now()})}),await pr.commit(),I(jr=>jr.map(Tn=>ge(Tn)===B?{...Tn,orderName:ft}:Tn))}m(" Pedido guardado."),E(!1),nr(),s()}catch(et){console.error(et),m(" Error guardando el pedido.")}finally{Q(!1)}},br=async fe=>{try{if(m(""),!l)return m(" Solo admin.");Q(!0);const et=Ee.filter(nt=>ge(nt)===fe);for(const nt of et)await pG(nt.id);m(" Pedido eliminado."),s()}catch(et){console.error(et),m(" Error eliminando pedido.")}finally{Q(!1)}},wr=oi.useRef(null),Xr=()=>{var fe;if(d)return m(" Solo lectura.");if(!T)return m(" Seleccion un vendedor.");if(!K)return m(" Seleccion una fecha.");(fe=wr.current)==null||fe.click()},Ir=async fe=>{var nt;const et=(nt=fe.target.files)==null?void 0:nt[0];fe.target.value="",et&&await Or(et)},Pr=!l,fn=l?12:9;return i.jsxs("div",{className:"p-3 md:p-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 md:gap-3 mb-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h2",{className:"text-lg md:text-2xl font-semibold",children:"rdenes de Vendedor (Dulces)"}),i.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Pedidos agrupados por vendedor + fecha. U. Bruta viene de la orden maestra. U. Neta = U. Bruta - Gastos - U. Vendedor."})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx(Rc,{onClick:s}),l&&i.jsx("button",{onClick:()=>Je(!0),className:"px-3 py-2 rounded bg-amber-600 text-white text-sm hover:bg-amber-700",children:"Traslados"}),!d&&i.jsx("button",{onClick:_r,className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",children:"+ Nuevo pedido"})]})]}),h&&!S&&i.jsx("div",{className:"mb-3 p-2 rounded border text-sm bg-white",children:h}),f?i.jsx("div",{className:"p-4 text-sm text-gray-600",children:"Cargando"}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"hidden md:block bg-white border rounded",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-700",children:["Total pedidos: ",i.jsx("b",{children:pe.length})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:()=>{if(!S){m(" Abr un pedido para exportar productos asociados.");return}er()},children:"Exportar asociados"}),l&&i.jsx(i.Fragment,{children:i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Se,disabled:Z,children:Z?"Actualizando campos...":"Actualizar campos calculados"})})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2 border-b",children:"Nombre"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Fecha"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Asociados"}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Restantes"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Total esperado"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"U. Bruta"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Gastos"}),i.jsx("th",{className:"text-right p-2 border-b",children:"U. Vendedor"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Trasl. Salida"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Trasl. Entrada"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Acciones"})]})}),i.jsxs("tbody",{children:[he.map(fe=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"p-2 border-b",children:fe.orderName||""}),i.jsx("td",{className:"p-2 border-b",children:fe.date}),i.jsx("td",{className:"p-2 border-b",children:fe.sellerName}),i.jsx("td",{className:"p-2 border-b text-right",children:fe.totalPackages}),i.jsx("td",{className:"p-2 border-b text-right",children:fe.totalRemainingPackages}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ai(fe.totalExpectedActive??fe.totalExpected)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ai(fe.grossProfitActive??fe.grossProfit)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ai((fe.gastosActive??fe.gastos)||0)}),i.jsx("td",{className:"p-2 border-b text-right",children:ai(fe.vendorProfitActive??fe.vendorProfit)}),i.jsx("td",{className:"p-2 border-b text-right",children:fe.transferredOut}),i.jsx("td",{className:"p-2 border-b text-right",children:fe.transferredIn}),i.jsx("td",{className:"p-2 border-b",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded bg-gray-900 text-white text-xs hover:bg-black",onClick:()=>or(fe.orderKey),children:"Ver / Editar"}),l&&i.jsx("button",{className:"px-3 py-1.5 rounded bg-red-600 text-white text-xs hover:bg-red-700",onClick:()=>{confirm("Eliminar este pedido completo?")&&br(fe.orderKey)},children:"Eliminar"})]})})]},fe.orderKey)),!he.length&&i.jsx("tr",{children:i.jsx("td",{className:"p-3 text-sm text-gray-600",colSpan:fn,children:"No hay pedidos."})})]})]})}),i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Pgina ",J," / ",He]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:ee,disabled:J<=1,children:""}),i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:_e,disabled:J>=He,children:""})]})]})]}),i.jsxs("div",{className:"md:hidden space-y-2",children:[i.jsxs("div",{className:"bg-white border rounded p-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-700",children:["Total pedidos: ",i.jsx("b",{children:pe.length})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:[J,"/",He]})]}),he.map(fe=>i.jsxs("div",{className:"bg-white border rounded",role:"button",tabIndex:0,onClick:()=>or(fe.orderKey),onKeyDown:et=>{(et.key==="Enter"||et.key===" ")&&(et.preventDefault(),or(fe.orderKey))},children:[i.jsxs("div",{className:"p-2 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold",children:fe.sellerName}),i.jsxs("div",{className:"text-xs text-gray-600",children:[fe.orderName||"","  ",fe.date]})]}),l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm text-red-600",onClick:et=>{et.stopPropagation(),confirm("Eliminar este pedido completo?")&&br(fe.orderKey)},children:"Eliminar"})]}),i.jsx("div",{className:"px-2 pb-2",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"P. Asociados"}),i.jsx("div",{className:"font-semibold",children:fe.totalPackages})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"P. Restantes"}),i.jsx("div",{className:"font-semibold",children:fe.totalRemainingPackages})]}),l&&i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"font-semibold",children:ai(fe.totalExpectedActive??fe.totalExpected)})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"font-semibold",children:ai(fe.vendorProfitActive??fe.vendorProfit)})]})]})})]},fe.orderKey)),!he.length&&i.jsx("div",{className:"p-3 text-sm text-gray-600 bg-white border rounded",children:"No hay pedidos."}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm",onClick:ee,disabled:J<=1,children:""}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm",onClick:_e,disabled:J>=He,children:""})]})]})]}),S&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3 md:p-6",children:i.jsxs("div",{className:"bg-white w-full max-w-5xl max-h-[90vh] overflow-y-auto rounded shadow relative",children:[D&&i.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:i.jsx("div",{className:"text-sm font-semibold",children:"Guardando"})}),i.jsxs("div",{className:"p-3 md:p-5 border-b flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-lg font-semibold",children:B?"Editar pedido":"Nuevo pedido"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Nombre: ",oe||""]}),i.jsx("div",{className:"text-xs text-gray-600",children:"U. Bruta viene de Orden Maestra. U. Vendedor e Inversionista se calculan aqu. U. Neta = U. Bruta - Gastos - U. Vendedor."})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:$r,children:"Cerrar"}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",onClick:ir,children:"Guardar"})]})]}),i.jsxs("div",{className:"p-3 md:p-5 space-y-3",children:[i.jsxs("button",{type:"button",className:"md:hidden w-full px-3 py-2 rounded border text-sm flex items-center justify-between",onClick:()=>ze(fe=>!fe),children:[i.jsx("span",{children:"Filtros y KPIs"}),i.jsx("span",{children:U?"":"+"})]}),i.jsxs("div",{className:`${U?"block":"hidden"} md:block space-y-3`,children:[i.jsxs("div",{className:"grid md:grid-cols-3 gap-2",children:[i.jsxs("div",{className:"md:col-span-3",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Nombre"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:oe,onChange:fe=>ie(fe.target.value),placeholder:"Nombre de la orden",disabled:d})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Vendedor"}),i.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:T,onChange:fe=>P(fe.target.value),disabled:Pr,children:[i.jsx("option",{value:"",children:"-- Seleccionar --"}),p.map(fe=>i.jsxs("option",{value:fe.id,children:[fe.name," ",fe.branch?`(${fe.branch})`:""]},fe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded p-2 text-sm",value:K,onChange:fe=>le(fe.target.value)})]}),i.jsxs("div",{className:"flex items-end gap-2",children:[i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Mr,children:"Plantilla"}),i.jsx("button",{className:"flex-1 px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:Xr,children:"Importar Excel"}),i.jsx("input",{ref:wr,type:"file",accept:".xlsx,.xls",className:"hidden",onChange:Ir})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-2",children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. asociados"}),i.jsx("div",{className:"text-lg font-semibold",children:Nt.totalPackages})]}),l&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"text-lg font-semibold",children:ai(Nt.totalExpected)})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Bruta"}),i.jsx("div",{className:"text-lg font-semibold",children:ai(Nt.grossProfit)})]})]}),i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"text-lg font-semibold",children:ai(Nt.uVendor)})]}),l&&i.jsxs("div",{className:"border rounded p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"U. Neta"}),i.jsx("div",{className:"text-lg font-semibold",children:ai(Rt)})]})]})]}),i.jsxs("div",{className:"border rounded p-3 space-y-2",children:[i.jsxs("button",{type:"button",className:"md:hidden w-full px-3 py-2 rounded border text-sm flex items-center justify-between",onClick:()=>Ot(fe=>!fe),children:[i.jsx("span",{children:"Agregar producto"}),i.jsx("span",{children:jt?"":"+"})]}),i.jsxs("div",{className:`${jt?"block":"hidden"} md:block space-y-2`,children:[i.jsx("div",{className:"text-sm font-semibold hidden md:block",children:"Agregar producto"}),i.jsxs("div",{className:"grid md:grid-cols-4 gap-2",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Buscar"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:G,onChange:fe=>L(fe.target.value),placeholder:"Buscar por categora o nombre"})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Producto"}),i.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:Ae,onChange:fe=>te(fe.target.value),children:[i.jsx("option",{value:"",children:"-- Seleccionar --"}),vt.map(fe=>i.jsxs("option",{value:fe.id,children:[fe.category," - ",fe.name," (exist:"," ",b[fe.id]??0,")"]},fe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("input",{className:"w-full border rounded p-2 text-sm",value:Te,onChange:fe=>Ue(fe.target.value),inputMode:"numeric"})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{className:"w-full px-3 py-2 rounded bg-gray-900 text-white text-sm hover:bg-black",onClick:kr,disabled:!me,children:"Agregar"})})]})]})]}),i.jsxs("div",{className:"border rounded",children:[i.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm font-semibold",children:["Productos asociados (",O.length,")"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"border rounded px-2 py-1 text-sm",placeholder:"Buscar producto",value:W,onChange:fe=>{X(fe.target.value),Ye(1)}}),l&&i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:er,disabled:!O.length,children:"Exportar Excel"})]})]}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1400px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2 border-b",children:"Categora"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Producto"}),i.jsxs("th",{className:"text-right p-2 border-b",children:["P. Asociados"," "]}),i.jsx("th",{className:"text-right p-2 border-b",children:"P. Restantes"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"Precio prov."}),i.jsx("th",{className:"text-right p-2 border-b",children:"Precio/paq"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Total esperado"}),l&&i.jsxs(i.Fragment,{children:[i.jsx("th",{className:"text-right p-2 border-b",children:"U. Bruta"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Gastos"})]}),i.jsx("th",{className:"text-right p-2 border-b",children:"U. Vendedor"}),l&&i.jsx("th",{className:"text-right p-2 border-b",children:"U. Neta"}),i.jsx("th",{className:"text-right p-2 border-b",children:"Margen (%)"}),i.jsx("th",{className:"text-left p-2 border-b",children:"Acciones"})]})}),i.jsxs("tbody",{children:[q.map(fe=>{const{totalExpected:et,grossProfit:nt,gastos:ct,uVendor:ve,uNeta:ft}=st(fe);return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"p-2 border-b",children:fe.category}),i.jsx("td",{className:"p-2 border-b",children:fe.productName}),i.jsx("td",{className:"p-2 border-b text-right",children:d?i.jsx("span",{children:fe.packages}):dt[fe.id]?i.jsx("input",{className:"w-20 border rounded p-1 text-right",value:String(fe.packages),onChange:St=>rn(fe.id,St.target.value),onBlur:()=>rt(fe.id),onKeyDown:St=>{(St.key==="Enter"||St.key==="Escape")&&rt(fe.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:fe.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Pe(fe.id),"aria-label":"Editar paquetes",children:""})]})}),i.jsx("td",{className:"p-2 border-b text-right",children:fe.remainingPackages}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ai(fe.providerPrice||0)}),i.jsx("td",{className:"p-2 border-b text-right",children:ai(fe.pricePerPackage)}),i.jsx("td",{className:"p-2 border-b text-right",children:ai(et)}),l&&i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"p-2 border-b text-right",children:ai(nt)}),i.jsx("td",{className:"p-2 border-b text-right",children:ai(ct)})]}),i.jsx("td",{className:"p-2 border-b text-right",children:ai(ve)}),l&&i.jsx("td",{className:"p-2 border-b text-right",children:ai(ft)}),i.jsx("td",{className:"p-2 border-b text-right",children:d?i.jsxs("span",{children:[Number(fe.vendorMarginPercent??It(T)).toFixed(3),"%"]}):we[fe.id]?i.jsx("input",{type:"number",step:"0.001",min:0,className:"w-20 border rounded p-1 text-right",value:String(fe.vendorMarginPercent??It(T)),onChange:St=>Er(fe.id,St.target.value),onBlur:()=>ht(fe.id),onKeyDown:St=>{(St.key==="Enter"||St.key==="Escape")&&ht(fe.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsxs("span",{children:[Number(fe.vendorMarginPercent??It(T)).toFixed(3),"%"]}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>lt(fe.id),"aria-label":"Editar margen",children:""})]})}),i.jsx("td",{className:"p-2 border-b",children:!d&&i.jsx("button",{className:"px-3 py-1.5 rounded bg-red-600 text-white text-xs hover:bg-red-700",onClick:()=>{confirm("Eliminar este producto?")&&en(fe.id)},children:""})})]},fe.id)}),!q.length&&i.jsx("tr",{children:i.jsx("td",{className:"p-3 text-sm text-gray-600",colSpan:l?13:9,children:"No hay productos asociados."})})]})]})}),i.jsxs("div",{className:"md:hidden p-3 space-y-2",children:[se.map(([fe,et])=>{const nt=!!ot[fe];return i.jsxs("div",{className:"border rounded",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-2 flex items-center justify-between text-sm",onClick:()=>Ne(fe),children:[i.jsx("span",{className:"font-semibold",children:fe}),i.jsxs("span",{className:"text-xs text-gray-600",children:[et.length," ",et.length===1?"producto":"productos"]})]}),nt&&i.jsx("div",{className:"px-3 pb-3 space-y-2",children:et.map(ct=>{const{totalExpected:ve,grossProfit:ft,gastos:St,uVendor:wt,uNeta:yt}=st(ct);return i.jsxs("div",{className:"border rounded p-2 text-xs space-y-2",children:[i.jsx("div",{className:"font-semibold text-sm",children:ct.productName}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes"}),d?i.jsx("div",{className:"font-semibold",children:ct.packages}):dt[ct.id]?i.jsx("input",{className:"w-full border rounded p-1 text-right",value:String(ct.packages),onChange:Et=>rn(ct.id,Et.target.value),onBlur:()=>rt(ct.id),onKeyDown:Et=>{(Et.key==="Enter"||Et.key==="Escape")&&rt(ct.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:ct.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Pe(ct.id),"aria-label":"Editar paquetes",children:""})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:ct.remainingPackages})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Precio/paq"}),i.jsx("div",{className:"font-semibold",children:ai(ct.pricePerPackage)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Total esperado"}),i.jsx("div",{className:"font-semibold",children:ai(ve)})]}),l&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta"}),i.jsx("div",{className:"font-semibold",children:ai(ft)})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"Gastos"}),i.jsx("div",{className:"font-semibold",children:ai(St)})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Vendedor"}),i.jsx("div",{className:"font-semibold",children:ai(wt)})]}),l&&i.jsxs("div",{children:[i.jsx("div",{className:"text-gray-600",children:"U. Neta"}),i.jsx("div",{className:"font-semibold",children:ai(yt)})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-gray-600",children:"Margen (%)"}),d?i.jsxs("div",{className:"font-semibold",children:[Number(ct.vendorMarginPercent??It(T)).toFixed(3),"%"]}):we[ct.id]?i.jsx("input",{type:"number",step:"0.001",min:0,className:"w-full border rounded p-1 text-right",value:String(ct.vendorMarginPercent??It(T)),onChange:Et=>Er(ct.id,Et.target.value),onBlur:()=>ht(ct.id),onKeyDown:Et=>{(Et.key==="Enter"||Et.key==="Escape")&&ht(ct.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsxs("span",{className:"font-semibold",children:[Number(ct.vendorMarginPercent??It(T)).toFixed(3),"%"]}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>lt(ct.id),"aria-label":"Editar margen",children:""})]})]}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white text-xs",onClick:()=>{confirm("Eliminar este producto?")&&en(ct.id)},children:""})]})]},ct.id)})})]},fe)}),!q.length&&i.jsx("div",{className:"p-3 text-sm text-gray-600 text-center",children:"No hay productos asociados."})]}),i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Pgina items ",Be," / ",V]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:Me,disabled:Be<=1,children:""}),i.jsx("button",{className:"px-3 py-1.5 rounded border text-sm hover:bg-gray-50",onClick:Ke,disabled:Be>=V,children:""})]})]})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center md:justify-between",children:[i.jsx("div",{className:"text-xs text-gray-600",children:B?i.jsxs(i.Fragment,{children:["Editando: ",i.jsx("b",{children:B})]}):i.jsx(i.Fragment,{children:"Nuevo pedido (an no guardado)"})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded border text-sm hover:bg-gray-50",onClick:$r,children:"Cancelar"}),!d&&i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm hover:bg-blue-700",onClick:ir,children:"Guardar pedido"})]})]}),h&&i.jsx("div",{className:"text-sm text-gray-700",children:h})]})]})}),i.jsx(aVe,{open:De,onClose:()=>Je(!1),orders:pe,rows:j,setRows:I,isAdmin:l,currentUserEmail:r||"",currentUserName:"",sellerCandyId:e,sellers:p,products:v,transferAgg:Tt,setTransferAgg:Qt,setTransferRowDeltas:Qe})]})}const Hn=t=>Math.max(0,Math.floor(Number(t)||0)),Qb=t=>Math.round(t||0),wE=99.999;function Hse(t){const e=Math.max(1,Hn(t.unitsPerPackage||1)),r=Hn(t.totalUnits||0),n=Hn(t.quantity||0),a=Hn(t.packages||0);return r>0?r:n>0?n:a>0?a*e:0}function iVe(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):Hse(t)}function CG(t){const e=Number(t.remainingPackages);if(Number.isFinite(e))return Math.max(0,Math.floor(e));const r=Math.max(1,Hn(t.unitsPerPackage||1)),n=iVe(t);return Math.max(0,Math.floor(n/r))}function oVe(t){const e=Math.max(1,Hn(t.unitsPerPackage||1)),r=Hse(t);return Math.max(0,Math.floor(r/e))}function Vb(t){return String(t??"").trim().toLowerCase().replace(/\s+/g," ")}function Uf(t){const e=String(t??"").trim();if(!e)return 0;const r=e.replace(/,/g,"."),n=Number(r);return Number.isFinite(n)?n:0}function Fh(t,e){const r={};Object.keys(t||{}).forEach(n=>r[Vb(n)]=t[n]);for(const n of e){const a=r[Vb(n)];if(a!=null&&String(a).trim()!=="")return a}}function sp(t,e,r){const n=t*e,a=wE,s=Math.min(Math.max(r.marginR,0),a)/100,o=Math.min(Math.max(r.marginSJ,0),a)/100,l=Math.min(Math.max(r.marginIsla,0),a)/100,c=e>0&&s<1?n/(1-s):n,u=e>0&&o<1?n/(1-o):n,d=e>0&&l<1?n/(1-l):n,f=c-n,A=u-n,h=d-n,m=e>0?Qb(c/e):0,p=e>0?Qb(u/e):0,x=e>0?Qb(d/e):0;return{subtotal:n,totalRivas:c,totalSanJorge:u,totalIsla:d,gainRivas:f,gainSanJorge:A,gainIsla:h,unitPriceRivas:m,unitPriceSanJorge:p,unitPriceIsla:x}}function lVe(t){return Number(t.gainRivas||0)}function cVe(t){return Number(t.gainIsla||0)}function lT(t,e,r){const n=lVe(t),a=cVe(t),s=Number(t.subtotal||0),o=e>0&&r>0?e*s/r:0;return{...t,grossProfit:n,grossProfitIsla:a,logisticAllocated:o}}function uVe(){const{refreshKey:t,refresh:e}=Mc(),[r,n]=g.useState(""),[a,s]=g.useState(!0),[o,l]=g.useState(!1),[c,u]=g.useState(!1),[d,f]=g.useState(!1),[A,h]=g.useState([]),[m,p]=g.useState(!1),[x,v]=g.useState([]),[y,b]=g.useState({}),[w,j]=g.useState(!1),[I,C]=g.useState(null),[S,E]=g.useState(""),[B,k]=g.useState(""),[T,P]=g.useState("20"),[K,le]=g.useState("15"),[oe,ie]=g.useState("30"),[Ae,te]=g.useState("0"),[Te,Ue]=g.useState([]),[O,H]=g.useState({}),[G,L]=g.useState({}),[W,X]=g.useState({}),[D,Q]=g.useState({}),[Z,be]=g.useState({}),[U,ze]=g.useState({}),[re,J]=g.useState({}),Re=Se=>H(gt=>({...gt,[Se]:!0})),ke=Se=>H(gt=>({...gt,[Se]:!1})),Be=Se=>L(gt=>({...gt,[Se]:!0})),Ye=Se=>L(gt=>({...gt,[Se]:!1})),ot=Se=>X(gt=>({...gt,[Se]:!0})),Ct=Se=>X(gt=>({...gt,[Se]:!1})),jt=Se=>Q(gt=>({...gt,[Se]:!0})),Ot=Se=>Q(gt=>({...gt,[Se]:!1})),Tt=Se=>be(gt=>({...gt,[Se]:!0})),Qt=Se=>be(gt=>({...gt,[Se]:!1})),Ft=Se=>ze(gt=>({...gt,[Se]:!0})),Qe=Se=>ze(gt=>({...gt,[Se]:!1})),De=Se=>J(gt=>({...gt,[Se]:!0})),Je=Se=>J(gt=>({...gt,[Se]:!1})),[dt,ce]=g.useState(""),[we,ue]=g.useState(""),[ne,Ve]=g.useState(""),[it,vt]=g.useState("1"),[me,Ee]=g.useState("0"),[ye,We]=g.useState("DATOS"),[ge,Ie]=g.useState(""),[xt,Pt]=g.useState(1),It=15,Ut=g.useMemo(()=>Math.max(1,Math.ceil(x.length/It)),[x.length]);g.useEffect(()=>Pt(1),[x.length]);const $t=g.useMemo(()=>{const Se=(xt-1)*It;return x.slice(Se,Se+It)},[x,xt]),Le=g.useMemo(()=>{const Se=new Set;for(const gt of A){const er=String(gt.category||"").trim();er&&Se.add(er)}return Array.from(Se).sort((gt,er)=>gt.localeCompare(er,"es"))},[A]);g.useEffect(()=>{!dt&&Le.length>0&&ce(Le[0])},[Le]);const Ce=async()=>{p(!0);try{const Se=await Ht(sr(bt(je,"products_candies"),In("createdAt","desc"))),gt=[];Se.forEach(er=>{const Mr=er.data();gt.push({id:er.id,name:String(Mr.name??"").trim(),category:String(Mr.category??"").trim()||"Caramelo",providerPrice:Number(Mr.providerPrice??0),unitsPerPackage:Number(Mr.unitsPerPackage??1)})}),h(gt)}catch(Se){console.error(Se),n(" Error cargando catlogo de dulces.")}finally{p(!1)}};g.useEffect(()=>{Ce()},[t]);const pe=g.useMemo(()=>(dt.trim().length>0?A.filter(gt=>gt.category===dt):A).sort((gt,er)=>gt.name.localeCompare(er.name,"es")),[A,dt]);g.useEffect(()=>{if(!we){Ve(""),vt("1");return}const Se=A.find(gt=>gt.id===we);Se&&(Ve(String(Se.providerPrice??0)),vt(String(Se.unitsPerPackage??1)))},[we,A]);const He=()=>{C(null),E(""),k(""),Ue([]),H({}),L({}),X({}),Q({}),be({}),ze({}),J({}),ce(Le[0]||""),ue(""),Ve(""),Ee("0"),vt("1"),P("20"),le("15"),ie("30"),te("0"),We("DATOS"),Ie("")},he=()=>{if(n(""),!we){n("Selecciona un producto del catlogo.");return}const Se=A.find(Ir=>Ir.id===we);if(!Se){n("Producto de catlogo no encontrado (refresca).");return}const gt=Number(Se.providerPrice||0),er=Hn(me||0),Mr=Hn(Se.unitsPerPackage||0);if(gt<0){n("El precio proveedor no puede ser negativo.");return}if(er<=0){n("Los paquetes deben ser mayor que 0.");return}if(Mr<=0){n("Las unidades por paquete deben ser mayor que 0.");return}const Or=Number(T||0),ir=Number(K||0),br=Number(oe||0),wr=sp(gt,er,{marginR:Or,marginSJ:ir,marginIsla:br});if(Te.find(Ir=>Ir.id===Se.id))Ue(Ir=>Ir.map(Pr=>{if(Pr.id!==Se.id)return Pr;const fn=Hn(Pr.packages||0)+er,fe=sp(gt,fn,{marginR:Number(Pr.marginRivas??Or),marginSJ:Number(Pr.marginSanJorge??ir),marginIsla:Number(Pr.marginIsla??br)}),nt=Hn(Pr.remainingPackages??Pr.packages)+er;return{...Pr,providerPrice:gt,unitsPerPackage:Mr,packages:fn,remainingPackages:nt,...fe}}));else{const Ir={id:Se.id,name:Se.name,category:Se.category,providerPrice:gt,packages:er,unitsPerPackage:Mr,marginRivas:Or,marginSanJorge:ir,marginIsla:br,subtotal:wr.subtotal,totalRivas:wr.totalRivas,totalSanJorge:wr.totalSanJorge,totalIsla:wr.totalIsla,gainRivas:wr.gainRivas,gainSanJorge:wr.gainSanJorge,gainIsla:wr.gainIsla,unitPriceRivas:wr.unitPriceRivas,unitPriceSanJorge:wr.unitPriceSanJorge,unitPriceIsla:wr.unitPriceIsla,remainingPackages:er};Ue(Pr=>[...Pr,Ir])}ue(""),Ee("0"),We("ITEMS")},ee=Se=>{Ue(gt=>gt.filter(er=>er.id!==Se))},_e=(Se,gt,er)=>{Ue(Mr=>Mr.map(Or=>{if(Or.id!==Se)return Or;let ir={...Or};if(gt==="packages"&&(ir.packages=Hn(er||0)),gt==="unitsPerPackage"&&(ir.unitsPerPackage=Hn(er||0)),gt==="remainingPackages"){const br=Math.max(0,Hn(ir.packages||0)),wr=Hn(er||0);ir.remainingPackages=Math.min(br,Math.max(0,wr))}if(gt==="unitPriceRivas"||gt==="unitPriceIsla"){const br=Math.max(0,Number(er)||0),wr=Math.max(0,Hn(ir.packages||0)),Xr=Number(ir.providerPrice||0)*wr,Ir=wr>0?br*wr:0;if(gt==="unitPriceRivas"){ir.unitPriceRivas=br,ir.totalRivas=Ir,ir.gainRivas=Ir-Xr;const Pr=Ir>0?(1-Xr/Ir)*100:0;ir.marginRivas=Math.min(Math.max(Pr,0),wE)}else{ir.unitPriceIsla=br,ir.totalIsla=Ir,ir.gainIsla=Ir-Xr;const Pr=Ir>0?(1-Xr/Ir)*100:0;ir.marginIsla=Math.min(Math.max(Pr,0),wE)}}if(gt==="marginRivas"&&(ir.marginRivas=Number(er||0)),gt==="marginIsla"&&(ir.marginIsla=Number(er||0)),gt==="marginSanJorge"&&(ir.marginSanJorge=Number(er||0)),gt==="packages"||gt==="marginRivas"||gt==="marginIsla"||gt==="marginSanJorge"){const br=sp(ir.providerPrice,ir.packages,{marginR:Number(ir.marginRivas||0),marginSJ:Number(ir.marginSanJorge||0),marginIsla:Number(ir.marginIsla||0)});ir={...ir,...br}}if(ir.remainingPackages===void 0||ir.remainingPackages===null)ir.remainingPackages=ir.packages;else if(gt==="packages"){const br=Hn(ir.remainingPackages);ir.remainingPackages=Math.min(br,Math.max(0,ir.packages))}return ir}))},R=g.useMemo(()=>{const Se=Te.reduce((ir,br)=>ir+Hn(br.packages),0),gt=Te.reduce((ir,br)=>ir+Number(br.subtotal||0),0),er=Te.reduce((ir,br)=>ir+Number(br.totalRivas||0),0),Mr=Te.reduce((ir,br)=>ir+Number(br.totalSanJorge||0),0),Or=Te.reduce((ir,br)=>ir+Number(br.totalIsla||0),0);return{totalPackages:Se,subtotal:gt,totalRivas:er,totalSanJorge:Mr,totalIsla:Or}},[Te]),V=g.useMemo(()=>{const Se=Math.max(0,Uf(Ae||0)),gt=Number(R.subtotal||0),er=Te.map(br=>lT(br,Se,gt)),Mr=er.reduce((br,wr)=>br+Number(wr.grossProfit||0),0),Or=er.reduce((br,wr)=>br+Number(wr.grossProfitIsla||0),0),ir=er.reduce((br,wr)=>br+Number(wr.logisticAllocated||0),0);return{items:er,logisticsTotal:Se,grossTotal:Mr,grossIslaTotal:Or,logisticAllocatedTotal:ir}},[Te,Ae,R.subtotal]),q=g.useMemo(()=>{const Se=String(ge||"").trim().toLowerCase();return Se?V.items.filter(gt=>{const er=String(gt.name||"").toLowerCase(),Mr=String(gt.category||"").toLowerCase();return er.includes(Se)||Mr.includes(Se)}):V.items},[V.items,ge]),[se,Ne]=g.useState(1),Me=15,Ke=g.useMemo(()=>Math.max(1,Math.ceil(q.length/Me)),[q.length]);g.useEffect(()=>Ne(1),[q.length]);const Pe=g.useMemo(()=>{const Se=(se-1)*Me;return q.slice(Se,Se+Me)},[q,se]),[rt,lt]=g.useState({});g.useEffect(()=>lt({}),[q.length]);const[ht,kt]=g.useState({});g.useEffect(()=>{const Se={};for(const gt of x)gt&&gt.id&&(Se[gt.id]=!1);kt(Se)},[x]);const de=g.useMemo(()=>({totalPackages:R.totalPackages,subtotalCosto:R.subtotal,esperadoRivas:R.totalRivas,esperadoIsla:R.totalIsla,gastosLogisticos:V.logisticsTotal,utilidadBrutaRivas:V.grossTotal,utilidadBrutaIsla:V.grossIslaTotal}),[R,V]),qe=()=>{if(n(""),!A.length){n(" No hay catlogo cargado para generar plantilla.");return}const Se=Number(T||0),gt=Number(oe||0),er=A.slice().sort((Xr,Ir)=>Xr.name.localeCompare(Ir.name,"es")).map(Xr=>({Producto:Xr.name,Paquetes:"","Margen rivas":Se,"Margen Isla":gt,"P. unidad Rivas":"","P. unidad Isla":""})),Mr=[{Campo:"Gastos logisticos",Valor:Uf(Ae||0)}],Or=Qa.book_new(),ir=Qa.json_to_sheet(er),br=Qa.json_to_sheet(Mr);Qa.book_append_sheet(Or,ir,"Productos"),Qa.book_append_sheet(Or,br,"Config");const wr=B&&String(B).trim()||new Date().toISOString().slice(0,10);$2(Or,`plantilla_orden_maestra_${wr}.xlsx`)},at=()=>{if(n(""),!V.items.length){n(" No hay items para exportar.");return}const Se=V.items.slice().sort((ir,br)=>ir.name.localeCompare(br.name,"es")).map(ir=>({Categora:ir.category,Producto:ir.name,Paquetes:Hn(ir.packages),"Paquetes restantes":Hn(ir.remainingPackages??ir.packages),"Und x Paquete":Hn(ir.unitsPerPackage),"Precio proveedor":Number(ir.providerPrice||0),Facturado:Number(ir.subtotal||0),"Esperado Rivas":Number(ir.totalRivas||0),"Esperado Isla":Number(ir.totalIsla||0),"MV Rivas":Number(ir.marginRivas||0),"MV Isla":Number(ir.marginIsla||0),"Utilidad Bruta":Number(ir.grossProfit||0),"Utilidad Bruta Isla":Number(ir.grossProfitIsla||0),"Prorrateo logistico":Number(ir.logisticAllocated||0),"Precio Rivas":Number(ir.unitPriceRivas||0),"Precio Isla":Number(ir.unitPriceIsla||0)})),gt=[{KPI:"Paquetes totales",Valor:de.totalPackages},{KPI:"Subtotal costo",Valor:de.subtotalCosto},{KPI:"Esperado Rivas",Valor:de.esperadoRivas},{KPI:"Esperado Isla",Valor:de.esperadoIsla},{KPI:"Gastos logsticos",Valor:de.gastosLogisticos},{KPI:"Utilidad Bruta Rivas",Valor:de.utilidadBrutaRivas},{KPI:"Utilidad Bruta Isla",Valor:de.utilidadBrutaIsla}],er=Qa.book_new();Qa.book_append_sheet(er,Qa.json_to_sheet(Se),"Productos"),Qa.book_append_sheet(er,Qa.json_to_sheet(gt),"Resumen");const Mr=B&&String(B).trim()||new Date().toISOString().slice(0,10),Or=S&&String(S).trim()||`Orden_${Mr}`;$2(er,`orden_maestra_${Or.replace(/[^\w\-]+/g,"_")}_${Mr}.xlsx`)},st=g.useRef(null),[Nt,Rt]=g.useState(!1),nr=()=>{var Se;if(!A.length){n(" Catlogo no cargado todava. Esper y prob de nuevo.");return}(Se=st.current)==null||Se.click()},_r=async Se=>{var er;const gt=(er=Se.target.files)==null?void 0:er[0];if(gt){Se.target.value="",Rt(!0),n("");try{const Mr=await gt.arrayBuffer(),Or=$v(Mr,{type:"array"}),ir=Or.SheetNames||[],br=Or.Sheets.Productos||Or.Sheets.Plantilla||Or.Sheets[ir[0]];if(!br){n(" No se encontr hoja de Productos/Plantilla.");return}const wr=Qa.sheet_to_json(br,{defval:""});if(!wr.length){n(" El Excel viene vaco.");return}let Xr=0;const Ir=Or.Sheets.Config;if(Ir){const nt=Qa.sheet_to_json(Ir,{defval:""}),ct=new Map;for(const ve of nt){const ft=Vb(Fh(ve,["Campo","Key","Nombre"])??""),St=Fh(ve,["Valor","Value"]);ft&&ct.set(ft,St)}ct.has("gastos logisticos")&&(Xr=Math.max(0,Uf(ct.get("gastos logisticos"))))}else for(const nt of wr){const ct=Fh(nt,["Gastos","Gasto","Gastos logisticos","Logistica"]),ve=Uf(ct);if(ve>0){Xr=ve;break}}te(String(Xr||0));const Pr=new Map;for(const nt of A)Pr.set(Vb(nt.name),nt);const fn=[],fe=new Map;for(let nt=0;nt<wr.length;nt++){const ct=wr[nt],ve=Fh(ct,["Producto","Product","Nombre","Name"]),ft=Fh(ct,["Paquetes","Packages"]),St=Fh(ct,["Margen rivas","Margen Rivas","MV Rivas"]),wt=Fh(ct,["Margen Isla","Margen isla","MV Isla"]),yt=Fh(ct,["P. unidad Rivas","P unidad Rivas","Precio Rivas"]),Et=Fh(ct,["P. unidad Isla","P unidad Isla","Precio Isla"]),qt=Vb(ve);if(!qt)continue;const Mt=Pr.get(qt);if(!Mt){fn.push(`Fila ${nt+2}: Producto no existe en catlogo: "${String(ve).trim()}".`);continue}const Yt=Math.floor(Uf(ft));if(Yt<=0){fn.push(`Fila ${nt+2}: "Paquetes" invlido para "${Mt.name}".`);continue}const ar=String(St??"").trim()!==""?Uf(St):Number(T||0),vr=String(wt??"").trim()!==""?Uf(wt):Number(oe||0),ur=Math.floor(Uf(yt)),Dt=Math.floor(Uf(Et)),Yr=fe.get(Mt.id);Yr?fe.set(Mt.id,{packages:Yr.packages+Yt,mR:ar,mI:vr,puR:ur>0?ur:Yr.puR,puI:Dt>0?Dt:Yr.puI}):fe.set(Mt.id,{packages:Yt,mR:ar,mI:vr,puR:ur>0?ur:void 0,puI:Dt>0?Dt:void 0})}const et=[];fe.forEach((nt,ct)=>{const ve=A.find(Dt=>Dt.id===ct);if(!ve)return;const ft=Number(ve.providerPrice||0),St=Math.max(1,Hn(ve.unitsPerPackage||1)),wt=Math.max(1,Hn(nt.packages)),yt=ft*wt,Et=Number(nt.puR||0),qt=Number(nt.puI||0),Mt=Et>0||qt>0;let Yt=nt.mR,ar=nt.mI;const vr=Number(K||0);let ur;if(Mt){const Dt=sp(ft,wt,{marginR:Yt,marginSJ:vr,marginIsla:ar}),Yr=Et>0?Et*wt:Dt.totalRivas,Vr=qt>0?qt*wt:Dt.totalIsla,Sr=pr=>{if(!Number.isFinite(pr)||pr<=0)return 0;const jr=(1-yt/pr)*100;return Math.min(Math.max(jr,0),wE)};Et>0&&(Yt=Sr(Yr)),qt>0&&(ar=Sr(Vr)),ur={subtotal:yt,totalRivas:Yr,totalSanJorge:Dt.totalSanJorge,totalIsla:Vr,gainRivas:Yr-yt,gainSanJorge:Dt.gainSanJorge,gainIsla:Vr-yt,unitPriceRivas:wt>0?Qb(Yr/wt):0,unitPriceSanJorge:Dt.unitPriceSanJorge,unitPriceIsla:wt>0?Qb(Vr/wt):0}}else ur=sp(ft,wt,{marginR:Yt,marginSJ:vr,marginIsla:ar});et.push({id:ve.id,name:ve.name,category:ve.category,providerPrice:ft,packages:wt,unitsPerPackage:St,marginRivas:Yt,marginSanJorge:vr,marginIsla:ar,subtotal:ur.subtotal,totalRivas:ur.totalRivas,totalSanJorge:ur.totalSanJorge,totalIsla:ur.totalIsla,gainRivas:ur.gainRivas,gainSanJorge:ur.gainSanJorge,gainIsla:ur.gainIsla,unitPriceRivas:ur.unitPriceRivas,unitPriceSanJorge:ur.unitPriceSanJorge,unitPriceIsla:ur.unitPriceIsla,remainingPackages:wt})}),Ue(nt=>{const ct=new Map;nt.forEach(ve=>ct.set(ve.id,ve));for(const ve of et){const ft=ct.get(ve.id);if(!ft)ct.set(ve.id,ve);else{const St=Hn(ft.packages)+Hn(ve.packages),wt=sp(ft.providerPrice,St,{marginR:ve.marginRivas,marginSJ:Number(ft.marginSanJorge||0),marginIsla:ve.marginIsla});ct.set(ve.id,{...ft,packages:St,marginRivas:ve.marginRivas,marginIsla:ve.marginIsla,remainingPackages:Hn(ft.remainingPackages??ft.packages)+Hn(ve.packages),...wt})}}return Array.from(ct.values()).sort((ve,ft)=>ve.name.localeCompare(ft.name,"es"))}),We("ITEMS"),fn.length?(n(` Importado con detalles. Errores: ${fn.length}.`),console.warn("Errores import:",fn)):n(` Importacin lista: ${et.length} productos agregados.`)}catch(Mr){console.error(Mr),n(" Error importando Excel. Revis hojas: Productos + Config (o Plantilla).")}finally{Rt(!1)}}};g.useEffect(()=>{(async()=>{s(!0);try{const Se=sr(bt(je,"candy_main_orders"),In("createdAt","desc")),gt=await Ht(Se),er=[];gt.forEach(ir=>{const br=ir.data();er.push({id:ir.id,name:br.name??"",date:br.date??"",totalPackages:Number(br.totalPackages??0),subtotal:Number(br.subtotal??0),totalRivas:Number(br.totalRivas??0),totalSanJorge:Number(br.totalSanJorge??0),totalIsla:Number(br.totalIsla??0),marginRivas:Number(br.marginRivas??20),marginSanJorge:Number(br.marginSanJorge??15),marginIsla:Number(br.marginIsla??30),logisticsCost:Number(br.logisticsCost??0),createdAt:br.createdAt??xr.now()})}),v(er);const Mr=await Ht(bt(je,"inventory_candies")),Or={};Mr.forEach(ir=>{const br=ir.data(),wr=br.orderId;if(!wr)return;const Xr=oVe(br),Ir=CG(br);Or[wr]||(Or[wr]={orderId:wr,totalPackages:0,remainingPackages:0}),Or[wr].totalPackages+=Xr,Or[wr].remainingPackages+=Ir}),b(Or)}catch(Se){console.error(Se),n(" Error cargando pedidos generales.")}finally{s(!1)}})()},[t]);const $r=Se=>{var gt;return Se.date?Se.date:(gt=Se.createdAt)!=null&&gt.toDate?Se.createdAt.toDate().toISOString().slice(0,10):""},or=async Se=>{if(Se.preventDefault(),n(""),l(!0),!Te.length){n("Agrega al menos un producto a la orden.");return}try{const gt=new Date().toISOString().slice(0,10),er=B||gt,Mr=Number(T||0),Or=Number(K||0),ir=Number(oe||0),br=Math.max(0,Uf(Ae||0));for(const nt of Te){if(!String(nt.name||"").trim()){n("Hay un producto sin nombre en el pedido.");return}if(Number(nt.providerPrice||0)<0){n(`El precio proveedor no puede ser negativo (producto: ${nt.name}).`);return}if(Hn(nt.packages)<=0){n(`Los paquetes deben ser mayor que 0 (producto: ${nt.name}).`);return}if(Hn(nt.unitsPerPackage)<=0){n(`Las unidades por paquete deben ser mayor que 0 (producto: ${nt.name}).`);return}}const wr=Number(R.subtotal||0),Xr=Te.map(nt=>lT(nt,br,wr)),Ir={totalPackages:R.totalPackages,subtotal:R.subtotal,totalRivas:R.totalRivas,totalSanJorge:R.totalSanJorge,totalIsla:R.totalIsla},Pr={name:S||`Pedido ${er}`,date:er,totalPackages:Ir.totalPackages,subtotal:Ir.subtotal,totalRivas:Ir.totalRivas,totalSanJorge:Ir.totalSanJorge,totalIsla:Ir.totalIsla,marginRivas:Mr,marginSanJorge:Or,marginIsla:ir,logisticsCost:br,uBrutaGlobal:V.grossTotal,items:Xr};if(I){await kn(Xt(je,"candy_main_orders",I),{...Pr});for(const ve of Xr){const ft=await Ht(sr(bt(je,"inventory_candies"),Ar("orderId","==",I),Ar("productId","==",ve.id))),St=Math.max(1,Hn(ve.unitsPerPackage||1)),wt=Hn(ve.packages)*St,yt=Math.min(Hn(ve.remainingPackages??ve.packages),Hn(ve.packages)),Et=Math.max(0,yt*St);if(ft.empty)await Wn(bt(je,"inventory_candies"),{productId:ve.id,productName:ve.name,category:ve.category,measurement:"unidad",quantity:wt,remaining:Et,packages:Hn(ve.packages),remainingPackages:yt,unitsPerPackage:St,totalUnits:wt,providerPrice:ve.providerPrice,subtotal:ve.subtotal,totalRivas:ve.totalRivas,totalSanJorge:ve.totalSanJorge,totalIsla:ve.totalIsla,gainRivas:ve.gainRivas,gainSanJorge:ve.gainSanJorge,gainIsla:ve.gainIsla,unitPriceRivas:ve.unitPriceRivas,unitPriceSanJorge:ve.unitPriceSanJorge,unitPriceIsla:ve.unitPriceIsla,date:er,createdAt:xr.now(),status:"PENDIENTE",orderId:I});else for(const qt of ft.docs)await kn(Xt(je,"inventory_candies",qt.id),{productName:ve.name,category:ve.category,unitsPerPackage:St,totalUnits:wt,quantity:wt,remaining:Et,packages:Hn(ve.packages),remainingPackages:yt,providerPrice:ve.providerPrice,subtotal:ve.subtotal,totalRivas:ve.totalRivas,totalSanJorge:ve.totalSanJorge,totalIsla:ve.totalIsla,gainRivas:ve.gainRivas,gainSanJorge:ve.gainSanJorge,gainIsla:ve.gainIsla,unitPriceRivas:ve.unitPriceRivas,unitPriceSanJorge:ve.unitPriceSanJorge,unitPriceIsla:ve.unitPriceIsla,date:er})}const nt=await Ht(sr(bt(je,"inventory_candies"),Ar("orderId","==",I))),ct=new Set(Xr.map(ve=>ve.id));for(const ve of nt.docs){const ft=ve.data(),St=String(ft.productId||"");St&&!ct.has(St)&&await zn(Xt(je,"inventory_candies",ve.id))}v(ve=>ve.map(ft=>ft.id===I?{...ft,name:Pr.name,date:Pr.date,totalPackages:Pr.totalPackages,subtotal:Pr.subtotal,totalRivas:Pr.totalRivas,totalSanJorge:Pr.totalSanJorge,totalIsla:Pr.totalIsla,marginRivas:Pr.marginRivas,marginSanJorge:Pr.marginSanJorge,marginIsla:Pr.marginIsla,logisticsCost:Pr.logisticsCost}:ft)),n(" Orden maestra actualizada (pedido + inventario)."),He(),j(!1),e();return}const fe=(await Wn(bt(je,"candy_main_orders"),{...Pr,createdAt:xr.now()})).id,et=Sc(je);for(const nt of Xr){const ct=Math.max(1,Hn(nt.unitsPerPackage||1)),ve=Hn(nt.packages)*ct,ft=Math.min(Hn(nt.remainingPackages??nt.packages),Hn(nt.packages)),St=Math.max(0,ft*ct),wt=Xt(bt(je,"inventory_candies"));et.set(wt,{productId:nt.id,productName:nt.name,category:nt.category,measurement:"unidad",quantity:ve,remaining:St,packages:Hn(nt.packages),remainingPackages:ft,unitsPerPackage:ct,totalUnits:ve,providerPrice:nt.providerPrice,subtotal:nt.subtotal,totalRivas:nt.totalRivas,totalSanJorge:nt.totalSanJorge,totalIsla:nt.totalIsla,gainRivas:nt.gainRivas,gainSanJorge:nt.gainSanJorge,gainIsla:nt.gainIsla,unitPriceRivas:nt.unitPriceRivas,unitPriceSanJorge:nt.unitPriceSanJorge,unitPriceIsla:nt.unitPriceIsla,date:er,createdAt:xr.now(),status:"PENDIENTE",orderId:fe})}await et.commit(),n(" Orden maestra creada y registrada en inventario."),He(),j(!1),e()}catch(gt){console.error(gt),n(" Error al guardar orden maestra.")}finally{l(!1)}},kr=async Se=>{try{s(!0),n(""),C(Se.id),E(Se.name),k(Se.date),P(String(Se.marginRivas??20)),le(String(Se.marginSanJorge??15)),ie(String(Se.marginIsla??30));const gt=Number(Se.logisticsCost??0);te(String(gt||0)),We("DATOS");const er=Xt(je,"candy_main_orders",Se.id),Mr=await Cs(er);if(!Mr.exists()){n(" No se encontr la orden.");return}const Or=Mr.data(),ir=Array.isArray(Or.items)?Or.items:[],br=await Ht(sr(bt(je,"inventory_candies"),Ar("orderId","==",Se.id))),wr={};br.forEach(Ir=>{const Pr=Ir.data(),fn=String(Pr.productId||"");if(!fn)return;const fe=CG(Pr);wr[fn]=(wr[fn]||0)+fe});const Xr=ir.map(Ir=>{const Pr=A.find(ft=>ft.id===Ir.id),fn=Number((Pr==null?void 0:Pr.providerPrice)??Ir.providerPrice??0),fe=Math.max(1,Hn((Pr==null?void 0:Pr.unitsPerPackage)??Ir.unitsPerPackage??1)),et=Number(Ir.marginRivas??0),nt=Number(Ir.marginSanJorge??Number(K||0)),ct=Number(Ir.marginIsla??0),ve=sp(fn,Hn(Ir.packages||0),{marginR:et,marginSJ:nt,marginIsla:ct});return{...Ir,name:String((Pr==null?void 0:Pr.name)??Ir.name??"").trim(),category:String((Pr==null?void 0:Pr.category)??Ir.category??"Caramelo").trim(),providerPrice:fn,unitsPerPackage:fe,remainingPackages:wr[Ir.id]??Ir.remainingPackages??Ir.packages??0,...ve}});Ue(Xr),j(!0)}catch(gt){console.error(gt),n(" Error al abrir orden maestra.")}finally{s(!1)}},en=async Se=>{if(confirm(`Eliminar la orden "${Se.name}" y todo su inventario asociado?`)){n("");try{const er=await Ht(sr(bt(je,"inventory_candies"),Ar("orderId","==",Se.id)));for(const Mr of er.docs)await zn(Xt(je,"inventory_candies",Mr.id));await zn(Xt(je,"candy_main_orders",Se.id)),v(Mr=>Mr.filter(Or=>Or.id!==Se.id)),n(" Orden maestra eliminada."),e()}catch(er){console.error(er),n(" Error al eliminar orden maestra.")}}},rn=async()=>{if(!c)try{u(!0),n("");const Se=await Ht(bt(je,"candy_main_orders"));let gt=Sc(je),er=0,Mr=0;const Or=(ir,br)=>Math.abs(Number(ir||0)-Number(br||0))>.01;Se.forEach(ir=>{const br=ir.data(),wr=Array.isArray(br.items)?br.items:[];if(!wr.length)return;const Xr=wr.reduce((nt,ct)=>nt+Number(ct.subtotal||0),0);let Ir=Number(br.logisticsCost??br.gastosLogisticos??br.gastos??0);if(Number.isFinite(Ir)||(Ir=0),!Ir){const nt=wr.reduce((ct,ve)=>ct+Number(ve.logisticAllocated??0),0);Ir=Number(nt||0)}const Pr=wr.map(nt=>lT(nt,Ir,Xr)),fn=Pr.reduce((nt,ct)=>nt+Number(ct.grossProfit||0),0);if(!(Or(br.logisticsCost,Ir)||Or(br.uBrutaGlobal,fn)||Pr.some((nt,ct)=>{const ve=wr[ct]||{};return Or(ve.logisticAllocated,nt.logisticAllocated)||Or(ve.grossProfit,nt.grossProfit)||Or(ve.grossProfitIsla,nt.grossProfitIsla)})))return;const et=Xt(je,"candy_main_orders",ir.id);gt.update(et,{logisticsCost:Ir,uBrutaGlobal:fn,items:Pr,updatedAt:xr.now()}),er+=1,Mr+=1,er>=400&&(gt.commit(),gt=Sc(je),er=0)}),er>0&&await gt.commit(),n(` Ordenes maestras actualizadas: ${Mr}`),e()}catch(Se){console.error(Se),n(" Error actualizando prorrateo de rdenes maestras.")}finally{u(!1)}},Er=async()=>{if(I&&!d)try{f(!0),n("");const Se=await yF(I);Se.created>0||Se.updated>0?n(` Inventario listo: ${Se.created} creados, ${Se.updated} reparados (de ${Se.totalItems}).`):Se.totalItems>0?n(" No haba inventario faltante para crear o reparar."):n(" La orden no tiene items para crear inventario."),e()}catch(Se){console.error(Se),n(" Error creando inventario faltante.")}finally{f(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"mb-3",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Ordenes Maestras"})}),i.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[i.jsx("div",{}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Rc,{onClick:e,loading:a||m}),i.jsx("button",{className:"inline-flex items-center gap-2 bg-gray-200 text-gray-800 px-2 md:px-3 py-2 rounded-2xl hover:bg-gray-300 disabled:opacity-60",onClick:rn,disabled:c,children:c?"Actualizando prorrateo...":"Actualizar prorrateo"}),i.jsxs("button",{className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-2 md:px-3 py-2 rounded-2xl hover:bg-indigo-700 w-full md:w-auto max-w-[220px] justify-center",onClick:()=>{He(),j(!0)},children:[i.jsx("span",{className:"items-center gap-4 inline-block bg-indigo-700/40 rounded-full p-1",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Orden"]})]})]}),r&&i.jsx("p",{className:"mt-2 text-sm",children:r})]}),w&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"relative bg-white p-4 md:p-6 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[o&&i.jsx("div",{className:"absolute inset-0 bg-white/70 z-50 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white border rounded-xl px-4 py-3 shadow flex items-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5 text-gray-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-semibold",children:"Guardando orden"})]})}),i.jsxs("div",{className:"sticky top-0 bg-white z-20 pb-3 border-b",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("h3",{className:"text-lg md:text-xl font-bold",children:I?"Editar Orden Maestra":"Nueva Orden Maestra"}),i.jsxs("div",{className:"ml-auto flex gap-2",children:[I&&i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",disabled:o||d,onClick:Er,children:d?"Creando inventario...":"Crear inventario faltante"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",disabled:o,onClick:()=>{He(),j(!1)},children:"Cerrar"})]})]}),i.jsx("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-1 gap-2",children:i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-semibold",children:"Gastos logsticos (orden)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:Ae,onChange:Se=>te(Se.target.value),placeholder:"0",min:0})]})}),i.jsx("div",{className:"md:hidden mt-3",children:i.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[i.jsx("button",{type:"button",onClick:()=>We("DATOS"),className:`px-2 py-2 rounded text-xs font-semibold border ${ye==="DATOS"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Datos"}),i.jsx("button",{type:"button",onClick:()=>We("AGREGAR"),className:`px-2 py-2 rounded text-xs font-semibold border ${ye==="AGREGAR"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Agregar"}),i.jsxs("button",{type:"button",onClick:()=>We("ITEMS"),className:`px-2 py-2 rounded text-xs font-semibold border ${ye==="ITEMS"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:["Items (",Te.length,")"]}),i.jsx("button",{type:"button",onClick:()=>We("TOTALES"),className:`px-2 py-2 rounded text-xs font-semibold border ${ye==="TOTALES"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Totales"})]})})]}),i.jsxs("form",{onSubmit:or,className:"space-y-4 pt-4",children:[i.jsx("input",{ref:st,type:"file",accept:".xlsx,.xls,.csv",className:"hidden",onChange:_r}),i.jsx("div",{className:`${ye==="DATOS"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de Orden"}),i.jsx("input",{className:"w-full border p-2 rounded",value:S,onChange:Se=>E(Se.target.value),placeholder:"Ej: Pedido enero 19"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del pedido"}),i.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:B,onChange:Se=>k(Se.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Rivas"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:T,onChange:Se=>P(Se.target.value)})]}),i.jsx("input",{type:"hidden",value:K,readOnly:!0}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Isla Ometepe"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:oe,onChange:Se=>ie(Se.target.value)})]})]})}),i.jsx("div",{className:`${ye==="AGREGAR"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Categora (dinmica)"}),i.jsx("select",{className:"w-full border p-2 rounded",value:dt,onChange:Se=>{ce(Se.target.value),ue("")},disabled:m,children:Le.length===0?i.jsx("option",{value:"",children:m?"Cargando...":"No hay categoras en catlogo"}):Le.map(Se=>i.jsx("option",{value:Se,children:Se},Se))})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Producto (catlogo)"}),i.jsxs("select",{className:"w-full border p-2 rounded",value:we,onChange:Se=>ue(Se.target.value),children:[i.jsx("option",{value:"",children:m?"Cargando catlogo...":"Selecciona producto"}),pe.map(Se=>i.jsx("option",{value:Se.id,children:Se.name},Se.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor (paq)"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:ne,readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Paquetes"}),i.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:me,onChange:Se=>Ee(Se.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold",children:"Unidades por paquete"}),i.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:it,readOnly:!0})]})]}),i.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-end gap-2 mt-3",children:i.jsx("button",{type:"button",onClick:he,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto"})})]})}),i.jsxs("div",{className:"hidden md:flex items-center justify-end gap-2",children:[i.jsx("button",{type:"button",onClick:qe,className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",title:"Descarga plantilla (Productos + Config)",children:"Descargar plantilla"}),i.jsx("button",{type:"button",onClick:nr,disabled:Nt,className:"px-3 py-2 rounded bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-60",title:"Importa desde Excel (Productos + Config)",children:Nt?"Importando...":"Importar Excel"}),i.jsx("button",{type:"button",onClick:at,className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",title:"Exporta la orden actual (Productos + Resumen)",children:"Exportar Excel"})]}),i.jsx("div",{className:`${ye==="ITEMS"?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"mb-2 flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Items:"," ",i.jsx("span",{className:"font-semibold",children:Te.length}),ge.trim()?i.jsxs(i.Fragment,{children:[" "," Mostrando"," ",i.jsx("span",{className:"font-semibold",children:q.length})]}):null]}),i.jsx("input",{value:ge,onChange:Se=>Ie(Se.target.value),placeholder:"Buscar producto o categora",className:"w-full md:w-80 border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{className:"hidden md:block",children:[i.jsx("div",{className:"overflow-x-auto border rounded pb-5",children:i.jsxs("table",{className:"min-w-[1400px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"text-left p-2",children:"Categora"}),i.jsx("th",{className:"text-left p-2",children:"Producto"}),i.jsx("th",{className:"text-right p-2",children:"Paquetes"}),i.jsx("th",{className:"text-right p-2",children:"Restantes"}),i.jsx("th",{className:"text-right p-2",children:"Und x Paq"}),i.jsx("th",{className:"text-right p-2",children:"Precio prov"}),i.jsx("th",{className:"text-right p-2",children:"Facturado"}),i.jsx("th",{className:"text-right p-2",children:"Esperado Rivas"}),i.jsx("th",{className:"text-right p-2",children:"Esperado Isla"}),i.jsx("th",{className:"text-right p-2",children:"MV Rivas"}),i.jsx("th",{className:"text-right p-2",children:"MV Isla"}),i.jsx("th",{className:"text-right p-2",children:"U. Bruta Rivas"}),i.jsx("th",{className:"text-right p-2",children:"U. Bruta Isla"}),i.jsx("th",{className:"text-right p-2",children:"Prorrateo"}),i.jsx("th",{className:"text-right p-2",children:"Precio Rivas"}),i.jsx("th",{className:"text-right p-2",children:"Precio Isla"}),i.jsx("th",{className:"text-center p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[Pe.map(Se=>i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:Se.category}),i.jsx("td",{className:"p-2 font-semibold",children:Se.name}),i.jsx("td",{className:"p-2 text-right",children:O[Se.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Se.packages,onChange:gt=>_e(Se.id,"packages",gt.target.value),onBlur:()=>ke(Se.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&ke(Se.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Se.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Re(Se.id),"aria-label":"Editar paquetes",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:W[Se.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Hn(Se.remainingPackages??Se.packages),onChange:gt=>_e(Se.id,"remainingPackages",gt.target.value),onBlur:()=>Ct(Se.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Ct(Se.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Hn(Se.remainingPackages??Se.packages)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ot(Se.id),"aria-label":"Editar paquetes restantes",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:G[Se.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Se.unitsPerPackage,onChange:gt=>_e(Se.id,"unitsPerPackage",gt.target.value),onBlur:()=>Ye(Se.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Ye(Se.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Se.unitsPerPackage}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Be(Se.id),"aria-label":"Editar unidades por paquete",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:Number(Se.providerPrice||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Se.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Se.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Se.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:U[Se.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-16 border rounded p-1 text-right",value:Number(Se.marginRivas??0),onChange:gt=>_e(Se.id,"marginRivas",gt.target.value),onBlur:()=>Qe(Se.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Qe(Se.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(Se.marginRivas??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Ft(Se.id),"aria-label":"Editar margen Rivas",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:re[Se.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-16 border rounded p-1 text-right",value:Number(Se.marginIsla??0),onChange:gt=>_e(Se.id,"marginIsla",gt.target.value),onBlur:()=>Je(Se.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Je(Se.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(Se.marginIsla??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>De(Se.id),"aria-label":"Editar margen Isla",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:Number(Se.grossProfit||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Se.grossProfitIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:Number(Se.logisticAllocated||0).toFixed(2)}),i.jsx("td",{className:"p-2 text-right",children:D[Se.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Number(Se.unitPriceRivas||0),onChange:gt=>_e(Se.id,"unitPriceRivas",gt.target.value),onBlur:()=>Ot(Se.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Ot(Se.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(Se.unitPriceRivas||0)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>jt(Se.id),"aria-label":"Editar precio Rivas",children:""})]})}),i.jsx("td",{className:"p-2 text-right",children:Z[Se.id]?i.jsx("input",{type:"number",className:"w-20 border rounded p-1 text-right",value:Number(Se.unitPriceIsla||0),onChange:gt=>_e(Se.id,"unitPriceIsla",gt.target.value),onBlur:()=>Qt(Se.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Qt(Se.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{children:Number(Se.unitPriceIsla||0)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Tt(Se.id),"aria-label":"Editar precio Isla",children:""})]})}),i.jsx("td",{className:"p-2 text-center",children:i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>ee(Se.id),children:"Quitar"})})]},Se.id)),q.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:17,className:"p-4 text-center text-gray-500",children:"No hay productos en la orden."})})]})]})}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando"," ",Math.min((se-1)*Me+1,q.length),"-",Math.min(se*Me,q.length)," ","de ",q.length]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:se<=1,onClick:()=>Ne(Se=>Math.max(1,Se-1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Anterior"}),i.jsxs("div",{className:"px-3 py-1 border rounded text-sm",children:[se," / ",Ke]}),i.jsx("button",{type:"button",disabled:se>=Ke,onClick:()=>Ne(Se=>Math.min(Ke,Se+1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Siguiente"})]})]})]}),i.jsx("div",{className:"md:hidden space-y-3",children:q.length===0?i.jsx("div",{className:"p-4 border rounded bg-gray-50 text-gray-600",children:"No hay productos en esta orden."}):q.map(Se=>i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm",children:[i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-semibold text-base leading-tight truncate",children:Se.name}),i.jsx("div",{className:"text-xs text-gray-500 truncate",children:Se.category})]}),i.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ee(Se.id),children:"Quitar"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes"}),O[Se.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-full border p-2 rounded text-right",value:Se.packages,onChange:gt=>_e(Se.id,"packages",gt.target.value),onBlur:()=>ke(Se.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&ke(Se.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Se.packages}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Re(Se.id),"aria-label":"Editar paquetes",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes restantes"}),W[Se.id]?i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:Hn(Se.remainingPackages??Se.packages),onChange:gt=>_e(Se.id,"remainingPackages",gt.target.value),onBlur:()=>Ct(Se.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Ct(Se.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Hn(Se.remainingPackages??Se.packages)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>ot(Se.id),"aria-label":"Editar paquetes restantes",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Und x Paquete"}),G[Se.id]?i.jsx("input",{type:"number",step:"0.001",className:"w-full border p-2 rounded text-right",value:Se.unitsPerPackage,onChange:gt=>_e(Se.id,"unitsPerPackage",gt.target.value),onBlur:()=>Ye(Se.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Ye(Se.id)},inputMode:"numeric",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Se.unitsPerPackage}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Be(Se.id),"aria-label":"Editar unidades por paquete",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Precio proveedor"}),i.jsx("input",{className:"w-full border p-2 rounded text-right bg-gray-100",value:Number(Se.providerPrice||0).toFixed(2),readOnly:!0})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"MV Rivas (%)"}),U[Se.id]?i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:Se.marginRivas??0,onChange:gt=>_e(Se.id,"marginRivas",gt.target.value),onBlur:()=>Qe(Se.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Qe(Se.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Number(Se.marginRivas??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Ft(Se.id),"aria-label":"Editar margen Rivas",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs text-gray-600",children:"MV Isla (%)"}),re[Se.id]?i.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:Se.marginIsla??0,onChange:gt=>_e(Se.id,"marginIsla",gt.target.value),onBlur:()=>Je(Se.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Je(Se.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Number(Se.marginIsla??0).toFixed(3)}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>De(Se.id),"aria-label":"Editar margen Isla",children:""})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Facturado"}),i.jsx("div",{className:"font-semibold",children:Number(Se.subtotal||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(Se.totalRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado Isla"}),i.jsx("div",{className:"font-semibold",children:Number(Se.totalIsla||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Prorrateo logstico"}),i.jsx("div",{className:"font-semibold",children:Number(Se.logisticAllocated||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(Se.grossProfit||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta Isla"}),i.jsx("div",{className:"font-semibold",children:Number(Se.grossProfitIsla||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Precio Rivas (paq)"}),D[Se.id]?i.jsx("input",{type:"number",className:"w-full border rounded p-2 text-right",value:Number(Se.unitPriceRivas||0),onChange:gt=>_e(Se.id,"unitPriceRivas",gt.target.value),onBlur:()=>Ot(Se.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Ot(Se.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Se.unitPriceRivas}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>jt(Se.id),"aria-label":"Editar precio Rivas",children:""})]})]}),i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Precio Isla (paq)"}),Z[Se.id]?i.jsx("input",{type:"number",className:"w-full border rounded p-2 text-right",value:Number(Se.unitPriceIsla||0),onChange:gt=>_e(Se.id,"unitPriceIsla",gt.target.value),onBlur:()=>Qt(Se.id),onKeyDown:gt=>{(gt.key==="Enter"||gt.key==="Escape")&&Qt(Se.id)},inputMode:"decimal",autoFocus:!0}):i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("span",{className:"font-semibold",children:Se.unitPriceIsla}),i.jsx("button",{type:"button",className:"text-xs text-gray-600 hover:text-gray-900",onClick:()=>Tt(Se.id),"aria-label":"Editar precio Isla",children:""})]})]})]})]},Se.id))})]})}),i.jsxs("div",{className:`${ye==="TOTALES"?"block":"hidden"} md:block`,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mt-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"text-lg font-semibold",children:de.totalPackages})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal costo (facturado)"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(de.subtotalCosto||0).toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Esperado (Rivas / Isla)"}),i.jsxs("div",{className:"text-sm font-semibold",children:["Rivas: ",Number(de.esperadoRivas||0).toFixed(2),i.jsx("br",{}),"Isla: ",Number(de.esperadoIsla||0).toFixed(2)]})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos logsticos"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(de.gastosLogisticos||0).toFixed(2)})]})]}),i.jsxs("div",{className:"mt-3",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-emerald-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Rivas"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(de.utilidadBrutaRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-3 border rounded bg-emerald-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Isla"}),i.jsx("div",{className:"text-lg font-semibold",children:Number(de.utilidadBrutaIsla||0).toFixed(2)})]})]}),i.jsx("div",{className:"mt-3 border rounded p-3 bg-white",children:i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:at,disabled:!V.items.length,title:"Exporta la orden actual (productos + resumen)",children:"Exportar orden a Excel"})})})]})]}),i.jsxs("div",{className:"sticky bottom-0 bg-white pt-3 mt-4 border-t",children:[i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{type:"button",onClick:He,className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar orden"}),i.jsx("button",{type:"button",onClick:()=>{He(),j(!1)},className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Cerrar"}),i.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",disabled:o||Te.length===0,children:o?"Guardando...":"Guardar orden"})]}),i.jsx("div",{className:"md:hidden mt-2",children:i.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 text-sm",onClick:()=>{We(ye==="DATOS"&&!I?"AGREGAR":ye==="DATOS"||ye==="AGREGAR"?"ITEMS":ye==="ITEMS"?"TOTALES":"DATOS")},children:"Siguiente"})})]})]})]})}),i.jsxs("div",{className:"mt-4",children:[i.jsx("div",{className:"md:hidden space-y-3",children:a?i.jsx("div",{className:"p-4 border rounded bg-white text-center",children:"Cargando"}):x.length===0?i.jsx("div",{className:"p-4 border rounded bg-white text-center",children:"Sin ordenes maestras."}):x.map(Se=>{const gt=y[Se.id],er=$r(Se),Mr=Se.totalPackages>0?(Se.subtotal/Se.totalPackages).toFixed(2):"0.00",Or=Number(Se.logisticsCost||0),ir=Number(Se.totalRivas||0)-Number(Se.subtotal||0);return i.jsxs("div",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-xs text-gray-500",children:er}),i.jsx("div",{className:"font-semibold text-base leading-tight",children:Se.name})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-xs",onClick:()=>kr(Se),children:"Ver"}),i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white text-xs",onClick:()=>en(Se),children:"Borrar"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-semibold",children:Se.totalPackages})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-semibold",children:gt?gt.remainingPackages:0})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"P. Proveedor"}),i.jsx("div",{className:"font-semibold",children:Mr})]}),i.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal"}),i.jsx("div",{className:"font-semibold",children:Number(Se.subtotal||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Esperado Rivas"}),i.jsx("div",{className:"font-semibold",children:Number(Se.totalRivas||0).toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Esperado Isla"}),i.jsx("div",{className:"font-semibold",children:Number(Se.totalIsla||0).toFixed(2)})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"Gastos log."}),i.jsx("div",{className:"font-semibold",children:Or.toFixed(2)})]}),i.jsxs("div",{className:"p-2 rounded bg-emerald-50 border",children:[i.jsx("div",{className:"text-gray-600",children:"U. Bruta (est)"}),i.jsx("div",{className:"font-semibold",children:ir.toFixed(2)})]})]})]},Se.id)})}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto",children:[i.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Precio Proveedor"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Esperado Rivas"}),i.jsx("th",{className:"p-2 border",children:"Esperado Isla"}),i.jsx("th",{className:"p-2 border",children:"Gastos log."}),i.jsx("th",{className:"p-2 border",children:"U. Bruta (est)"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):x.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin ordenes maestras."})}):$t.map(Se=>{const gt=y[Se.id],er=$r(Se),Mr=Se.totalPackages>0?(Se.subtotal/Se.totalPackages).toFixed(2):"0.00",Or=Number(Se.logisticsCost||0),ir=Number(Se.totalRivas||0)-Number(Se.subtotal||0);return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:er}),i.jsx("td",{className:"p-2 border text-left",children:Se.name}),i.jsx("td",{className:"p-2 border",children:Se.totalPackages}),i.jsx("td",{className:"p-2 border",children:gt?gt.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:Mr}),i.jsx("td",{className:"p-2 border",children:Number(Se.subtotal||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(Se.totalRivas||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Number(Se.totalIsla||0).toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Or.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:ir.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsxs("div",{className:"flex gap-1 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>kr(Se),children:"Ver / Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>en(Se),children:"Borrar"})]})})]},Se.id)})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",Math.min((xt-1)*It+1,x.length),"-",Math.min(xt*It,x.length)," de ",x.length]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{type:"button",disabled:xt<=1,onClick:()=>Pt(Se=>Math.max(1,Se-1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Anterior"}),i.jsxs("div",{className:"px-3 py-1 border rounded text-sm",children:[xt," / ",Ut]}),i.jsx("button",{type:"button",disabled:xt>=Ut,onClick:()=>Pt(Se=>Math.min(Ut,Se+1)),className:"px-2 py-1 rounded border disabled:opacity-50 text-sm",children:"Siguiente"})]})]})]})]})]})}const w0=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function cT(t){const e=Number(t.packages||0),r=Number(t.providerPrice||0),n=Number(t.unitsPerPackage||0),a=r*e,s=e>0&&n>0?e*n:1,o=Number(t.marginRivas||0),l=Number(t.marginSanJorge||0),c=Number(t.marginIsla||0),u=a*(1+o/100),d=a*(1+l/100),f=a*(1+c/100),A=u-a,h=d-a,m=f-a,p=u/s,x=d/s,v=f/s;return{...t,subtotal:Number(a.toFixed(2)),totalRivas:Number(u.toFixed(2)),totalSanJorge:Number(d.toFixed(2)),totalIsla:Number(f.toFixed(2)),gainRivas:Number(A.toFixed(2)),gainSanJorge:Number(h.toFixed(2)),gainIsla:Number(m.toFixed(2)),unitPriceRivas:Number(p.toFixed(2)),unitPriceSanJorge:Number(x.toFixed(2)),unitPriceIsla:Number(v.toFixed(2))}}function _G(t){return t.reduce((e,r)=>(e.totalPackages+=Number(r.packages||0),e.subtotal+=Number(r.subtotal||0),e.totalRivas+=Number(r.totalRivas||0),e.totalSanJorge+=Number(r.totalSanJorge||0),e.totalIsla+=Number(r.totalIsla||0),e),{totalPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0})}function Xc(t,e=0){const r=Number(t);return Number.isFinite(r)?r:e}function uT(t){const{margin:e,gain:r,subtotal:n,orderMargin:a}=t;if(e!=null&&Number.isFinite(Number(e)))return Number(e);const s=Number(n||0),o=Number(r);return Number.isFinite(o)&&s>0?o/s*100:Number(a||0)}function dVe(){var L,W,X;const[t,e]=g.useState([]),[r,n]=g.useState({}),[a,s]=g.useState(!0),[o,l]=g.useState(""),[c,u]=g.useState(Ur(Qd(new Date),"yyyy-MM-dd")),[d,f]=g.useState(Ur(Ud(new Date),"yyyy-MM-dd")),[A,h]=g.useState(!1),[m,p]=g.useState(!1),[x,v]=g.useState(null),[y,b]=g.useState([]),[w,j]=g.useState(0),[I,C]=g.useState(0),[S,E]=g.useState(0),[B,k]=g.useState(""),[T,P]=g.useState(""),[K,le]=g.useState(0),[oe,ie]=g.useState(0),[Ae,te]=g.useState(1);g.useEffect(()=>{(async()=>{try{s(!0),l("");const D=sr(bt(je,"candy_main_orders"),In("createdAt","desc")),Q=await Ht(D),Z=[];Q.forEach(ze=>{const re=ze.data();Z.push({id:ze.id,name:re.name??"",date:re.date??"",totalPackages:Number(re.totalPackages??0),subtotal:Number(re.subtotal??0),totalRivas:Number(re.totalRivas??0),totalSanJorge:Number(re.totalSanJorge??0),totalIsla:Number(re.totalIsla??0),marginRivas:Number(re.marginRivas??0),marginSanJorge:Number(re.marginSanJorge??0),marginIsla:Number(re.marginIsla??0),createdAt:re.createdAt??xr.now()})}),e(Z);const be=await Ht(sr(bt(je,"inventory_candies"))),U={};be.forEach(ze=>{const re=ze.data(),J=re.orderId;if(!J)return;const Re=Number(re.unitsPerPackage||1)||1,ke=Number(re.totalUnits??(re.packages||0)*Re),Be=Math.round(ke/Re),Ye=Number(re.remaining??re.totalUnits??ke),ot=Number(re.remainingPackages??NaN),Ct=Number.isFinite(ot)?Math.round(ot):Math.round(Ye/Re);U[J]||(U[J]={orderId:J,totalPackages:0,remainingPackages:0}),U[J].totalPackages+=Be,U[J].remainingPackages+=Ct}),n(U)}catch(D){console.error(D),l(" Error cargando inventario de pedidos.")}finally{s(!1)}})()},[]);const Te=g.useMemo(()=>t.filter(D=>{var Z;const Q=D.date||((Z=D.createdAt)!=null&&Z.toDate?D.createdAt.toDate().toISOString().slice(0,10):"");return!(!Q||c&&Q<c||d&&Q>d)}),[t,c,d]),Ue=g.useMemo(()=>{let D=0,Q=0,Z=0,be=0,U=0,ze=0;for(const re of Te){D+=re.totalPackages,Q+=re.subtotal,Z+=re.totalRivas,be+=re.totalSanJorge,U+=re.totalIsla;const J=r[re.id];J&&(ze+=J.remainingPackages)}return{totalPaquetes:D,totalSubtotal:Q,totalRivas:Z,totalSJ:be,totalIsla:U,totalPaquetesRestantes:ze,totalPedidos:Te.length}},[Te,r]),O=async(D,Q,Z)=>{if(!x)return;const be=Number(Z||0),U=y.map(J=>J.id!==D?J:cT({...J,[Q]:be}));b(U);const ze=U.find(J=>J.id===D);if(!ze)return;const re=_G(U);try{await kn(Xt(je,"products_candies",D),{marginRivas:ze.marginRivas,marginSanJorge:ze.marginSanJorge,marginIsla:ze.marginIsla,subtotal:ze.subtotal,totalRivas:ze.totalRivas,totalSanJorge:ze.totalSanJorge,totalIsla:ze.totalIsla,unitPriceRivas:ze.unitPriceRivas,unitPriceSanJorge:ze.unitPriceSanJorge,unitPriceIsla:ze.unitPriceIsla,gainRivas:ze.gainRivas,gainSanJorge:ze.gainSanJorge,gainIsla:ze.gainIsla}),await kn(Xt(je,"candy_main_orders",x.id),{totalPackages:re.totalPackages,subtotal:Number(re.subtotal.toFixed(2)),totalRivas:Number(re.totalRivas.toFixed(2)),totalSanJorge:Number(re.totalSanJorge.toFixed(2)),totalIsla:Number(re.totalIsla.toFixed(2))}),v(J=>J&&{...J,totalPackages:re.totalPackages,subtotal:Number(re.subtotal.toFixed(2)),totalRivas:Number(re.totalRivas.toFixed(2)),totalSanJorge:Number(re.totalSanJorge.toFixed(2)),totalIsla:Number(re.totalIsla.toFixed(2))}),l(" Mrgenes del producto actualizados.")}catch(J){console.error(J),l(" Error actualizando mrgenes del producto.")}},H=async()=>{if(x)try{l("");const D=Number.isFinite(w)&&w!==0?w:x.marginRivas||0,Q=Number.isFinite(I)&&I!==0?I:x.marginSanJorge||0,Z=Number.isFinite(S)&&S!==0?S:x.marginIsla||0,be=cT({id:"tmp",name:B.trim(),category:T.trim(),providerPrice:Number(K||0),packages:Number(oe||0),unitsPerPackage:Number(Ae||1),marginRivas:Number(D||0),marginSanJorge:Number(Q||0),marginIsla:Number(Z||0),subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,gainRivas:0,gainSanJorge:0,gainIsla:0,unitPriceRivas:0,unitPriceSanJorge:0,unitPriceIsla:0,remainingPackages:Number(oe||0)}),U=await Wn(bt(je,"products_candies"),{orderId:x.id,inventoryDate:x.date||"",name:be.name,category:be.category,providerPrice:be.providerPrice,packages:be.packages,unitsPerPackage:be.unitsPerPackage,marginRivas:be.marginRivas,marginSanJorge:be.marginSanJorge,marginIsla:be.marginIsla,gainRivas:be.gainRivas,gainSanJorge:be.gainSanJorge,gainIsla:be.gainIsla,subtotal:be.subtotal,totalRivas:be.totalRivas,totalSanJorge:be.totalSanJorge,totalIsla:be.totalIsla,unitPriceRivas:be.unitPriceRivas,unitPriceSanJorge:be.unitPriceSanJorge,unitPriceIsla:be.unitPriceIsla,createdAt:xr.now()}),re=[{...be,id:U.id},...y];b(re);const J=_G(re);await kn(Xt(je,"candy_main_orders",x.id),{totalPackages:J.totalPackages,subtotal:Number(J.subtotal.toFixed(2)),totalRivas:Number(J.totalRivas.toFixed(2)),totalSanJorge:Number(J.totalSanJorge.toFixed(2)),totalIsla:Number(J.totalIsla.toFixed(2))}),v(Re=>Re&&{...Re,totalPackages:J.totalPackages,subtotal:Number(J.subtotal.toFixed(2)),totalRivas:Number(J.totalRivas.toFixed(2)),totalSanJorge:Number(J.totalSanJorge.toFixed(2)),totalIsla:Number(J.totalIsla.toFixed(2))}),j(0),C(0),E(0),k(""),P(""),le(0),ie(0),te(1),l(" Producto agregado con mrgenes por sucursal.")}catch(D){console.error(D),l(" Error agregando producto al pedido.")}},G=async D=>{try{v(D),b([]),h(!0),p(!0),l("");const Q=await Ht(sr(bt(je,"inventory_candies"),Ar("orderId","==",D.id))),Z={};Q.forEach(ze=>{const re=ze.data(),J=re.productId;if(!J)return;const Re=Number(re.unitsPerPackage||1)||1,ke=Number(re.remaining??re.totalUnits??0),Be=Number(re.remainingPackages??NaN),Ye=Number.isFinite(Be)?Math.round(Be):Math.round(ke/Re);Z[J]=(Z[J]||0)+Ye});const be=await Ht(sr(bt(je,"products_candies"),Ar("orderId","==",D.id))),U=[];be.forEach(ze=>{const re=ze.data(),J=Xc(re.providerPrice,0),Re=Xc(re.packages,0),ke=re.subtotal??J*Re,Be=uT({margin:re.marginRivas,gain:re.gainRivas,subtotal:ke,orderMargin:D.marginRivas||0}),Ye=uT({margin:re.marginSanJorge,gain:re.gainSanJorge,subtotal:ke,orderMargin:D.marginSanJorge||0}),ot=uT({margin:re.marginIsla,gain:re.gainIsla,subtotal:ke,orderMargin:D.marginIsla||0}),Ct=cT({id:ze.id,name:re.name??"",category:re.category??"",providerPrice:J,packages:Re,unitsPerPackage:Xc(re.unitsPerPackage,1),marginRivas:Number(Be||0),marginSanJorge:Number(Ye||0),marginIsla:Number(ot||0),subtotal:Xc(re.subtotal,0),totalRivas:Xc(re.totalRivas,0),totalSanJorge:Xc(re.totalSanJorge,0),totalIsla:Xc(re.totalIsla,0),gainRivas:Xc(re.gainRivas,0),gainSanJorge:Xc(re.gainSanJorge,0),gainIsla:Xc(re.gainIsla,0),unitPriceRivas:Xc(re.unitPriceRivas,0),unitPriceSanJorge:Xc(re.unitPriceSanJorge,0),unitPriceIsla:Xc(re.unitPriceIsla,0),remainingPackages:Z[ze.id]??Xc(re.packages,0)});U.push(Ct)}),b(U)}catch(Q){console.error(Q),l(" Error cargando productos del pedido.")}finally{p(!1)}};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Ordenes Maestras"})}),i.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:D=>u(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:D=>f(D.target.value)})]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{u(""),f("")},children:"Quitar filtro"}),i.jsxs("div",{className:"ml-auto text-xs md:text-sm text-gray-600",children:["Cantidad de pedidos:"," ",i.jsx("span",{className:"font-semibold",children:Ue.totalPedidos})]})]}),i.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-2 gap-x-8",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes totales:"})," ",Ue.totalPaquetes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",Ue.totalPaquetesRestantes]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Subtotal total:"})," ",w0(Ue.totalSubtotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Rivas (todo):"})," ",w0(Ue.totalRivas)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total San Jorge (todo):"})," ",w0(Ue.totalSJ)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total Isla (todo):"})," ",w0(Ue.totalIsla)]})]})}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-2",children:i.jsxs("table",{className:"min-w-[900px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Nombre"}),i.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. prom. San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. prom. Isla"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:a?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):Te.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin pedidos generales en este rango."})}):Te.map(D=>{var re;const Q=D.totalPackages>0?Math.round(D.totalRivas/D.totalPackages):0,Z=D.totalPackages>0?Math.round(D.totalSanJorge/D.totalPackages):0,be=D.totalPackages>0?Math.round(D.totalIsla/D.totalPackages):0,U=D.date||((re=D.createdAt)!=null&&re.toDate?D.createdAt.toDate().toISOString().slice(0,10):""),ze=r[D.id];return i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:U}),i.jsx("td",{className:"p-2 border",children:D.name}),i.jsx("td",{className:"p-2 border",children:D.totalPackages}),i.jsx("td",{className:"p-2 border",children:ze?ze.remainingPackages:0}),i.jsx("td",{className:"p-2 border",children:D.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:Q}),i.jsx("td",{className:"p-2 border",children:Z}),i.jsx("td",{className:"p-2 border",children:be}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>G(D),children:"Ver pedido"})})]},D.id)})})]})}),A&&x&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsxs("h3",{className:"text-xl font-bold",children:["Detalle: ",x.name]}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:()=>{h(!1),v(null),b([]),l("")},children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4 text-xs md:text-sm",children:[i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Fecha del pedido"}),i.jsx("div",{className:"font-semibold",children:x.date||((L=x.createdAt)!=null&&L.toDate?x.createdAt.toDate().toISOString().slice(0,10):"")})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes totales"}),i.jsx("div",{className:"font-semibold",children:((W=r[x.id])==null?void 0:W.totalPackages)??x.totalPackages})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Paquetes restantes"}),i.jsx("div",{className:"font-semibold",children:((X=r[x.id])==null?void 0:X.remainingPackages)??0})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Subtotal (proveedor)"}),i.jsx("div",{className:"font-semibold",children:w0(x.subtotal)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Rivas"}),i.jsx("div",{className:"font-semibold",children:w0(x.totalRivas)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total San Jorge"}),i.jsx("div",{className:"font-semibold",children:w0(x.totalSanJorge)})]}),i.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-gray-600",children:"Total Isla"}),i.jsx("div",{className:"font-semibold",children:w0(x.totalIsla)})]})]}),i.jsxs("div",{className:"bg-white border rounded p-3 mb-4",children:[i.jsx("div",{className:"font-semibold mb-2",children:"Agregar producto"}),i.jsxs("div",{className:"flex flex-wrap gap-2 items-end text-xs",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Rivas"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:w,onChange:D=>j(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen SJ"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:I,onChange:D=>C(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Margen Isla"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:S,onChange:D=>E(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Producto"}),i.jsx("input",{className:"border rounded px-2 py-1 w-56",value:B,onChange:D=>k(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Categora"}),i.jsx("input",{className:"border rounded px-2 py-1 w-40",value:T,onChange:D=>P(D.target.value)})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"P. proveedor (paq)"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-32 text-right",value:K,onChange:D=>le(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Paquetes"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:oe,onChange:D=>ie(Number(D.target.value||0))})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("label",{className:"text-gray-600",children:"Und x Paq"}),i.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:Ae,onChange:D=>te(Number(D.target.value||1))})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:H,children:"Agregar producto"})]})]}),i.jsx("h4",{className:"font-semibold mb-2",children:"Productos del pedido"}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Categora"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),i.jsx("th",{className:"p-2 border",children:"Und x Paq"}),i.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),i.jsx("th",{className:"p-2 border",children:"Margen Rivas (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen San Jorge (%)"}),i.jsx("th",{className:"p-2 border",children:"Margen Isla (%)"}),i.jsx("th",{className:"p-2 border",children:"Subtotal"}),i.jsx("th",{className:"p-2 border",children:"Total Rivas"}),i.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),i.jsx("th",{className:"p-2 border",children:"Total Isla"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),i.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),i.jsx("th",{className:"p-2 border",children:"P. unidad Isla"})]})}),i.jsx("tbody",{children:m?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Cargando productos"})}):y.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Este pedido no tiene productos registrados."})}):y.map(D=>i.jsxs("tr",{className:"text-center whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:D.name}),i.jsx("td",{className:"p-2 border",children:D.category}),i.jsx("td",{className:"p-2 border",children:D.packages}),i.jsx("td",{className:"p-2 border",children:D.remainingPackages??D.packages}),i.jsx("td",{className:"p-2 border",children:D.unitsPerPackage}),i.jsx("td",{className:"p-2 border",children:D.providerPrice.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginRivas??0,onChange:Q=>O(D.id,"marginRivas",Q.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginSanJorge??0,onChange:Q=>O(D.id,"marginSanJorge",Q.target.value)})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:D.marginIsla??0,onChange:Q=>O(D.id,"marginIsla",Q.target.value)})}),i.jsx("td",{className:"p-2 border",children:D.subtotal.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalRivas.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalSanJorge.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.totalIsla.toFixed(2)}),i.jsx("td",{className:"p-2 border",children:D.unitPriceRivas}),i.jsx("td",{className:"p-2 border",children:D.unitPriceSanJorge}),i.jsx("td",{className:"p-2 border",children:D.unitPriceIsla})]},D.id))})]})}),o&&i.jsx("p",{className:"mt-3 text-sm",children:o})]})}),o&&!A&&i.jsx("p",{className:"mt-2 text-sm",children:o})]})}const za=t=>Math.round((Number(t)||0)*100)/100,ip=t=>Math.round((Number(t)||0)*1e3)/1e3,si=t=>Number(t??0).toFixed(2),Qf=t=>Number(t??0).toFixed(3),EG=t=>String(t??"").trim().toLowerCase();async function fVe(t){if(!t)return;const e=sr(bt(je,"ar_movements"),Ar("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>zn(Xt(je,"ar_movements",n.id))))}const hVe=(t,e)=>{var h;const r=t.date??((h=t.timestamp)!=null&&h.toDate?Ur(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",a=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",s=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0,u=t.processedDate??t.closureDate??"";if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((m,p)=>{const x=Number((m==null?void 0:m.packages)??(m==null?void 0:m.qty)??(m==null?void 0:m.quantity)??0),v=Number((m==null?void 0:m.lineFinal)??0)||Math.max(0,Number((m==null?void 0:m.unitPricePackage)||(m==null?void 0:m.unitPrice)||0)*x-Number((m==null?void 0:m.discount)||0));let y=0;return c>0&&l>0&&Number(v||0)>0&&(y=za(c*Number(v||0)/l)),{id:`${e}#${p}`,productName:String((m==null?void 0:m.productName)??"(sin nombre)"),quantity:x,amount:za(v),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:a,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:Array.isArray(m==null?void 0:m.allocations)?m.allocations:t.allocations,avgUnitCost:Number((m==null?void 0:m.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((m==null?void 0:m.cogsAmount)??0),type:s,vendorId:o,vendorCommissionAmount:y,processedDate:u||""}});const d=Number(t.packagesTotal??t.quantity??0),f=Number(t.amount??t.amountCharged??t.total??0)||0;let A=0;return A=za(Number(t.vendorCommissionAmount??0)||0),[{id:e,productName:t.productName??"(sin nombre)",quantity:d,amount:f,amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:a,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount,type:s,vendorId:o,vendorCommissionAmount:A,processedDate:u||""}]};function AVe({role:t,currentUserEmail:e,sellerCandyId:r,roles:n}){const[a,s]=g.useState([]),[o,l]=g.useState(null),[c,u]=g.useState(!0),[d,f]=g.useState(""),[A,h]=g.useState("ALL"),m=Ur(new Date,"yyyy-MM-dd"),[p,x]=g.useState(m),[v,y]=g.useState(m),[b,w]=g.useState("ALL"),[j,I]=g.useState("ALL"),[C,S]=g.useState(null),[E,B]=g.useState(0),[k,T]=g.useState(0),[P,K]=g.useState(""),[le,oe]=g.useState(0),[ie,Ae]=g.useState("0"),[te,Te]=g.useState(!1),[Ue,O]=g.useState(!1),[H,G]=g.useState(!1),[L,W]=g.useState(!1),[X,D]=g.useState(!1),[Q,Z]=g.useState(!1),be=g.useRef(null),U=n&&n.length?n:t,ze=!U||Sn(U,"admin"),re=Sn(U,"vendedor_dulces"),J=(e||"").trim().toLowerCase(),[Re,ke]=g.useState([]),[Be,Ye]=g.useState({}),[ot,Ct]=g.useState({}),jt=oi.useMemo(()=>{const ee=new Set;return a.forEach(_e=>{const R=(_e.productName||"").trim();R&&ee.add(R)}),Array.from(ee).sort((_e,R)=>_e.localeCompare(R))},[a]);g.useEffect(()=>{if(!p||!v)return;u(!0);const ee=sr(bt(je,"sales_candies"),Ar("date",">=",p),Ar("date","<=",v),In("date","asc")),_e=Pd(ee,R=>{const V=[];R.forEach(q=>{const se=hVe(q.data(),q.id);V.push(...se)}),s(V),u(!1)},R=>{console.error("Error cargando ventas por periodo:",R),s([]),u(!1)});return()=>_e()},[p,v]),g.useEffect(()=>{(async()=>{const _e=sr(bt(je,"daily_closures_candies"),Ar("date","==",m)),R=await Ht(_e);if(R.empty)l(null);else{const V=R.docs[0];l({id:V.id,...V.data()})}})()},[m]),g.useEffect(()=>{(async()=>{try{const _e=await Ht(bt(je,"sellers_candies")),R=[];_e.forEach(V=>{const q=V.data();R.push({id:V.id,name:q.name||"",commissionPercent:Number(q.commissionPercent||0)})}),ke(R)}catch(_e){console.error("Error cargando sellers_candies",_e)}})()},[]),g.useEffect(()=>{(async()=>{try{const _e=await Ht(bt(je,"products_candies")),R={};_e.forEach(V=>{const q=V.data(),se=EG(q==null?void 0:q.name);if(!se)return;const Ne=String((q==null?void 0:q.category)||"").trim();R[se]=Ne||"(sin categora)"}),Ye(R)}catch(_e){console.error("Error cargando products_candies",_e)}})()},[]);const Ot=ee=>za(Number(ee.vendorCommissionAmount??0)||0),Tt=oi.useMemo(()=>{let ee=[...a];return A==="FLOTANTE"&&(ee=ee.filter(_e=>_e.status==="FLOTANTE")),A==="PROCESADA"&&(ee=ee.filter(_e=>_e.status==="PROCESADA")),j!=="ALL"&&(ee=ee.filter(_e=>(_e.productName||"").trim()===j)),ze&&b!=="ALL"&&(ee=ee.filter(_e=>(_e.vendorId||"")===b)),re&&(r?ee=ee.filter(_e=>(_e.vendorId||"")===r):J?ee=ee.filter(_e=>(_e.sellerEmail||"").toLowerCase()===J):ee=[]),ee},[A,a,j,ze,b,re,r,J]),Qt=oi.useMemo(()=>Tt.filter(ee=>ee.type!=="CREDITO"),[Tt]),Ft=oi.useMemo(()=>Tt.filter(ee=>ee.type==="CREDITO"),[Tt]),Qe=oi.useMemo(()=>Tt.filter(ee=>ee.status==="FLOTANTE").length,[Tt]),De=oi.useMemo(()=>Tt.filter(ee=>ee.status==="PROCESADA").length,[Tt]),Je=oi.useMemo(()=>Tt.filter(ee=>ee.type==="CREDITO").length,[Tt]),dt=oi.useMemo(()=>Tt.filter(ee=>ee.type!=="CREDITO").length,[Tt]),ce=ip(Tt.reduce((ee,_e)=>ee+(_e.quantity||0),0)),we=za(Tt.reduce((ee,_e)=>ee+Number(_e.cogsAmount??0),0)),ue=za(Tt.reduce((ee,_e)=>ee+(_e.amount||0),0)),ne=za(ue-we);let Ve=0,it=0,vt=0,me=0,Ee=0,ye=0,We=0;Tt.forEach(ee=>{const _e=Number(ee.amount||0),R=Number(ee.amountReceived||0),V=Ot(ee);Ee+=V,ee.type==="CREDITO"?(Ve+=ee.quantity||0,vt+=_e-R,We+=V):(it+=ee.quantity||0,me+=_e,ye+=V)}),vt=za(vt),me=za(me),Ee=za(Ee),ye=za(ye),We=za(We);const ge=oi.useMemo(()=>{const ee={};for(const _e of Tt){const R=(_e.vendorId||"").trim();if(!R||_e.type==="CREDITO")continue;const V=Ot(_e);if(!ee[R]){const q=Re.find(se=>se.id===R);ee[R]={vendorId:R,name:(q==null?void 0:q.name)||_e.userEmail||"(sin vendedor)",total:0}}ee[R].total=za(ee[R].total+V)}return Object.values(ee).filter(_e=>_e.total>0).sort((_e,R)=>R.total-_e.total)},[Tt,Re]),Ie=oi.useMemo(()=>{const ee={};for(const _e of Tt){const R=(_e.vendorId||"").trim();if(!R||_e.type!=="CREDITO")continue;const V=Ot(_e);if(!ee[R]){const q=Re.find(se=>se.id===R);ee[R]={vendorId:R,name:(q==null?void 0:q.name)||_e.userEmail||"(sin vendedor)",total:0}}ee[R].total=za(ee[R].total+V)}return Object.values(ee).filter(_e=>_e.total>0).sort((_e,R)=>R.total-_e.total)},[Tt,Re]),xt={};Tt.forEach(ee=>{const _e=ee.productName||"(sin nombre)";xt[_e]||(xt[_e]={totalQuantity:0,totalAmount:0,totalCommission:0}),xt[_e].totalQuantity=ip(xt[_e].totalQuantity+(ee.quantity||0)),xt[_e].totalAmount=za(xt[_e].totalAmount+(ee.amount||0)),xt[_e].totalCommission=za(xt[_e].totalCommission+Ot(ee))});const Pt=Object.entries(xt).map(([ee,_e])=>({productName:ee,category:Be[EG(ee)]||"(sin categora)",totalQuantity:_e.totalQuantity,totalAmount:_e.totalAmount,totalCommission:_e.totalCommission})),It=oi.useMemo(()=>{const ee={};for(const _e of Pt){const R=_e.category||"(sin categora)";ee[R]||(ee[R]={category:R,rows:[],totalQuantity:0,totalAmount:0,totalCommission:0}),ee[R].rows.push(_e),ee[R].totalQuantity=ip(ee[R].totalQuantity+(_e.totalQuantity||0)),ee[R].totalAmount=za(ee[R].totalAmount+(_e.totalAmount||0)),ee[R].totalCommission=za(ee[R].totalCommission+(_e.totalCommission||0))}return Object.values(ee).map(_e=>({..._e,rows:[..._e.rows].sort((R,V)=>V.totalAmount-R.totalAmount)})).sort((_e,R)=>R.totalAmount-_e.totalAmount)},[Pt]),Ut=ee=>{Ct(_e=>({..._e,[ee]:!_e[ee]}))},$t=async()=>{if(ze)try{const ee=Tt.filter(Ke=>Ke.status==="FLOTANTE");if(ee.length===0){f("No hay ventas flotantes para procesar en este perodo.");return}const _e={totalCharged:za(ee.reduce((Ke,Pe)=>Ke+(Pe.amount||0),0)),totalSuggested:za(ee.reduce((Ke,Pe)=>Ke+(Pe.amountSuggested||0),0)),totalUnits:ip(ee.reduce((Ke,Pe)=>Ke+(Pe.quantity||0),0)),totalCOGS:za(ee.reduce((Ke,Pe)=>Ke+Number(Pe.cogsAmount??0),0))},R=za(_e.totalCharged-_e.totalSuggested),V=za(_e.totalCharged-_e.totalCOGS),q=ee.reduce((Ke,Pe)=>{const rt=Number(Pe.quantity||0),lt=Number(Pe.amount||0),ht=Number(Pe.vendorCommissionAmount||0);return Pe.type==="CREDITO"?(Ke.packsCredit+=rt,Ke.amountCredit+=lt,Ke.comCredit+=ht):(Ke.packsCash+=rt,Ke.amountCash+=lt,Ke.comCash+=ht),Ke},{packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0}),se={totalPacksCash:ip(q.packsCash),totalPacksCredit:ip(q.packsCredit),totalAmountCash:za(q.amountCash),totalAmountCredit:za(q.amountCredit),totalCommissionCash:za(q.comCash),totalCommissionCredit:za(q.comCredit)},Ne=await Wn(bt(je,"daily_closures_candies"),{date:m,createdAt:xr.now(),periodStart:p,periodEnd:v,totalCharged:_e.totalCharged,totalSuggested:_e.totalSuggested,totalDifference:R,totalUnits:_e.totalUnits,totalCOGS:_e.totalCOGS,grossProfit:V,...se,products:ee.map(Ke=>({productName:Ke.productName,quantity:Ke.quantity,amount:Ke.amount})),sales:ee.map(Ke=>({id:Ke.id,productName:Ke.productName,quantity:Ke.quantity,amount:Ke.amount,amountSuggested:Ke.amountSuggested,userEmail:Ke.userEmail,clientName:Ke.clientName,amountReceived:Ke.amountReceived,change:Ke.change,status:Ke.status,cogsAmount:Ke.cogsAmount??0,avgUnitCost:Ke.avgUnitCost??null,allocations:Ke.allocations??[],date:Ke.date,type:Ke.type??"CONTADO",vendorId:Ke.vendorId??"",vendorCommissionAmount:Number(Ke.vendorCommissionAmount??0)||0,processedDate:m})),productSummary:Object.entries(ee.reduce((Ke,Pe)=>{const rt=Pe.productName||"(sin nombre)";return Ke[rt]||(Ke[rt]={totalQuantity:0,totalAmount:0}),Ke[rt].totalQuantity=ip(Ke[rt].totalQuantity+(Pe.quantity||0)),Ke[rt].totalAmount=za(Ke[rt].totalAmount+(Pe.amount||0)),Ke},{})).map(([Ke,Pe])=>({productName:Ke,totalQuantity:Pe.totalQuantity,totalAmount:Pe.totalAmount}))}),Me=Sc(je);ee.forEach(Ke=>{Me.update(Xt(je,"sales_candies",Ke.id.split("#")[0]),{status:"PROCESADA",closureId:Ne.id,closureDate:m,processedDate:m,processedAt:xr.now()})}),await Me.commit(),f(` Cierre guardado. Ventas procesadas: ${ee.length}. (Proceso: ${m})`)}catch(ee){console.error(ee),f(" Error al guardar el cierre de dulces.")}},Le=async ee=>{if(ze&&window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await kn(Xt(je,"sales_candies",ee.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null,processedDate:null,processedAt:null}),f(" Venta revertida a FLOTANTE.")}catch(_e){console.error(_e),f(" No se pudo revertir la venta.")}},Ce=ee=>{ze&&(S(ee),B(ee.quantity),T(ee.amount),K(ee.clientName),oe(ee.amountReceived),Ae(ee.change))},pe=async()=>{if(!(!C||!ze))try{await kn(Xt(je,"sales_candies",C.id.split("#")[0]),{packagesTotal:E,amount:k,amountCharged:k,clientName:P,amountReceived:le,change:ie}),S(null),f(" Venta de dulces actualizada.")}catch(ee){console.error(ee),f(" No se pudo actualizar la venta de dulces.")}},He=async ee=>{if(ze&&window.confirm("Eliminar esta venta? Se restaurar el stock (paquetes) en los lotes asignados."))try{const _e=ee.split("#")[0],{restored:R}=await BQe(_e);await fVe(_e),f(` Venta eliminada. Stock restaurado (unidades internas): ${Number(R).toFixed(2)}. Estado de cuenta ajustado.`)}catch(_e){console.error(_e),f(" No se pudo eliminar la venta de dulces.")}},he=async()=>{if(be.current){be.current.classList.add("force-pdf-colors"),be.current.classList.add("pdf-print-mode");try{const _e=(await Vm(be.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),R=new an;R.addImage(_e,"PNG",10,10,190,0),R.save(`cierre_dulces_${p}_a_${v}_proc_${m}.pdf`)}finally{be.current.classList.remove("pdf-print-mode"),be.current.classList.remove("force-pdf-colors")}}};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("style",{children:`
        .pdf-print-mode .pdf-desktop { display: block !important; }
        .pdf-print-mode .pdf-mobile  { display: none !important; }
        .pdf-print-mode .collapsible-content { display: block !important; }
      `}),i.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Cierre de Ventas de Dulces - Proceso: ",m]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Te(ee=>!ee),"aria-expanded":te,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${te?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${te?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Desde:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:p,onChange:ee=>x(ee.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Hasta:"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:v,onChange:ee=>y(ee.target.value)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Filtrar:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:A,onChange:ee=>h(ee.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),ze&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm",children:"Vendedor:"}),i.jsxs("select",{className:"border rounded px-2 py-1",value:b,onChange:ee=>w(ee.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),Re.map(ee=>i.jsx("option",{value:ee.id,children:ee.name||ee.id},ee.id))]})]}),i.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[i.jsx("label",{className:"text-xs md:text-sm whitespace-nowrap",children:"Productos:"}),i.jsxs("select",{className:"border rounded px-2 py-1 text-xs w-full md:w-48 lg:w-56",value:j,onChange:ee=>I(ee.target.value),disabled:jt.length===0,children:[i.jsx("option",{value:"ALL",children:"Todos"}),jt.map(ee=>i.jsx("option",{value:ee,children:ee},ee))]})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>O(ee=>!ee),"aria-expanded":Ue,children:[i.jsx("span",{children:"KPIs"}),i.jsx("span",{className:`transition-transform ${Ue?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Ue?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas flotantes"}),i.jsx("div",{className:"text-2xl font-bold",children:Qe}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas procesadas"}),i.jsx("div",{className:"text-2xl font-bold",children:De}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:Je}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsx("div",{className:"text-2xl font-bold",children:dt}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",si(ye)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito (perodo)"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",si(We)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",p,"  ",v]})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>G(ee=>!ee),"aria-expanded":H,children:[i.jsx("span",{children:"KPIs por vendedor"}),i.jsx("span",{className:`transition-transform ${H?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${H?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CASH del perodo)"}),ge.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:ge.map(ee=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:ee.name}),i.jsxs("strong",{className:"ml-2",children:["C$",si(ee.total)]})]},ee.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CRDITO del perodo)"}),Ie.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Ie.map(ee=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:ee.name}),i.jsxs("strong",{className:"ml-2",children:["C$",si(ee.total)]})]},ee.vendorId))})]})]})})]}),c?i.jsx("p",{children:"Cargando ventas..."}):i.jsxs("div",{ref:be,children:[i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>W(ee=>!ee),"aria-expanded":L,children:[i.jsx("span",{children:"Transacciones Cash"}),i.jsx("span",{className:`transition-transform ${L?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${L?"block":"hidden"} border-t p-4`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Fecha proceso"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[Qt.map(ee=>{const _e=Ot(ee),R=(ee.processedDate||"").trim();return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ee.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ee.status})}),i.jsx("td",{className:"border p-1",children:ee.productName}),i.jsx("td",{className:"border p-1",children:"Cash"}),i.jsx("td",{className:"border p-1",children:Qf(ee.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",si(ee.amount)]}),i.jsx("td",{className:"border p-1",children:_e>0?`C$${si(_e)}`:""}),i.jsx("td",{className:"border p-1",children:ee.date}),i.jsx("td",{className:"border p-1",children:R||""}),i.jsx("td",{className:"border p-1",children:ee.userEmail}),i.jsx("td",{className:"border p-1",children:ee.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:ze?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Ce(ee),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>He(ee.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):ee.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:ze?i.jsx("button",{onClick:()=>Le(ee.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},ee.id)}),Qt.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-3 text-center text-gray-500",children:"Sin ventas cash para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden space-y-3 mb-4",children:[Qt.map(ee=>{const _e=Ot(ee),R=(ee.processedDate||"").trim();return i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:ee.productName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Cash  ",ee.date]})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",si(ee.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${ee.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ee.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("strong",{children:Qf(ee.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:_e>0?`C$${si(_e)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha proceso"}),i.jsx("strong",{children:R||""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:ee.userEmail})]}),i.jsx("div",{className:"pt-2",children:ee.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:ze?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Ce(ee),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>He(ee.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):ee.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:ze?i.jsx("button",{onClick:()=>Le(ee.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},ee.id)}),Qt.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas cash para mostrar."})]})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>D(ee=>!ee),"aria-expanded":X,children:[i.jsx("span",{children:"Transacciones Crdito"}),i.jsx("span",{className:`transition-transform ${X?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${X?"block":"hidden"} border-t p-4`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Estado"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"}),i.jsx("th",{className:"border p-2",children:"Fecha proceso"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Acciones"})]})}),i.jsxs("tbody",{children:[Ft.map(ee=>{const _e=Ot(ee),R=(ee.processedDate||"").trim();return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ee.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ee.status})}),i.jsx("td",{className:"border p-1",children:ee.productName}),i.jsx("td",{className:"border p-1",children:"Crdito"}),i.jsx("td",{className:"border p-1",children:Qf(ee.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",si(ee.amount)]}),i.jsx("td",{className:"border p-1",children:_e>0?`C$${si(_e)}`:""}),i.jsx("td",{className:"border p-1",children:ee.date}),i.jsx("td",{className:"border p-1",children:R||""}),i.jsx("td",{className:"border p-1",children:ee.userEmail}),i.jsx("td",{className:"border p-1",children:ee.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2 justify-center",children:ze?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Ce(ee),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>He(ee.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):ee.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2 justify-center",children:ze?i.jsx("button",{onClick:()=>Le(ee.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("span",{className:"text-gray-400 text-xs",children:""})}):i.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},ee.id)}),Ft.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:10,className:"p-3 text-center text-gray-500",children:"Sin ventas crdito para mostrar."})})]})]})}),i.jsxs("div",{className:"pdf-mobile md:hidden space-y-3 mb-4",children:[Ft.map(ee=>{const _e=Ot(ee),R=(ee.processedDate||"").trim();return i.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:ee.productName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Crdito  ",ee.date]})]}),i.jsxs("div",{className:"text-right shrink-0 ml-3",children:[i.jsxs("div",{className:"font-bold",children:["C$",si(ee.amount)]}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${ee.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ee.status})]})]}),i.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Paquetes"}),i.jsx("strong",{children:Qf(ee.quantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:_e>0?`C$${si(_e)}`:""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha proceso"}),i.jsx("strong",{children:R||""})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Vendedor"}),i.jsx("strong",{className:"text-right break-all",children:ee.userEmail})]}),i.jsx("div",{className:"pt-2",children:ee.status==="FLOTANTE"?i.jsx("div",{className:"flex gap-2",children:ze?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Ce(ee),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),i.jsx("button",{onClick:()=>He(ee.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):ee.status==="PROCESADA"?i.jsx("div",{className:"flex gap-2",children:ze?i.jsx("button",{onClick:()=>Le(ee.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):i.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},ee.id)}),Ft.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas crdito para mostrar."})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:["Total paquetes crdito: ",i.jsx("strong",{children:Qf(Ve)})]}),i.jsxs("div",{children:["Total paquetes cash: ",i.jsx("strong",{children:Qf(it)})]}),i.jsxs("div",{children:["Total pendiente crdito:"," ",i.jsxs("strong",{children:["C$",si(vt)]})]}),i.jsxs("div",{children:["Total cobrado cash: ",i.jsxs("strong",{children:["C$",si(me)]})]}),i.jsxs("div",{children:["Total comisin: ",i.jsxs("strong",{children:["C$",si(Ee)]})]})]}),(we>0||ne!==ue)&&i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm mb-6",children:[i.jsxs("div",{children:["Costo total (COGS): ",i.jsxs("strong",{children:["C$",si(we)]})]}),i.jsxs("div",{children:["Ganancia antes de gasto:"," ",i.jsxs("strong",{children:["C$",si(ne)]})]}),i.jsxs("div",{children:["Total paquetes (visibles):"," ",i.jsx("strong",{children:Qf(ce)})]})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Z(ee=>!ee),"aria-expanded":Q,children:[i.jsx("span",{children:"Consolidado por producto"}),i.jsx("span",{className:`transition-transform ${Q?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Q?"block":"hidden"} border-t p-4`,children:i.jsxs("div",{className:"space-y-3",children:[It.map(ee=>{const _e=!!ot[ee.category];return i.jsxs("div",{className:"border rounded-xl bg-white shadow-sm",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ut(ee.category),"aria-expanded":_e,children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"truncate",children:ee.category}),i.jsxs("div",{className:"text-xs text-gray-600",children:[Qf(ee.totalQuantity)," paquetes  C$",si(ee.totalAmount),"  Comisin"," ",ee.totalCommission>0?`C$${si(ee.totalCommission)}`:""]})]}),i.jsx("span",{className:`transition-transform ${_e?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${_e?"block":"hidden"} border-t p-3`,children:[i.jsx("div",{className:"pdf-desktop hidden md:block",children:i.jsxs("table",{className:"min-w-full border text-sm mb-2",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero"}),i.jsx("th",{className:"border p-2",children:"Comisin"})]})}),i.jsx("tbody",{children:ee.rows.map(R=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:R.productName}),i.jsx("td",{className:"border p-1",children:Qf(R.totalQuantity)}),i.jsxs("td",{className:"border p-1",children:["C$",si(R.totalAmount)]}),i.jsx("td",{className:"border p-1",children:R.totalCommission>0?`C$${si(R.totalCommission)}`:""})]},R.productName))})]})}),i.jsx("div",{className:"pdf-mobile md:hidden space-y-2",children:ee.rows.map(R=>i.jsxs("div",{className:"border rounded-xl bg-white shadow-sm p-3",children:[i.jsx("div",{className:"font-semibold",children:R.productName}),i.jsxs("div",{className:"mt-2 text-sm space-y-1",children:[i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Total paquetes"}),i.jsx("strong",{children:Qf(R.totalQuantity)})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Total dinero"}),i.jsxs("strong",{children:["C$",si(R.totalAmount)]})]}),i.jsxs("div",{className:"flex justify-between gap-3",children:[i.jsx("span",{className:"text-gray-600",children:"Comisin"}),i.jsx("strong",{children:R.totalCommission>0?`C$${si(R.totalCommission)}`:""})]})]})]},R.productName))})]})]},ee.category)}),It.length===0&&i.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin datos para consolidar."})]})})]})]}),i.jsxs("div",{className:"flex gap-2 mt-4",children:[ze&&i.jsx("button",{onClick:$t,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del perodo"}),i.jsx("button",{onClick:he,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),d&&i.jsx("p",{className:"mt-2 text-sm",children:d}),C&&ze&&i.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[i.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta de dulces"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[C.productName,"  ",C.userEmail]}),i.jsx("label",{className:"text-sm",children:"Paquetes"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:E,onChange:ee=>B(parseFloat(ee.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Monto cobrado"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:k,onChange:ee=>T(parseFloat(ee.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Cliente"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:P,onChange:ee=>K(ee.target.value)}),i.jsx("label",{className:"text-sm",children:"Paga con"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:le,onChange:ee=>oe(parseFloat(ee.target.value||"0"))}),i.jsx("label",{className:"text-sm",children:"Vuelto"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:ie,onChange:ee=>Ae(ee.target.value)}),i.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[i.jsx("button",{onClick:()=>S(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),i.jsx("button",{onClick:pe,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const Oh=t=>`C$ ${(Number(t)||0).toFixed(2)}`,_u=t=>Math.round((Number(t)||0)*100)/100;function mVe(t){if(!t)return"";switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function pVe(t){return t.toISOString().slice(0,10)}function gVe(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-01`}function xVe(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,1),r=new Date(e.getTime()-24*60*60*1e3);return pVe(r)}function vVe(){const[t,e]=g.useState(gVe()),[r,n]=g.useState(xVe()),[a,s]=g.useState(!1),[o,l]=g.useState(""),[c,u]=g.useState({}),[d,f]=g.useState({}),[A,h]=g.useState([]),[m,p]=g.useState([]),[x,v]=g.useState({}),[y,b]=g.useState(!1),[w,j]=g.useState(null),[I,C]=g.useState(null),S=g.useMemo(()=>w&&A.find(oe=>oe.vendorId===w)||null,[w,A]),E=g.useMemo(()=>{var oe;return!w||!I?[]:((oe=x[w])==null?void 0:oe[I])||[]},[w,I,x]),B=g.useMemo(()=>_u(A.reduce((oe,ie)=>oe+(ie.totalSoldMoney||0),0)),[A]),k=g.useMemo(()=>_u(A.reduce((oe,ie)=>oe+(ie.totalCreditMoney||0),0)),[A]);g.useEffect(()=>{(async()=>{try{const oe=await Ht(bt(je,"sellers_candies")),ie={};oe.forEach(Te=>{const Ue=Te.data(),O=Ue.branch||"Rivas";let H="RIVAS";O==="San Jorge"?H="SAN_JORGE":O==="Isla Ometepe"&&(H="ISLA"),ie[Te.id]={id:Te.id,name:Ue.name??"(sin nombre)",branch:H,branchLabel:O,commissionPercent:Number(Ue.commissionPercent??0)}});const Ae=await Ht(bt(je,"products_candies")),te={};Ae.forEach(Te=>{const Ue=Te.data();te[Te.id]={id:Te.id,name:Ue.name??"(sin nombre)"}}),u(ie),f(te)}catch(oe){console.error(oe),l(" Error cargando catlogos de vendedores/productos.")}})()},[]);const T=async()=>{if(!t||!r){l("Selecciona rango de fechas vlido.");return}if(!Object.keys(c).length){l("Cargando vendedores, intenta de nuevo en unos segundos.");return}s(!0),l("");try{const oe={},ie={},Ae=sr(bt(je,"inventory_candies_sellers"),Ar("date",">=",t),Ar("date","<=",r)),te=await Ht(Ae),Te={},Ue={},O={},H={};te.forEach(ke=>{var We,ge;const Be=ke.data(),Ye=Be.sellerId||"";if(!Ye)return;const ot=Be.productId||"",Ct=Be.productName||((We=d[ot])==null?void 0:We.name)||"(sin nombre)",jt=Math.max(1,Math.floor(Number(Be.unitsPerPackage||1))),Ot=Number(Be.totalUnits??0),Tt=Number(Be.packages??0),Qt=Number(Be.remainingUnits??Be.remaining??0),Ft=Number(Be.remainingPackages??0),Qe=Tt>0?Tt:Ot>0?Math.floor(Ot/jt):0,De=Ft>0?Ft:Qt>0?Math.floor(Qt/jt):0;Te[Ye]=(Te[Ye]||0)+Qe,Ue[Ye]=(Ue[Ye]||0)+De;const Je=Be.orderId||Be.vendorOrderId||Be.orderNumber||Be.order||ke.id;O[Ye]||(O[Ye]=new Set),O[Ye].add(Je);const dt=((ge=c[Ye])==null?void 0:ge.name)||Be.sellerName||"(sin vendedor)",ce=String(Be.date||""),we=Number(Be.totalVendor??0),ue=Number(Be.gainVendor??0),ne=Tt>0?Tt:Ot>0?Math.floor(Ot/jt):0,Ve=ne>0?we/ne:0,it=ne>0?ue/ne:0,vt=_u(Qe*Ve),me=_u(Qe*it),Ee=_u(De*Ve),ye=_u(De*it);H[Ye]||(H[Ye]={ordered:[],remaining:[]}),Qe>0&&H[Ye].ordered.push({date:ce,vendorName:dt,productName:Ct,packages:Qe,totalMoney:vt,vendorCommission:me}),De>0&&H[Ye].remaining.push({date:ce,vendorName:dt,productName:Ct,packages:De,totalMoney:Ee,vendorCommission:ye})});const G={};Object.keys(O).forEach(ke=>{G[ke]=O[ke].size});const L=sr(bt(je,"sales_candies"),Ar("date",">=",t),Ar("date","<=",r)),W=await Ht(L),X={},D={},Q={},Z={},be={},U={};W.forEach(ke=>{const Be=ke.data(),Ye=Be.date||"",ot=Be.vendorId||Be.sellerId||"";if(!ot)return;const Ct=c[ot],jt=Be.vendorName||(Ct==null?void 0:Ct.name)||"(sin vendedor)",Ot=Number(Be.vendorCommissionPercent??(Ct==null?void 0:Ct.commissionPercent)??0)||0,Tt=Array.isArray(Be.items)?Be.items:[];if(!Tt.length)return;const Qt=String(Be.type||"").toUpperCase()==="CREDITO";be[ot]||(be[ot]={sold:[],credit:[]}),Tt.forEach(Ft=>{var vt;const Qe=Ft.productName||((vt=d[Ft.productId||""])==null?void 0:vt.name)||"(sin nombre)",De=Ft.packages??Ft.qty??Ft.quantity??0,Je=Number(De||0);if(Je<=0)return;const dt=Number(Ft.unitPricePackage??Ft.unitPrice??0)||0,ce=Math.max(0,Number(Ft.discount||0)),we=Je*dt,ue=_u(Math.max(0,we-ce));if(ue<=0)return;console.log("DBG",{isCredit:Qt,vendorId:ot,commissionPercent:Ot,lineFinal:ue,storedItemCommission:Number(Ft.vendorCommissionAmount??0)});let ne=0;const Ve=Number(Ft.vendorCommissionAmount??0);Ve?ne=_u(Ve):Ot>0&&(ne=_u(ue*Ot/100)),Qt?(D[ot]=(D[ot]||0)+Je,Z[ot]=(Z[ot]||0)+ue):(X[ot]=(X[ot]||0)+Je,Q[ot]=(Q[ot]||0)+ue),Qt?ie[ot]=(ie[ot]||0)+ne:oe[ot]=(oe[ot]||0)+ne,Qt?be[ot].credit.push({date:Ye,vendorName:jt,productName:Qe,packages:Je,totalMoney:ue,vendorCommission:0}):be[ot].sold.push({date:Ye,vendorName:jt,productName:Qe,packages:Je,totalMoney:ue,vendorCommission:ne});const it=Qe;U[it]||(U[it]={productName:Qe,packages:0,totalMoney:0}),U[it].packages+=Je,U[it].totalMoney+=ue})});const ze=new Set([...Object.keys(Te),...Object.keys(Ue),...Object.keys(X),...Object.keys(D)]),re=[],J={};ze.forEach(ke=>{var De,Je,dt,ce;const Be=c[ke],Ye=(Be==null?void 0:Be.name)||"(sin vendedor)",ot=Be?Be.branchLabel||mVe(Be.branch):"",Ct=Te[ke]||0,jt=Ue[ke]||0,Ot=X[ke]||0,Tt=D[ke]||0,Qt=_u(Q[ke]||0),Ft=_u(Z[ke]||0),Qe=G[ke]||0;re.push({vendorId:ke,vendorName:Ye,branchLabel:ot,orderedPackages:Ct,remainingPackages:jt,soldPackages:Ot,creditPackages:Tt,totalSoldMoney:Qt,totalCreditMoney:Ft,ordersCreated:Qe,commissionCash:_u(oe[ke]||0),commissionCredit:0}),J[ke]={ordered:(((De=H[ke])==null?void 0:De.ordered)||[]).sort((we,ue)=>we.date.localeCompare(ue.date)),remaining:(((Je=H[ke])==null?void 0:Je.remaining)||[]).sort((we,ue)=>we.date.localeCompare(ue.date)),sold:(((dt=be[ke])==null?void 0:dt.sold)||[]).sort((we,ue)=>we.date.localeCompare(ue.date)),credit:(((ce=be[ke])==null?void 0:ce.credit)||[]).sort((we,ue)=>we.date.localeCompare(ue.date))}}),re.sort((ke,Be)=>ke.vendorName.localeCompare(Be.vendorName,"es")),h(re),v(J);const Re=Object.values(U).map(ke=>({productName:ke.productName,packages:ke.packages,totalMoney:_u(ke.totalMoney)})).sort((ke,Be)=>Be.packages-ke.packages).slice(0,10);p(Re),re.length||l("Sin datos para el rango seleccionado.")}catch(oe){console.error(oe),l(" Error cargando consolidado de vendedores.")}finally{s(!1)}};g.useEffect(()=>{Object.keys(c).length&&T()},[c]);const P=(oe,ie)=>{j(oe),C(ie),b(!0)},K=()=>{b(!1),j(null),C(null)},le=()=>{if(!A.length){l("No hay datos para exportar.");return}const oe=["Vendedor","Sucursal","Paquetes ordenados","Paquetes restantes","Paquetes vendidos","Paquetes fiados","Total vendidos (C$)","Comisin Cash (C$)","Total fiado (C$)","Comisin Crdito (C$)","rdenes creadas"],ie=A.map(O=>[O.vendorName,O.branchLabel,O.orderedPackages.toString(),O.remainingPackages.toString(),O.soldPackages.toString(),O.creditPackages.toString(),O.totalSoldMoney.toFixed(2),O.commissionCash.toFixed(2),O.totalCreditMoney.toFixed(2),O.commissionCredit.toFixed(2),O.ordersCreated.toString()]),Ae=[oe,...ie].map(O=>O.map(H=>`"${String(H).replace(/"/g,'""')}"`).join(",")).join(`
`),te=new Blob([Ae],{type:"text/csv;charset=utf-8;"}),Te=URL.createObjectURL(te),Ue=document.createElement("a");Ue.href=Te,Ue.download=`consolidado_vendedores_dulces_${t}_a_${r}.csv`,Ue.click(),URL.revokeObjectURL(Te)};return i.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Consolidado por Vendedor - Dulces"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Desde"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:t,onChange:oe=>e(oe.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold mb-1",children:"Hasta"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:r,onChange:oe=>n(oe.target.value)})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:T,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",disabled:a,children:a?"Cargando...":"Aplicar filtros"})}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{type:"button",onClick:le,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 w-full",children:"Exportar CSV"})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-sm",children:[i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:Oh(B)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Credito"}),i.jsx("div",{className:"text-xl font-semibold",children:Oh(k)})]}),i.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-500",children:"Vendedores con Inventario"}),i.jsx("div",{className:"text-xl font-semibold",children:A.length})]})]}),i.jsx("div",{className:"overflow-x-auto mb-6",children:i.jsxs("table",{className:"min-w-full border text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes ordenados"}),i.jsx("th",{className:"border p-2",children:"Paquetes restantes"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Paquetes fiados"}),i.jsx("th",{className:"border p-2",children:"Total vendidos (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Cash (C$)"}),i.jsx("th",{className:"border p-2",children:"Total fiado (C$)"}),i.jsx("th",{className:"border p-2",children:"Comisin Crdito (C$)"}),i.jsx("th",{className:"border p-2",children:"rdenes creadas"})]})}),i.jsxs("tbody",{children:[A.map(oe=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:oe.vendorName}),i.jsx("td",{className:"border p-1",children:oe.branchLabel}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>P(oe.vendorId,"ordered"),children:oe.orderedPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>P(oe.vendorId,"remaining"),children:oe.remainingPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>P(oe.vendorId,"sold"),children:oe.soldPackages})}),i.jsx("td",{className:"border p-1",children:i.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>P(oe.vendorId,"credit"),children:oe.creditPackages})}),i.jsx("td",{className:"border p-1",children:Oh(oe.totalSoldMoney)}),i.jsx("td",{className:"border p-1",children:Oh(oe.commissionCash)}),i.jsx("td",{className:"border p-1",children:Oh(oe.totalCreditMoney)}),i.jsx("td",{className:"border p-1",children:Oh(oe.commissionCredit)}),i.jsx("td",{className:"border p-1",children:oe.ordersCreated})]},oe.vendorId)),A.length===0&&!a&&i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-3 text-center text-gray-500",children:"Sin datos para mostrar."})})]})]})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"font-semibold mb-2 text-sm",children:"Top 10 productos ms vendidos (paquetes)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-xs shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"#"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"})]})}),i.jsxs("tbody",{children:[m.map((oe,ie)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:ie+1}),i.jsx("td",{className:"border p-1",children:oe.productName}),i.jsx("td",{className:"border p-1",children:oe.packages}),i.jsx("td",{className:"border p-1",children:Oh(oe.totalMoney)})]},oe.productName)),m.length===0&&!a&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin productos para mostrar."})})]})]})})]}),o&&i.jsx("p",{className:"mt-2 text-sm text-gray-700",children:o}),y&&I&&w&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-[95%] max-w-4xl max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-lg",children:["Detalle"," ",I==="ordered"?"Paquetes ordenados":I==="remaining"?"Paquetes restantes":I==="sold"?"Paquetes vendidos":"Paquetes fiados"]}),i.jsxs("p",{className:"text-xs text-gray-500",children:[S==null?void 0:S.vendorName,"  ",S==null?void 0:S.branchLabel]})]}),i.jsx("button",{onClick:K,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-sm",children:"Cerrar"})]}),i.jsx("div",{className:"flex-1 overflow-auto p-4",children:i.jsxs("table",{className:"min-w-full border text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Total dinero (C$)"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Comisin vendedor (C$)"})]})}),i.jsxs("tbody",{children:[E.map((oe,ie)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:oe.date}),i.jsx("td",{className:"border p-1",children:oe.productName}),i.jsx("td",{className:"border p-1",children:oe.packages}),i.jsx("td",{className:"border p-1",children:Oh(oe.totalMoney)}),i.jsx("td",{className:"border p-1",children:oe.vendorName}),i.jsx("td",{className:"border p-1",children:Oh(oe.vendorCommission)})]},ie)),E.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin registros para mostrar."})})]})]})})]})})]})}const zl=t=>`C$${Number(t||0).toFixed(2)}`,h_=t=>Number(t||0).toFixed(3),dT=()=>{const t=new Date;return Ur(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},A_=()=>Ur(new Date,"yyyy-MM-dd");function yVe({transactions:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[a,s]=g.useState([]),o=g.useMemo(()=>{const me={};return a.forEach(Ee=>{Ee.email&&(me[Ee.email.trim().toLowerCase()]=Ee)}),me},[a]);g.useEffect(()=>{(async()=>{try{const me=sr(bt(je,"sellers_candies"),In("name","asc")),Ee=await Ht(me),ye=[];Ee.forEach(We=>{const ge=We.data();ye.push({id:We.id,name:ge.name||"",email:ge.email||"",commissionPercent:Number(ge.commissionPercent||0)})}),s(ye)}catch(me){console.error(me)}})()},[]);const[l,c]=g.useState(dT()),[u,d]=g.useState(A_()),[f,A]=g.useState(""),[h,m]=g.useState(""),p=g.useMemo(()=>{const me=new Map;return n.forEach(Ee=>{const ye=Ee.productId||Ee.productName;me.set(ye,{key:ye,name:Ee.productName})}),Array.from(me.values()).sort((Ee,ye)=>Ee.name.localeCompare(ye.name))},[n]),x=g.useMemo(()=>{const me=new Map;return n.forEach(Ee=>{const ye=(Ee.sellerEmail||"").trim().toLowerCase();if(!ye)return;const We=o[ye],ge=(We==null?void 0:We.name)||Ee.vendorName||ye;me.set(ye,{email:ye,label:ge})}),Array.from(me.values()).sort((Ee,ye)=>Ee.label.localeCompare(ye.label))},[n,o]),v=g.useMemo(()=>n.filter(me=>!(l&&me.date<l||u&&me.date>u||f&&(me.productId||me.productName)!==f||h&&(me.sellerEmail||"").trim().toLowerCase()!==h)),[n,l,u,f,h]),[y,b]=g.useState(A_()),[w,j]=g.useState(()=>`FAC-CANDY-${Date.now().toString().slice(-6)}`),[I,C]=g.useState(""),[S,E]=g.useState("0"),[B,k]=g.useState(()=>v.map(me=>me.id));g.useEffect(()=>{k(me=>me.filter(Ee=>v.some(ye=>ye.id===Ee)))},[v]);const[T,P]=g.useState([]),[K,le]=g.useState([]),[oe,ie]=g.useState(!1),[Ae,te]=g.useState(dT()),[Te,Ue]=g.useState(A_());g.useEffect(()=>{(async()=>{try{ie(!0);const me=sr(bt(je,"expensesCandies"),In("date","desc")),Ee=await Ht(me),ye=[];Ee.forEach(We=>{const ge=We.data();ye.push({id:We.id,date:ge.date,description:ge.description,amount:Number(ge.amount||0)})}),P(ye)}catch(me){console.error(me)}finally{ie(!1)}})()},[]);const O=g.useMemo(()=>T.filter(me=>!(!me.date||Ae&&me.date<Ae||Te&&me.date>Te)),[T,Ae,Te]),[H,G]=g.useState([]),[L,W]=g.useState(!1),[X,D]=g.useState(""),[Q,Z]=g.useState("DEBITO"),[be,U]=g.useState(""),ze=()=>{const me=Number(be);!X.trim()||!isFinite(me)||me<=0||(G(Ee=>[...Ee,{id:`${Date.now()}_${Ee.length+1}`,description:X.trim(),type:Q,amount:Number(me.toFixed(2))}]),D(""),U(""))},[re,J]=g.useState(null),[Re,ke]=g.useState(""),[Be,Ye]=g.useState("DEBITO"),[ot,Ct]=g.useState(""),jt=me=>{J(me.id),ke(me.description),Ye(me.type),Ct(me.amount.toFixed(2))},Ot=()=>{J(null),ke(""),Ye("DEBITO"),Ct("")},Tt=()=>{if(!re)return;const me=Number(ot);!isFinite(me)||me<=0||(G(Ee=>Ee.map(ye=>ye.id===re?{...ye,description:Re.trim(),type:Be,amount:Number(me.toFixed(2))}:ye)),Ot())},Qt=me=>{G(Ee=>Ee.filter(ye=>ye.id!==me)),re===me&&Ot()},Ft=(me,Ee)=>{k(ye=>Ee?[...new Set([...ye,me])]:ye.filter(We=>We!==me))},Qe=me=>{k(me?v.map(Ee=>Ee.id):[])},De=(me,Ee)=>{le(ye=>Ee?[...new Set([...ye,me])]:ye.filter(We=>We!==me))},Je=g.useMemo(()=>v.filter(me=>B.includes(me.id)),[v,B]),dt=g.useMemo(()=>H.filter(me=>me.type==="DEBITO").reduce((me,Ee)=>me+Ee.amount,0),[H]),ce=g.useMemo(()=>H.filter(me=>me.type==="CREDITO").reduce((me,Ee)=>me+Ee.amount,0),[H]),we=g.useMemo(()=>{let me=0,Ee=0,ye=0,We=0;for(const Ut of Je){const $t=Number(Ut.packages||0),Le=Number(Ut.cogsAmount||0),Ce=Number(Ut.amount||0);me+=$t,Ee+=Le,ye+=Ce;const pe=(Ut.sellerEmail||"").trim().toLowerCase(),He=o[pe],he=Number((He==null?void 0:He.commissionPercent)||0),ee=Ce*he/100;We+=ee}const ge=O.filter(Ut=>K.includes(Ut.id)).reduce((Ut,$t)=>Ut+Number($t.amount||0),0),Ie=ye-Ee,xt=ye-ge-dt+ce-We,Pt=Number(S||0),It=ye*Pt/100;return{totalPackages:Number(h_(me)),totalProvider:Number(Ee.toFixed(2)),totalSale:Number(ye.toFixed(2)),totalGastos:Number(ge.toFixed(2)),debits:Number(dt.toFixed(2)),credits:Number(ce.toFixed(2)),grossProfit:Number(Ie.toFixed(2)),finalAmount:Number(xt.toFixed(2)),totalCommissionVendors:Number(We.toFixed(2)),branchProfit:Number(It.toFixed(2)),branchFactor:Pt}},[Je,O,K,dt,ce,o,S]),[ue,ne]=g.useState(!1),[Ve,it]=g.useState(""),vt=async()=>{if(it(""),Je.length===0){it("Selecciona al menos 1 transaccin procesada.");return}try{ne(!0);const me={number:w.trim(),date:y,description:I.trim(),status:"PENDIENTE",createdAt:xr.now(),totalPackages:we.totalPackages,totalProvider:we.totalProvider,totalSale:we.totalSale,totalExpenses:we.totalGastos,totalDebits:we.debits,totalCredits:we.credits,grossProfit:we.grossProfit,totalCommissionVendors:we.totalCommissionVendors,branchFactorPercent:we.branchFactor,branchProfit:we.branchProfit,finalAmount:we.finalAmount,transactions:Je.map(Ee=>{const ye=Number(Ee.packages||0)||1,We=Number(Ee.cogsAmount||0),ge=Number(Ee.amount||0),Ie=We/ye,xt=ge/ye,Pt=(Ee.sellerEmail||"").trim().toLowerCase(),It=o[Pt],Ut=Number((It==null?void 0:It.commissionPercent)||0),$t=ge*Ut/100;return{id:Ee.id,date:Ee.date,productId:Ee.productId||null,productName:Ee.productName,vendorName:Ee.vendorName,sellerEmail:Ee.sellerEmail||null,packages:Number(h_(Ee.packages)),providerPricePack:Number(Ie.toFixed(4)),salePricePack:Number(xt.toFixed(4)),totalProvider:Number(We.toFixed(2)),totalSale:Number(ge.toFixed(2)),commissionPercent:Ut,commissionAmount:Number($t.toFixed(2))}}),expenses:O.filter(Ee=>K.includes(Ee.id)).map(Ee=>({id:Ee.id,date:Ee.date||null,description:Ee.description||"",amount:Number(Number(Ee.amount||0).toFixed(2))})),adjustments:H.map(Ee=>({id:Ee.id,description:Ee.description,type:Ee.type,amount:Number(Ee.amount.toFixed(2))}))};await Wn(bt(je,"invoicesCandies"),me),it(" Factura de dulces creada."),r()}catch(me){console.error(me),it(` Error al crear factura: ${(me==null?void 0:me.message)||"desconocido"}`)}finally{ne(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[i.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura CandyShop"}),i.jsx("button",{onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),i.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:y,onChange:me=>b(me.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:w,onChange:me=>j(me.target.value),placeholder:"FAC-CANDY-001"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Factor sucursal (%)"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:S,onChange:me=>E(me.target.value),placeholder:"Ej: 30"}),i.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Se aplica sobre el total de ventas para calcular la ganancia de sucursal."})]}),i.jsxs("div",{className:"md:col-span-1",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),i.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:I,onChange:me=>C(me.target.value),placeholder:"Comentarios de la factura"})]})]}),i.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:i.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Desde (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:l,onChange:me=>c(me.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Hasta (transaccin)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:me=>d(me.target.value)})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:f,onChange:me=>A(me.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),p.map(me=>i.jsx("option",{value:me.key,children:me.name},me.key))]})]}),i.jsxs("div",{className:"min-w-[180px]",children:[i.jsx("label",{className:"block text-sm font-medium",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:h,onChange:me=>m(me.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),x.map(me=>i.jsx("option",{value:me.email,children:me.label},me.email))]})]}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{c(dT()),d(A_()),A(""),m("")},children:"Quitar filtro"})]})}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Transacciones procesadas"}),i.jsxs("label",{className:"text-sm flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:v.length>0&&B.length===v.length,onChange:me=>Qe(me.target.checked)}),"Seleccionar todas (sobre el filtro)"]})]}),v.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay transacciones procesadas en el filtro actual."}):i.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Vendedor"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Paquetes"}),i.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border",children:"Precio venta"}),i.jsx("th",{className:"p-2 border",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border",children:"Total venta"}),i.jsx("th",{className:"p-2 border",children:"Comisin venta"})]})}),i.jsx("tbody",{children:v.map(me=>{const Ee=B.includes(me.id),ye=Number(me.packages||0)||1,We=Number(me.cogsAmount||0),ge=Number(me.amount||0),Ie=We/ye,xt=ge/ye,Pt=(me.sellerEmail||"").trim().toLowerCase(),It=o[Pt],Ut=Number((It==null?void 0:It.commissionPercent)||0),$t=ge*Ut/100;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:Ee,onChange:Le=>Ft(me.id,Le.target.checked)})}),i.jsx("td",{className:"p-2 border",children:me.date}),i.jsx("td",{className:"p-2 border",children:(It==null?void 0:It.name)||me.vendorName}),i.jsx("td",{className:"p-2 border",children:me.productName}),i.jsx("td",{className:"p-2 border",children:h_(me.packages)}),i.jsx("td",{className:"p-2 border",children:zl(Ie)}),i.jsx("td",{className:"p-2 border",children:zl(xt)}),i.jsx("td",{className:"p-2 border",children:zl(We)}),i.jsx("td",{className:"p-2 border",children:zl(ge)}),i.jsx("td",{className:"p-2 border",children:Ut>0?`${zl($t)} (${Ut.toFixed(2)}%)`:""})]},me.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),oe&&i.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),i.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:Ae,onChange:me=>te(me.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:Te,onChange:me=>Ue(me.target.value)})]})]})]}),O.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):i.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Sel"}),i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Monto"})]})}),i.jsx("tbody",{children:O.map(me=>{const Ee=K.includes(me.id);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{type:"checkbox",checked:Ee,onChange:ye=>De(me.id,ye.target.checked)})}),i.jsx("td",{className:"p-2 border",children:me.date||""}),i.jsx("td",{className:"p-2 border",children:me.description||""}),i.jsx("td",{className:"p-2 border",children:zl(Number(me.amount||0))})]},me.id)})})]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),i.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>W(!0),children:"Crear Cargo"})]}),H.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):i.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Descripcin"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Monto"}),i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:H.map(me=>{const Ee=re===me.id;return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:Ee?i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:Re,onChange:ye=>ke(ye.target.value)}):i.jsx("span",{title:me.description,children:me.description.length>60?`${me.description.slice(0,60)}`:me.description})}),i.jsx("td",{className:"p-2 border",children:Ee?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Be,onChange:ye=>Ye(ye.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]}):i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${me.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:me.type})}),i.jsx("td",{className:"p-2 border",children:Ee?i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:ot,onChange:ye=>Ct(ye.target.value)}):zl(me.amount)}),i.jsx("td",{className:"p-2 border",children:Ee?i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:Tt,children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:Ot,children:"Cancelar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Qt(me.id),children:"Eliminar"})]}):i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>jt(me),children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Qt(me.id),children:"Eliminar"})]})})]},me.id)})})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[i.jsx("div",{className:"space-y-1",children:i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:h_(we.totalPackages)})]})}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Total proveedor (costo):"," ",i.jsx("strong",{children:zl(we.totalProvider)})]}),i.jsxs("div",{children:["Total venta: ",i.jsx("strong",{children:zl(we.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta (venta  costo):"," ",i.jsx("strong",{children:zl(we.grossProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:zl(we.totalGastos)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:zl(we.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:zl(we.credits)})]}),i.jsxs("div",{children:["Comisin total vendedores:"," ",i.jsx("strong",{children:zl(we.totalCommissionVendors)})]}),i.jsxs("div",{children:["Ganancia sucursal (ventas  factor):"," ",i.jsx("strong",{children:zl(we.branchProfit)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (ventas  gastos  dbitos + crditos  comisin vendedores):"," ",i.jsx("span",{className:"text-blue-700",children:zl(we.finalAmount)})]})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{disabled:ue,onClick:vt,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:ue?"Creando":"Crear factura"}),i.jsx("button",{onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),Ve&&i.jsx("span",{className:"text-sm ml-2",children:Ve})]}),ue&&i.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[i.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),L&&i.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg_WHITE w-full max-w-lg rounded-xl shadow-xl p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),i.jsx("button",{className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>W(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),i.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:X,onChange:me=>D(me.target.value),placeholder:"Detalle del cargo"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Q,onChange:me=>Z(me.target.value),children:[i.jsx("option",{value:"DEBITO",children:"Dbito"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),i.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:be,onChange:me=>U(me.target.value),placeholder:"0.00"})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:ze,children:"Agregar"})})]})]})})]})}const Ka=t=>`C$ ${Number(t??0).toFixed(2)}`,m_=t=>Number(t??0).toFixed(3);function fT(t){const e=t.transactions||[];let r=Number(t.totalPackages??0),n=Number(t.totalProvider??0),a=Number(t.totalSale??0),s=Number(t.totalCommissionVendors??0);if(e.length>0&&(a===0||r===0)){r=0,n=0,a=0,s=0;for(const v of e){const y=Number(v.packages??0);r+=y,n+=Number(v.totalProvider??y*(v.providerPricePack??0)),a+=Number(v.totalSale??y*(v.salePricePack??0));const b=v.commissionAmount??Number(v.totalSale??0)*Number(v.commissionPercent??0)/100;s+=Number(b||0)}}const o=t.expenses||[],l=t.adjustments||[],c=t.totalExpenses!==void 0?Number(t.totalExpenses):o.reduce((v,y)=>v+Number(y.amount||0),0),u=l.filter(v=>v.type==="DEBITO").reduce((v,y)=>v+Number(y.amount||0),0),d=l.filter(v=>v.type==="CREDITO").reduce((v,y)=>v+Number(y.amount||0),0),f=t.totalDebits!==void 0?Number(t.totalDebits):u,A=t.totalCredits!==void 0?Number(t.totalCredits):d,h=a-n,m=Number(t.branchFactorPercent??0),p=t.branchProfit!==void 0?Number(t.branchProfit):Number((h*m/100).toFixed(2)),x=t.finalAmount!==void 0?Number(t.finalAmount):a-s-c-f+A;return{totalPackages:r,totalProvider:n,totalSale:a,commissionTotal:s,expenses:c,debits:f,credits:A,grossProfit:h,branchProfit:p,finalAmount:x}}function SG(t){const e=t.transactions||[];if(e.length===0)return"";const r=Array.from(new Set(e.map(n=>n.vendorName||"Sin nombre")));return r.length===1?r[0]:"Varios"}function bVe(){const[t,e]=g.useState([]),[r,n]=g.useState(!0),[a,s]=g.useState(null),o=g.useRef(null),[l,c]=g.useState(!1),u=async()=>{n(!0);const h=sr(bt(je,"invoicesCandies"),In("date","desc")),m=await Ht(h),p=[];m.forEach(x=>{const v=x.data();p.push({id:x.id,date:v.date,number:v.number,description:v.description,status:v.status||"PENDIENTE",totalPackages:v.totalPackages||0,totalProvider:v.totalProvider||0,totalSale:v.totalSale||0,totalExpenses:v.totalExpenses||0,totalDebits:v.totalDebits||0,totalCredits:v.totalCredits||0,totalCommissionVendors:v.totalCommissionVendors||0,finalAmount:v.finalAmount||0,branchFactorPercent:v.branchFactorPercent||0,branchProfit:v.branchProfit||0,transactions:(v.transactions||[]).map(y=>({id:y.id,date:y.date,vendorId:y.vendorId||null,vendorName:y.vendorName||"Sin nombre",sellerEmail:y.sellerEmail||null,productId:y.productId,productName:y.productName||"Sin nombre",packages:Number(y.packages||0),providerPricePack:Number(y.providerPricePack||0),salePricePack:Number(y.salePricePack||0),totalProvider:Number(y.totalProvider||0),totalSale:Number(y.totalSale||0),commissionPercent:Number(y.commissionPercent||0),commissionAmount:Number(y.commissionAmount||0)})),expenses:(v.expenses||[]).map(y=>({id:y.id,description:y.description||"",date:y.date||null,amount:Number(y.amount||0)})),adjustments:(v.adjustments||[]).map(y=>({id:y.id,description:y.description||"",type:y.type||"DEBITO",amount:Number(y.amount||0)}))})}),e(p),n(!1)};g.useEffect(()=>{u()},[]);const d=async h=>{const m=h.status==="PAGADA"?"PENDIENTE":"PAGADA";await kn(Xt(je,"invoicesCandies",h.id),{status:m}),e(p=>p.map(x=>x.id===h.id?{...x,status:m}:x)),(a==null?void 0:a.id)===h.id&&s({...h,status:m})},f=async h=>{if(window.confirm(`Eliminar factura del ${h.date}?`))try{await zn(Xt(je,"invoicesCandies",h.id)),e(m=>m.filter(p=>p.id!==h.id)),(a==null?void 0:a.id)===h.id&&s(null)}catch(m){console.error(m),alert("No se pudo eliminar la factura.")}},A=async()=>{if(!o.current||!a)return;const h=o.current,m=await Vm(h,{backgroundColor:"#ffffff",onclone:b=>{const w=b.body;w.style.background="#ffffff",w.querySelectorAll("*").forEach(j=>{const I=b.defaultView.getComputedStyle(j);I.boxShadow&&I.boxShadow!=="none"&&(j.style.boxShadow="none")})},scale:2}),p=m.toDataURL("image/png"),x=new an("p","mm","a4"),v=x.internal.pageSize.getWidth(),y=m.height*v/m.width;x.addImage(p,"PNG",0,0,v,y),x.save(`factura_candy_${a.number||a.date}.pdf`)};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[i.jsxs("div",{className:"flex items-center mb-4 gap-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Facturacin CandyShop"}),i.jsx("button",{className:"ml-auto bg-blue-600 text-white px-4 py-2 rounded-2xl hover:bg-blue-700 text-sm",onClick:()=>c(!0),children:"Crear factura Candy"})]}),l&&i.jsx(yVe,{onClose:()=>c(!1),onCreated:()=>{c(!1),u()}}),i.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"N factura"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Sub total (sin gastos/ajustes)"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Gastos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Dbitos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Crditos"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Estado"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):t.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin facturas"})}):t.map(h=>{const m=fT(h),p=SG(h);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.number||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:p}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(m.commissionTotal)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:m_(m.totalPackages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(m.totalSale)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(m.expenses)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(m.debits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(m.credits)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(m.finalAmount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:h.status})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>s(h),children:"Ver"}),i.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>d(h),children:h.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),i.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>f(h),children:"Eliminar"})]})})]},h.id)})})]})}),a&&i.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",a.date," ",a.number?` ${a.number}`:""]}),i.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>s(null),children:"Cerrar"}),i.jsx("button",{onClick:A,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const h=fT(a),m=SG(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Estado:"})," ",a.status]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Vendedor:"})," ",m]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Paquetes:"})," ",m_(h.totalPackages)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Total proveedor:"})," ",Ka(h.totalProvider)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Sub total ventas:"})," ",Ka(h.totalSale)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Ganancia bruta:"})," ",Ka(h.grossProfit)]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Comisin vendedores:"})," ",Ka(h.commissionTotal)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",Ka(h.expenses)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",Ka(h.debits)]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",Ka(h.credits)]})]})]})})(),i.jsx("h4",{className:"font-semibold mb-1",children:"Transacciones"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-2xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total proveedor"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total venta"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin venta"})]})}),i.jsx("tbody",{children:(a.transactions||[]).length>0?(a.transactions||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.vendorName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.productName}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:m_(h.packages)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(h.providerPricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(h.salePricePack)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(h.totalProvider)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(h.totalSale)}),i.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[Ka(h.commissionAmount||0),h.commissionPercent?` (${h.commissionPercent.toFixed(2)}%)`:""]})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:9,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin transacciones"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"})]})}),i.jsx("tbody",{children:(a.expenses||[]).length>0?(a.expenses||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description||""}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(h.amount)})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin gastos"})})})]})}),i.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),i.jsx("div",{className:"overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo de cargo"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),i.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"})]})}),i.jsx("tbody",{children:(a.adjustments||[]).length>0?(a.adjustments||[]).map((h,m)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:h.type})}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ka(h.amount)}),i.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.date})]},m)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin cargos extras"})})})]})}),(()=>{const h=fT(a);return i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{children:["Total paquetes: ",i.jsx("strong",{children:m_(h.totalPackages)})]}),i.jsxs("div",{children:["Total proveedor: ",i.jsx("strong",{children:Ka(h.totalProvider)})]})]}),i.jsxs("div",{className:"space-y-1 text-center",children:[i.jsxs("div",{children:["Sub total ventas: ",i.jsx("strong",{children:Ka(h.totalSale)})]}),i.jsxs("div",{children:["Ganancia bruta: ",i.jsx("strong",{children:Ka(h.grossProfit)})]}),i.jsxs("div",{children:["Ganancia sucursal: ",i.jsx("strong",{children:Ka(h.branchProfit)})]})]}),i.jsxs("div",{className:"space-y-1 text-right",children:[i.jsxs("div",{children:["Comisin vendedores:"," ",i.jsx("strong",{children:Ka(h.commissionTotal)})]}),i.jsxs("div",{children:["Gastos: ",i.jsx("strong",{children:Ka(h.expenses)})]}),i.jsxs("div",{children:["Dbitos: ",i.jsx("strong",{children:Ka(h.debits)})]}),i.jsxs("div",{children:["Crditos: ",i.jsx("strong",{children:Ka(h.credits)})]})]}),i.jsx("div",{className:"md:col-span-3 mt-3",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[i.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Total (sub total  comisin  gastos  dbitos + crditos):"}),i.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:Ka(h.finalAmount)})]})})]})})()]})]})}const Us=t=>Math.round((Number(t)||0)*100)/100,N0=t=>Math.round((Number(t)||0)*1e3)/1e3,yo=t=>Number(t??0).toFixed(2),Dh=t=>Number(t??0).toFixed(3),wVe=(t,e)=>{var A;const r=t.date??((A=t.timestamp)!=null&&A.toDate?Ur(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",a=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",s=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0;if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((h,m)=>{const p=Number((h==null?void 0:h.packages)??(h==null?void 0:h.qty)??(h==null?void 0:h.quantity)??0),x=Number((h==null?void 0:h.lineFinal)??0)||Math.max(0,Number((h==null?void 0:h.unitPricePackage)||(h==null?void 0:h.unitPrice)||0)*p-Number((h==null?void 0:h.discount)||0));let v=0;return c>0&&l>0&&Number(x||0)>0&&(v=Us(c*Number(x||0)/l)),{id:`${e}#${m}`,productName:String((h==null?void 0:h.productName)??"(sin nombre)"),quantity:p,amount:Us(x),date:r,type:s,vendorId:o,userEmail:a,vendorCommissionAmount:v}});const u=Number(t.packagesTotal??t.quantity??0),d=Number(t.amount??t.amountCharged??t.total??0)||0,f=Us(Number(t.vendorCommissionAmount??0)||0);return[{id:e,productName:String((t==null?void 0:t.productName)??"(sin nombre)"),quantity:u,amount:Us(d),date:r,type:s,vendorId:o,userEmail:a,vendorCommissionAmount:f}]};function NVe({role:t,roles:e,currentUserEmail:r,sellerCandyId:n}){const a=e&&e.length?e:t,s=!a||Sn(a,"admin"),o="daily_closures_candies",l="sales_candies",c="sellers_candies",[u,d]=g.useState(Ur(Wee(new Date),"yyyy-MM-dd")),[f,A]=g.useState(Ur(new Date,"yyyy-MM-dd")),[h,m]=g.useState(!0),[p,x]=g.useState([]),[v,y]=g.useState(null),[b,w]=g.useState(""),[j,I]=g.useState([]),[C,S]=g.useState("ALL"),[E,B]=g.useState({}),k=g.useRef(null);if(!s)return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Liquidaciones"}),i.jsx("p",{className:"text-sm text-red-600",children:"Acceso denegado: solo admin."})]});const T=async()=>{try{const X=await Ht(bt(je,c)),D=[];X.forEach(Q=>{const Z=Q.data();D.push({id:Q.id,name:Z.name||"",commissionPercent:Number(Z.commissionPercent||0)})}),I(D)}catch(X){console.error("Error cargando sellers_candies",X)}},P=async()=>{const X=performance.now();try{m(!0);const D=sr(bt(je,o),Ar("date",">=",u),Ar("date","<=",f)),Q=await Ht(D),Z=performance.now();console.log(" getDocs ms:",(Z-X).toFixed(1),"docs:",Q.size);const be=[];Q.forEach(J=>be.push({id:J.id,...J.data()}));const U=performance.now();console.log(" parse+set ms:",(U-Z).toFixed(1),"rows:",be.length),be.sort((J,Re)=>J.date<Re.date?1:J.date>Re.date?-1:0),x(be),y(null);const ze=new Set;be.forEach(J=>{(J.sales||[]).forEach(Re=>{const ke=String((Re==null?void 0:Re.id)??"").split("#")[0].trim();ke&&ze.add(ke)})});const re=Array.from(ze).filter(J=>!E[J]);if(re.length>0){const J={};for(const Re of re)try{const ke=await Cs(Xt(je,l,Re));if(ke.exists()){const Be=ke.data();J[Re]=wVe(Be,Re)}else J[Re]=[]}catch(ke){console.error("Error leyendo sale",Re,ke),J[Re]=[]}B(Re=>({...Re,...J}))}}catch(D){console.error(D),w(" Error cargando liquidaciones.")}finally{m(!1)}};g.useEffect(()=>{T()},[]),g.useEffect(()=>{P()},[]);const K=async X=>{X.preventDefault(),await P()},le=g.useMemo(()=>{const X={};return j.forEach(D=>X[D.id]=D.name||D.id),X},[j]),oe=X=>{const D=[];return(X.sales||[]).forEach(Q=>{const Z=String((Q==null?void 0:Q.id)??"").trim();if(!Z)return;const be=Z.split("#")[0],ze=(E[be]||[]).find(re=>re.id===Z);ze?D.push(ze):D.push({id:Z,productName:String((Q==null?void 0:Q.productName)??"(sin nombre)"),quantity:Number((Q==null?void 0:Q.quantity)??0),amount:Us(Number((Q==null?void 0:Q.amount)??0)),date:String((Q==null?void 0:Q.date)??""),type:"CONTADO",vendorId:"",userEmail:String((Q==null?void 0:Q.userEmail)??"(sin vendedor)"),vendorCommissionAmount:0})}),D},ie=X=>C==="ALL"?X:X.filter(D=>(D.vendorId||"")===C),Ae=g.useMemo(()=>p.map(X=>{const D=ie(oe(X));let Q=0,Z=0,be=0,U=0,ze=0,re=0;for(const J of D){const Re=Number(J.quantity||0),ke=Number(J.amount||0),Be=Number(J.vendorCommissionAmount||0);J.type==="CREDITO"?(Z+=Re,U+=ke,re+=Be):(Q+=Re,be+=ke,ze+=Be)}return{...X,_sales:D,_packsCash:N0(Q),_packsCredit:N0(Z),_amountCash:Us(be),_amountCredit:Us(U),_comCash:Us(ze),_comCredit:Us(re)}}),[p,E,C]),te=g.useMemo(()=>{let X=0,D=0,Q=0,Z=0,be=0,U=0;for(const ze of Ae)X+=Number(ze._packsCash||0),D+=Number(ze._packsCredit||0),Q+=Number(ze._amountCash||0),Z+=Number(ze._amountCredit||0),be+=Number(ze._comCash||0),U+=Number(ze._comCredit||0);return{packsCash:N0(X),packsCredit:N0(D),totalSales:Us(Q+Z),amountCash:Us(Q),amountCredit:Us(Z),comCash:Us(be),comCredit:Us(U)}},[Ae]),Te=g.useMemo(()=>{const X={},D={};for(const Q of Ae){const Z=Q._sales||[];for(const be of Z){const U=(be.vendorId||"").trim();if(!U)continue;const ze=le[U]||be.userEmail||U,re=Us(Number(be.vendorCommissionAmount||0));be.type==="CREDITO"?(D[U]||(D[U]={vendorId:U,name:ze,total:0}),D[U].total=Us(D[U].total+re)):(X[U]||(X[U]={vendorId:U,name:ze,total:0}),X[U].total=Us(X[U].total+re))}}return{cashRows:Object.values(X).filter(Q=>Q.total>0).sort((Q,Z)=>Z.total-Q.total),creditRows:Object.values(D).filter(Q=>Q.total>0).sort((Q,Z)=>Z.total-Q.total)}},[Ae,le]),Ue=g.useMemo(()=>j.map(X=>({id:X.id,label:X.name||X.id})).sort((X,D)=>X.label.localeCompare(D.label)),[j]),O=g.useMemo(()=>v&&Ae.find(X=>X.id===v.id)||null,[v,Ae]),H=g.useMemo(()=>O?O._sales||[]:[],[O]),G=g.useMemo(()=>{let X=0,D=0,Q=0,Z=0;for(const be of H)be.type==="CREDITO"?(D+=Number(be.quantity||0),Z+=Number(be.amount||0)):(X+=Number(be.quantity||0),Q+=Number(be.amount||0));return{packsCash:N0(X),packsCredit:N0(D),amountCash:Us(Q),amountCredit:Us(Z)}},[H]),L=g.useMemo(()=>{const X={};for(const D of H){const Q=D.productName||"(sin nombre)";X[Q]||(X[Q]={productName:Q,packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0});const Z=Number(D.quantity||0),be=Number(D.amount||0),U=Number(D.vendorCommissionAmount||0);D.type==="CREDITO"?(X[Q].packsCredit=N0(X[Q].packsCredit+Z),X[Q].amountCredit=Us(X[Q].amountCredit+be),X[Q].comCredit=Us(X[Q].comCredit+U)):(X[Q].packsCash=N0(X[Q].packsCash+Z),X[Q].amountCash=Us(X[Q].amountCash+be),X[Q].comCash=Us(X[Q].comCash+U))}return Object.values(X)},[H]),W=async()=>{if(!k.current||!O)return;const X=k.current;X.classList.add("force-pdf-colors");try{const Q=(await Vm(X,{backgroundColor:"#ffffff"})).toDataURL("image/png"),Z=new an;Z.addImage(Q,"PNG",10,10,190,0),Z.save(`liquidacion_${O.date}.pdf`)}finally{X.classList.remove("force-pdf-colors")}};return i.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Liquidaciones"}),i.jsxs("form",{onSubmit:K,className:"flex flex-wrap items-end gap-3 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:X=>d(X.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:f,onChange:X=>A(X.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm",children:"Vendedor"}),i.jsxs("select",{className:"border rounded px-2 py-1 min-w-[240px]",value:C,onChange:X=>S(X.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),Ue.map(X=>i.jsx("option",{value:X.id,children:X.label},X.id))]})]}),i.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3 mb-6",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-2xl font-bold",children:Dh(te.packsCash)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-2xl font-bold",children:Dh(te.packsCredit)})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",yo(te.totalSales)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",yo(te.amountCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",yo(te.amountCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",yo(te.comCash)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-2xl font-bold",children:["C$",yo(te.comCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),Te.cashRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Te.cashRows.map(X=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:X.name}),i.jsxs("strong",{className:"ml-2",children:["C$",yo(X.total)]})]},X.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),Te.creditRows.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Te.creditRows.map(X=>i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:X.name}),i.jsxs("strong",{className:"ml-2",children:["C$",yo(X.total)]})]},X.vendorId))})]})]}),h?i.jsx("p",{children:"Cargando..."}):Ae.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):i.jsxs("table",{className:"min-w-full text-sm mb-6 shadow-lg p-4 bg-white border-gray-100",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total paquetes Cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Total Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Total Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsx("tbody",{children:Ae.map(X=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:X.date}),i.jsx("td",{className:"border p-1",children:Dh(X._packsCash)}),i.jsx("td",{className:"border p-1",children:Dh(X._packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",yo(X._amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",yo(X._amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",yo(X._comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",yo(X._comCredit)]}),i.jsx("td",{className:"border p-1",children:i.jsx("div",{className:"flex items-center gap-2 justify-center",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>y(X),children:"Ver detalle"})})})]},X.id))})]}),O&&i.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[i.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",O.date]}),i.jsx("button",{onClick:()=>y(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),i.jsx("button",{onClick:W,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),i.jsxs("div",{ref:k,className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[i.jsxs("div",{children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",yo(G.amountCash)]})]}),i.jsxs("div",{children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",yo(G.amountCredit)]})]}),i.jsxs("div",{children:["Total paquetes cash:"," ",i.jsx("strong",{children:Dh(G.packsCash)})]}),i.jsxs("div",{children:["Total paquetes crdito:"," ",i.jsx("strong",{children:Dh(G.packsCredit)})]})]}),i.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),H.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin ventas en este cierre."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsx("tbody",{children:H.map((X,D)=>{const Q=X.vendorId&&le[X.vendorId]?le[X.vendorId]:X.userEmail,Z=Us(Number(X.vendorCommissionAmount||0));return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:Q}),i.jsx("td",{className:"border p-1",children:X.productName}),i.jsx("td",{className:"border p-1",children:X.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-1",children:Dh(X.quantity)}),i.jsxs("td",{className:"border p-1",children:["C$",yo(X.amount)]}),i.jsx("td",{className:"border p-1",children:Z>0?`C$${yo(Z)}`:""}),i.jsx("td",{className:"border p-1",children:X.date||""})]},D)})})]}),i.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),L.length===0?i.jsx("p",{className:"text-sm text-gray-500",children:"Sin datos para consolidar."}):i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsx("tbody",{children:L.map((X,D)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:X.productName}),i.jsx("td",{className:"border p-1",children:Dh(X.packsCash)}),i.jsx("td",{className:"border p-1",children:Dh(X.packsCredit)}),i.jsxs("td",{className:"border p-1",children:["C$",yo(X.amountCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",yo(X.amountCredit)]}),i.jsxs("td",{className:"border p-1",children:["C$",yo(X.comCash)]}),i.jsxs("td",{className:"border p-1",children:["C$",yo(X.comCredit)]})]},D))})]})]})]}),b&&i.jsx("p",{className:"mt-3 text-sm",children:b})]})}const zr=t=>Math.round((Number(t)||0)*100)/100,Al=t=>Math.round((Number(t)||0)*1e3)/1e3,Qr=t=>Number(t??0).toFixed(2),ii=t=>Number(t??0).toFixed(3),oI=t=>{const e=String(t||"").toUpperCase().trim();return e==="RIVAS"?"RIVAS":e==="SAN_JORGE"||e==="SANJORGE"||e==="SJ"?"SAN_JORGE":e==="ISLA"||e==="OMETEPE"?"ISLA":""},Rr=t=>{const e=Number(t);return Number.isFinite(e)?e:0},CVe=t=>Math.max(0,Math.min(1,t));function IG({title:t,series:e,valuePrefix:r="C$"}){const u=e.map(b=>Number(b.value||0)),d=u.length?Math.min(...u):0,f=u.length?Math.max(...u):0,A=f-d||1,h=840,m=204,p=e.map((b,w)=>{const j=44+(e.length<=1?h/2:w/(e.length-1)*h),I=18+(1-(Number(b.value||0)-d)/A)*m;return{x:j,y:I,...b}}),x=p.map((b,w)=>`${w===0?"M":"L"} ${b.x.toFixed(2)} ${b.y.toFixed(2)}`).join(" "),v=p[p.length-1],y=v?v.value:0;return i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsx("div",{className:"font-semibold text-sm sm:text-base",children:t}),i.jsxs("div",{className:"text-xs text-gray-600 whitespace-nowrap",children:["ltimo: ",i.jsx("strong",{children:r+Qr(y)})]})]}),i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("svg",{viewBox:"0 0 900 260",className:"min-w-[720px] w-full h-auto",role:"img","aria-label":t,children:[[0,1,2,3].map(b=>{const w=18+b/3*m;return i.jsx("line",{x1:44,y1:w,x2:884,y2:w,stroke:"#e5e7eb",strokeWidth:"1"},b)}),i.jsxs("text",{x:8,y:28,fontSize:"12",fill:"#6b7280",children:[r,Qr(f)]}),i.jsxs("text",{x:8,y:18+m,fontSize:"12",fill:"#6b7280",children:[r,Qr(d)]}),i.jsx("path",{d:x,fill:"none",stroke:"#111827",strokeWidth:"2.5"}),p.map((b,w)=>i.jsx("circle",{cx:b.x,cy:b.y,r:"3.5",fill:"#111827"},w)),e.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("text",{x:44,y:246,fontSize:"12",fill:"#6b7280",textAnchor:"start",children:e[0].label}),i.jsx("text",{x:884,y:246,fontSize:"12",fill:"#6b7280",textAnchor:"end",children:e[e.length-1].label})]})]})})]})}function _Ve({title:t,items:e}){const r=e.reduce((f,A)=>f+Number(A.value||0),0),n=240,a=86,s=120,o=120,l=r>0?r:1;let c=0;const u=["#111827","#374151","#6b7280","#9ca3af"],d=e.map((f,A)=>{const h=Math.max(0,Number(f.value||0)),m=c/l,p=h/l;c+=h;const x=m+p,v=m*Math.PI*2-Math.PI/2,y=x*Math.PI*2-Math.PI/2,b=s+a*Math.cos(v),w=o+a*Math.sin(v),j=s+a*Math.cos(y),I=o+a*Math.sin(y),C=p>.5?1:0;return{d:[`M ${s} ${o}`,`L ${b.toFixed(2)} ${w.toFixed(2)}`,`A ${a} ${a} 0 ${C} 1 ${j.toFixed(2)} ${I.toFixed(2)}`,"Z"].join(" "),fill:u[A%u.length],...f,frac:p}});return i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsx("div",{className:"font-semibold text-sm sm:text-base mb-2",children:t}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("div",{className:"w-full md:w-auto overflow-x-auto",children:i.jsxs("svg",{viewBox:`0 0 ${n} ${n}`,className:"min-w-[240px] w-[260px] h-auto",role:"img","aria-label":t,children:[d.map((f,A)=>i.jsx("path",{d:f.d,fill:f.fill},A)),i.jsx("circle",{cx:s,cy:o,r:"48",fill:"#ffffff"}),i.jsx("text",{x:s,y:o-4,textAnchor:"middle",fontSize:"12",fill:"#6b7280",children:"Total"}),i.jsxs("text",{x:s,y:o+16,textAnchor:"middle",fontSize:"14",fill:"#111827",fontWeight:"700",children:["C$",Qr(r)]})]})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:e.map((f,A)=>{const h=Number(f.value||0),m=CVe(h/(r||1))*100;return i.jsxs("div",{className:"border rounded-xl p-2 bg-gray-50",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"text-sm font-semibold truncate",children:f.label}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Qr(h)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[m.toFixed(1),"%"]}),i.jsx("div",{className:"h-2 bg-white border rounded-full mt-2 overflow-hidden",children:i.jsx("div",{className:"h-full",style:{width:`${m}%`,background:u[A%u.length]}})})]},f.label)})}),i.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"*Distribucin basada en ventas del perodo con los filtros actuales."})]})]})]})}const EVe=(t,e)=>{var x;const r=t.date??((x=t.timestamp)!=null&&x.toDate?Ur(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=String(t.processedDate??t.closureDate??"").trim(),a=t.status??"FLOTANTE",s=t.type||"CONTADO",o=String(t.vendorId??"").trim(),l=String(t.vendorName??"").trim()||String(t.userEmail??"").trim()||o||"(sin vendedor)",c=String(t.customerId??"").trim(),u=String(t.customerName??"").trim()||String(t.clientName??"").trim()||"",d=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,f=Number(t.vendorCommissionAmount??0)||0,A=oI(t.branch??t.vendorBranch);if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((v,y)=>{const b=Number((v==null?void 0:v.packages)??0)||0,w=Number((v==null?void 0:v.total)??0)||Math.max(0,Number((v==null?void 0:v.unitPricePackage)||0)*b-Number((v==null?void 0:v.discount)||0)),j=oI(v==null?void 0:v.branch)||A;let I=0;return f>0&&d>0&&w>0&&(I=zr(f*w/d)),{id:`${e}#${y}`,docId:e,productId:String((v==null?void 0:v.productId)??""),productName:String((v==null?void 0:v.productName)??"(sin nombre)"),date:r,processedDate:n,status:a,type:s,vendorId:o,vendorName:l,customerId:c,customerName:u,branch:j||"",packages:b,amount:zr(w),commission:zr(I)}});const h=Number(t.packagesTotal??0)||0,m=Number(t.total??t.amount??t.amountCharged??0)||0,p=zr(Number(t.vendorCommissionAmount??0)||0);return[{id:`${e}#0`,docId:e,productId:"",productName:"(sin nombre)",date:r,processedDate:n,status:a,type:s,vendorId:o,vendorName:l,customerId:c,customerName:u,branch:A||"",packages:h,amount:zr(m),commission:zr(p)}]};function SVe({role:t,roles:e}){var kt;const r=e&&e.length?e:t,n=!r||Sn(r,"admin"),a=Ur(new Date,"yyyy-MM-dd"),[s,o]=g.useState(a),[l,c]=g.useState(a),[u,d]=g.useState("TODAS"),[f,A]=g.useState("AMBAS"),[h,m]=g.useState("ALL"),[p,x]=g.useState("ALL"),[v,y]=g.useState(""),[b,w]=g.useState(""),[j,I]=g.useState(""),[C,S]=g.useState(""),[E,B]=g.useState("DIA"),[k,T]=g.useState(!0),[P,K]=g.useState(""),[le,oe]=g.useState([]),[ie,Ae]=g.useState([]),[te,Te]=g.useState([]),[Ue,O]=g.useState({}),[H,G]=g.useState([]),[L,W]=g.useState([]),[X,D]=g.useState([]),[Q,Z]=g.useState([]),[be,U]=g.useState([]),[ze,re]=g.useState([]),[J,Re]=g.useState(""),[ke,Be]=g.useState(""),[Ye,ot]=g.useState(null),Ct=g.useRef(null),[jt,Ot]=g.useState([]),[Tt,Qt]=g.useState("DETALLE"),[Ft,Qe]=g.useState(!1),[De,Je]=g.useState(!1),[dt,ce]=g.useState(!1),[we,ue]=g.useState(!1),[ne,Ve]=g.useState(!1),[it,vt]=g.useState(!1),me=g.useMemo(()=>{const de={};return L.forEach(qe=>de[qe.id]=String(qe.name||"").trim()),de},[L]),Ee=g.useMemo(()=>{const de={};return ie.forEach(qe=>de[qe.id]=qe),de},[ie]),ye=de=>{const qe=de.customerId?me[de.customerId]:"";return(de.customerName||qe||"").trim()||(de.customerId?me[de.customerId]||de.customerId:"")||""};g.useEffect(()=>{if(!n)return;(async()=>{try{const qe=await Ht(bt(je,"inventory_candies")),at=[];qe.forEach(st=>at.push({id:st.id,...st.data()})),Ot(at)}catch(qe){console.error("inventory_candies all error:",qe),Ot([])}})()},[n]),g.useEffect(()=>{(async()=>{try{const qe=await Ht(bt(je,"sellers_candies")),at=[];qe.forEach(Nt=>{const Rt=Nt.data();at.push({id:Nt.id,name:String(Rt.name||"").trim(),commissionPercent:Number(Rt.commissionPercent||0),branch:Rt.branch||""})});const st=new Map;at.forEach(Nt=>st.set(Nt.id,Nt)),Ae(Array.from(st.values()).sort((Nt,Rt)=>Nt.name.localeCompare(Rt.name)))}catch(qe){console.error(qe)}})()},[]),g.useEffect(()=>{if(!n||!s||!l)return;T(!0),K("");const de=sr(bt(je,"sales_candies"),Ar("date",">=",s),Ar("date","<=",l),In("date","asc")),qe=Pd(de,at=>{const st=[];at.forEach(Nt=>st.push(...EVe(Nt.data(),Nt.id))),oe(st),T(!1)},at=>{console.error("sales_candies periodo error:",at),oe([]),T(!1),K(" Error cargando ventas del perodo (revis ndices si aplica).")});return()=>qe()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const qe=sr(bt(je,"candy_main_orders"),Ar("date",">=",s),Ar("date","<=",l)),at=await Ht(qe),st=[];at.forEach(Nt=>st.push({id:Nt.id,...Nt.data()})),Te(st)}catch(qe){console.error("candy_main_orders error:",qe),Te([])}})()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const qe=await Ht(sr(bt(je,"candy_main_orders"),In("createdAt","desc"))),at={},st=(Nt,Rt)=>`${Nt}#${String(Rt).padStart(10,"0")}`;qe.forEach(Nt=>{var kr;const Rt=Nt.data(),nr=Number(((kr=Rt.createdAt)==null?void 0:kr.seconds)??0),_r=String(Rt.date||""),$r=st(_r,nr),or=Array.isArray(Rt.items)?Rt.items:[];for(const en of or){const rn=String(en.id||en.productId||"");if(!rn)continue;const Er={unitPriceRivas:Number(en.unitPriceRivas||0),unitPriceSanJorge:Number(en.unitPriceSanJorge||0),unitPriceIsla:Number(en.unitPriceIsla||0),key:$r},Se=at[rn];(!Se||Er.key>Se.key)&&(at[rn]=Er)}}),O(at)}catch(qe){console.error("candy_main_orders catalog error:",qe),O({})}})()},[n]),g.useEffect(()=>{if(!n)return;const de=sr(bt(je,"inventory_candies_sellers"),Ar("date",">=",s),Ar("date","<=",l)),qe=Pd(de,at=>{const st=[];at.forEach(Nt=>st.push({id:Nt.id,...Nt.data()})),G(st)},at=>{console.error("inventory_candies_sellers error:",at),G([])});return()=>qe()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const qe=sr(bt(je,"expenses_candies"),Ar("date",">=",s),Ar("date","<=",l),In("date","asc")),at=await Ht(qe),st=[];at.forEach(Nt=>st.push({id:Nt.id,...Nt.data()})),Z(st)}catch(qe){console.warn("expenses_candies sin ndice, usando fallback:",qe);try{const at=await Ht(bt(je,"expenses_candies")),st=[];at.forEach(Nt=>st.push({id:Nt.id,...Nt.data()})),Z(st.filter(Nt=>String(Nt.date||"")>=s&&String(Nt.date||"")<=l))}catch(at){console.error(at),Z([])}}})()},[n,s,l]),g.useEffect(()=>{if(!n)return;(async()=>{try{const qe=await Ht(bt(je,"inventory_candies")),at=[];qe.forEach(st=>at.push({id:st.id,...st.data()})),U(at)}catch(qe){console.error("inventory_candies global error:",qe),U([])}})()},[n]),g.useEffect(()=>{if(!n)return;(async()=>{try{const qe=await Ht(bt(je,"inventory_candies_sellers")),at=[];qe.forEach(st=>at.push({id:st.id,...st.data()})),re(at)}catch(qe){console.error("inventory_candies_sellers global error:",qe),re([])}})()},[n]),g.useEffect(()=>{if(!n)return;const de=sr(bt(je,"customers_candies")),qe=Pd(de,at=>{const st=[];at.forEach(Nt=>{var Rt,nr,_r;return st.push({id:Nt.id,name:String(((Rt=Nt.data())==null?void 0:Rt.name)||"").trim(),initialDebt:Number(((nr=Nt.data())==null?void 0:nr.initialDebt)||0),initialDebtDate:String(((_r=Nt.data())==null?void 0:_r.initialDebtDate)||"").trim()})}),W(st)},at=>{console.error("customers_candies snapshot error:",at),W([])});return()=>qe()},[n]),g.useEffect(()=>{if(!n)return;(async()=>{try{const qe=sr(bt(je,"ar_movements"),Ar("date","<=",l),In("date","asc")),at=await Ht(qe),st=[];at.forEach(Nt=>st.push({id:Nt.id,...Nt.data()})),D(st)}catch(qe){console.warn("ar_movements sin ndice, usando fallback:",qe);try{const at=await Ht(bt(je,"ar_movements")),st=[];at.forEach(Nt=>st.push({id:Nt.id,...Nt.data()})),D(st.filter(Nt=>String(Nt.date||"")<=l))}catch(at){console.error(at),D([])}}})()},[n,l]);const We=g.useMemo(()=>{let de=[...le];if(u!=="TODAS"&&(de=de.filter(st=>st.status===u)),f==="CASH"&&(de=de.filter(st=>st.type==="CONTADO")),f==="CREDITO"&&(de=de.filter(st=>st.type==="CREDITO")),h!=="ALL"&&(de=de.filter(st=>(st.vendorId||"")===h)),p!=="ALL"&&(de=de.filter(st=>st.branch===p)),v.trim()){const st=v.trim().toLowerCase();de=de.filter(Nt=>(Nt.productName||"").toLowerCase().includes(st))}if(b.trim()){const st=b.trim().toLowerCase();de=de.filter(Nt=>(ye(Nt)||"").toLowerCase().includes(st))}const qe=j.trim()?Number(j):null,at=C.trim()?Number(C):null;return qe!==null&&!Number.isNaN(qe)&&(de=de.filter(st=>(st.amount||0)>=qe)),at!==null&&!Number.isNaN(at)&&(de=de.filter(st=>(st.amount||0)<=at)),de},[le,u,f,h,p,v,b,j,C,me]),ge=g.useMemo(()=>{let de=0,qe=0,at=0,st=0,Nt=0,Rt=0;for(const _r of We){const $r=Rr(_r.packages),or=Rr(_r.amount),kr=Rr(_r.commission);_r.type==="CREDITO"?(qe+=$r,st+=or,Rt+=kr):(de+=$r,at+=or,Nt+=kr)}const nr=zr(at+st);return{packsCash:Al(de),packsCredit:Al(qe),salesCash:zr(at),salesCredit:zr(st),salesTotal:nr,commCash:zr(Nt),commCredit:zr(Rt),commTotal:zr(Nt+Rt)}},[We]),Ie=g.useMemo(()=>{let de=0,qe=0,at=0,st=0,Nt=0,Rt=0;for(const nr of te){const _r=Array.isArray(nr.items)?nr.items:[];for(const $r of _r)de+=Rr($r.totalRivas),qe+=Rr($r.totalSanJorge),at+=Rr($r.totalIsla),st+=Rr($r.gainRivas),Nt+=Rr($r.gainSanJorge),Rt+=Rr($r.gainIsla)}return{expectedRivas:zr(de),expectedSanJorge:zr(qe),expectedIsla:zr(at),grossRivas:zr(st),grossSanJorge:zr(Nt),grossIsla:zr(Rt),grossTotal:zr(st+Nt+Rt),expectedTotal:zr(de+qe+at)}},[te]),xt=g.useMemo(()=>{const de={RIVAS:{sales:0,packages:0},SAN_JORGE:{sales:0,packages:0},ISLA:{sales:0,packages:0}};for(const qe of We){const at=qe.branch;at&&(de[at].sales+=Rr(qe.amount),de[at].packages+=Rr(qe.packages))}return{RIVAS:{sales:zr(de.RIVAS.sales),packages:Al(de.RIVAS.packages)},SAN_JORGE:{sales:zr(de.SAN_JORGE.sales),packages:Al(de.SAN_JORGE.packages)},ISLA:{sales:zr(de.ISLA.sales),packages:Al(de.ISLA.packages)}}},[We]),Pt=g.useMemo(()=>({RIVAS:zr(xt.RIVAS.sales-Ie.expectedRivas),SAN_JORGE:zr(xt.SAN_JORGE.sales-Ie.expectedSanJorge),ISLA:zr(xt.ISLA.sales-Ie.expectedIsla)}),[xt,Ie]),It=g.useMemo(()=>{const de={},qe={};for(const Nt of We){const Rt=(Nt.vendorId||"").trim();if(!Rt)continue;const nr=ie.find(or=>or.id===Rt),_r=(nr==null?void 0:nr.name)||Nt.vendorName||"(sin vendedor)",$r=Rr(Nt.commission);Nt.type==="CREDITO"?(qe[Rt]||(qe[Rt]={vendorId:Rt,name:_r,total:0}),qe[Rt].total=zr(qe[Rt].total+$r)):(de[Rt]||(de[Rt]={vendorId:Rt,name:_r,total:0}),de[Rt].total=zr(de[Rt].total+$r))}const at=Object.values(de).sort((Nt,Rt)=>Rt.total-Nt.total),st=Object.values(qe).sort((Nt,Rt)=>Rt.total-Nt.total);return{cashArr:at,creditArr:st}},[We,ie]),Ut=g.useMemo(()=>{const de=(Er,Se)=>Er.reduce((gt,er)=>gt+Number((er==null?void 0:er[Se])??0),0),qe=Er=>{const Se=Number(Er);return Number.isFinite(Se)?Math.floor(Se):0},at=Er=>{const Se=Number((Er==null?void 0:Er.totalPackages)??0);if(Se>0)return Se;const gt=Array.isArray(Er==null?void 0:Er.items)?Er.items:[];return de(gt,"packages")};let st=0,Nt=0;for(const Er of te){const Se=Array.isArray(Er.items)?Er.items:[];if(Se.length)for(const gt of Se)st+=Number((gt==null?void 0:gt.subtotal)??0);else st+=Number(Er.subtotal??0);Nt+=at(Er)}let Rt=0,nr=0,_r=0;const $r=Er=>{const Se=Number(Er==null?void 0:Er.remainingPackages);if(Number.isFinite(Se)&&Se>0)return Math.floor(Se);const gt=Math.max(1,qe((Er==null?void 0:Er.unitsPerPackage)??1)),er=qe((Er==null?void 0:Er.remainingUnits)??(Er==null?void 0:Er.remaining)??0);return er>0?Math.max(0,Math.floor(er/gt)):0};for(const Er of H)Rt+=Number(Er.subtotal??0),nr+=Number(Er.packages??0),_r+=$r(Er);const or=new Set(te.filter(Er=>String(Er.date||"")>=s&&String(Er.date||"")<=l).map(Er=>Er.id));let kr=0;for(const Er of jt){const Se=String(Er.orderId||"").trim();Se&&or.has(Se)&&(kr+=Number(Er.remainingPackages??0))}const en=be.reduce((Er,Se)=>Er+Rr(Se.remainingPackages),0),rn=ze.reduce((Er,Se)=>Er+Rr(Se.remainingPackages),0);return{providerTotalMaster:zr(st),providerTotalVendor:zr(Rt),orderedPacksMaster:Al(Nt),remainingPacksMaster:Al(kr),orderedPacksVendor:Al(nr),remainingPacksVendor:Al(_r),globalRemainingMaster:Al(en),globalRemainingVendor:Al(rn)}},[te,H,jt,s,l,be,ze]),$t=g.useMemo(()=>{const de={};let qe=0;for(const at of Q){const st=String(at.date||"").trim();if(!st)continue;const Nt=Math.max(0,Rr(at.amount));qe+=Nt,de[st]=zr((de[st]||0)+Nt)}return{total:zr(qe),byDay:de}},[Q]),Le=g.useMemo(()=>{let de=0;for(const qe of te){const at=Array.isArray(qe.items)?qe.items:[];if(at.length)for(const st of at)de+=Rr(st==null?void 0:st.subtotal);else de+=Rr(qe.subtotal)}return zr(de)},[te]),Ce=g.useMemo(()=>{var $r;const de=or=>{const kr=Math.max(1,Math.floor(Rr(or.unitsPerPackage||1))),en=Rr(or.totalUnits)>0?Rr(or.totalUnits):Rr(or.packages)*kr;let rn=0;Rr(or.remainingUnits)>0?rn=Rr(or.remainingUnits):Rr(or.remainingPackages)>0?rn=Rr(or.remainingPackages)*kr:rn=0;const Er=Math.max(0,en-rn);return{orderedUnits:en,remainingUnits:rn,soldUnits:Er,upp:kr}},qe=or=>{const kr=Ee[or];return oI(kr==null?void 0:kr.branch)||"ISLA"},at=(or,kr)=>{var en,rn,Er;return kr==="ISLA"?Rr(((en=Ue[String(or.productId||"")])==null?void 0:en.unitPriceIsla)??or.unitPriceIsla):kr==="RIVAS"?Rr(((rn=Ue[String(or.productId||"")])==null?void 0:rn.unitPriceRivas)??or.unitPriceRivas):kr==="SAN_JORGE"?Rr(((Er=Ue[String(or.productId||"")])==null?void 0:Er.unitPriceSanJorge)??or.unitPriceSanJorge):0},st=(or,kr)=>{const en=Math.max(0,Math.floor(Rr(or.packages))),rn=at(or,kr),Er=zr(rn*en);if(Er>0)return Er;const Se=Rr(or.totalVendor)||(kr==="ISLA"?Rr(or.totalIsla):kr==="RIVAS"?Rr(or.totalRivas):kr==="SAN_JORGE"?Rr(or.totalSanJorge):0);if(Se>0)return Se;const gt=Rr(or.unitPriceVendor);if(gt>0){const{orderedUnits:er}=de(or);return gt*er}return 0},Nt=(or,kr)=>{const en=at(or,kr),{orderedUnits:rn,upp:Er}=de(or);if(en>0&&Er>0)return en/Er;const Se=Rr(or.unitPriceVendor);if(Se>0)return Se;const gt=st(or,kr);return gt>0&&rn>0?gt/rn:0},Rt=new Map;for(const or of H){const kr=String(or.orderId||"").trim(),en=kr||`DOC:${or.id}`,rn=String(or.sellerId||"").trim(),Er=String(or.sellerName||"").trim()||rn&&(($r=Ee[rn])==null?void 0:$r.name)||""||"(sin vendedor)",Se=String(or.date||"").trim(),gt=rn?qe(rn):"",{orderedUnits:er,remainingUnits:Mr,soldUnits:Or}=de(or),ir=st(or,gt),br=Nt(or,gt),wr=br>0?br*Or:er>0?ir*Or/er:0,Xr=zr(ir-wr);Rt.has(en)||Rt.set(en,{orderKey:en,orderId:kr||en,date:Se,sellerId:rn,sellerName:Er,branch:gt,totalOrden:0,vendido:0,restante:0,comision:0,totalEsperado:0,lines:[]});const Ir=Rt.get(en);Ir.lines.push({...or,orderedUnits:er,soldUnits:Or,remainingUnits:Mr,lineTotal:zr(ir),lineSoldValue:zr(wr),lineRemainingValue:zr(Xr)}),Ir.totalOrden+=ir,Ir.vendido+=wr,Ir.restante+=Xr,Ir.comision+=Rr(or.uVendor??or.vendorProfit??or.gainVendor)}for(const or of Rt.values())or.comision=zr(or.comision),or.totalEsperado=zr(or.totalOrden-or.comision),or.totalOrden=zr(or.totalOrden),or.vendido=zr(or.vendido),or.restante=zr(or.restante);const nr=Array.from(Rt.values()).sort((or,kr)=>or.date&&kr.date?or.date<kr.date?1:-1:kr.totalOrden-or.totalOrden),_r=nr.reduce((or,kr)=>(or.totalOrden+=Rr(kr.totalOrden),or.vendido+=Rr(kr.vendido),or.restante+=Rr(kr.restante),or.comision+=Rr(kr.comision),or.totalEsperado+=Rr(kr.totalEsperado),or),{totalOrden:0,vendido:0,restante:0,comision:0,totalEsperado:0});return{global:{totalOrden:zr(_r.totalOrden),vendido:zr(_r.vendido),restante:zr(_r.restante),comision:zr(_r.comision),totalEsperado:zr(_r.totalEsperado)},orders:nr}},[H,Ee,Ue]),pe=g.useMemo(()=>{var st,Nt,Rt;let de=0,qe=0;for(const nr of H){const _r=String(nr.sellerId||"").trim(),$r=_r?Ee[_r]:void 0,or=oI($r==null?void 0:$r.branch)||"ISLA",kr=Math.max(0,Math.floor(Rr(nr.packages)));if(!kr)continue;const en=Rr(or==="ISLA"?((st=Ue[String(nr.productId||"")])==null?void 0:st.unitPriceIsla)??nr.unitPriceIsla:or==="RIVAS"?((Nt=Ue[String(nr.productId||"")])==null?void 0:Nt.unitPriceRivas)??nr.unitPriceRivas:((Rt=Ue[String(nr.productId||"")])==null?void 0:Rt.unitPriceSanJorge)??nr.unitPriceSanJorge);let rn=zr(en*kr);rn||(rn=Rr(or==="ISLA"?nr.totalIsla:or==="RIVAS"?nr.totalRivas:nr.totalSanJorge)),rn&&(de+=rn,qe+=rn)}const at=zr(Rr(Ie.expectedIsla)-qe);return{dispersedTotal:zr(de),dispersedIsla:zr(qe),totalExistenteIsla:at}},[H,Ee,Ie.expectedIsla,Ue]),He=g.useMemo(()=>({net:zr(H.reduce((qe,at)=>{const st=at.uNeta,Nt=Rr(st);if(Nt!==0||st===0)return qe+Nt;const Rt=Rr(at.grossProfit),nr=Rr(at.logisticAllocated??at.gastos??at.gasto),_r=Rr(at.uVendor??at.vendorProfit);return qe+(Rt-nr-_r)},0))}),[H]),he=g.useMemo(()=>{let de=0,qe=0,at=0;for(const st of We){if(st.type!=="CREDITO")continue;const Nt=Rr(st.amount),Rt=Rr(st.commission);de+=Nt,qe+=Nt-Rt}for(const st of X){const Nt=String(st.date||"").trim();if(!Nt||Nt<s||Nt>l)continue;const Rt=Rr(st.amount);(st.type||(Rt<0?"ABONO":"CARGO"))==="ABONO"&&(at+=Math.abs(Rt))}return{cxc:zr(de),recaudado:zr(at),utilidadBruta:zr(qe)}},[We,X,s,l]),ee=g.useMemo(()=>{if(!ke)return null;const de=Ce.orders.find(st=>st.orderKey===ke);if(!de)return null;const qe={};for(const st of de.lines){const Nt=String(st.productName||"(sin nombre)");qe[Nt]||(qe[Nt]={productName:Nt,asociados:0,vendidos:0,restantes:0});const Rt=Math.max(0,Math.floor(Rr(st.packages))),nr=Math.max(1,Math.floor(Rr(st.unitsPerPackage||1))),_r=Math.max(0,Math.floor(Rr(st.remainingPackages)||(Rr(st.remainingUnits)>0?Rr(st.remainingUnits)/nr:0))),$r=Math.max(0,Rt-_r);qe[Nt].asociados+=Rt,qe[Nt].vendidos+=$r,qe[Nt].restantes+=_r}const at=Object.values(qe).map(st=>({...st,asociados:Math.floor(st.asociados),vendidos:Math.floor(st.vendidos),restantes:Math.floor(st.restantes)})).sort((st,Nt)=>Nt.asociados-st.asociados);return{...de,products:at}},[ke,Ce.orders]),_e=g.useMemo(()=>{const de=be.reduce((at,st)=>at+Rr(st.remainingPackages),0),qe=ze.reduce((at,st)=>at+Rr(st.remainingPackages),0);return{masterRemainingPackages:Al(de),vendorRemainingPackages:Al(qe)}},[be,ze]),R=g.useMemo(()=>{const de=new Map,qe=st=>E==="DIA"?{key:st.date,label:st.date}:E==="VENDEDOR"?{key:st.vendorId||"",label:st.vendorName||""}:E==="PRODUCTO"?{key:st.productName||"",label:st.productName||""}:{key:st.branch||"",label:st.branch||""};for(const st of We){const{key:Nt,label:Rt}=qe(st);de.has(Nt)||de.set(Nt,{key:Nt,label:Rt,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0,rows:[]});const nr=de.get(Nt);nr.rows.push(st),st.type==="CREDITO"?(nr.packsCredit+=Rr(st.packages),nr.salesCredit+=Rr(st.amount),nr.commCredit+=Rr(st.commission)):(nr.packsCash+=Rr(st.packages),nr.salesCash+=Rr(st.amount),nr.commCash+=Rr(st.commission))}const at=Array.from(de.values()).map(st=>({...st,packsCash:Al(st.packsCash),packsCredit:Al(st.packsCredit),salesCash:zr(st.salesCash),salesCredit:zr(st.salesCredit),commCash:zr(st.commCash),commCredit:zr(st.commCredit)}));return E==="DIA"?at.sort((st,Nt)=>st.key<Nt.key?1:-1):at.sort((st,Nt)=>Nt.salesCash+Nt.salesCredit-(st.salesCash+st.salesCredit)),at},[We,E]),V=g.useMemo(()=>{if(!J)return[];const de=R.find(qe=>qe.key===J);return(de==null?void 0:de.rows)||[]},[J,R]),q=g.useMemo(()=>{const de={};for(const qe of V){const at=qe.productName||"(sin nombre)";de[at]||(de[at]={productName:at,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0}),qe.type==="CREDITO"?(de[at].packsCredit+=Rr(qe.packages),de[at].salesCredit+=Rr(qe.amount),de[at].commCredit+=Rr(qe.commission)):(de[at].packsCash+=Rr(qe.packages),de[at].salesCash+=Rr(qe.amount),de[at].commCash+=Rr(qe.commission))}return Object.values(de).map(qe=>({...qe,packsCash:Al(qe.packsCash),packsCredit:Al(qe.packsCredit),salesCash:zr(qe.salesCash),salesCredit:zr(qe.salesCredit),commCash:zr(qe.commCash),commCredit:zr(qe.commCredit)})).sort((qe,at)=>at.salesCash+at.salesCredit-(qe.salesCash+qe.salesCredit))},[V]),se=g.useMemo(()=>{const de={},qe=Rt=>(me[Rt]||"").trim()||Rt;for(const Rt of L){const nr=String(Rt.id||"").trim();nr&&(de[nr]={customerId:nr,name:qe(nr),balance:0,lastPayment:"",lastPaymentAmount:0,initialDebt:Rr(Rt.initialDebt),initialDebtDate:String(Rt.initialDebtDate||"").trim(),movements:[]})}for(const Rt of X){const nr=String(Rt.customerId||"").trim();if(!nr)continue;const _r=String(Rt.date||"");_r&&_r>l||(de[nr]||(de[nr]={customerId:nr,name:qe(nr),balance:0,lastPayment:"",lastPaymentAmount:0,initialDebt:0,initialDebtDate:"",movements:[]}),de[nr].movements.push(Rt))}const at=(Rt,nr,_r)=>{const $r=Number(Rt||0);if(!$r)return 0;const or=String(nr||"").trim();return or&&_r.some(en=>{var er;const rn=Number(en.amount||0);if(!(rn>0))return!1;const Er=Math.abs(rn-$r)<.01,Se=String(en.date||"").trim()===or,gt=!!((er=en.ref)!=null&&er.saleId);return Er&&Se&&gt})?0:$r},st=Object.values(de).map(Rt=>{const nr=Rt.movements.reduce((kr,en)=>kr+Rr(en.amount),0),_r=at(Rt.initialDebt,Rt.initialDebtDate,Rt.movements);let $r="",or=0;for(const kr of Rt.movements){const en=kr.type||(Rr(kr.amount)<0?"ABONO":"CARGO"),rn=String(kr.date||"");if(en==="ABONO"){const Er=Math.abs(Rr(kr.amount));(!$r||rn>$r)&&($r=rn,or=Er)}}return{customerId:Rt.customerId,name:Rt.name,balance:zr(_r+nr),lastPayment:$r,lastPaymentAmount:zr(or)}}).filter(Rt=>Rt.balance>0).sort((Rt,nr)=>nr.balance-Rt.balance),Nt=zr(st.reduce((Rt,nr)=>Rt+nr.balance,0));return{count:st.length,totalPending:Nt,list:st.slice(0,20)}},[X,me,L,l]),Ne=g.useMemo(()=>{if(!Ye)return[];const de=X.filter(at=>(at.customerId||"").trim()===Ye.customerId).filter(at=>!at.date||String(at.date)<=l).map(at=>({id:at.id,date:String(at.date||""),type:String(at.type||""),amount:zr(Rr(at.amount))})).sort((at,st)=>at.date<st.date?-1:at.date>st.date?1:0);let qe=0;return de.map(at=>{const st=at.type==="ABONO"?-at.amount:at.amount;return qe=zr(qe+st),{...at,running:qe}})},[Ye,X,l]),Me=g.useMemo(()=>Ye?le.filter(de=>(de.customerId||"").trim()===Ye.customerId).filter(de=>!de.date||String(de.date)<=l).sort((de,qe)=>de.date<qe.date?-1:de.date>qe.date?1:0):[],[Ye,le,l]),Ke=g.useMemo(()=>{const de=zr(ge.salesTotal),qe=zr(ge.commTotal),at=zr($t.total),st=zr(de-qe-at),Nt=new Set;for(const kr of We)kr.date&&Nt.add(kr.date);const Rt=Math.max(1,Nt.size),nr=zr(de/Rt),_r=zr(qe/Rt),$r=zr(at/Rt),or=zr(st/Rt);return{ingreso:de,comision:qe,gastos:at,gananciaNeta:st,daysCount:Rt,ingresoDia:nr,comisionDia:_r,gastosDia:$r,netaDia:or}},[ge,$t.total,We]),Pe=g.useMemo(()=>{const de={};for(const Nt of We){const Rt=Nt.date;Rt&&(de[Rt]||(de[Rt]={date:Rt,ingreso:0,comision:0}),de[Rt].ingreso+=Rr(Nt.amount),de[Rt].comision+=Rr(Nt.commission))}const qe=Object.keys(de).sort((Nt,Rt)=>Nt<Rt?-1:1),at=qe.map(Nt=>({label:Nt.slice(5),value:zr(de[Nt].ingreso)})),st=qe.map(Nt=>{var or,kr;const Rt=Rr((or=de[Nt])==null?void 0:or.ingreso),nr=Rr((kr=de[Nt])==null?void 0:kr.comision),_r=Rr($t.byDay[Nt]||0),$r=Rt-nr-_r;return{label:Nt.slice(5),value:zr($r)}});return{seriesIngreso:at,seriesNeta:st,datesCount:qe.length}},[We,$t.byDay]),rt=g.useMemo(()=>[{label:"Rivas",value:Rr(xt.RIVAS.sales)},{label:"San Jorge",value:Rr(xt.SAN_JORGE.sales)},{label:"Isla",value:Rr(xt.ISLA.sales)}].map(de=>({...de,value:zr(de.value)})),[xt]),lt=async()=>{if(Ct.current){Ct.current.classList.add("force-pdf-colors");try{const qe=(await Vm(Ct.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),at=new an;at.addImage(qe,"PNG",10,10,190,0),at.save(`data_center_dulces_${s}_a_${l}.pdf`)}finally{Ct.current.classList.remove("force-pdf-colors")}}},ht=()=>{const qe=[["date","processedDate","status","type","vendorId","vendorName","branch","productName","packages","amount","commission","customerId","customerName"].join(","),...We.map(Rt=>[Rt.date,Rt.processedDate||"",Rt.status,Rt.type,Rt.vendorId,`"${String(Rt.vendorName||"").replace(/"/g,'""')}"`,Rt.branch||"",`"${String(Rt.productName||"").replace(/"/g,'""')}"`,ii(Rt.packages),Qr(Rt.amount),Qr(Rt.commission),Rt.customerId||"",`"${String(ye(Rt)||"").replace(/"/g,'""')}"`].join(","))],at=new Blob([qe.join(`
`)],{type:"text/csv;charset=utf-8;"}),st=URL.createObjectURL(at),Nt=document.createElement("a");Nt.href=st,Nt.download=`data_center_dulces_${s}_a_${l}.csv`,Nt.click(),URL.revokeObjectURL(st)};return n?i.jsxs("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 md:px-0",children:[i.jsxs("div",{className:"bg-white p-3 sm:p-4 md:p-6 rounded-2xl shadow-2xl",children:[i.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between mb-4",children:[i.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold",children:"Data Center - Dulces"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center sm:justify-end",children:[i.jsx("button",{onClick:lt,className:`\r
                inline-flex items-center justify-center gap-2\r
                w-full sm:w-auto\r
                px-3 py-2 text-sm font-semibold\r
                rounded-lg md:rounded-md\r
                bg-green-600 text-white hover:bg-green-700 transition-colors\r
              `,children:"Exportar PDF"}),i.jsx("button",{onClick:ht,className:`\r
                inline-flex items-center justify-center gap-2\r
                w-full sm:w-auto\r
                px-3 py-2 text-sm font-semibold\r
                rounded-lg md:rounded-md\r
                bg-gray-800 text-white hover:bg-black transition-colors\r
              `,children:"Exportar CSV"})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-3",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Qe(de=>!de),"aria-expanded":Ft,children:[i.jsx("span",{children:"Filtros"}),i.jsx("span",{className:`transition-transform ${Ft?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${Ft?"block":"hidden"} border-t p-3 sm:p-4`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full text-sm",value:s,onChange:de=>o(de.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full text-sm",value:l,onChange:de=>c(de.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Estado"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:u,onChange:de=>d(de.target.value),children:[i.jsx("option",{value:"TODAS",children:"Todas"}),i.jsx("option",{value:"FLOTANTE",children:"Flotante"}),i.jsx("option",{value:"PROCESADA",children:"Procesada"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Tipo"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:f,onChange:de=>A(de.target.value),children:[i.jsx("option",{value:"AMBAS",children:"Ambas"}),i.jsx("option",{value:"CASH",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Vendedor"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:h,onChange:de=>m(de.target.value),children:[i.jsx("option",{value:"ALL",children:"Todos"}),ie.map(de=>i.jsx("option",{value:de.id,children:de.name||de.id},de.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Sucursal"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:p,onChange:de=>x(de.target.value),children:[i.jsx("option",{value:"ALL",children:"Todas"}),i.jsx("option",{value:"RIVAS",children:"Rivas"}),i.jsx("option",{value:"SAN_JORGE",children:"San Jorge"}),i.jsx("option",{value:"ISLA",children:"Isla"})]})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Producto (opcional)"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:v,onChange:de=>y(de.target.value),placeholder:"Ej: Conitos"})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Cliente (opcional)"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:b,onChange:de=>w(de.target.value),placeholder:"Ej: Javier"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Monto min"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:j,onChange:de=>I(de.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Monto max"}),i.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:C,onChange:de=>S(de.target.value),placeholder:"999999"})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block text-xs text-gray-600",children:"Agrupar por"}),i.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:E,onChange:de=>{Re(""),B(de.target.value)},children:[i.jsx("option",{value:"DIA",children:"Da"}),i.jsx("option",{value:"VENDEDOR",children:"Vendedor"}),i.jsx("option",{value:"PRODUCTO",children:"Producto"}),i.jsx("option",{value:"SUCURSAL",children:"Sucursal"})]})]})]})})]}),i.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between mb-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{Be(""),Qt("MACRO")},className:["px-3 py-2 rounded-full text-sm font-semibold border transition-colors",Tt==="MACRO"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"].join(" "),children:"Data Macro"}),i.jsx("button",{onClick:()=>{Be(""),Qt("DETALLE")},className:["px-3 py-2 rounded-full text-sm font-semibold border transition-colors",Tt==="DETALLE"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"].join(" "),children:"Data Detalle"})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Gastos del perodo (expenses_candies):"," ",i.jsxs("strong",{children:["C$",Qr($t.total)]})]})]}),i.jsxs("div",{ref:Ct,children:[Tt==="MACRO"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Je(de=>!de),"aria-expanded":De,children:[i.jsx("span",{children:"KPI"}),i.jsx("span",{className:`transition-transform ${De?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${De?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ingreso (ventas)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(Ke.ingreso)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin vendedor (ventas)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["-C$",Qr(Ke.comision)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Qr(ge.commCash),"  Crdito: C$",Qr(ge.commCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Gastos (expenses_candies)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["-C$",Qr(Ke.gastos)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se calcula automtico por fechas"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia neta (real)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(Ke.gananciaNeta)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Ingreso  Comisin  Gastos"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Promedio neto por da"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(Ke.netaDia)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Das con ventas: ",i.jsx("strong",{children:Ke.daysCount})]})]})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-3",children:[i.jsx(IG,{title:"Ventas por da (Ingreso)",series:Pe.seriesIngreso,valuePrefix:"C$"}),i.jsx(IG,{title:"Ganancia neta por da (real)",series:Pe.seriesNeta,valuePrefix:"C$"})]}),i.jsx("div",{className:"mb-6",children:i.jsx(_Ve,{title:"Distribucin de ventas por sucursal",items:rt})})]}),Tt==="DETALLE"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Je(de=>!de),"aria-expanded":De,children:[i.jsx("span",{children:"KPI"}),i.jsx("span",{className:`transition-transform ${De?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${De?"block":"hidden"} border-t p-3`,children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:ii(ge.packsCash)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:ii(ge.packsCredit)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(ge.salesTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Qr(ge.salesCash),"  Crdito: C$",Qr(ge.salesCredit)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(ge.commTotal)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",Qr(ge.commCash),"  Crdito: C$",Qr(ge.commCredit)]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta Aprox. (rdenes maestras)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(Ie.grossIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total esperado (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Qr(Ie.expectedIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Actual ventas (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Qr(xt.ISLA.sales)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Diferencia vs esperado (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold mt-2",children:["C$",Qr(Pt.ISLA)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Isla Ometepe"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado (precio proveedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(Le)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Sumatoria rdenes maestras (perodo)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad neta (rdenes vendedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(He.net)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"U bruta  Gastos  U vendedor"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (maestras)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:ii(Ut.orderedPacksMaster)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:ii(Ut.remainingPacksMaster)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:ii(_e.masterRemainingPackages)})]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (rdenes vendedor)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:ii(Ut.orderedPacksVendor)}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",i.jsx("strong",{children:ii(Ut.remainingPacksVendor)})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",i.jsx("strong",{children:ii(_e.vendorRemainingPackages)})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado a precio proveedor (rdenes vendedor)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(Ut.providerTotalVendor)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Productos dispersados (precio venta)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(pe.dispersedTotal)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Sumatoria rdenes de vendedores (perodo)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Dispersado Isla (precio venta)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(pe.dispersedIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Usado para Total existente"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total existente en productos (Isla)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(pe.totalExistenteIsla)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Esperado Isla  Dispersado Isla"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"CxC (ventas crdito)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(he.cxc)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(ge.commCredit)]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s,"  ",l]})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Recaudacin (abonos)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(he.recaudado)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"abonos en ar_movements"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta crdito (ventas  comisin)"}),i.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",Qr(he.utilidadBruta)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Paquetes vendidos al crdito"})]})]})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>ce(de=>!de),"aria-expanded":dt,children:[i.jsx("span",{children:"rdenes vendedores"}),i.jsx("span",{className:`transition-transform ${dt?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${dt?"block":"hidden"} border-t p-3 sm:p-4`,children:[i.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-4 shadow-sm bg-white border-gray-100",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsx("h3",{className:"font-semibold text-sm sm:text-base",children:"rdenes de vendedores (Global)"}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Basado en ",i.jsx("strong",{children:"precio de venta"})," (por sucursal del vendedor)"]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-sm",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total orden:"," ",i.jsxs("strong",{children:["C$",Qr(Ce.global.totalOrden)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Vendido:"," ",i.jsxs("strong",{children:["C$",Qr(Ce.global.vendido)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Restante:"," ",i.jsxs("strong",{children:["C$",Qr(Ce.global.restante)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Comisin:"," ",i.jsxs("strong",{children:["C$",Qr(Ce.global.comision)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total esperado:"," ",i.jsxs("strong",{children:["C$",Qr(Ce.global.totalEsperado)]})]})]})]}),i.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-6 shadow-sm bg-white border-gray-100",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3",children:[i.jsx("h3",{className:"font-semibold text-sm sm:text-base",children:"rdenes de vendedores (Detalle por orden)"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Click/Tap en una orden para ver productos asociados/vendidos/restantes"})]}),Ce.orders.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2",children:Ce.orders.map(de=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"font-semibold truncate",children:de.orderId}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1 truncate",children:[de.sellerName," ",de.branch?` ${de.branch}`:""," ",de.date?` ${de.date}`:""]})]}),i.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-800 text-white text-sm font-semibold",onClick:()=>Be(de.orderKey),children:"Ver"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(de.totalOrden)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendido"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(de.vendido)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restante"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(de.restante)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(de.comision)]})]})]})]},de.orderKey))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Total orden"}),i.jsx("th",{className:"border p-2",children:"Vendido"}),i.jsx("th",{className:"border p-2",children:"Restante"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Total esperado"}),i.jsx("th",{className:"border p-2",children:"Accin"})]})}),i.jsx("tbody",{children:Ce.orders.map(de=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:de.sellerName}),i.jsx("td",{className:"border p-2",children:de.branch||""}),i.jsx("td",{className:"border p-2",children:de.date||""}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.totalOrden)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.vendido)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.restante)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.comision)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.totalEsperado)]}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-3 py-2 rounded-lg hover:bg-black",onClick:()=>Be(de.orderKey),children:"Ver detalle"})})]},de.orderKey))})]})}),ee&&i.jsxs("div",{className:"mt-4 rounded-2xl border-2 border-gray-100 p-3 sm:p-4 shadow-lg bg-white",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-3",children:[i.jsxs("h4",{className:"text-base sm:text-xl font-semibold truncate",children:["Detalle orden vendedor "," ",ee.orderId]}),i.jsx("button",{onClick:()=>Be(""),className:"w-full sm:w-auto text-sm px-3 py-2 border rounded-lg hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-sm mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total orden:"," ",i.jsxs("strong",{children:["C$",Qr(ee.totalOrden)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Vendido:"," ",i.jsxs("strong",{children:["C$",Qr(ee.vendido)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Restante:"," ",i.jsxs("strong",{children:["C$",Qr(ee.restante)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Comisin:"," ",i.jsxs("strong",{children:["C$",Qr(ee.comision)]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total esperado:"," ",i.jsxs("strong",{children:["C$",Qr(ee.totalEsperado)]})]})]}),i.jsx("h5",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Productos asociados (Nombre - Asociados - Vendidos - Restantes)"}),i.jsx("div",{className:"md:hidden space-y-2",children:ee.products.map(de=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"font-semibold",children:de.productName}),i.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Asociados"}),i.jsx("div",{className:"font-bold",children:de.asociados})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendidos"}),i.jsx("div",{className:"font-bold",children:de.vendidos})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Restantes"}),i.jsx("div",{className:"font-bold",children:de.restantes})]})]})]},de.productName))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Nombre producto"}),i.jsx("th",{className:"border p-2",children:"Asociados"}),i.jsx("th",{className:"border p-2",children:"Vendidos"}),i.jsx("th",{className:"border p-2",children:"Restantes"})]})}),i.jsxs("tbody",{children:[ee.products.map(de=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:de.productName}),i.jsx("td",{className:"border p-2",children:de.asociados}),i.jsx("td",{className:"border p-2",children:de.vendidos}),i.jsx("td",{className:"border p-2",children:de.restantes})]},de.productName)),ee.products.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"p-4 text-center text-gray-500",children:"Sin productos."})})]})]})})]})]})]})]})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>ue(de=>!de),"aria-expanded":we,children:[i.jsx("span",{children:"Existencias"}),i.jsx("span",{className:`transition-transform ${we?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${we?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencia global (maestras)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:ii(_e.masterRemainingPackages)}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"remainingPackages (todas)"})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Existencia global (vendedores)"}),i.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:ii(_e.vendorRemainingPackages)}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"remainingPackages (todas)"})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ve(de=>!de),"aria-expanded":ne,children:[i.jsx("span",{children:"Vendedores"}),i.jsx("span",{className:`transition-transform ${ne?"rotate-180":""}`,children:""})]}),i.jsx("div",{className:`collapsible-content ${ne?"block":"hidden"} border-t p-3`,children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),It.cashArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:It.cashArr.map(de=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:de.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Qr(de.total)]})]},de.vendorId))})]}),i.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),It.creditArr.length===0?i.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):i.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:It.creditArr.map(de=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"truncate",children:de.name}),i.jsxs("strong",{className:"ml-2",children:["C$",Qr(de.total)]})]},de.vendorId))})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm mb-6",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>vt(de=>!de),"aria-expanded":it,children:[i.jsx("span",{children:"Saldos pendientes"}),i.jsx("span",{className:`transition-transform ${it?"rotate-180":""}`,children:""})]}),i.jsxs("div",{className:`collapsible-content ${it?"block":"hidden"} border-t p-3 sm:p-4`,children:[i.jsxs("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:["Saldos pendientes (hasta ",l,")"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 text-sm mb-3",children:[i.jsxs("div",{children:["Clientes con saldo: ",i.jsx("strong",{children:se.count})]}),i.jsxs("div",{children:["Saldo total pendiente:"," ",i.jsxs("strong",{children:["C$",Qr(se.totalPending)]})]}),i.jsx("div",{className:"text-gray-500",children:"*Muestra top 20 por monto"})]}),se.list.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:""}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2",children:se.list.map(de=>i.jsxs("div",{className:"border rounded-xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:de.name}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Qr(de.balance)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["ltimo abono:"," ",i.jsxs("b",{children:["C$",Qr(de.lastPaymentAmount)]})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Fecha ult. abono:"," ",i.jsx("span",{className:"font-medium",children:de.lastPayment||""})]}),i.jsx("div",{className:"mt-2",children:i.jsx("button",{type:"button",onClick:()=>ot(de),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},de.customerId))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:"Cliente"}),i.jsx("th",{className:"border p-2",children:"Saldo pendiente"}),i.jsx("th",{className:"border p-2",children:"ltimo abono"}),i.jsx("th",{className:"border p-2",children:"Fecha ult. abono"}),i.jsx("th",{className:"border p-2",children:"Ver"})]})}),i.jsx("tbody",{children:se.list.map(de=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:de.name}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.balance)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.lastPaymentAmount)]}),i.jsx("td",{className:"border p-2",children:de.lastPayment||""}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{type:"button",onClick:()=>ot(de),className:"px-3 py-1 rounded bg-indigo-600 text-white text-xs hover:bg-indigo-700",children:"Ver"})})]},de.customerId))})]})})]})]})]}),i.jsxs("div",{className:"mb-3 flex flex-col sm:flex-row sm:items-center gap-2",children:[i.jsxs("h3",{className:"font-semibold text-sm sm:text-base",children:["Tabla principal (Agrupar por: ",E,")"]}),i.jsx("span",{className:"text-xs text-gray-500 sm:ml-auto",children:"Tap/Click en Ver detalle para drill-down"})]}),k?i.jsx("p",{className:"text-sm",children:"Cargando..."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"md:hidden space-y-2 mb-6",children:R.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."}):R.map(de=>i.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:de.label}),i.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-800 text-white text-sm font-semibold",onClick:()=>Re(de.key),children:"Ver detalle"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),i.jsx("div",{className:"font-bold",children:ii(de.packsCash)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),i.jsx("div",{className:"font-bold",children:ii(de.packsCredit)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(de.salesCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(de.salesCredit)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(de.commCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(de.commCredit)]})]})]})]},de.key))}),i.jsx("div",{className:"hidden md:block overflow-x-auto mb-6 shadow-2xl rounded-xl border",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2 text-left",children:E==="DIA"?"Da":E==="VENDEDOR"?"Vendedor":E==="PRODUCTO"?"Producto":"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"}),i.jsx("th",{className:"border p-2",children:"Opciones"})]})}),i.jsxs("tbody",{children:[R.map(de=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:de.label}),i.jsx("td",{className:"border p-2",children:ii(de.packsCash)}),i.jsx("td",{className:"border p-2",children:ii(de.packsCredit)}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.salesCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.salesCredit)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.commCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.commCredit)]}),i.jsx("td",{className:"border p-2",children:i.jsx("button",{className:"text-xs bg-gray-800 text-white px-3 py-2 rounded-lg hover:bg-black",onClick:()=>Re(de.key),children:"Ver detalle"})})]},de.key)),R.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."})})]})]})})]}),J&&i.jsxs("div",{className:"rounded-2xl shadow-lg p-3 sm:p-4 bg-white border-solid border-2 border-gray-100",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-3",children:[i.jsxs("h2",{className:"text-base sm:text-xl font-semibold truncate",children:["Detalle "," ",((kt=R.find(de=>de.key===J))==null?void 0:kt.label)||J]}),i.jsx("button",{onClick:()=>Re(""),className:"w-full sm:w-auto text-sm px-3 py-2 border rounded-lg hover:bg-gray-50",children:"Cerrar"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 text-sm mb-4",children:[i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total Ventas cash:"," ",i.jsxs("strong",{children:["C$",Qr(V.filter(de=>de.type==="CONTADO").reduce((de,qe)=>de+Rr(qe.amount),0))]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total Ventas crdito:"," ",i.jsxs("strong",{children:["C$",Qr(V.filter(de=>de.type==="CREDITO").reduce((de,qe)=>de+Rr(qe.amount),0))]})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total paquetes cash:"," ",i.jsx("strong",{children:ii(V.filter(de=>de.type==="CONTADO").reduce((de,qe)=>de+Rr(qe.packages),0))})]}),i.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total paquetes crdito:"," ",i.jsx("strong",{children:ii(V.filter(de=>de.type==="CREDITO").reduce((de,qe)=>de+Rr(qe.packages),0))})]})]}),i.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Ventas incluidas"}),i.jsx("div",{className:"md:hidden space-y-2 mb-4",children:V.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin detalle."}):V.map(de=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:de.productName}),i.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",Qr(de.amount)]})]}),i.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Vendedor:"," ",i.jsx("span",{className:"font-medium",children:de.vendorName})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Tipo"}),i.jsx("div",{className:"font-bold",children:de.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Sucursal"}),i.jsx("div",{className:"font-bold",children:de.branch||""})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),i.jsx("div",{className:"font-bold",children:ii(de.packages)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(de.commission)]})]})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Fecha: ",de.date]})]},de.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto mb-4",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Sucursal"}),i.jsx("th",{className:"border p-2",children:"Paquetes"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Comisin"}),i.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),i.jsxs("tbody",{children:[V.map(de=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2",children:de.vendorName}),i.jsx("td",{className:"border p-2",children:de.productName}),i.jsx("td",{className:"border p-2",children:de.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"border p-2",children:de.branch||""}),i.jsx("td",{className:"border p-2",children:ii(de.packages)}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.amount)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.commission)]}),i.jsx("td",{className:"border p-2",children:de.date})]},de.id)),V.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sin detalle."})})]})]})}),i.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Consolidado por producto"}),i.jsx("div",{className:"md:hidden space-y-2",children:q.length===0?i.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin consolidado."}):q.map(de=>i.jsxs("div",{className:"border rounded-2xl p-3",children:[i.jsx("div",{className:"font-semibold",children:de.productName}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paq cash"}),i.jsx("div",{className:"font-bold",children:ii(de.packsCash)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Paq crdito"}),i.jsx("div",{className:"font-bold",children:ii(de.packsCredit)})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(de.salesCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(de.salesCredit)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Com cash"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(de.commCash)]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Com crdito"}),i.jsxs("div",{className:"font-bold",children:["C$",Qr(de.commCredit)]})]})]})]},de.productName))}),i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),i.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),i.jsx("th",{className:"border p-2",children:"Ventas cash"}),i.jsx("th",{className:"border p-2",children:"Ventas crdito"}),i.jsx("th",{className:"border p-2",children:"Comisin cash"}),i.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),i.jsxs("tbody",{children:[q.map(de=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-2 text-left",children:de.productName}),i.jsx("td",{className:"border p-2",children:ii(de.packsCash)}),i.jsx("td",{className:"border p-2",children:ii(de.packsCredit)}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.salesCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.salesCredit)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.commCash)]}),i.jsxs("td",{className:"border p-2",children:["C$",Qr(de.commCredit)]})]},de.productName)),q.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:7,className:"p-4 text-center text-gray-500",children:"Sin consolidado."})})]})]})})]})]})]}),P&&i.jsx("p",{className:"mt-3 text-sm",children:P})]}),Ye&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-lg",children:Ye.name}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Saldo pendiente: ",i.jsxs("b",{children:["C$",Qr(Ye.balance)]})]})]}),i.jsx("button",{type:"button",onClick:()=>ot(null),className:"text-sm text-gray-500 hover:text-gray-700",children:""})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Monto"}),i.jsx("th",{className:"border p-2",children:"Saldo"})]})}),i.jsx("tbody",{children:Ne.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"border p-2 text-center text-gray-500",children:"Sin movimientos."})}):Ne.map(de=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:de.date||""}),i.jsx("td",{className:"border p-1",children:de.type||""}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(de.amount)]}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(de.running)]})]},de.id))})]})}),i.jsx("div",{className:"mt-4 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full border text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border p-2",children:"Fecha"}),i.jsx("th",{className:"border p-2",children:"Producto"}),i.jsx("th",{className:"border p-2",children:"Vendedor"}),i.jsx("th",{className:"border p-2",children:"Tipo"}),i.jsx("th",{className:"border p-2",children:"Monto"})]})}),i.jsx("tbody",{children:Me.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"border p-2 text-center text-gray-500",children:"Sin ventas asociadas."})}):Me.map(de=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"border p-1",children:de.date||""}),i.jsx("td",{className:"border p-1",children:de.productName||""}),i.jsx("td",{className:"border p-1",children:de.vendorName||""}),i.jsx("td",{className:"border p-1",children:de.type||""}),i.jsxs("td",{className:"border p-1",children:["C$",Qr(de.amount)]})]},de.id))})]})})]})})]}):i.jsxs("div",{className:"max-w-5xl mx-auto p-3 sm:p-4 md:p-6 bg-white rounded-2xl shadow-2xl",children:[i.jsx("h2",{className:"text-lg md:text-xl font-bold",children:"Data Center - Dulces"}),i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"No autorizado."})]})}function $se(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(r=$se(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function as(){for(var t,e,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(e=$se(t))&&(n&&(n+=" "),n+=e);return n}var IVe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function GR(t){if(typeof t!="string")return!1;var e=IVe;return e.includes(t)}var jVe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],PVe=new Set(jVe);function Gse(t){return typeof t!="string"?!1:PVe.has(t)}function Kse(t){return typeof t=="string"&&t.startsWith("data-")}function uh(t){if(typeof t!="object"||t===null)return{};var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Gse(r)||Kse(r))&&(e[r]=t[r]);return e}function X2(t){if(t==null)return null;if(g.isValidElement(t)&&typeof t.props=="object"&&t.props!==null){var e=t.props;return uh(e)}return typeof t=="object"&&!Array.isArray(t)?uh(t):null}function Rd(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Gse(r)||Kse(r)||GR(r))&&(e[r]=t[r]);return e}var TVe=["children","width","height","viewBox","className","style","title","desc"];function _F(){return _F=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_F.apply(null,arguments)}function BVe(t,e){if(t==null)return{};var r,n,a=kVe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function kVe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var KR=g.forwardRef((t,e)=>{var{children:r,width:n,height:a,viewBox:s,className:o,style:l,title:c,desc:u}=t,d=BVe(t,TVe),f=s||{width:n,height:a,x:0,y:0},A=as("recharts-surface",o);return g.createElement("svg",_F({},Rd(d),{className:A,width:n,height:a,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:e}),g.createElement("title",null,c),g.createElement("desc",null,u),r)}),FVe=["children","className"];function EF(){return EF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},EF.apply(null,arguments)}function OVe(t,e){if(t==null)return{};var r,n,a=DVe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function DVe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var kc=g.forwardRef((t,e)=>{var{children:r,className:n}=t,a=OVe(t,FVe),s=as("recharts-layer",n);return g.createElement("g",EF({className:s},Rd(a),{ref:e}),r)}),qse=g.createContext(null),RVe=()=>g.useContext(qse);function vs(t){return function(){return t}}const zse=Math.cos,lI=Math.sin,Tf=Math.sqrt,cI=Math.PI,wP=2*cI,SF=Math.PI,IF=2*SF,mp=1e-6,MVe=IF-mp;function Wse(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function LVe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Wse;const r=10**e;return function(n){this._+=n[0];for(let a=1,s=n.length;a<s;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class UVe{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Wse:LVe(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,a){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(e,r,n,a,s,o){this._append`C${+e},${+r},${+n},${+a},${this._x1=+s},${this._y1=+o}`}arcTo(e,r,n,a,s){if(e=+e,r=+r,n=+n,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,c=n-e,u=a-r,d=o-e,f=l-r,A=d*d+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(A>mp)if(!(Math.abs(f*c-u*d)>mp)||!s)this._append`L${this._x1=e},${this._y1=r}`;else{let h=n-o,m=a-l,p=c*c+u*u,x=h*h+m*m,v=Math.sqrt(p),y=Math.sqrt(A),b=s*Math.tan((SF-Math.acos((p+A-x)/(2*v*y)))/2),w=b/y,j=b/v;Math.abs(w-1)>mp&&this._append`L${e+w*d},${r+w*f}`,this._append`A${s},${s},0,0,${+(f*h>d*m)},${this._x1=e+j*c},${this._y1=r+j*u}`}}arc(e,r,n,a,s,o){if(e=+e,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),u=e+l,d=r+c,f=1^o,A=o?a-s:s-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>mp||Math.abs(this._y1-d)>mp)&&this._append`L${u},${d}`,n&&(A<0&&(A=A%IF+IF),A>MVe?this._append`A${n},${n},0,1,${f},${e-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:A>mp&&this._append`A${n},${n},0,${+(A>=SF)},${f},${this._x1=e+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(e,r,n,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function qR(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new UVe(e)}function zR(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Xse(t){this._context=t}Xse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function NP(t){return new Xse(t)}function Yse(t){return t[0]}function Jse(t){return t[1]}function Zse(t,e){var r=vs(!0),n=null,a=NP,s=null,o=qR(l);t=typeof t=="function"?t:t===void 0?Yse:vs(t),e=typeof e=="function"?e:e===void 0?Jse:vs(e);function l(c){var u,d=(c=zR(c)).length,f,A=!1,h;for(n==null&&(s=a(h=o())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===A&&((A=!A)?s.lineStart():s.lineEnd()),A&&s.point(+t(f,u,c),+e(f,u,c));if(h)return s=null,h+""||null}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:vs(+c),l):t},l.y=function(c){return arguments.length?(e=typeof c=="function"?c:vs(+c),l):e},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:vs(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(s=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=s=null:s=a(n=c),l):n},l}function p_(t,e,r){var n=null,a=vs(!0),s=null,o=NP,l=null,c=qR(u);t=typeof t=="function"?t:t===void 0?Yse:vs(+t),e=typeof e=="function"?e:vs(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?Jse:vs(+r);function u(f){var A,h,m,p=(f=zR(f)).length,x,v=!1,y,b=new Array(p),w=new Array(p);for(s==null&&(l=o(y=c())),A=0;A<=p;++A){if(!(A<p&&a(x=f[A],A,f))===v)if(v=!v)h=A,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=A-1;m>=h;--m)l.point(b[m],w[m]);l.lineEnd(),l.areaEnd()}v&&(b[A]=+t(x,A,f),w[A]=+e(x,A,f),l.point(n?+n(x,A,f):b[A],r?+r(x,A,f):w[A]))}if(y)return l=null,y+""||null}function d(){return Zse().defined(a).curve(o).context(s)}return u.x=function(f){return arguments.length?(t=typeof f=="function"?f:vs(+f),n=null,u):t},u.x0=function(f){return arguments.length?(t=typeof f=="function"?f:vs(+f),u):t},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:vs(+f),u):n},u.y=function(f){return arguments.length?(e=typeof f=="function"?f:vs(+f),r=null,u):e},u.y0=function(f){return arguments.length?(e=typeof f=="function"?f:vs(+f),u):e},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:vs(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(t).y(e)},u.lineY1=function(){return d().x(t).y(r)},u.lineX1=function(){return d().x(n).y(e)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:vs(!!f),u):a},u.curve=function(f){return arguments.length?(o=f,s!=null&&(l=o(s)),u):o},u.context=function(f){return arguments.length?(f==null?s=l=null:l=o(s=f),u):s},u}class eie{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function QVe(t){return new eie(t,!0)}function VVe(t){return new eie(t,!1)}const WR={draw(t,e){const r=Tf(e/cI);t.moveTo(r,0),t.arc(0,0,r,0,wP)}},HVe={draw(t,e){const r=Tf(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},tie=Tf(1/3),$Ve=tie*2,GVe={draw(t,e){const r=Tf(e/$Ve),n=r*tie;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},KVe={draw(t,e){const r=Tf(e),n=-r/2;t.rect(n,n,r,r)}},qVe=.8908130915292852,rie=lI(cI/10)/lI(7*cI/10),zVe=lI(wP/10)*rie,WVe=-zse(wP/10)*rie,XVe={draw(t,e){const r=Tf(e*qVe),n=zVe*r,a=WVe*r;t.moveTo(0,-r),t.lineTo(n,a);for(let s=1;s<5;++s){const o=wP*s/5,l=zse(o),c=lI(o);t.lineTo(c*r,-l*r),t.lineTo(l*n-c*a,c*n+l*a)}t.closePath()}},hT=Tf(3),YVe={draw(t,e){const r=-Tf(e/(hT*3));t.moveTo(0,r*2),t.lineTo(-hT*r,-r),t.lineTo(hT*r,-r),t.closePath()}},od=-.5,ld=Tf(3)/2,jF=1/Tf(12),JVe=(jF/2+1)*3,ZVe={draw(t,e){const r=Tf(e/JVe),n=r/2,a=r*jF,s=n,o=r*jF+r,l=-s,c=o;t.moveTo(n,a),t.lineTo(s,o),t.lineTo(l,c),t.lineTo(od*n-ld*a,ld*n+od*a),t.lineTo(od*s-ld*o,ld*s+od*o),t.lineTo(od*l-ld*c,ld*l+od*c),t.lineTo(od*n+ld*a,od*a-ld*n),t.lineTo(od*s+ld*o,od*o-ld*s),t.lineTo(od*l+ld*c,od*c-ld*l),t.closePath()}};function eHe(t,e){let r=null,n=qR(a);t=typeof t=="function"?t:vs(t||WR),e=typeof e=="function"?e:vs(e===void 0?64:+e);function a(){let s;if(r||(r=s=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),s)return r=null,s+""||null}return a.type=function(s){return arguments.length?(t=typeof s=="function"?s:vs(s),a):t},a.size=function(s){return arguments.length?(e=typeof s=="function"?s:vs(+s),a):e},a.context=function(s){return arguments.length?(r=s??null,a):r},a}function uI(){}function dI(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function nie(t){this._context=t}nie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:dI(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:dI(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function tHe(t){return new nie(t)}function aie(t){this._context=t}aie.prototype={areaStart:uI,areaEnd:uI,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:dI(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function rHe(t){return new aie(t)}function sie(t){this._context=t}sie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:dI(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function nHe(t){return new sie(t)}function iie(t){this._context=t}iie.prototype={areaStart:uI,areaEnd:uI,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function aHe(t){return new iie(t)}function jG(t){return t<0?-1:1}function PG(t,e,r){var n=t._x1-t._x0,a=e-t._x1,s=(t._y1-t._y0)/(n||a<0&&-0),o=(r-t._y1)/(a||n<0&&-0),l=(s*a+o*n)/(n+a);return(jG(s)+jG(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function TG(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function AT(t,e,r){var n=t._x0,a=t._y0,s=t._x1,o=t._y1,l=(s-n)/3;t._context.bezierCurveTo(n+l,a+l*e,s-l,o-l*r,s,o)}function fI(t){this._context=t}fI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:AT(this,this._t0,TG(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,AT(this,TG(this,r=PG(this,t,e)),r);break;default:AT(this,this._t0,r=PG(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function oie(t){this._context=new lie(t)}(oie.prototype=Object.create(fI.prototype)).point=function(t,e){fI.prototype.point.call(this,e,t)};function lie(t){this._context=t}lie.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,a,s){this._context.bezierCurveTo(e,t,n,r,s,a)}};function sHe(t){return new fI(t)}function iHe(t){return new oie(t)}function cie(t){this._context=t}cie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=BG(t),a=BG(e),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(n[0][s],a[0][s],n[1][s],a[1][s],t[o],e[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function BG(t){var e,r=t.length-1,n,a=new Array(r),s=new Array(r),o=new Array(r);for(a[0]=0,s[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)a[e]=1,s[e]=4,o[e]=4*t[e]+2*t[e+1];for(a[r-1]=2,s[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=a[e]/s[e-1],s[e]-=n,o[e]-=n*o[e-1];for(a[r-1]=o[r-1]/s[r-1],e=r-2;e>=0;--e)a[e]=(o[e]-a[e+1])/s[e];for(s[r-1]=(t[r]+a[r-1])/2,e=0;e<r-1;++e)s[e]=2*t[e+1]-a[e+1];return[a,s]}function oHe(t){return new cie(t)}function CP(t,e){this._context=t,this._t=e}CP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function lHe(t){return new CP(t,.5)}function cHe(t){return new CP(t,0)}function uHe(t){return new CP(t,1)}function wg(t,e){if((o=t.length)>1)for(var r=1,n,a,s=t[e[0]],o,l=s.length;r<o;++r)for(a=s,s=t[e[r]],n=0;n<l;++n)s[n][1]+=s[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function PF(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function dHe(t,e){return t[e]}function fHe(t){const e=[];return e.key=t,e}function hHe(){var t=vs([]),e=PF,r=wg,n=dHe;function a(s){var o=Array.from(t.apply(this,arguments),fHe),l,c=o.length,u=-1,d;for(const f of s)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(f,o[l].key,u,s)]).data=f;for(l=0,d=zR(e(o));l<c;++l)o[d[l]].index=l;return r(o,d),o}return a.keys=function(s){return arguments.length?(t=typeof s=="function"?s:vs(Array.from(s)),a):t},a.value=function(s){return arguments.length?(n=typeof s=="function"?s:vs(+s),a):n},a.order=function(s){return arguments.length?(e=s==null?PF:typeof s=="function"?s:vs(Array.from(s)),a):e},a.offset=function(s){return arguments.length?(r=s??wg,a):r},a}function AHe(t,e){if((n=t.length)>0){for(var r,n,a=0,s=t[0].length,o;a<s;++a){for(o=r=0;r<n;++r)o+=t[r][a][1]||0;if(o)for(r=0;r<n;++r)t[r][a][1]/=o}wg(t,e)}}function mHe(t,e){if((a=t.length)>0){for(var r=0,n=t[e[0]],a,s=n.length;r<s;++r){for(var o=0,l=0;o<a;++o)l+=t[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}wg(t,e)}}function pHe(t,e){if(!(!((o=t.length)>0)||!((s=(a=t[e[0]]).length)>0))){for(var r=0,n=1,a,s,o;n<s;++n){for(var l=0,c=0,u=0;l<o;++l){for(var d=t[e[l]],f=d[n][1]||0,A=d[n-1][1]||0,h=(f-A)/2,m=0;m<l;++m){var p=t[e[m]],x=p[n][1]||0,v=p[n-1][1]||0;h+=x-v}c+=f,u+=h*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,wg(t,e)}}var _P={},uie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(uie);var XR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(XR);var EP={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}t.toKey=e})(EP);var SP={},die={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(e).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}t.toString=e})(die);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=die,r=EP;function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=e.toString(a);const s=[],o=a.length;if(o===0)return s;let l=0,c="",u="",d=!1;for(a.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const f=a[l];u?f==="\\"&&l+1<o?(l++,c+=a[l]):f===u?u="":c+=f:d?f==='"'||f==="'"?u=f:f==="]"?(d=!1,s.push(c),c=""):c+=f:f==="["?(d=!0,c&&(s.push(c),c="")):f==="."?c&&(s.push(c),c=""):c+=f,l++}return c&&s.push(c),s}t.toPath=n})(SP);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=uie,r=XR,n=EP,a=SP;function s(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(e.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?r.isDeepKey(c)?s(l,a.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),e.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function o(l,c,u){if(c.length===0)return u;let d=l;for(let f=0;f<c.length;f++){if(d==null||e.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}t.get=s})(_P);var gHe=_P.get;const Ng=PA(gHe);var xHe=4;function Z0(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xHe,r=10**e,n=Math.round(t*r)/r;return Object.is(n,-0)?0:n}function _i(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t.reduce((a,s,o)=>{var l=r[o-1];return typeof l=="string"?a+l+s:l!==void 0?a+Z0(l)+s:a+s},"")}var Tl=t=>t===0?0:t>0?1:-1,dh=t=>typeof t=="number"&&t!=+t,NA=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,_n=t=>(typeof t=="number"||t instanceof Number)&&!dh(t),fh=t=>_n(t)||typeof t=="string",vHe=0,Y2=t=>{var e=++vHe;return"".concat(t||"").concat(e)},oc=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!_n(e)&&typeof e!="string")return n;var s;if(NA(e)){if(r==null)return n;var o=e.indexOf("%");s=r*parseFloat(e.slice(0,o))/100}else s=+e;return dh(s)&&(s=n),a&&r!=null&&s>r&&(s=r),s},fie=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[String(t[n])])r[String(t[n])]=!0;else return!0;return!1};function So(t,e,r){return _n(t)&&_n(e)?Z0(t+r*(e-t)):e}function yHe(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):Ng(n,e))===r)}var il=t=>t===null||typeof t>"u",Ww=t=>il(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));function bHe(t){return t!=null}function Xw(){}var wHe=["type","size","sizeType"];function TF(){return TF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},TF.apply(null,arguments)}function kG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function FG(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kG(Object(r),!0).forEach(function(n){NHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function NHe(t,e,r){return(e=CHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CHe(t){var e=_He(t,"string");return typeof e=="symbol"?e:e+""}function _He(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EHe(t,e){if(t==null)return{};var r,n,a=SHe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function SHe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var hie={symbolCircle:WR,symbolCross:HVe,symbolDiamond:GVe,symbolSquare:KVe,symbolStar:XVe,symbolTriangle:YVe,symbolWye:ZVe},IHe=Math.PI/180,jHe=t=>{var e="symbol".concat(Ww(t));return hie[e]||WR},PHe=(t,e,r)=>{if(e==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var n=18*IHe;return 1.25*t*t*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},THe=(t,e)=>{hie["symbol".concat(Ww(t))]=e},YR=t=>{var{type:e="circle",size:r=64,sizeType:n="area"}=t,a=EHe(t,wHe),s=FG(FG({},a),{},{type:e,size:r,sizeType:n}),o="circle";typeof e=="string"&&(o=e);var l=()=>{var A=jHe(o),h=eHe().type(A).size(PHe(r,n,o)),m=h();if(m!==null)return m},{className:c,cx:u,cy:d}=s,f=Rd(s);return _n(u)&&_n(d)&&_n(r)?g.createElement("path",TF({},f,{className:as("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:l()})):null};YR.registerSymbol=THe;var Aie=t=>"radius"in t&&"startAngle"in t&&"endAngle"in t,BHe=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(g.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{GR(a)&&(n[a]=s=>r[a](r,s))}),n},kHe=(t,e,r)=>n=>(t(e,r,n),null),Yw=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(a=>{var s=t[a];GR(a)&&typeof s=="function"&&(n||(n={}),n[a]=kHe(s,e,r))}),n};function OG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function FHe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?OG(Object(r),!0).forEach(function(n){OHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):OG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function OHe(t,e,r){return(e=DHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DHe(t){var e=RHe(t,"string");return typeof e=="symbol"?e:e+""}function RHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fl(t,e){var r=FHe({},t),n=e,a=Object.keys(e),s=a.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return s}function hI(){return hI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},hI.apply(null,arguments)}function DG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function MHe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?DG(Object(r),!0).forEach(function(n){LHe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):DG(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function LHe(t,e,r){return(e=UHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UHe(t){var e=QHe(t,"string");return typeof e=="symbol"?e:e+""}function QHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var md=32,VHe={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function HHe(t){var{data:e,iconType:r,inactiveColor:n}=t,a=md/2,s=md/6,o=md/3,l=e.inactive?n:e.color,c=r??e.type;if(c==="none")return null;if(c==="plainline"){var u;return g.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=e.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:a,x2:md,y2:a,className:"recharts-legend-icon"})}if(c==="line")return g.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(md,"M").concat(2*o,",").concat(a,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return g.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(md/8,"h").concat(md,"v").concat(md*3/4,"h").concat(-md,"z"),className:"recharts-legend-icon"});if(g.isValidElement(e.legendIcon)){var d=MHe({},e);return delete d.legendIcon,g.cloneElement(e.legendIcon,d)}return g.createElement(YR,{fill:l,cx:a,cy:a,size:md,sizeType:"diameter",type:c})}function $He(t){var{payload:e,iconSize:r,layout:n,formatter:a,inactiveColor:s,iconType:o}=t,l={x:0,y:0,width:md,height:md},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((d,f)=>{var A=d.formatter||a,h=as({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var m=d.inactive?s:d.color,p=A?A(d.value,d,f):d.value;return g.createElement("li",hI({className:h,style:c,key:"legend-item-".concat(f)},Yw(t,d,f)),g.createElement(KR,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(p," legend icon")},g.createElement(HHe,{data:d,iconType:o,inactiveColor:s})),g.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},p))})}var GHe=t=>{var e=Fl(t,VHe),{payload:r,layout:n,align:a}=e;if(!r||!r.length)return null;var s={padding:0,margin:0,textAlign:n==="horizontal"?a:"left"};return g.createElement("ul",{className:"recharts-default-legend",style:s},g.createElement($He,hI({},e,{payload:r})))},mie={},pie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const a=new Map;for(let s=0;s<r.length;s++){const o=r[s],l=n(o);a.has(l)||a.set(l,o)}return Array.from(a.values())}t.uniqBy=e})(pie);var JR={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(JR);var gie={},IP={},xie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(xie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=xie;function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(IP);var vie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(vie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=IP,r=vie;function n(a){return r.isObjectLike(a)&&e.isArrayLike(a)}t.isArrayLikeObject=n})(gie);var yie={},bie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_P;function r(n){return function(a){return e.get(a,n)}}t.property=r})(bie);var wie={},ZR={},Nie={},eM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(eM);var tM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(tM);var rM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(rM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=eM,r=tM,n=rM;function a(d,f,A){return typeof A!="function"?a(d,f,()=>{}):s(d,f,function h(m,p,x,v,y,b){const w=A(m,p,x,v,y,b);return w!==void 0?!!w:s(m,p,h,b)},new Map)}function s(d,f,A,h){if(f===d)return!0;switch(typeof f){case"object":return o(d,f,A,h);case"function":return Object.keys(f).length>0?s(d,{...f},A,h):n.eq(d,f);default:return e.isObject(d)?typeof f=="string"?f==="":!0:n.eq(d,f)}}function o(d,f,A,h){if(f==null)return!0;if(Array.isArray(f))return c(d,f,A,h);if(f instanceof Map)return l(d,f,A,h);if(f instanceof Set)return u(d,f,A,h);const m=Object.keys(f);if(d==null||r.isPrimitive(d))return m.length===0;if(m.length===0)return!0;if(h!=null&&h.has(f))return h.get(f)===d;h==null||h.set(f,d);try{for(let p=0;p<m.length;p++){const x=m[p];if(!r.isPrimitive(d)&&!(x in d)||f[x]===void 0&&d[x]!==void 0||f[x]===null&&d[x]!==null||!A(d[x],f[x],x,d,f,h))return!1}return!0}finally{h==null||h.delete(f)}}function l(d,f,A,h){if(f.size===0)return!0;if(!(d instanceof Map))return!1;for(const[m,p]of f.entries()){const x=d.get(m);if(A(x,p,m,d,f,h)===!1)return!1}return!0}function c(d,f,A,h){if(f.length===0)return!0;if(!Array.isArray(d))return!1;const m=new Set;for(let p=0;p<f.length;p++){const x=f[p];let v=!1;for(let y=0;y<d.length;y++){if(m.has(y))continue;const b=d[y];let w=!1;if(A(b,x,p,d,f,h)&&(w=!0),w){m.add(y),v=!0;break}}if(!v)return!1}return!0}function u(d,f,A,h){return f.size===0?!0:d instanceof Set?c([...d],[...f],A,h):!1}t.isMatchWith=a,t.isSetMatch=u})(Nie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Nie;function r(n,a){return e.isMatchWith(n,a,()=>{})}t.isMatch=r})(ZR);var Cie={},nM={},_ie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(_ie);var aM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(aM);var sM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",A="[object ArrayBuffer]",h="[object Object]",m="[object Error]",p="[object DataView]",x="[object Uint8Array]",v="[object Uint8ClampedArray]",y="[object Uint16Array]",b="[object Uint32Array]",w="[object BigUint64Array]",j="[object Int8Array]",I="[object Int16Array]",C="[object Int32Array]",S="[object BigInt64Array]",E="[object Float32Array]",B="[object Float64Array]";t.argumentsTag=s,t.arrayBufferTag=A,t.arrayTag=d,t.bigInt64ArrayTag=S,t.bigUint64ArrayTag=w,t.booleanTag=a,t.dataViewTag=p,t.dateTag=l,t.errorTag=m,t.float32ArrayTag=E,t.float64ArrayTag=B,t.functionTag=f,t.int16ArrayTag=I,t.int32ArrayTag=C,t.int8ArrayTag=j,t.mapTag=c,t.numberTag=n,t.objectTag=h,t.regexpTag=e,t.setTag=u,t.stringTag=r,t.symbolTag=o,t.uint16ArrayTag=y,t.uint32ArrayTag=b,t.uint8ArrayTag=x,t.uint8ClampedArrayTag=v})(sM);var Eie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(Eie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_ie,r=aM,n=sM,a=tM,s=Eie;function o(d,f){return l(d,void 0,d,new Map,f)}function l(d,f,A,h=new Map,m=void 0){const p=m==null?void 0:m(d,f,A,h);if(p!==void 0)return p;if(a.isPrimitive(d))return d;if(h.has(d))return h.get(d);if(Array.isArray(d)){const x=new Array(d.length);h.set(d,x);for(let v=0;v<d.length;v++)x[v]=l(d[v],v,A,h,m);return Object.hasOwn(d,"index")&&(x.index=d.index),Object.hasOwn(d,"input")&&(x.input=d.input),x}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const x=new RegExp(d.source,d.flags);return x.lastIndex=d.lastIndex,x}if(d instanceof Map){const x=new Map;h.set(d,x);for(const[v,y]of d)x.set(v,l(y,v,A,h,m));return x}if(d instanceof Set){const x=new Set;h.set(d,x);for(const v of d)x.add(l(v,void 0,A,h,m));return x}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(s.isTypedArray(d)){const x=new(Object.getPrototypeOf(d)).constructor(d.length);h.set(d,x);for(let v=0;v<d.length;v++)x[v]=l(d[v],v,A,h,m);return x}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const x=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return h.set(d,x),c(x,d,A,h,m),x}if(typeof File<"u"&&d instanceof File){const x=new File([d],d.name,{type:d.type});return h.set(d,x),c(x,d,A,h,m),x}if(typeof Blob<"u"&&d instanceof Blob){const x=new Blob([d],{type:d.type});return h.set(d,x),c(x,d,A,h,m),x}if(d instanceof Error){const x=new d.constructor;return h.set(d,x),x.message=d.message,x.name=d.name,x.stack=d.stack,x.cause=d.cause,c(x,d,A,h,m),x}if(d instanceof Boolean){const x=new Boolean(d.valueOf());return h.set(d,x),c(x,d,A,h,m),x}if(d instanceof Number){const x=new Number(d.valueOf());return h.set(d,x),c(x,d,A,h,m),x}if(d instanceof String){const x=new String(d.valueOf());return h.set(d,x),c(x,d,A,h,m),x}if(typeof d=="object"&&u(d)){const x=Object.create(Object.getPrototypeOf(d));return h.set(d,x),c(x,d,A,h,m),x}return d}function c(d,f,A=d,h,m){const p=[...Object.keys(f),...e.getSymbols(f)];for(let x=0;x<p.length;x++){const v=p[x],y=Object.getOwnPropertyDescriptor(d,v);(y==null||y.writable)&&(d[v]=l(f[v],v,A,h,m))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=o,t.cloneDeepWithImpl=l,t.copyProperties=c})(nM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=nM;function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(Cie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=ZR,r=Cie;function n(a){return a=r.cloneDeep(a),s=>e.isMatch(s,a)}t.matches=n})(wie);var Sie={},Iie={},jie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=nM,r=sM;function n(a,s){return e.cloneDeepWith(a,(o,l,c,u)=>{const d=s==null?void 0:s(o,l,c,u);if(d!==void 0)return d;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new a.constructor(a==null?void 0:a.valueOf());return e.copyProperties(f,a),f}case r.argumentsTag:{const f={};return e.copyProperties(f,a),f.length=a.length,f[Symbol.iterator]=a[Symbol.iterator],f}default:return}})}t.cloneDeepWith=n})(jie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=jie;function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(Iie);var Pie={},iM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(iM);var Tie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=aM;function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(Tie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=XR,r=iM,n=Tie,a=SP;function s(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&e.isDeepKey(l)&&(o==null?void 0:o[l])==null?c=a.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}t.has=s})(Pie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=ZR,r=EP,n=Iie,a=_P,s=Pie;function o(l,c){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const d=a.get(u,l);return d===void 0?s.has(u,l):c===void 0?d===void 0:e.isMatch(d,c)}}t.matchesProperty=o})(Sie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=JR,r=bie,n=wie,a=Sie;function s(o){if(o==null)return e.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}t.iteratee=s})(yie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=pie,r=JR,n=gie,a=yie;function s(o,l=r.identity){return n.isArrayLikeObject(o)?e.uniqBy(Array.from(o),a.iteratee(l)):[]}t.uniqBy=s})(mie);var KHe=mie.uniqBy;const RG=PA(KHe);function Bie(t,e,r){return e===!0?RG(t,r):typeof e=="function"?RG(t,e):t}var kie={exports:{}},Fie={},Oie={exports:{}},Die={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kv=g;function qHe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zHe=typeof Object.is=="function"?Object.is:qHe,WHe=Kv.useState,XHe=Kv.useEffect,YHe=Kv.useLayoutEffect,JHe=Kv.useDebugValue;function ZHe(t,e){var r=e(),n=WHe({inst:{value:r,getSnapshot:e}}),a=n[0].inst,s=n[1];return YHe(function(){a.value=r,a.getSnapshot=e,mT(a)&&s({inst:a})},[t,r,e]),XHe(function(){return mT(a)&&s({inst:a}),t(function(){mT(a)&&s({inst:a})})},[t]),JHe(r),r}function mT(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!zHe(t,r)}catch{return!0}}function e$e(t,e){return e()}var t$e=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?e$e:ZHe;Die.useSyncExternalStore=Kv.useSyncExternalStore!==void 0?Kv.useSyncExternalStore:t$e;Oie.exports=Die;var r$e=Oie.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jP=g,n$e=r$e;function a$e(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var s$e=typeof Object.is=="function"?Object.is:a$e,i$e=n$e.useSyncExternalStore,o$e=jP.useRef,l$e=jP.useEffect,c$e=jP.useMemo,u$e=jP.useDebugValue;Fie.useSyncExternalStoreWithSelector=function(t,e,r,n,a){var s=o$e(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=c$e(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),a!==void 0&&o.hasValue){var m=o.value;if(a(m,h))return f=m}return f=h}if(m=f,s$e(d,h))return m;var p=n(h);return a!==void 0&&a(m,p)?(d=h,m):(d=h,f=p)}var u=!1,d,f,A=r===void 0?null:r;return[function(){return c(e())},A===null?void 0:function(){return c(A())}]},[e,r,n,a]);var l=i$e(t,s[0],s[1]);return l$e(function(){o.hasValue=!0,o.value=l},[l]),u$e(l),l};kie.exports=Fie;var d$e=kie.exports,oM=g.createContext(null),f$e=t=>t,_s=()=>{var t=g.useContext(oM);return t?t.store.dispatch:f$e},NE=()=>{},h$e=()=>NE,A$e=(t,e)=>t===e;function yn(t){var e=g.useContext(oM);return d$e.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:h$e,e?e.store.getState:NE,e?e.store.getState:NE,e?t:NE,A$e)}function m$e(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function p$e(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function g$e(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var MG=t=>Array.isArray(t)?t:[t];function x$e(t){const e=Array.isArray(t[0])?t[0]:t;return g$e(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function v$e(t,e){const r=[],{length:n}=t;for(let a=0;a<n;a++)r.push(t[a].apply(null,e));return r}var y$e=class{constructor(t){this.value=t}deref(){return this.value}},b$e=typeof WeakRef<"u"?WeakRef:y$e,w$e=0,LG=1;function g_(){return{s:w$e,v:void 0,o:null,p:null}}function Rie(t,e={}){let r=g_();const{resultEqualityCheck:n}=e;let a,s=0;function o(){var f;let l=r;const{length:c}=arguments;for(let A=0,h=c;A<h;A++){const m=arguments[A];if(typeof m=="function"||typeof m=="object"&&m!==null){let p=l.o;p===null&&(l.o=p=new WeakMap);const x=p.get(m);x===void 0?(l=g_(),p.set(m,l)):l=x}else{let p=l.p;p===null&&(l.p=p=new Map);const x=p.get(m);x===void 0?(l=g_(),p.set(m,l)):l=x}}const u=l;let d;if(l.s===LG)d=l.v;else if(d=t.apply(null,arguments),s++,n){const A=((f=a==null?void 0:a.deref)==null?void 0:f.call(a))??a;A!=null&&n(A,d)&&(d=A,s!==0&&s--),a=typeof d=="object"&&d!==null||typeof d=="function"?new b$e(d):d}return u.s=LG,u.v=d,d}return o.clearCache=()=>{r=g_(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function N$e(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...a)=>{let s=0,o=0,l,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),m$e(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:A=[],argsMemoize:h=Rie,argsMemoizeOptions:m=[]}=d,p=MG(A),x=MG(m),v=x$e(a),y=f(function(){return s++,u.apply(null,arguments)},...p),b=h(function(){o++;const j=v$e(v,arguments);return l=y.apply(null,j),l},...x);return Object.assign(b,{resultFunc:u,memoizedResultFunc:y,dependencies:v,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var tr=N$e(Rie),C$e=Object.assign((t,e=tr)=>{p$e(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(s=>t[s]);return e(n,(...s)=>s.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>C$e}),Mie={},Lie={},Uie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,s)=>{if(n!==a){const o=e(n),l=e(a);if(o===l&&o===0){if(n<a)return s==="desc"?1:-1;if(n>a)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};t.compareValues=r})(Uie);var Qie={},lM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(lM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=lM,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||e.isSymbol(s)?!0:typeof s=="string"&&(n.test(s)||!r.test(s))||o!=null&&Object.hasOwn(o,s)}t.isKey=a})(Qie);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Uie,r=Qie,n=SP;function a(s,o,l,c){if(s==null)return[];l=c?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(h=>String(h));const u=(h,m)=>{let p=h;for(let x=0;x<m.length&&p!=null;++x)p=p[m[x]];return p},d=(h,m)=>m==null||h==null?m:typeof h=="object"&&"key"in h?Object.hasOwn(m,h.key)?m[h.key]:u(m,h.path):typeof h=="function"?h(m):Array.isArray(h)?u(m,h):typeof m=="object"?m[h]:m,f=o.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:n.toPath(h)}));return s.map(h=>({original:h,criteria:f.map(m=>d(m,h))})).slice().sort((h,m)=>{for(let p=0;p<f.length;p++){const x=e.compareValues(h.criteria[p],m.criteria[p],l[p]);if(x!==0)return x}return 0}).map(h=>h.original)}t.orderBy=a})(Lie);var Vie={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const a=[],s=Math.floor(n),o=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<s?o(d,c+1):a.push(d)}};return o(r,0),a}t.flatten=e})(Vie);var cM={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=iM,r=IP,n=eM,a=rM;function s(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&e.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?a.eq(c[l],o):!1}t.isIterateeCall=s})(cM);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Lie,r=Vie,n=cM;function a(s,...o){const l=o.length;return l>1&&n.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),e.orderBy(s,r.flatten(o),["asc"])}t.sortBy=a})(Mie);var _$e=Mie.sortBy;const PP=PA(_$e);var Hie=t=>t.legend.settings,E$e=t=>t.legend.size,S$e=t=>t.legend.payload,I$e=tr([S$e,Hie],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?PP(n,r):n});function j$e(){return yn(I$e)}var x_=1;function $ie(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=g.useState({height:0,left:0,top:0,width:0}),n=g.useCallback(a=>{if(a!=null){var s=a.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-e.height)>x_||Math.abs(o.left-e.left)>x_||Math.abs(o.top-e.top)>x_||Math.abs(o.width-e.width)>x_)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function yl(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var P$e=typeof Symbol=="function"&&Symbol.observable||"@@observable",UG=P$e,pT=()=>Math.random().toString(36).substring(7).split("").join("."),T$e={INIT:`@@redux/INIT${pT()}`,REPLACE:`@@redux/REPLACE${pT()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${pT()}`},AI=T$e;function uM(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function Gie(t,e,r){if(typeof t!="function")throw new Error(yl(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(yl(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(yl(1));return r(Gie)(t,e)}let n=t,a=e,s=new Map,o=s,l=0,c=!1;function u(){o===s&&(o=new Map,s.forEach((x,v)=>{o.set(v,x)}))}function d(){if(c)throw new Error(yl(3));return a}function f(x){if(typeof x!="function")throw new Error(yl(4));if(c)throw new Error(yl(5));let v=!0;u();const y=l++;return o.set(y,x),function(){if(v){if(c)throw new Error(yl(6));v=!1,u(),o.delete(y),s=null}}}function A(x){if(!uM(x))throw new Error(yl(7));if(typeof x.type>"u")throw new Error(yl(8));if(typeof x.type!="string")throw new Error(yl(17));if(c)throw new Error(yl(9));try{c=!0,a=n(a,x)}finally{c=!1}return(s=o).forEach(y=>{y()}),x}function h(x){if(typeof x!="function")throw new Error(yl(10));n=x,A({type:AI.REPLACE})}function m(){const x=f;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(yl(11));function y(){const w=v;w.next&&w.next(d())}return y(),{unsubscribe:x(y)}},[UG](){return this}}}return A({type:AI.INIT}),{dispatch:A,subscribe:f,getState:d,replaceReducer:h,[UG]:m}}function B$e(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:AI.INIT})>"u")throw new Error(yl(12));if(typeof r(void 0,{type:AI.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(yl(13))})}function Kie(t){const e=Object.keys(t),r={};for(let s=0;s<e.length;s++){const o=e[s];typeof t[o]=="function"&&(r[o]=t[o])}const n=Object.keys(r);let a;try{B$e(r)}catch(s){a=s}return function(o={},l){if(a)throw a;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],A=r[f],h=o[f],m=A(h,l);if(typeof m>"u")throw l&&l.type,new Error(yl(14));u[f]=m,c=c||m!==h}return c=c||n.length!==Object.keys(o).length,c?u:o}}function mI(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function k$e(...t){return e=>(r,n)=>{const a=e(r,n);let s=()=>{throw new Error(yl(15))};const o={getState:a.getState,dispatch:(c,...u)=>s(c,...u)},l=t.map(c=>c(o));return s=mI(...l)(a.dispatch),{...a,dispatch:s}}}function qie(t){return uM(t)&&"type"in t&&typeof t.type=="string"}var zie=Symbol.for("immer-nothing"),QG=Symbol.for("immer-draftable"),Fc=Symbol.for("immer-state");function uf(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Ru=Object,qv=Ru.getPrototypeOf,pI="constructor",TP="prototype",BF="configurable",gI="enumerable",CE="writable",J2="value",CA=t=>!!t&&!!t[Fc];function _f(t){var e;return t?Wie(t)||kP(t)||!!t[QG]||!!((e=t[pI])!=null&&e[QG])||FP(t)||OP(t):!1}var F$e=Ru[TP][pI].toString(),VG=new WeakMap;function Wie(t){if(!t||!dM(t))return!1;const e=qv(t);if(e===null||e===Ru[TP])return!0;const r=Ru.hasOwnProperty.call(e,pI)&&e[pI];if(r===Object)return!0;if(!Dx(r))return!1;let n=VG.get(r);return n===void 0&&(n=Function.toString.call(r),VG.set(r,n)),n===F$e}function BP(t,e,r=!0){Jw(t)===0?(r?Reflect.ownKeys(t):Ru.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((n,a)=>e(a,n,t))}function Jw(t){const e=t[Fc];return e?e.type_:kP(t)?1:FP(t)?2:OP(t)?3:0}var HG=(t,e,r=Jw(t))=>r===2?t.has(e):Ru[TP].hasOwnProperty.call(t,e),kF=(t,e,r=Jw(t))=>r===2?t.get(e):t[e],xI=(t,e,r,n=Jw(t))=>{n===2?t.set(e,r):n===3?t.add(r):t[e]=r};function O$e(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}var kP=Array.isArray,FP=t=>t instanceof Map,OP=t=>t instanceof Set,dM=t=>typeof t=="object",Dx=t=>typeof t=="function",gT=t=>typeof t=="boolean";function D$e(t){const e=+t;return Number.isInteger(e)&&String(e)===t}var Vh=t=>t.copy_||t.base_,fM=t=>t.modified_?t.copy_:t.base_;function FF(t,e){if(FP(t))return new Map(t);if(OP(t))return new Set(t);if(kP(t))return Array[TP].slice.call(t);const r=Wie(t);if(e===!0||e==="class_only"&&!r){const n=Ru.getOwnPropertyDescriptors(t);delete n[Fc];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l[CE]===!1&&(l[CE]=!0,l[BF]=!0),(l.get||l.set)&&(n[o]={[BF]:!0,[CE]:!0,[gI]:l[gI],[J2]:t[o]})}return Ru.create(qv(t),n)}else{const n=qv(t);if(n!==null&&r)return{...t};const a=Ru.create(n);return Ru.assign(a,t)}}function hM(t,e=!1){return DP(t)||CA(t)||!_f(t)||(Jw(t)>1&&Ru.defineProperties(t,{set:v_,add:v_,clear:v_,delete:v_}),Ru.freeze(t),e&&BP(t,(r,n)=>{hM(n,!0)},!1)),t}function R$e(){uf(2)}var v_={[J2]:R$e};function DP(t){return t===null||!dM(t)?!0:Ru.isFrozen(t)}var vI="MapSet",OF="Patches",$G="ArrayMethods",Xie={};function Cg(t){const e=Xie[t];return e||uf(0,t),e}var GG=t=>!!Xie[t],Z2,Yie=()=>Z2,M$e=(t,e)=>({drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:GG(vI)?Cg(vI):void 0,arrayMethodsPlugin_:GG($G)?Cg($G):void 0});function KG(t,e){e&&(t.patchPlugin_=Cg(OF),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function DF(t){RF(t),t.drafts_.forEach(L$e),t.drafts_=null}function RF(t){t===Z2&&(Z2=t.parent_)}var qG=t=>Z2=M$e(Z2,t);function L$e(t){const e=t[Fc];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function zG(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];if(t!==void 0&&t!==r){r[Fc].modified_&&(DF(e),uf(4)),_f(t)&&(t=WG(e,t));const{patchPlugin_:a}=e;a&&a.generateReplacementPatches_(r[Fc].base_,t,e)}else t=WG(e,r);return U$e(e,t,!0),DF(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==zie?t:void 0}function WG(t,e){if(DP(e))return e;const r=e[Fc];if(!r)return yI(e,t.handledSet_,t);if(!RP(r,t))return e;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(t);eoe(r,t)}return r.copy_}function U$e(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&hM(e,r)}function Jie(t){t.finalized_=!0,t.scope_.unfinalizedDrafts_--}var RP=(t,e)=>t.scope_===e,Q$e=[];function Zie(t,e,r,n){const a=Vh(t),s=t.type_;if(n!==void 0&&kF(a,n,s)===e){xI(a,n,r,s);return}if(!t.draftLocations_){const l=t.draftLocations_=new Map;BP(a,(c,u)=>{if(CA(u)){const d=l.get(u)||[];d.push(c),l.set(u,d)}})}const o=t.draftLocations_.get(e)??Q$e;for(const l of o)xI(a,l,r,s)}function V$e(t,e,r){t.callbacks_.push(function(a){var l;const s=e;if(!s||!RP(s,a))return;(l=a.mapSetPlugin_)==null||l.fixSetContents(s);const o=fM(s);Zie(t,s.draft_??s,o,r),eoe(s,a)})}function eoe(t,e){var n;if(t.modified_&&!t.finalized_&&(t.type_===3||t.type_===1&&t.allIndicesReassigned_||(((n=t.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:a}=e;if(a){const s=a.getPath(t);s&&a.generatePatches_(t,s,e)}Jie(t)}}function H$e(t,e,r){const{scope_:n}=t;if(CA(r)){const a=r[Fc];RP(a,n)&&a.callbacks_.push(function(){_E(t);const o=fM(a);Zie(t,r,o,e)})}else _f(r)&&t.callbacks_.push(function(){const s=Vh(t);t.type_===3?s.has(r)&&yI(r,n.handledSet_,n):kF(s,e,t.type_)===r&&n.drafts_.length>1&&(t.assigned_.get(e)??!1)===!0&&t.copy_&&yI(kF(t.copy_,e,t.type_),n.handledSet_,n)})}function yI(t,e,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||CA(t)||e.has(t)||!_f(t)||DP(t)||(e.add(t),BP(t,(n,a)=>{if(CA(a)){const s=a[Fc];if(RP(s,r)){const o=fM(s);xI(t,n,o,t.type_),Jie(s)}}else _f(a)&&yI(a,e,r)})),t}function $$e(t,e){const r=kP(t),n={type_:r?1:0,scope_:e?e.scope_:Yie(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,s=bI;r&&(a=[n],s=ew);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,[l,n]}var bI={get(t,e){if(e===Fc)return t;let r=t.scope_.arrayMethodsPlugin_;const n=t.type_===1&&typeof e=="string";if(n&&r!=null&&r.isArrayOperationMethod(e))return r.createMethodInterceptor(t,e);const a=Vh(t);if(!HG(a,e,t.type_))return G$e(t,a,e);const s=a[e];if(t.finalized_||!_f(s)||n&&t.operationMethod&&(r!=null&&r.isMutatingArrayMethod(t.operationMethod))&&D$e(e))return s;if(s===xT(t.base_,e)){_E(t);const o=t.type_===1?+e:e,l=LF(t.scope_,s,t,o);return t.copy_[o]=l}return s},has(t,e){return e in Vh(t)},ownKeys(t){return Reflect.ownKeys(Vh(t))},set(t,e,r){const n=toe(Vh(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=xT(Vh(t),e),s=a==null?void 0:a[Fc];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_.set(e,!1),!0;if(O$e(r,a)&&(r!==void 0||HG(t.base_,e,t.type_)))return!0;_E(t),MF(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_.set(e,!0),H$e(t,e,r)),!0},deleteProperty(t,e){return _E(t),xT(t.base_,e)!==void 0||e in t.base_?(t.assigned_.set(e,!1),MF(t)):t.assigned_.delete(e),t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Vh(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{[CE]:!0,[BF]:t.type_!==1||e!=="length",[gI]:n[gI],[J2]:r[e]}},defineProperty(){uf(11)},getPrototypeOf(t){return qv(t.base_)},setPrototypeOf(){uf(12)}},ew={};for(let t in bI){let e=bI[t];ew[t]=function(){const r=arguments;return r[0]=r[0][0],e.apply(this,r)}}ew.deleteProperty=function(t,e){return ew.set.call(this,t,e,void 0)};ew.set=function(t,e,r){return bI.set.call(this,t[0],e,r,t[0])};function xT(t,e){const r=t[Fc];return(r?Vh(r):t)[e]}function G$e(t,e,r){var a;const n=toe(e,r);return n?J2 in n?n[J2]:(a=n.get)==null?void 0:a.call(t.draft_):void 0}function toe(t,e){if(!(e in t))return;let r=qv(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=qv(r)}}function MF(t){t.modified_||(t.modified_=!0,t.parent_&&MF(t.parent_))}function _E(t){t.copy_||(t.assigned_=new Map,t.copy_=FF(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var K$e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,a)=>{if(Dx(r)&&!Dx(n)){const o=n;n=r;const l=this;return function(u=o,...d){return l.produce(u,f=>n.call(this,f,...d))}}Dx(n)||uf(6),a!==void 0&&!Dx(a)&&uf(7);let s;if(_f(r)){const o=qG(this),l=LF(o,r,void 0);let c=!0;try{s=n(l),c=!1}finally{c?DF(o):RF(o)}return KG(o,a),zG(s,o)}else if(!r||!dM(r)){if(s=n(r),s===void 0&&(s=r),s===zie&&(s=void 0),this.autoFreeze_&&hM(s,!0),a){const o=[],l=[];Cg(OF).generateReplacementPatches_(r,s,{patches_:o,inversePatches_:l}),a(o,l)}return s}else uf(1,r)},this.produceWithPatches=(r,n)=>{if(Dx(r))return(l,...c)=>this.produceWithPatches(l,u=>r(u,...c));let a,s;return[this.produce(r,n,(l,c)=>{a=l,s=c}),a,s]},gT(e==null?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),gT(e==null?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),gT(e==null?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){_f(e)||uf(8),CA(e)&&(e=yf(e));const r=qG(this),n=LF(r,e,void 0);return n[Fc].isManual_=!0,RF(r),n}finishDraft(e,r){const n=e&&e[Fc];(!n||!n.isManual_)&&uf(9);const{scope_:a}=n;return KG(a,r),zG(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let n;for(n=r.length-1;n>=0;n--){const s=r[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(r=r.slice(n+1));const a=Cg(OF).applyPatches_;return CA(e)?a(e,r):this.produce(e,s=>a(s,r))}};function LF(t,e,r,n){const[a,s]=FP(e)?Cg(vI).proxyMap_(e,r):OP(e)?Cg(vI).proxySet_(e,r):$$e(e,r);return((r==null?void 0:r.scope_)??Yie()).drafts_.push(a),s.callbacks_=(r==null?void 0:r.callbacks_)??[],s.key_=n,r&&n!==void 0?V$e(r,s,n):s.callbacks_.push(function(c){var d;(d=c.mapSetPlugin_)==null||d.fixSetContents(s);const{patchPlugin_:u}=c;s.modified_&&u&&u.generatePatches_(s,[],c)}),a}function yf(t){return CA(t)||uf(10,t),roe(t)}function roe(t){if(!_f(t)||DP(t))return t;const e=t[Fc];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=FF(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=FF(t,!0);return BP(r,(a,s)=>{xI(r,a,roe(s))},n),e&&(e.finalized_=!1),r}var q$e=new K$e,noe=q$e.produce;function aoe(t){return({dispatch:r,getState:n})=>a=>s=>typeof s=="function"?s(r,n,t):a(s)}var z$e=aoe(),W$e=aoe,X$e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?mI:mI.apply(null,arguments)};function Md(t,e){function r(...n){if(e){let a=e(...n);if(!a)throw new Error(Uu(0));return{type:t,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>qie(n)&&n.type===t,r}var soe=class nb extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,nb.prototype)}static get[Symbol.species](){return nb}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new nb(...e[0].concat(this)):new nb(...e.concat(this))}};function XG(t){return _f(t)?noe(t,()=>{}):t}function y_(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function Y$e(t){return typeof t=="boolean"}var J$e=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:s=!0}=e??{};let o=new soe;return r&&(Y$e(r)?o.push(z$e):o.push(W$e(r.extraArgument))),o},ioe="RTK_autoBatch",Qs=()=>t=>({payload:t,meta:{[ioe]:!0}}),YG=t=>e=>{setTimeout(e,t)},ooe=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let a=!0,s=!1,o=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:YG(10):t.type==="callback"?t.queueNotification:YG(t.timeout),u=()=>{o=!1,s&&(s=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>a&&d(),A=n.subscribe(f);return l.add(d),()=>{A(),l.delete(d)}},dispatch(d){var f;try{return a=!((f=d==null?void 0:d.meta)!=null&&f[ioe]),s=!a,s&&(o||(o=!0,c(u))),n.dispatch(d)}finally{a=!0}}})},Z$e=t=>function(r){const{autoBatch:n=!0}=r??{};let a=new soe(t);return n&&a.push(ooe(typeof n=="object"?n:void 0)),a};function eGe(t){const e=J$e(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:s=void 0,enhancers:o=void 0}=t||{};let l;if(typeof r=="function")l=r;else if(uM(r))l=Kie(r);else throw new Error(Uu(1));let c;typeof n=="function"?c=n(e):c=e();let u=mI;a&&(u=X$e({trace:!1,...typeof a=="object"&&a}));const d=k$e(...c),f=Z$e(d);let A=typeof o=="function"?o(f):f();const h=u(...A);return Gie(l,s,h)}function loe(t){const e={},r=[];let n;const a={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(Uu(28));if(l in e)throw new Error(Uu(29));return e[l]=o,a},addAsyncThunk(s,o){return o.pending&&(e[s.pending.type]=o.pending),o.rejected&&(e[s.rejected.type]=o.rejected),o.fulfilled&&(e[s.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:s.settled,reducer:o.settled}),a},addMatcher(s,o){return r.push({matcher:s,reducer:o}),a},addDefaultCase(s){return n=s,a}};return t(a),[e,r,n]}function tGe(t){return typeof t=="function"}function rGe(t,e){let[r,n,a]=loe(e),s;if(tGe(t))s=()=>XG(t());else{const l=XG(t);s=()=>l}function o(l=s(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[a]),u.reduce((d,f)=>{if(f)if(CA(d)){const h=f(d,c);return h===void 0?d:h}else{if(_f(d))return noe(d,A=>f(A,c));{const A=f(d,c);if(A===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return A}}return d},l)}return o.getInitialState=s,o}var nGe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",aGe=(t=21)=>{let e="",r=t;for(;r--;)e+=nGe[Math.random()*64|0];return e},sGe=Symbol.for("rtk-slice-createasyncthunk");function iGe(t,e){return`${t}/${e}`}function oGe({creators:t}={}){var r;const e=(r=t==null?void 0:t.asyncThunk)==null?void 0:r[sGe];return function(a){const{name:s,reducerPath:o=s}=a;if(!s)throw new Error(Uu(11));const l=(typeof a.reducers=="function"?a.reducers(cGe()):a.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(w,j){const I=typeof w=="string"?w:w.type;if(!I)throw new Error(Uu(12));if(I in u.sliceCaseReducersByType)throw new Error(Uu(13));return u.sliceCaseReducersByType[I]=j,d},addMatcher(w,j){return u.sliceMatchers.push({matcher:w,reducer:j}),d},exposeAction(w,j){return u.actionCreators[w]=j,d},exposeCaseReducer(w,j){return u.sliceCaseReducersByName[w]=j,d}};c.forEach(w=>{const j=l[w],I={reducerName:w,type:iGe(s,w),createNotation:typeof a.reducers=="function"};dGe(j)?hGe(I,j,d,e):uGe(I,j,d)});function f(){const[w={},j=[],I=void 0]=typeof a.extraReducers=="function"?loe(a.extraReducers):[a.extraReducers],C={...w,...u.sliceCaseReducersByType};return rGe(a.initialState,S=>{for(let E in C)S.addCase(E,C[E]);for(let E of u.sliceMatchers)S.addMatcher(E.matcher,E.reducer);for(let E of j)S.addMatcher(E.matcher,E.reducer);I&&S.addDefaultCase(I)})}const A=w=>w,h=new Map,m=new WeakMap;let p;function x(w,j){return p||(p=f()),p(w,j)}function v(){return p||(p=f()),p.getInitialState()}function y(w,j=!1){function I(S){let E=S[w];return typeof E>"u"&&j&&(E=y_(m,I,v)),E}function C(S=A){const E=y_(h,j,()=>new WeakMap);return y_(E,S,()=>{const B={};for(const[k,T]of Object.entries(a.selectors??{}))B[k]=lGe(T,S,()=>y_(m,S,v),j);return B})}return{reducerPath:w,getSelectors:C,get selectors(){return C(I)},selectSlice:I}}const b={name:s,reducer:x,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:v,...y(o),injectInto(w,{reducerPath:j,...I}={}){const C=j??o;return w.inject({reducerPath:C,reducer:x},I),{...b,...y(C,!0)}}};return b}}function lGe(t,e,r,n){function a(s,...o){let l=e(s);return typeof l>"u"&&n&&(l=r()),t(l,...o)}return a.unwrapped=t,a}var fu=oGe();function cGe(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function uGe({type:t,reducerName:e,createNotation:r},n,a){let s,o;if("reducer"in n){if(r&&!fGe(n))throw new Error(Uu(17));s=n.reducer,o=n.prepare}else s=n;a.addCase(t,s).exposeCaseReducer(e,s).exposeAction(e,o?Md(t,o):Md(t))}function dGe(t){return t._reducerDefinitionType==="asyncThunk"}function fGe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function hGe({type:t,reducerName:e},r,n,a){if(!a)throw new Error(Uu(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=r,f=a(t,s,d);n.exposeAction(e,f),o&&n.addCase(f.fulfilled,o),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(e,{fulfilled:o||b_,pending:l||b_,rejected:c||b_,settled:u||b_})}function b_(){}var AGe="task",coe="listener",uoe="completed",AM="cancelled",mGe=`task-${AM}`,pGe=`task-${uoe}`,UF=`${coe}-${AM}`,gGe=`${coe}-${uoe}`,MP=class{constructor(t){Tr(this,"name","TaskAbortError");Tr(this,"message");this.code=t,this.message=`${AGe} ${AM} (reason: ${t})`}},mM=(t,e)=>{if(typeof t!="function")throw new TypeError(Uu(32))},wI=()=>{},doe=(t,e=wI)=>(t.catch(e),t),foe=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Wp=t=>{if(t.aborted)throw new MP(t.reason)};function hoe(t,e){let r=wI;return new Promise((n,a)=>{const s=()=>a(new MP(t.reason));if(t.aborted){s();return}r=foe(t,s),e.finally(()=>r()).then(n,a)}).finally(()=>{r=wI})}var xGe=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof MP?"cancelled":"rejected",error:r}}finally{e==null||e()}},NI=t=>e=>doe(hoe(t,e).then(r=>(Wp(t),r))),Aoe=t=>{const e=NI(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:bv}=Object,JG={},LP="listenerMiddleware",vGe=(t,e)=>{const r=n=>foe(t,()=>n.abort(t.reason));return(n,a)=>{mM(n);const s=new AbortController;r(s);const o=xGe(async()=>{Wp(t),Wp(s.signal);const l=await n({pause:NI(s.signal),delay:Aoe(s.signal),signal:s.signal});return Wp(s.signal),l},()=>s.abort(pGe));return a!=null&&a.autoJoin&&e.push(o.catch(wI)),{result:NI(t)(o),cancel(){s.abort(mGe)}}}},yGe=(t,e)=>{const r=async(n,a)=>{Wp(e);let s=()=>{};const l=[new Promise((c,u)=>{let d=t({predicate:n,effect:(f,A)=>{A.unsubscribe(),c([f,A.getState(),A.getOriginalState()])}});s=()=>{d(),u()}})];a!=null&&l.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await hoe(e,Promise.race(l));return Wp(e),c}finally{s()}};return(n,a)=>doe(r(n,a))},moe=t=>{let{type:e,actionCreator:r,matcher:n,predicate:a,effect:s}=t;if(e)a=Md(e).match;else if(r)e=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Uu(21));return mM(s),{predicate:a,type:e,effect:s}},poe=bv(t=>{const{type:e,predicate:r,effect:n}=moe(t);return{id:aGe(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Uu(22))}}},{withTypes:()=>poe}),ZG=(t,e)=>{const{type:r,effect:n,predicate:a}=moe(e);return Array.from(t.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===a)&&s.effect===n)},QF=t=>{t.pending.forEach(e=>{e.abort(UF)})},bGe=(t,e)=>()=>{for(const r of e.keys())QF(r);t.clear()},eK=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},goe=bv(Md(`${LP}/add`),{withTypes:()=>goe}),wGe=Md(`${LP}/removeAll`),xoe=bv(Md(`${LP}/remove`),{withTypes:()=>xoe}),NGe=(...t)=>{console.error(`${LP}/error`,...t)},Zw=(t={})=>{const e=new Map,r=new Map,n=h=>{const m=r.get(h)??0;r.set(h,m+1)},a=h=>{const m=r.get(h)??1;m===1?r.delete(h):r.set(h,m-1)},{extra:s,onError:o=NGe}=t;mM(o);const l=h=>(h.unsubscribe=()=>e.delete(h.id),e.set(h.id,h),m=>{h.unsubscribe(),m!=null&&m.cancelActive&&QF(h)}),c=h=>{const m=ZG(e,h)??poe(h);return l(m)};bv(c,{withTypes:()=>c});const u=h=>{const m=ZG(e,h);return m&&(m.unsubscribe(),h.cancelActive&&QF(m)),!!m};bv(u,{withTypes:()=>u});const d=async(h,m,p,x)=>{const v=new AbortController,y=yGe(c,v.signal),b=[];try{h.pending.add(v),n(h),await Promise.resolve(h.effect(m,bv({},p,{getOriginalState:x,condition:(w,j)=>y(w,j).then(Boolean),take:y,delay:Aoe(v.signal),pause:NI(v.signal),extra:s,signal:v.signal,fork:vGe(v.signal,b),unsubscribe:h.unsubscribe,subscribe:()=>{e.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((w,j,I)=>{w!==v&&(w.abort(UF),I.delete(w))})},cancel:()=>{v.abort(UF),h.pending.delete(v)},throwIfCancelled:()=>{Wp(v.signal)}})))}catch(w){w instanceof MP||eK(o,w,{raisedBy:"effect"})}finally{await Promise.all(b),v.abort(gGe),a(h),h.pending.delete(v)}},f=bGe(e,r);return{middleware:h=>m=>p=>{if(!qie(p))return m(p);if(goe.match(p))return c(p.payload);if(wGe.match(p)){f();return}if(xoe.match(p))return u(p.payload);let x=h.getState();const v=()=>{if(x===JG)throw new Error(Uu(23));return x};let y;try{if(y=m(p),e.size>0){const b=h.getState(),w=Array.from(e.values());for(const j of w){let I=!1;try{I=j.predicate(p,b,x)}catch(C){I=!1,eK(o,C,{raisedBy:"predicate"})}I&&d(j,p,h,v)}}}finally{x=JG}return y},startListening:c,stopListening:u,clearListeners:f}};function Uu(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var CGe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},voe=fu({name:"chartLayout",initialState:CGe,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){var r,n,a,s;t.margin.top=(r=e.payload.top)!==null&&r!==void 0?r:0,t.margin.right=(n=e.payload.right)!==null&&n!==void 0?n:0,t.margin.bottom=(a=e.payload.bottom)!==null&&a!==void 0?a:0,t.margin.left=(s=e.payload.left)!==null&&s!==void 0?s:0},setScale(t,e){t.scale=e.payload}}}),{setMargin:_Ge,setLayout:EGe,setChartSize:SGe,setScale:IGe}=voe.actions,jGe=voe.reducer;function yoe(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function pi(t){return Number.isFinite(t)}function km(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function tK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function rv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tK(Object(r),!0).forEach(function(n){PGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function PGe(t,e,r){return(e=TGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TGe(t){var e=BGe(t,"string");return typeof e=="symbol"?e:e+""}function BGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Os(t,e,r){return il(t)||il(e)?r:fh(e)?Ng(t,e,r):typeof e=="function"?e(t):r}var kGe=(t,e,r)=>{if(e&&r){var{width:n,height:a}=r,{align:s,verticalAlign:o,layout:l}=e;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&_n(t[s]))return rv(rv({},t),{},{[s]:t[s]+(n||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&_n(t[o]))return rv(rv({},t),{},{[o]:t[o]+(a||0)})}return t},Kg=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",rK=1e-4,FGe=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),a=Math.min(n[0],n[1])-rK,s=Math.max(n[0],n[1])+rK,o=t(e[0]),l=t(e[r-1]);(o<a||o>s||l<a||l>s)&&t.domain([e[0],e[r-1]])}},OGe=(t,e)=>{if(!e||e.length!==2||!_n(e[0])||!_n(e[1]))return t;var r=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]),a=[t[0],t[1]];return(!_n(t[0])||t[0]<r)&&(a[0]=r),(!_n(t[1])||t[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},DGe=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,o=0,l=0;l<r;++l){var c=t[l],u=c==null?void 0:c[a];if(u!=null){var d=u[1],f=u[0],A=dh(d)?f:d;A>=0?(u[0]=s,u[1]=s+A,s=d):(u[0]=o,u[1]=o+A,o=d)}}}},RGe=t=>{var e,r=t.length;if(!(r<=0)){var n=(e=t[0])===null||e===void 0?void 0:e.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,o=0;o<r;++o){var l=t[o],c=l==null?void 0:l[a];if(c!=null){var u=dh(c[1])?c[0]:c[1];u>=0?(c[0]=s,c[1]=s+u,s=c[1]):(c[0]=0,c[1]=0)}}}},MGe={sign:DGe,expand:AHe,none:wg,silhouette:mHe,wiggle:pHe,positive:RGe},LGe=(t,e,r)=>{var n,a=(n=MGe[r])!==null&&n!==void 0?n:wg,s=hHe().keys(e).value((l,c)=>Number(Os(l,c,0))).order(PF).offset(a),o=s(t);return o.forEach((l,c)=>{l.forEach((u,d)=>{var f=Os(t[d],e[c],0);Array.isArray(f)&&f.length===2&&_n(f[0])&&_n(f[1])&&(u[0]=f[0],u[1]=f[1])})}),o};function UGe(t){return t==null?void 0:String(t)}var nK=t=>{var{axis:e,ticks:r,offset:n,bandSize:a,entry:s,index:o}=t;if(e.type==="category")return r[o]?r[o].coordinate+n:null;var l=Os(s,e.dataKey,e.scale.domain()[o]);return il(l)?null:e.scale(l)-a/2+n},QGe=t=>{var{numericAxis:e}=t,r=e.scale.domain();if(e.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},VGe=t=>{var e=t.flat(2).filter(_n);return[Math.min(...e),Math.max(...e)]},HGe=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],$Ge=(t,e,r)=>{if(t!=null)return HGe(Object.keys(t).reduce((n,a)=>{var s=t[a];if(!s)return n;var{stackedData:o}=s,l=o.reduce((c,u)=>{var d=yoe(u,e,r),f=VGe(d);return!pi(f[0])||!pi(f[1])?c:[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},aK=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,sK=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,CI=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var a=PP(e,d=>d.coordinate),s=1/0,o=1,l=a.length;o<l;o++){var c=a[o],u=a[o-1];s=Math.min(((c==null?void 0:c.coordinate)||0)-((u==null?void 0:u.coordinate)||0),s)}return s===1/0?0:s}return r?void 0:0};function iK(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:a,name:s}=t;return rv(rv({},e),{},{dataKey:r,payload:n,value:a,name:s})}function UP(t,e){if(t)return String(t);if(typeof e=="string")return e}var GGe=(t,e)=>{if(e==="horizontal")return t.chartX;if(e==="vertical")return t.chartY},KGe=(t,e)=>e==="centric"?t.angle:t.radius,UA=t=>t.layout.width,QA=t=>t.layout.height,qGe=t=>t.layout.scale,boe=t=>t.layout.margin,QP=tr(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),VP=tr(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),woe="data-recharts-item-index",Noe="data-recharts-item-id",eN=60;function oK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function w_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oK(Object(r),!0).forEach(function(n){zGe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function zGe(t,e,r){return(e=WGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WGe(t){var e=XGe(t,"string");return typeof e=="symbol"?e:e+""}function XGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var YGe=t=>t.brush.height;function JGe(t){var e=VP(t);return e.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:eN;return r+a}return r},0)}function ZGe(t){var e=VP(t);return e.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:eN;return r+a}return r},0)}function eKe(t){var e=QP(t);return e.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function tKe(t){var e=QP(t);return e.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Mo=tr([UA,QA,boe,YGe,JGe,ZGe,eKe,tKe,Hie,E$e],(t,e,r,n,a,s,o,l,c,u)=>{var d={left:(r.left||0)+a,right:(r.right||0)+s},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},A=w_(w_({},f),d),h=A.bottom;A.bottom+=n,A=kGe(A,c,u);var m=t-A.left-A.right,p=e-A.top-A.bottom;return w_(w_({brushBottom:h},A),{},{width:Math.max(m,0),height:Math.max(p,0)})}),rKe=tr(Mo,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),pM=tr(UA,QA,(t,e)=>({x:0,y:0,width:t,height:e})),nKe=g.createContext(null),zu=()=>g.useContext(nKe)!=null,HP=t=>t.brush,$P=tr([HP,Mo,boe],(t,e,r)=>({height:t.height,x:_n(t.x)?t.x:e.left,y:_n(t.y)?t.y:e.top+e.height+e.brushBottom-((r==null?void 0:r.bottom)||0),width:_n(t.width)?t.width:e.width})),Coe={},_oe={},Eoe={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n,{signal:a,edges:s}={}){let o,l=null;const c=s!=null&&s.includes("leading"),u=s==null||s.includes("trailing"),d=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{u&&d(),p()};let A=null;const h=()=>{A!=null&&clearTimeout(A),A=setTimeout(()=>{A=null,f()},n)},m=()=>{A!==null&&(clearTimeout(A),A=null)},p=()=>{m(),o=void 0,l=null},x=()=>{d()},v=function(...y){if(a!=null&&a.aborted)return;o=this,l=y;const b=A==null;h(),c&&b&&d()};return v.schedule=h,v.cancel=p,v.flush=x,a==null||a.addEventListener("abort",p,{once:!0}),v}t.debounce=e})(Eoe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Eoe;function r(n,a=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:c}=s,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let d,f=null;const A=e.debounce(function(...p){d=n.apply(this,p),f=null},a,{edges:u}),h=function(...p){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,p),f=Date.now(),A.cancel(),A.schedule(),d):(A.apply(this,p),d)},m=()=>(A.flush(),d);return h.cancel=A.cancel,h.flush=m,h}t.debounce=r})(_oe);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_oe;function r(n,a=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return e.debounce(n,a,{leading:o,maxWait:a,trailing:l})}t.throttle=r})(Coe);var aKe=Coe.throttle;const sKe=PA(aKe);var lK=function(e,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!e))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>a[o++]))}},Soe=(t,e,r)=>{var{width:n="100%",height:a="100%",aspect:s,maxHeight:o}=r,l=NA(n)?t:Number(n),c=NA(a)?e:Number(a);return s&&s>0&&(l?c=l/s:c&&(l=c*s),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},iKe={width:0,height:0,overflow:"visible"},oKe={width:0,overflowX:"visible"},lKe={height:0,overflowY:"visible"},cKe={},uKe=t=>{var{width:e,height:r}=t,n=NA(e),a=NA(r);return n&&a?iKe:n?oKe:a?lKe:cKe};function dKe(t){var{width:e,height:r,aspect:n}=t,a=e,s=r;return a===void 0&&s===void 0?(a="100%",s="100%"):a===void 0?a=n&&n>0?void 0:"100%":s===void 0&&(s=n&&n>0?void 0:"100%"),{width:a,height:s}}function VF(){return VF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},VF.apply(null,arguments)}function cK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function uK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cK(Object(r),!0).forEach(function(n){fKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fKe(t,e,r){return(e=hKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hKe(t){var e=AKe(t,"string");return typeof e=="symbol"?e:e+""}function AKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ioe=g.createContext({width:-1,height:-1});function mKe(t){return km(t.width)&&km(t.height)}function joe(t){var{children:e,width:r,height:n}=t,a=g.useMemo(()=>({width:r,height:n}),[r,n]);return mKe(a)?g.createElement(Ioe.Provider,{value:a},e):null}var gM=()=>g.useContext(Ioe),pKe=g.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:s,minWidth:o=0,minHeight:l,maxHeight:c,children:u,debounce:d=0,id:f,className:A,onResize:h,style:m={}}=t,p=g.useRef(null),x=g.useRef();x.current=h,g.useImperativeHandle(e,()=>p.current);var[v,y]=g.useState({containerWidth:n.width,containerHeight:n.height}),b=g.useCallback((S,E)=>{y(B=>{var k=Math.round(S),T=Math.round(E);return B.containerWidth===k&&B.containerHeight===T?B:{containerWidth:k,containerHeight:T}})},[]);g.useEffect(()=>{if(p.current==null||typeof ResizeObserver>"u")return Xw;var S=T=>{var P,{width:K,height:le}=T[0].contentRect;b(K,le),(P=x.current)===null||P===void 0||P.call(x,K,le)};d>0&&(S=sKe(S,d,{trailing:!0,leading:!1}));var E=new ResizeObserver(S),{width:B,height:k}=p.current.getBoundingClientRect();return b(B,k),E.observe(p.current),()=>{E.disconnect()}},[b,d]);var{containerWidth:w,containerHeight:j}=v;lK(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:I,calculatedHeight:C}=Soe(w,j,{width:a,height:s,aspect:r,maxHeight:c});return lK(I!=null&&I>0||C!=null&&C>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,I,C,a,s,o,l,r),g.createElement("div",{id:f?"".concat(f):void 0,className:as("recharts-responsive-container",A),style:uK(uK({},m),{},{width:a,height:s,minWidth:o,minHeight:l,maxHeight:c}),ref:p},g.createElement("div",{style:uKe({width:a,height:s})},g.createElement(joe,{width:I,height:C},u)))}),dK=g.forwardRef((t,e)=>{var r=gM();if(km(r.width)&&km(r.height))return t.children;var{width:n,height:a}=dKe({width:t.width,height:t.height,aspect:t.aspect}),{calculatedWidth:s,calculatedHeight:o}=Soe(void 0,void 0,{width:n,height:a,aspect:t.aspect,maxHeight:t.maxHeight});return _n(s)&&_n(o)?g.createElement(joe,{width:s,height:o},t.children):g.createElement(pKe,VF({},t,{width:n,height:a,ref:e}))});function Poe(t){if(t)return{x:t.x,y:t.y,upperWidth:"upperWidth"in t?t.upperWidth:t.width,lowerWidth:"lowerWidth"in t?t.lowerWidth:t.width,width:t.width,height:t.height}}var GP=()=>{var t,e=zu(),r=yn(rKe),n=yn($P),a=(t=yn(HP))===null||t===void 0?void 0:t.padding;return!e||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},gKe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},xKe=()=>{var t;return(t=yn(Mo))!==null&&t!==void 0?t:gKe},Toe=()=>yn(UA),Boe=()=>yn(QA),vKe=()=>yn(t=>t.layout.margin),Ba=t=>t.layout.layoutType,tN=()=>yn(Ba),yKe=()=>{var t=tN();return t!==void 0},KP=t=>{var e=_s(),r=zu(),{width:n,height:a}=t,s=gM(),o=n,l=a;return s&&(o=s.width>0?s.width:n,l=s.height>0?s.height:a),g.useEffect(()=>{!r&&km(o)&&km(l)&&e(SGe({width:o,height:l}))},[e,r,o,l]),null},koe=Symbol.for("immer-nothing"),fK=Symbol.for("immer-draftable"),Gu=Symbol.for("immer-state");function df(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var tw=Object.getPrototypeOf;function zv(t){return!!t&&!!t[Gu]}function _g(t){var e;return t?Foe(t)||Array.isArray(t)||!!t[fK]||!!((e=t.constructor)!=null&&e[fK])||rN(t)||zP(t):!1}var bKe=Object.prototype.constructor.toString(),hK=new WeakMap;function Foe(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=hK.get(r);return n===void 0&&(n=Function.toString.call(r),hK.set(r,n)),n===bKe}function _I(t,e,r=!0){qP(t)===0?(r?Reflect.ownKeys(t):Object.keys(t)).forEach(a=>{e(a,t[a],t)}):t.forEach((n,a)=>e(a,n,t))}function qP(t){const e=t[Gu];return e?e.type_:Array.isArray(t)?1:rN(t)?2:zP(t)?3:0}function HF(t,e){return qP(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Ooe(t,e,r){const n=qP(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function wKe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function rN(t){return t instanceof Map}function zP(t){return t instanceof Set}function pp(t){return t.copy_||t.base_}function $F(t,e){if(rN(t))return new Map(t);if(zP(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=Foe(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[Gu];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[o]})}return Object.create(tw(t),n)}else{const n=tw(t);if(n!==null&&r)return{...t};const a=Object.create(n);return Object.assign(a,t)}}function xM(t,e=!1){return WP(t)||zv(t)||!_g(t)||(qP(t)>1&&Object.defineProperties(t,{set:N_,add:N_,clear:N_,delete:N_}),Object.freeze(t),e&&Object.values(t).forEach(r=>xM(r,!0))),t}function NKe(){df(2)}var N_={value:NKe};function WP(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var CKe={};function Eg(t){const e=CKe[t];return e||df(0,t),e}var rw;function Doe(){return rw}function _Ke(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function AK(t,e){e&&(Eg("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function GF(t){KF(t),t.drafts_.forEach(EKe),t.drafts_=null}function KF(t){t===rw&&(rw=t.parent_)}function mK(t){return rw=_Ke(rw,t)}function EKe(t){const e=t[Gu];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function pK(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[Gu].modified_&&(GF(e),df(4)),_g(t)&&(t=EI(e,t),e.parent_||SI(e,t)),e.patches_&&Eg("Patches").generateReplacementPatches_(r[Gu].base_,t,e.patches_,e.inversePatches_)):t=EI(e,r,[]),GF(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==koe?t:void 0}function EI(t,e,r){if(WP(e))return e;const n=t.immer_.shouldUseStrictIteration(),a=e[Gu];if(!a)return _I(e,(s,o)=>gK(t,a,e,s,o,r),n),e;if(a.scope_!==t)return e;if(!a.modified_)return SI(t,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const s=a.copy_;let o=s,l=!1;a.type_===3&&(o=new Set(s),s.clear(),l=!0),_I(o,(c,u)=>gK(t,a,s,c,u,r,l),n),SI(t,s,!1),r&&t.patches_&&Eg("Patches").generatePatches_(a,r,t.patches_,t.inversePatches_)}return a.copy_}function gK(t,e,r,n,a,s,o){if(a==null||typeof a!="object"&&!o)return;const l=WP(a);if(!(l&&!o)){if(zv(a)){const c=s&&e&&e.type_!==3&&!HF(e.assigned_,n)?s.concat(n):void 0,u=EI(t,a,c);if(Ooe(r,n,u),zv(u))t.canAutoFreeze_=!1;else return}else o&&r.add(a);if(_g(a)&&!l){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[n]===a&&l)return;EI(t,a),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&(rN(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&SI(t,a)}}}function SI(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&xM(e,r)}function SKe(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:Doe(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,s=vM;r&&(a=[n],s=nw);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,l}var vM={get(t,e){if(e===Gu)return t;const r=pp(t);if(!HF(r,e))return IKe(t,r,e);const n=r[e];return t.finalized_||!_g(n)?n:n===vT(t.base_,e)?(yT(t),t.copy_[e]=zF(n,t)):n},has(t,e){return e in pp(t)},ownKeys(t){return Reflect.ownKeys(pp(t))},set(t,e,r){const n=Roe(pp(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const a=vT(pp(t),e),s=a==null?void 0:a[Gu];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(wKe(r,a)&&(r!==void 0||HF(t.base_,e)))return!0;yT(t),qF(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return vT(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,yT(t),qF(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=pp(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){df(11)},getPrototypeOf(t){return tw(t.base_)},setPrototypeOf(){df(12)}},nw={};_I(vM,(t,e)=>{nw[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});nw.deleteProperty=function(t,e){return nw.set.call(this,t,e,void 0)};nw.set=function(t,e,r){return vM.set.call(this,t[0],e,r,t[0])};function vT(t,e){const r=t[Gu];return(r?pp(r):t)[e]}function IKe(t,e,r){var a;const n=Roe(e,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(t.draft_):void 0}function Roe(t,e){if(!(e in t))return;let r=tw(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=tw(r)}}function qF(t){t.modified_||(t.modified_=!0,t.parent_&&qF(t.parent_))}function yT(t){t.copy_||(t.copy_=$F(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var jKe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const s=r;r=e;const o=this;return function(c=s,...u){return o.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&df(6),n!==void 0&&typeof n!="function"&&df(7);let a;if(_g(e)){const s=mK(this),o=zF(e,void 0);let l=!0;try{a=r(o),l=!1}finally{l?GF(s):KF(s)}return AK(s,n),pK(a,s)}else if(!e||typeof e!="object"){if(a=r(e),a===void 0&&(a=e),a===koe&&(a=void 0),this.autoFreeze_&&xM(a,!0),n){const s=[],o=[];Eg("Patches").generateReplacementPatches_(e,a,s,o),n(s,o)}return a}else df(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let n,a;return[this.produce(e,r,(o,l)=>{n=o,a=l}),n,a]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof(t==null?void 0:t.useStrictIteration)=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){_g(t)||df(8),zv(t)&&(t=PKe(t));const e=mK(this),r=zF(t,void 0);return r[Gu].isManual_=!0,KF(e),r}finishDraft(t,e){const r=t&&t[Gu];(!r||!r.isManual_)&&df(9);const{scope_:n}=r;return AK(n,e),pK(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const a=e[r];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}r>-1&&(e=e.slice(r+1));const n=Eg("Patches").applyPatches_;return zv(t)?n(t,e):this.produce(t,a=>n(a,e))}};function zF(t,e){const r=rN(t)?Eg("MapSet").proxyMap_(t,e):zP(t)?Eg("MapSet").proxySet_(t,e):SKe(t,e);return(e?e.scope_:Doe()).drafts_.push(r),r}function PKe(t){return zv(t)||df(10,t),Moe(t)}function Moe(t){if(!_g(t)||WP(t))return t;const e=t[Gu];let r,n=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=$F(t,e.scope_.immer_.useStrictShallowCopy_),n=e.scope_.immer_.shouldUseStrictIteration()}else r=$F(t,!0);return _I(r,(a,s)=>{Ooe(r,a,Moe(s))},n),e&&(e.finalized_=!1),r}var TKe=new jKe;TKe.produce;var BKe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},Loe=fu({name:"legend",initialState:BKe,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload:{reducer(t,e){t.payload.push(e.payload)},prepare:Qs()},replaceLegendPayload:{reducer(t,e){var{prev:r,next:n}=e.payload,a=yf(t).payload.indexOf(r);a>-1&&(t.payload[a]=n)},prepare:Qs()},removeLegendPayload:{reducer(t,e){var r=yf(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)},prepare:Qs()}}}),{setLegendSize:xK,setLegendSettings:kKe,addLegendPayload:Uoe,replaceLegendPayload:Qoe,removeLegendPayload:Voe}=Loe.actions,FKe=Loe.reducer,OKe=["contextPayload"];function WF(){return WF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},WF.apply(null,arguments)}function vK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Wv(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vK(Object(r),!0).forEach(function(n){DKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function DKe(t,e,r){return(e=RKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RKe(t){var e=MKe(t,"string");return typeof e=="symbol"?e:e+""}function MKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function LKe(t,e){if(t==null)return{};var r,n,a=UKe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function UKe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function QKe(t){return t.value}function VKe(t){var{contextPayload:e}=t,r=LKe(t,OKe),n=Bie(e,t.payloadUniqBy,QKe),a=Wv(Wv({},r),{},{payload:n});return g.isValidElement(t.content)?g.cloneElement(t.content,a):typeof t.content=="function"?g.createElement(t.content,a):g.createElement(GHe,a)}function HKe(t,e,r,n,a,s){var{layout:o,align:l,verticalAlign:c}=e,u,d;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(l==="center"&&o==="vertical"?u={left:((n||0)-s.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(c==="middle"?d={top:((a||0)-s.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Wv(Wv({},u),d)}function $Ke(t){var e=_s();return g.useEffect(()=>{e(kKe(t))},[e,t]),null}function GKe(t){var e=_s();return g.useEffect(()=>(e(xK(t)),()=>{e(xK({width:0,height:0}))}),[e,t]),null}function KKe(t,e,r,n){return t==="vertical"&&_n(e)?{height:e}:t==="horizontal"?{width:r||n}:null}var qKe={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function XF(t){var e=Fl(t,qKe),r=j$e(),n=RVe(),a=vKe(),{width:s,height:o,wrapperStyle:l,portal:c}=e,[u,d]=$ie([r]),f=Toe(),A=Boe();if(f==null||A==null)return null;var h=f-((a==null?void 0:a.left)||0)-((a==null?void 0:a.right)||0),m=KKe(e.layout,o,s,h),p=c?l:Wv(Wv({position:"absolute",width:(m==null?void 0:m.width)||s||"auto",height:(m==null?void 0:m.height)||o||"auto"},HKe(l,e,a,f,A,u)),l),x=c??n;if(x==null||r==null)return null;var v=g.createElement("div",{className:"recharts-legend-wrapper",style:p,ref:d},g.createElement($Ke,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),!c&&g.createElement(GKe,{width:u.width,height:u.height}),g.createElement(VKe,WF({},e,m,{margin:a,chartWidth:f,chartHeight:A,contextPayload:r})));return Lu.createPortal(v,x)}XF.displayName="Legend";function YF(){return YF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},YF.apply(null,arguments)}function yK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function bT(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yK(Object(r),!0).forEach(function(n){zKe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function zKe(t,e,r){return(e=WKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WKe(t){var e=XKe(t,"string");return typeof e=="symbol"?e:e+""}function XKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YKe(t){return Array.isArray(t)&&fh(t[0])&&fh(t[1])?t.join(" ~ "):t}var JKe=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:s,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:A=!1}=t,h=()=>{if(s&&s.length){var j={padding:0,margin:0},I=(l?PP(s,l):s).map((C,S)=>{if(C.type==="none")return null;var E=C.formatter||o||YKe,{value:B,name:k}=C,T=B,P=k;if(E){var K=E(B,k,C,S,s);if(Array.isArray(K))[T,P]=K;else if(K!=null)T=K;else return null}var le=bT({display:"block",paddingTop:4,paddingBottom:4,color:C.color||"#000"},n);return g.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(S),style:le},fh(P)?g.createElement("span",{className:"recharts-tooltip-item-name"},P):null,fh(P)?g.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,g.createElement("span",{className:"recharts-tooltip-item-value"},T),g.createElement("span",{className:"recharts-tooltip-item-unit"},C.unit||""))});return g.createElement("ul",{className:"recharts-tooltip-item-list",style:j},I)}return null},m=bT({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),p=bT({margin:0},a),x=!il(d),v=x?d:"",y=as("recharts-default-tooltip",c),b=as("recharts-tooltip-label",u);x&&f&&s!==void 0&&s!==null&&(v=f(d,s));var w=A?{role:"status","aria-live":"assertive"}:{};return g.createElement("div",YF({className:y,style:m},w),g.createElement("p",{className:b,style:p},g.isValidElement(v)?v:"".concat(v)),h())},_y="recharts-tooltip-wrapper",ZKe={visibility:"hidden"};function eqe(t){var{coordinate:e,translateX:r,translateY:n}=t;return as(_y,{["".concat(_y,"-right")]:_n(r)&&e&&_n(e.x)&&r>=e.x,["".concat(_y,"-left")]:_n(r)&&e&&_n(e.x)&&r<e.x,["".concat(_y,"-bottom")]:_n(n)&&e&&_n(e.y)&&n>=e.y,["".concat(_y,"-top")]:_n(n)&&e&&_n(e.y)&&n<e.y})}function bK(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:a,position:s,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=t;if(s&&_n(s[n]))return s[n];var d=r[n]-l-(a>0?a:0),f=r[n]+a;if(e[n])return o[n]?d:f;var A=c[n];if(A==null)return 0;if(o[n]){var h=d,m=A;return h<m?Math.max(f,A):Math.max(d,A)}if(u==null)return 0;var p=f+l,x=A+u;return p>x?Math.max(d,A):Math.max(f,A)}function tqe(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function rqe(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:s,tooltipBox:o,useTranslate3d:l,viewBox:c}=t,u,d,f;return o.height>0&&o.width>0&&r?(d=bK({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),f=bK({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=tqe({translateX:d,translateY:f,useTranslate3d:l})):u=ZKe,{cssProperties:u,cssClasses:eqe({translateX:d,translateY:f,coordinate:r})}}function wK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function C_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wK(Object(r),!0).forEach(function(n){JF(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function JF(t,e,r){return(e=nqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nqe(t){var e=aqe(t,"string");return typeof e=="symbol"?e:e+""}function aqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sqe extends g.PureComponent{constructor(){super(...arguments),JF(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),JF(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,a,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:s,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:A,viewBox:h,wrapperStyle:m,lastBoundingBox:p,innerRef:x,hasPortalFromProps:v}=this.props,{cssClasses:y,cssProperties:b}=rqe({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:u,position:d,reverseDirection:f,tooltipBox:{height:p.height,width:p.width},useTranslate3d:A,viewBox:h}),w=v?{}:C_(C_({transition:c&&e?"transform ".concat(n,"ms ").concat(a):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&l?"visible":"hidden",position:"absolute",top:0,left:0}),j=C_(C_({},w),{},{visibility:!this.state.dismissed&&e&&l?"visible":"hidden"},m);return g.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:j,ref:x},s)}}var Hoe=()=>{var t;return(t=yn(e=>e.rootProps.accessibilityLayer))!==null&&t!==void 0?t:!0};function ZF(){return ZF=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ZF.apply(null,arguments)}function NK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function CK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?NK(Object(r),!0).forEach(function(n){iqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):NK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function iqe(t,e,r){return(e=oqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oqe(t){var e=lqe(t,"string");return typeof e=="symbol"?e:e+""}function lqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _K={curveBasisClosed:rHe,curveBasisOpen:nHe,curveBasis:tHe,curveBumpX:QVe,curveBumpY:VVe,curveLinearClosed:aHe,curveLinear:NP,curveMonotoneX:sHe,curveMonotoneY:iHe,curveNatural:oHe,curveStep:lHe,curveStepAfter:uHe,curveStepBefore:cHe},II=t=>pi(t.x)&&pi(t.y),EK=t=>t.base!=null&&II(t.base)&&II(t),Ey=t=>t.x,Sy=t=>t.y,cqe=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(Ww(t));return(r==="curveMonotone"||r==="curveBump")&&e?_K["".concat(r).concat(e==="vertical"?"Y":"X")]:_K[r]||NP},uqe=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:a,connectNulls:s=!1}=t,o=cqe(e,a),l=s?r.filter(II):r,c;if(Array.isArray(n)){var u=r.map((h,m)=>CK(CK({},h),{},{base:n[m]}));a==="vertical"?c=p_().y(Sy).x1(Ey).x0(h=>h.base.x):c=p_().x(Ey).y1(Sy).y0(h=>h.base.y);var d=c.defined(EK).curve(o),f=s?u.filter(EK):u;return d(f)}a==="vertical"&&_n(n)?c=p_().y(Sy).x1(Ey).x0(n):_n(n)?c=p_().x(Ey).y1(Sy).y0(n):c=Zse().x(Ey).y(Sy);var A=c.defined(II).curve(o);return A(l)},yM=t=>{var{className:e,points:r,path:n,pathRef:a}=t,s=tN();if((!r||!r.length)&&!n)return null;var o={type:t.type,points:t.points,baseLine:t.baseLine,layout:t.layout||s,connectNulls:t.connectNulls},l=r&&r.length?uqe(o):n;return g.createElement("path",ZF({},uh(t),BHe(t),{className:as("recharts-curve",e),d:l===null?void 0:l,ref:a}))},dqe=["x","y","top","left","width","height","className"];function eO(){return eO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},eO.apply(null,arguments)}function SK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function fqe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?SK(Object(r),!0).forEach(function(n){hqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):SK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hqe(t,e,r){return(e=Aqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Aqe(t){var e=mqe(t,"string");return typeof e=="symbol"?e:e+""}function mqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pqe(t,e){if(t==null)return{};var r,n,a=gqe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function gqe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var xqe=(t,e,r,n,a,s)=>"M".concat(t,",").concat(a,"v").concat(n,"M").concat(s,",").concat(e,"h").concat(r),vqe=t=>{var{x:e=0,y:r=0,top:n=0,left:a=0,width:s=0,height:o=0,className:l}=t,c=pqe(t,dqe),u=fqe({x:e,y:r,top:n,left:a,width:s,height:o},c);return!_n(e)||!_n(r)||!_n(s)||!_n(o)||!_n(n)||!_n(a)?null:g.createElement("path",eO({},Rd(u),{className:as("recharts-cross",l),d:xqe(e,r,s,o,n,a)}))};function yqe(t,e,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-a:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-a,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function IK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function jK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?IK(Object(r),!0).forEach(function(n){bqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):IK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bqe(t,e,r){return(e=wqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wqe(t){var e=Nqe(t,"string");return typeof e=="symbol"?e:e+""}function Nqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Cqe=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),$oe=(t,e,r)=>t.map(n=>"".concat(Cqe(n)," ").concat(e,"ms ").concat(r)).join(","),_qe=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(a=>n.includes(a))),aw=(t,e)=>Object.keys(e).reduce((r,n)=>jK(jK({},r),{},{[n]:t(n,e[n])}),{});function PK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Io(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?PK(Object(r),!0).forEach(function(n){Eqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):PK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Eqe(t,e,r){return(e=Sqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sqe(t){var e=Iqe(t,"string");return typeof e=="symbol"?e:e+""}function Iqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jI=(t,e,r)=>t+(e-t)*r,tO=t=>{var{from:e,to:r}=t;return e!==r},Goe=(t,e,r)=>{var n=aw((a,s)=>{if(tO(s)){var[o,l]=t(s.from,s.to,s.velocity);return Io(Io({},s),{},{from:o,velocity:l})}return s},e);return r<1?aw((a,s)=>tO(s)&&n[a]!=null?Io(Io({},s),{},{velocity:jI(s.velocity,n[a].velocity,r),from:jI(s.from,n[a].from,r)}):s,e):Goe(t,n,r-1)};function jqe(t,e,r,n,a,s){var o,l=n.reduce((A,h)=>Io(Io({},A),{},{[h]:{from:t[h],velocity:0,to:e[h]}}),{}),c=()=>aw((A,h)=>h.from,l),u=()=>!Object.values(l).filter(tO).length,d=null,f=A=>{o||(o=A);var h=A-o,m=h/r.dt;l=Goe(r,l,m),a(Io(Io(Io({},t),e),c())),o=A,u()||(d=s.setTimeout(f))};return()=>(d=s.setTimeout(f),()=>{var A;(A=d)===null||A===void 0||A()})}function Pqe(t,e,r,n,a,s,o){var l=null,c=a.reduce((f,A)=>{var h=t[A],m=e[A];return h==null||m==null?f:Io(Io({},f),{},{[A]:[h,m]})},{}),u,d=f=>{u||(u=f);var A=(f-u)/n,h=aw((p,x)=>jI(...x,r(A)),c);if(s(Io(Io(Io({},t),e),h)),A<1)l=o.setTimeout(d);else{var m=aw((p,x)=>jI(...x,r(1)),c);s(Io(Io(Io({},t),e),m))}};return()=>(l=o.setTimeout(d),()=>{var f;(f=l)===null||f===void 0||f()})}const Tqe=(t,e,r,n,a,s)=>{var o=_qe(t,e);return r==null?()=>(a(Io(Io({},t),e)),()=>{}):r.isStepper===!0?jqe(t,e,r,o,a,s):Pqe(t,e,r,n,o,a,s)};var PI=1e-4,Koe=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],qoe=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),TK=(t,e)=>r=>{var n=Koe(t,e);return qoe(n,r)},Bqe=(t,e)=>r=>{var n=Koe(t,e),a=[...n.map((s,o)=>s*o).slice(1),0];return qoe(a,r)},kqe=t=>{var e,r=t.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(e=r[1])===null||e===void 0||(e=e.split(")")[0])===null||e===void 0?void 0:e.split(",");if(n==null||n.length!==4)return null;var a=n.map(s=>parseFloat(s));return[a[0],a[1],a[2],a[3]]},Fqe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=kqe(r[0]);if(a)return a}}return r.length===4?r:[0,0,1,1]},Oqe=(t,e,r,n)=>{var a=TK(t,r),s=TK(e,n),o=Bqe(t,r),l=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,f=d,A=0;A<8;++A){var h=a(f)-d,m=o(f);if(Math.abs(h-d)<PI||m<PI)return s(f);f=l(f-h/m)}return s(f)};return c.isStepper=!1,c},BK=function(){return Oqe(...Fqe(...arguments))},Dqe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=e,s=(o,l,c)=>{var u=-(o-l)*r,d=c*n,f=c+(u-d)*a/1e3,A=c*a/1e3+o;return Math.abs(A-l)<PI&&Math.abs(f)<PI?[l,0]:[A,f]};return s.isStepper=!0,s.dt=a,s},Rqe=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return BK(t);case"spring":return Dqe();default:if(t.split("(")[0]==="cubic-bezier")return BK(t)}return typeof t=="function"?t:null};function Mqe(t){var e,r=()=>null,n=!1,a=null,s=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){a=t.setTimeout(s.bind(null,u),c);return}s(c),a=t.setTimeout(s.bind(null,u));return}typeof o=="string"&&(e=o,r(e)),typeof o=="object"&&(e=o,r(e)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,a&&(a(),a=null),s(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>t}}class Lqe{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,s=o=>{o-n>=r?e(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(s))};return a=requestAnimationFrame(s),()=>{a!=null&&cancelAnimationFrame(a)}}}function Uqe(){return Mqe(new Lqe)}var Qqe=g.createContext(Uqe);function Vqe(t,e){var r=g.useContext(Qqe);return g.useMemo(()=>e??r(t),[t,e,r])}var Hqe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),XP={isSsr:Hqe()},$qe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},kK={t:0},wT={t:1};function YP(t){var e=Fl(t,$qe),{isActive:r,canBegin:n,duration:a,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=e,d=r==="auto"?!XP.isSsr:r,f=Vqe(e.animationId,e.animationManager),[A,h]=g.useState(d?kK:wT),m=g.useRef(null);return g.useEffect(()=>{d||h(wT)},[d]),g.useEffect(()=>{if(!d||!n)return Xw;var p=Tqe(kK,wT,Rqe(s),a,h,f.getTimeoutController()),x=()=>{m.current=p()};return f.start([c,o,x,a,l]),()=>{f.stop(),m.current&&m.current(),l()}},[d,n,a,s,o,c,l,f]),u(A.t)}function JP(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=g.useRef(Y2(e)),n=g.useRef(t);return n.current!==t&&(r.current=Y2(e),n.current=t),r.current}var Gqe=["radius"],Kqe=["radius"],FK,OK,DK,RK,MK,LK,UK,QK,VK,HK;function $K(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function GK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$K(Object(r),!0).forEach(function(n){qqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$K(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qqe(t,e,r){return(e=zqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zqe(t){var e=Wqe(t,"string");return typeof e=="symbol"?e:e+""}function Wqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TI(){return TI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},TI.apply(null,arguments)}function KK(t,e){if(t==null)return{};var r,n,a=Xqe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Xqe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Vf(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var qK=(t,e,r,n,a)=>{var s=Z0(r),o=Z0(n),l=Math.min(Math.abs(s)/2,Math.abs(o)/2),c=o>=0?1:-1,u=s>=0?1:-1,d=o>=0&&s>=0||o<0&&s<0?1:0,f;if(l>0&&a instanceof Array){for(var A=[0,0,0,0],h=0,m=4;h<m;h++)A[h]=a[h]>l?l:a[h];f=_i(FK||(FK=Vf(["M",",",""])),t,e+c*A[0]),A[0]>0&&(f+=_i(OK||(OK=Vf(["A ",",",",0,0,",",",",",""])),A[0],A[0],d,t+u*A[0],e)),f+=_i(DK||(DK=Vf(["L ",",",""])),t+r-u*A[1],e),A[1]>0&&(f+=_i(RK||(RK=Vf(["A ",",",",0,0,",`,
        `,",",""])),A[1],A[1],d,t+r,e+c*A[1])),f+=_i(MK||(MK=Vf(["L ",",",""])),t+r,e+n-c*A[2]),A[2]>0&&(f+=_i(LK||(LK=Vf(["A ",",",",0,0,",`,
        `,",",""])),A[2],A[2],d,t+r-u*A[2],e+n)),f+=_i(UK||(UK=Vf(["L ",",",""])),t+u*A[3],e+n),A[3]>0&&(f+=_i(QK||(QK=Vf(["A ",",",",0,0,",`,
        `,",",""])),A[3],A[3],d,t,e+n-c*A[3])),f+="Z"}else if(l>0&&a===+a&&a>0){var p=Math.min(l,a);f=_i(VK||(VK=Vf(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),t,e+c*p,p,p,d,t+u*p,e,t+r-u*p,e,p,p,d,t+r,e+c*p,t+r,e+n-c*p,p,p,d,t+r-u*p,e+n,t+u*p,e+n,p,p,d,t,e+n-c*p)}else f=_i(HK||(HK=Vf(["M ",","," h "," v "," h "," Z"])),t,e,r,n,-r);return f},zK={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},zoe=t=>{var e=Fl(t,zK),r=g.useRef(null),[n,a]=g.useState(-1);g.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var ie=r.current.getTotalLength();ie&&a(ie)}catch{}},[]);var{x:s,y:o,width:l,height:c,radius:u,className:d}=e,{animationEasing:f,animationDuration:A,animationBegin:h,isAnimationActive:m,isUpdateAnimationActive:p}=e,x=g.useRef(l),v=g.useRef(c),y=g.useRef(s),b=g.useRef(o),w=g.useMemo(()=>({x:s,y:o,width:l,height:c,radius:u}),[s,o,l,c,u]),j=JP(w,"rectangle-");if(s!==+s||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var I=as("recharts-rectangle",d);if(!p){var C=Rd(e),{radius:S}=C,E=KK(C,Gqe);return g.createElement("path",TI({},E,{x:Z0(s),y:Z0(o),width:Z0(l),height:Z0(c),radius:typeof u=="number"?u:void 0,className:I,d:qK(s,o,l,c,u)}))}var B=x.current,k=v.current,T=y.current,P=b.current,K="0px ".concat(n===-1?1:n,"px"),le="".concat(n,"px 0px"),oe=$oe(["strokeDasharray"],A,typeof f=="string"?f:zK.animationEasing);return g.createElement(YP,{animationId:j,key:j,canBegin:n>0,duration:A,easing:f,isActive:p,begin:h},ie=>{var Ae=So(B,l,ie),te=So(k,c,ie),Te=So(T,s,ie),Ue=So(P,o,ie);r.current&&(x.current=Ae,v.current=te,y.current=Te,b.current=Ue);var O;m?ie>0?O={transition:oe,strokeDasharray:le}:O={strokeDasharray:K}:O={strokeDasharray:le};var H=Rd(e),{radius:G}=H,L=KK(H,Kqe);return g.createElement("path",TI({},L,{radius:typeof u=="number"?u:void 0,className:I,d:qK(Te,Ue,Ae,te,u),ref:r,style:GK(GK({},O),e.style)}))})};function WK(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function XK(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?WK(Object(r),!0).forEach(function(n){Yqe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):WK(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Yqe(t,e,r){return(e=Jqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Jqe(t){var e=Zqe(t,"string");return typeof e=="symbol"?e:e+""}function Zqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var BI=Math.PI/180,eze=t=>t*180/Math.PI,co=(t,e,r,n)=>({x:t+Math.cos(-BI*n)*r,y:e+Math.sin(-BI*n)*r}),Woe=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},tze=(t,e)=>{var{x:r,y:n}=t,{x:a,y:s}=e;return Math.sqrt((r-a)**2+(n-s)**2)},rze=(t,e)=>{var{x:r,y:n}=t,{cx:a,cy:s}=e,o=tze({x:r,y:n},{x:a,y:s});if(o<=0)return{radius:o,angle:0};var l=(r-a)/o,c=Math.acos(l);return n>s&&(c=2*Math.PI-c),{radius:o,angle:eze(c),angleInRadian:c}},nze=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),a=Math.floor(r/360),s=Math.min(n,a);return{startAngle:e-s*360,endAngle:r-s*360}},aze=(t,e)=>{var{startAngle:r,endAngle:n}=e,a=Math.floor(r/360),s=Math.floor(n/360),o=Math.min(a,s);return t+o*360},sze=(t,e)=>{var{chartX:r,chartY:n}=t,{radius:a,angle:s}=rze({x:r,y:n},e),{innerRadius:o,outerRadius:l}=e;if(a<o||a>l||a===0)return null;var{startAngle:c,endAngle:u}=nze(e),d=s,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?XK(XK({},e),{},{radius:a,angle:aze(d,e)}):null};function Xoe(t){var{cx:e,cy:r,radius:n,startAngle:a,endAngle:s}=t,o=co(e,r,n,a),l=co(e,r,n,s);return{points:[o,l],cx:e,cy:r,radius:n,startAngle:a,endAngle:s}}var YK,JK,ZK,eq,tq,rq,nq;function rO(){return rO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},rO.apply(null,arguments)}function Bp(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var ize=(t,e)=>{var r=Tl(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},__=t=>{var{cx:e,cy:r,radius:n,angle:a,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:c}=t,u=l*(o?1:-1)+n,d=Math.asin(l/u)/BI,f=c?a:a+s*d,A=co(e,r,u,f),h=co(e,r,n,f),m=c?a-s*d:a,p=co(e,r,u*Math.cos(d*BI),m);return{center:A,circleTangency:h,lineTangency:p,theta:d}},Yoe=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:s,endAngle:o}=t,l=ize(s,o),c=s+l,u=co(e,r,a,s),d=co(e,r,a,c),f=_i(YK||(YK=Bp(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,a,a,+(Math.abs(l)>180),+(s>c),d.x,d.y);if(n>0){var A=co(e,r,n,s),h=co(e,r,n,c);f+=_i(JK||(JK=Bp(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),h.x,h.y,n,n,+(Math.abs(l)>180),+(s<=c),A.x,A.y)}else f+=_i(ZK||(ZK=Bp(["L ",","," Z"])),e,r);return f},oze=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=t,d=Tl(u-c),{circleTangency:f,lineTangency:A,theta:h}=__({cx:e,cy:r,radius:a,angle:c,sign:d,cornerRadius:s,cornerIsExternal:l}),{circleTangency:m,lineTangency:p,theta:x}=__({cx:e,cy:r,radius:a,angle:u,sign:-d,cornerRadius:s,cornerIsExternal:l}),v=l?Math.abs(c-u):Math.abs(c-u)-h-x;if(v<0)return o?_i(eq||(eq=Bp(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),A.x,A.y,s,s,s*2,s,s,-s*2):Yoe({cx:e,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:u});var y=_i(tq||(tq=Bp(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),A.x,A.y,s,s,+(d<0),f.x,f.y,a,a,+(v>180),+(d<0),m.x,m.y,s,s,+(d<0),p.x,p.y);if(n>0){var{circleTangency:b,lineTangency:w,theta:j}=__({cx:e,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:I,lineTangency:C,theta:S}=__({cx:e,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),E=l?Math.abs(c-u):Math.abs(c-u)-j-S;if(E<0&&s===0)return"".concat(y,"L").concat(e,",").concat(r,"Z");y+=_i(rq||(rq=Bp(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),C.x,C.y,s,s,+(d<0),I.x,I.y,n,n,+(E>180),+(d>0),b.x,b.y,s,s,+(d<0),w.x,w.y)}else y+=_i(nq||(nq=Bp(["L",",","Z"])),e,r);return y},lze={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Joe=t=>{var e=Fl(t,lze),{cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=e;if(s<a||u===d)return null;var A=as("recharts-sector",f),h=s-a,m=oc(o,h,0,!0),p;return m>0&&Math.abs(u-d)<360?p=oze({cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:Math.min(m,h/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):p=Yoe({cx:r,cy:n,innerRadius:a,outerRadius:s,startAngle:u,endAngle:d}),g.createElement("path",rO({},Rd(e),{className:A,d:p}))};function cze(t,e,r){if(t==="horizontal")return[{x:e.x,y:r.top},{x:e.x,y:r.top+r.height}];if(t==="vertical")return[{x:r.left,y:e.y},{x:r.left+r.width,y:e.y}];if(Aie(e)){if(t==="centric"){var{cx:n,cy:a,innerRadius:s,outerRadius:o,angle:l}=e,c=co(n,a,s,l),u=co(n,a,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return Xoe(e)}}var Zoe={},ele={},tle={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=lM;function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(tle);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=tle;function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(ele);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=cM,r=ele;function n(a,s,o){o&&typeof o!="number"&&e.isIterateeCall(a,s,o)&&(s=o=void 0),a=r.toFinite(a),s===void 0?(s=a,a=0):s=r.toFinite(s),o=o===void 0?a<s?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((s-a)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=a,a+=o;return c}t.range=n})(Zoe);var uze=Zoe.range;const rle=PA(uze);function gm(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function dze(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function bM(t){let e,r,n;t.length!==2?(e=gm,r=(l,c)=>gm(t(l),c),n=(l,c)=>t(l)-c):(e=t===gm||t===dze?t:fze,r=t,n=t);function a(l,c,u=0,d=l.length){if(u<d){if(e(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){if(u<d){if(e(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function o(l,c,u=0,d=l.length){const f=a(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:o,right:s}}function fze(){return 0}function nle(t){return t===null?NaN:+t}function*hze(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const Aze=bM(gm),nN=Aze.right;bM(nle).center;class aq extends Map{constructor(e,r=gze){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,a]of e)this.set(n,a)}get(e){return super.get(sq(this,e))}has(e){return super.has(sq(this,e))}set(e,r){return super.set(mze(this,e),r)}delete(e){return super.delete(pze(this,e))}}function sq({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function mze({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function pze({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function gze(t){return t!==null&&typeof t=="object"?t.valueOf():t}function xze(t=gm){if(t===gm)return ale;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function ale(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const vze=Math.sqrt(50),yze=Math.sqrt(10),bze=Math.sqrt(2);function kI(t,e,r){const n=(e-t)/Math.max(0,r),a=Math.floor(Math.log10(n)),s=n/Math.pow(10,a),o=s>=vze?10:s>=yze?5:s>=bze?2:1;let l,c,u;return a<0?(u=Math.pow(10,-a)/o,l=Math.round(t*u),c=Math.round(e*u),l/u<t&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,a)*o,l=Math.round(t/u),c=Math.round(e/u),l*u<t&&++l,c*u>e&&--c),c<l&&.5<=r&&r<2?kI(t,e,r*2):[l,c,u]}function nO(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[a,s,o]=n?kI(e,t,r):kI(t,e,r);if(!(s>=a))return[];const l=s-a+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(s-u)/-o;else for(let u=0;u<l;++u)c[u]=(s-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(a+u)/-o;else for(let u=0;u<l;++u)c[u]=(a+u)*o;return c}function aO(t,e,r){return e=+e,t=+t,r=+r,kI(t,e,r)[2]}function sO(t,e,r){e=+e,t=+t,r=+r;const n=e<t,a=n?aO(e,t,r):aO(t,e,r);return(n?-1:1)*(a<0?1/-a:a)}function iq(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function oq(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function sle(t,e,r=0,n=1/0,a){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(a=a===void 0?ale:xze(a);n>r;){if(n-r>600){const c=n-r+1,u=e-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),A=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),h=Math.max(r,Math.floor(e-u*f/c+A)),m=Math.min(n,Math.floor(e+(c-u)*f/c+A));sle(t,e,h,m,a)}const s=t[e];let o=r,l=n;for(Iy(t,r,e),a(t[n],s)>0&&Iy(t,r,n);o<l;){for(Iy(t,o,l),++o,--l;a(t[o],s)<0;)++o;for(;a(t[l],s)>0;)--l}a(t[r],s)===0?Iy(t,r,l):(++l,Iy(t,l,n)),l<=e&&(r=l+1),e<=l&&(n=l-1)}return t}function Iy(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function wze(t,e,r){if(t=Float64Array.from(hze(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return oq(t);if(e>=1)return iq(t);var n,a=(n-1)*e,s=Math.floor(a),o=iq(sle(t,s).subarray(0,s+1)),l=oq(t.subarray(s+1));return o+(l-o)*(a-s)}}function Nze(t,e,r=nle){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,a=(n-1)*e,s=Math.floor(a),o=+r(t[s],s,t),l=+r(t[s+1],s+1,t);return o+(l-o)*(a-s)}}function Cze(t,e,r){t=+t,e=+e,r=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((e-t)/r))|0,s=new Array(a);++n<a;)s[n]=t+n*r;return s}function Hd(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function VA(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const iO=Symbol("implicit");function wM(){var t=new aq,e=[],r=[],n=iO;function a(s){let o=t.get(s);if(o===void 0){if(n!==iO)return n;t.set(s,o=e.push(s)-1)}return r[o%r.length]}return a.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new aq;for(const o of s)t.has(o)||t.set(o,e.push(o)-1);return a},a.range=function(s){return arguments.length?(r=Array.from(s),a):r.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return wM(e,r).unknown(n)},Hd.apply(a,arguments),a}function NM(){var t=wM().unknown(void 0),e=t.domain,r=t.range,n=0,a=1,s,o,l=!1,c=0,u=0,d=.5;delete t.unknown;function f(){var A=e().length,h=a<n,m=h?a:n,p=h?n:a;s=(p-m)/Math.max(1,A-c+u*2),l&&(s=Math.floor(s)),m+=(p-m-s*(A-c))*d,o=s*(1-c),l&&(m=Math.round(m),o=Math.round(o));var x=Cze(A).map(function(v){return m+s*v});return r(h?x.reverse():x)}return t.domain=function(A){return arguments.length?(e(A),f()):e()},t.range=function(A){return arguments.length?([n,a]=A,n=+n,a=+a,f()):[n,a]},t.rangeRound=function(A){return[n,a]=A,n=+n,a=+a,l=!0,f()},t.bandwidth=function(){return o},t.step=function(){return s},t.round=function(A){return arguments.length?(l=!!A,f()):l},t.padding=function(A){return arguments.length?(c=Math.min(1,u=+A),f()):c},t.paddingInner=function(A){return arguments.length?(c=Math.min(1,A),f()):c},t.paddingOuter=function(A){return arguments.length?(u=+A,f()):u},t.align=function(A){return arguments.length?(d=Math.max(0,Math.min(1,A)),f()):d},t.copy=function(){return NM(e(),[n,a]).round(l).paddingInner(c).paddingOuter(u).align(d)},Hd.apply(f(),arguments)}function ile(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return ile(e())},t}function _ze(){return ile(NM.apply(null,arguments).paddingInner(1))}function CM(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function ole(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function aN(){}var sw=.7,FI=1/sw,wv="\\s*([+-]?\\d+)\\s*",iw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",oh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Eze=/^#([0-9a-f]{3,8})$/,Sze=new RegExp(`^rgb\\(${wv},${wv},${wv}\\)$`),Ize=new RegExp(`^rgb\\(${oh},${oh},${oh}\\)$`),jze=new RegExp(`^rgba\\(${wv},${wv},${wv},${iw}\\)$`),Pze=new RegExp(`^rgba\\(${oh},${oh},${oh},${iw}\\)$`),Tze=new RegExp(`^hsl\\(${iw},${oh},${oh}\\)$`),Bze=new RegExp(`^hsla\\(${iw},${oh},${oh},${iw}\\)$`),lq={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};CM(aN,ow,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:cq,formatHex:cq,formatHex8:kze,formatHsl:Fze,formatRgb:uq,toString:uq});function cq(){return this.rgb().formatHex()}function kze(){return this.rgb().formatHex8()}function Fze(){return lle(this).formatHsl()}function uq(){return this.rgb().formatRgb()}function ow(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=Eze.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?dq(e):r===3?new au(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?E_(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?E_(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Sze.exec(t))?new au(e[1],e[2],e[3],1):(e=Ize.exec(t))?new au(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=jze.exec(t))?E_(e[1],e[2],e[3],e[4]):(e=Pze.exec(t))?E_(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Tze.exec(t))?Aq(e[1],e[2]/100,e[3]/100,1):(e=Bze.exec(t))?Aq(e[1],e[2]/100,e[3]/100,e[4]):lq.hasOwnProperty(t)?dq(lq[t]):t==="transparent"?new au(NaN,NaN,NaN,0):null}function dq(t){return new au(t>>16&255,t>>8&255,t&255,1)}function E_(t,e,r,n){return n<=0&&(t=e=r=NaN),new au(t,e,r,n)}function Oze(t){return t instanceof aN||(t=ow(t)),t?(t=t.rgb(),new au(t.r,t.g,t.b,t.opacity)):new au}function oO(t,e,r,n){return arguments.length===1?Oze(t):new au(t,e,r,n??1)}function au(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}CM(au,oO,ole(aN,{brighter(t){return t=t==null?FI:Math.pow(FI,t),new au(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?sw:Math.pow(sw,t),new au(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new au(Xp(this.r),Xp(this.g),Xp(this.b),OI(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fq,formatHex:fq,formatHex8:Dze,formatRgb:hq,toString:hq}));function fq(){return`#${kp(this.r)}${kp(this.g)}${kp(this.b)}`}function Dze(){return`#${kp(this.r)}${kp(this.g)}${kp(this.b)}${kp((isNaN(this.opacity)?1:this.opacity)*255)}`}function hq(){const t=OI(this.opacity);return`${t===1?"rgb(":"rgba("}${Xp(this.r)}, ${Xp(this.g)}, ${Xp(this.b)}${t===1?")":`, ${t})`}`}function OI(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Xp(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function kp(t){return t=Xp(t),(t<16?"0":"")+t.toString(16)}function Aq(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new ff(t,e,r,n)}function lle(t){if(t instanceof ff)return new ff(t.h,t.s,t.l,t.opacity);if(t instanceof aN||(t=ow(t)),!t)return new ff;if(t instanceof ff)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),s=Math.max(e,r,n),o=NaN,l=s-a,c=(s+a)/2;return l?(e===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-e)/l+2:o=(e-r)/l+4,l/=c<.5?s+a:2-s-a,o*=60):l=c>0&&c<1?0:o,new ff(o,l,c,t.opacity)}function Rze(t,e,r,n){return arguments.length===1?lle(t):new ff(t,e,r,n??1)}function ff(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}CM(ff,Rze,ole(aN,{brighter(t){return t=t==null?FI:Math.pow(FI,t),new ff(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?sw:Math.pow(sw,t),new ff(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new au(NT(t>=240?t-240:t+120,a,n),NT(t,a,n),NT(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new ff(mq(this.h),S_(this.s),S_(this.l),OI(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=OI(this.opacity);return`${t===1?"hsl(":"hsla("}${mq(this.h)}, ${S_(this.s)*100}%, ${S_(this.l)*100}%${t===1?")":`, ${t})`}`}}));function mq(t){return t=(t||0)%360,t<0?t+360:t}function S_(t){return Math.max(0,Math.min(1,t||0))}function NT(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const _M=t=>()=>t;function Mze(t,e){return function(r){return t+r*e}}function Lze(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function Uze(t){return(t=+t)==1?cle:function(e,r){return r-e?Lze(e,r,t):_M(isNaN(e)?r:e)}}function cle(t,e){var r=e-t;return r?Mze(t,r):_M(isNaN(t)?e:t)}const pq=function t(e){var r=Uze(e);function n(a,s){var o=r((a=oO(a)).r,(s=oO(s)).r),l=r(a.g,s.g),c=r(a.b,s.b),u=cle(a.opacity,s.opacity);return function(d){return a.r=o(d),a.g=l(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=t,n}(1);function Qze(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),a;return function(s){for(a=0;a<r;++a)n[a]=t[a]*(1-s)+e[a]*s;return n}}function Vze(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Hze(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),s=new Array(r),o;for(o=0;o<n;++o)a[o]=E1(t[o],e[o]);for(;o<r;++o)s[o]=e[o];return function(l){for(o=0;o<n;++o)s[o]=a[o](l);return s}}function $ze(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function DI(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function Gze(t,e){var r={},n={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?r[a]=E1(t[a],e[a]):n[a]=e[a];return function(s){for(a in r)n[a]=r[a](s);return n}}var lO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,CT=new RegExp(lO.source,"g");function Kze(t){return function(){return t}}function qze(t){return function(e){return t(e)+""}}function zze(t,e){var r=lO.lastIndex=CT.lastIndex=0,n,a,s,o=-1,l=[],c=[];for(t=t+"",e=e+"";(n=lO.exec(t))&&(a=CT.exec(e));)(s=a.index)>r&&(s=e.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:DI(n,a)})),r=CT.lastIndex;return r<e.length&&(s=e.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?qze(c[0].x):Kze(e):(e=c.length,function(u){for(var d=0,f;d<e;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function E1(t,e){var r=typeof e,n;return e==null||r==="boolean"?_M(e):(r==="number"?DI:r==="string"?(n=ow(e))?(e=n,pq):zze:e instanceof ow?pq:e instanceof Date?$ze:Vze(e)?Qze:Array.isArray(e)?Hze:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Gze:DI)(t,e)}function EM(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function Wze(t,e){e===void 0&&(e=t,t=E1);for(var r=0,n=e.length-1,a=e[0],s=new Array(n<0?0:n);r<n;)s[r]=t(a,a=e[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return s[l](o-l)}}function Xze(t){return function(){return t}}function RI(t){return+t}var gq=[0,1];function jc(t){return t}function cO(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:Xze(isNaN(e)?NaN:.5)}function Yze(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function Jze(t,e,r){var n=t[0],a=t[1],s=e[0],o=e[1];return a<n?(n=cO(a,n),s=r(o,s)):(n=cO(n,a),s=r(s,o)),function(l){return s(n(l))}}function Zze(t,e,r){var n=Math.min(t.length,e.length)-1,a=new Array(n),s=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)a[o]=cO(t[o],t[o+1]),s[o]=r(e[o],e[o+1]);return function(l){var c=nN(t,l,1,n)-1;return s[c](a[c](l))}}function sN(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ZP(){var t=gq,e=gq,r=E1,n,a,s,o=jc,l,c,u;function d(){var A=Math.min(t.length,e.length);return o!==jc&&(o=Yze(t[0],t[A-1])),l=A>2?Zze:Jze,c=u=null,f}function f(A){return A==null||isNaN(A=+A)?s:(c||(c=l(t.map(n),e,r)))(n(o(A)))}return f.invert=function(A){return o(a((u||(u=l(e,t.map(n),DI)))(A)))},f.domain=function(A){return arguments.length?(t=Array.from(A,RI),d()):t.slice()},f.range=function(A){return arguments.length?(e=Array.from(A),d()):e.slice()},f.rangeRound=function(A){return e=Array.from(A),r=EM,d()},f.clamp=function(A){return arguments.length?(o=A?!0:jc,d()):o!==jc},f.interpolate=function(A){return arguments.length?(r=A,d()):r},f.unknown=function(A){return arguments.length?(s=A,f):s},function(A,h){return n=A,a=h,d()}}function SM(){return ZP()(jc,jc)}function eWe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function MI(t,e){if(!isFinite(t)||t===0)return null;var r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"),n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Xv(t){return t=MI(Math.abs(t)),t?t[1]:NaN}function tWe(t,e){return function(r,n){for(var a=r.length,s=[],o=0,l=t[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),s.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=t[o=(o+1)%t.length];return s.reverse().join(e)}}function rWe(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var nWe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function lw(t){if(!(e=nWe.exec(t)))throw new Error("invalid format: "+t);var e;return new IM({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}lw.prototype=IM.prototype;function IM(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}IM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function aWe(t){e:for(var e=t.length,r=1,n=-1,a;r<e;++r)switch(t[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(a+1):t}var LI;function sWe(t,e){var r=MI(t,e);if(!r)return LI=void 0,t.toPrecision(e);var n=r[0],a=r[1],s=a-(LI=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+MI(t,Math.max(0,e+s-1))[0]}function xq(t,e){var r=MI(t,e);if(!r)return t+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const vq={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:eWe,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>xq(t*100,e),r:xq,s:sWe,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function yq(t){return t}var bq=Array.prototype.map,wq=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function iWe(t){var e=t.grouping===void 0||t.thousands===void 0?yq:tWe(bq.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?yq:rWe(bq.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(f,A){f=lw(f);var h=f.fill,m=f.align,p=f.sign,x=f.symbol,v=f.zero,y=f.width,b=f.comma,w=f.precision,j=f.trim,I=f.type;I==="n"?(b=!0,I="g"):vq[I]||(w===void 0&&(w=12),j=!0,I="g"),(v||h==="0"&&m==="=")&&(v=!0,h="0",m="=");var C=(A&&A.prefix!==void 0?A.prefix:"")+(x==="$"?r:x==="#"&&/[boxX]/.test(I)?"0"+I.toLowerCase():""),S=(x==="$"?n:/[%p]/.test(I)?o:"")+(A&&A.suffix!==void 0?A.suffix:""),E=vq[I],B=/[defgprs%]/.test(I);w=w===void 0?6:/[gprs]/.test(I)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function k(T){var P=C,K=S,le,oe,ie;if(I==="c")K=E(T)+K,T="";else{T=+T;var Ae=T<0||1/T<0;if(T=isNaN(T)?c:E(Math.abs(T),w),j&&(T=aWe(T)),Ae&&+T==0&&p!=="+"&&(Ae=!1),P=(Ae?p==="("?p:l:p==="-"||p==="("?"":p)+P,K=(I==="s"&&!isNaN(T)&&LI!==void 0?wq[8+LI/3]:"")+K+(Ae&&p==="("?")":""),B){for(le=-1,oe=T.length;++le<oe;)if(ie=T.charCodeAt(le),48>ie||ie>57){K=(ie===46?a+T.slice(le+1):T.slice(le))+K,T=T.slice(0,le);break}}}b&&!v&&(T=e(T,1/0));var te=P.length+T.length+K.length,Te=te<y?new Array(y-te+1).join(h):"";switch(b&&v&&(T=e(Te+T,Te.length?y-K.length:1/0),Te=""),m){case"<":T=P+T+K+Te;break;case"=":T=P+Te+T+K;break;case"^":T=Te.slice(0,te=Te.length>>1)+P+T+K+Te.slice(te);break;default:T=Te+P+T+K;break}return s(T)}return k.toString=function(){return f+""},k}function d(f,A){var h=Math.max(-8,Math.min(8,Math.floor(Xv(A)/3)))*3,m=Math.pow(10,-h),p=u((f=lw(f),f.type="f",f),{suffix:wq[8+h/3]});return function(x){return p(m*x)}}return{format:u,formatPrefix:d}}var I_,jM,ule;oWe({thousands:",",grouping:[3],currency:["$",""]});function oWe(t){return I_=iWe(t),jM=I_.format,ule=I_.formatPrefix,I_}function lWe(t){return Math.max(0,-Xv(Math.abs(t)))}function cWe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Xv(e)/3)))*3-Xv(Math.abs(t)))}function uWe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Xv(e)-Xv(t))+1}function dle(t,e,r,n){var a=sO(t,e,r),s;switch(n=lw(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(s=cWe(a,o))&&(n.precision=s),ule(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=uWe(a,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=lWe(a))&&(n.precision=s-(n.type==="%")*2);break}}return jM(n)}function Km(t){var e=t.domain;return t.ticks=function(r){var n=e();return nO(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var a=e();return dle(a[0],a[a.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),a=0,s=n.length-1,o=n[a],l=n[s],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=a,a=s,s=u);d-- >0;){if(u=aO(o,l,r),u===c)return n[a]=o,n[s]=l,e(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return t},t}function fle(){var t=SM();return t.copy=function(){return sN(t,fle())},Hd.apply(t,arguments),Km(t)}function hle(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,RI),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return hle(t).unknown(e)},t=arguments.length?Array.from(t,RI):[0,1],Km(r)}function Ale(t,e){t=t.slice();var r=0,n=t.length-1,a=t[r],s=t[n],o;return s<a&&(o=r,r=n,n=o,o=a,a=s,s=o),t[r]=e.floor(a),t[n]=e.ceil(s),t}function Nq(t){return Math.log(t)}function Cq(t){return Math.exp(t)}function dWe(t){return-Math.log(-t)}function fWe(t){return-Math.exp(-t)}function hWe(t){return isFinite(t)?+("1e"+t):t<0?0:t}function AWe(t){return t===10?hWe:t===Math.E?Math.exp:e=>Math.pow(t,e)}function mWe(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function _q(t){return(e,r)=>-t(-e,r)}function PM(t){const e=t(Nq,Cq),r=e.domain;let n=10,a,s;function o(){return a=mWe(n),s=AWe(n),r()[0]<0?(a=_q(a),s=_q(s),t(dWe,fWe)):t(Nq,Cq),e}return e.base=function(l){return arguments.length?(n=+l,o()):n},e.domain=function(l){return arguments.length?(r(l),o()):r()},e.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let A=a(u),h=a(d),m,p;const x=l==null?10:+l;let v=[];if(!(n%1)&&h-A<x){if(A=Math.floor(A),h=Math.ceil(h),u>0){for(;A<=h;++A)for(m=1;m<n;++m)if(p=A<0?m/s(-A):m*s(A),!(p<u)){if(p>d)break;v.push(p)}}else for(;A<=h;++A)for(m=n-1;m>=1;--m)if(p=A>0?m/s(-A):m*s(A),!(p<u)){if(p>d)break;v.push(p)}v.length*2<x&&(v=nO(u,d,x))}else v=nO(A,h,Math.min(h-A,x)).map(s);return f?v.reverse():v},e.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=lw(c)).precision==null&&(c.trim=!0),c=jM(c)),l===1/0)return c;const u=Math.max(1,n*l/e.ticks().length);return d=>{let f=d/s(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},e.nice=()=>r(Ale(r(),{floor:l=>s(Math.floor(a(l))),ceil:l=>s(Math.ceil(a(l)))})),e}function mle(){const t=PM(ZP()).domain([1,10]);return t.copy=()=>sN(t,mle()).base(t.base()),Hd.apply(t,arguments),t}function Eq(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Sq(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function TM(t){var e=1,r=t(Eq(e),Sq(e));return r.constant=function(n){return arguments.length?t(Eq(e=+n),Sq(e)):e},Km(r)}function ple(){var t=TM(ZP());return t.copy=function(){return sN(t,ple()).constant(t.constant())},Hd.apply(t,arguments)}function Iq(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function pWe(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function gWe(t){return t<0?-t*t:t*t}function BM(t){var e=t(jc,jc),r=1;function n(){return r===1?t(jc,jc):r===.5?t(pWe,gWe):t(Iq(r),Iq(1/r))}return e.exponent=function(a){return arguments.length?(r=+a,n()):r},Km(e)}function kM(){var t=BM(ZP());return t.copy=function(){return sN(t,kM()).exponent(t.exponent())},Hd.apply(t,arguments),t}function xWe(){return kM.apply(null,arguments).exponent(.5)}function jq(t){return Math.sign(t)*t*t}function vWe(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function gle(){var t=SM(),e=[0,1],r=!1,n;function a(s){var o=vWe(t(s));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(s){return t.invert(jq(s))},a.domain=function(s){return arguments.length?(t.domain(s),a):t.domain()},a.range=function(s){return arguments.length?(t.range((e=Array.from(s,RI)).map(jq)),a):e.slice()},a.rangeRound=function(s){return a.range(s).round(!0)},a.round=function(s){return arguments.length?(r=!!s,a):r},a.clamp=function(s){return arguments.length?(t.clamp(s),a):t.clamp()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return gle(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},Hd.apply(a,arguments),Km(a)}function xle(){var t=[],e=[],r=[],n;function a(){var o=0,l=Math.max(1,e.length);for(r=new Array(l-1);++o<l;)r[o-1]=Nze(t,o/l);return s}function s(o){return o==null||isNaN(o=+o)?n:e[nN(r,o)]}return s.invertExtent=function(o){var l=e.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:t[0],l<r.length?r[l]:t[t.length-1]]},s.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let l of o)l!=null&&!isNaN(l=+l)&&t.push(l);return t.sort(gm),a()},s.range=function(o){return arguments.length?(e=Array.from(o),a()):e.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return xle().domain(t).range(e).unknown(n)},Hd.apply(s,arguments)}function vle(){var t=0,e=1,r=1,n=[.5],a=[0,1],s;function o(c){return c!=null&&c<=c?a[nN(n,c,0,r)]:s}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*e-(c-r)*t)/(r+1);return o}return o.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,l()):[t,e]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[t,n[0]]:u>=r?[n[r-1],e]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return vle().domain([t,e]).range(a).unknown(s)},Hd.apply(Km(o),arguments)}function yle(){var t=[.5],e=[0,1],r,n=1;function a(s){return s!=null&&s<=s?e[nN(t,s,0,n)]:r}return a.domain=function(s){return arguments.length?(t=Array.from(s),n=Math.min(t.length,e.length-1),a):t.slice()},a.range=function(s){return arguments.length?(e=Array.from(s),n=Math.min(t.length,e.length-1),a):e.slice()},a.invertExtent=function(s){var o=e.indexOf(s);return[t[o-1],t[o]]},a.unknown=function(s){return arguments.length?(r=s,a):r},a.copy=function(){return yle().domain(t).range(e).unknown(r)},Hd.apply(a,arguments)}const _T=new Date,ET=new Date;function Lo(t,e,r,n){function a(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=s=>(t(s=new Date(+s)),s),a.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),a.round=s=>{const o=a(s),l=a.ceil(s);return s-o<l-s?o:l},a.offset=(s,o)=>(e(s=new Date(+s),o==null?1:Math.floor(o)),s),a.range=(s,o,l)=>{const c=[];if(s=a.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return c;let u;do c.push(u=new Date(+s)),e(s,l),t(s);while(u<s&&s<o);return c},a.filter=s=>Lo(o=>{if(o>=o)for(;t(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;e(o,-1),!s(o););else for(;--l>=0;)for(;e(o,1),!s(o););}),r&&(a.count=(s,o)=>(_T.setTime(+s),ET.setTime(+o),t(_T),t(ET),Math.floor(r(_T,ET))),a.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(n?o=>n(o)%s===0:o=>a.count(0,o)%s===0):a)),a}const UI=Lo(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);UI.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Lo(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):UI);UI.range;const Zh=1e3,Sd=Zh*60,eA=Sd*60,_A=eA*24,FM=_A*7,Pq=_A*30,ST=_A*365,Fp=Lo(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Zh)},(t,e)=>(e-t)/Zh,t=>t.getUTCSeconds());Fp.range;const OM=Lo(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Zh)},(t,e)=>{t.setTime(+t+e*Sd)},(t,e)=>(e-t)/Sd,t=>t.getMinutes());OM.range;const DM=Lo(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Sd)},(t,e)=>(e-t)/Sd,t=>t.getUTCMinutes());DM.range;const RM=Lo(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Zh-t.getMinutes()*Sd)},(t,e)=>{t.setTime(+t+e*eA)},(t,e)=>(e-t)/eA,t=>t.getHours());RM.range;const MM=Lo(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*eA)},(t,e)=>(e-t)/eA,t=>t.getUTCHours());MM.range;const iN=Lo(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Sd)/_A,t=>t.getDate()-1);iN.range;const e4=Lo(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/_A,t=>t.getUTCDate()-1);e4.range;const ble=Lo(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/_A,t=>Math.floor(t/_A));ble.range;function qg(t){return Lo(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Sd)/FM)}const t4=qg(0),QI=qg(1),yWe=qg(2),bWe=qg(3),Yv=qg(4),wWe=qg(5),NWe=qg(6);t4.range;QI.range;yWe.range;bWe.range;Yv.range;wWe.range;NWe.range;function zg(t){return Lo(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/FM)}const r4=zg(0),VI=zg(1),CWe=zg(2),_We=zg(3),Jv=zg(4),EWe=zg(5),SWe=zg(6);r4.range;VI.range;CWe.range;_We.range;Jv.range;EWe.range;SWe.range;const LM=Lo(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());LM.range;const UM=Lo(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());UM.range;const EA=Lo(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());EA.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Lo(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});EA.range;const SA=Lo(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());SA.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Lo(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});SA.range;function wle(t,e,r,n,a,s){const o=[[Fp,1,Zh],[Fp,5,5*Zh],[Fp,15,15*Zh],[Fp,30,30*Zh],[s,1,Sd],[s,5,5*Sd],[s,15,15*Sd],[s,30,30*Sd],[a,1,eA],[a,3,3*eA],[a,6,6*eA],[a,12,12*eA],[n,1,_A],[n,2,2*_A],[r,1,FM],[e,1,Pq],[e,3,3*Pq],[t,1,ST]];function l(u,d,f){const A=d<u;A&&([u,d]=[d,u]);const h=f&&typeof f.range=="function"?f:c(u,d,f),m=h?h.range(u,+d+1):[];return A?m.reverse():m}function c(u,d,f){const A=Math.abs(d-u)/f,h=bM(([,,x])=>x).right(o,A);if(h===o.length)return t.every(sO(u/ST,d/ST,f));if(h===0)return UI.every(Math.max(sO(u,d,f),1));const[m,p]=o[A/o[h-1][2]<o[h][2]/A?h-1:h];return m.every(p)}return[l,c]}const[IWe,jWe]=wle(SA,UM,r4,ble,MM,DM),[PWe,TWe]=wle(EA,LM,t4,iN,RM,OM);function IT(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function jT(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function jy(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function BWe(t){var e=t.dateTime,r=t.date,n=t.time,a=t.periods,s=t.days,o=t.shortDays,l=t.months,c=t.shortMonths,u=Py(a),d=Ty(a),f=Py(s),A=Ty(s),h=Py(o),m=Ty(o),p=Py(l),x=Ty(l),v=Py(c),y=Ty(c),b={a:ie,A:Ae,b:te,B:Te,c:null,d:Dq,e:Dq,f:tXe,g:dXe,G:hXe,H:JWe,I:ZWe,j:eXe,L:Nle,m:rXe,M:nXe,p:Ue,q:O,Q:Lq,s:Uq,S:aXe,u:sXe,U:iXe,V:oXe,w:lXe,W:cXe,x:null,X:null,y:uXe,Y:fXe,Z:AXe,"%":Mq},w={a:H,A:G,b:L,B:W,c:null,d:Rq,e:Rq,f:xXe,g:IXe,G:PXe,H:mXe,I:pXe,j:gXe,L:_le,m:vXe,M:yXe,p:X,q:D,Q:Lq,s:Uq,S:bXe,u:wXe,U:NXe,V:CXe,w:_Xe,W:EXe,x:null,X:null,y:SXe,Y:jXe,Z:TXe,"%":Mq},j={a:B,A:k,b:T,B:P,c:K,d:Fq,e:Fq,f:zWe,g:kq,G:Bq,H:Oq,I:Oq,j:$We,L:qWe,m:HWe,M:GWe,p:E,q:VWe,Q:XWe,s:YWe,S:KWe,u:RWe,U:MWe,V:LWe,w:DWe,W:UWe,x:le,X:oe,y:kq,Y:Bq,Z:QWe,"%":WWe};b.x=I(r,b),b.X=I(n,b),b.c=I(e,b),w.x=I(r,w),w.X=I(n,w),w.c=I(e,w);function I(Q,Z){return function(be){var U=[],ze=-1,re=0,J=Q.length,Re,ke,Be;for(be instanceof Date||(be=new Date(+be));++ze<J;)Q.charCodeAt(ze)===37&&(U.push(Q.slice(re,ze)),(ke=Tq[Re=Q.charAt(++ze)])!=null?Re=Q.charAt(++ze):ke=Re==="e"?" ":"0",(Be=Z[Re])&&(Re=Be(be,ke)),U.push(Re),re=ze+1);return U.push(Q.slice(re,ze)),U.join("")}}function C(Q,Z){return function(be){var U=jy(1900,void 0,1),ze=S(U,Q,be+="",0),re,J;if(ze!=be.length)return null;if("Q"in U)return new Date(U.Q);if("s"in U)return new Date(U.s*1e3+("L"in U?U.L:0));if(Z&&!("Z"in U)&&(U.Z=0),"p"in U&&(U.H=U.H%12+U.p*12),U.m===void 0&&(U.m="q"in U?U.q:0),"V"in U){if(U.V<1||U.V>53)return null;"w"in U||(U.w=1),"Z"in U?(re=jT(jy(U.y,0,1)),J=re.getUTCDay(),re=J>4||J===0?VI.ceil(re):VI(re),re=e4.offset(re,(U.V-1)*7),U.y=re.getUTCFullYear(),U.m=re.getUTCMonth(),U.d=re.getUTCDate()+(U.w+6)%7):(re=IT(jy(U.y,0,1)),J=re.getDay(),re=J>4||J===0?QI.ceil(re):QI(re),re=iN.offset(re,(U.V-1)*7),U.y=re.getFullYear(),U.m=re.getMonth(),U.d=re.getDate()+(U.w+6)%7)}else("W"in U||"U"in U)&&("w"in U||(U.w="u"in U?U.u%7:"W"in U?1:0),J="Z"in U?jT(jy(U.y,0,1)).getUTCDay():IT(jy(U.y,0,1)).getDay(),U.m=0,U.d="W"in U?(U.w+6)%7+U.W*7-(J+5)%7:U.w+U.U*7-(J+6)%7);return"Z"in U?(U.H+=U.Z/100|0,U.M+=U.Z%100,jT(U)):IT(U)}}function S(Q,Z,be,U){for(var ze=0,re=Z.length,J=be.length,Re,ke;ze<re;){if(U>=J)return-1;if(Re=Z.charCodeAt(ze++),Re===37){if(Re=Z.charAt(ze++),ke=j[Re in Tq?Z.charAt(ze++):Re],!ke||(U=ke(Q,be,U))<0)return-1}else if(Re!=be.charCodeAt(U++))return-1}return U}function E(Q,Z,be){var U=u.exec(Z.slice(be));return U?(Q.p=d.get(U[0].toLowerCase()),be+U[0].length):-1}function B(Q,Z,be){var U=h.exec(Z.slice(be));return U?(Q.w=m.get(U[0].toLowerCase()),be+U[0].length):-1}function k(Q,Z,be){var U=f.exec(Z.slice(be));return U?(Q.w=A.get(U[0].toLowerCase()),be+U[0].length):-1}function T(Q,Z,be){var U=v.exec(Z.slice(be));return U?(Q.m=y.get(U[0].toLowerCase()),be+U[0].length):-1}function P(Q,Z,be){var U=p.exec(Z.slice(be));return U?(Q.m=x.get(U[0].toLowerCase()),be+U[0].length):-1}function K(Q,Z,be){return S(Q,e,Z,be)}function le(Q,Z,be){return S(Q,r,Z,be)}function oe(Q,Z,be){return S(Q,n,Z,be)}function ie(Q){return o[Q.getDay()]}function Ae(Q){return s[Q.getDay()]}function te(Q){return c[Q.getMonth()]}function Te(Q){return l[Q.getMonth()]}function Ue(Q){return a[+(Q.getHours()>=12)]}function O(Q){return 1+~~(Q.getMonth()/3)}function H(Q){return o[Q.getUTCDay()]}function G(Q){return s[Q.getUTCDay()]}function L(Q){return c[Q.getUTCMonth()]}function W(Q){return l[Q.getUTCMonth()]}function X(Q){return a[+(Q.getUTCHours()>=12)]}function D(Q){return 1+~~(Q.getUTCMonth()/3)}return{format:function(Q){var Z=I(Q+="",b);return Z.toString=function(){return Q},Z},parse:function(Q){var Z=C(Q+="",!1);return Z.toString=function(){return Q},Z},utcFormat:function(Q){var Z=I(Q+="",w);return Z.toString=function(){return Q},Z},utcParse:function(Q){var Z=C(Q+="",!0);return Z.toString=function(){return Q},Z}}}var Tq={"-":"",_:" ",0:"0"},ol=/^\s*\d+/,kWe=/^%/,FWe=/[\\^$*+?|[\]().{}]/g;function Ta(t,e,r){var n=t<0?"-":"",a=(n?-t:t)+"",s=a.length;return n+(s<r?new Array(r-s+1).join(e)+a:a)}function OWe(t){return t.replace(FWe,"\\$&")}function Py(t){return new RegExp("^(?:"+t.map(OWe).join("|")+")","i")}function Ty(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function DWe(t,e,r){var n=ol.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function RWe(t,e,r){var n=ol.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function MWe(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function LWe(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function UWe(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function Bq(t,e,r){var n=ol.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function kq(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function QWe(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function VWe(t,e,r){var n=ol.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function HWe(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function Fq(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function $We(t,e,r){var n=ol.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function Oq(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function GWe(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function KWe(t,e,r){var n=ol.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function qWe(t,e,r){var n=ol.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function zWe(t,e,r){var n=ol.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function WWe(t,e,r){var n=kWe.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function XWe(t,e,r){var n=ol.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function YWe(t,e,r){var n=ol.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function Dq(t,e){return Ta(t.getDate(),e,2)}function JWe(t,e){return Ta(t.getHours(),e,2)}function ZWe(t,e){return Ta(t.getHours()%12||12,e,2)}function eXe(t,e){return Ta(1+iN.count(EA(t),t),e,3)}function Nle(t,e){return Ta(t.getMilliseconds(),e,3)}function tXe(t,e){return Nle(t,e)+"000"}function rXe(t,e){return Ta(t.getMonth()+1,e,2)}function nXe(t,e){return Ta(t.getMinutes(),e,2)}function aXe(t,e){return Ta(t.getSeconds(),e,2)}function sXe(t){var e=t.getDay();return e===0?7:e}function iXe(t,e){return Ta(t4.count(EA(t)-1,t),e,2)}function Cle(t){var e=t.getDay();return e>=4||e===0?Yv(t):Yv.ceil(t)}function oXe(t,e){return t=Cle(t),Ta(Yv.count(EA(t),t)+(EA(t).getDay()===4),e,2)}function lXe(t){return t.getDay()}function cXe(t,e){return Ta(QI.count(EA(t)-1,t),e,2)}function uXe(t,e){return Ta(t.getFullYear()%100,e,2)}function dXe(t,e){return t=Cle(t),Ta(t.getFullYear()%100,e,2)}function fXe(t,e){return Ta(t.getFullYear()%1e4,e,4)}function hXe(t,e){var r=t.getDay();return t=r>=4||r===0?Yv(t):Yv.ceil(t),Ta(t.getFullYear()%1e4,e,4)}function AXe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ta(e/60|0,"0",2)+Ta(e%60,"0",2)}function Rq(t,e){return Ta(t.getUTCDate(),e,2)}function mXe(t,e){return Ta(t.getUTCHours(),e,2)}function pXe(t,e){return Ta(t.getUTCHours()%12||12,e,2)}function gXe(t,e){return Ta(1+e4.count(SA(t),t),e,3)}function _le(t,e){return Ta(t.getUTCMilliseconds(),e,3)}function xXe(t,e){return _le(t,e)+"000"}function vXe(t,e){return Ta(t.getUTCMonth()+1,e,2)}function yXe(t,e){return Ta(t.getUTCMinutes(),e,2)}function bXe(t,e){return Ta(t.getUTCSeconds(),e,2)}function wXe(t){var e=t.getUTCDay();return e===0?7:e}function NXe(t,e){return Ta(r4.count(SA(t)-1,t),e,2)}function Ele(t){var e=t.getUTCDay();return e>=4||e===0?Jv(t):Jv.ceil(t)}function CXe(t,e){return t=Ele(t),Ta(Jv.count(SA(t),t)+(SA(t).getUTCDay()===4),e,2)}function _Xe(t){return t.getUTCDay()}function EXe(t,e){return Ta(VI.count(SA(t)-1,t),e,2)}function SXe(t,e){return Ta(t.getUTCFullYear()%100,e,2)}function IXe(t,e){return t=Ele(t),Ta(t.getUTCFullYear()%100,e,2)}function jXe(t,e){return Ta(t.getUTCFullYear()%1e4,e,4)}function PXe(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Jv(t):Jv.ceil(t),Ta(t.getUTCFullYear()%1e4,e,4)}function TXe(){return"+0000"}function Mq(){return"%"}function Lq(t){return+t}function Uq(t){return Math.floor(+t/1e3)}var wx,Sle,Ile;BXe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function BXe(t){return wx=BWe(t),Sle=wx.format,wx.parse,Ile=wx.utcFormat,wx.utcParse,wx}function kXe(t){return new Date(t)}function FXe(t){return t instanceof Date?+t:+new Date(+t)}function QM(t,e,r,n,a,s,o,l,c,u){var d=SM(),f=d.invert,A=d.domain,h=u(".%L"),m=u(":%S"),p=u("%I:%M"),x=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),w=u("%Y");function j(I){return(c(I)<I?h:l(I)<I?m:o(I)<I?p:s(I)<I?x:n(I)<I?a(I)<I?v:y:r(I)<I?b:w)(I)}return d.invert=function(I){return new Date(f(I))},d.domain=function(I){return arguments.length?A(Array.from(I,FXe)):A().map(kXe)},d.ticks=function(I){var C=A();return t(C[0],C[C.length-1],I??10)},d.tickFormat=function(I,C){return C==null?j:u(C)},d.nice=function(I){var C=A();return(!I||typeof I.range!="function")&&(I=e(C[0],C[C.length-1],I??10)),I?A(Ale(C,I)):d},d.copy=function(){return sN(d,QM(t,e,r,n,a,s,o,l,c,u))},d}function OXe(){return Hd.apply(QM(PWe,TWe,EA,LM,t4,iN,RM,OM,Fp,Sle).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function DXe(){return Hd.apply(QM(IWe,jWe,SA,UM,r4,e4,MM,DM,Fp,Ile).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function n4(){var t=0,e=1,r,n,a,s,o=jc,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:o(a===0?.5:(f=(s(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([t,e]=f,r=s(t=+t),n=s(e=+e),a=r===n?0:1/(n-r),u):[t,e]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(o=f,u):o};function d(f){return function(A){var h,m;return arguments.length?([h,m]=A,o=f(h,m),u):[o(0),o(1)]}}return u.range=d(E1),u.rangeRound=d(EM),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return s=f,r=f(t),n=f(e),a=r===n?0:1/(n-r),u}}function qm(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function jle(){var t=Km(n4()(jc));return t.copy=function(){return qm(t,jle())},VA.apply(t,arguments)}function Ple(){var t=PM(n4()).domain([1,10]);return t.copy=function(){return qm(t,Ple()).base(t.base())},VA.apply(t,arguments)}function Tle(){var t=TM(n4());return t.copy=function(){return qm(t,Tle()).constant(t.constant())},VA.apply(t,arguments)}function VM(){var t=BM(n4());return t.copy=function(){return qm(t,VM()).exponent(t.exponent())},VA.apply(t,arguments)}function RXe(){return VM.apply(null,arguments).exponent(.5)}function Ble(){var t=[],e=jc;function r(n){if(n!=null&&!isNaN(n=+n))return e((nN(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let a of n)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(gm),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,a)=>e(a/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,s)=>wze(t,s/n))},r.copy=function(){return Ble(e).domain(t)},VA.apply(r,arguments)}function a4(){var t=0,e=.5,r=1,n=1,a,s,o,l,c,u=jc,d,f=!1,A;function h(p){return isNaN(p=+p)?A:(p=.5+((p=+d(p))-s)*(n*p<n*s?l:c),u(f?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([t,e,r]=p,a=d(t=+t),s=d(e=+e),o=d(r=+r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,h):[t,e,r]},h.clamp=function(p){return arguments.length?(f=!!p,h):f},h.interpolator=function(p){return arguments.length?(u=p,h):u};function m(p){return function(x){var v,y,b;return arguments.length?([v,y,b]=x,u=Wze(p,[v,y,b]),h):[u(0),u(.5),u(1)]}}return h.range=m(E1),h.rangeRound=m(EM),h.unknown=function(p){return arguments.length?(A=p,h):A},function(p){return d=p,a=p(t),s=p(e),o=p(r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,h}}function kle(){var t=Km(a4()(jc));return t.copy=function(){return qm(t,kle())},VA.apply(t,arguments)}function Fle(){var t=PM(a4()).domain([.1,1,10]);return t.copy=function(){return qm(t,Fle()).base(t.base())},VA.apply(t,arguments)}function Ole(){var t=TM(a4());return t.copy=function(){return qm(t,Ole()).constant(t.constant())},VA.apply(t,arguments)}function HM(){var t=BM(a4());return t.copy=function(){return qm(t,HM()).exponent(t.exponent())},VA.apply(t,arguments)}function MXe(){return HM.apply(null,arguments).exponent(.5)}const ab=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:NM,scaleDiverging:kle,scaleDivergingLog:Fle,scaleDivergingPow:HM,scaleDivergingSqrt:MXe,scaleDivergingSymlog:Ole,scaleIdentity:hle,scaleImplicit:iO,scaleLinear:fle,scaleLog:mle,scaleOrdinal:wM,scalePoint:_ze,scalePow:kM,scaleQuantile:xle,scaleQuantize:vle,scaleRadial:gle,scaleSequential:jle,scaleSequentialLog:Ple,scaleSequentialPow:VM,scaleSequentialQuantile:Ble,scaleSequentialSqrt:RXe,scaleSequentialSymlog:Tle,scaleSqrt:xWe,scaleSymlog:ple,scaleThreshold:yle,scaleTime:OXe,scaleUtc:DXe,tickFormat:dle},Symbol.toStringTag,{value:"Module"}));var HA=t=>t.chartData,s4=tr([HA],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),Dle=(t,e,r,n)=>n?s4(t):HA(t),LXe=(t,e,r)=>r?s4(t):HA(t);function Fm(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(pi(e)&&pi(r))return!0}return!1}function Qq(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function Rle(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,a,s;if(pi(r))a=r;else if(typeof r=="function")return;if(pi(n))s=n;else if(typeof n=="function")return;var o=[a,s];if(Fm(o))return o}}function UXe(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(Fm(n))return Qq(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[a,s]=t,o,l;if(a==="auto")e!=null&&(o=Math.min(...e));else if(_n(a))o=a;else if(typeof a=="function")try{e!=null&&(o=a(e==null?void 0:e[0]))}catch{}else if(typeof a=="string"&&aK.test(a)){var c=aK.exec(a);if(c==null||c[1]==null||e==null)o=void 0;else{var u=+c[1];o=e[0]-u}}else o=e==null?void 0:e[0];if(s==="auto")e!=null&&(l=Math.max(...e));else if(_n(s))l=s;else if(typeof s=="function")try{e!=null&&(l=s(e==null?void 0:e[1]))}catch{}else if(typeof s=="string"&&sK.test(s)){var d=sK.exec(s);if(d==null||d[1]==null||e==null)l=void 0;else{var f=+d[1];l=e[1]+f}}else l=e==null?void 0:e[1];var A=[o,l];if(Fm(A))return e==null?A:Qq(A,e,r)}}}var S1=1e9,QXe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},GM,zs=!0,Ld="[DecimalError] ",Yp=Ld+"Invalid argument: ",$M=Ld+"Exponent out of range: ",I1=Math.floor,gp=Math.pow,VXe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ku,Yo=1e7,Ts=7,Mle=9007199254740991,HI=I1(Mle/Ts),ln={};ln.absoluteValue=ln.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};ln.comparedTo=ln.cmp=function(t){var e,r,n,a,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(n=s.d.length,a=t.d.length,e=0,r=n<a?n:a;e<r;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return n===a?0:n>a^s.s<0?1:-1};ln.decimalPlaces=ln.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*Ts;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};ln.dividedBy=ln.div=function(t){return dA(this,new this.constructor(t))};ln.dividedToIntegerBy=ln.idiv=function(t){var e=this,r=e.constructor;return ms(dA(e,new r(t),0,1),r.precision)};ln.equals=ln.eq=function(t){return!this.cmp(t)};ln.exponent=function(){return uo(this)};ln.greaterThan=ln.gt=function(t){return this.cmp(t)>0};ln.greaterThanOrEqualTo=ln.gte=function(t){return this.cmp(t)>=0};ln.isInteger=ln.isint=function(){return this.e>this.d.length-2};ln.isNegative=ln.isneg=function(){return this.s<0};ln.isPositive=ln.ispos=function(){return this.s>0};ln.isZero=function(){return this.s===0};ln.lessThan=ln.lt=function(t){return this.cmp(t)<0};ln.lessThanOrEqualTo=ln.lte=function(t){return this.cmp(t)<1};ln.logarithm=ln.log=function(t){var e,r=this,n=r.constructor,a=n.precision,s=a+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(ku))throw Error(Ld+"NaN");if(r.s<1)throw Error(Ld+(r.s?"NaN":"-Infinity"));return r.eq(ku)?new n(0):(zs=!1,e=dA(cw(r,s),cw(t,s),s),zs=!0,ms(e,a))};ln.minus=ln.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Qle(e,t):Lle(e,(t.s=-t.s,t))};ln.modulo=ln.mod=function(t){var e,r=this,n=r.constructor,a=n.precision;if(t=new n(t),!t.s)throw Error(Ld+"NaN");return r.s?(zs=!1,e=dA(r,t,0,1).times(t),zs=!0,r.minus(e)):ms(new n(r),a)};ln.naturalExponential=ln.exp=function(){return Ule(this)};ln.naturalLogarithm=ln.ln=function(){return cw(this)};ln.negated=ln.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};ln.plus=ln.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Lle(e,t):Qle(e,(t.s=-t.s,t))};ln.precision=ln.sd=function(t){var e,r,n,a=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Yp+t);if(e=uo(a)+1,n=a.d.length-1,r=n*Ts+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};ln.squareRoot=ln.sqrt=function(){var t,e,r,n,a,s,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Ld+"NaN")}for(t=uo(l),zs=!1,a=Math.sqrt(+l),a==0||a==1/0?(e=rh(l.d),(e.length+t)%2==0&&(e+="0"),a=Math.sqrt(e),t=I1((t+1)/2)-(t<0||t%2),a==1/0?e="5e"+t:(e=a.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new c(e)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(s=n,n=s.plus(dA(l,s,o+2)).times(.5),rh(s.d).slice(0,o)===(e=rh(n.d)).slice(0,o)){if(e=e.slice(o-3,o+1),a==o&&e=="4999"){if(ms(s,r+1,0),s.times(s).eq(l)){n=s;break}}else if(e!="9999")break;o+=4}return zs=!0,ms(n,r)};ln.times=ln.mul=function(t){var e,r,n,a,s,o,l,c,u,d=this,f=d.constructor,A=d.d,h=(t=new f(t)).d;if(!d.s||!t.s)return new f(0);for(t.s*=d.s,r=d.e+t.e,c=A.length,u=h.length,c<u&&(s=A,A=h,h=s,o=c,c=u,u=o),s=[],o=c+u,n=o;n--;)s.push(0);for(n=u;--n>=0;){for(e=0,a=c+n;a>n;)l=s[a]+h[n]*A[a-n-1]+e,s[a--]=l%Yo|0,e=l/Yo|0;s[a]=(s[a]+e)%Yo|0}for(;!s[--o];)s.pop();return e?++r:s.shift(),t.d=s,t.e=r,zs?ms(t,f.precision):t};ln.toDecimalPlaces=ln.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(hh(t,0,S1),e===void 0?e=n.rounding:hh(e,0,8),ms(r,t+uo(r)+1,e))};ln.toExponential=function(t,e){var r,n=this,a=n.constructor;return t===void 0?r=Sg(n,!0):(hh(t,0,S1),e===void 0?e=a.rounding:hh(e,0,8),n=ms(new a(n),t+1,e),r=Sg(n,!0,t+1)),r};ln.toFixed=function(t,e){var r,n,a=this,s=a.constructor;return t===void 0?Sg(a):(hh(t,0,S1),e===void 0?e=s.rounding:hh(e,0,8),n=ms(new s(a),t+uo(a)+1,e),r=Sg(n.abs(),!1,t+uo(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};ln.toInteger=ln.toint=function(){var t=this,e=t.constructor;return ms(new e(t),uo(t)+1,e.rounding)};ln.toNumber=function(){return+this};ln.toPower=ln.pow=function(t){var e,r,n,a,s,o,l=this,c=l.constructor,u=12,d=+(t=new c(t));if(!t.s)return new c(ku);if(l=new c(l),!l.s){if(t.s<1)throw Error(Ld+"Infinity");return l}if(l.eq(ku))return l;if(n=c.precision,t.eq(ku))return ms(l,n);if(e=t.e,r=t.d.length-1,o=e>=r,s=l.s,o){if((r=d<0?-d:d)<=Mle){for(a=new c(ku),e=Math.ceil(n/Ts+4),zs=!1;r%2&&(a=a.times(l),Hq(a.d,e)),r=I1(r/2),r!==0;)l=l.times(l),Hq(l.d,e);return zs=!0,t.s<0?new c(ku).div(a):ms(a,n)}}else if(s<0)throw Error(Ld+"NaN");return s=s<0&&t.d[Math.max(e,r)]&1?-1:1,l.s=1,zs=!1,a=t.times(cw(l,n+u)),zs=!0,a=Ule(a),a.s=s,a};ln.toPrecision=function(t,e){var r,n,a=this,s=a.constructor;return t===void 0?(r=uo(a),n=Sg(a,r<=s.toExpNeg||r>=s.toExpPos)):(hh(t,1,S1),e===void 0?e=s.rounding:hh(e,0,8),a=ms(new s(a),t,e),r=uo(a),n=Sg(a,t<=r||r<=s.toExpNeg,t)),n};ln.toSignificantDigits=ln.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(hh(t,1,S1),e===void 0?e=n.rounding:hh(e,0,8)),ms(new n(r),t,e)};ln.toString=ln.valueOf=ln.val=ln.toJSON=ln[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=uo(t),r=t.constructor;return Sg(t,e<=r.toExpNeg||e>=r.toExpPos)};function Lle(t,e){var r,n,a,s,o,l,c,u,d=t.constructor,f=d.precision;if(!t.s||!e.s)return e.s||(e=new d(t)),zs?ms(e,f):e;if(c=t.d,u=e.d,o=t.e,a=e.e,c=c.slice(),s=o-a,s){for(s<0?(n=c,s=-s,l=u.length):(n=u,a=o,l=c.length),o=Math.ceil(f/Ts),l=o>l?o+1:l+1,s>l&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(l=c.length,s=u.length,l-s<0&&(s=l,n=u,u=c,c=n),r=0;s;)r=(c[--s]=c[s]+u[s]+r)/Yo|0,c[s]%=Yo;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return e.d=c,e.e=a,zs?ms(e,f):e}function hh(t,e,r){if(t!==~~t||t<e||t>r)throw Error(Yp+t)}function rh(t){var e,r,n,a=t.length-1,s="",o=t[0];if(a>0){for(s+=o,e=1;e<a;e++)n=t[e]+"",r=Ts-n.length,r&&(s+=T0(r)),s+=n;o=t[e],n=o+"",r=Ts-n.length,r&&(s+=T0(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var dA=function(){function t(n,a){var s,o=0,l=n.length;for(n=n.slice();l--;)s=n[l]*a+o,n[l]=s%Yo|0,o=s/Yo|0;return o&&n.unshift(o),n}function e(n,a,s,o){var l,c;if(s!=o)c=s>o?1:-1;else for(l=c=0;l<s;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,s){for(var o=0;s--;)n[s]-=o,o=n[s]<a[s]?1:0,n[s]=o*Yo+n[s]-a[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,s,o){var l,c,u,d,f,A,h,m,p,x,v,y,b,w,j,I,C,S,E=n.constructor,B=n.s==a.s?1:-1,k=n.d,T=a.d;if(!n.s)return new E(n);if(!a.s)throw Error(Ld+"Division by zero");for(c=n.e-a.e,C=T.length,j=k.length,h=new E(B),m=h.d=[],u=0;T[u]==(k[u]||0);)++u;if(T[u]>(k[u]||0)&&--c,s==null?y=s=E.precision:o?y=s+(uo(n)-uo(a))+1:y=s,y<0)return new E(0);if(y=y/Ts+2|0,u=0,C==1)for(d=0,T=T[0],y++;(u<j||d)&&y--;u++)b=d*Yo+(k[u]||0),m[u]=b/T|0,d=b%T|0;else{for(d=Yo/(T[0]+1)|0,d>1&&(T=t(T,d),k=t(k,d),C=T.length,j=k.length),w=C,p=k.slice(0,C),x=p.length;x<C;)p[x++]=0;S=T.slice(),S.unshift(0),I=T[0],T[1]>=Yo/2&&++I;do d=0,l=e(T,p,C,x),l<0?(v=p[0],C!=x&&(v=v*Yo+(p[1]||0)),d=v/I|0,d>1?(d>=Yo&&(d=Yo-1),f=t(T,d),A=f.length,x=p.length,l=e(f,p,A,x),l==1&&(d--,r(f,C<A?S:T,A))):(d==0&&(l=d=1),f=T.slice()),A=f.length,A<x&&f.unshift(0),r(p,f,x),l==-1&&(x=p.length,l=e(T,p,C,x),l<1&&(d++,r(p,C<x?S:T,x))),x=p.length):l===0&&(d++,p=[0]),m[u++]=d,l&&p[0]?p[x++]=k[w]||0:(p=[k[w]],x=1);while((w++<j||p[0]!==void 0)&&y--)}return m[0]||m.shift(),h.e=c,ms(h,o?s+uo(h)+1:s)}}();function Ule(t,e){var r,n,a,s,o,l,c=0,u=0,d=t.constructor,f=d.precision;if(uo(t)>16)throw Error($M+uo(t));if(!t.s)return new d(ku);for(zs=!1,l=f,o=new d(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(n=Math.log(gp(2,u))/Math.LN10*2+5|0,l+=n,r=a=s=new d(ku),d.precision=l;;){if(a=ms(a.times(t),l),r=r.times(++c),o=s.plus(dA(a,r,l)),rh(o.d).slice(0,l)===rh(s.d).slice(0,l)){for(;u--;)s=ms(s.times(s),l);return d.precision=f,e==null?(zs=!0,ms(s,f)):s}s=o}}function uo(t){for(var e=t.e*Ts,r=t.d[0];r>=10;r/=10)e++;return e}function PT(t,e,r){if(e>t.LN10.sd())throw zs=!0,r&&(t.precision=r),Error(Ld+"LN10 precision limit exceeded");return ms(new t(t.LN10),e)}function T0(t){for(var e="";t--;)e+="0";return e}function cw(t,e){var r,n,a,s,o,l,c,u,d,f=1,A=10,h=t,m=h.d,p=h.constructor,x=p.precision;if(h.s<1)throw Error(Ld+(h.s?"NaN":"-Infinity"));if(h.eq(ku))return new p(0);if(e==null?(zs=!1,u=x):u=e,h.eq(10))return e==null&&(zs=!0),PT(p,u);if(u+=A,p.precision=u,r=rh(m),n=r.charAt(0),s=uo(h),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(t),r=rh(h.d),n=r.charAt(0),f++;s=uo(h),n>1?(h=new p("0."+r),s++):h=new p(n+"."+r.slice(1))}else return c=PT(p,u+2,x).times(s+""),h=cw(new p(n+"."+r.slice(1)),u-A).plus(c),p.precision=x,e==null?(zs=!0,ms(h,x)):h;for(l=o=h=dA(h.minus(ku),h.plus(ku),u),d=ms(h.times(h),u),a=3;;){if(o=ms(o.times(d),u),c=l.plus(dA(o,new p(a),u)),rh(c.d).slice(0,u)===rh(l.d).slice(0,u))return l=l.times(2),s!==0&&(l=l.plus(PT(p,u+2,x).times(s+""))),l=dA(l,new p(f),u),p.precision=x,e==null?(zs=!0,ms(l,x)):l;l=c,a+=2}}function Vq(t,e){var r,n,a;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(a=e.length;e.charCodeAt(a-1)===48;)--a;if(e=e.slice(n,a),e){if(a-=n,r=r-n-1,t.e=I1(r/Ts),t.d=[],n=(r+1)%Ts,r<0&&(n+=Ts),n<a){for(n&&t.d.push(+e.slice(0,n)),a-=Ts;n<a;)t.d.push(+e.slice(n,n+=Ts));e=e.slice(n),n=Ts-e.length}else n-=a;for(;n--;)e+="0";if(t.d.push(+e),zs&&(t.e>HI||t.e<-HI))throw Error($M+r)}else t.s=0,t.e=0,t.d=[0];return t}function ms(t,e,r){var n,a,s,o,l,c,u,d,f=t.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(n=e-o,n<0)n+=Ts,a=e,u=f[d=0];else{if(d=Math.ceil((n+1)/Ts),s=f.length,d>=s)return t;for(u=s=f[d],o=1;s>=10;s/=10)o++;n%=Ts,a=n-Ts+o}if(r!==void 0&&(s=gp(10,o-a-1),l=u/s%10|0,c=e<0||f[d+1]!==void 0||u%s,c=r<4?(l||c)&&(r==0||r==(t.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?u/gp(10,o-a):0:f[d-1])%10&1||r==(t.s<0?8:7))),e<1||!f[0])return c?(s=uo(t),f.length=1,e=e-s-1,f[0]=gp(10,(Ts-e%Ts)%Ts),t.e=I1(-e/Ts)||0):(f.length=1,f[0]=t.e=t.s=0),t;if(n==0?(f.length=d,s=1,d--):(f.length=d+1,s=gp(10,Ts-n),f[d]=a>0?(u/gp(10,o-a)%gp(10,a)|0)*s:0),c)for(;;)if(d==0){(f[0]+=s)==Yo&&(f[0]=1,++t.e);break}else{if(f[d]+=s,f[d]!=Yo)break;f[d--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(zs&&(t.e>HI||t.e<-HI))throw Error($M+uo(t));return t}function Qle(t,e){var r,n,a,s,o,l,c,u,d,f,A=t.constructor,h=A.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new A(t),zs?ms(e,h):e;if(c=t.d,f=e.d,n=e.e,u=t.e,c=c.slice(),o=u-n,o){for(d=o<0,d?(r=c,o=-o,l=f.length):(r=f,n=u,l=c.length),a=Math.max(Math.ceil(h/Ts),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,d=a<l,d&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){d=c[a]<f[a];break}o=0}for(d&&(r=c,c=f,f=r,e.s=-e.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>o;){if(c[--a]<f[a]){for(s=a;s&&c[--s]===0;)c[s]=Yo-1;--c[s],c[a]+=Yo}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=n,zs?ms(e,h):e):new A(0)}function Sg(t,e,r){var n,a=uo(t),s=rh(t.d),o=s.length;return e?(r&&(n=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+T0(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+T0(-a-1)+s,r&&(n=r-o)>0&&(s+=T0(n))):a>=o?(s+=T0(a+1-o),r&&(n=r-a-1)>0&&(s=s+"."+T0(n))):((n=a+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(s+="."),s+=T0(n))),t.s<0?"-"+s:s}function Hq(t,e){if(t.length>e)return t.length=e,!0}function Vle(t){var e,r,n;function a(s){var o=this;if(!(o instanceof a))return new a(s);if(o.constructor=a,s instanceof a){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Yp+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return Vq(o,s.toString())}else if(typeof s!="string")throw Error(Yp+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,VXe.test(s))Vq(o,s);else throw Error(Yp+s)}if(a.prototype=ln,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=Vle,a.config=a.set=HXe,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return a.config(t),a}function HXe(t){if(!t||typeof t!="object")throw Error(Ld+"Object expected");var e,r,n,a=["precision",1,S1,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<a.length;e+=3)if((n=t[r=a[e]])!==void 0)if(I1(n)===n&&n>=a[e+1]&&n<=a[e+2])this[r]=n;else throw Error(Yp+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Yp+r+": "+n);return this}var GM=Vle(QXe);ku=new GM(1);const Za=GM;var $Xe=t=>t,Hle={},$le=t=>t===Hle,$q=t=>function e(){return arguments.length===0||arguments.length===1&&$le(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},Gle=(t,e)=>t===1?e:$q(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var s=n.filter(o=>o!==Hle).length;return s>=t?e(...n):Gle(t-s,$q(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var u=n.map(d=>$le(d)?l.shift():d);return e(...u,...l)}))}),GXe=t=>Gle(t.length,t),uO=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},KXe=GXe((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),qXe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return $Xe;var a=r.reverse(),s=a[0],o=a.slice(1);return function(){return o.reduce((l,c)=>c(l),s(...arguments))}};function Kle(t){var e;return t===0?e=1:e=Math.floor(new Za(t).abs().log(10).toNumber())+1,e}function qle(t,e,r){for(var n=new Za(t),a=0,s=[];n.lt(e)&&a<1e5;)s.push(n.toNumber()),n=n.add(r),a++;return s}var zle=t=>{var[e,r]=t,[n,a]=[e,r];return e>r&&([n,a]=[r,e]),[n,a]},Wle=(t,e,r)=>{if(t.lte(0))return new Za(0);var n=Kle(t.toNumber()),a=new Za(10).pow(n),s=t.div(a),o=n!==1?.05:.1,l=new Za(Math.ceil(s.div(o).toNumber())).add(r).mul(o),c=l.mul(a);return e?new Za(c.toNumber()):new Za(Math.ceil(c.toNumber()))},zXe=(t,e,r)=>{var n=new Za(1),a=new Za(t);if(!a.isint()&&r){var s=Math.abs(t);s<1?(n=new Za(10).pow(Kle(t)-1),a=new Za(Math.floor(a.div(n).toNumber())).mul(n)):s>1&&(a=new Za(Math.floor(t)))}else t===0?a=new Za(Math.floor((e-1)/2)):r||(a=new Za(Math.floor(t)));var o=Math.floor((e-1)/2),l=qXe(KXe(c=>a.add(new Za(c-o).mul(n)).toNumber()),uO);return l(0,e)},Xle=function(e,r,n,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new Za(0),tickMin:new Za(0),tickMax:new Za(0)};var o=Wle(new Za(r).sub(e).div(n-1),a,s),l;e<=0&&r>=0?l=new Za(0):(l=new Za(e).add(r).div(2),l=l.sub(new Za(l).mod(o)));var c=Math.ceil(l.sub(e).div(o).toNumber()),u=Math.ceil(new Za(r).sub(l).div(o).toNumber()),d=c+u+1;return d>n?Xle(e,r,n,a,s+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:o,tickMin:l.sub(new Za(c).mul(o)),tickMax:l.add(new Za(u).mul(o))})},WXe=function(e){var[r,n]=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),[l,c]=zle([r,n]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...uO(0,a-1).map(()=>1/0)]:[...uO(0,a-1).map(()=>-1/0),c];return r>n?u.reverse():u}if(l===c)return zXe(l,a,s);var{step:d,tickMin:f,tickMax:A}=Xle(l,c,o,s,0),h=qle(f,A.add(new Za(.1).mul(d)),d);return r>n?h.reverse():h},XXe=function(e,r){var[n,a]=e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=zle([n,a]);if(o===-1/0||l===1/0)return[n,a];if(o===l)return[o];var c=Math.max(r,2),u=Wle(new Za(l).sub(o).div(c-1),s,0),d=[...qle(new Za(o),new Za(l),u),l];return s===!1&&(d=d.map(f=>Math.round(f))),n>a?d.reverse():d},Yle=t=>t.rootProps.maxBarSize,YXe=t=>t.rootProps.barGap,Jle=t=>t.rootProps.barCategoryGap,JXe=t=>t.rootProps.barSize,oN=t=>t.rootProps.stackOffset,Zle=t=>t.rootProps.reverseStackOrder,KM=t=>t.options.chartName,qM=t=>t.rootProps.syncId,ece=t=>t.rootProps.syncMethod,zM=t=>t.options.eventEmitter,sc={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Hh={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Iu={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},i4=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},ZXe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Hh.angleAxisId,includeHidden:!1,name:void 0,reversed:Hh.reversed,scale:Hh.scale,tick:Hh.tick,tickCount:void 0,ticks:void 0,type:Hh.type,unit:void 0},eYe={allowDataOverflow:Iu.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Iu.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Iu.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Iu.scale,tick:Iu.tick,tickCount:Iu.tickCount,ticks:void 0,type:Iu.type,unit:void 0},tYe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Hh.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Hh.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Hh.scale,tick:Hh.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},rYe={allowDataOverflow:Iu.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Iu.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Iu.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Iu.scale,tick:Iu.tick,tickCount:Iu.tickCount,ticks:void 0,type:"category",unit:void 0},WM=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?tYe:ZXe,XM=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?rYe:eYe,o4=t=>t.polarOptions,YM=tr([UA,QA,Mo],Woe),tce=tr([o4,YM],(t,e)=>{if(t!=null)return oc(t.innerRadius,e,0)}),rce=tr([o4,YM],(t,e)=>{if(t!=null)return oc(t.outerRadius,e,e*.8)}),nYe=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},nce=tr([o4],nYe);tr([WM,nce],i4);var ace=tr([YM,tce,rce],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});tr([XM,ace],i4);var sce=tr([Ba,o4,tce,rce,UA,QA],(t,e,r,n,a,s)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=e;return{cx:oc(o,a,a/2),cy:oc(l,s,s/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Ys=(t,e)=>e,lN=(t,e,r)=>r;function JM(t){return t==null?void 0:t.id}function ice(t,e,r){var{chartData:n=[]}=e,{allowDuplicatedCategory:a,dataKey:s}=r,o=new Map;return t.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=JM(l);u.forEach((f,A)=>{var h=s==null||a?A:String(Os(f,s,null)),m=Os(f,l.dataKey,0),p;o.has(h)?p=o.get(h):p={},Object.assign(p,{[d]:m}),o.set(h,p)})}}),Array.from(o.values())}function l4(t){return"stackId"in t&&t.stackId!=null&&t.dataKey!=null}var c4=(t,e)=>t===e?!0:t==null||e==null?!1:t[0]===e[0]&&t[1]===e[1];function u4(t,e){return Array.isArray(t)&&Array.isArray(e)&&t.length===0&&e.length===0?!0:t===e}function aYe(t,e){if(t.length===e.length){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}var Uo=t=>{var e=Ba(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},j1=t=>t.tooltip.settings.axisId;function Gq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function $I(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Gq(Object(r),!0).forEach(function(n){sYe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function sYe(t,e,r){return(e=iYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iYe(t){var e=oYe(t,"string");return typeof e=="symbol"?e:e+""}function oYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var dO=[0,"auto"],Ko={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},oce=(t,e)=>t.cartesianAxis.xAxis[e],$A=(t,e)=>{var r=oce(t,e);return r??Ko},qo={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:dO,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:eN},lce=(t,e)=>t.cartesianAxis.yAxis[e],GA=(t,e)=>{var r=lce(t,e);return r??qo},lYe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},ZM=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??lYe},gi=(t,e,r)=>{switch(e){case"xAxis":return $A(t,r);case"yAxis":return GA(t,r);case"zAxis":return ZM(t,r);case"angleAxis":return WM(t,r);case"radiusAxis":return XM(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},cYe=(t,e,r)=>{switch(e){case"xAxis":return $A(t,r);case"yAxis":return GA(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},cN=(t,e,r)=>{switch(e){case"xAxis":return $A(t,r);case"yAxis":return GA(t,r);case"angleAxis":return WM(t,r);case"radiusAxis":return XM(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},cce=t=>t.graphicalItems.cartesianItems.some(e=>e.type==="bar")||t.graphicalItems.polarItems.some(e=>e.type==="radialBar");function e8(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var t8=t=>t.graphicalItems.cartesianItems,uYe=tr([Ys,lN],e8),r8=(t,e,r)=>t.filter(r).filter(n=>(e==null?void 0:e.includeHidden)===!0?!0:!n.hide),uN=tr([t8,gi,uYe],r8,{memoizeOptions:{resultEqualityCheck:u4}}),uce=tr([uN],t=>t.filter(e=>e.type==="area"||e.type==="bar").filter(l4)),dce=t=>t.filter(e=>!("stackId"in e)||e.stackId===void 0),dYe=tr([uN],dce),n8=t=>t.map(e=>e.data).filter(Boolean).flat(1),fYe=tr([uN],n8,{memoizeOptions:{resultEqualityCheck:u4}}),a8=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=e;return t.length>0?t:r.slice(n,a+1)},s8=tr([fYe,Dle],a8),i8=(t,e,r)=>(e==null?void 0:e.dataKey)!=null?t.map(n=>({value:Os(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(a=>({value:Os(a,n)}))):t.map(n=>({value:n})),d4=tr([s8,gi,uN],i8);function fce(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function EE(t){if(fh(t)||t instanceof Date){var e=Number(t);if(pi(e))return e}}function Kq(t){if(Array.isArray(t)){var e=[EE(t[0]),EE(t[1])];return Fm(e)?e:void 0}var r=EE(t);if(r!=null)return[r,r]}function IA(t){return t.map(EE).filter(bHe)}function hYe(t,e,r){return!r||typeof e!="number"||dh(e)?[]:r.length?IA(r.flatMap(n=>{var a=Os(t,n.dataKey),s,o;if(Array.isArray(a)?[s,o]=a:s=o=a,!(!pi(s)||!pi(o)))return[e-s,e+o]})):[]}var Qo=t=>{var e=Uo(t),r=j1(t);return cN(t,e,r)},dN=tr([Qo],t=>t==null?void 0:t.dataKey),AYe=tr([uce,Dle,Qo],ice),hce=(t,e,r,n)=>{var a={},s=e.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},a);return Object.fromEntries(Object.entries(s).map(o=>{var[l,c]=o,u=n?[...c].reverse():c,d=u.map(JM);return[l,{stackedData:LGe(t,d,r),graphicalItems:u}]}))},fO=tr([AYe,uce,oN,Zle],hce),Ace=(t,e,r,n)=>{var{dataStartIndex:a,dataEndIndex:s}=e;if(n==null&&r!=="zAxis"){var o=$Ge(t,a,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},mYe=tr([gi],t=>t.allowDataOverflow),o8=t=>{var e;if(t==null||!("domain"in t))return dO;if(t.domain!=null)return t.domain;if("ticks"in t&&t.ticks!=null){if(t.type==="number"){var r=IA(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t==null?void 0:t.domain)!==null&&e!==void 0?e:dO},l8=tr([gi],o8),c8=tr([l8,mYe],Rle),pYe=tr([fO,HA,Ys,c8],Ace,{memoizeOptions:{resultEqualityCheck:c4}}),f4=t=>t.errorBars,gYe=(t,e,r)=>t.flatMap(n=>e[n.id]).filter(Boolean).filter(n=>fce(r,n)),GI=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var s=a.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},u8=(t,e,r,n,a)=>{var s,o;if(r.length>0&&t.forEach(l=>{r.forEach(c=>{var u,d,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(v=>fce(a,v)),A=Os(l,(d=e.dataKey)!==null&&d!==void 0?d:c.dataKey),h=hYe(l,A,f);if(h.length>=2){var m=Math.min(...h),p=Math.max(...h);(s==null||m<s)&&(s=m),(o==null||p>o)&&(o=p)}var x=Kq(A);x!=null&&(s=s==null?x[0]:Math.min(s,x[0]),o=o==null?x[1]:Math.max(o,x[1]))})}),(e==null?void 0:e.dataKey)!=null&&t.forEach(l=>{var c=Kq(Os(l,e.dataKey));c!=null&&(s=s==null?c[0]:Math.min(s,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),pi(s)&&pi(o))return[s,o]},xYe=tr([s8,gi,dYe,f4,Ys],u8,{memoizeOptions:{resultEqualityCheck:c4}});function vYe(t){var{value:e}=t;if(fh(e)||e instanceof Date)return e}var yYe=(t,e,r)=>{var n=t.map(vYe).filter(a=>a!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&fie(n))?rle(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},mce=t=>t.referenceElements.dots,P1=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),bYe=tr([mce,Ys,lN],P1),pce=t=>t.referenceElements.areas,wYe=tr([pce,Ys,lN],P1),gce=t=>t.referenceElements.lines,NYe=tr([gce,Ys,lN],P1),xce=(t,e)=>{if(t!=null){var r=IA(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},CYe=tr(bYe,Ys,xce),vce=(t,e)=>{if(t!=null){var r=IA(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},_Ye=tr([wYe,Ys],vce);function EYe(t){var e;if(t.x!=null)return IA([t.x]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.x);return r==null||r.length===0?[]:IA(r)}function SYe(t){var e;if(t.y!=null)return IA([t.y]);var r=(e=t.segment)===null||e===void 0?void 0:e.map(n=>n.y);return r==null||r.length===0?[]:IA(r)}var yce=(t,e)=>{if(t!=null){var r=t.flatMap(n=>e==="xAxis"?EYe(n):SYe(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},IYe=tr([NYe,Ys],yce),jYe=tr(CYe,IYe,_Ye,(t,e,r)=>GI(t,r,e)),d8=(t,e,r,n,a,s,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?GI(n,s,a):GI(s,a);return UXe(e,u,t.allowDataOverflow)},PYe=tr([gi,l8,c8,pYe,xYe,jYe,Ba,Ys],d8,{memoizeOptions:{resultEqualityCheck:c4}}),TYe=[0,1],f8=(t,e,r,n,a,s,o)=>{if(!((t==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=t,u=Kg(e,s);if(u&&l==null){var d;return rle(0,(d=r==null?void 0:r.length)!==null&&d!==void 0?d:0)}return c==="category"?yYe(n,t,u):a==="expand"?TYe:o}},h8=tr([gi,Ba,s8,d4,oN,Ys,PYe],f8),bce=(t,e,r,n,a)=>{if(t!=null){var{scale:s,type:o}=t;if(s==="auto")return e==="radial"&&a==="radiusAxis"?"band":e==="radial"&&a==="angleAxis"?"linear":o==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof s=="string"){var l="scale".concat(Ww(s));return l in ab?l:"point"}}},T1=tr([gi,Ba,cce,KM,Ys],bce);function BYe(t){if(t!=null){if(t in ab)return ab[t]();var e="scale".concat(Ww(t));if(e in ab)return ab[e]()}}function A8(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var a=BYe(e);if(a!=null){var s=a.domain(r).range(n);return FGe(s),s}}}var m8=(t,e,r)=>{var n=o8(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Fm(t))return WXe(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&Fm(t))return XXe(t,e.tickCount,e.allowDecimals)}},p8=tr([h8,cN,T1],m8),g8=(t,e,r,n)=>{if(n!=="angleAxis"&&(t==null?void 0:t.type)==="number"&&Fm(e)&&Array.isArray(r)&&r.length>0){var a=e[0],s=r[0],o=e[1],l=r[r.length-1];return[Math.min(a,s),Math.max(o,l)]}return e},kYe=tr([gi,h8,p8,Ys],g8),FYe=tr(d4,gi,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(IA(t.map(f=>f.value))).sort((f,A)=>f-A),a=n[0],s=n[n.length-1];if(a==null||s==null)return 1/0;var o=s-a;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],u=n[l+1];if(!(c==null||u==null)){var d=u-c;r=Math.min(r,d)}}return r/o}}),wce=tr(FYe,Ba,Jle,Mo,(t,e,r,n,a)=>a,(t,e,r,n,a)=>{if(!pi(t))return 0;var s=e==="vertical"?n.height:n.width;if(a==="gap")return t*s/2;if(a==="no-gap"){var o=oc(r,t*s),l=t*s/2;return l-o-(l-o)/s*o}return 0}),OYe=(t,e,r)=>{var n=$A(t,e);return n==null||typeof n.padding!="string"?0:wce(t,"xAxis",e,r,n.padding)},DYe=(t,e,r)=>{var n=GA(t,e);return n==null||typeof n.padding!="string"?0:wce(t,"yAxis",e,r,n.padding)},RYe=tr($A,OYe,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:a}=t;return typeof a=="string"?{left:e,right:e}:{left:((r=a.left)!==null&&r!==void 0?r:0)+e,right:((n=a.right)!==null&&n!==void 0?n:0)+e}}),MYe=tr(GA,DYe,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:a}=t;return typeof a=="string"?{top:e,bottom:e}:{top:((r=a.top)!==null&&r!==void 0?r:0)+e,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+e}}),LYe=tr([Mo,RYe,$P,HP,(t,e,r)=>r],(t,e,r,n,a)=>{var{padding:s}=n;return a?[s.left,r.width-s.right]:[t.left+e.left,t.left+t.width-e.right]}),UYe=tr([Mo,Ba,MYe,$P,HP,(t,e,r)=>r],(t,e,r,n,a,s)=>{var{padding:o}=a;return s?[n.height-o.bottom,o.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),fN=(t,e,r,n)=>{var a;switch(e){case"xAxis":return LYe(t,r,n);case"yAxis":return UYe(t,r,n);case"zAxis":return(a=ZM(t,r))===null||a===void 0?void 0:a.range;case"angleAxis":return nce(t);case"radiusAxis":return ace(t,r);default:return}},Nce=tr([gi,fN],i4),h4=tr([gi,T1,kYe,Nce],A8);tr([uN,f4,Ys],gYe);function Cce(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var A4=(t,e)=>e,m4=(t,e,r)=>r,QYe=tr(QP,A4,m4,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(Cce)),VYe=tr(VP,A4,m4,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(Cce)),_ce=(t,e)=>({width:t.width,height:e.height}),HYe=(t,e)=>{var r=typeof e.width=="number"?e.width:eN;return{width:r,height:t.height}},Ece=tr(Mo,$A,_ce),$Ye=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},GYe=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},KYe=tr(QA,Mo,QYe,A4,m4,(t,e,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=_ce(e,l);o==null&&(o=$Ye(e,n,t));var u=n==="top"&&!a||n==="bottom"&&a;s[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),s}),qYe=tr(UA,Mo,VYe,A4,m4,(t,e,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=HYe(e,l);o==null&&(o=GYe(e,n,t));var u=n==="left"&&!a||n==="right"&&a;s[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),s}),zYe=(t,e)=>{var r=$A(t,e);if(r!=null)return KYe(t,r.orientation,r.mirror)},WYe=tr([Mo,$A,zYe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r==null?void 0:r[n];return a==null?{x:t.left,y:0}:{x:t.left,y:a}}}),XYe=(t,e)=>{var r=GA(t,e);if(r!=null)return qYe(t,r.orientation,r.mirror)},YYe=tr([Mo,GA,XYe,(t,e)=>e],(t,e,r,n)=>{if(e!=null){var a=r==null?void 0:r[n];return a==null?{x:0,y:t.top}:{x:a,y:t.top}}}),Sce=tr(Mo,GA,(t,e)=>{var r=typeof e.width=="number"?e.width:eN;return{width:r,height:t.height}}),qq=(t,e,r)=>{switch(e){case"xAxis":return Ece(t,r).width;case"yAxis":return Sce(t,r).height;default:return}},Ice=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:s,dataKey:o}=r,l=Kg(t,n),c=e.map(u=>u.value);if(o&&l&&s==="category"&&a&&fie(c))return c}},x8=tr([Ba,d4,gi,Ys],Ice),jce=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:s}=r,o=Kg(t,n);if(o&&(a==="number"||s!=="auto"))return e.map(l=>l.value)}},v8=tr([Ba,d4,cN,Ys],jce);tr([Ba,cYe,T1,h4,x8,v8,fN,p8,Ys],(t,e,r,n,a,s,o,l,c)=>{if(e!=null){var u=Kg(t,c);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:c,categoricalDomain:s,duplicateDomain:a,isCategorical:u,niceTicks:l,range:o,realScaleType:r,scale:n}}});var JYe=(t,e,r,n,a,s,o,l,c)=>{if(!(e==null||n==null)){var u=Kg(t,c),{type:d,ticks:f,tickCount:A}=e,h=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,m=d==="category"&&n.bandwidth?n.bandwidth()/h:0;m=c==="angleAxis"&&s!=null&&s.length>=2?Tl(s[0]-s[1])*2*m:m;var p=f||a;if(p){var x=p.map((v,y)=>{var b=o?o.indexOf(v):v;return{index:y,coordinate:n(b)+m,value:v,offset:m}});return x.filter(v=>pi(v.coordinate))}return u&&l?l.map((v,y)=>({coordinate:n(v)+m,value:v,index:y,offset:m})).filter(v=>pi(v.coordinate)):n.ticks?n.ticks(A).map(v=>({coordinate:n(v)+m,value:v,offset:m})):n.domain().map((v,y)=>({coordinate:n(v)+m,value:o?o[v]:v,index:y,offset:m}))}},Pce=tr([Ba,cN,T1,h4,p8,fN,x8,v8,Ys],JYe),ZYe=(t,e,r,n,a,s,o)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var l=Kg(t,o),{tickCount:c}=e,u=0;return u=o==="angleAxis"&&(n==null?void 0:n.length)>=2?Tl(n[0]-n[1])*2*u:u,l&&s?s.map((d,f)=>({coordinate:r(d)+u,value:d,index:f,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,f)=>({coordinate:r(d)+u,value:a?a[d]:d,index:f,offset:u}))}},Zv=tr([Ba,cN,h4,fN,x8,v8,Ys],ZYe),e1=tr(gi,h4,(t,e)=>{if(!(t==null||e==null))return $I($I({},t),{},{scale:e})}),eJe=tr([gi,T1,h8,Nce],A8);tr((t,e,r)=>ZM(t,r),eJe,(t,e)=>{if(!(t==null||e==null))return $I($I({},t),{},{scale:e})});var tJe=tr([Ba,QP,VP],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),Tce=t=>t.options.defaultTooltipEventType,Bce=t=>t.options.validateTooltipEventTypes;function kce(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function y8(t,e){var r=Tce(t),n=Bce(t);return kce(e,r,n)}function rJe(t){return yn(e=>y8(e,t))}var Fce=(t,e)=>{var r,n=Number(e);if(!(dh(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},nJe=t=>t.tooltip.settings,H0={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},aJe={itemInteraction:{click:H0,hover:H0},axisInteraction:{click:H0,hover:H0},keyboardInteraction:H0,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},Oce=fu({name:"tooltip",initialState:aJe,reducers:{addTooltipEntrySettings:{reducer(t,e){t.tooltipItemPayloads.push(e.payload)},prepare:Qs()},replaceTooltipEntrySettings:{reducer(t,e){var{prev:r,next:n}=e.payload,a=yf(t).tooltipItemPayloads.indexOf(r);a>-1&&(t.tooltipItemPayloads[a]=n)},prepare:Qs()},removeTooltipEntrySettings:{reducer(t,e){var r=yf(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},prepare:Qs()},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.graphicalItemId=e.payload.activeGraphicalItemId,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate}}}),{addTooltipEntrySettings:sJe,replaceTooltipEntrySettings:iJe,removeTooltipEntrySettings:oJe,setTooltipSettingsState:lJe,setActiveMouseOverItemIndex:Dce,mouseLeaveItem:cJe,mouseLeaveChart:Rce,setActiveClickItemIndex:uJe,setMouseOverAxisIndex:Mce,setMouseClickAxisIndex:dJe,setSyncInteraction:hO,setKeyboardInteraction:AO}=Oce.actions,fJe=Oce.reducer;function zq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function j_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zq(Object(r),!0).forEach(function(n){hJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hJe(t,e,r){return(e=AJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AJe(t){var e=mJe(t,"string");return typeof e=="symbol"?e:e+""}function mJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pJe(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function gJe(t){return t.index!=null}var Lce=(t,e,r,n)=>{if(e==null)return H0;var a=pJe(t,e,r);if(a==null)return H0;if(a.active)return a;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var s=t.settings.active===!0;if(gJe(a)){if(s)return j_(j_({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return j_(j_({},H0),{},{coordinate:a.coordinate})};function xJe(t){if(typeof t=="number")return Number.isFinite(t)?t:void 0;if(t instanceof Date){var e=t.valueOf();return Number.isFinite(e)?e:void 0}var r=Number(t);return Number.isFinite(r)?r:void 0}function vJe(t,e){var r=xJe(t),n=e[0],a=e[1];if(r===void 0)return!1;var s=Math.min(n,a),o=Math.max(n,a);return r>=s&&r<=o}function yJe(t,e,r){if(r==null||e==null)return!0;var n=Os(t,e);return n==null||!Fm(r)?!0:vJe(n,r)}var b8=(t,e,r,n)=>{var a=t==null?void 0:t.index;if(a==null)return null;var s=Number(a);if(!pi(s))return a;var o=0,l=1/0;e.length>0&&(l=e.length-1);var c=Math.max(o,Math.min(s,l)),u=e[c];return u==null||yJe(u,r,n)?String(c):null},Uce=(t,e,r,n,a,s,o,l)=>{if(!(s==null||l==null)){var c=o[0],u=c==null?void 0:l(c.positions,s);if(u!=null)return u;var d=a==null?void 0:a[Number(s)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+e)/2};default:return{x:(n.left+t)/2,y:d.coordinate}}}},Qce=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var a;if(r==="hover"?a=t.itemInteraction.hover.graphicalItemId:a=t.itemInteraction.click.graphicalItemId,a==null&&n!=null){var s=t.tooltipItemPayloads[0];return s!=null?[s]:[]}return t.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===a})},hN=t=>t.options.tooltipPayloadSearcher,B1=t=>t.tooltip;function Wq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Xq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Wq(Object(r),!0).forEach(function(n){bJe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Wq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bJe(t,e,r){return(e=wJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wJe(t){var e=NJe(t,"string");return typeof e=="symbol"?e:e+""}function NJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CJe(t,e){return t??e}var Vce=(t,e,r,n,a,s,o)=>{if(!(e==null||s==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return t.reduce((A,h)=>{var m,{dataDefinedOnItem:p,settings:x}=h,v=CJe(p,l),y=Array.isArray(v)?yoe(v,u,d):v,b=(m=x==null?void 0:x.dataKey)!==null&&m!==void 0?m:n,w=x==null?void 0:x.nameKey,j;if(n&&Array.isArray(y)&&!Array.isArray(y[0])&&o==="axis"?j=yHe(y,n,a):j=s(y,e,c,w),Array.isArray(j))j.forEach(C=>{var S=Xq(Xq({},x),{},{name:C.name,unit:C.unit,color:void 0,fill:void 0});A.push(iK({tooltipEntrySettings:S,dataKey:C.dataKey,payload:C.payload,value:Os(C.payload,C.dataKey),name:C.name}))});else{var I;A.push(iK({tooltipEntrySettings:x,dataKey:b,payload:j,value:Os(j,b),name:(I=Os(j,w))!==null&&I!==void 0?I:x==null?void 0:x.name}))}return A},f)}},w8=tr([Qo,Ba,cce,KM,Uo],bce),_Je=tr([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),EJe=tr([Uo,j1],e8),k1=tr([_Je,Qo,EJe],r8,{memoizeOptions:{resultEqualityCheck:u4}}),SJe=tr([k1],t=>t.filter(l4)),IJe=tr([k1],n8,{memoizeOptions:{resultEqualityCheck:u4}}),F1=tr([IJe,HA],a8),jJe=tr([SJe,HA,Qo],ice),N8=tr([F1,Qo,k1],i8),Hce=tr([Qo],o8),PJe=tr([Qo],t=>t.allowDataOverflow),$ce=tr([Hce,PJe],Rle),TJe=tr([k1],t=>t.filter(l4)),BJe=tr([jJe,TJe,oN,Zle],hce),kJe=tr([BJe,HA,Uo,$ce],Ace),FJe=tr([k1],dce),OJe=tr([F1,Qo,FJe,f4,Uo],u8,{memoizeOptions:{resultEqualityCheck:c4}}),DJe=tr([mce,Uo,j1],P1),RJe=tr([DJe,Uo],xce),MJe=tr([pce,Uo,j1],P1),LJe=tr([MJe,Uo],vce),UJe=tr([gce,Uo,j1],P1),QJe=tr([UJe,Uo],yce),VJe=tr([RJe,QJe,LJe],GI),HJe=tr([Qo,Hce,$ce,kJe,OJe,VJe,Ba,Uo],d8),AN=tr([Qo,Ba,F1,N8,oN,Uo,HJe],f8),$Je=tr([AN,Qo,w8],m8),GJe=tr([Qo,AN,$Je,Uo],g8),Gce=t=>{var e=Uo(t),r=j1(t),n=!1;return fN(t,e,r,n)},Kce=tr([Qo,Gce],i4),qce=tr([Qo,w8,GJe,Kce],A8),KJe=tr([Ba,N8,Qo,Uo],Ice),qJe=tr([Ba,N8,Qo,Uo],jce),zJe=(t,e,r,n,a,s,o,l)=>{if(e){var{type:c}=e,u=Kg(t,l);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=l==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?Tl(a[0]-a[1])*2*f:f,u&&o?o.map((A,h)=>({coordinate:n(A)+f,value:A,index:h,offset:f})):n.domain().map((A,h)=>({coordinate:n(A)+f,value:s?s[A]:A,index:h,offset:f}))}}},KA=tr([Ba,Qo,w8,qce,Gce,KJe,qJe,Uo],zJe),C8=tr([Tce,Bce,nJe],(t,e,r)=>kce(r.shared,t,e)),zce=t=>t.tooltip.settings.trigger,_8=t=>t.tooltip.settings.defaultIndex,mN=tr([B1,C8,zce,_8],Lce),Ig=tr([mN,F1,dN,AN],b8),Wce=tr([KA,Ig],Fce),E8=tr([mN],t=>{if(t)return t.dataKey}),WJe=tr([mN],t=>{if(t)return t.graphicalItemId}),Xce=tr([B1,C8,zce,_8],Qce),XJe=tr([UA,QA,Ba,Mo,KA,_8,Xce,hN],Uce),YJe=tr([mN,XJe],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),JJe=tr([mN],t=>{var e;return(e=t==null?void 0:t.active)!==null&&e!==void 0?e:!1}),ZJe=tr([Xce,Ig,HA,dN,Wce,hN,C8],Vce);tr([ZJe],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function Yq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Jq(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yq(Object(r),!0).forEach(function(n){eZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function eZe(t,e,r){return(e=tZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tZe(t){var e=rZe(t,"string");return typeof e=="symbol"?e:e+""}function rZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nZe=()=>yn(Qo),aZe=()=>{var t=nZe(),e=yn(KA),r=yn(qce);return CI(!t||!r?void 0:Jq(Jq({},t),{},{scale:r}),e)};function Zq(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Nx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zq(Object(r),!0).forEach(function(n){sZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zq(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function sZe(t,e,r){return(e=iZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iZe(t){var e=oZe(t,"string");return typeof e=="symbol"?e:e+""}function oZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lZe=(t,e,r,n)=>{var a=e.find(s=>s&&s.index===r);if(a){if(t==="horizontal")return{x:a.coordinate,y:n.chartY};if(t==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},cZe=(t,e,r,n)=>{var a=e.find(u=>u&&u.index===r);if(a){if(t==="centric"){var s=a.coordinate,{radius:o}=n;return Nx(Nx(Nx({},n),co(n.cx,n.cy,o,s)),{},{angle:s,radius:o})}var l=a.coordinate,{angle:c}=n;return Nx(Nx(Nx({},n),co(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function uZe(t,e){var{chartX:r,chartY:n}=t;return r>=e.left&&r<=e.left+e.width&&n>=e.top&&n<=e.top+e.height}var Yce=(t,e,r,n,a)=>{var s,o=(s=e==null?void 0:e.length)!==null&&s!==void 0?s:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,d,f,A,h=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(u=r[o-1])===null||u===void 0?void 0:u.coordinate,m=(d=r[l])===null||d===void 0?void 0:d.coordinate,p=l>=o-1?(f=r[0])===null||f===void 0?void 0:f.coordinate:(A=r[l+1])===null||A===void 0?void 0:A.coordinate,x=void 0;if(!(h==null||m==null||p==null))if(Tl(m-h)!==Tl(p-m)){var v=[];if(Tl(p-m)===Tl(a[1]-a[0])){x=p;var y=m+a[1]-a[0];v[0]=Math.min(y,(y+h)/2),v[1]=Math.max(y,(y+h)/2)}else{x=h;var b=p+a[1]-a[0];v[0]=Math.min(m,(b+m)/2),v[1]=Math.max(m,(b+m)/2)}var w=[Math.min(m,(x+m)/2),Math.max(m,(x+m)/2)];if(t>w[0]&&t<=w[1]||t>=v[0]&&t<=v[1]){var j;return(j=r[l])===null||j===void 0?void 0:j.index}}else{var I=Math.min(h,p),C=Math.max(h,p);if(t>(I+m)/2&&t<=(C+m)/2){var S;return(S=r[l])===null||S===void 0?void 0:S.index}}}else if(e)for(var E=0;E<o;E++){var B=e[E];if(B!=null){var k=e[E+1],T=e[E-1];if(E===0&&k!=null&&t<=(B.coordinate+k.coordinate)/2||E===o-1&&T!=null&&t>(B.coordinate+T.coordinate)/2||E>0&&E<o-1&&T!=null&&k!=null&&t>(B.coordinate+T.coordinate)/2&&t<=(B.coordinate+k.coordinate)/2)return B.index}}return-1},dZe=()=>yn(KM),S8=(t,e)=>e,Jce=(t,e,r)=>r,I8=(t,e,r,n)=>n,fZe=tr(KA,t=>PP(t,e=>e.coordinate)),j8=tr([B1,S8,Jce,I8],Lce),P8=tr([j8,F1,dN,AN],b8),hZe=(t,e,r)=>{if(e!=null){var n=B1(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},Zce=tr([B1,S8,Jce,I8],Qce),KI=tr([UA,QA,Ba,Mo,KA,I8,Zce,hN],Uce),AZe=tr([j8,KI],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),eue=tr([KA,P8],Fce),mZe=tr([Zce,P8,HA,dN,eue,hN,S8],Vce),pZe=tr([j8,P8],(t,e)=>({isActive:t.active&&e!=null,activeIndex:e})),gZe=(t,e,r,n,a,s,o)=>{if(!(!t||!r||!n||!a)&&uZe(t,o)){var l=GGe(t,e),c=Yce(l,s,a,r,n),u=lZe(e,a,c,t);return{activeIndex:String(c),activeCoordinate:u}}},xZe=(t,e,r,n,a,s,o)=>{if(!(!t||!n||!a||!s||!r)){var l=sze(t,r);if(l){var c=KGe(l,e),u=Yce(c,o,s,n,a),d=cZe(e,s,u,l);return{activeIndex:String(u),activeCoordinate:d}}}},vZe=(t,e,r,n,a,s,o,l)=>{if(!(!t||!e||!n||!a||!s))return e==="horizontal"||e==="vertical"?gZe(t,e,n,a,s,o,l):xZe(t,e,r,n,a,s,o)},yZe=tr(t=>t.zIndex.zIndexMap,(t,e)=>e,(t,e,r)=>r,(t,e,r)=>{if(e!=null){var n=t[e];if(n!=null)return r?n.panoramaElement:n.element}}),bZe=tr(t=>t.zIndex.zIndexMap,t=>{var e=Object.keys(t).map(n=>parseInt(n,10)).concat(Object.values(sc)),r=Array.from(new Set(e));return r.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:aYe}});function ez(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function tz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ez(Object(r),!0).forEach(function(n){wZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ez(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wZe(t,e,r){return(e=NZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NZe(t){var e=CZe(t,"string");return typeof e=="symbol"?e:e+""}function CZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _Ze={},EZe={zIndexMap:Object.values(sc).reduce((t,e)=>tz(tz({},t),{},{[e]:{element:void 0,panoramaElement:void 0,consumers:0}}),_Ze)},SZe=new Set(Object.values(sc));function IZe(t){return SZe.has(t)}var tue=fu({name:"zIndex",initialState:EZe,reducers:{registerZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]?t.zIndexMap[r].consumers+=1:t.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Qs()},unregisterZIndexPortal:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(t.zIndexMap[r].consumers-=1,t.zIndexMap[r].consumers<=0&&!IZe(r)&&delete t.zIndexMap[r])},prepare:Qs()},registerZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r,element:n,isPanorama:a}=e.payload;t.zIndexMap[r]?a?t.zIndexMap[r].panoramaElement=n:t.zIndexMap[r].element=n:t.zIndexMap[r]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:Qs()},unregisterZIndexPortalElement:{reducer:(t,e)=>{var{zIndex:r}=e.payload;t.zIndexMap[r]&&(e.payload.isPanorama?t.zIndexMap[r].panoramaElement=void 0:t.zIndexMap[r].element=void 0)},prepare:Qs()}}}),{registerZIndexPortal:jZe,unregisterZIndexPortal:PZe,registerZIndexPortalElement:TZe,unregisterZIndexPortalElement:BZe}=tue.actions,kZe=tue.reducer;function yh(t){var{zIndex:e,children:r}=t,n=yKe(),a=n&&e!==void 0&&e!==0,s=zu(),o=_s();g.useLayoutEffect(()=>a?(o(jZe({zIndex:e})),()=>{o(PZe({zIndex:e}))}):Xw,[o,e,a]);var l=yn(c=>yZe(c,e,s));return a?l?Lu.createPortal(r,l):null:r}function mO(){return mO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},mO.apply(null,arguments)}function rz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function P_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rz(Object(r),!0).forEach(function(n){FZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function FZe(t,e,r){return(e=OZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OZe(t){var e=DZe(t,"string");return typeof e=="symbol"?e:e+""}function DZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RZe(t){var{cursor:e,cursorComp:r,cursorProps:n}=t;return g.isValidElement(e)?g.cloneElement(e,n):g.createElement(r,n)}function MZe(t){var e,{coordinate:r,payload:n,index:a,offset:s,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:d}=t,f=r,A=n,h=a;if(!c||!f||d!=="ScatterChart"&&u!=="axis")return null;var m,p,x;if(d==="ScatterChart")m=f,p=vqe,x=sc.cursorLine;else if(d==="BarChart")m=yqe(l,f,s,o),p=zoe,x=sc.cursorRectangle;else if(l==="radial"&&Aie(f)){var{cx:v,cy:y,radius:b,startAngle:w,endAngle:j}=Xoe(f);m={cx:v,cy:y,startAngle:w,endAngle:j,innerRadius:b,outerRadius:b},p=Joe,x=sc.cursorLine}else m={points:cze(l,f,s)},p=yM,x=sc.cursorLine;var I=typeof c=="object"&&"className"in c?c.className:void 0,C=P_(P_(P_(P_({stroke:"#ccc",pointerEvents:"none"},s),m),X2(c)),{},{payload:A,payloadIndex:h,className:as("recharts-tooltip-cursor",I)});return g.createElement(yh,{zIndex:(e=t.zIndex)!==null&&e!==void 0?e:x},g.createElement(RZe,{cursor:c,cursorComp:p,cursorProps:C}))}function LZe(t){var e=aZe(),r=xKe(),n=tN(),a=dZe();return e==null||r==null||n==null||a==null?null:g.createElement(MZe,mO({},t,{offset:r,layout:n,tooltipAxisBandSize:e,chartName:a}))}var rue=g.createContext(null),UZe=()=>g.useContext(rue),nue={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,A){if(typeof d!="function")throw new TypeError("The listener must be a function");var h=new a(d,f||c,A),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],h]:c._events[m].push(h):(c._events[m]=h,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)e.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var A=0,h=f.length,m=new Array(h);A<h;A++)m[A]=f[A].fn;return m},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,A,h,m){var p=r?r+u:u;if(!this._events[p])return!1;var x=this._events[p],v=arguments.length,y,b;if(x.fn){switch(x.once&&this.removeListener(u,x.fn,void 0,!0),v){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,d),!0;case 3:return x.fn.call(x.context,d,f),!0;case 4:return x.fn.call(x.context,d,f,A),!0;case 5:return x.fn.call(x.context,d,f,A,h),!0;case 6:return x.fn.call(x.context,d,f,A,h,m),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];x.fn.apply(x.context,y)}else{var w=x.length,j;for(b=0;b<w;b++)switch(x[b].once&&this.removeListener(u,x[b].fn,void 0,!0),v){case 1:x[b].fn.call(x[b].context);break;case 2:x[b].fn.call(x[b].context,d);break;case 3:x[b].fn.call(x[b].context,d,f);break;case 4:x[b].fn.call(x[b].context,d,f,A);break;default:if(!y)for(j=1,y=new Array(v-1);j<v;j++)y[j-1]=arguments[j];x[b].fn.apply(x[b].context,y)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,A){var h=r?r+u:u;if(!this._events[h])return this;if(!d)return o(this,h),this;var m=this._events[h];if(m.fn)m.fn===d&&(!A||m.once)&&(!f||m.context===f)&&o(this,h);else{for(var p=0,x=[],v=m.length;p<v;p++)(m[p].fn!==d||A&&!m[p].once||f&&m[p].context!==f)&&x.push(m[p]);x.length?this._events[h]=x.length===1?x[0]:x:o(this,h)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,t.exports=l})(nue);var QZe=nue.exports;const VZe=PA(QZe);var uw=new VZe,pO="recharts.syncEvent.tooltip",nz="recharts.syncEvent.brush";function aue(t,e){if(e){var r=Number.parseInt(e,10);if(!dh(r))return t==null?void 0:t[r]}}var HZe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},sue=fu({name:"options",initialState:HZe,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),$Ze=sue.reducer,{createEventEmitter:GZe}=sue.actions;function KZe(t){return t.tooltip.syncInteraction}var qZe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},iue=fu({name:"chartData",initialState:qZe,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:az,setDataStartEndIndexes:zZe,setComputedData:tot}=iue.actions,WZe=iue.reducer,XZe=["x","y"];function sz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Cx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sz(Object(r),!0).forEach(function(n){YZe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function YZe(t,e,r){return(e=JZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JZe(t){var e=ZZe(t,"string");return typeof e=="symbol"?e:e+""}function ZZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eet(t,e){if(t==null)return{};var r,n,a=tet(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function tet(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function ret(){var t=yn(qM),e=yn(zM),r=_s(),n=yn(ece),a=yn(KA),s=tN(),o=GP(),l=yn(c=>c.rootProps.className);g.useEffect(()=>{if(t==null)return Xw;var c=(u,d,f)=>{if(e!==f&&t===u){if(n==="index"){var A;if(o&&d!==null&&d!==void 0&&(A=d.payload)!==null&&A!==void 0&&A.coordinate&&d.payload.sourceViewBox){var h=d.payload.coordinate,{x:m,y:p}=h,x=eet(h,XZe),{x:v,y,width:b,height:w}=d.payload.sourceViewBox,j=Cx(Cx({},x),{},{x:o.x+(b?(m-v)/b:0)*o.width,y:o.y+(w?(p-y)/w:0)*o.height});r(Cx(Cx({},d),{},{payload:Cx(Cx({},d.payload),{},{coordinate:j})}))}else r(d);return}if(a!=null){var I;if(typeof n=="function"){var C={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},S=n(a,C);I=a[S]}else n==="value"&&(I=a.find(oe=>String(oe.value)===d.payload.label));var{coordinate:E}=d.payload;if(I==null||d.payload.active===!1||E==null||o==null){r(hO({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:B,y:k}=E,T=Math.min(B,o.x+o.width),P=Math.min(k,o.y+o.height),K={x:s==="horizontal"?I.coordinate:T,y:s==="horizontal"?P:I.coordinate},le=hO({active:d.payload.active,coordinate:K,dataKey:d.payload.dataKey,index:String(I.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});r(le)}}};return uw.on(pO,c),()=>{uw.off(pO,c)}},[l,r,e,t,n,a,s,o])}function net(){var t=yn(qM),e=yn(zM),r=_s();g.useEffect(()=>{if(t==null)return Xw;var n=(a,s,o)=>{e!==o&&t===a&&r(zZe(s))};return uw.on(nz,n),()=>{uw.off(nz,n)}},[r,e,t])}function aet(){var t=_s();g.useEffect(()=>{t(GZe())},[t]),ret(),net()}function set(t,e,r,n,a,s){var o=yn(h=>hZe(h,t,e)),l=yn(zM),c=yn(qM),u=yn(ece),d=yn(KZe),f=d==null?void 0:d.active,A=GP();g.useEffect(()=>{if(!f&&c!=null&&l!=null){var h=hO({active:s,coordinate:r,dataKey:o,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:A,graphicalItemId:void 0});uw.emit(pO,c,h,l)}},[f,r,o,a,n,l,c,u,s,A])}function iz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function oz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iz(Object(r),!0).forEach(function(n){iet(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function iet(t,e,r){return(e=oet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oet(t){var e=cet(t,"string");return typeof e=="symbol"?e:e+""}function cet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uet(t){return t.dataKey}function det(t,e){return g.isValidElement(t)?g.cloneElement(t,e):typeof t=="function"?g.createElement(t,e):g.createElement(JKe,e)}var lz=[],fet={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function cz(t){var e,r,n=Fl(t,fet),{active:a,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:d,offset:f,payloadUniqBy:A,position:h,reverseDirection:m,useTranslate3d:p,wrapperStyle:x,cursor:v,shared:y,trigger:b,defaultIndex:w,portal:j,axisId:I}=n,C=_s(),S=typeof w=="number"?String(w):w;g.useEffect(()=>{C(lJe({shared:y,trigger:b,axisId:I,active:a,defaultIndex:S}))},[C,y,b,I,a,S]);var E=GP(),B=Hoe(),k=rJe(y),{activeIndex:T,isActive:P}=(e=yn(X=>pZe(X,k,b,S)))!==null&&e!==void 0?e:{},K=yn(X=>mZe(X,k,b,S)),le=yn(X=>eue(X,k,b,S)),oe=yn(X=>AZe(X,k,b,S)),ie=K,Ae=UZe(),te=(r=a??P)!==null&&r!==void 0?r:!1,[Te,Ue]=$ie([ie,te]),O=k==="axis"?le:void 0;set(k,b,oe,O,T,te);var H=j??Ae;if(H==null||E==null||k==null)return null;var G=ie??lz;te||(G=lz),u&&G.length&&(G=Bie(G.filter(X=>X.value!=null&&(X.hide!==!0||n.includeHidden)),A,uet));var L=G.length>0,W=g.createElement(sqe,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:d,active:te,coordinate:oe,hasPayload:L,offset:f,position:h,reverseDirection:m,useTranslate3d:p,viewBox:E,wrapperStyle:x,lastBoundingBox:Te,innerRef:Ue,hasPortalFromProps:!!j},det(c,oz(oz({},n),{},{payload:G,label:O,active:te,activeIndex:T,coordinate:oe,accessibilityLayer:B})));return g.createElement(g.Fragment,null,Lu.createPortal(W,H),te&&g.createElement(LZe,{cursor:v,tooltipEventType:k,coordinate:oe,payload:G,index:T}))}var pN=t=>null;pN.displayName="Cell";function het(t,e,r){return(e=Aet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Aet(t){var e=met(t,"string");return typeof e=="symbol"?e:e+""}function met(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pet{constructor(e){het(this,"cache",new Map),this.maxSize=e}get(e){var r=this.cache.get(e);return r!==void 0&&(this.cache.delete(e),this.cache.set(e,r)),r}set(e,r){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(e,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function uz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function get(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?uz(Object(r),!0).forEach(function(n){xet(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):uz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function xet(t,e,r){return(e=vet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vet(t){var e=yet(t,"string");return typeof e=="symbol"?e:e+""}function yet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bet={cacheSize:2e3,enableCache:!0},oue=get({},bet),dz=new pet(oue.cacheSize),wet={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},fz="recharts_measurement_span";function Net(t,e){var r=e.fontSize||"",n=e.fontFamily||"",a=e.fontWeight||"",s=e.fontStyle||"",o=e.letterSpacing||"",l=e.textTransform||"";return"".concat(t,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(s,"|").concat(o,"|").concat(l)}var hz=(t,e)=>{try{var r=document.getElementById(fz);r||(r=document.createElement("span"),r.setAttribute("id",fz),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,wet,e),r.textContent="".concat(t);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Hb=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||XP.isSsr)return{width:0,height:0};if(!oue.enableCache)return hz(e,r);var n=Net(e,r),a=dz.get(n);if(a)return a;var s=hz(e,r);return dz.set(n,s),s},lue;function Cet(t,e,r){return(e=_et(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _et(t){var e=Eet(t,"string");return typeof e=="symbol"?e:e+""}function Eet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Az=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,mz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Iet=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,jet=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Pet={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Tet=["cm","mm","pt","pc","in","Q","px"];function Bet(t){return Tet.includes(t)}var nv="NaN";function ket(t,e){return t*Pet[e]}class wl{static parse(e){var r,[,n,a]=(r=jet.exec(e))!==null&&r!==void 0?r:[];return n==null?wl.NaN:new wl(parseFloat(n),a??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,dh(e)&&(this.unit=""),r!==""&&!Iet.test(r)&&(this.num=NaN,this.unit=""),Bet(r)&&(this.num=ket(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new wl(NaN,""):new wl(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new wl(NaN,""):new wl(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new wl(NaN,""):new wl(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new wl(NaN,""):new wl(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return dh(this.num)}}lue=wl;Cet(wl,"NaN",new lue(NaN,""));function cue(t){if(t==null||t.includes(nv))return nv;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,a,s]=(r=Az.exec(e))!==null&&r!==void 0?r:[],o=wl.parse(n??""),l=wl.parse(s??""),c=a==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return nv;e=e.replace(Az,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var u,[,d,f,A]=(u=mz.exec(e))!==null&&u!==void 0?u:[],h=wl.parse(d??""),m=wl.parse(A??""),p=f==="+"?h.add(m):h.subtract(m);if(p.isNaN())return nv;e=e.replace(mz,p.toString())}return e}var pz=/\(([^()]*)\)/;function Fet(t){for(var e=t,r;(r=pz.exec(e))!=null;){var[,n]=r;e=e.replace(pz,cue(n))}return e}function Oet(t){var e=t.replace(/\s+/g,"");return e=Fet(e),e=cue(e),e}function Det(t){try{return Oet(t)}catch{return nv}}function TT(t){var e=Det(t.slice(5,-1));return e===nv?"":e}var Ret=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],Met=["dx","dy","angle","className","breakAll"];function gO(){return gO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gO.apply(null,arguments)}function gz(t,e){if(t==null)return{};var r,n,a=Let(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Let(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var uue=/[ \f\n\r\t\v\u2028\u2029]+/,due=t=>{var{children:e,breakAll:r,style:n}=t;try{var a=[];il(e)||(r?a=e.toString().split(""):a=e.toString().split(uue));var s=a.map(l=>({word:l,width:Hb(l,n).width})),o=r?0:Hb("",n).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function Uet(t){return t==="start"||t==="middle"||t==="end"||t==="inherit"}var fue=(t,e,r,n)=>t.reduce((a,s)=>{var{word:o,width:l}=s,c=a[a.length-1];if(c&&l!=null&&(e==null||n||c.width+l+r<Number(e)))c.words.push(o),c.width+=l+r;else{var u={words:[o],width:l};a.push(u)}return a},[]),hue=t=>t.reduce((e,r)=>e.width>r.width?e:r),Qet="",xz=(t,e,r,n,a,s,o,l)=>{var c=t.slice(0,e),u=due({breakAll:r,style:n,children:c+Qet});if(!u)return[!1,[]];var d=fue(u.wordsWithComputedWidth,s,o,l),f=d.length>a||hue(d).width>Number(s);return[f,d]},Vet=(t,e,r,n,a)=>{var{maxLines:s,children:o,style:l,breakAll:c}=t,u=_n(s),d=String(o),f=fue(e,n,r,a);if(!u||a)return f;var A=f.length>s||hue(f).width>Number(n);if(!A)return f;for(var h=0,m=d.length-1,p=0,x;h<=m&&p<=d.length-1;){var v=Math.floor((h+m)/2),y=v-1,[b,w]=xz(d,y,c,l,s,n,r,a),[j]=xz(d,v,c,l,s,n,r,a);if(!b&&!j&&(h=v+1),b&&j&&(m=v-1),!b&&j){x=w;break}p++}return x||f},vz=t=>{var e=il(t)?[]:t.toString().split(uue);return[{words:e,width:void 0}]},Het=t=>{var{width:e,scaleToFit:r,children:n,style:a,breakAll:s,maxLines:o}=t;if((e||r)&&!XP.isSsr){var l,c,u=due({breakAll:s,children:n,style:a});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;l=d,c=f}else return vz(n);return Vet({breakAll:s,children:n,maxLines:o,style:a},l,c,e,!!r)}return vz(n)},Aue="#808080",$et={angle:0,breakAll:!1,capHeight:"0.71em",fill:Aue,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},p4=g.forwardRef((t,e)=>{var r=Fl(t,$et),{x:n,y:a,lineHeight:s,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:d}=r,f=gz(r,Ret),A=g.useMemo(()=>Het({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:h,dy:m,angle:p,className:x,breakAll:v}=f,y=gz(f,Met);if(!fh(n)||!fh(a)||A.length===0)return null;var b=Number(n)+(_n(h)?h:0),w=Number(a)+(_n(m)?m:0);if(!pi(b)||!pi(w))return null;var j;switch(d){case"start":j=TT("calc(".concat(o,")"));break;case"middle":j=TT("calc(".concat((A.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:j=TT("calc(".concat(A.length-1," * -").concat(s,")"));break}var I=[];if(c){var C=A[0].width,{width:S}=f;I.push("scale(".concat(_n(S)&&_n(C)?S/C:1,")"))}return p&&I.push("rotate(".concat(p,", ").concat(b,", ").concat(w,")")),I.length&&(y.transform=I.join(" ")),g.createElement("text",gO({},Rd(y),{ref:e,x:b,y:w,className:as("recharts-text",x),textAnchor:u,fill:l.includes("url")?Aue:l}),A.map((E,B)=>{var k=E.words.join(v?"":" ");return g.createElement("tspan",{x:b,dy:B===0?j:s,key:"".concat(k,"-").concat(B)},k)}))});p4.displayName="Text";var Get=["labelRef"],Ket=["content"];function yz(t,e){if(t==null)return{};var r,n,a=qet(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function qet(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function bz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ui(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bz(Object(r),!0).forEach(function(n){zet(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function zet(t,e,r){return(e=Wet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wet(t){var e=Xet(t,"string");return typeof e=="symbol"?e:e+""}function Xet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $h(){return $h=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$h.apply(null,arguments)}var mue=g.createContext(null),Yet=t=>{var{x:e,y:r,upperWidth:n,lowerWidth:a,width:s,height:o,children:l}=t,c=g.useMemo(()=>({x:e,y:r,upperWidth:n,lowerWidth:a,width:s,height:o}),[e,r,n,a,s,o]);return g.createElement(mue.Provider,{value:c},l)},pue=()=>{var t=g.useContext(mue),e=GP();return t||Poe(e)},Jet=g.createContext(null),Zet=()=>{var t=g.useContext(Jet),e=yn(sce);return t||e},ett=t=>{var{value:e,formatter:r}=t,n=il(t.children)?e:t.children;return typeof r=="function"?r(n):n},T8=t=>t!=null&&typeof t=="function",ttt=(t,e)=>{var r=Tl(e-t),n=Math.min(Math.abs(e-t),360);return r*n},rtt=(t,e,r,n,a)=>{var{offset:s,className:o}=t,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:A,clockWise:h}=a,m=(u+d)/2,p=ttt(f,A),x=p>=0?1:-1,v,y;switch(e){case"insideStart":v=f+x*s,y=h;break;case"insideEnd":v=A-x*s,y=!h;break;case"end":v=A+x*s,y=h;break;default:throw new Error("Unsupported position ".concat(e))}y=p<=0?y:!y;var b=co(l,c,m,v),w=co(l,c,m,v+(y?1:-1)*359),j="M".concat(b.x,",").concat(b.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(y?0:1,`,
    `).concat(w.x,",").concat(w.y),I=il(t.id)?Y2("recharts-radial-line-"):t.id;return g.createElement("text",$h({},n,{dominantBaseline:"central",className:as("recharts-radial-bar-label",o)}),g.createElement("defs",null,g.createElement("path",{id:I,d:j})),g.createElement("textPath",{xlinkHref:"#".concat(I)},r))},ntt=(t,e,r)=>{var{cx:n,cy:a,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=t,u=(l+c)/2;if(r==="outside"){var{x:d,y:f}=co(n,a,o+e,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var A=(s+o)/2,{x:h,y:m}=co(n,a,A,u);return{x:h,y:m,textAnchor:"middle",verticalAnchor:"middle"}},xO=t=>"cx"in t&&_n(t.cx),att=(t,e)=>{var{parentViewBox:r,offset:n,position:a}=t,s;r!=null&&!xO(r)&&(s=r);var{x:o,y:l,upperWidth:c,lowerWidth:u,height:d}=e,f=o,A=o+(c-u)/2,h=(f+A)/2,m=(c+u)/2,p=f+c/2,x=d>=0?1:-1,v=x*n,y=x>0?"end":"start",b=x>0?"start":"end",w=c>=0?1:-1,j=w*n,I=w>0?"end":"start",C=w>0?"start":"end";if(a==="top"){var S={x:f+c/2,y:l-v,textAnchor:"middle",verticalAnchor:y};return Ui(Ui({},S),s?{height:Math.max(l-s.y,0),width:c}:{})}if(a==="bottom"){var E={x:A+u/2,y:l+d+v,textAnchor:"middle",verticalAnchor:b};return Ui(Ui({},E),s?{height:Math.max(s.y+s.height-(l+d),0),width:u}:{})}if(a==="left"){var B={x:h-j,y:l+d/2,textAnchor:I,verticalAnchor:"middle"};return Ui(Ui({},B),s?{width:Math.max(B.x-s.x,0),height:d}:{})}if(a==="right"){var k={x:h+m+j,y:l+d/2,textAnchor:C,verticalAnchor:"middle"};return Ui(Ui({},k),s?{width:Math.max(s.x+s.width-k.x,0),height:d}:{})}var T=s?{width:m,height:d}:{};return a==="insideLeft"?Ui({x:h+j,y:l+d/2,textAnchor:C,verticalAnchor:"middle"},T):a==="insideRight"?Ui({x:h+m-j,y:l+d/2,textAnchor:I,verticalAnchor:"middle"},T):a==="insideTop"?Ui({x:f+c/2,y:l+v,textAnchor:"middle",verticalAnchor:b},T):a==="insideBottom"?Ui({x:A+u/2,y:l+d-v,textAnchor:"middle",verticalAnchor:y},T):a==="insideTopLeft"?Ui({x:f+j,y:l+v,textAnchor:C,verticalAnchor:b},T):a==="insideTopRight"?Ui({x:f+c-j,y:l+v,textAnchor:I,verticalAnchor:b},T):a==="insideBottomLeft"?Ui({x:A+j,y:l+d-v,textAnchor:C,verticalAnchor:y},T):a==="insideBottomRight"?Ui({x:A+u-j,y:l+d-v,textAnchor:I,verticalAnchor:y},T):a&&typeof a=="object"&&(_n(a.x)||NA(a.x))&&(_n(a.y)||NA(a.y))?Ui({x:o+oc(a.x,m),y:l+oc(a.y,d),textAnchor:"end",verticalAnchor:"end"},T):Ui({x:p,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},T)},stt={angle:0,offset:5,zIndex:sc.label,position:"middle",textBreakAll:!1};function B0(t){var e=Fl(t,stt),{viewBox:r,position:n,value:a,children:s,content:o,className:l="",textBreakAll:c,labelRef:u}=e,d=Zet(),f=pue(),A=n==="center"?f:d??f,h,m,p;if(r==null?h=A:xO(r)?h=r:h=Poe(r),!h||il(a)&&il(s)&&!g.isValidElement(o)&&typeof o!="function")return null;var x=Ui(Ui({},e),{},{viewBox:h});if(g.isValidElement(o)){var{labelRef:v}=x,y=yz(x,Get);return g.cloneElement(o,y)}if(typeof o=="function"){var{content:b}=x,w=yz(x,Ket);if(m=g.createElement(o,w),g.isValidElement(m))return m}else m=ett(e);var j=Rd(e);if(xO(h)){if(n==="insideStart"||n==="insideEnd"||n==="end")return rtt(e,n,m,j,h);p=ntt(h,e.offset,e.position)}else p=att(e,h);return g.createElement(yh,{zIndex:e.zIndex},g.createElement(p4,$h({ref:u,className:as("recharts-label",l)},j,p,{textAnchor:Uet(j.textAnchor)?j.textAnchor:p.textAnchor,breakAll:c}),m))}B0.displayName="Label";var itt=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?g.createElement(B0,$h({key:"label-implicit"},n)):fh(t)?g.createElement(B0,$h({key:"label-implicit",value:t},n)):g.isValidElement(t)?t.type===B0?g.cloneElement(t,Ui({key:"label-implicit"},n)):g.createElement(B0,$h({key:"label-implicit",content:t},n)):T8(t)?g.createElement(B0,$h({key:"label-implicit",content:t},n)):t&&typeof t=="object"?g.createElement(B0,$h({},t,{key:"label-implicit"},n)):null};function ott(t){var{label:e,labelRef:r}=t,n=pue();return itt(e,n,r)||null}var gue={},xue={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(xue);var vue={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(vue);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=xue,r=vue,n=IP;function a(s){if(n.isArrayLike(s))return e.last(r.toArray(s))}t.last=a})(gue);var ltt=gue.last;const ctt=PA(ltt);var utt=["valueAccessor"],dtt=["dataKey","clockWise","id","textBreakAll","zIndex"];function qI(){return qI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qI.apply(null,arguments)}function wz(t,e){if(t==null)return{};var r,n,a=ftt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function ftt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var htt=t=>Array.isArray(t.value)?ctt(t.value):t.value,yue=g.createContext(void 0),Att=yue.Provider,bue=g.createContext(void 0),mtt=bue.Provider;function ptt(){return g.useContext(yue)}function gtt(){return g.useContext(bue)}function SE(t){var{valueAccessor:e=htt}=t,r=wz(t,utt),{dataKey:n,clockWise:a,id:s,textBreakAll:o,zIndex:l}=r,c=wz(r,dtt),u=ptt(),d=gtt(),f=u||d;return!f||!f.length?null:g.createElement(yh,{zIndex:l??sc.label},g.createElement(kc,{className:"recharts-label-list"},f.map((A,h)=>{var m,p=il(n)?e(A,h):Os(A&&A.payload,n),x=il(s)?{}:{id:"".concat(s,"-").concat(h)};return g.createElement(B0,qI({key:"label-".concat(h)},Rd(A),c,x,{fill:(m=r.fill)!==null&&m!==void 0?m:A.fill,parentViewBox:A.parentViewBox,value:p,textBreakAll:o,viewBox:A.viewBox,index:h,zIndex:0}))})))}SE.displayName="LabelList";function wue(t){var{label:e}=t;return e?e===!0?g.createElement(SE,{key:"labelList-implicit"}):g.isValidElement(e)||T8(e)?g.createElement(SE,{key:"labelList-implicit",content:e}):typeof e=="object"?g.createElement(SE,qI({key:"labelList-implicit"},e,{type:String(e.type)})):null:null}var Nue=t=>t.graphicalItems.polarItems,xtt=tr([Ys,lN],e8),g4=tr([Nue,gi,xtt],r8),vtt=tr([g4],n8),x4=tr([vtt,s4],a8),ytt=tr([x4,gi,g4],i8);tr([x4,gi,g4],(t,e,r)=>r.length>0?t.flatMap(n=>r.flatMap(a=>{var s,o=Os(n,(s=e.dataKey)!==null&&s!==void 0?s:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(e==null?void 0:e.dataKey)!=null?t.map(n=>({value:Os(n,e.dataKey),errorDomain:[]})):t.map(n=>({value:n,errorDomain:[]})));var Nz=()=>{},btt=tr([x4,gi,g4,f4,Ys],u8),wtt=tr([gi,l8,c8,Nz,btt,Nz,Ba,Ys],d8),Cue=tr([gi,Ba,x4,ytt,oN,Ys,wtt],f8),Ntt=tr([Cue,gi,T1],m8);tr([gi,Cue,Ntt,Ys],g8);var Ctt={radiusAxis:{},angleAxis:{}},_ue=fu({name:"polarAxis",initialState:Ctt,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:rot,removeRadiusAxis:not,addAngleAxis:aot,removeAngleAxis:sot}=_ue.actions,_tt=_ue.reducer;function Cz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function _z(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cz(Object(r),!0).forEach(function(n){Ett(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ett(t,e,r){return(e=Stt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Stt(t){var e=Itt(t,"string");return typeof e=="symbol"?e:e+""}function Itt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jtt=(t,e)=>e,B8=tr([Nue,jtt],(t,e)=>t.filter(r=>r.type==="pie").find(r=>r.id===e)),Ptt=[],k8=(t,e,r)=>(r==null?void 0:r.length)===0?Ptt:r,Eue=tr([s4,B8,k8],(t,e,r)=>{var{chartData:n}=t;if(e!=null){var a;if((e==null?void 0:e.data)!=null&&e.data.length>0?a=e.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(s=>_z(_z({},e.presentationProps),s.props))),a!=null)return a}}),Ttt=tr([Eue,B8,k8],(t,e,r)=>{if(!(t==null||e==null))return t.map((n,a)=>{var s,o=Os(n,e.nameKey,e.name),l;return r!=null&&(s=r[a])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=e.fill,{value:UP(o,e.dataKey),color:l,payload:n,type:e.legendType}})}),Btt=tr([Eue,B8,k8,Mo],(t,e,r,n)=>{if(!(e==null||t==null))return Frt({offset:n,pieSettings:e,displayedData:t,cells:r})}),Sue={exports:{}},ps={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F8=Symbol.for("react.transitional.element"),O8=Symbol.for("react.portal"),v4=Symbol.for("react.fragment"),y4=Symbol.for("react.strict_mode"),b4=Symbol.for("react.profiler"),w4=Symbol.for("react.consumer"),N4=Symbol.for("react.context"),C4=Symbol.for("react.forward_ref"),_4=Symbol.for("react.suspense"),E4=Symbol.for("react.suspense_list"),S4=Symbol.for("react.memo"),I4=Symbol.for("react.lazy"),ktt=Symbol.for("react.view_transition"),Ftt=Symbol.for("react.client.reference");function $d(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case F8:switch(t=t.type,t){case v4:case b4:case y4:case _4:case E4:case ktt:return t;default:switch(t=t&&t.$$typeof,t){case N4:case C4:case I4:case S4:return t;case w4:return t;default:return e}}case O8:return e}}}ps.ContextConsumer=w4;ps.ContextProvider=N4;ps.Element=F8;ps.ForwardRef=C4;ps.Fragment=v4;ps.Lazy=I4;ps.Memo=S4;ps.Portal=O8;ps.Profiler=b4;ps.StrictMode=y4;ps.Suspense=_4;ps.SuspenseList=E4;ps.isContextConsumer=function(t){return $d(t)===w4};ps.isContextProvider=function(t){return $d(t)===N4};ps.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===F8};ps.isForwardRef=function(t){return $d(t)===C4};ps.isFragment=function(t){return $d(t)===v4};ps.isLazy=function(t){return $d(t)===I4};ps.isMemo=function(t){return $d(t)===S4};ps.isPortal=function(t){return $d(t)===O8};ps.isProfiler=function(t){return $d(t)===b4};ps.isStrictMode=function(t){return $d(t)===y4};ps.isSuspense=function(t){return $d(t)===_4};ps.isSuspenseList=function(t){return $d(t)===E4};ps.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===v4||t===b4||t===y4||t===_4||t===E4||typeof t=="object"&&t!==null&&(t.$$typeof===I4||t.$$typeof===S4||t.$$typeof===N4||t.$$typeof===w4||t.$$typeof===C4||t.$$typeof===Ftt||t.getModuleId!==void 0)};ps.typeOf=$d;Sue.exports=ps;var Ott=Sue.exports,Ez=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",Sz=null,BT=null,Iue=t=>{if(t===Sz&&Array.isArray(BT))return BT;var e=[];return g.Children.forEach(t,r=>{il(r)||(Ott.isFragment(r)?e=e.concat(Iue(r.props.children)):e.push(r))}),BT=e,Sz=t,e};function D8(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(a=>Ez(a)):n=[Ez(e)],Iue(t).forEach(a=>{var s=Ng(a,"type.displayName")||Ng(a,"type.name");s&&n.indexOf(s)!==-1&&r.push(a)}),r}var jue={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${s}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}t.isPlainObject=e})(jue);var Dtt=jue.isPlainObject;const Rtt=PA(Dtt);var Iz,jz,Pz,Tz,Bz;function kz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Fz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kz(Object(r),!0).forEach(function(n){Mtt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Mtt(t,e,r){return(e=Ltt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ltt(t){var e=Utt(t,"string");return typeof e=="symbol"?e:e+""}function Utt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zI(){return zI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zI.apply(null,arguments)}function By(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var Oz=(t,e,r,n,a)=>{var s=r-n,o;return o=_i(Iz||(Iz=By(["M ",",",""])),t,e),o+=_i(jz||(jz=By(["L ",",",""])),t+r,e),o+=_i(Pz||(Pz=By(["L ",",",""])),t+r-s/2,e+a),o+=_i(Tz||(Tz=By(["L ",",",""])),t+r-s/2-n,e+a),o+=_i(Bz||(Bz=By(["L ",","," Z"])),t,e),o},Qtt={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Vtt=t=>{var e=Fl(t,Qtt),{x:r,y:n,upperWidth:a,lowerWidth:s,height:o,className:l}=e,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:f}=e,A=g.useRef(null),[h,m]=g.useState(-1),p=g.useRef(a),x=g.useRef(s),v=g.useRef(o),y=g.useRef(r),b=g.useRef(n),w=JP(t,"trapezoid-");if(g.useEffect(()=>{if(A.current&&A.current.getTotalLength)try{var K=A.current.getTotalLength();K&&m(K)}catch{}},[]),r!==+r||n!==+n||a!==+a||s!==+s||o!==+o||a===0&&s===0||o===0)return null;var j=as("recharts-trapezoid",l);if(!f)return g.createElement("g",null,g.createElement("path",zI({},Rd(e),{className:j,d:Oz(r,n,a,s,o)})));var I=p.current,C=x.current,S=v.current,E=y.current,B=b.current,k="0px ".concat(h===-1?1:h,"px"),T="".concat(h,"px 0px"),P=$oe(["strokeDasharray"],u,c);return g.createElement(YP,{animationId:w,key:w,canBegin:h>0,duration:u,easing:c,isActive:f,begin:d},K=>{var le=So(I,a,K),oe=So(C,s,K),ie=So(S,o,K),Ae=So(E,r,K),te=So(B,n,K);A.current&&(p.current=le,x.current=oe,v.current=ie,y.current=Ae,b.current=te);var Te=K>0?{transition:P,strokeDasharray:T}:{strokeDasharray:k};return g.createElement("path",zI({},Rd(e),{className:j,d:Oz(Ae,te,le,oe,ie),ref:A,style:Fz(Fz({},Te),e.style)}))})},Htt=["option","shapeType","activeClassName"];function $tt(t,e){if(t==null)return{};var r,n,a=Gtt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Gtt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Dz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function WI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Dz(Object(r),!0).forEach(function(n){Ktt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Dz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ktt(t,e,r){return(e=qtt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qtt(t){var e=ztt(t,"string");return typeof e=="symbol"?e:e+""}function ztt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wtt(t,e){return WI(WI({},e),t)}function Xtt(t,e){return t==="symbols"}function Rz(t){var{shapeType:e,elementProps:r}=t;switch(e){case"rectangle":return g.createElement(zoe,r);case"trapezoid":return g.createElement(Vtt,r);case"sector":return g.createElement(Joe,r);case"symbols":if(Xtt(e))return g.createElement(YR,r);break;case"curve":return g.createElement(yM,r);default:return null}}function Ytt(t){return g.isValidElement(t)?t.props:t}function Pue(t){var{option:e,shapeType:r,activeClassName:n="recharts-active-shape"}=t,a=$tt(t,Htt),s;if(g.isValidElement(e))s=g.cloneElement(e,WI(WI({},a),Ytt(e)));else if(typeof e=="function")s=e(a,a.index);else if(Rtt(e)&&typeof e!="boolean"){var o=Wtt(e,a);s=g.createElement(Rz,{shapeType:r,elementProps:o})}else{var l=a;s=g.createElement(Rz,{shapeType:r,elementProps:l})}return a.isActive?g.createElement(kc,{className:n},s):s}var R8=(t,e,r)=>{var n=_s();return(a,s)=>o=>{t==null||t(a,s,o),n(Dce({activeIndex:String(s),activeDataKey:e,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}},M8=t=>{var e=_s();return(r,n)=>a=>{t==null||t(r,n,a),e(cJe())}},L8=(t,e,r)=>{var n=_s();return(a,s)=>o=>{t==null||t(a,s,o),n(uJe({activeIndex:String(s),activeDataKey:e,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}};function Tue(t){var{tooltipEntrySettings:e}=t,r=_s(),n=zu(),a=g.useRef(null);return g.useLayoutEffect(()=>{n||(a.current===null?r(sJe(e)):a.current!==e&&r(iJe({prev:a.current,next:e})),a.current=e)},[e,r,n]),g.useLayoutEffect(()=>()=>{a.current&&(r(oJe(a.current)),a.current=null)},[r]),null}function Jtt(t){var{legendPayload:e}=t,r=_s(),n=zu(),a=g.useRef(null);return g.useLayoutEffect(()=>{n||(a.current===null?r(Uoe(e)):a.current!==e&&r(Qoe({prev:a.current,next:e})),a.current=e)},[r,n,e]),g.useLayoutEffect(()=>()=>{a.current&&(r(Voe(a.current)),a.current=null)},[r]),null}function Ztt(t){var{legendPayload:e}=t,r=_s(),n=yn(Ba),a=g.useRef(null);return g.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(a.current===null?r(Uoe(e)):a.current!==e&&r(Qoe({prev:a.current,next:e})),a.current=e)},[r,n,e]),g.useLayoutEffect(()=>()=>{a.current&&(r(Voe(a.current)),a.current=null)},[r]),null}var kT,ert=()=>{var[t]=g.useState(()=>Y2("uid-"));return t},trt=(kT=mfe.useId)!==null&&kT!==void 0?kT:ert;function rrt(t,e){var r=trt();return e||(t?"".concat(t,"-").concat(r):r)}var nrt=g.createContext(void 0),Bue=t=>{var{id:e,type:r,children:n}=t,a=rrt("recharts-".concat(r),e);return g.createElement(nrt.Provider,{value:a},n(a))},art={cartesianItems:[],polarItems:[]},kue=fu({name:"graphicalItems",initialState:art,reducers:{addCartesianGraphicalItem:{reducer(t,e){t.cartesianItems.push(e.payload)},prepare:Qs()},replaceCartesianGraphicalItem:{reducer(t,e){var{prev:r,next:n}=e.payload,a=yf(t).cartesianItems.indexOf(r);a>-1&&(t.cartesianItems[a]=n)},prepare:Qs()},removeCartesianGraphicalItem:{reducer(t,e){var r=yf(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},prepare:Qs()},addPolarGraphicalItem:{reducer(t,e){t.polarItems.push(e.payload)},prepare:Qs()},removePolarGraphicalItem:{reducer(t,e){var r=yf(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)},prepare:Qs()}}}),{addCartesianGraphicalItem:srt,replaceCartesianGraphicalItem:irt,removeCartesianGraphicalItem:ort,addPolarGraphicalItem:lrt,removePolarGraphicalItem:crt}=kue.actions,urt=kue.reducer,drt=t=>{var e=_s(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(srt(t)):r.current!==t&&e(irt({prev:r.current,next:t})),r.current=t},[e,t]),g.useLayoutEffect(()=>()=>{r.current&&(e(ort(r.current)),r.current=null)},[e]),null},frt=g.memo(drt);function hrt(t){var e=_s();return g.useLayoutEffect(()=>(e(lrt(t)),()=>{e(crt(t))}),[e,t]),null}var Art=["key"],mrt=["onMouseEnter","onClick","onMouseLeave"],prt=["id"],grt=["id"];function Mz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ii(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Mz(Object(r),!0).forEach(function(n){xrt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function xrt(t,e,r){return(e=vrt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vrt(t){var e=yrt(t,"string");return typeof e=="symbol"?e:e+""}function yrt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Om(){return Om=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Om.apply(null,arguments)}function j4(t,e){if(t==null)return{};var r,n,a=brt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function brt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function wrt(t){var e=g.useMemo(()=>D8(t.children,pN),[t.children]),r=yn(n=>Ttt(n,t.id,e));return r==null?null:g.createElement(Ztt,{legendPayload:r})}var Nrt=g.memo(t=>{var{dataKey:e,nameKey:r,sectors:n,stroke:a,strokeWidth:s,fill:o,name:l,hide:c,tooltipType:u,id:d}=t,f={dataDefinedOnItem:n.map(A=>A.tooltipPayload),positions:n.map(A=>A.tooltipPosition),settings:{stroke:a,strokeWidth:s,fill:o,dataKey:e,nameKey:r,name:UP(l,e),hide:c,type:u,color:o,unit:"",graphicalItemId:d}};return g.createElement(Tue,{tooltipEntrySettings:f})}),Crt=(t,e)=>t>e?"start":t<e?"end":"middle",_rt=(t,e,r)=>oc(typeof e=="function"?e(t):e,r,r*.8),Ert=(t,e,r)=>{var{top:n,left:a,width:s,height:o}=e,l=Woe(s,o),c=a+oc(t.cx,s,s/2),u=n+oc(t.cy,o,o/2),d=oc(t.innerRadius,l,0),f=_rt(r,t.outerRadius,l),A=t.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:A}},Srt=(t,e)=>{var r=Tl(e-t),n=Math.min(Math.abs(e-t),360);return r*n};function Irt(t){return t&&typeof t=="object"&&"className"in t&&typeof t.className=="string"?t.className:""}var jrt=(t,e)=>{if(g.isValidElement(t))return g.cloneElement(t,e);if(typeof t=="function")return t(e);var r=as("recharts-pie-label-line",typeof t!="boolean"?t.className:""),{key:n}=e,a=j4(e,Art);return g.createElement(yM,Om({},a,{type:"linear",className:r}))},Prt=(t,e,r)=>{if(g.isValidElement(t))return g.cloneElement(t,e);var n=r;if(typeof t=="function"&&(n=t(e),g.isValidElement(n)))return n;var a=as("recharts-pie-label-text",Irt(t));return g.createElement(p4,Om({},e,{alignmentBaseline:"middle",className:a}),n)};function Trt(t){var{sectors:e,props:r,showLabels:n}=t,{label:a,labelLine:s,dataKey:o}=r;if(!n||!a||!e)return null;var l=uh(r),c=X2(a),u=X2(s),d=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=e.map((A,h)=>{var m=(A.startAngle+A.endAngle)/2,p=co(A.cx,A.cy,A.outerRadius+d,m),x=Ii(Ii(Ii(Ii({},l),A),{},{stroke:"none"},c),{},{index:h,textAnchor:Crt(p.x,A.cx)},p),v=Ii(Ii(Ii(Ii({},l),A),{},{fill:"none",stroke:A.fill},u),{},{index:h,points:[co(A.cx,A.cy,A.outerRadius,m),p],key:"line"});return g.createElement(yh,{zIndex:sc.label,key:"label-".concat(A.startAngle,"-").concat(A.endAngle,"-").concat(A.midAngle,"-").concat(h)},g.createElement(kc,null,s&&jrt(s,v),Prt(a,x,Os(A,o))))});return g.createElement(kc,{className:"recharts-pie-labels"},f)}function Brt(t){var{sectors:e,props:r,showLabels:n}=t,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?g.createElement(wue,{label:a}):g.createElement(Trt,{sectors:e,props:r,showLabels:n})}function krt(t){var{sectors:e,activeShape:r,inactiveShape:n,allOtherPieProps:a,shape:s,id:o}=t,l=yn(Ig),c=yn(E8),u=yn(WJe),{onMouseEnter:d,onClick:f,onMouseLeave:A}=a,h=j4(a,mrt),m=R8(d,a.dataKey,o),p=M8(A),x=L8(f,a.dataKey,o);return e==null||e.length===0?null:g.createElement(g.Fragment,null,e.map((v,y)=>{if((v==null?void 0:v.startAngle)===0&&(v==null?void 0:v.endAngle)===0&&e.length!==1)return null;var b=u==null||u===o,w=String(y)===l&&(c==null||a.dataKey===c)&&b,j=l?n:null,I=r&&w?r:j,C=Ii(Ii({},v),{},{stroke:v.stroke,tabIndex:-1,[woe]:y,[Noe]:o});return g.createElement(kc,Om({key:"sector-".concat(v==null?void 0:v.startAngle,"-").concat(v==null?void 0:v.endAngle,"-").concat(v.midAngle,"-").concat(y),tabIndex:-1,className:"recharts-pie-sector"},Yw(h,v,y),{onMouseEnter:m(v,y),onMouseLeave:p(v,y),onClick:x(v,y)}),g.createElement(Pue,Om({option:s??I,index:y,shapeType:"sector",isActive:w},C)))}))}function Frt(t){var e,{pieSettings:r,displayedData:n,cells:a,offset:s}=t,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,A=Math.abs(r.minAngle),h=Srt(l,c),m=Math.abs(h),p=n.length<=1?0:(e=r.paddingAngle)!==null&&e!==void 0?e:0,x=n.filter(I=>Os(I,u,0)!==0).length,v=(m>=360?x:x-1)*p,y=m-x*A-v,b=n.reduce((I,C)=>{var S=Os(C,u,0);return I+(_n(S)?S:0)},0),w;if(b>0){var j;w=n.map((I,C)=>{var S=Os(I,u,0),E=Os(I,d,C),B=Ert(r,s,I),k=(_n(S)?S:0)/b,T,P=Ii(Ii({},I),a&&a[C]&&a[C].props);C?T=j.endAngle+Tl(h)*p*(S!==0?1:0):T=l;var K=T+Tl(h)*((S!==0?A:0)+k*y),le=(T+K)/2,oe=(B.innerRadius+B.outerRadius)/2,ie=[{name:E,value:S,payload:P,dataKey:u,type:f,graphicalItemId:r.id}],Ae=co(B.cx,B.cy,oe,le);return j=Ii(Ii(Ii(Ii({},r.presentationProps),{},{percent:k,cornerRadius:typeof o=="string"?parseFloat(o):o,name:E,tooltipPayload:ie,midAngle:le,middleRadius:oe,tooltipPosition:Ae},P),B),{},{value:S,dataKey:u,startAngle:T,endAngle:K,payload:P,paddingAngle:Tl(h)*p}),j})}return w}function Ort(t){var{showLabels:e,sectors:r,children:n}=t,a=g.useMemo(()=>!e||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,e]);return g.createElement(mtt,{value:e?a:void 0},n)}function Drt(t){var{props:e,previousSectorsRef:r,id:n}=t,{sectors:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:f,onAnimationEnd:A}=e,h=JP(e,"recharts-pie-"),m=r.current,[p,x]=g.useState(!1),v=g.useCallback(()=>{typeof A=="function"&&A(),x(!1)},[A]),y=g.useCallback(()=>{typeof f=="function"&&f(),x(!0)},[f]);return g.createElement(Ort,{showLabels:!p,sectors:a},g.createElement(YP,{animationId:h,begin:o,duration:l,isActive:s,easing:c,onAnimationStart:y,onAnimationEnd:v,key:h},b=>{var w=[],j=a&&a[0],I=j==null?void 0:j.startAngle;return a==null||a.forEach((C,S)=>{var E=m&&m[S],B=S>0?Ng(C,"paddingAngle",0):0;if(E){var k=So(E.endAngle-E.startAngle,C.endAngle-C.startAngle,b),T=Ii(Ii({},C),{},{startAngle:I+B,endAngle:I+k+B});w.push(T),I=T.endAngle}else{var{endAngle:P,startAngle:K}=C,le=So(0,P-K,b),oe=Ii(Ii({},C),{},{startAngle:I+B,endAngle:I+le+B});w.push(oe),I=oe.endAngle}}),r.current=w,g.createElement(kc,null,g.createElement(krt,{sectors:w,activeShape:u,inactiveShape:d,allOtherPieProps:e,shape:e.shape,id:n}))}),g.createElement(Brt,{showLabels:!p,sectors:a,props:e}),e.children)}var Rrt={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:sc.area};function Mrt(t){var{id:e}=t,r=j4(t,prt),{hide:n,className:a,rootTabIndex:s}=t,o=g.useMemo(()=>D8(t.children,pN),[t.children]),l=yn(d=>Btt(d,e,o)),c=g.useRef(null),u=as("recharts-pie",a);return n||l==null?(c.current=null,g.createElement(kc,{tabIndex:s,className:u})):g.createElement(yh,{zIndex:t.zIndex},g.createElement(Nrt,{dataKey:t.dataKey,nameKey:t.nameKey,sectors:l,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,tooltipType:t.tooltipType,id:e}),g.createElement(kc,{tabIndex:s,className:u},g.createElement(Drt,{props:Ii(Ii({},r),{},{sectors:l}),previousSectorsRef:c,id:e})))}function Fue(t){var e=Fl(t,Rrt),{id:r}=e,n=j4(e,grt),a=uh(n);return g.createElement(Bue,{id:r,type:"pie"},s=>g.createElement(g.Fragment,null,g.createElement(hrt,{type:"pie",id:s,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:e.maxRadius}),g.createElement(wrt,Om({},n,{id:s})),g.createElement(Mrt,Om({},n,{id:s}))))}Fue.displayName="Pie";function Lz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Uz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lz(Object(r),!0).forEach(function(n){Lrt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Lrt(t,e,r){return(e=Urt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Urt(t){var e=Qrt(t,"string");return typeof e=="symbol"?e:e+""}function Qrt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Oue=0,Vrt={xAxis:{},yAxis:{},zAxis:{}},Due=fu({name:"cartesianAxis",initialState:Vrt,reducers:{addXAxis:{reducer(t,e){t.xAxis[e.payload.id]=e.payload},prepare:Qs()},replaceXAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.xAxis[r.id],t.xAxis[n.id]=n)},prepare:Qs()},removeXAxis:{reducer(t,e){delete t.xAxis[e.payload.id]},prepare:Qs()},addYAxis:{reducer(t,e){t.yAxis[e.payload.id]=e.payload},prepare:Qs()},replaceYAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.yAxis[r.id],t.yAxis[n.id]=n)},prepare:Qs()},removeYAxis:{reducer(t,e){delete t.yAxis[e.payload.id]},prepare:Qs()},addZAxis:{reducer(t,e){t.zAxis[e.payload.id]=e.payload},prepare:Qs()},replaceZAxis:{reducer(t,e){var{prev:r,next:n}=e.payload;t.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete t.zAxis[r.id],t.zAxis[n.id]=n)},prepare:Qs()},removeZAxis:{reducer(t,e){delete t.zAxis[e.payload.id]},prepare:Qs()},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload,a=t.yAxis[r];if(a){var s=a.widthHistory||[];if(s.length===3&&s[0]===s[2]&&n===s[1]&&n!==a.width&&Math.abs(n-s[0])<=1)return;var o=[...s,n].slice(-3);t.yAxis[r]=Uz(Uz({},t.yAxis[r]),{},{width:n,widthHistory:o})}}}}),{addXAxis:Hrt,replaceXAxis:$rt,removeXAxis:Grt,addYAxis:Krt,replaceYAxis:qrt,removeYAxis:zrt,addZAxis:iot,replaceZAxis:oot,removeZAxis:lot,updateYAxisWidth:Wrt}=Due.actions,Xrt=Due.reducer,Yrt=tr([Mo],t=>({top:t.top,bottom:t.bottom,left:t.left,right:t.right})),Jrt=tr([Yrt,UA,QA],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),Rue=()=>yn(Jrt),Qz=(t,e,r)=>{var n=r??t;if(!il(n))return oc(n,e,0)},Zrt=(t,e,r)=>{var n={},a=t.filter(l4),s=t.filter(u=>u.stackId==null),o=a.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),n),l=Object.entries(o).map(u=>{var[d,f]=u,A=f.map(m=>m.dataKey),h=Qz(e,r,f[0].barSize);return{stackId:d,dataKeys:A,barSize:h}}),c=s.map(u=>{var d=[u.dataKey].filter(A=>A!=null),f=Qz(e,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...l,...c]};function Vz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function T_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vz(Object(r),!0).forEach(function(n){ent(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ent(t,e,r){return(e=tnt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tnt(t){var e=rnt(t,"string");return typeof e=="symbol"?e:e+""}function rnt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nnt(t,e,r,n,a){var s=n.length;if(!(s<1)){var o=oc(t,r,0,!0),l,c=[];if(pi(n[0].barSize)){var u=!1,d=r/s,f=n.reduce((v,y)=>v+(y.barSize||0),0);f+=(s-1)*o,f>=r&&(f-=(s-1)*o,o=0),f>=r&&d>0&&(u=!0,d*=.9,f=s*d);var A=(r-f)/2>>0,h={offset:A-o,size:0};l=n.reduce((v,y)=>{var b,w={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:h.offset+h.size+o,size:u?d:(b=y.barSize)!==null&&b!==void 0?b:0}},j=[...v,w];return h=j[j.length-1].position,j},c)}else{var m=oc(e,r,0,!0);r-2*m-(s-1)*o<=0&&(o=0);var p=(r-2*m-(s-1)*o)/s;p>1&&(p>>=0);var x=pi(a)?Math.min(p,a):p;l=n.reduce((v,y,b)=>[...v,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:m+(p+o)*b+(p-x)/2,size:x}}],c)}return l}}var ant=(t,e,r,n,a,s,o)=>{var l=il(o)?e:o,c=nnt(r,n,a!==s?a:s,t,l);return a!==s&&c!=null&&(c=c.map(u=>T_(T_({},u),{},{position:T_(T_({},u.position),{},{offset:u.position.offset-a/2})}))),c},snt=(t,e)=>{var r=JM(e);if(!(!t||r==null||e==null)){var{stackId:n}=e;if(n!=null){var a=t[n];if(a){var{stackedData:s}=a;if(s)return s.find(o=>o.key===r)}}}};function int(t,e){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&pi(t.zIndex)?t.zIndex:e}var Mue=t=>{var{chartData:e}=t,r=_s(),n=zu();return g.useEffect(()=>n?()=>{}:(r(az(e)),()=>{r(az(void 0))}),[e,r,n]),null},Hz={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},Lue=fu({name:"brush",initialState:Hz,reducers:{setBrushSettings(t,e){return e.payload==null?Hz:e.payload}}}),{setBrushSettings:cot}=Lue.actions,ont=Lue.reducer;function lnt(t,e,r){return(e=cnt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cnt(t){var e=unt(t,"string");return typeof e=="symbol"?e:e+""}function unt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U8{static create(e){return new U8(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+a}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(e)+s}default:return this.scale(e)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+o}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?e>=n&&e<=a:e>=a&&e<=n}}lnt(U8,"EPS",1e-4);function dnt(t){return(t%180+180)%180}var fnt=function(e){var{width:r,height:n}=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=dnt(a),o=s*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},hnt={dots:[],areas:[],lines:[]},Uue=fu({name:"referenceElements",initialState:hnt,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=yf(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=yf(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=yf(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:uot,removeDot:dot,addArea:fot,removeArea:hot,addLine:Aot,removeLine:mot}=Uue.actions,Ant=Uue.reducer,mnt=g.createContext(void 0),pnt=t=>{var{children:e}=t,[r]=g.useState("".concat(Y2("recharts"),"-clip")),n=Rue();if(n==null)return null;var{x:a,y:s,width:o,height:l}=n;return g.createElement(mnt.Provider,{value:r},g.createElement("defs",null,g.createElement("clipPath",{id:r},g.createElement("rect",{x:a,y:s,height:l,width:o}))),e)};function Que(t,e){if(e<1)return[];if(e===1)return t;for(var r=[],n=0;n<t.length;n+=e){var a=t[n];a!==void 0&&r.push(a)}return r}function gnt(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return fnt(n,r)}function xnt(t,e,r){var n=r==="width",{x:a,y:s,width:o,height:l}=t;return e===1?{start:n?a:s,end:n?a+o:s+l}:{start:n?a+o:s+l,end:n?a:s}}function dw(t,e,r,n,a){if(t*e<t*n||t*e>t*a)return!1;var s=r();return t*(e-t*s/2-n)>=0&&t*(e+t*s/2-a)<=0}function vnt(t,e){return Que(t,e+1)}function ynt(t,e,r,n,a){for(var s=(n||[]).slice(),{start:o,end:l}=e,c=0,u=1,d=o,f=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:Que(n,u)};var p=c,x,v=()=>(x===void 0&&(x=r(m,p)),x),y=m.coordinate,b=c===0||dw(t,y,v,d,l);b||(c=0,d=o,u+=1),b&&(d=y+t*(v()/2+a),c+=u)},A;u<=s.length;)if(A=f(),A)return A.v;return[]}function bnt(t,e,r,n,a){var s=(n||[]).slice(),o=s.length;if(o===0)return[];for(var{start:l,end:c}=e,u=1;u<=o;u++){for(var d=(o-1)%u,f=l,A=!0,h=function(){var y=n[m],b=m,w,j=()=>(w===void 0&&(w=r(y,b)),w),I=y.coordinate,C=m===d||dw(t,I,j,f,c);if(!C)return A=!1,1;C&&(f=I+t*(j()/2+a))},m=d;m<o&&!h();m+=u);if(A){for(var p=[],x=d;x<o;x+=u)p.push(n[x]);return p}}return[]}function $z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Jl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$z(Object(r),!0).forEach(function(n){wnt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$z(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wnt(t,e,r){return(e=Nnt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nnt(t){var e=Cnt(t,"string");return typeof e=="symbol"?e:e+""}function Cnt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _nt(t,e,r,n,a){for(var s=(n||[]).slice(),o=s.length,{start:l}=e,{end:c}=e,u=function(A){var h=s[A],m,p=()=>(m===void 0&&(m=r(h,A)),m);if(A===o-1){var x=t*(h.coordinate+t*p()/2-c);s[A]=h=Jl(Jl({},h),{},{tickCoord:x>0?h.coordinate-x*t:h.coordinate})}else s[A]=h=Jl(Jl({},h),{},{tickCoord:h.coordinate});if(h.tickCoord!=null){var v=dw(t,h.tickCoord,p,l,c);v&&(c=h.tickCoord-t*(p()/2+a),s[A]=Jl(Jl({},h),{},{isShow:!0}))}},d=o-1;d>=0;d--)u(d);return s}function Ent(t,e,r,n,a,s){var o=(n||[]).slice(),l=o.length,{start:c,end:u}=e;if(s){var d=n[l-1],f=r(d,l-1),A=t*(d.coordinate+t*f/2-u);if(o[l-1]=d=Jl(Jl({},d),{},{tickCoord:A>0?d.coordinate-A*t:d.coordinate}),d.tickCoord!=null){var h=dw(t,d.tickCoord,()=>f,c,u);h&&(u=d.tickCoord-t*(f/2+a),o[l-1]=Jl(Jl({},d),{},{isShow:!0}))}}for(var m=s?l-1:l,p=function(y){var b=o[y],w,j=()=>(w===void 0&&(w=r(b,y)),w);if(y===0){var I=t*(b.coordinate-t*j()/2-c);o[y]=b=Jl(Jl({},b),{},{tickCoord:I<0?b.coordinate-I*t:b.coordinate})}else o[y]=b=Jl(Jl({},b),{},{tickCoord:b.coordinate});if(b.tickCoord!=null){var C=dw(t,b.tickCoord,j,c,u);C&&(c=b.tickCoord+t*(j()/2+a),o[y]=Jl(Jl({},b),{},{isShow:!0}))}},x=0;x<m;x++)p(x);return o}function Snt(t,e,r){var{tick:n,ticks:a,viewBox:s,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:d,angle:f}=t;if(!a||!a.length||!n)return[];if(_n(c)||XP.isSsr){var A;return(A=vnt(a,_n(c)?c:0))!==null&&A!==void 0?A:[]}var h=[],m=l==="top"||l==="bottom"?"width":"height",p=d&&m==="width"?Hb(d,{fontSize:e,letterSpacing:r}):{width:0,height:0},x=(b,w)=>{var j=typeof u=="function"?u(b.value,w):b.value;return m==="width"?gnt(Hb(j,{fontSize:e,letterSpacing:r}),p,f):Hb(j,{fontSize:e,letterSpacing:r})[m]},v=a.length>=2?Tl(a[1].coordinate-a[0].coordinate):1,y=xnt(s,v,m);return c==="equidistantPreserveStart"?ynt(v,y,x,a,o):c==="equidistantPreserveEnd"?bnt(v,y,x,a,o):(c==="preserveStart"||c==="preserveStartEnd"?h=Ent(v,y,x,a,o,c==="preserveStartEnd"):h=_nt(v,y,x,a,o),h.filter(b=>b.isShow))}var Int=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:s=0}=t,o=0;if(e){Array.from(e).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=a+s,u=o+c+l+(r?n:0);return Math.round(u)}return 0},jnt=["axisLine","width","height","className","hide","ticks","axisType"];function Pnt(t,e){if(t==null)return{};var r,n,a=Tnt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Tnt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function jg(){return jg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},jg.apply(null,arguments)}function Gz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function so(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Gz(Object(r),!0).forEach(function(n){Bnt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Bnt(t,e,r){return(e=knt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function knt(t){var e=Fnt(t,"string");return typeof e=="symbol"?e:e+""}function Fnt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Jp={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:sc.axis};function Ont(t){var{x:e,y:r,width:n,height:a,orientation:s,mirror:o,axisLine:l,otherSvgProps:c}=t;if(!l)return null;var u=so(so(so({},c),uh(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!o||s==="bottom"&&o);u=so(so({},u),{},{x1:e,y1:r+d*a,x2:e+n,y2:r+d*a})}else{var f=+(s==="left"&&!o||s==="right"&&o);u=so(so({},u),{},{x1:e+f*n,y1:r,x2:e+f*n,y2:r+a})}return g.createElement("line",jg({},u,{className:as("recharts-cartesian-axis-line",Ng(l,"className"))}))}function Dnt(t,e,r,n,a,s,o,l,c){var u,d,f,A,h,m,p=l?-1:1,x=t.tickSize||o,v=_n(t.tickCoord)?t.tickCoord:t.coordinate;switch(s){case"top":u=d=t.coordinate,A=r+ +!l*a,f=A-p*x,m=f-p*c,h=v;break;case"left":f=A=t.coordinate,d=e+ +!l*n,u=d-p*x,h=u-p*c,m=v;break;case"right":f=A=t.coordinate,d=e+ +l*n,u=d+p*x,h=u+p*c,m=v;break;default:u=d=t.coordinate,A=r+ +l*a,f=A+p*x,m=f+p*c,h=v;break}return{line:{x1:u,y1:f,x2:d,y2:A},tick:{x:h,y:m}}}function Rnt(t,e){switch(t){case"left":return e?"start":"end";case"right":return e?"end":"start";default:return"middle"}}function Mnt(t,e){switch(t){case"left":case"right":return"middle";case"top":return e?"start":"end";default:return e?"end":"start"}}function Lnt(t){var{option:e,tickProps:r,value:n}=t,a,s=as(r.className,"recharts-cartesian-axis-tick-value");if(g.isValidElement(e))a=g.cloneElement(e,so(so({},r),{},{className:s}));else if(typeof e=="function")a=e(so(so({},r),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(o=as(o,e==null?void 0:e.className)),a=g.createElement(p4,jg({},r,{className:o}),n)}return a}var Unt=g.forwardRef((t,e)=>{var{ticks:r=[],tick:n,tickLine:a,stroke:s,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:d,mirror:f,x:A,y:h,width:m,height:p,tickSize:x,tickMargin:v,fontSize:y,letterSpacing:b,getTicksConfig:w,events:j,axisType:I}=t,C=Snt(so(so({},w),{},{ticks:r}),y,b),S=Rnt(d,f),E=Mnt(d,f),B=uh(w),k=X2(n),T={};typeof a=="object"&&(T=a);var P=so(so({},B),{},{fill:"none"},T),K=C.map(ie=>so({entry:ie},Dnt(ie,A,h,m,p,d,x,f,v))),le=K.map(ie=>{var{entry:Ae,line:te}=ie;return g.createElement(kc,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(Ae.value,"-").concat(Ae.coordinate,"-").concat(Ae.tickCoord)},a&&g.createElement("line",jg({},P,te,{className:as("recharts-cartesian-axis-tick-line",Ng(a,"className"))})))}),oe=K.map((ie,Ae)=>{var{entry:te,tick:Te}=ie,Ue=so(so(so(so({textAnchor:S,verticalAnchor:E},B),{},{stroke:"none",fill:s},k),Te),{},{index:Ae,payload:te,visibleTicksCount:C.length,tickFormatter:o,padding:c},u);return g.createElement(kc,jg({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(te.value,"-").concat(te.coordinate,"-").concat(te.tickCoord)},Yw(j,te,Ae)),n&&g.createElement(Lnt,{option:n,tickProps:Ue,value:"".concat(typeof o=="function"?o(te.value,Ae):te.value).concat(l||"")}))});return g.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(I,"-ticks")},oe.length>0&&g.createElement(yh,{zIndex:sc.label},g.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(I,"-tick-labels"),ref:e},oe)),le.length>0&&g.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(I,"-tick-lines")},le))}),Qnt=g.forwardRef((t,e)=>{var{axisLine:r,width:n,height:a,className:s,hide:o,ticks:l,axisType:c}=t,u=Pnt(t,jnt),[d,f]=g.useState(""),[A,h]=g.useState(""),m=g.useRef(null);g.useImperativeHandle(e,()=>({getCalculatedWidth:()=>{var x;return Int({ticks:m.current,label:(x=t.labelRef)===null||x===void 0?void 0:x.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var p=g.useCallback(x=>{if(x){var v=x.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=v;var y=v[0];if(y){var b=window.getComputedStyle(y),w=b.fontSize,j=b.letterSpacing;(w!==d||j!==A)&&(f(w),h(j))}}},[d,A]);return o||n!=null&&n<=0||a!=null&&a<=0?null:g.createElement(yh,{zIndex:t.zIndex},g.createElement(kc,{className:as("recharts-cartesian-axis",s)},g.createElement(Ont,{x:t.x,y:t.y,width:n,height:a,orientation:t.orientation,mirror:t.mirror,axisLine:r,otherSvgProps:uh(t)}),g.createElement(Unt,{ref:p,axisType:c,events:u,fontSize:d,getTicksConfig:t,height:t.height,letterSpacing:A,mirror:t.mirror,orientation:t.orientation,padding:t.padding,stroke:t.stroke,tick:t.tick,tickFormatter:t.tickFormatter,tickLine:t.tickLine,tickMargin:t.tickMargin,tickSize:t.tickSize,tickTextProps:t.tickTextProps,ticks:l,unit:t.unit,width:t.width,x:t.x,y:t.y}),g.createElement(Yet,{x:t.x,y:t.y,width:t.width,height:t.height,lowerWidth:t.width,upperWidth:t.width},g.createElement(ott,{label:t.label,labelRef:t.labelRef}),t.children)))}),Q8=g.forwardRef((t,e)=>{var r=Fl(t,Jp);return g.createElement(Qnt,jg({},r,{ref:e}))});Q8.displayName="CartesianAxis";var Vnt={},Vue=fu({name:"errorBars",initialState:Vnt,reducers:{addErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]||(t[r]=[]),t[r].push(n)},replaceErrorBar:(t,e)=>{var{itemId:r,prev:n,next:a}=e.payload;t[r]&&(t[r]=t[r].map(s=>s.dataKey===n.dataKey&&s.direction===n.direction?a:s))},removeErrorBar:(t,e)=>{var{itemId:r,errorBar:n}=e.payload;t[r]&&(t[r]=t[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:pot,replaceErrorBar:got,removeErrorBar:xot}=Vue.actions,Hnt=Vue.reducer,$nt=["children"];function Gnt(t,e){if(t==null)return{};var r,n,a=Knt(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Knt(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var qnt={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},znt=g.createContext(qnt);function Wnt(t){var{children:e}=t,r=Gnt(t,$nt);return g.createElement(znt.Provider,{value:r},e)}function Hue(t,e){var r,n,a=yn(u=>$A(u,t)),s=yn(u=>GA(u,e)),o=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:Ko.allowDataOverflow,l=(n=s==null?void 0:s.allowDataOverflow)!==null&&n!==void 0?n:qo.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function Xnt(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,a=Rue(),{needClipX:s,needClipY:o,needClip:l}=Hue(e,r);if(!l||!a)return null;var{x:c,y:u,width:d,height:f}=a;return g.createElement("clipPath",{id:"clipPath-".concat(n)},g.createElement("rect",{x:s?c:c-d/2,y:o?u:u-f/2,width:s?d:d*2,height:o?f:f*2}))}var Ynt={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gN=g;function Jnt(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Znt=typeof Object.is=="function"?Object.is:Jnt,eat=gN.useSyncExternalStore,tat=gN.useRef,rat=gN.useEffect,nat=gN.useMemo,aat=gN.useDebugValue;Ynt.useSyncExternalStoreWithSelector=function(t,e,r,n,a){var s=tat(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=nat(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),a!==void 0&&o.hasValue){var m=o.value;if(a(m,h))return f=m}return f=h}if(m=f,Znt(d,h))return m;var p=n(h);return a!==void 0&&a(m,p)?(d=h,m):(d=h,f=p)}var u=!1,d,f,A=r===void 0?null:r;return[function(){return c(e())},A===null?void 0:function(){return c(A())}]},[e,r,n,a]);var l=eat(t,s[0],s[1]);return rat(function(){o.hasValue=!0,o.value=l},[l]),aat(l),l};function sat(t){t()}function iat(){let t=null,e=null;return{clear(){t=null,e=null},notify(){sat(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=e={callback:r,next:null,prev:e};return a.prev?a.prev.next=a:t=a,function(){!n||t===null||(n=!1,a.next?a.next.prev=a.prev:e=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}var Kz={notify(){},get:()=>[]};function oat(t,e){let r,n=Kz,a=0,s=!1;function o(p){d();const x=n.subscribe(p);let v=!1;return()=>{v||(v=!0,x(),f())}}function l(){n.notify()}function c(){m.onStateChange&&m.onStateChange()}function u(){return s}function d(){a++,r||(r=t.subscribe(c),n=iat())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=Kz)}function A(){s||(s=!0,d())}function h(){s&&(s=!1,f())}const m={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:A,tryUnsubscribe:h,getListeners:()=>n};return m}var lat=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",cat=lat(),uat=()=>typeof navigator<"u"&&navigator.product==="ReactNative",dat=uat(),fat=()=>cat||dat?g.useLayoutEffect:g.useEffect,hat=fat();function qz(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function Aat(t,e){if(qz(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(e,r[a])||!qz(t[r[a]],e[r[a]]))return!1;return!0}var FT=Symbol.for("react-redux-context"),OT=typeof globalThis<"u"?globalThis:{};function mat(){if(!g.createContext)return{};const t=OT[FT]??(OT[FT]=new Map);let e=t.get(g.createContext);return e||(e=g.createContext(null),t.set(g.createContext,e)),e}var pat=mat();function gat(t){const{children:e,context:r,serverState:n,store:a}=t,s=g.useMemo(()=>{const c=oat(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),o=g.useMemo(()=>a.getState(),[a]);hat(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=r||pat;return g.createElement(l.Provider,{value:s},e)}var xat=gat,vat=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function yat(t,e){return t==null&&e==null?!0:typeof t=="number"&&typeof e=="number"?t===e||t!==t&&e!==e:t===e}function V8(t,e){var r=new Set([...Object.keys(t),...Object.keys(e)]);for(var n of r)if(vat.has(n)){if(t[n]==null&&e[n]==null)continue;if(!Aat(t[n],e[n]))return!1}else if(!yat(t[n],e[n]))return!1;return!0}function Wg(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(a=>a.id===e))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:Oue}function Xg(t,e){var r,n;return(r=(n=t.graphicalItems.cartesianItems.find(a=>a.id===e))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:Oue}var bat="Invariant failed";function wat(t,e){throw new Error(bat)}function vO(){return vO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},vO.apply(null,arguments)}function XI(t){return g.createElement(Pue,vO({shapeType:"rectangle",activeClassName:"recharts-active-bar"},t))}var Nat=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(_n(e))return e;var s=_n(n)||il(n);return s?e(n,a):(s||wat(),r)}},Cat=(t,e,r)=>r,_at=(t,e)=>e,xN=tr([t8,_at],(t,e)=>t.filter(r=>r.type==="bar").find(r=>r.id===e)),Eat=tr([xN],t=>t==null?void 0:t.maxBarSize),Sat=(t,e,r,n)=>n,Iat=tr([Ba,t8,Wg,Xg,Cat],(t,e,r,n,a)=>e.filter(s=>t==="horizontal"?s.xAxisId===r:s.yAxisId===n).filter(s=>s.isPanorama===a).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),jat=(t,e,r)=>{var n=Ba(t),a=Wg(t,e),s=Xg(t,e);if(!(a==null||s==null))return n==="horizontal"?fO(t,"yAxis",s,r):fO(t,"xAxis",a,r)},Pat=(t,e)=>{var r=Ba(t),n=Wg(t,e),a=Xg(t,e);if(!(n==null||a==null))return r==="horizontal"?qq(t,"xAxis",n):qq(t,"yAxis",a)},Tat=tr([Iat,JXe,Pat],Zrt),Bat=(t,e,r)=>{var n,a,s=xN(t,e);if(s!=null){var o=Wg(t,e),l=Xg(t,e);if(!(o==null||l==null)){var c=Ba(t),u=Yle(t),{maxBarSize:d}=s,f=il(d)?u:d,A,h;return c==="horizontal"?(A=e1(t,"xAxis",o,r),h=Zv(t,"xAxis",o,r)):(A=e1(t,"yAxis",l,r),h=Zv(t,"yAxis",l,r)),(n=(a=CI(A,h,!0))!==null&&a!==void 0?a:f)!==null&&n!==void 0?n:0}}},$ue=(t,e,r)=>{var n=Ba(t),a=Wg(t,e),s=Xg(t,e);if(!(a==null||s==null)){var o,l;return n==="horizontal"?(o=e1(t,"xAxis",a,r),l=Zv(t,"xAxis",a,r)):(o=e1(t,"yAxis",s,r),l=Zv(t,"yAxis",s,r)),CI(o,l)}},kat=tr([Tat,Yle,YXe,Jle,Bat,$ue,Eat],ant),Fat=(t,e,r)=>{var n=Wg(t,e);if(n!=null)return e1(t,"xAxis",n,r)},Oat=(t,e,r)=>{var n=Xg(t,e);if(n!=null)return e1(t,"yAxis",n,r)},Dat=(t,e,r)=>{var n=Wg(t,e);if(n!=null)return Zv(t,"xAxis",n,r)},Rat=(t,e,r)=>{var n=Xg(t,e);if(n!=null)return Zv(t,"yAxis",n,r)},Mat=tr([kat,xN],(t,e)=>{if(!(t==null||e==null)){var r=t.find(n=>n.stackId===e.stackId&&e.dataKey!=null&&n.dataKeys.includes(e.dataKey));if(r!=null)return r.position}}),Lat=tr([jat,xN],snt),Uat=tr([Mo,pM,Fat,Oat,Dat,Rat,Mat,Ba,LXe,$ue,Lat,xN,Sat],(t,e,r,n,a,s,o,l,c,u,d,f,A)=>{var{chartData:h,dataStartIndex:m,dataEndIndex:p}=c;if(!(f==null||o==null||e==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||s==null||u==null)){var{data:x}=f,v;if(x!=null&&x.length>0?v=x:v=h==null?void 0:h.slice(m,p+1),v!=null)return mst({layout:l,barSettings:f,pos:o,parentViewBox:e,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:s,stackedData:d,displayedData:v,offset:t,cells:A,dataStartIndex:m})}}),Qat=["index"];function yO(){return yO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yO.apply(null,arguments)}function Vat(t,e){if(t==null)return{};var r,n,a=Hat(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Hat(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Gue=g.createContext(void 0),$at=t=>{var e=g.useContext(Gue);if(e!=null)return e.stackId;if(t!=null)return UGe(t)},Gat=(t,e)=>"recharts-bar-stack-clip-path-".concat(t,"-").concat(e),Kat=t=>{var e=g.useContext(Gue);if(e!=null){var{stackId:r}=e;return"url(#".concat(Gat(r,t),")")}},qat=t=>{var{index:e}=t,r=Vat(t,Qat),n=Kat(e);return g.createElement(kc,yO({className:"recharts-bar-stack-layer",clipPath:n},r))},zat=["onMouseEnter","onMouseLeave","onClick"],Wat=["value","background","tooltipPosition"],Xat=["id"],Yat=["onMouseEnter","onClick","onMouseLeave"];function jA(){return jA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},jA.apply(null,arguments)}function zz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function _c(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zz(Object(r),!0).forEach(function(n){Jat(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Jat(t,e,r){return(e=Zat(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zat(t){var e=est(t,"string");return typeof e=="symbol"?e:e+""}function est(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YI(t,e){if(t==null)return{};var r,n,a=tst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function tst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var rst=t=>{var{dataKey:e,name:r,fill:n,legendType:a,hide:s}=t;return[{inactive:s,dataKey:e,type:a,color:n,value:UP(r,e),payload:t}]},nst=g.memo(t=>{var{dataKey:e,stroke:r,strokeWidth:n,fill:a,name:s,hide:o,unit:l,tooltipType:c,id:u}=t,d={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:e,nameKey:void 0,name:UP(s,e),hide:o,type:c,color:a,unit:l,graphicalItemId:u}};return g.createElement(Tue,{tooltipEntrySettings:d})});function ast(t){var e=yn(Ig),{data:r,dataKey:n,background:a,allOtherBarProps:s}=t,{onMouseEnter:o,onMouseLeave:l,onClick:c}=s,u=YI(s,zat),d=R8(o,n,s.id),f=M8(l),A=L8(c,n,s.id);if(!a||r==null)return null;var h=X2(a);return g.createElement(yh,{zIndex:int(a,sc.barBackground)},r.map((m,p)=>{var{value:x,background:v,tooltipPosition:y}=m,b=YI(m,Wat);if(!v)return null;var w=d(m,p),j=f(m,p),I=A(m,p),C=_c(_c(_c(_c(_c({option:a,isActive:String(p)===e},b),{},{fill:"#eee"},v),h),Yw(u,m,p)),{},{onMouseEnter:w,onMouseLeave:j,onClick:I,dataKey:n,index:p,className:"recharts-bar-background-rectangle"});return g.createElement(XI,jA({key:"background-bar-".concat(p)},C))}))}function sst(t){var{showLabels:e,children:r,rects:n}=t,a=n==null?void 0:n.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return _c(_c({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return g.createElement(Att,{value:e?a:void 0},r)}function ist(t){var{shape:e,activeBar:r,baseProps:n,entry:a,index:s,dataKey:o}=t,l=yn(Ig),c=yn(E8),u=r&&String(s)===l&&(c==null||o===c),d=u?r:e;return u?g.createElement(yh,{zIndex:sc.activeBar},g.createElement(XI,jA({},n,{name:String(n.name)},a,{isActive:u,option:d,index:s,dataKey:o}))):g.createElement(XI,jA({},n,{name:String(n.name)},a,{isActive:u,option:d,index:s,dataKey:o}))}function ost(t){var{shape:e,baseProps:r,entry:n,index:a,dataKey:s}=t;return g.createElement(XI,jA({},r,{name:String(r.name)},n,{isActive:!1,option:e,index:a,dataKey:s}))}function lst(t){var e,{data:r,props:n}=t,a=(e=uh(n))!==null&&e!==void 0?e:{},{id:s}=a,o=YI(a,Xat),{shape:l,dataKey:c,activeBar:u}=n,{onMouseEnter:d,onClick:f,onMouseLeave:A}=n,h=YI(n,Yat),m=R8(d,c,s),p=M8(A),x=L8(f,c,s);return r?g.createElement(g.Fragment,null,r.map((v,y)=>g.createElement(qat,jA({index:y,key:"rectangle-".concat(v==null?void 0:v.x,"-").concat(v==null?void 0:v.y,"-").concat(v==null?void 0:v.value,"-").concat(y),className:"recharts-bar-rectangle"},Yw(h,v,y),{onMouseEnter:m(v,y),onMouseLeave:p(v,y),onClick:x(v,y)}),u?g.createElement(ist,{shape:l,activeBar:u,baseProps:o,entry:v,index:y,dataKey:c}):g.createElement(ost,{shape:l,baseProps:o,entry:v,index:y,dataKey:c})))):null}function cst(t){var{props:e,previousRectanglesRef:r}=t,{data:n,layout:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=e,f=r.current,A=JP(e,"recharts-bar-"),[h,m]=g.useState(!1),p=!h,x=g.useCallback(()=>{typeof u=="function"&&u(),m(!1)},[u]),v=g.useCallback(()=>{typeof d=="function"&&d(),m(!0)},[d]);return g.createElement(sst,{showLabels:p,rects:n},g.createElement(YP,{animationId:A,begin:o,duration:l,isActive:s,easing:c,onAnimationEnd:x,onAnimationStart:v,key:A},y=>{var b=y===1?n:n==null?void 0:n.map((w,j)=>{var I=f&&f[j];if(I)return _c(_c({},w),{},{x:So(I.x,w.x,y),y:So(I.y,w.y,y),width:So(I.width,w.width,y),height:So(I.height,w.height,y)});if(a==="horizontal"){var C=So(0,w.height,y),S=So(w.stackedBarStart,w.y,y);return _c(_c({},w),{},{y:S,height:C})}var E=So(0,w.width,y),B=So(w.stackedBarStart,w.x,y);return _c(_c({},w),{},{width:E,x:B})});return y>0&&(r.current=b??null),b==null?null:g.createElement(kc,null,g.createElement(lst,{props:e,data:b}))}),g.createElement(wue,{label:e.label}),e.children)}function ust(t){var e=g.useRef(null);return g.createElement(cst,{previousRectanglesRef:e,props:t})}var Kue=0,dst=(t,e)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:Os(t,e)}};class fst extends g.PureComponent{render(){var{hide:e,data:r,dataKey:n,className:a,xAxisId:s,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(e||r==null)return null;var d=as("recharts-bar",a),f=u;return g.createElement(kc,{className:d,id:u},l&&g.createElement("defs",null,g.createElement(Xnt,{clipPathId:f,xAxisId:s,yAxisId:o})),g.createElement(kc,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},g.createElement(ast,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),g.createElement(ust,this.props)))}}var hst={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:Kue,xAxisId:0,yAxisId:0,zIndex:sc.bar};function Ast(t){var{xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=t,{needClip:f}=Hue(e,r),A=tN(),h=zu(),m=D8(t.children,pN),p=yn(y=>Uat(y,t.id,h,m));if(A!=="vertical"&&A!=="horizontal")return null;var x,v=p==null?void 0:p[0];return v==null||v.height==null||v.width==null?x=0:x=A==="vertical"?v.height/2:v.width/2,g.createElement(Wnt,{xAxisId:e,yAxisId:r,data:p,dataPointFormatter:dst,errorBarOffset:x},g.createElement(fst,jA({},t,{layout:A,needClip:f,data:p,xAxisId:e,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function mst(t){var{layout:e,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:A,cells:h,parentViewBox:m,dataStartIndex:p}=t,x=e==="horizontal"?l:o,v=d?x.scale.domain():null,y=QGe({numericAxis:x}),b=x.scale(y);return f.map((w,j)=>{var I,C,S,E,B,k;if(d){var T=d[j+p];if(T==null)return null;I=OGe(T,v)}else I=Os(w,r),Array.isArray(I)||(I=[y,I]);var P=Nat(n,Kue)(I[1],j);if(e==="horizontal"){var K,[le,oe]=[l.scale(I[0]),l.scale(I[1])];C=nK({axis:o,ticks:c,bandSize:s,offset:a.offset,entry:w,index:j}),S=(K=oe??le)!==null&&K!==void 0?K:void 0,E=a.size;var ie=le-oe;if(B=dh(ie)?0:ie,k={x:C,y:A.top,width:E,height:A.height},Math.abs(P)>0&&Math.abs(B)<Math.abs(P)){var Ae=Tl(B||P)*(Math.abs(P)-Math.abs(B));S-=Ae,B+=Ae}}else{var[te,Te]=[o.scale(I[0]),o.scale(I[1])];if(C=te,S=nK({axis:l,ticks:u,bandSize:s,offset:a.offset,entry:w,index:j}),E=Te-te,B=a.size,k={x:A.left,y:S,width:A.width,height:B},Math.abs(P)>0&&Math.abs(E)<Math.abs(P)){var Ue=Tl(E||P)*(Math.abs(P)-Math.abs(E));E+=Ue}}if(C==null||S==null||E==null||B==null)return null;var O=_c(_c({},w),{},{stackedBarStart:b,x:C,y:S,width:E,height:B,value:d?I:I[1],payload:w,background:k,tooltipPosition:{x:C+E/2,y:S+B/2},parentViewBox:m},h&&h[j]&&h[j].props);return O}).filter(Boolean)}function pst(t){var e=Fl(t,hst),r=$at(e.stackId),n=zu();return g.createElement(Bue,{id:e.id,type:"bar"},a=>g.createElement(g.Fragment,null,g.createElement(Jtt,{legendPayload:rst(e)}),g.createElement(nst,{dataKey:e.dataKey,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,unit:e.unit,tooltipType:e.tooltipType,id:a}),g.createElement(frt,{type:"bar",id:a,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:r,hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:n}),g.createElement(yh,{zIndex:e.zIndex},g.createElement(Ast,jA({},e,{id:a})))))}var bO=g.memo(pst,V8);bO.displayName="Bar";var gst=["domain","range"],xst=["domain","range"];function Wz(t,e){if(t==null)return{};var r,n,a=vst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function vst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Xz(t,e){return t===e?!0:Array.isArray(t)&&t.length===2&&Array.isArray(e)&&e.length===2?t[0]===e[0]&&t[1]===e[1]:!1}function que(t,e){if(t===e)return!0;var{domain:r,range:n}=t,a=Wz(t,gst),{domain:s,range:o}=e,l=Wz(e,xst);return!Xz(r,s)||!Xz(n,o)?!1:V8(a,l)}var yst=["dangerouslySetInnerHTML","ticks","scale"],bst=["id","scale"];function wO(){return wO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wO.apply(null,arguments)}function Yz(t,e){if(t==null)return{};var r,n,a=wst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function wst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Nst(t){var e=_s(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(Hrt(t)):r.current!==t&&e($rt({prev:r.current,next:t})),r.current=t},[t,e]),g.useLayoutEffect(()=>()=>{r.current&&(e(Grt(r.current)),r.current=null)},[e]),null}var Cst=t=>{var{xAxisId:e,className:r}=t,n=yn(pM),a=zu(),s="xAxis",o=yn(v=>Pce(v,s,e,a)),l=yn(v=>Ece(v,e)),c=yn(v=>WYe(v,e)),u=yn(v=>oce(v,e));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:f,scale:A}=t,h=Yz(t,yst),{id:m,scale:p}=u,x=Yz(u,bst);return g.createElement(Q8,wO({},h,x,{x:c.x,y:c.y,width:l.width,height:l.height,className:as("recharts-".concat(s," ").concat(s),r),viewBox:n,ticks:o,axisType:s}))},_st={allowDataOverflow:Ko.allowDataOverflow,allowDecimals:Ko.allowDecimals,allowDuplicatedCategory:Ko.allowDuplicatedCategory,angle:Ko.angle,axisLine:Jp.axisLine,height:Ko.height,hide:!1,includeHidden:Ko.includeHidden,interval:Ko.interval,minTickGap:Ko.minTickGap,mirror:Ko.mirror,orientation:Ko.orientation,padding:Ko.padding,reversed:Ko.reversed,scale:Ko.scale,tick:Ko.tick,tickCount:Ko.tickCount,tickLine:Jp.tickLine,tickSize:Jp.tickSize,type:Ko.type,xAxisId:0},Est=t=>{var e=Fl(t,_st);return g.createElement(g.Fragment,null,g.createElement(Nst,{allowDataOverflow:e.allowDataOverflow,allowDecimals:e.allowDecimals,allowDuplicatedCategory:e.allowDuplicatedCategory,angle:e.angle,dataKey:e.dataKey,domain:e.domain,height:e.height,hide:e.hide,id:e.xAxisId,includeHidden:e.includeHidden,interval:e.interval,minTickGap:e.minTickGap,mirror:e.mirror,name:e.name,orientation:e.orientation,padding:e.padding,reversed:e.reversed,scale:e.scale,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit}),g.createElement(Cst,e))},zue=g.memo(Est,que);zue.displayName="XAxis";var Sst=["dangerouslySetInnerHTML","ticks","scale"],Ist=["id","scale"];function NO(){return NO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},NO.apply(null,arguments)}function Jz(t,e){if(t==null)return{};var r,n,a=jst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function jst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Pst(t){var e=_s(),r=g.useRef(null);return g.useLayoutEffect(()=>{r.current===null?e(Krt(t)):r.current!==t&&e(qrt({prev:r.current,next:t})),r.current=t},[t,e]),g.useLayoutEffect(()=>()=>{r.current&&(e(zrt(r.current)),r.current=null)},[e]),null}var Tst=t=>{var{yAxisId:e,className:r,width:n,label:a}=t,s=g.useRef(null),o=g.useRef(null),l=yn(pM),c=zu(),u=_s(),d="yAxis",f=yn(I=>Sce(I,e)),A=yn(I=>YYe(I,e)),h=yn(I=>Pce(I,d,e,c)),m=yn(I=>lce(I,e));if(g.useLayoutEffect(()=>{if(!(n!=="auto"||!f||T8(a)||g.isValidElement(a)||m==null)){var I=s.current;if(I){var C=I.getCalculatedWidth();Math.round(f.width)!==Math.round(C)&&u(Wrt({id:e,width:C}))}}},[h,f,u,a,e,n,m]),f==null||A==null||m==null)return null;var{dangerouslySetInnerHTML:p,ticks:x,scale:v}=t,y=Jz(t,Sst),{id:b,scale:w}=m,j=Jz(m,Ist);return g.createElement(Q8,NO({},y,j,{ref:s,labelRef:o,x:A.x,y:A.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:as("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:h,axisType:d}))},Bst={allowDataOverflow:qo.allowDataOverflow,allowDecimals:qo.allowDecimals,allowDuplicatedCategory:qo.allowDuplicatedCategory,angle:qo.angle,axisLine:Jp.axisLine,hide:!1,includeHidden:qo.includeHidden,interval:qo.interval,minTickGap:qo.minTickGap,mirror:qo.mirror,orientation:qo.orientation,padding:qo.padding,reversed:qo.reversed,scale:qo.scale,tick:qo.tick,tickCount:qo.tickCount,tickLine:Jp.tickLine,tickSize:Jp.tickSize,type:qo.type,width:qo.width,yAxisId:0},kst=t=>{var e=Fl(t,Bst);return g.createElement(g.Fragment,null,g.createElement(Pst,{interval:e.interval,id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:e.includeHidden,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:e.angle,minTickGap:e.minTickGap,tick:e.tick,tickFormatter:e.tickFormatter}),g.createElement(Tst,e))},Wue=g.memo(kst,que);Wue.displayName="YAxis";var Fst=(t,e)=>e,H8=tr([Fst,Ba,sce,Uo,Kce,KA,fZe,Mo],vZe),$8=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},Xue=Md("mouseClick"),Yue=Zw();Yue.startListening({actionCreator:Xue,effect:(t,e)=>{var r=t.payload,n=H8(e.getState(),$8(r));(n==null?void 0:n.activeIndex)!=null&&e.dispatch(dJe({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var CO=Md("mouseMove"),Jue=Zw(),B_=null;Jue.startListening({actionCreator:CO,effect:(t,e)=>{var r=t.payload;B_!==null&&cancelAnimationFrame(B_);var n=$8(r);B_=requestAnimationFrame(()=>{var a=e.getState(),s=y8(a,a.tooltip.settings.shared);if(s==="axis"){var o=H8(a,n);(o==null?void 0:o.activeIndex)!=null?e.dispatch(Mce({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):e.dispatch(Rce())}B_=null})}});function Ost(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":t==="children"&&typeof e=="object"&&e!==null?"<<CHILDREN>>":e}var Zz={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},Zue=fu({name:"rootProps",initialState:Zz,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:Zz.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className,t.baseValue=e.payload.baseValue,t.reverseStackOrder=e.payload.reverseStackOrder}}}),Dst=Zue.reducer,{updateOptions:Rst}=Zue.actions,ede=fu({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:Mst}=ede.actions,Lst=ede.reducer,tde=Md("keyDown"),rde=Md("focus"),G8=Zw();G8.startListening({actionCreator:tde,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,s=t.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=b8(a,F1(r),dN(r),AN(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=KA(r);if(s==="Enter"){var u=KI(r,"axis","hover",String(a.index));e.dispatch(AO({active:!a.active,activeIndex:a.index,activeCoordinate:u}));return}var d=tJe(r),f=d==="left-to-right"?1:-1,A=s==="ArrowRight"?1:-1,h=l+A*f;if(!(c==null||h>=c.length||h<0)){var m=KI(r,"axis","hover",String(h));e.dispatch(AO({active:!0,activeIndex:h.toString(),activeCoordinate:m}))}}}}}});G8.startListening({actionCreator:rde,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var s="0",o=KI(r,"axis","hover",String(s));e.dispatch(AO({active:!0,activeIndex:s,activeCoordinate:o}))}}}});var hd=Md("externalEvent"),nde=Zw(),DT=new Map;nde.startListening({actionCreator:hd,effect:(t,e)=>{var{handler:r,reactEvent:n}=t.payload;if(r!=null){n.persist();var a=n.type,s=DT.get(a);s!==void 0&&cancelAnimationFrame(s);var o=requestAnimationFrame(()=>{try{var l=e.getState(),c={activeCoordinate:YJe(l),activeDataKey:E8(l),activeIndex:Ig(l),activeLabel:Wce(l),activeTooltipIndex:Ig(l),isTooltipActive:JJe(l)};r(c,n)}finally{DT.delete(a)}});DT.set(a,o)}}});var Ust=tr([B1],t=>t.tooltipItemPayloads),Qst=tr([Ust,hN,(t,e)=>e,(t,e,r)=>r],(t,e,r,n)=>{var a=t.find(l=>l.settings.graphicalItemId===n);if(a!=null){var{positions:s}=a;if(s!=null){var o=e(s,r);return o}}}),ade=Md("touchMove"),sde=Zw();sde.startListening({actionCreator:ade,effect:(t,e)=>{var r=t.payload;if(!(r.touches==null||r.touches.length===0)){var n=e.getState(),a=y8(n,n.tooltip.settings.shared);if(a==="axis"){var s=r.touches[0];if(s==null)return;var o=H8(n,$8({clientX:s.clientX,clientY:s.clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&e.dispatch(Mce({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(a==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var d=u.getAttribute(woe),f=(l=u.getAttribute(Noe))!==null&&l!==void 0?l:void 0,A=k1(n).find(p=>p.id===f);if(d==null||A==null||f==null)return;var{dataKey:h}=A,m=Qst(n,d,f);e.dispatch(Dce({activeDataKey:h,activeIndex:d,activeCoordinate:m,activeGraphicalItemId:f}))}}}});var Vst=Kie({brush:ont,cartesianAxis:Xrt,chartData:WZe,errorBars:Hnt,graphicalItems:urt,layout:jGe,legend:FKe,options:$Ze,polarAxis:_tt,polarOptions:Lst,referenceElements:Ant,rootProps:Dst,tooltip:fJe,zIndex:kZe}),Hst=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return eGe({reducer:Vst,preloadedState:e,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([Yue.middleware,Jue.middleware,G8.middleware,nde.middleware,sde.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(ooe({type:"raf"}))},devTools:{serialize:{replacer:Ost},name:"recharts-".concat(r)}})};function ide(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,a=zu(),s=g.useRef(null);if(a)return r;s.current==null&&(s.current=Hst(e,n));var o=oM;return g.createElement(xat,{context:o,store:s.current},r)}function $st(t){var{layout:e,margin:r}=t,n=_s(),a=zu();return g.useEffect(()=>{a||(n(EGe(e)),n(_Ge(r)))},[n,a,e,r]),null}var ode=g.memo($st,V8);function lde(t){var e=_s();return g.useEffect(()=>{e(Rst(t))},[e,t]),null}function eW(t){var{zIndex:e,isPanorama:r}=t,n=g.useRef(null),a=_s();return g.useLayoutEffect(()=>(n.current&&a(TZe({zIndex:e,element:n.current,isPanorama:r})),()=>{a(BZe({zIndex:e,isPanorama:r}))}),[a,e,r]),g.createElement("g",{tabIndex:-1,ref:n})}function tW(t){var{children:e,isPanorama:r}=t,n=yn(bZe);if(!n||n.length===0)return e;var a=n.filter(o=>o<0),s=n.filter(o=>o>0);return g.createElement(g.Fragment,null,a.map(o=>g.createElement(eW,{key:o,zIndex:o,isPanorama:r})),e,s.map(o=>g.createElement(eW,{key:o,zIndex:o,isPanorama:r})))}var Gst=["children"];function Kst(t,e){if(t==null)return{};var r,n,a=qst(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function qst(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function JI(){return JI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},JI.apply(null,arguments)}var zst={width:"100%",height:"100%",display:"block"},Wst=g.forwardRef((t,e)=>{var r=Toe(),n=Boe(),a=Hoe();if(!km(r)||!km(n))return null;var{children:s,otherAttributes:o,title:l,desc:c}=t,u,d;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=a?0:void 0,typeof o.role=="string"?d=o.role:d=a?"application":void 0),g.createElement(KR,JI({},o,{title:l,desc:c,role:d,tabIndex:u,width:r,height:n,style:zst,ref:e}),s)}),Xst=t=>{var{children:e}=t,r=yn($P);if(!r)return null;var{width:n,height:a,y:s,x:o}=r;return g.createElement(KR,{width:n,height:a,x:o,y:s},e)},rW=g.forwardRef((t,e)=>{var{children:r}=t,n=Kst(t,Gst),a=zu();return a?g.createElement(Xst,null,g.createElement(tW,{isPanorama:!0},r)):g.createElement(Wst,JI({ref:e},n),g.createElement(tW,{isPanorama:!1},r))});function Yst(){var t=_s(),[e,r]=g.useState(null),n=yn(qGe);return g.useEffect(()=>{if(e!=null){var a=e.getBoundingClientRect(),s=a.width/e.offsetWidth;pi(s)&&s!==n&&t(IGe(s))}},[e,t,n]),r}function nW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Jst(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nW(Object(r),!0).forEach(function(n){Zst(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Zst(t,e,r){return(e=eit(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eit(t){var e=tit(t,"string");return typeof e=="symbol"?e:e+""}function tit(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pg(){return Pg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Pg.apply(null,arguments)}var rit=()=>(aet(),null);function ZI(t){if(typeof t=="number")return t;if(typeof t=="string"){var e=parseFloat(t);if(!Number.isNaN(e))return e}return 0}var nit=g.forwardRef((t,e)=>{var r,n,a=g.useRef(null),[s,o]=g.useState({containerWidth:ZI((r=t.style)===null||r===void 0?void 0:r.width),containerHeight:ZI((n=t.style)===null||n===void 0?void 0:n.height)}),l=g.useCallback((u,d)=>{o(f=>{var A=Math.round(u),h=Math.round(d);return f.containerWidth===A&&f.containerHeight===h?f:{containerWidth:A,containerHeight:h}})},[]),c=g.useCallback(u=>{if(typeof e=="function"&&e(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:f}=u.getBoundingClientRect();l(d,f);var A=m=>{var{width:p,height:x}=m[0].contentRect;l(p,x)},h=new ResizeObserver(A);h.observe(u),a.current=h}},[e,l]);return g.useEffect(()=>()=>{var u=a.current;u!=null&&u.disconnect()},[l]),g.createElement(g.Fragment,null,g.createElement(KP,{width:s.containerWidth,height:s.containerHeight}),g.createElement("div",Pg({ref:c},t)))}),ait=g.forwardRef((t,e)=>{var{width:r,height:n}=t,[a,s]=g.useState({containerWidth:ZI(r),containerHeight:ZI(n)}),o=g.useCallback((c,u)=>{s(d=>{var f=Math.round(c),A=Math.round(u);return d.containerWidth===f&&d.containerHeight===A?d:{containerWidth:f,containerHeight:A}})},[]),l=g.useCallback(c=>{if(typeof e=="function"&&e(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();o(u,d)}},[e,o]);return g.createElement(g.Fragment,null,g.createElement(KP,{width:a.containerWidth,height:a.containerHeight}),g.createElement("div",Pg({ref:l},t)))}),sit=g.forwardRef((t,e)=>{var{width:r,height:n}=t;return g.createElement(g.Fragment,null,g.createElement(KP,{width:r,height:n}),g.createElement("div",Pg({ref:e},t)))}),iit=g.forwardRef((t,e)=>{var{width:r,height:n}=t;return NA(r)||NA(n)?g.createElement(ait,Pg({},t,{ref:e})):g.createElement(sit,Pg({},t,{ref:e}))});function oit(t){return t===!0?nit:iit}var lit=g.forwardRef((t,e)=>{var{children:r,className:n,height:a,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:A,onTouchEnd:h,onTouchMove:m,onTouchStart:p,style:x,width:v,responsive:y,dispatchTouchEvents:b=!0}=t,w=g.useRef(null),j=_s(),[I,C]=g.useState(null),[S,E]=g.useState(null),B=Yst(),k=gM(),T=(k==null?void 0:k.width)>0?k.width:v,P=(k==null?void 0:k.height)>0?k.height:a,K=g.useCallback(Q=>{B(Q),typeof e=="function"&&e(Q),C(Q),E(Q),Q!=null&&(w.current=Q)},[B,e,C,E]),le=g.useCallback(Q=>{j(Xue(Q)),j(hd({handler:s,reactEvent:Q}))},[j,s]),oe=g.useCallback(Q=>{j(CO(Q)),j(hd({handler:u,reactEvent:Q}))},[j,u]),ie=g.useCallback(Q=>{j(Rce()),j(hd({handler:d,reactEvent:Q}))},[j,d]),Ae=g.useCallback(Q=>{j(CO(Q)),j(hd({handler:f,reactEvent:Q}))},[j,f]),te=g.useCallback(()=>{j(rde())},[j]),Te=g.useCallback(Q=>{j(tde(Q.key))},[j]),Ue=g.useCallback(Q=>{j(hd({handler:o,reactEvent:Q}))},[j,o]),O=g.useCallback(Q=>{j(hd({handler:l,reactEvent:Q}))},[j,l]),H=g.useCallback(Q=>{j(hd({handler:c,reactEvent:Q}))},[j,c]),G=g.useCallback(Q=>{j(hd({handler:A,reactEvent:Q}))},[j,A]),L=g.useCallback(Q=>{j(hd({handler:p,reactEvent:Q}))},[j,p]),W=g.useCallback(Q=>{b&&j(ade(Q)),j(hd({handler:m,reactEvent:Q}))},[j,b,m]),X=g.useCallback(Q=>{j(hd({handler:h,reactEvent:Q}))},[j,h]),D=oit(y);return g.createElement(rue.Provider,{value:I},g.createElement(qse.Provider,{value:S},g.createElement(D,{width:T??(x==null?void 0:x.width),height:P??(x==null?void 0:x.height),className:as("recharts-wrapper",n),style:Jst({position:"relative",cursor:"default",width:T,height:P},x),onClick:le,onContextMenu:Ue,onDoubleClick:O,onFocus:te,onKeyDown:Te,onMouseDown:H,onMouseEnter:oe,onMouseLeave:ie,onMouseMove:Ae,onMouseUp:G,onTouchEnd:X,onTouchMove:W,onTouchStart:L,ref:K},g.createElement(rit,null),r)))}),cit=["width","height","responsive","children","className","style","compact","title","desc"];function uit(t,e){if(t==null)return{};var r,n,a=dit(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function dit(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var cde=g.forwardRef((t,e)=>{var{width:r,height:n,responsive:a,children:s,className:o,style:l,compact:c,title:u,desc:d}=t,f=uit(t,cit),A=uh(f);return c?g.createElement(g.Fragment,null,g.createElement(KP,{width:r,height:n}),g.createElement(rW,{otherAttributes:A,title:u,desc:d},s)):g.createElement(lit,{className:o,style:l,width:r,height:n,responsive:a??!1,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},g.createElement(rW,{otherAttributes:A,title:u,desc:d,ref:e},g.createElement(pnt,null,s)))});function _O(){return _O=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_O.apply(null,arguments)}var fit={top:5,right:5,bottom:5,left:5},hit={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:fit,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},Ait=g.forwardRef(function(e,r){var n,a=Fl(e.categoricalChartProps,hit),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=e,d={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return g.createElement(ide,{preloadedState:{options:d},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:s},g.createElement(Mue,{chartData:u.data}),g.createElement(ode,{layout:a.layout,margin:a.margin}),g.createElement(lde,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),g.createElement(cde,_O({},a,{ref:r})))}),mit=["axis","item"],pit=g.forwardRef((t,e)=>g.createElement(Ait,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:mit,tooltipPayloadSearcher:aue,categoricalChartProps:t,ref:e}));function git(t){var e=_s();return g.useEffect(()=>{e(Mst(t))},[e,t]),null}var xit=["layout"];function EO(){return EO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},EO.apply(null,arguments)}function vit(t,e){if(t==null)return{};var r,n,a=yit(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function yit(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var bit={top:5,right:5,bottom:5,left:5},ude={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:bit,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},wit=g.forwardRef(function(e,r){var n,a=Fl(e.categoricalChartProps,ude),{layout:s}=a,o=vit(a,xit),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=e,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return g.createElement(ide,{preloadedState:{options:f},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:l},g.createElement(Mue,{chartData:a.data}),g.createElement(ode,{layout:s,margin:a.margin}),g.createElement(lde,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),g.createElement(git,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),g.createElement(cde,EO({},o,{ref:r})))});function aW(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function sW(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?aW(Object(r),!0).forEach(function(n){Nit(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):aW(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Nit(t,e,r){return(e=Cit(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cit(t){var e=_it(t,"string");return typeof e=="symbol"?e:e+""}function _it(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Eit=["item"],Sit=sW(sW({},ude),{},{layout:"centric",startAngle:0,endAngle:360}),Iit=g.forwardRef((t,e)=>{var r=Fl(t,Sit);return g.createElement(wit,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Eit,tooltipPayloadSearcher:aue,categoricalChartProps:r,ref:e})});const jit="sellers_candies",k_="cash_deliveries_candies";function Oa(t){const e=typeof t=="number"?t:parseFloat(String(t??"").replace(/,/g,""));return Number.isFinite(e)?e:0}function Ri(t){return Number.isFinite(t)?t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"}function F_(t,e){return t*e/100}function O_(t,e,r){return t-e-r}function iW(t){return t?Ur(t.toDate(),"yyyy-MM-dd"):""}function D_(t){if(!t)return xr.fromDate(new Date);const[e,r,n]=t.split("-").map(s=>parseInt(s,10)),a=new Date(e,(r||1)-1,n||1,0,0,0,0);return xr.fromDate(a)}function Pit(){const t=new Date,[e,r]=g.useState(Ur(Qd(t),"yyyy-MM-dd")),[n,a]=g.useState(Ur(Ud(t),"yyyy-MM-dd")),[s,o]=g.useState([]),l=g.useMemo(()=>{const D=new Map;return s.forEach(Q=>D.set(Q.id,Q)),D},[s]),[c,u]=g.useState([]),[d,f]=g.useState(!0),[A,h]=g.useState(()=>Ur(new Date,"yyyy-MM-dd")),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState("0"),[w,j]=g.useState(""),[I,C]=g.useState(null),[S,E]=g.useState({}),B=g.useRef(null);g.useEffect(()=>{const D=sr(bt(je,jit),In("name","asc")),Q=Pd(D,Z=>{const be=Z.docs.map(U=>{const ze=U.data();return{id:U.id,name:String((ze==null?void 0:ze.name)??""),branch:ze!=null&&ze.branch?String(ze.branch):"",commissionPercent:Oa((ze==null?void 0:ze.commissionPercent)??0)}});o(be)},()=>o([]));return()=>Q()},[]),g.useEffect(()=>{f(!0);const D=D_(e),Q=new Date(D_(n).toDate().getTime());Q.setDate(Q.getDate()+1);const Z=xr.fromDate(Q),be=sr(bt(je,k_),Ar("date",">=",D),Ar("date","<",Z),In("date","desc")),U=Pd(be,ze=>{const re=ze.docs.map(J=>{const Re=J.data();return{id:J.id,date:Re==null?void 0:Re.date,sellerId:String((Re==null?void 0:Re.sellerId)??""),sellerName:String((Re==null?void 0:Re.sellerName)??""),amountDelivered:Oa(Re==null?void 0:Re.amountDelivered),commissionPercent:Oa(Re==null?void 0:Re.commissionPercent),commissionPaid:Oa(Re==null?void 0:Re.commissionPaid),extraExpenses:Oa(Re==null?void 0:Re.extraExpenses),totalFinal:Oa(Re==null?void 0:Re.totalFinal),comment:String((Re==null?void 0:Re.comment)??""),createdAt:Re==null?void 0:Re.createdAt,updatedAt:Re==null?void 0:Re.updatedAt}});u(re),f(!1)},ze=>{console.error("Firestore deliveries query error:",ze),u([]),f(!1),alert("Firestore query fall. Revis consola (probable ndice).")});return()=>U()},[e,n]);const k=g.useMemo(()=>m?l.get(m):void 0,[m,l]),T=Oa((k==null?void 0:k.commissionPercent)??0),P=Oa(x),K=Oa(y),le=F_(P,T),oe=O_(P,le,K),ie=g.useMemo(()=>{var Q;const D=new Map;for(const Z of c){const be=Z.sellerId||Z.sellerName||"UNKNOWN",U=D.get(be)??{sellerId:Z.sellerId,sellerName:Z.sellerName||((Q=l.get(Z.sellerId))==null?void 0:Q.name)||"Sin nombre",delivered:0,commission:0,totalFinal:0};U.delivered+=Oa(Z.amountDelivered),U.commission+=Oa(Z.commissionPaid),U.totalFinal+=Oa(Z.totalFinal),D.set(be,U)}return Array.from(D.values()).sort((Z,be)=>Z.sellerName.localeCompare(be.sellerName))},[c,l]),Ae=g.useMemo(()=>{let D=0,Q=0,Z=0,be=0;for(const U of c)D+=Oa(U.amountDelivered),Q+=Oa(U.commissionPaid),Z+=Oa(U.extraExpenses),be+=Oa(U.totalFinal);return{delivered:D,commission:Q,expenses:Z,totalFinal:be}},[c]),te=g.useMemo(()=>ie.map(D=>({name:D.sellerName,Entregado:Number(D.delivered.toFixed(2)),Comision:Number(D.commission.toFixed(2))})),[ie]),Te=g.useMemo(()=>[{name:"Total Entregado (Bruto)",value:Number(Ae.delivered.toFixed(2))},{name:"Total Comisin",value:Number(Ae.commission.toFixed(2))},{name:"Total Gastos",value:Number(Ae.expenses.toFixed(2))}].filter(D=>D.value>0),[Ae]),Ue=["#3B82F6","#F59E0B","#EF4444"];async function O(){if(!m)return alert("Seleccion un vendedor.");if(P<=0)return alert("Ingres un Monto entregado vlido (> 0).");const D=l.get(m),Q=(D==null?void 0:D.name)??"Sin nombre",Z=Oa((D==null?void 0:D.commissionPercent)??0),be=F_(P,Z),U=O_(P,be,K);await Wn(bt(je,k_),{date:D_(A),sellerId:m,sellerName:Q,amountDelivered:P,commissionPercent:Z,commissionPaid:be,extraExpenses:K,totalFinal:U,comment:w??"",createdAt:xr.now()}),v(""),b("0"),j("")}function H(D){C(D.id),E({...D,dateInput:iW(D.date)})}function G(){C(null),E({})}async function L(D){const Q=S,Z=String(Q.sellerId??""),be=l.get(Z),U=String(Q.sellerName??(be==null?void 0:be.name)??"Sin nombre"),ze=Oa(Q.amountDelivered),re=Oa(Q.extraExpenses),J=Oa(Q.commissionPercent??(be==null?void 0:be.commissionPercent)??0),Re=F_(ze,J),ke=O_(ze,Re,re),Be=D_(String(Q.dateInput??iW(Q.date)));await kn(Xt(je,k_,D),{date:Be,sellerId:Z,sellerName:U,amountDelivered:ze,commissionPercent:J,commissionPaid:Re,extraExpenses:re,totalFinal:ke,comment:String(Q.comment??""),updatedAt:xr.now()}),G()}async function W(D){confirm("Eliminar este registro?")&&await zn(Xt(je,k_,D))}async function X(){if(!B.current)return;const D=await Vm(B.current,{scale:2,useCORS:!0,backgroundColor:"#ffffff",scrollX:0,scrollY:-window.scrollY}),Q=D.toDataURL("image/png"),Z=new an("p","mm","a4"),be=Z.internal.pageSize.getWidth(),U=Z.internal.pageSize.getHeight(),ze=be,re=D.height*ze/D.width;let J=re,Re=0;for(Z.addImage(Q,"PNG",0,Re,ze,re),J-=U;J>0;)Z.addPage(),Re=-(re-J),Z.addImage(Q,"PNG",0,Re,ze,re),J-=U;Z.save(`Entregas_Dulces_${e}_a_${n}.pdf`)}return i.jsxs("div",{className:"p-3 md:p-6 max-w-7xl mx-auto space-y-3 md:space-y-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-lg md:text-2xl font-black text-gray-900",children:"Control Contable - Entregas de Vendedores (Dulces)"}),i.jsxs("p",{className:"text-xs md:text-sm text-gray-600",children:["Periodo: ",i.jsx("span",{className:"font-bold",children:e})," "," ",i.jsx("span",{className:"font-bold",children:n})]})]}),i.jsx("button",{onClick:X,className:"h-10 px-4 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800 active:scale-[0.99] transition",children:"Exportar a PDF"})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Filtros de periodo"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Desde"}),i.jsx("input",{type:"date",value:e,onChange:D=>r(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Hasta"}),i.jsx("input",{type:"date",value:n,onChange:D=>a(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]})]})]}),i.jsxs("div",{ref:B,className:"space-y-3 md:space-y-4",children:[i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"KPIs Consolidados"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Entradas (Neto)"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Ri(Ae.totalFinal)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Entregado - Comisin - Gastos"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Comisiones"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Ri(Ae.commission)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Suma de comisin pagada"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"KPI Gastos extras"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Ri(Ae.expenses)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Suma de gastos registrados"})]}),i.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[i.jsx("div",{className:"text-xs font-extrabold text-gray-600",children:"Total entregado (Bruto)"}),i.jsxs("div",{className:"text-xl font-black text-gray-900 mt-1",children:["$ ",Ri(Ae.delivered)]}),i.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Sin restar nada"})]})]}),i.jsx("div",{className:"font-black text-sm text-gray-900 mt-4 mb-2",children:"KPI Vendedores (sumatoria del periodo)"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-[520px] w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50 text-gray-700",children:[i.jsx("th",{className:"text-left p-2 font-black",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Entregado"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Total final"})]})}),i.jsx("tbody",{children:ie.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-2 text-gray-500",colSpan:4,children:"Sin datos en el periodo seleccionado."})}):ie.map(D=>i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:D.sellerName}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ri(D.delivered)]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ri(D.commission)]}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Ri(D.totalFinal)]})]},D.sellerId||D.sellerName))})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Entregas y Comisin por vendedor (Barras)"}),i.jsx("div",{className:"w-full h-[320px]",children:i.jsx(dK,{children:i.jsxs(pit,{data:te,children:[i.jsx(zue,{dataKey:"name",interval:0,angle:-12,height:70}),i.jsx(Wue,{}),i.jsx(cz,{}),i.jsx(XF,{}),i.jsx(bO,{dataKey:"Entregado"}),i.jsx(bO,{dataKey:"Comision"})]})})})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Distribucin (Pastel)"}),i.jsx("div",{className:"w-full h-[320px]",children:i.jsx(dK,{children:i.jsxs(Iit,{children:[i.jsx(Fue,{data:Te,dataKey:"value",nameKey:"name",outerRadius:110,label:!0,children:Te.map((D,Q)=>i.jsx(pN,{fill:Ue[Q%Ue.length]},Q))}),i.jsx(cz,{}),i.jsx(XF,{})]})})})]})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Agregar movimiento"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",value:A,onChange:D=>h(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Vendedor"}),i.jsxs("select",{value:m,onChange:D=>p(D.target.value),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10 bg-white",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(D=>i.jsxs("option",{value:D.id,children:[D.name," ",D.branch?`(${D.branch})`:""]},D.id))]})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Monto entregado"}),i.jsx("input",{type:"number",inputMode:"decimal",value:x,onChange:D=>v(D.target.value),placeholder:"0.00",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin configurada"}),i.jsx("input",{value:`${T}%`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-800"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin pagada"}),i.jsx("input",{value:`$ ${Ri(le)}`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-800"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Gastos extras"}),i.jsx("input",{type:"number",inputMode:"decimal",value:y,onChange:D=>b(D.target.value),placeholder:"0.00",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Total final"}),i.jsx("input",{value:`$ ${Ri(oe)}`,readOnly:!0,className:"w-full h-10 rounded-xl border border-gray-200 px-3 bg-gray-50 text-gray-900 font-extrabold"})]}),i.jsxs("label",{className:"space-y-1 md:col-span-2",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comentario"}),i.jsx("input",{value:w,onChange:D=>j(D.target.value),placeholder:"Opcional...",className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none focus:ring-2 focus:ring-gray-900/10"})]})]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{onClick:O,className:"w-full md:w-auto h-10 px-4 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800 active:scale-[0.99] transition",children:"Guardar movimiento"})})]}),i.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm p-3 md:p-4",children:[i.jsx("div",{className:"font-black text-sm text-gray-900 mb-3",children:"Registro detallado"}),d?i.jsx("div",{className:"text-sm text-gray-500",children:"Cargando..."}):c.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"No hay registros en el periodo."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1100px] w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50 text-gray-700",children:[i.jsx("th",{className:"text-left p-2 font-black",children:"Fecha"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Vendedor"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Monto entregado"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin %"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Comisin pagada"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Gastos"}),i.jsx("th",{className:"text-right p-2 font-black",children:"Total final"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Comentario"}),i.jsx("th",{className:"text-left p-2 font-black",children:"Acciones"})]})}),i.jsx("tbody",{children:c.map(D=>{if(!(I===D.id))return i.jsxs("tr",{className:"border-t",children:[i.jsx("td",{className:"p-2",children:Ur(D.date.toDate(),"yyyy-MM-dd")}),i.jsx("td",{className:"p-2 font-semibold",children:D.sellerName}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ri(D.amountDelivered)]}),i.jsxs("td",{className:"p-2 text-right",children:[Ri(D.commissionPercent),"%"]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ri(D.commissionPaid)]}),i.jsxs("td",{className:"p-2 text-right",children:["$ ",Ri(D.extraExpenses)]}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Ri(D.totalFinal)]}),i.jsx("td",{className:"p-2",children:D.comment}),i.jsx("td",{className:"p-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>H(D),className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Editar"}),i.jsx("button",{onClick:()=>W(D.id),className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold text-red-700 hover:bg-red-50",children:"Eliminar"})]})})]},D.id);const Z=Oa(S.amountDelivered??D.amountDelivered),be=Oa(S.commissionPercent??D.commissionPercent),U=Oa(S.extraExpenses??D.extraExpenses),ze=F_(Z,be),re=O_(Z,ze,U);return i.jsxs("tr",{className:"border-t bg-yellow-50/40",children:[i.jsx("td",{className:"p-2",children:i.jsx("input",{type:"date",value:String(S.dateInput??""),onChange:J=>E(Re=>({...Re,dateInput:J.target.value})),className:"h-9 px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2",children:i.jsxs("select",{value:String(S.sellerId??D.sellerId),onChange:J=>{const Re=J.target.value,ke=l.get(Re);E(Be=>({...Be,sellerId:Re,sellerName:(ke==null?void 0:ke.name)??"",commissionPercent:Oa((ke==null?void 0:ke.commissionPercent)??0)}))},className:"h-9 px-3 rounded-xl border border-gray-200 bg-white outline-none",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(J=>i.jsxs("option",{value:J.id,children:[J.name," ",J.branch?`(${J.branch})`:""]},J.id))]})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(Z),onChange:J=>E(Re=>({...Re,amountDelivered:Oa(J.target.value)})),className:"h-9 w-32 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(be),onChange:J=>E(Re=>({...Re,commissionPercent:Oa(J.target.value)})),className:"h-9 w-24 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsxs("td",{className:"p-2 text-right font-semibold",children:["$ ",Ri(ze)]}),i.jsx("td",{className:"p-2 text-right",children:i.jsx("input",{type:"number",value:String(U),onChange:J=>E(Re=>({...Re,extraExpenses:Oa(J.target.value)})),className:"h-9 w-32 text-right px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsxs("td",{className:"p-2 text-right font-extrabold",children:["$ ",Ri(re)]}),i.jsx("td",{className:"p-2",children:i.jsx("input",{type:"text",value:String(S.comment??D.comment),onChange:J=>E(Re=>({...Re,comment:J.target.value})),className:"h-9 w-full px-3 rounded-xl border border-gray-200 bg-white outline-none"})}),i.jsx("td",{className:"p-2",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>L(D.id),className:"h-8 px-3 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800",children:"Guardar"}),i.jsx("button",{onClick:G,className:"h-8 px-3 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Cancelar"})]})})]},D.id)})})]})}),i.jsxs("div",{className:"md:hidden space-y-3",children:[c.map(D=>i.jsxs("div",{className:"rounded-2xl border border-gray-100 p-3 bg-white",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("div",{className:"font-black text-gray-900",children:D.sellerName}),i.jsx("div",{className:"text-xs font-extrabold bg-gray-100 rounded-full px-3 py-1",children:Ur(D.date.toDate(),"yyyy-MM-dd")})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Monto entregado"}),i.jsxs("div",{className:"font-extrabold",children:["$ ",Ri(D.amountDelivered)]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comisin %"}),i.jsxs("div",{className:"font-semibold",children:[Ri(D.commissionPercent),"%"]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comisin pagada"}),i.jsxs("div",{className:"font-semibold",children:["$ ",Ri(D.commissionPaid)]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Gastos"}),i.jsxs("div",{className:"font-semibold",children:["$ ",Ri(D.extraExpenses)]})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Total final"}),i.jsxs("div",{className:"text-base font-black",children:["$ ",Ri(D.totalFinal)]})]}),D.comment?i.jsxs("div",{className:"col-span-2",children:[i.jsx("div",{className:"text-[11px] font-bold text-gray-500",children:"Comentario"}),i.jsx("div",{className:"text-sm text-gray-800",children:D.comment})]}):null]}),i.jsxs("div",{className:"mt-3 flex gap-2",children:[i.jsx("button",{onClick:()=>H(D),className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Editar"}),i.jsx("button",{onClick:()=>W(D.id),className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold text-red-700 hover:bg-red-50",children:"Eliminar"})]})]},D.id)),I?i.jsxs("div",{className:"rounded-2xl border border-yellow-200 bg-yellow-50 p-3",children:[i.jsx("div",{className:"font-black text-gray-900 mb-3",children:"Editando registro"}),i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Fecha"}),i.jsx("input",{type:"date",value:String(S.dateInput??""),onChange:D=>E(Q=>({...Q,dateInput:D.target.value})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Vendedor"}),i.jsxs("select",{value:String(S.sellerId??""),onChange:D=>{const Q=D.target.value,Z=l.get(Q);E(be=>({...be,sellerId:Q,sellerName:(Z==null?void 0:Z.name)??"",commissionPercent:Oa((Z==null?void 0:Z.commissionPercent)??0)}))},className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white",children:[i.jsx("option",{value:"",children:"Seleccionar..."}),s.map(D=>i.jsxs("option",{value:D.id,children:[D.name," ",D.branch?`(${D.branch})`:""]},D.id))]})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Monto entregado"}),i.jsx("input",{type:"number",value:String(S.amountDelivered??""),onChange:D=>E(Q=>({...Q,amountDelivered:Oa(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Gastos extras"}),i.jsx("input",{type:"number",value:String(S.extraExpenses??""),onChange:D=>E(Q=>({...Q,extraExpenses:Oa(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comisin %"}),i.jsx("input",{type:"number",value:String(S.commissionPercent??""),onChange:D=>E(Q=>({...Q,commissionPercent:Oa(D.target.value)})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("label",{className:"space-y-1",children:[i.jsx("span",{className:"text-xs font-bold text-gray-600",children:"Comentario"}),i.jsx("input",{type:"text",value:String(S.comment??""),onChange:D=>E(Q=>({...Q,comment:D.target.value})),className:"w-full h-10 rounded-xl border border-gray-200 px-3 outline-none bg-white"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>L(I),className:"flex-1 h-10 rounded-xl bg-gray-900 text-white font-extrabold hover:bg-gray-800",children:"Guardar"}),i.jsx("button",{onClick:G,className:"flex-1 h-10 rounded-xl border border-gray-200 font-extrabold hover:bg-gray-50",children:"Cancelar"})]})]})]}):null]})]})]})]})]})}const op=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Tit(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function oW(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function Bit(t){const e=String(t||"").trim();if(!e)return 0;const r=Date.parse(e);return Number.isFinite(r)?r:0}function kit({open:t,onClose:e,onDetected:r}){const n=g.useRef(null),a=g.useRef(null),[s,o]=g.useState(""),l=g.useRef("");return g.useEffect(()=>{if(!t)return;let c=!1;const u=new K2,d=()=>{var A,h,m;try{(A=a.current)==null||A.stop()}catch{}a.current=null;try{const p=(h=n.current)==null?void 0:h.srcObject;(m=p==null?void 0:p.getTracks)==null||m.call(p).forEach(x=>x.stop())}catch{}try{n.current&&(n.current.srcObject=null)}catch{}};return(async()=>{o("");try{if(!n.current)return;try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1})).getTracks().forEach(m=>m.stop())}catch{}const A=await u.decodeFromConstraints({video:{facingMode:{ideal:"environment"},width:{ideal:1280},height:{ideal:720}},audio:!1},n.current,h=>{if(!c&&h){const m=String(h.getText()||"").trim().replace(/\s+/g,"");if(!m||m===l.current)return;l.current=m,d(),r(m),e()}});a.current=A}catch(A){const h=String((A==null?void 0:A.message)||""),m=String((A==null?void 0:A.name)||"");h.toLowerCase().includes("permission")||m==="NotAllowedError"?o("Permiso de cmara denegado."):m==="NotFoundError"||h.toLowerCase().includes("notfound")?o("No se encontr cmara en este dispositivo."):h.toLowerCase().includes("secure")||h.toLowerCase().includes("https")?o("La cmara requiere HTTPS (sitio seguro)."):o(h||"No se pudo iniciar el escner.")}})(),()=>{c=!0,d()}},[t,e,r]),t?i.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 p-3 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg border overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[i.jsx("div",{className:"font-bold",children:"Escanear cdigo"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:e,type:"button",children:"Cerrar"})]}),i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden",children:[i.jsx("video",{ref:n,className:"w-full h-full object-cover",muted:!0,playsInline:!0,autoPlay:!0}),i.jsx("div",{className:"absolute inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[85%] h-40 border-2 border-white/70 rounded-xl"})})]}),s&&i.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded p-2",children:s}),i.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Apunt al cdigo de barras y mantenelo estable."})]})]})}):null}function Fit(){const{refreshKey:t,refresh:e}=Mc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,u]=g.useState(""),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState("ANY"),[y,b]=g.useState(!1),[w,j]=g.useState({});g.useEffect(()=>{(async()=>{n(!0),s("");try{const ye=await Ht(sr(bt(je,"candy_main_orders"))),We=new Map;ye.forEach(Ie=>{var Le,Ce,pe;const xt=Ie.data(),Pt=Bit(xt.date),It=((Ce=(Le=xt==null?void 0:xt.createdAt)==null?void 0:Le.toMillis)==null?void 0:Ce.call(Le))||((pe=xt==null?void 0:xt.createdAt)!=null&&pe.seconds?xt.createdAt.seconds*1e3:0)||0,Ut=Math.max(Pt,It),$t=Array.isArray(xt.items)?xt.items:[];for(const He of $t){const he=String((He==null?void 0:He.id)||(He==null?void 0:He.productId)||"").trim();if(!he)continue;const ee=String((He==null?void 0:He.name)||(He==null?void 0:He.productName)||"").trim(),_e=String((He==null?void 0:He.category)||"").trim(),R=Number((He==null?void 0:He.unitPriceIsla)||0),V=Number((He==null?void 0:He.unitPriceRivas)||0),q=Number((He==null?void 0:He.unitsPerPackage)||(He==null?void 0:He.unitsPerPack)||1),se=We.get(he);(!se||Ut>=se._sortKey)&&We.set(he,{productId:he,category:_e,productName:ee,priceIsla:R,priceRivas:V,unitsPerPackage:q,_sortKey:Ut})}});const ge=Array.from(We.values()).sort((Ie,xt)=>Ie.productName.localeCompare(xt.productName,"es"));l(ge)}catch(ye){console.error(ye),s(" Error cargando precios desde rdenes maestras."),l([])}finally{n(!1)}})()},[t]),g.useEffect(()=>{const ye=bt(je,"products_candies"),We=sr(ye),ge=Pd(We,Ie=>{const xt={},Pt={},It={},Ut={};Ie.forEach($t=>{const Le=$t.data();xt[$t.id]=Number((Le==null?void 0:Le.providerPrice)||(Le==null?void 0:Le.providerPricePerUnit)||0),It[$t.id]=Number((Le==null?void 0:Le.unitsPerPackage)||(Le==null?void 0:Le.unitsPerPack)||1)||1;const Ce=String((Le==null?void 0:Le.barcode)||"").trim();Ce&&(Pt[$t.id]=Ce);const pe=String((Le==null?void 0:Le.packaging)||(Le==null?void 0:Le.empaque)||"").trim();pe&&(Ut[$t.id]=pe)});try{const $t=S.current||{};let Le=!1;for(const he of Object.keys(Pt))if((Pt[he]||"")!==($t[he]||"")){Le=!0;break}const Ce=B.current||{};let pe=!1;for(const he of Object.keys(It))if((It[he]||0)!==(Ce[he]||0)){pe=!0;break}K(xt),oe(It);const He={...Pt,...$t};C(He),S.current=He,B.current={...It},Te(Ut),l(he=>he.map(ee=>({...ee,unitsPerPackage:It[ee.productId]??ee.unitsPerPackage}))),!E.current&&Le&&(s(" Cdigo actualizado."),setTimeout(()=>s(""),3e3)),!E.current&&pe&&(s(" Unidades x paquete actualizadas."),setTimeout(()=>s(""),3e3)),E.current=!1}catch{K(xt),oe(It),C(Le=>({...Pt,...Le})),B.current={...It},Te(Ut),l(Le=>Le.map(Ce=>({...Ce,unitsPerPackage:It[Ce.productId]??Ce.unitsPerPackage})))}},Ie=>console.error(Ie));return()=>ge()},[]);const[I,C]=g.useState({}),S=g.useRef({}),E=g.useRef(!0),B=g.useRef({}),k=g.useRef({}),T=g.useRef(!0),[P,K]=g.useState({}),[le,oe]=g.useState({}),[ie,Ae]=g.useState({}),[te,Te]=g.useState({}),[Ue,O]=g.useState("");g.useEffect(()=>{const ye=bt(je,"inventory_candies"),We=sr(ye),ge=Pd(We,Ie=>{try{const xt={};Ie.forEach(It=>{var He,he,ee;const Ut=It.data(),$t=String(Ut.productId||"").trim();if(!$t)return;const Le=Number(Ut.unitsPerPackage||Ut.unitsPerPack||0)||0,Ce=((he=(He=Ut==null?void 0:Ut.createdAt)==null?void 0:He.toMillis)==null?void 0:he.call(He))||((ee=Ut==null?void 0:Ut.createdAt)!=null&&ee.seconds?Ut.createdAt.seconds*1e3:0)||0,pe=xt[$t];(!pe||Ce>=pe.ts)&&(xt[$t]={val:Le||0,ts:Ce})});const Pt={};for(const It of Object.keys(xt))Pt[It]=xt[It].val||0;Ae(Pt);try{const It=k.current||{};let Ut=!1;for(const $t of Object.keys(Pt))if((Pt[$t]||0)!==(It[$t]||0)){Ut=!0;break}k.current={...Pt},!T.current&&Ut&&(s(" Inventario: unidades por paquete actualizadas."),setTimeout(()=>s(""),3e3)),T.current=!1}catch{}l(It=>It.map(Ut=>({...Ut,unitsPerPackage:Pt[Ut.productId]??le[Ut.productId]??Ut.unitsPerPackage})))}catch(xt){console.error("inventory_candies snapshot error:",xt)}},Ie=>console.error(Ie));return()=>ge()},[le]),g.useEffect(()=>{l(ye=>ye.map(We=>({...We,unitsPerPackage:ie[We.productId]??le[We.productId]??We.unitsPerPackage})))},[le,ie]);const H=g.useMemo(()=>{const ye=Tit(c),We=String(d||"").trim(),ge=String(Ue||"").trim().toLowerCase(),Ie=A.trim()===""?null:oW(A,NaN),xt=m.trim()===""?null:oW(m,NaN);return o.filter(Pt=>{const It=String(te[Pt.productId]||"").trim().toLowerCase();if(ge)return It===ge;if(ye&&!`${Pt.category} ${Pt.productName}`.toLowerCase().includes(ye))return!1;if(We){const Ce=String(Pt.productId||""),pe=String(I[Pt.productId]||"");if(!Ce.includes(We)&&!pe.includes(We))return!1}const Ut=x==="ISLA"?[Pt.priceIsla]:x==="RIVAS"?[Pt.priceRivas]:[Pt.priceIsla,Pt.priceRivas],$t=Ie==null||!Number.isFinite(Ie)?!0:Ut.some(Ce=>Ce>=Ie),Le=xt==null||!Number.isFinite(xt)?!0:Ut.some(Ce=>Ce<=xt);return $t&&Le})},[o,c,A,m,x,I,Ue,te]),G=g.useMemo(()=>{const ye=new Map;for(const We of H){const ge=(We.category||"Sin categora").trim()||"Sin categora",Ie=ye.get(ge)||[];Ie.push(We),ye.set(ge,Ie)}return Array.from(ye.entries()).sort(([We],[ge])=>We.localeCompare(ge,"es"))},[H]),L=5,[W,X]=g.useState(1),D=Math.max(1,Math.ceil(G.length/L)),Q=g.useMemo(()=>{const ye=(W-1)*L;return G.slice(ye,ye+L)},[G,W]);g.useEffect(()=>{X(1)},[c,d,A,m,x,Ue]),g.useEffect(()=>{X(ye=>Math.min(ye,D))},[D]);const Z=()=>X(1),be=()=>X(ye=>Math.max(1,ye-1)),U=()=>X(ye=>Math.min(D,ye+1)),ze=()=>X(D),re=()=>i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Z,disabled:W===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:be,disabled:W===1,children:" Anterior"}),i.jsxs("span",{className:"px-2 text-sm",children:["Pgina ",W," de ",D]}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:U,disabled:W===D,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ze,disabled:W===D,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[G.length," categora(s)"]})]}),J=ye=>{j(We=>({...We,[ye]:!We[ye]}))},Re=()=>{u(""),h(""),p(""),v("ANY"),O("")},[ke,Be]=g.useState(!1),[Ye,ot]=g.useState("search"),[Ct,jt]=g.useState(null),[Ot,Tt]=g.useState(0),[Qt,Ft]=g.useState(0),[Qe,De]=g.useState(null),[Je,dt]=g.useState(""),[ce,we]=g.useState(""),ue=g.useMemo(()=>c.trim()!==""||A.trim()!==""||m.trim()!==""||x!=="ANY"||Ue.trim()!=="",[c,A,m,x,Ue]),[ne,Ve]=g.useState(!1);g.useEffect(()=>{var ge;const ye=window.matchMedia("(max-width: 900px)"),We=()=>Ve(ye.matches);return We(),(ge=ye.addEventListener)==null||ge.call(ye,"change",We),()=>{var Ie;return(Ie=ye.removeEventListener)==null?void 0:Ie.call(ye,"change",We)}},[]);const[it,vt]=g.useState(!1);g.useEffect(()=>{const ye=yj(Ic,async We=>{if(!We)return vt(!1);try{const ge=await Cs(Xt(je,"users",We.uid)),Ie=ge.exists()?ge.data():null,xt=Ie?Array.isArray(Ie.roles)?Ie.roles:Ie.role?[Ie.role]:[]:[];vt(Sn(xt,"admin"))}catch(ge){console.error(ge),vt(!1)}});return()=>ye()},[]);const me=async ye=>{var We;if(Ye==="search"){f(ye);const ge=Object.keys(I).find(Pt=>(I[Pt]||"")===ye),Ie=(We=o.find(Pt=>String(Pt.productId||"").includes(ye)))==null?void 0:We.productId,xt=ge||Ie||null;xt&&(De(xt),b(!1)),Be(!1);return}if(Ye==="edit"&&Ct)try{const ge=bt(je,"products_candies"),Ie=Xt(ge,Ct);await kn(Ie,{barcode:ye}),C(xt=>({...xt,[Ct]:ye})),dt(ye),Be(!1),ot("search"),s(" Producto guardado.")}catch(ge){console.error(ge),s(" Error guardando el cdigo.")}},Ee=async ye=>{l(We=>We.map(ge=>ge.productId===ye?{...ge,priceIsla:Number(Ot||0),priceRivas:Number(Qt||0)}:ge));try{const We=String(ce||"").trim();await kn(Xt(bt(je,"products_candies"),ye),{packaging:We||""}),Te(ge=>({...ge,[ye]:We||""}))}catch(We){console.error("Error updating packaging:",We),s(" Error guardando empaque.")}jt(null),s(ne?" Producto guardado.":"")};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Precio Ventas"}),i.jsx("div",{className:"flex gap-2",children:i.jsx(Rc,{onClick:e,loading:r})})]}),i.jsxs("div",{className:"md:hidden mb-3",children:[i.jsxs("button",{type:"button",onClick:()=>b(ye=>!ye),className:`w-full px-3 py-3 rounded-xl border shadow-sm flex items-center justify-between ${ue?"bg-yellow-50 border-yellow-200":"bg-white"}`,children:[i.jsxs("div",{className:"text-left",children:[i.jsx("div",{className:"font-semibold",children:"Filtros"}),i.jsxs("div",{className:"text-xs text-gray-600",children:[ue?"Activos":"Ninguno","  ","Mostrando ",i.jsx("b",{children:H.length})]})]}),i.jsx("div",{className:"text-sm font-semibold",children:y?"Cerrar":"Abrir"})]}),y&&i.jsx("div",{className:"mt-2 bg-white border rounded-xl shadow-sm p-3 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:c,onChange:ye=>u(ye.target.value),placeholder:"Ej: Conitos, Gomitas"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:Ue,onChange:ye=>O(ye.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Buscar por EAN"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:d,onChange:ye=>f(ye.target.value),placeholder:"Cdigo EAN"}),i.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{ot("search"),Be(!0)},children:"Escanear"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Re(),f("")},children:"Limpiar filtros"}),i.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>b(!1),children:"Aplicar"})]})]})})]}),i.jsxs("div",{className:"hidden md:block bg-white p-3 rounded shadow border mb-3 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-6 gap-3 items-end",children:[i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Filtrar por producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:ye=>u(ye.target.value),placeholder:"Ej: Conitos, Gomitas"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo empaque"}),i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Ue,onChange:ye=>O(ye.target.value),children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio mn"}),i.jsx("input",{className:"w-full border rounded px-2 py-1 text-right",inputMode:"decimal",value:A,onChange:ye=>h(ye.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio mx"}),i.jsx("input",{className:"w-full border rounded px-2 py-1 text-right",inputMode:"decimal",value:m,onChange:ye=>p(ye.target.value),placeholder:"0"})]}),i.jsx("div",{className:"text-right",children:i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:Re,children:"Limpiar"})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[i.jsxs("div",{className:"text-xs text-gray-600",children:["Fuente: ",i.jsx("b",{children:"candy_main_orders.items[]"}),"  Muestra el"," ",i.jsx("b",{children:"ltimo precio"})," registrado por producto."]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Mostrando:"})," ",i.jsx("b",{children:H.length})]})]})]}),i.jsxs("div",{className:"md:hidden",children:[r?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Cargando"}):H.length===0?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Sin resultados."}):i.jsx("div",{className:"space-y-2",children:Q.map(([ye,We])=>{const ge=!!w[ye];return i.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>J(ye),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[13px] font-semibold truncate",children:ye}),i.jsxs("div",{className:"text-[10px] text-gray-600 truncate",children:[We.length," ",We.length===1?"producto":"productos"]})]}),i.jsx("div",{className:"text-sm font-semibold",children:ge?"":"+"})]}),ge&&i.jsx("div",{className:"px-3 pb-3 border-t space-y-2",children:We.map(Ie=>{const xt=Qe===Ie.productId,Pt=Ct===Ie.productId,It=P[Ie.productId]||0,Ut=Ie.priceIsla-It,$t=Ut*.25;return i.jsxs("div",{className:"bg-white border rounded-xl overflow-hidden",children:[i.jsxs("button",{type:"button",className:"w-full px-3 py-3 flex items-center justify-between text-left",onClick:()=>De(Le=>Le===Ie.productId?null:Ie.productId),children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"text-[13px] font-semibold truncate",children:Ie.productName}),i.jsx("div",{className:"text-[10px] text-gray-600 truncate",children:Ie.category})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"P. Paquete"}),i.jsx("div",{className:"text-sm font-semibold tabular-nums",children:op(Ie.priceIsla)})]})]}),xt&&i.jsx("div",{className:"px-3 pb-3 border-t",children:i.jsxs("div",{className:"pt-3 space-y-2 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Categora"}),i.jsx("div",{className:"text-sm",children:Ie.category}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Unidades x paquete"}),i.jsx("div",{className:"text-sm",children:String(Ie.unitsPerPackage||1)})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Precio Unidad"}),i.jsx("div",{className:"text-sm tabular-nums",children:op(Ie.priceIsla/(Ie.unitsPerPackage||1))})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Precio Paquete"}),Pt?i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:String(Ot),onChange:Le=>Tt(Number(Le.target.value||0))}):i.jsx("div",{className:"text-sm font-semibold tabular-nums",children:op(Ie.priceIsla)})]})]}),i.jsxs("div",{children:[it&&i.jsxs("div",{children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Utilidad Bruta"}),i.jsx("div",{className:"text-sm tabular-nums",children:op(Ut)})]}),i.jsxs("div",{className:"mt-1",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Comisin"}),i.jsx("div",{className:"text-sm tabular-nums",children:op($t)})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Cdigo EAN"}),Pt?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:Je,readOnly:!0}),i.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white",onClick:()=>{ot("edit"),Be(!0)},type:"button",children:"Escanear"})]}):i.jsx("div",{children:I[Ie.productId]||""})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] text-gray-600",children:"Tipo Empaque"}),Pt?i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:ce,onChange:Le=>we(Le.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):i.jsx("div",{className:"text-sm",children:te[Ie.productId]||""})]})]})]}),i.jsx("div",{className:"flex gap-2",children:Pt?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white",onClick:()=>{Ee(Ie.productId),De(null)},type:"button",children:"Guardar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-800 text-white",onClick:()=>{ot("edit"),Be(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200",onClick:()=>jt(null),type:"button",children:"Cancelar"})]}):it&&i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"px-3 py-2 rounded bg-yellow-400",onClick:()=>{jt(Ie.productId),Tt(Ie.priceIsla||0),Ft(Ie.priceRivas||0),dt(I[Ie.productId]||""),we(te[Ie.productId]||"")},type:"button",children:"Editar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white",onClick:()=>l(Le=>Le.filter(Ce=>Ce.productId!==Ie.productId)),type:"button",children:"Borrar"})]})})]})})]},Ie.productId)})})]},ye)})}),!r&&G.length>0&&re(),a&&i.jsx("p",{className:"mt-2 text-sm",children:a})]}),i.jsx(kit,{open:ke,onClose:()=>Be(!1),onDetected:me}),i.jsx("div",{className:"hidden md:block bg-white rounded shadow border w-full overflow-x-auto",children:i.jsxs("table",{className:"min-w-[900px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-left",children:"Empaque"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio Isla"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio Rivas"}),i.jsx("th",{className:"p-2 border text-right",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):H.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin resultados."})}):H.map(ye=>i.jsxs("tr",{children:[i.jsx("td",{className:"p-2 border",children:ye.category}),i.jsx("td",{className:"p-2 border",children:ye.productName}),i.jsx("td",{className:"p-2 border",children:Ct===ye.productId?i.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ce,onChange:We=>we(We.target.value),children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"Tarro",children:"Tarro"}),i.jsx("option",{value:"Bolsa",children:"Bolsa"}),i.jsx("option",{value:"Ristra",children:"Ristra"}),i.jsx("option",{value:"Caja",children:"Caja"}),i.jsx("option",{value:"Vaso",children:"Vaso"}),i.jsx("option",{value:"Pana",children:"Pana"})]}):te[ye.productId]||""}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ct===ye.productId?i.jsx("input",{className:"w-24 border rounded px-2 py-1 text-right",inputMode:"decimal",value:String(Ot),onChange:We=>Tt(Number(We.target.value||0))}):op(ye.priceIsla)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ct===ye.productId?i.jsx("input",{className:"w-24 border rounded px-2 py-1 text-right",inputMode:"decimal",value:String(Qt),onChange:We=>Ft(Number(We.target.value||0))}):op(ye.priceRivas)}),i.jsx("td",{className:"p-2 border text-right",children:Ct===ye.productId?i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white text-sm",onClick:()=>Ee(ye.productId),type:"button",children:"Guardar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 text-sm",onClick:()=>jt(null),type:"button",children:"Cancelar"})]}):it&&i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-sm",onClick:()=>{jt(ye.productId),Tt(ye.priceIsla||0),Ft(ye.priceRivas||0),dt(I[ye.productId]||"")},type:"button",children:"Editar"}),i.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white text-sm",onClick:()=>{jt(ye.productId),ot("edit"),Be(!0)},type:"button",children:"Escanear"}),i.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white text-sm",onClick:()=>l(We=>We.filter(ge=>ge.productId!==ye.productId)),type:"button",children:"Borrar"})]})})]},ye.productId))})]})}),a&&i.jsx("p",{className:"hidden md:block mt-2 text-sm",children:a})]})}const R_=["Cuaderno","Block","Lapicero","Lpiz","Tajador","Borrador","Corrector","Cartucheras"],lW=["Lider","Scribe","Smarty","Pointer","Paper Mate","Otro"],RT=["Hombre","Mujer","Variado","NA"],Oit=["Universitario Cocido","5 Materia","2 Materia","Doble Raya","Rayado","Cuadriculado","Subrayado","Sublineado","Liso"],Wl=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function No(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function bc(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function IE(t,e=1){const r=Math.floor(bc(t,e));return r>0?r:e}function dde(t){return!Number.isFinite(t)||t<=0?0:t}function MT(t){const e=String(t??"").trim();return e||""}function tf(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(a=>n.set(No(a),a));for(const a of e){const s=n.get(No(a));if(s!=null)return t[s]}}function Dit(t){return Object.values(t||{}).every(r=>No(r)==="")}function _x(t){const e=Math.max(0,bc(t.providerPrice,0)),r=Math.max(1,IE(t.quantity,1)),n=dde(bc(t.margin,0)),a=Math.max(0,bc(t.salePrice,0)),s=n>0?e/n:e,o=a>0?a:s,l=o>0?e/o:n,c=e*r,u=(o-e)*r,d=o*r;return{providerPrice:e,quantity:r,margin:l,salePrice:o,facturado:c,gain:u,totalEsperado:d}}function Rit(){const{refreshKey:t,refresh:e}=Mc(),[r,n]=g.useState(!0),[a,s]=g.useState(""),[o,l]=g.useState([]),[c,u]=g.useState(!1),[d,f]=g.useState(""),[A,h]=g.useState(""),[m,p]=g.useState(""),[x,v]=g.useState(""),[y,b]=g.useState(!1),[w,j]=g.useState(null),[I,C]=g.useState(!1),[S,E]=g.useState(null),[B,k]=g.useState(R_[0]),[T,P]=g.useState(lW[0]),[K,le]=g.useState(""),[oe,ie]=g.useState(0),[Ae,te]=g.useState(1),[Te,Ue]=g.useState(.7),[O,H]=g.useState(0),[G,L]=g.useState("NA"),[W,X]=g.useState(""),[D,Q]=g.useState(""),[Z,be]=g.useState(!1),[U,ze]=g.useState(""),[re,J]=g.useState([]),[Re,ke]=g.useState([]),[Be,Ye]=g.useState(!1);g.useEffect(()=>{(async()=>{n(!0),s("");try{const me=await Ht(sr(bt(je,"products_stationery"))),Ee=[];me.forEach(ye=>{const We=ye.data();Ee.push({id:ye.id,category:We.category||"",brand:We.brand||"",name:We.name||"",providerPrice:Number(We.providerPrice||0),quantity:Number(We.quantity||1),facturado:Number(We.facturado||0),margin:Number(We.margin||0),salePrice:Number(We.salePrice||0),gain:Number(We.gain||0),gender:We.gender||"NA",typeProduct:We.typeProduct||"",code:We.code??"",createdAt:We.createdAt,updatedAt:We.updatedAt,totalEsperado:Number(We.totalEsperado||Number(We.salePrice||0)*Number(We.quantity||1))})}),l(Ee)}catch(me){console.error(me),s(" Error cargando productos (papelera).")}finally{n(!1)}})()},[t]);const ot=g.useMemo(()=>{const me=No(d),Ee=No(A),ye=m.trim()===""?null:bc(m,NaN),We=x.trim()===""?null:bc(x,NaN);return o.filter(ge=>!(me&&!`${ge.category} ${ge.name}`.toLowerCase().includes(me)||Ee&&!String(ge.code||"").toLowerCase().includes(Ee)||ye!=null&&Number.isFinite(ye)&&ge.salePrice<ye||We!=null&&Number.isFinite(We)&&ge.salePrice>We))},[o,d,A,m,x]),Ct=g.useMemo(()=>d.trim()!==""||A.trim()!==""||m.trim()!==""||x.trim()!=="",[d,A,m,x]),jt=g.useMemo(()=>{const me=o.length,Ee=o.reduce((ge,Ie)=>ge+(Ie.facturado||0),0),ye=o.reduce((ge,Ie)=>ge+Number(Ie.totalEsperado||Number(Ie.salePrice||0)*Number(Ie.quantity||1)),0),We=o.reduce((ge,Ie)=>ge+(Ie.gain||0),0);return{count:me,sumFact:Ee,sumEsperado:ye,sumGain:We}},[o]),Ot=()=>{k(R_[0]),le(""),ie(0),te(1),Ue(.7),H(0),L("NA"),X(""),Q(""),j(null)},Tt=()=>{Ot(),b(!0)},Qt=me=>{j(me),k(me.category||R_[0]),P(me.brand||lW[0]),le(me.name||""),ie(Number(me.providerPrice||0)),te(Number(me.quantity||1)),Ue(Number(me.margin||.7)),H(Number(me.salePrice||0)),L(me.gender||"NA"),X(me.typeProduct||""),Q(String(me.code||"")),b(!0)},Ft=async()=>{s("");const me=String(B||"").trim(),Ee=String(T||"").trim(),ye=String(K||"").trim(),{providerPrice:We,quantity:ge,margin:Ie,salePrice:xt,facturado:Pt,totalEsperado:It,gain:Ut}=_x({providerPrice:oe,quantity:Ae,margin:Te,salePrice:O});if(!me)return s(" Categora requerida.");if(!ye)return s(" Producto requerido.");if(We<=0)return s(" Precio proveedor debe ser > 0.");if(ge<=0)return s(" Cantidad debe ser > 0.");if(xt<=0)return s(" Precio venta invlido.");if(Ie<=0)return s(" Margen invlido.");const $t={category:me,brand:Ee,name:ye,providerPrice:We,quantity:ge,facturado:Pt,margin:Ie,salePrice:xt,gain:Ut,gender:G||"NA",typeProduct:String(W||"").trim(),code:MT(D)||null,updatedAt:xr.now(),totalEsperado:It};try{n(!0),w?(await kn(Xt(je,"products_stationery",w.id),$t),s(" Producto actualizado.")):(await Wn(bt(je,"products_stationery"),{...$t,createdAt:xr.now()}),s(" Producto creado.")),b(!1),j(null),Ot(),e()}catch(Le){console.error(Le),s(" Error guardando producto.")}finally{n(!1)}},Qe=async()=>{var me;try{const Ee=new K2,ye=await K2.listVideoInputDevices(),We=(me=ye[ye.length-1])==null?void 0:me.deviceId;if(!We)return null;const ge=document.createElement("div");ge.className="fixed inset-0 z-[9999] bg-black/70 flex items-center justify-center p-3";const Ie=document.createElement("div");Ie.className="bg-white w-full max-w-md rounded-xl overflow-hidden shadow-xl";const xt=document.createElement("div");xt.className="p-3 flex items-center justify-between border-b",xt.innerHTML="<div style='font-weight:700'>Escanear cdigo</div>";const Pt=document.createElement("button");Pt.textContent="Cerrar",Pt.className="px-3 py-1 rounded bg-gray-200";const It=document.createElement("div");It.className="p-3";const Ut=document.createElement("video");return Ut.style.width="100%",Ut.style.borderRadius="12px",It.appendChild(Ut),xt.appendChild(Pt),Ie.appendChild(xt),Ie.appendChild(It),ge.appendChild(Ie),document.body.appendChild(ge),await new Promise(async $t=>{const Le=()=>{ge.remove(),$t(null)};Pt.onclick=Le;const Ce=await Ee.decodeFromVideoDevice(We,Ut,pe=>{if(pe){const He=pe.getText();try{Ce.stop()}catch{}ge.remove(),$t(He)}})})}catch(Ee){return console.error(Ee),null}},De=async()=>{const me=await Qe();me&&Q(me)},Je=async()=>{const me=await Qe();if(!me)return;const Ee=o.find(ye=>String(ye.code||"")===String(me));Ee?(E(Ee),C(!0),s("")):(E(null),C(!0),s(""))},dt=(me,Ee)=>{const ye=me.map(Ie=>({Id:Ie.id,Categoria:Ie.category,brand:Ie.brand,Producto:Ie.name,PrecioProveedor:Ie.providerPrice,Cantidad:Ie.quantity,Facturado:Ie.facturado,TotalEsperado:Ie.totalEsperado||Ie.salePrice*Ie.quantity,Margen:Ie.margin,PrecioVenta:Ie.salePrice,Ganancia:Ie.gain,Genero:Ie.gender,TipoProducto:Ie.typeProduct,Codigo:Ie.code||""})),We=Qa.json_to_sheet(ye),ge=Qa.book_new();Qa.book_append_sheet(ge,We,"Productos"),$2(ge,Ee)},ce=()=>{const me=[{Id:"",Categoria:"Cuaderno",brand:"Lider",Producto:"Cuaderno Norma 100 hojas",PrecioProveedor:120,Cantidad:12,Margen:.7,PrecioVenta:"",Genero:"NA",TipoProducto:"Universitario Cocido",Codigo:"1234567890123"}],Ee=Qa.json_to_sheet(me),ye=Qa.book_new();Qa.book_append_sheet(ye,Ee,"Productos");const We=gP(ye,{type:"array",bookType:"xlsx"}),ge=new Blob([We],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Ie=URL.createObjectURL(ge),xt=document.createElement("a");xt.href=Ie,xt.download="template_products_stationery.xlsx",document.body.appendChild(xt),xt.click(),xt.remove(),URL.revokeObjectURL(Ie)},we=me=>{const Ee=[],ye=[];me.forEach((ge,Ie)=>{if(!ge||typeof ge!="object"||Dit(ge))return;const xt=Ie+2,Pt=String(tf(ge,["Id","ID","docId","DocId"])??"").trim(),It=String(tf(ge,["Categoria","Categora","Category","category"])??"").trim(),Ut=String(tf(ge,["Brand","Marca","brand","marca"])??"").trim(),$t=String(tf(ge,["Producto","Product","Nombre","Name","name"])??"").trim(),Le=tf(ge,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Costo","providerPrice"]),Ce=tf(ge,["Cantidad","Qty","quantity","cantidad"]),pe=tf(ge,["Margen","Margin","margen","margin"]),He=tf(ge,["PrecioVenta","Precio Venta","SalePrice","salePrice"]),he=String(tf(ge,["Genero","Gnero","Gender","gender"])??"NA").trim(),ee=String(tf(ge,["TipoProducto","Tipo","TypeProduct","typeProduct","Tipo producto"])??"").trim(),_e=tf(ge,["Codigo","Cdigo","Code","Barcode","code"]),R=MT(_e),V=Math.max(0,bc(Le,0)),q=Math.max(1,IE(Ce,1)),se=dde(bc(pe,0)),Ne=Math.max(0,bc(He,0));It||ye.push(`Fila ${xt}: falta Categoria.`),$t||ye.push(`Fila ${xt}: falta Producto.`),V<=0&&ye.push(`Fila ${xt}: PrecioProveedor debe ser > 0.`),q<=0&&ye.push(`Fila ${xt}: Cantidad debe ser > 0.`),se<=0&&Ne<=0&&ye.push(`Fila ${xt}: Margen debe ser > 0 (o enviar PrecioVenta).`);const Ke=RT.includes(he||"NA")?he:"NA";It&&$t&&V>0&&q>0&&(se>0||Ne>0)&&Ee.push({id:Pt||void 0,category:It,brand:Ut,name:$t,providerPrice:V,quantity:q,margin:se>0?se:.7,salePrice:Ne>0?Ne:void 0,gender:Ke,typeProduct:ee,code:R||"",_raw:ge})});const We=new Map;for(const ge of Ee){const Ie=ge.id?`id::${ge.id}`:`${No(ge.category)}::${No(ge.name)}`;We.set(Ie,ge)}return{rows:Array.from(We.values()),errors:ye}},ue=async me=>{if(s(""),ke([]),J([]),ze((me==null?void 0:me.name)||""),!me)return;const Ee=me.name.toLowerCase(),ye=Ee.endsWith(".xlsx")||Ee.endsWith(".xls"),We=Ee.endsWith(".csv");if(!ye&&!We){ke(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{Ye(!0);const ge=new FileReader,Ie=await new Promise((Ce,pe)=>{ge.onerror=()=>pe(new Error("No se pudo leer el archivo.")),ge.onload=()=>Ce(ge.result),ge.readAsArrayBuffer(me)}),xt=$v(new Uint8Array(Ie),{type:"array"}),Pt=xt.SheetNames[0],It=xt.Sheets[Pt],Ut=Qa.sheet_to_json(It,{defval:""}),{rows:$t,errors:Le}=we(Ut);J($t),ke(Le),$t.length===0&&Le.length===0&&ke(["No se encontraron filas vlidas para importar."])}catch(ge){console.error(ge),ke(["Error leyendo el archivo. Revis que no est corrupto."])}finally{Ye(!1)}},ne=(me,Ee)=>{J(ye=>{const We=[...ye],ge=We[me];return ge?(We[me]={...ge,...Ee},We):ye})},Ve=g.useMemo(()=>{const me=new Set(o.map(ge=>ge.id)),Ee=new Set(o.map(ge=>`${No(ge.category)}::${No(ge.name)}`));let ye=0,We=0;for(const ge of re){if(ge.id&&me.has(ge.id)){ye+=1;continue}const Ie=`${No(ge.category)}::${No(ge.name)}`;Ee.has(Ie)?ye+=1:We+=1}return{total:re.length,willCreate:We,willUpdate:ye}},[re,o]),it=async()=>{if(s(""),Re.length>0){s(" Correg los errores antes de importar.");return}if(re.length===0){s(" No hay filas para importar.");return}try{Ye(!0);const me={},Ee={};o.forEach(Ie=>{me[Ie.id]=Ie,Ee[`${No(Ie.category)}::${No(Ie.name)}`]=Ie});const ye=Sc(je);let We=0,ge=0;for(const Ie of re){const xt=String(Ie.category||"").trim(),Pt=String(Ie.name||"").trim(),{providerPrice:It,quantity:Ut,margin:$t,salePrice:Le,facturado:Ce,totalEsperado:pe,gain:He}=_x({providerPrice:Ie.providerPrice,quantity:Ie.quantity,margin:Ie.margin,salePrice:Ie.salePrice});if(!xt||!Pt||It<=0||Ut<=0||Le<=0||$t<=0)continue;const he={category:xt,name:Pt,providerPrice:It,quantity:Ut,facturado:Ce,totalEsperado:pe,margin:$t,salePrice:Le,gain:He,gender:Ie.gender||"NA",typeProduct:String(Ie.typeProduct||"").trim(),code:MT(Ie.code)||null,updatedAt:xr.now()};let ee;if(Ie.id&&me[Ie.id])ee=me[Ie.id];else{const _e=`${No(xt)}::${No(Pt)}`;ee=Ee[_e]}if(ee)ye.update(Xt(je,"products_stationery",ee.id),he),ge+=1;else{const _e=Xt(bt(je,"products_stationery"));ye.set(_e,{...he,createdAt:xr.now()}),We+=1}}await ye.commit(),s(` Importacin lista. Creados: ${We}, Actualizados: ${ge}`),be(!1),J([]),ke([]),ze(""),e()}catch(me){console.error(me),s(" Error importando productos a Firestore.")}finally{Ye(!1)}},vt=()=>{f(""),h(""),p(""),v("")};return i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Papelera"}),i.jsxs("div",{className:"flex gap-2 flex-wrap justify-end",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-900 text-white hover:bg-black",onClick:Je,type:"button",children:"Escanear"}),i.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:Tt,type:"button",children:"+ Nuevo"}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>{be(!0),J([]),ke([]),ze("")},type:"button",children:"Importar (.xlsx)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>dt(o,"products_stationery_todo.xlsx"),type:"button",children:"Exportar (todo)"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>dt(ot,"products_stationery_filtrado.xlsx"),type:"button",children:"Exportar (filtrado)"}),i.jsx(Rc,{onClick:e,loading:r||Be})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[i.jsx(M_,{label:"Productos",value:jt.count}),i.jsx(M_,{label:"Facturado",value:Wl(jt.sumFact)}),i.jsx(M_,{label:"Esperado",value:Wl(jt.sumEsperado)}),i.jsx(M_,{label:"Ganancia",value:Wl(jt.sumGain)})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("button",{className:`w-full md:w-auto px-3 py-2 rounded border bg-white hover:bg-gray-50 ${Ct?"border-yellow-300 bg-yellow-50":""}`,type:"button",onClick:()=>u(me=>!me),children:[c?"Cerrar filtros":"Abrir filtros"," ",Ct?"(activos)":""]}),c&&i.jsxs("div",{className:"mt-2 bg-white border rounded-xl shadow-sm p-3 text-sm",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 items-end",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:d,onChange:me=>f(me.target.value),placeholder:"Ej: Cuaderno Norma"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:A,onChange:me=>h(me.target.value),placeholder:"Barcode"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta mn"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:m,onChange:me=>p(me.target.value),placeholder:"0"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta mx"}),i.jsx("input",{className:"w-full border rounded px-2 py-2 text-right",inputMode:"decimal",value:x,onChange:me=>v(me.target.value),placeholder:"0"})]}),i.jsxs("div",{className:"md:col-span-4 flex gap-2 justify-end",children:[i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:vt,children:"Limpiar"}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:()=>u(!1),children:"Aplicar"})]})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-600",children:[i.jsxs("div",{children:["Mostrando: ",i.jsx("b",{children:ot.length})]}),i.jsxs("div",{children:["Coleccin: ",i.jsx("b",{children:"products_stationery"})]})]})]})]}),i.jsx("div",{className:"md:hidden space-y-2",children:r?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Cargando"}):ot.length===0?i.jsx("div",{className:"bg-white rounded-xl border shadow p-4 text-center",children:"Sin resultados."}):ot.map(me=>i.jsxs("div",{className:"bg-white border rounded-xl p-3 shadow-sm",children:[i.jsx("div",{className:"text-xs text-gray-600",children:me.category}),i.jsx("div",{className:"text-base font-bold leading-tight",children:me.name}),i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Venta"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:Wl(me.salePrice)})]}),i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Ganancia"}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Esperado:"," ",i.jsx("b",{children:Wl(me.totalEsperado||me.salePrice*me.quantity)})]}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:Wl(me.gain)})]})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:["Cdigo: ",i.jsx("b",{children:me.code||""})]}),i.jsx("div",{className:"mt-2 flex gap-2",children:i.jsx("button",{className:"flex-1 px-3 py-2 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>Qt(me),children:"Editar"})})]},me.id))}),i.jsx("div",{className:"hidden md:block bg-white border rounded overflow-x-auto",children:i.jsxs("table",{className:"min-w-[1200px] w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Facturado"}),i.jsx("th",{className:"p-2 border text-right",children:"Esperado"}),i.jsx("th",{className:"p-2 border text-right",children:"Margen"}),i.jsx("th",{className:"p-2 border text-right",children:"Venta"}),i.jsx("th",{className:"p-2 border text-right",children:"Ganancia"}),i.jsx("th",{className:"p-2 border text-left",children:"Gnero"}),i.jsx("th",{className:"p-2 border text-left",children:"Tipo"}),i.jsx("th",{className:"p-2 border text-left",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),i.jsx("tbody",{children:r?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:12,children:"Cargando"})}):ot.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:12,children:"Sin resultados."})}):ot.map(me=>i.jsxs("tr",{className:"align-top",children:[i.jsx("td",{className:"p-2 border",children:me.category}),i.jsx("td",{className:"p-2 border",children:me.name}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Wl(me.providerPrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:me.quantity}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Wl(me.facturado)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Wl(me.totalEsperado||me.salePrice*me.quantity)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Number(me.margin||0).toFixed(2)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Wl(me.salePrice)}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:Wl(me.gain)}),i.jsx("td",{className:"p-2 border",children:me.gender}),i.jsx("td",{className:"p-2 border",children:me.typeProduct}),i.jsx("td",{className:"p-2 border",children:me.code||""}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>Qt(me),children:"Editar"})})]},me.id))})]})}),a&&i.jsx("p",{className:"mt-2 text-sm",children:a}),y&&i.jsxs(cW,{onClose:()=>b(!1),title:w?"Editar producto":"Nuevo producto",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Categora"}),i.jsx("select",{className:"w-full border rounded px-2 py-2",value:B,onChange:me=>k(me.target.value),children:R_.map(me=>i.jsx("option",{value:me,children:me},me))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsx("input",{className:"w-full border rounded px-2 py-2",value:K,onChange:me=>le(me.target.value),placeholder:"Ej: Cuaderno Norma..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio proveedor"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(oe)?"":oe,onChange:me=>ie(Math.max(0,bc(me.target.value,0)))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Cantidad"}),i.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-2 text-right",value:Ae,onChange:me=>te(IE(me.target.value,1))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Facturado (auto)"}),i.jsx("div",{className:"w-full border rounded px-2 py-2 text-right bg-gray-50 tabular-nums",children:Wl(_x({providerPrice:oe,quantity:Ae,margin:Te,salePrice:O}).facturado)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Margen"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(Te)?"":Te,onChange:me=>Ue(Math.max(0,bc(me.target.value,0)))}),i.jsx("div",{className:"text-[11px] text-gray-600 mt-1",children:"Ej: 0.70 / 0.80"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Precio venta (editable)"}),i.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-2 text-right",value:Number.isNaN(_x({providerPrice:oe,quantity:Ae,margin:Te,salePrice:O}).salePrice)?"":_x({providerPrice:oe,quantity:Ae,margin:Te,salePrice:O}).salePrice,onChange:me=>{H(Math.max(0,bc(me.target.value,0)))}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Ganancia (auto)"}),i.jsx("div",{className:"w-full border rounded px-2 py-2 text-right bg-gray-50 tabular-nums",children:Wl(_x({providerPrice:oe,quantity:Ae,margin:Te,salePrice:O}).gain)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Gnero"}),i.jsx("select",{className:"w-full border rounded px-2 py-2",value:G,onChange:me=>L(me.target.value),children:RT.map(me=>i.jsx("option",{value:me,children:me},me))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo producto"}),i.jsxs("select",{className:"w-full border rounded px-2 py-2",value:W,onChange:me=>X(me.target.value),children:[i.jsx("option",{value:"",children:""}),Oit.map(me=>i.jsx("option",{value:me,children:me},me))]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cdigo"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{className:"flex-1 border rounded px-2 py-2",value:D,onChange:me=>Q(me.target.value),placeholder:"Escane o peg el cdigo"}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:De,children:"Escanear"})]})]})]}),i.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[i.jsx("button",{className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",type:"button",onClick:()=>{b(!1),j(null)},children:"Cancelar"}),i.jsx("button",{className:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",type:"button",onClick:Ft,disabled:r,children:"Guardar"})]})]}),I&&i.jsx(cW,{onClose:()=>C(!1),title:"Resultado de escaneo",children:S?i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"text-xs text-gray-600",children:S.category}),i.jsx("div",{className:"text-lg font-bold",children:S.name}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Precio venta"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:Wl(S.salePrice)})]}),i.jsxs("div",{className:"rounded-lg border bg-gray-50 p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Ganancia"}),i.jsx("div",{className:"text-lg font-extrabold tabular-nums",children:Wl(S.gain)})]})]}),i.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"rounded-lg border p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Proveedor"}),i.jsx("div",{className:"font-semibold tabular-nums",children:Wl(S.providerPrice)})]}),i.jsxs("div",{className:"rounded-lg border p-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Cantidad"}),i.jsx("div",{className:"font-semibold tabular-nums",children:S.quantity})]}),i.jsxs("div",{className:"rounded-lg border p-2 col-span-2",children:[i.jsx("div",{className:"text-[11px] text-gray-600",children:"Cdigo"}),i.jsx("div",{className:"font-semibold tabular-nums",children:S.code||""})]})]}),i.jsx("div",{className:"mt-4 flex justify-end",children:i.jsx("button",{className:"px-4 py-2 rounded bg-yellow-400 hover:bg-yellow-500",type:"button",onClick:()=>{C(!1),Qt(S)},children:"Editar"})})]}):i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"font-semibold",children:"No encontrado"}),i.jsxs("div",{className:"text-gray-600 mt-1",children:["Ese cdigo no existe en ",i.jsx("b",{children:"products_stationery"}),"."]})]})}),Z&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-3",children:i.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:"Importar papelera (.xlsx / .csv)"}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>be(!1),children:"Cerrar"})]}),i.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),i.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas: Id (opcional), Categoria, Producto, PrecioProveedor, Cantidad, Margen (o PrecioVenta), Genero, TipoProducto, Codigo."})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:ce,type:"button",children:"Descargar template .xlsx"})]}),i.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[i.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:me=>{var Ee;return ue(((Ee=me.target.files)==null?void 0:Ee[0])||null)}}),U&&i.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",i.jsx("b",{children:U})]}),Be&&i.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),Re.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[i.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),i.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:Re.slice(0,60).map((me,Ee)=>i.jsx("li",{children:me},Ee))})]}),i.jsxs("div",{className:"bg-white border rounded p-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",Ve.total," filas (Crear:"," ",Ve.willCreate," / Actualizar:"," ",Ve.willUpdate,")"]})]}),i.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:it,disabled:Be||re.length===0||Re.length>0,type:"button",children:"Importar a Firestore"})]}),i.jsxs("div",{className:"overflow-x-auto border rounded",children:[i.jsxs("table",{className:"min-w-[1500px] w-full text-xs",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),i.jsx("th",{className:"p-2 border text-left",children:"Categora"}),i.jsx("th",{className:"p-2 border text-left",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Proveedor"}),i.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),i.jsx("th",{className:"p-2 border text-right",children:"Margen"}),i.jsx("th",{className:"p-2 border text-right",children:"PrecioVenta"}),i.jsx("th",{className:"p-2 border text-left",children:"Gnero"}),i.jsx("th",{className:"p-2 border text-left",children:"Tipo"}),i.jsx("th",{className:"p-2 border text-left",children:"Cdigo"}),i.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),i.jsx("tbody",{children:re.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:11,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):re.slice(0,300).map((me,Ee)=>{const ye=me.id?o.some(Ie=>Ie.id===me.id):!1,We=o.some(Ie=>`${No(Ie.category)}::${No(Ie.name)}`==`${No(me.category)}::${No(me.name)}`),ge=ye||We;return i.jsxs("tr",{className:"whitespace-nowrap",children:[i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:me.id||"",onChange:Ie=>ne(Ee,{id:Ie.target.value.trim()||void 0}),placeholder:"docId (update exacto)"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-44 border rounded px-2 py-1",value:me.category,onChange:Ie=>ne(Ee,{category:Ie.target.value})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-72 border rounded px-2 py-1",value:me.name,onChange:Ie=>ne(Ee,{name:Ie.target.value})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-28 border rounded px-2 py-1 text-right",value:me.providerPrice,onChange:Ie=>ne(Ee,{providerPrice:Math.max(0,bc(Ie.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:me.quantity,onChange:Ie=>ne(Ee,{quantity:IE(Ie.target.value,1)})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-24 border rounded px-2 py-1 text-right",value:me.margin,onChange:Ie=>ne(Ee,{margin:Math.max(0,bc(Ie.target.value,0))})})}),i.jsx("td",{className:"p-2 border text-right tabular-nums",children:i.jsx("input",{type:"number",step:"0.01",className:"w-28 border rounded px-2 py-1 text-right",value:me.salePrice??"",onChange:Ie=>ne(Ee,{salePrice:Math.max(0,bc(Ie.target.value,0))||void 0}),placeholder:"Opcional"})}),i.jsx("td",{className:"p-2 border",children:i.jsx("select",{className:"w-28 border rounded px-2 py-1",value:me.gender,onChange:Ie=>ne(Ee,{gender:Ie.target.value}),children:RT.map(Ie=>i.jsx("option",{value:Ie,children:Ie},Ie))})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:me.typeProduct,onChange:Ie=>ne(Ee,{typeProduct:Ie.target.value})})}),i.jsx("td",{className:"p-2 border",children:i.jsx("input",{className:"w-56 border rounded px-2 py-1",value:me.code||"",onChange:Ie=>ne(Ee,{code:Ie.target.value})})}),i.jsx("td",{className:"p-2 border text-center",children:i.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${ge?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:ge?"ACTUALIZA":"CREA"})})]},`${me.id||""}-${Ee}`)})})]}),re.length>300&&i.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",re.length," filas (importa todas)."]})]})]})]})})]})}function M_({label:t,value:e}){return i.jsxs("div",{className:"bg-white border rounded p-3 shadow-sm",children:[i.jsx("div",{className:"text-xs text-gray-500",children:t}),i.jsx("div",{className:"text-lg font-extrabold",children:e})]})}function cW({title:t,children:e,onClose:r}){return i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-3",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-3xl p-4 relative",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-xl font-bold",children:t}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:r,type:"button",children:"Cerrar"})]}),e]})})}const cd=t=>`C$ ${(Number(t)||0).toFixed(2)}`,C0=t=>Number(t||0).toFixed(3),LT=(t,e)=>{var a,s,o,l;const r=t._raw||{},n=t.customerName||r.customerName||((a=r.customer)==null?void 0:a.name)||r.clientName||((s=r.client)==null?void 0:s.name)||"";return t.type==="CONTADO"&&n?n:(t.customerId?e[t.customerId]:"")||t.customerName||r.customerName||((o=r.customer)==null?void 0:o.name)||r.clientName||((l=r.client)==null?void 0:l.name)||"Nombre cliente"},uW=t=>{const e=t._raw||{},r=hde(e)||t.date,n=av(r);return isFinite(n)?n:NaN},UT=t=>String((t==null?void 0:t.status)||"").toUpperCase()==="PROCESADA"||t!=null&&t.closureId||t!=null&&t.closureDate||t!=null&&t.processedDate?"PROCESADA":"FLOTANTE",Mit=t=>String(t??"").toLowerCase().trim(),dW=t=>["lb","lbs","libra","libras"].includes(Mit(t)),fW=t=>Number((t==null?void 0:t.qty)??(t==null?void 0:t.quantity)??0)||0,Lit=t=>t?Array.isArray(t.items)&&t.items.length>0?t.items.reduce((e,r)=>dW((r==null?void 0:r.measurement)??(t==null?void 0:t.measurement))?e+fW(r):e,0):dW(t==null?void 0:t.measurement)?fW(t):0:0;function fde(t){if(!t)return"";if(t!=null&&t.toDate)return Ur(t.toDate(),"yyyy-MM-dd");const e=String(t).trim();if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const r=["dd/MM/yyyy","d/M/yyyy","MM/dd/yyyy","M/d/yyyy","yyyy/MM/dd","yyyy-M-d","yyyy/M/d","yyyy-MM-dd'T'HH:mm:ss","yyyy-MM-dd'T'HH:mm:ss.SSSX"];for(const a of r){const s=wS(e,a,new Date);if(F6(s))return Ur(s,"yyyy-MM-dd")}const n=new Date(e);return isNaN(n.getTime())?"":Ur(n,"yyyy-MM-dd")}function av(t){const e=fde(t);if(!e)return NaN;const r=wS(e,"yyyy-MM-dd",new Date);return F6(r)?r.getTime():NaN}function hde(t){var n,a;const e=fde(t==null?void 0:t.date),r=(n=t==null?void 0:t.createdAt)!=null&&n.toDate?t.createdAt.toDate():null;if(e&&r){const s=av(e),o=r.getTime();if(Math.abs(o-s)/(1e3*60*60*24)>30)return Ur(r,"yyyy-MM-dd")}return e||((a=t==null?void 0:t.timestamp)!=null&&a.toDate?Ur(t.timestamp.toDate(),"yyyy-MM-dd"):r?Ur(r,"yyyy-MM-dd"):"")}function Uit(t,e){var s,o,l,c;const r=hde(t);if(!r)return null;let n=0,a=0;return Array.isArray(t.items)&&t.items.length>0?(n=t.items.reduce((u,d)=>u+(Number(d.qty??d.quantity??d.lbs??0)||0),0),a=Number(t.amount??t.total??0)||0):(n=Number(t.quantity??t.lbs??t.weight??0)||0,a=Number(t.amount??t.total??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:a,quantity:n,customerId:t.customerId||((s=t.customer)==null?void 0:s.id)||((o=t.customer)==null?void 0:o.customerId)||t.clientId||void 0,customerName:t.customerName||((l=t.customer)==null?void 0:l.name)||t.clientName||((c=t.client)==null?void 0:c.name)||void 0,_raw:t}}async function Qit(t){const e=sr(bt(je,"ar_movements"),Ar("ref.saleId","==",t)),r=await Ht(e);await Promise.all(r.docs.map(n=>zn(Xt(je,"ar_movements",n.id))))}function Vit({role:t="",sellerCandyId:e="",roles:r}){const n=r&&r.length?r:t,a=Sn(n,"vendedor_pollo"),s=Sn(n,"admin");if(!(Sn(n,"admin")||Sn(n,"vendedor_pollo")||Sn(n,"supervisor_pollo")||Sn(n,"contador")))return i.jsx("div",{className:"p-6 max-w-4xl mx-auto text-center text-red-600",children:"Acceso restringido  Solo administradores, vendedores y supervisores de pollo."});const o=s?8:7,[l,c]=g.useState(!1),[u,d]=g.useState(!1),[f,A]=g.useState(null),[h,m]=g.useState([]),p=async ce=>{c(!0),d(!0),A(ce),m([]);try{const we=await Cs(Xt(je,"salesV2",ce)),ue=we.exists()?we.data():null;if(!ue){m([]);return}let ne=[];if(Array.isArray(ue.items)&&ue.items.length>0)ne=ue.items;else if(ue.items&&typeof ue.items=="object")try{ne=Object.values(ue.items)}catch{ne=[]}else ue.item?ne=[ue.item]:Array.isArray(ue.products)&&ue.products.length>0?ne=ue.products:Array.isArray(ue.lines)&&ue.lines.length>0?ne=ue.lines:Array.isArray(ue.detalles)&&ue.detalles.length>0?ne=ue.detalles:(ue.productName||ue.product)&&(ne=[{productName:ue.productName||ue.product||"",qty:ue.qty??ue.quantity??ue.lbs??0,unitPrice:ue.unitPrice??ue.price??0,discount:ue.discount??0,total:ue.total??ue.amount??0}]);const Ve=Ee=>{if(Ee==null)return NaN;if(typeof Ee=="number")return Ee;let ye=String(Ee).trim();if(!ye)return NaN;if(ye=ye.replace(/[^0-9.,-]/g,""),!ye)return NaN;ye.indexOf(".")>-1&&ye.indexOf(",")>-1?ye=ye.replace(/,/g,""):ye.indexOf(",")>-1&&ye.indexOf(".")===-1&&(ye=ye.replace(/,/g,"."));const We=Number(ye);return isNaN(We)?NaN:We},it=new Set;for(const Ee of ne)if(Array.isArray(Ee==null?void 0:Ee.allocations))for(const ye of Ee.allocations){const We=String((ye==null?void 0:ye.batchId)||"").trim();We&&it.add(We)}else if(Ee!=null&&Ee.allocations&&typeof Ee.allocations=="object")try{for(const ye of Object.values(Ee.allocations)){const We=String((ye==null?void 0:ye.batchId)||"").trim();We&&it.add(We)}}catch{}if(Array.isArray(ue==null?void 0:ue.allocations))for(const Ee of ue.allocations){const ye=String((Ee==null?void 0:Ee.batchId)||"").trim();ye&&it.add(ye)}const vt={};it.size>0&&await Promise.all(Array.from(it).map(async Ee=>{try{const ye=await Cs(Xt(je,"inventory_batches",Ee));if(ye.exists()){const We=ye.data();vt[Ee]=Number(We.salePrice??We.sale_price??We.price??0)}}catch{}}));const me=ne.map(Ee=>{const ye=String(Ee.productName||Ee.product||Ee.name||"(sin nombre)"),We=Number(Ee.qty??Ee.quantity??Ee.lbs??Ee.weight??0)||0,ge=Ve(Ee.total??Ee.lineFinal??Ee.amount??Ee.monto??Ee.line_total)||0;let Ie=0;const xt=[Ee.unitPrice,Ee.unitPricePackage,Ee.salePrice,Ee.sale_price,Ee.price,Ee.unit_price,Ee.pricePerUnit,Ee.price_per_unit];for(const Ut of xt){const $t=Ve(Ut);if(!isNaN($t)&&$t!==0){Ie=$t;break}}if(!Ie){const Ut=(ue==null?void 0:ue.salePrice)??(ue==null?void 0:ue.sale_price)??(ue==null?void 0:ue.unitPrice)??(ue==null?void 0:ue.unit_price)??(ue==null?void 0:ue.price)??(ue==null?void 0:ue.pricePerUnit),$t=Ve(Ut);!isNaN($t)&&$t!==0&&(Ie=$t)}if(!Ie){const Ut=Array.isArray(Ee.allocations)?Ee.allocations[0]:Ee.allocations&&typeof Ee.allocations=="object"?Object.values(Ee.allocations)[0]:null,$t=Ut?String(Ut.batchId||"").trim():"";$t&&vt[$t]&&(Ie=vt[$t]||0)}!Ie&&Ee.productId&&(Ie=productPriceMap[String(Ee.productId)]||0),(!Ie||Ie===0)&&ge>0&&We>0&&(Ie=ge/We);const Pt=Ve(Ee.discount??Ee.desc??0)||0;let It=ge;return(!It||It===0)&&(It=Number(Ie*We||0)),It=Number(It)||0,{productName:ye,qty:We,unitPrice:Ie,discount:Pt,total:It}});m(me)}catch(we){console.error(we)}finally{d(!1)}},[x,v]=g.useState(Ur(new Date,"yyyy-MM-01")),[y,b]=g.useState(Ur(new Date,"yyyy-MM-dd")),[w,j]=g.useState([]),[I,C]=g.useState([]),[S,E]=g.useState([]),[B,k]=g.useState(!0),[T,P]=g.useState(""),{refreshKey:K,refresh:le}=Mc(),[oe,ie]=g.useState(""),[Ae,te]=g.useState(""),[Te,Ue]=g.useState("ALL"),[O,H]=g.useState(""),[G,L]=g.useState(null),W=15,[X,D]=g.useState(1),Q=g.useMemo(()=>{const ce={};return w.forEach(we=>ce[we.id]=we.name),ce},[w]);g.useEffect(()=>{Te!=="ALL"&&!S.includes(Te)&&Ue("ALL")},[S,Te]),g.useEffect(()=>{(async()=>{k(!0),P("");try{const ce=[];if(a&&e){const ge=sr(bt(je,"customers_pollo"),Ar("vendorId","==",e),In("createdAt","desc"));(await Ht(ge)).forEach(xt=>ce.push({id:xt.id,name:xt.data().name||""}))}else(await Ht(sr(bt(je,"customers_pollo"),In("createdAt","desc")))).forEach(Ie=>ce.push({id:Ie.id,name:Ie.data().name||""}));j(ce);const we={};ce.forEach(ge=>{we[ge.id]=ge.name});const[ue,ne,Ve]=await Promise.all([Ht(sr(bt(je,"salesV2"),In("timestamp","desc"))),Ht(sr(bt(je,"daily_closures"),In("createdAt","desc"))),Ht(sr(bt(je,"ar_movements_pollo"),Ar("date",">=",x),Ar("date","<=",y)))]),it=new Map;Ve.forEach(ge=>{var It;const Ie=ge.data(),xt=String(((It=Ie==null?void 0:Ie.ref)==null?void 0:It.saleId)||"").trim(),Pt=String((Ie==null?void 0:Ie.customerId)||"").trim();xt&&Pt&&it.set(xt,Pt)});const vt=new Map;ne.forEach(ge=>{const Ie=ge.data(),xt=Array.isArray(Ie==null?void 0:Ie.salesV2)?Ie.salesV2:[];for(const Pt of xt){const It=String((Pt==null?void 0:Pt.id)||"").trim();if(!It)continue;const Ut=It.split("#")[0];(String((Pt==null?void 0:Pt.status)||"").toUpperCase()==="PROCESADA"||Pt!=null&&Pt.closureDate||Pt!=null&&Pt.processedDate)&&vt.set(Ut,{closureDate:Pt==null?void 0:Pt.closureDate,processedDate:Pt==null?void 0:Pt.processedDate})}});const me=[];ue.forEach(ge=>{const Ie=ge.data(),xt=vt.get(ge.id),Pt=it.get(ge.id);!Ie.customerId&&Pt&&(Ie.customerId=Pt),!Ie.customerName&&Pt&&(Ie.customerName=we[Pt]||""),xt&&(Ie.status="PROCESADA",!Ie.closureDate&&xt.closureDate&&(Ie.closureDate=xt.closureDate),!Ie.processedDate&&xt.processedDate&&(Ie.processedDate=xt.processedDate));const It=Uit(Ie,ge.id);It&&me.push(It)});const Ee=me.sort((ge,Ie)=>Ie.date.localeCompare(ge.date));C(Ee);const ye=av(x),We=av(y);E(Array.from(new Set(Ee.filter(ge=>{const Ie=uW(ge);return!(!isFinite(Ie)||isFinite(ye)&&Ie<ye||isFinite(We)&&Ie>We)}).map(ge=>{var Ie,xt,Pt,It;return((Ie=ge._raw)==null?void 0:Ie.productName)||((It=(Pt=(xt=ge._raw)==null?void 0:xt.items)==null?void 0:Pt[0])==null?void 0:It.productName)||"(sin producto)"}))).sort()),D(1)}catch(ce){console.error(ce),P(" Error cargando transacciones.")}finally{k(!1)}})()},[x,y,K]);const Z=g.useMemo(()=>{const ce=av(x),we=av(y);return I.filter(ue=>{const ne=uW(ue);return!(!isFinite(ne)||isFinite(ce)&&ne<ce||isFinite(we)&&ne>we)})},[I,x,y]),be=g.useMemo(()=>Z.filter(ce=>{var we,ue,ne,Ve;if(oe&&ce.customerId!==oe||Ae&&ce.type!==Ae)return!1;if(Te&&Te!=="ALL"){const it=((we=ce._raw)==null?void 0:we.productName)||((Ve=(ne=(ue=ce._raw)==null?void 0:ue.items)==null?void 0:ne[0])==null?void 0:Ve.productName)||"";if(!it||it!==Te)return!1}return!(O&&UT(ce._raw)!==O)}),[Z,oe,Ae,Te,O]),U=g.useMemo(()=>{let ce=0,we=0,ue=0,ne=0;for(const vt of be){const me=Lit(vt._raw);vt.type==="CONTADO"?(ce+=me,ue+=vt.total):(we+=me,ne+=vt.total)}const Ve=ce+we,it=ue+ne;return{packsCash:ce,packsCredito:we,packsTotal:Ve,montoCash:ue,montoCredito:ne,montoTotal:it}},[be]),ze=g.useMemo(()=>{let ce=0,we=0;for(const ne of be)ne.type==="CONTADO"?ce+=ne.quantity:we+=ne.quantity;const ue=ce+we;return{unidadesCash:ce,unidadesCredito:we,unidadesTotal:ue}},[be]),re=Math.max(1,Math.ceil(be.length/W)),J=g.useMemo(()=>{const ce=(X-1)*W;return be.slice(ce,ce+W)},[be,X]),[Re,ke]=g.useState(!1),[Be,Ye]=g.useState(!1),[ot,Ct]=g.useState(!1),jt=g.useMemo(()=>{const ce=new Map;return J.forEach(we=>{var Ve,it,vt,me;const ue=((Ve=we._raw)==null?void 0:Ve.productName)||((me=(vt=(it=we._raw)==null?void 0:it.items)==null?void 0:vt[0])==null?void 0:me.productName)||"(sin producto)";ce.has(ue)||ce.set(ue,{cash:[],credit:[]});const ne=ce.get(ue);we.type==="CONTADO"?ne.cash.push(we):ne.credit.push(we)}),Array.from(ce.entries()).sort((we,ue)=>we[0].localeCompare(ue[0]))},[J]);g.useMemo(()=>f&&I.find(ce=>ce.id===f)||null,[f,I]);const Ot=async ce=>{if(s&&(L(null),!!window.confirm("Eliminar esta venta? Se restaurar el inventario asociado.")))try{k(!0),await Gre(ce.id),await Qit(ce.id),C(we=>we.filter(ue=>ue.id!==ce.id)),P(" Venta eliminada")}catch(we){console.error(we),P(" No se pudo eliminar la venta.")}finally{k(!1)}},Tt=()=>{const ce=`Ventas del dia  ${x} a ${y}`,we=it=>(it||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ue=be.map(it=>{var me,Ee,ye,We;const vt=LT(it,Q);return(me=it._raw)!=null&&me.productName||(We=(ye=(Ee=it._raw)==null?void 0:Ee.items)==null?void 0:ye[0])!=null&&We.productName,`<tr>
          <td>${it.date}</td>
          <td>${we(vt)}</td>
          <td>${it.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${it.quantity}</td>
          <td style="text-align:right">${cd(it.total)}</td>
        </tr>`}).join(""),ne=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${we(ce)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${we(ce)}</h1>
      <div class="kpis">

      
        <div><b>Unidades Cash:</b> ${C0(ze.unidadesCash)}</div>
        <div><b>Unidades Crdito:</b> ${C0(ze.unidadesCredito)}</div>
        <div><b>Total Unidades:</b> ${C0(ze.unidadesTotal)}</div>
      </div>

      <div class="kpis">
        <div><b>Libras Cash:</b> ${U.packsCash}</div>
        <div><b>Libras Crdito:</b> ${U.packsCredito}</div>
        <div><b>Ventas Cash:</b> ${cd(U.montoCash)}</div>
        <div><b>Ventas Crdito:</b> ${cd(U.montoCredito)}</div>
      </div>

      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Libras</th><th>Ventas</th>
      </tr></thead><tbody>
      ${ue||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,Ve=window.open("","_blank");Ve&&(Ve.document.open(),Ve.document.write(ne),Ve.document.close())},Qt=()=>D(1),Ft=()=>D(ce=>Math.max(1,ce-1)),Qe=()=>D(ce=>Math.min(re,ce+1)),De=()=>D(re),Je=()=>{const ce=[];if(re<=7)for(let ue=1;ue<=re;ue++)ce.push(ue);else{const ue=Math.max(1,X-2),ne=Math.min(re,X+2);ce.push(1),ue>2&&ce.push(-1);for(let Ve=ue;Ve<=ne;Ve++)Ve!==1&&Ve!==re&&ce.push(Ve);ne<re-1&&ce.push(-2),ce.push(re)}return i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Qt,disabled:X===1,children:" Primero"}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Ft,disabled:X===1,children:" Anterior"}),ce.map((ue,ne)=>typeof ue=="number"?i.jsx("button",{className:`px-3 py-1 border rounded ${ue===X?"bg-blue-600 text-white":""}`,onClick:()=>D(ue),children:ue},ne):i.jsx("span",{className:"px-2",children:""},ne)),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Qe,disabled:X===re,children:"Siguiente "}),i.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:De,disabled:X===re,children:"ltimo "})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",X," de ",re,"  ",be.length," transaccin(es)"]})]})},dt=ce=>{var Ve,it,vt,me;const we=LT(ce,Q),ue=((Ve=ce._raw)==null?void 0:Ve.productName)||((me=(vt=(it=ce._raw)==null?void 0:it.items)==null?void 0:vt[0])==null?void 0:me.productName)||"(sin producto)",ne=UT(ce._raw);return i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsx("div",{className:"font-semibold truncate",children:we}),i.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:ce.date})]}),i.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[i.jsx("span",{className:`px-2 py-1 rounded-full border ${ne==="PROCESADA"?"bg-blue-50 border-blue-200 text-blue-700":"bg-gray-50 border-gray-200 text-gray-700"}`,children:ne}),i.jsx("span",{className:`px-2 py-1 rounded-full border ${ce.type==="CREDITO"?"bg-yellow-50 border-yellow-200 text-yellow-700":"bg-green-50 border-green-200 text-green-700"}`,children:ce.type==="CREDITO"?"Crdito":"Cash"}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Libras:"})," ",i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:Ee=>{Ee.preventDefault(),p(ce.id)},title:"Ver detalle",children:C0(ce.quantity)})]}),i.jsxs("span",{className:"text-gray-700",children:[i.jsx("b",{children:"Monto:"})," ",cd(ce.total)]})]})]}),i.jsx("div",{className:"text-gray-500 mt-1",children:i.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),i.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:i.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Cliente"}),i.jsx("span",{className:"font-medium text-right",children:we})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Producto"}),i.jsx("span",{className:"font-medium text-right",children:ue})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Fecha"}),i.jsx("span",{className:"font-medium",children:ce.date})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Estado"}),i.jsx("span",{className:"font-medium",children:ne})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Tipo"}),i.jsx("span",{className:"font-medium",children:ce.type==="CREDITO"?"Crdito":"Cash"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Libras"}),i.jsx("span",{className:"font-medium",children:i.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>p(ce.id),title:"Ver detalle",children:C0(ce.quantity)})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Monto"}),i.jsx("span",{className:"font-semibold",children:cd(ce.total)})]}),i.jsx("div",{className:"flex items-center justify-between",children:s&&i.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2 w-full",children:[i.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>L(Ee=>Ee===ce.id?null:ce.id),children:" Acciones"}),G===ce.id&&i.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Ot(ce),children:"Eliminar"})]})})]})})]})},ce.id)};return i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>ke(ce=>!ce),"aria-expanded":Re,children:[i.jsx("span",{children:"Filtros de bsqueda"}),i.jsx("span",{className:`transition-transform ${Re?"rotate-180":""}`,children:""})]}),Re&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-7 gap-3 items-end text-sm",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Desde"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:x,onChange:ce=>{v(ce.target.value),D(1)}})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Hasta"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:y,onChange:ce=>{b(ce.target.value),D(1)}})]}),i.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[i.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:oe,onChange:ce=>{ie(ce.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),w.map(ce=>i.jsx("option",{value:ce.id,children:ce.name},ce.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Tipo"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:Ae,onChange:ce=>{te(ce.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"CONTADO",children:"Cash"}),i.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Producto"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:Te,onChange:ce=>{Ue(ce.target.value),D(1)},children:[i.jsx("option",{value:"ALL",children:"Todos"}),S.map(ce=>i.jsx("option",{value:ce,children:ce},ce))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block font-semibold",children:"Estado"}),i.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:O,onChange:ce=>{H(ce.target.value),D(1)},children:[i.jsx("option",{value:"",children:"Todos"}),i.jsx("option",{value:"FLOTANTE",children:"FLOTANTE"}),i.jsx("option",{value:"PROCESADA",children:"PROCESADA"})]})]}),i.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 w-full",onClick:Tt,children:"Exportar PDF"}),i.jsx("div",{className:"sm:col-span-2 lg:col-span-1 flex",children:i.jsx(Rc,{onClick:le,loading:B,className:"w-full justify-center"})})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm mb-4",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ye(ce=>!ce),"aria-expanded":Be,children:[i.jsx("span",{children:"KPIs"}),i.jsx("span",{className:`transition-transform ${Be?"rotate-180":""}`,children:""})]}),Be&&i.jsx("div",{className:"p-4 border-t",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:C0(U.packsCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Libras Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:C0(U.packsCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Cash"}),i.jsx("div",{className:"text-xl font-semibold",children:cd(U.montoCash)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Crdito"}),i.jsx("div",{className:"text-xl font-semibold",children:cd(U.montoCredito)})]}),i.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Total"}),i.jsx("div",{className:"text-xl font-semibold",children:cd(U.montoTotal)})]})]})})]}),i.jsxs("div",{className:"bg-white border rounded shadow-sm",children:[i.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 text-left text-sm font-semibold",onClick:()=>Ct(ce=>!ce),"aria-expanded":ot,children:[i.jsx("span",{children:"Transacciones"}),i.jsx("span",{className:`transition-transform ${ot?"rotate-180":""}`,children:""})]}),ot&&i.jsxs("div",{className:"p-3 border-t space-y-4",children:[i.jsxs("div",{className:"block md:hidden space-y-3",children:[B?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Cargando"}):J.length===0?i.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Sin transacciones en el rango."}):jt.map(([ce,we])=>i.jsx("div",{className:"bg-white border rounded-xl shadow",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"font-semibold",children:["Categora: ",ce]}),i.jsxs("div",{className:"text-xs text-gray-500",children:[we.cash.length+we.credit.length," transaccin(es)"]})]}),i.jsxs("div",{className:"p-3 pt-0 space-y-3",children:[i.jsx("div",{className:"bg-gray-50 border rounded-lg",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:"Cash"}),i.jsxs("div",{className:"text-xs text-gray-500",children:[we.cash.length," item(s)"]})]}),i.jsx("div",{className:"px-3 pb-3 space-y-3",children:we.cash.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones cash."}):we.cash.map(dt)})]})}),i.jsx("div",{className:"bg-gray-50 border rounded-lg",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-center justify-between",children:[i.jsx("div",{className:"font-semibold",children:"Crdito"}),i.jsxs("div",{className:"text-xs text-gray-500",children:[we.credit.length," item(s)"]})]}),i.jsx("div",{className:"px-3 pb-3 space-y-3",children:we.credit.length===0?i.jsx("div",{className:"text-sm text-gray-500",children:"Sin transacciones crdito."}):we.credit.map(dt)})]})})]})]})},ce)),i.jsx("div",{className:"bg-white p-3 rounded shadow border",children:Je()})]}),i.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:[i.jsxs("table",{className:"min-w-full w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Fecha"}),i.jsx("th",{className:"p-2 border",children:"Estado"}),i.jsx("th",{className:"p-2 border",children:"Cliente"}),i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border",children:"Tipo"}),i.jsx("th",{className:"p-2 border",children:"Libras"}),i.jsx("th",{className:"p-2 border",children:"Ventas"}),s&&i.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),i.jsx("tbody",{children:B?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Cargando"})}):J.length===0?i.jsx("tr",{children:i.jsx("td",{className:"p-4 text-center",colSpan:o,children:"Sin transacciones en el rango."})}):J.map(ce=>{var Ve,it,vt,me;const we=LT(ce,Q),ue=((Ve=ce._raw)==null?void 0:Ve.productName)||((me=(vt=(it=ce._raw)==null?void 0:it.items)==null?void 0:vt[0])==null?void 0:me.productName)||"(sin producto)",ne=UT(ce._raw);return i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border",children:ce.date}),i.jsx("td",{className:"p-2 border",children:ne}),i.jsx("td",{className:"p-2 border",children:we}),i.jsx("td",{className:"p-2 border",children:ue}),i.jsx("td",{className:"p-2 border",children:ce.type==="CREDITO"?"Crdito":"Cash"}),i.jsx("td",{className:"p-2 border",children:i.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>p(ce.id),children:C0(ce.quantity)})}),i.jsx("td",{className:"p-2 border",children:cd(ce.total)}),s&&i.jsxs("td",{className:"p-2 border relative",children:[i.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>L(Ee=>Ee===ce.id?null:ce.id),title:"Acciones",children:""}),G===ce.id&&i.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:i.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>Ot(ce),children:"Eliminar"})})]})]},ce.id)})})]}),Je()]})]})]}),T&&i.jsx("p",{className:"mt-2 text-sm",children:T}),l&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{children:i.jsxs("h3",{className:"text-lg font-bold",children:["Productos vendidos"," ",f?` #${f}`:""]})}),i.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>c(!1),children:"Cerrar"})]}),i.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-100",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-2 border",children:"Producto"}),i.jsx("th",{className:"p-2 border text-right",children:"Libras"}),i.jsx("th",{className:"p-2 border text-right",children:"Precio"}),i.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),i.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),i.jsx("tbody",{children:u?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):h.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):h.map((ce,we)=>i.jsxs("tr",{className:"text-center",children:[i.jsx("td",{className:"p-2 border text-left",children:ce.productName}),i.jsx("td",{className:"p-2 border text-right",children:ce.qty}),i.jsx("td",{className:"p-2 border text-right",children:cd(ce.unitPrice)}),i.jsx("td",{className:"p-2 border text-right",children:cd(ce.discount||0)}),i.jsx("td",{className:"p-2 border text-right",children:cd(ce.total)})]},we))})]})})]})})]})}function Hit(){const[t,e]=g.useState(!1);return g.useEffect(()=>{var a;const r=window.matchMedia("(max-width: 900px)"),n=()=>e(r.matches);return n(),(a=r.addEventListener)==null||a.call(r,"change",n),()=>{var s;return(s=r.removeEventListener)==null?void 0:s.call(r,"change",n)}},[]),t}function $it(){const[t,e]=g.useState(null),[r,n]=g.useState(""),[a,s]=g.useState([]),[o,l]=g.useState(""),[c,u]=g.useState(!0),d=Hit(),f=g.useMemo(()=>d?i.jsx(lbe,{role:r,roles:a}):i.jsx(obe,{role:r,roles:a}),[d,r,a]),A=(t==null?void 0:t.email)||"";if(g.useEffect(()=>{const m=yj(Ic,async p=>{if(u(!0),p){e(p);try{const x=Xt(je,"users",p.uid),v=await Cs(x);if(v.exists()){const y=v.data(),b=Array.isArray(y.roles)?y.roles:y.role?[y.role]:[],w=y.sellerCandyId||"";s(b),n(b[0]||""),l(w||"")}else n(""),s([]),l("")}catch{n(""),l("")}}else e(null),n(""),l("");u(!1)});return()=>m()},[]),c)return i.jsx("div",{className:"p-6 text-center",children:"Cargando..."});const h=()=>{const m=a&&a.length?a:r;return Sn(m,"admin")?i.jsx(Rh,{to:"financialDashboard",replace:!0}):Sn(m,"vendedor_pollo")?i.jsx(Rh,{to:"salesV2",replace:!0}):Sn(m,"supervisor_pollo")?i.jsx(Rh,{to:"batches",replace:!0}):Sn(m,"contador")?i.jsx(Rh,{to:"batches",replace:!0}):Sn(m,"vendedor_ropa")?i.jsx(Rh,{to:"salesClothes",replace:!0}):Sn(m,"vendedor_dulces")?i.jsx(Rh,{to:"salesCandies",replace:!0}):i.jsx(Rh,{to:"/",replace:!0})};return i.jsx(U0e,{children:i.jsxs(g0e,{children:[i.jsx(Mn,{path:"/",element:i.jsx(nbe,{})}),i.jsxs(Mn,{path:"/admin",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces","supervisor_pollo","contador"],children:f}),children:[i.jsx(Mn,{index:!0,element:i.jsx(h,{})}),i.jsx(Mn,{path:"bills",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(FPe,{role:r,roles:a})})}),i.jsx(Mn,{path:"salesV2",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(eH,{user:t})})}),i.jsx(Mn,{path:"financialDashboard",element:i.jsx(Kn,{allowedRoles:["admin","contador","supervisor_pollo"],children:i.jsx(B4e,{})})}),i.jsx(Mn,{path:"expenses",element:i.jsx(Kn,{allowedRoles:["admin","contador"],children:i.jsx(F4e,{})})}),i.jsx(Mn,{path:"polloCashAudits",element:i.jsx(Kn,{allowedRoles:["admin","contador"],children:i.jsx(Y8e,{})})}),i.jsx(Mn,{path:"transactionsPollo",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(Vit,{role:r,roles:a})})}),i.jsx(Mn,{path:"batches",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(j4e,{role:r,roles:a})})}),i.jsx(Mn,{path:"paidBatches",element:i.jsx(Kn,{allowedRoles:["admin"],children:i.jsx(V4e,{})})}),i.jsx(Mn,{path:"fix",element:i.jsx(Kn,{allowedRoles:["admin"],children:i.jsx(R4e,{})})}),i.jsx(Mn,{path:"billing",element:i.jsx(Kn,{allowedRoles:["admin","contador"],children:i.jsx(Z8e,{})})}),i.jsx(Mn,{path:"transactionclose",element:i.jsx(Kn,{allowedRoles:["admin"],children:i.jsx(P4e,{})})}),i.jsx(Mn,{path:"billhistoric",element:i.jsx(Kn,{allowedRoles:["admin"],children:i.jsx(OPe,{})})}),i.jsx(Mn,{path:"users",element:i.jsx(Kn,{allowedRoles:["admin"],children:i.jsx(DPe,{})})}),i.jsx(Mn,{path:"products",element:i.jsx(Kn,{allowedRoles:["admin"],children:i.jsx(RPe,{})})}),i.jsx(Mn,{path:"customersPollo",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_pollo","supervisor_pollo","contador"],children:i.jsx(TLe,{role:r,roles:a,currentUserEmail:A,sellerPolloId:o})})}),i.jsx(Mn,{path:"datacenter",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(SVe,{})})}),i.jsx(Mn,{path:"productsCandies",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(SQe,{})})}),i.jsx(Mn,{path:"mainordersCandies",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(uVe,{})})}),i.jsx(Mn,{path:"productsPricesCandies",element:i.jsx(Kn,{roles:a,allowedRoles:["admin","vendedor_dulces"],children:i.jsx(Fit,{})})}),i.jsx(Mn,{path:"inventoryMainOrderCandies",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(dVe,{})})}),i.jsx(Mn,{path:"inventoryCandies",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(FQe,{})})}),i.jsx(Mn,{path:"billingsCandies",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(bVe,{})})}),i.jsx(Mn,{path:"cashDeliveries",element:i.jsx(Kn,{allowedRoles:["admin"],children:i.jsx(Pit,{})})}),i.jsx(Mn,{path:"customersCandies",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(OQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Mn,{path:"salesCandies",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(QQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Mn,{path:"expensesCandies",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(VQe,{})})}),i.jsx(Mn,{path:"dashboardCandies",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(YQe,{})})}),i.jsx(Mn,{path:"transactionCandies",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(KQe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Mn,{path:"vendorsCandies",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(JQe,{})})}),i.jsx(Mn,{path:"productsVendorsCandies",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(sVe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Mn,{path:"cierreVentasCandies",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(AVe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Mn,{path:"reporteCierresCandies",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(NVe,{role:r,roles:a,currentUserEmail:A,sellerCandyId:o})})}),i.jsx(Mn,{path:"consolidatedVendors",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_dulces"],children:i.jsx(vVe,{})})}),i.jsx(Mn,{path:"salesClothes",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(vLe,{})})}),i.jsx(Mn,{path:"notebooksInventory",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(Rit,{})})}),i.jsx(Mn,{path:"TransactionsReportClothes",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(jLe,{})})}),i.jsx(Mn,{path:"financialDashboardClothes",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(wLe,{})})}),i.jsx(Mn,{path:"ExpensesClothes",element:i.jsx(Kn,{allowedRoles:["admin"],children:i.jsx(NLe,{})})}),i.jsx(Mn,{path:"inventoryClothesBatches",element:i.jsx(Kn,{allowedRoles:["admin"],children:i.jsx(nLe,{})})}),i.jsx(Mn,{path:"productsClothes",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(ALe,{})})}),i.jsx(Mn,{path:"CustomersClothes",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_ropa"],children:i.jsx(pLe,{})})})]}),i.jsx(Mn,{path:"/salesV2",element:i.jsx(Kn,{allowedRoles:["admin","vendedor_pollo","contador"],children:i.jsx(eH,{user:t})})}),i.jsx(Mn,{path:"*",element:i.jsx(Rh,{to:"/"})})]})})}rbe.then(t=>{console.info("Auth persistence mode:",t)}).catch(()=>{}).finally(()=>{QT.createRoot(document.getElementById("root")).render(i.jsx(oi.StrictMode,{children:i.jsx($it,{})}))});export{es as _,Kit as c,PA as g};
