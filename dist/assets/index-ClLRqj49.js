var Z7=Object.defineProperty;var eV=(t,e,r)=>e in t?Z7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Nn=(t,e,r)=>eV(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var G1e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tV(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var k3={exports:{}},Mb={},F3={exports:{}},Xr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mx=Symbol.for("react.element"),rV=Symbol.for("react.portal"),nV=Symbol.for("react.fragment"),sV=Symbol.for("react.strict_mode"),aV=Symbol.for("react.profiler"),iV=Symbol.for("react.provider"),oV=Symbol.for("react.context"),lV=Symbol.for("react.forward_ref"),cV=Symbol.for("react.suspense"),dV=Symbol.for("react.memo"),AV=Symbol.for("react.lazy"),j5=Symbol.iterator;function uV(t){return t===null||typeof t!="object"?null:(t=j5&&t[j5]||t["@@iterator"],typeof t=="function"?t:null)}var T3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},P3=Object.assign,R3={};function z0(t,e,r){this.props=t,this.context=e,this.refs=R3,this.updater=r||T3}z0.prototype.isReactComponent={};z0.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};z0.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function D3(){}D3.prototype=z0.prototype;function VE(t,e,r){this.props=t,this.context=e,this.refs=R3,this.updater=r||T3}var HE=VE.prototype=new D3;HE.constructor=VE;P3(HE,z0.prototype);HE.isPureReactComponent=!0;var k5=Array.isArray,L3=Object.prototype.hasOwnProperty,KE={current:null},U3={key:!0,ref:!0,__self:!0,__source:!0};function O3(t,e,r){var n,s={},i=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)L3.call(e,n)&&!U3.hasOwnProperty(n)&&(s[n]=e[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:mx,type:t,key:i,ref:o,props:s,_owner:KE.current}}function hV(t,e){return{$$typeof:mx,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function qE(t){return typeof t=="object"&&t!==null&&t.$$typeof===mx}function fV(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var F5=/\/+/g;function xw(t,e){return typeof t=="object"&&t!==null&&t.key!=null?fV(""+t.key):e.toString(36)}function Q1(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case mx:case rV:o=!0}}if(o)return o=t,s=s(o),t=n===""?"."+xw(o,0):n,k5(s)?(r="",t!=null&&(r=t.replace(F5,"$&/")+"/"),Q1(s,e,r,"",function(d){return d})):s!=null&&(qE(s)&&(s=hV(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(F5,"$&/")+"/")+t)),e.push(s)),1;if(o=0,n=n===""?".":n+":",k5(t))for(var l=0;l<t.length;l++){i=t[l];var c=n+xw(i,l);o+=Q1(i,e,r,c,s)}else if(c=uV(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=n+xw(i,l++),o+=Q1(i,e,r,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function mv(t,e,r){if(t==null)return t;var n=[],s=0;return Q1(t,n,"","",function(i){return e.call(r,i,s++)}),n}function mV(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ui={current:null},V1={transition:null},pV={ReactCurrentDispatcher:Ui,ReactCurrentBatchConfig:V1,ReactCurrentOwner:KE};function M3(){throw Error("act(...) is not supported in production builds of React.")}Xr.Children={map:mv,forEach:function(t,e,r){mv(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return mv(t,function(){e++}),e},toArray:function(t){return mv(t,function(e){return e})||[]},only:function(t){if(!qE(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Xr.Component=z0;Xr.Fragment=nV;Xr.Profiler=aV;Xr.PureComponent=VE;Xr.StrictMode=sV;Xr.Suspense=cV;Xr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pV;Xr.act=M3;Xr.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=P3({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=KE.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)L3.call(e,c)&&!U3.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:mx,type:t.type,key:s,ref:i,props:n,_owner:o}};Xr.createContext=function(t){return t={$$typeof:oV,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:iV,_context:t},t.Consumer=t};Xr.createElement=O3;Xr.createFactory=function(t){var e=O3.bind(null,t);return e.type=t,e};Xr.createRef=function(){return{current:null}};Xr.forwardRef=function(t){return{$$typeof:lV,render:t}};Xr.isValidElement=qE;Xr.lazy=function(t){return{$$typeof:AV,_payload:{_status:-1,_result:t},_init:mV}};Xr.memo=function(t,e){return{$$typeof:dV,type:t,compare:e===void 0?null:e}};Xr.startTransition=function(t){var e=V1.transition;V1.transition={};try{t()}finally{V1.transition=e}};Xr.unstable_act=M3;Xr.useCallback=function(t,e){return Ui.current.useCallback(t,e)};Xr.useContext=function(t){return Ui.current.useContext(t)};Xr.useDebugValue=function(){};Xr.useDeferredValue=function(t){return Ui.current.useDeferredValue(t)};Xr.useEffect=function(t,e){return Ui.current.useEffect(t,e)};Xr.useId=function(){return Ui.current.useId()};Xr.useImperativeHandle=function(t,e,r){return Ui.current.useImperativeHandle(t,e,r)};Xr.useInsertionEffect=function(t,e){return Ui.current.useInsertionEffect(t,e)};Xr.useLayoutEffect=function(t,e){return Ui.current.useLayoutEffect(t,e)};Xr.useMemo=function(t,e){return Ui.current.useMemo(t,e)};Xr.useReducer=function(t,e,r){return Ui.current.useReducer(t,e,r)};Xr.useRef=function(t){return Ui.current.useRef(t)};Xr.useState=function(t){return Ui.current.useState(t)};Xr.useSyncExternalStore=function(t,e,r){return Ui.current.useSyncExternalStore(t,e,r)};Xr.useTransition=function(){return Ui.current.useTransition()};Xr.version="18.3.1";F3.exports=Xr;var N=F3.exports;const ui=tV(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gV=N,xV=Symbol.for("react.element"),vV=Symbol.for("react.fragment"),yV=Object.prototype.hasOwnProperty,bV=gV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wV={key:!0,ref:!0,__self:!0,__source:!0};function Q3(t,e,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)yV.call(e,n)&&!wV.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:xV,type:t,key:i,ref:o,props:s,_owner:bV.current}}Mb.Fragment=vV;Mb.jsx=Q3;Mb.jsxs=Q3;k3.exports=Mb;var a=k3.exports,NC={},V3={exports:{}},Ro={},H3={exports:{}},K3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(me,Z){var ye=me.length;me.push(Z);e:for(;0<ye;){var Ie=ye-1>>>1,I=me[Ie];if(0<s(I,Z))me[Ie]=Z,me[ye]=I,ye=Ie;else break e}}function r(me){return me.length===0?null:me[0]}function n(me){if(me.length===0)return null;var Z=me[0],ye=me.pop();if(ye!==Z){me[0]=ye;e:for(var Ie=0,I=me.length,j=I>>>1;Ie<j;){var Q=2*(Ie+1)-1,T=me[Q],R=Q+1,K=me[R];if(0>s(T,ye))R<I&&0>s(K,T)?(me[Ie]=K,me[R]=ye,Ie=R):(me[Ie]=T,me[Q]=ye,Ie=Q);else if(R<I&&0>s(K,ye))me[Ie]=K,me[R]=ye,Ie=R;else break e}}return Z}function s(me,Z){var ye=me.sortIndex-Z.sortIndex;return ye!==0?ye:me.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],A=1,u=null,f=3,h=!1,m=!1,p=!1,g=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(me){for(var Z=r(d);Z!==null;){if(Z.callback===null)n(d);else if(Z.startTime<=me)n(d),Z.sortIndex=Z.expirationTime,e(c,Z);else break;Z=r(d)}}function k(me){if(p=!1,w(me),!m)if(r(c)!==null)m=!0,ae(O);else{var Z=r(d);Z!==null&&fe(k,Z.startTime-me)}}function O(me,Z){m=!1,p&&(p=!1,x(B),B=-1),h=!0;var ye=f;try{for(w(Z),u=r(c);u!==null&&(!(u.expirationTime>Z)||me&&!_());){var Ie=u.callback;if(typeof Ie=="function"){u.callback=null,f=u.priorityLevel;var I=Ie(u.expirationTime<=Z);Z=t.unstable_now(),typeof I=="function"?u.callback=I:u===r(c)&&n(c),w(Z)}else n(c);u=r(c)}if(u!==null)var j=!0;else{var Q=r(d);Q!==null&&fe(k,Q.startTime-Z),j=!1}return j}finally{u=null,f=ye,h=!1}}var L=!1,E=null,B=-1,S=5,U=-1;function _(){return!(t.unstable_now()-U<S)}function F(){if(E!==null){var me=t.unstable_now();U=me;var Z=!0;try{Z=E(!0,me)}finally{Z?D():(L=!1,E=null)}}else L=!1}var D;if(typeof b=="function")D=function(){b(F)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,ge=X.port2;X.port1.onmessage=F,D=function(){ge.postMessage(null)}}else D=function(){g(F,0)};function ae(me){E=me,L||(L=!0,D())}function fe(me,Z){B=g(function(){me(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(me){me.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,ae(O))},t.unstable_forceFrameRate=function(me){0>me||125<me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<me?Math.floor(1e3/me):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(me){switch(f){case 1:case 2:case 3:var Z=3;break;default:Z=f}var ye=f;f=Z;try{return me()}finally{f=ye}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(me,Z){switch(me){case 1:case 2:case 3:case 4:case 5:break;default:me=3}var ye=f;f=me;try{return Z()}finally{f=ye}},t.unstable_scheduleCallback=function(me,Z,ye){var Ie=t.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?Ie+ye:Ie):ye=Ie,me){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=ye+I,me={id:A++,callback:Z,priorityLevel:me,startTime:ye,expirationTime:I,sortIndex:-1},ye>Ie?(me.sortIndex=ye,e(d,me),r(c)===null&&me===r(d)&&(p?(x(B),B=-1):p=!0,fe(k,ye-Ie))):(me.sortIndex=I,e(c,me),m||h||(m=!0,ae(O))),me},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(me){var Z=f;return function(){var ye=f;f=Z;try{return me.apply(this,arguments)}finally{f=ye}}}})(K3);H3.exports=K3;var NV=H3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CV=N,ko=NV;function qt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var q3=new Set,hg={};function Hh(t,e){E0(t,e),E0(t+"Capture",e)}function E0(t,e){for(hg[t]=e,t=0;t<e.length;t++)q3.add(e[t])}var wd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),CC=Object.prototype.hasOwnProperty,_V=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,T5={},P5={};function EV(t){return CC.call(P5,t)?!0:CC.call(T5,t)?!1:_V.test(t)?P5[t]=!0:(T5[t]=!0,!1)}function BV(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function SV(t,e,r,n){if(e===null||typeof e>"u"||BV(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Oi(t,e,r,n,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Xa={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Xa[t]=new Oi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Xa[e]=new Oi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Xa[t]=new Oi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Xa[t]=new Oi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Xa[t]=new Oi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Xa[t]=new Oi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Xa[t]=new Oi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Xa[t]=new Oi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Xa[t]=new Oi(t,5,!1,t.toLowerCase(),null,!1,!1)});var GE=/[\-:]([a-z])/g;function $E(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(GE,$E);Xa[e]=new Oi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(GE,$E);Xa[e]=new Oi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(GE,$E);Xa[e]=new Oi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Xa[t]=new Oi(t,1,!1,t.toLowerCase(),null,!1,!1)});Xa.xlinkHref=new Oi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Xa[t]=new Oi(t,1,!1,t.toLowerCase(),null,!0,!0)});function zE(t,e,r,n){var s=Xa.hasOwnProperty(e)?Xa[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(SV(e,r,s,n)&&(r=null),n||s===null?EV(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Fd=CV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,pv=Symbol.for("react.element"),Jf=Symbol.for("react.portal"),Xf=Symbol.for("react.fragment"),WE=Symbol.for("react.strict_mode"),_C=Symbol.for("react.profiler"),G3=Symbol.for("react.provider"),$3=Symbol.for("react.context"),JE=Symbol.for("react.forward_ref"),EC=Symbol.for("react.suspense"),BC=Symbol.for("react.suspense_list"),XE=Symbol.for("react.memo"),xA=Symbol.for("react.lazy"),z3=Symbol.for("react.offscreen"),R5=Symbol.iterator;function Rm(t){return t===null||typeof t!="object"?null:(t=R5&&t[R5]||t["@@iterator"],typeof t=="function"?t:null)}var _s=Object.assign,vw;function dp(t){if(vw===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);vw=e&&e[1]||""}return`
`+vw+t}var yw=!1;function bw(t,e){if(!t||yw)return"";yw=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var n=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){n=d}t.call(e.prototype)}else{try{throw Error()}catch(d){n=d}t()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{yw=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?dp(t):""}function IV(t){switch(t.tag){case 5:return dp(t.type);case 16:return dp("Lazy");case 13:return dp("Suspense");case 19:return dp("SuspenseList");case 0:case 2:case 15:return t=bw(t.type,!1),t;case 11:return t=bw(t.type.render,!1),t;case 1:return t=bw(t.type,!0),t;default:return""}}function SC(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Xf:return"Fragment";case Jf:return"Portal";case _C:return"Profiler";case WE:return"StrictMode";case EC:return"Suspense";case BC:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case $3:return(t.displayName||"Context")+".Consumer";case G3:return(t._context.displayName||"Context")+".Provider";case JE:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case XE:return e=t.displayName||null,e!==null?e:SC(t.type)||"Memo";case xA:e=t._payload,t=t._init;try{return SC(t(e))}catch{}}return null}function jV(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return SC(e);case 8:return e===WE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function tu(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function W3(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function kV(t){var e=W3(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function gv(t){t._valueTracker||(t._valueTracker=kV(t))}function J3(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=W3(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function yy(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function IC(t,e){var r=e.checked;return _s({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function D5(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=tu(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function X3(t,e){e=e.checked,e!=null&&zE(t,"checked",e,!1)}function jC(t,e){X3(t,e);var r=tu(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?kC(t,e.type,r):e.hasOwnProperty("defaultValue")&&kC(t,e.type,tu(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function L5(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function kC(t,e,r){(e!=="number"||yy(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ap=Array.isArray;function A0(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+tu(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function FC(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(qt(91));return _s({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function U5(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(qt(92));if(Ap(r)){if(1<r.length)throw Error(qt(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:tu(r)}}function Y3(t,e){var r=tu(e.value),n=tu(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function O5(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Z3(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function TC(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Z3(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var xv,eR=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(xv=xv||document.createElement("div"),xv.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=xv.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function fg(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var kp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FV=["Webkit","ms","Moz","O"];Object.keys(kp).forEach(function(t){FV.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),kp[e]=kp[t]})});function tR(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||kp.hasOwnProperty(t)&&kp[t]?(""+e).trim():e+"px"}function rR(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=tR(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var TV=_s({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function PC(t,e){if(e){if(TV[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(qt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(qt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(qt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(qt(62))}}function RC(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var DC=null;function YE(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var LC=null,u0=null,h0=null;function M5(t){if(t=xx(t)){if(typeof LC!="function")throw Error(qt(280));var e=t.stateNode;e&&(e=qb(e),LC(t.stateNode,t.type,e))}}function nR(t){u0?h0?h0.push(t):h0=[t]:u0=t}function sR(){if(u0){var t=u0,e=h0;if(h0=u0=null,M5(t),e)for(t=0;t<e.length;t++)M5(e[t])}}function aR(t,e){return t(e)}function iR(){}var ww=!1;function oR(t,e,r){if(ww)return t(e,r);ww=!0;try{return aR(t,e,r)}finally{ww=!1,(u0!==null||h0!==null)&&(iR(),sR())}}function mg(t,e){var r=t.stateNode;if(r===null)return null;var n=qb(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(qt(231,e,typeof r));return r}var UC=!1;if(wd)try{var Dm={};Object.defineProperty(Dm,"passive",{get:function(){UC=!0}}),window.addEventListener("test",Dm,Dm),window.removeEventListener("test",Dm,Dm)}catch{UC=!1}function PV(t,e,r,n,s,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(A){this.onError(A)}}var Fp=!1,by=null,wy=!1,OC=null,RV={onError:function(t){Fp=!0,by=t}};function DV(t,e,r,n,s,i,o,l,c){Fp=!1,by=null,PV.apply(RV,arguments)}function LV(t,e,r,n,s,i,o,l,c){if(DV.apply(this,arguments),Fp){if(Fp){var d=by;Fp=!1,by=null}else throw Error(qt(198));wy||(wy=!0,OC=d)}}function Kh(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function lR(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Q5(t){if(Kh(t)!==t)throw Error(qt(188))}function UV(t){var e=t.alternate;if(!e){if(e=Kh(t),e===null)throw Error(qt(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Q5(s),t;if(i===n)return Q5(s),e;i=i.sibling}throw Error(qt(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o)throw Error(qt(189))}}if(r.alternate!==n)throw Error(qt(190))}if(r.tag!==3)throw Error(qt(188));return r.stateNode.current===r?t:e}function cR(t){return t=UV(t),t!==null?dR(t):null}function dR(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=dR(t);if(e!==null)return e;t=t.sibling}return null}var AR=ko.unstable_scheduleCallback,V5=ko.unstable_cancelCallback,OV=ko.unstable_shouldYield,MV=ko.unstable_requestPaint,Ks=ko.unstable_now,QV=ko.unstable_getCurrentPriorityLevel,ZE=ko.unstable_ImmediatePriority,uR=ko.unstable_UserBlockingPriority,Ny=ko.unstable_NormalPriority,VV=ko.unstable_LowPriority,hR=ko.unstable_IdlePriority,Qb=null,Nc=null;function HV(t){if(Nc&&typeof Nc.onCommitFiberRoot=="function")try{Nc.onCommitFiberRoot(Qb,t,void 0,(t.current.flags&128)===128)}catch{}}var Ul=Math.clz32?Math.clz32:GV,KV=Math.log,qV=Math.LN2;function GV(t){return t>>>=0,t===0?32:31-(KV(t)/qV|0)|0}var vv=64,yv=4194304;function up(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Cy(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=up(l):(i&=o,i!==0&&(n=up(i)))}else o=r&~s,o!==0?n=up(o):i!==0&&(n=up(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Ul(e),s=1<<r,n|=t[r],e&=~s;return n}function $V(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zV(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Ul(i),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=$V(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function MC(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function fR(){var t=vv;return vv<<=1,!(vv&4194240)&&(vv=64),t}function Nw(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function px(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ul(e),t[e]=r}function WV(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Ul(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function eB(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Ul(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var kn=0;function mR(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var pR,tB,gR,xR,vR,QC=!1,bv=[],OA=null,MA=null,QA=null,pg=new Map,gg=new Map,bA=[],JV="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function H5(t,e){switch(t){case"focusin":case"focusout":OA=null;break;case"dragenter":case"dragleave":MA=null;break;case"mouseover":case"mouseout":QA=null;break;case"pointerover":case"pointerout":pg.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":gg.delete(e.pointerId)}}function Lm(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=xx(e),e!==null&&tB(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function XV(t,e,r,n,s){switch(e){case"focusin":return OA=Lm(OA,t,e,r,n,s),!0;case"dragenter":return MA=Lm(MA,t,e,r,n,s),!0;case"mouseover":return QA=Lm(QA,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return pg.set(i,Lm(pg.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,gg.set(i,Lm(gg.get(i)||null,t,e,r,n,s)),!0}return!1}function yR(t){var e=th(t.target);if(e!==null){var r=Kh(e);if(r!==null){if(e=r.tag,e===13){if(e=lR(r),e!==null){t.blockedOn=e,vR(t.priority,function(){gR(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function H1(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=VC(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);DC=n,r.target.dispatchEvent(n),DC=null}else return e=xx(r),e!==null&&tB(e),t.blockedOn=r,!1;e.shift()}return!0}function K5(t,e,r){H1(t)&&r.delete(e)}function YV(){QC=!1,OA!==null&&H1(OA)&&(OA=null),MA!==null&&H1(MA)&&(MA=null),QA!==null&&H1(QA)&&(QA=null),pg.forEach(K5),gg.forEach(K5)}function Um(t,e){t.blockedOn===e&&(t.blockedOn=null,QC||(QC=!0,ko.unstable_scheduleCallback(ko.unstable_NormalPriority,YV)))}function xg(t){function e(s){return Um(s,t)}if(0<bv.length){Um(bv[0],t);for(var r=1;r<bv.length;r++){var n=bv[r];n.blockedOn===t&&(n.blockedOn=null)}}for(OA!==null&&Um(OA,t),MA!==null&&Um(MA,t),QA!==null&&Um(QA,t),pg.forEach(e),gg.forEach(e),r=0;r<bA.length;r++)n=bA[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<bA.length&&(r=bA[0],r.blockedOn===null);)yR(r),r.blockedOn===null&&bA.shift()}var f0=Fd.ReactCurrentBatchConfig,_y=!0;function ZV(t,e,r,n){var s=kn,i=f0.transition;f0.transition=null;try{kn=1,rB(t,e,r,n)}finally{kn=s,f0.transition=i}}function e9(t,e,r,n){var s=kn,i=f0.transition;f0.transition=null;try{kn=4,rB(t,e,r,n)}finally{kn=s,f0.transition=i}}function rB(t,e,r,n){if(_y){var s=VC(t,e,r,n);if(s===null)Tw(t,e,n,Ey,r),H5(t,n);else if(XV(s,t,e,r,n))n.stopPropagation();else if(H5(t,n),e&4&&-1<JV.indexOf(t)){for(;s!==null;){var i=xx(s);if(i!==null&&pR(i),i=VC(t,e,r,n),i===null&&Tw(t,e,n,Ey,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Tw(t,e,n,null,r)}}var Ey=null;function VC(t,e,r,n){if(Ey=null,t=YE(n),t=th(t),t!==null)if(e=Kh(t),e===null)t=null;else if(r=e.tag,r===13){if(t=lR(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ey=t,null}function bR(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(QV()){case ZE:return 1;case uR:return 4;case Ny:case VV:return 16;case hR:return 536870912;default:return 16}default:return 16}}var jA=null,nB=null,K1=null;function wR(){if(K1)return K1;var t,e=nB,r=e.length,n,s="value"in jA?jA.value:jA.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===s[i-n];n++);return K1=s.slice(t,1<n?1-n:void 0)}function q1(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function wv(){return!0}function q5(){return!1}function Do(t){function e(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?wv:q5,this.isPropagationStopped=q5,this}return _s(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=wv)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=wv)},persist:function(){},isPersistent:wv}),e}var W0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sB=Do(W0),gx=_s({},W0,{view:0,detail:0}),t9=Do(gx),Cw,_w,Om,Vb=_s({},gx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:aB,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Om&&(Om&&t.type==="mousemove"?(Cw=t.screenX-Om.screenX,_w=t.screenY-Om.screenY):_w=Cw=0,Om=t),Cw)},movementY:function(t){return"movementY"in t?t.movementY:_w}}),G5=Do(Vb),r9=_s({},Vb,{dataTransfer:0}),n9=Do(r9),s9=_s({},gx,{relatedTarget:0}),Ew=Do(s9),a9=_s({},W0,{animationName:0,elapsedTime:0,pseudoElement:0}),i9=Do(a9),o9=_s({},W0,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),l9=Do(o9),c9=_s({},W0,{data:0}),$5=Do(c9),d9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},A9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},u9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function h9(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=u9[t])?!!e[t]:!1}function aB(){return h9}var f9=_s({},gx,{key:function(t){if(t.key){var e=d9[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=q1(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?A9[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:aB,charCode:function(t){return t.type==="keypress"?q1(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?q1(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),m9=Do(f9),p9=_s({},Vb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),z5=Do(p9),g9=_s({},gx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:aB}),x9=Do(g9),v9=_s({},W0,{propertyName:0,elapsedTime:0,pseudoElement:0}),y9=Do(v9),b9=_s({},Vb,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),w9=Do(b9),N9=[9,13,27,32],iB=wd&&"CompositionEvent"in window,Tp=null;wd&&"documentMode"in document&&(Tp=document.documentMode);var C9=wd&&"TextEvent"in window&&!Tp,NR=wd&&(!iB||Tp&&8<Tp&&11>=Tp),W5=" ",J5=!1;function CR(t,e){switch(t){case"keyup":return N9.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _R(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Yf=!1;function _9(t,e){switch(t){case"compositionend":return _R(e);case"keypress":return e.which!==32?null:(J5=!0,W5);case"textInput":return t=e.data,t===W5&&J5?null:t;default:return null}}function E9(t,e){if(Yf)return t==="compositionend"||!iB&&CR(t,e)?(t=wR(),K1=nB=jA=null,Yf=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return NR&&e.locale!=="ko"?null:e.data;default:return null}}var B9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function X5(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!B9[t.type]:e==="textarea"}function ER(t,e,r,n){nR(n),e=By(e,"onChange"),0<e.length&&(r=new sB("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Pp=null,vg=null;function S9(t){LR(t,0)}function Hb(t){var e=t0(t);if(J3(e))return t}function I9(t,e){if(t==="change")return e}var BR=!1;if(wd){var Bw;if(wd){var Sw="oninput"in document;if(!Sw){var Y5=document.createElement("div");Y5.setAttribute("oninput","return;"),Sw=typeof Y5.oninput=="function"}Bw=Sw}else Bw=!1;BR=Bw&&(!document.documentMode||9<document.documentMode)}function Z5(){Pp&&(Pp.detachEvent("onpropertychange",SR),vg=Pp=null)}function SR(t){if(t.propertyName==="value"&&Hb(vg)){var e=[];ER(e,vg,t,YE(t)),oR(S9,e)}}function j9(t,e,r){t==="focusin"?(Z5(),Pp=e,vg=r,Pp.attachEvent("onpropertychange",SR)):t==="focusout"&&Z5()}function k9(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Hb(vg)}function F9(t,e){if(t==="click")return Hb(e)}function T9(t,e){if(t==="input"||t==="change")return Hb(e)}function P9(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Hl=typeof Object.is=="function"?Object.is:P9;function yg(t,e){if(Hl(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!CC.call(e,s)||!Hl(t[s],e[s]))return!1}return!0}function e4(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function t4(t,e){var r=e4(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=e4(r)}}function IR(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?IR(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function jR(){for(var t=window,e=yy();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=yy(t.document)}return e}function oB(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function R9(t){var e=jR(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&IR(r.ownerDocument.documentElement,r)){if(n!==null&&oB(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=t4(r,i);var o=t4(r,n);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var D9=wd&&"documentMode"in document&&11>=document.documentMode,Zf=null,HC=null,Rp=null,KC=!1;function r4(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;KC||Zf==null||Zf!==yy(n)||(n=Zf,"selectionStart"in n&&oB(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Rp&&yg(Rp,n)||(Rp=n,n=By(HC,"onSelect"),0<n.length&&(e=new sB("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Zf)))}function Nv(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var e0={animationend:Nv("Animation","AnimationEnd"),animationiteration:Nv("Animation","AnimationIteration"),animationstart:Nv("Animation","AnimationStart"),transitionend:Nv("Transition","TransitionEnd")},Iw={},kR={};wd&&(kR=document.createElement("div").style,"AnimationEvent"in window||(delete e0.animationend.animation,delete e0.animationiteration.animation,delete e0.animationstart.animation),"TransitionEvent"in window||delete e0.transitionend.transition);function Kb(t){if(Iw[t])return Iw[t];if(!e0[t])return t;var e=e0[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in kR)return Iw[t]=e[r];return t}var FR=Kb("animationend"),TR=Kb("animationiteration"),PR=Kb("animationstart"),RR=Kb("transitionend"),DR=new Map,n4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mu(t,e){DR.set(t,e),Hh(e,[t])}for(var jw=0;jw<n4.length;jw++){var kw=n4[jw],L9=kw.toLowerCase(),U9=kw[0].toUpperCase()+kw.slice(1);mu(L9,"on"+U9)}mu(FR,"onAnimationEnd");mu(TR,"onAnimationIteration");mu(PR,"onAnimationStart");mu("dblclick","onDoubleClick");mu("focusin","onFocus");mu("focusout","onBlur");mu(RR,"onTransitionEnd");E0("onMouseEnter",["mouseout","mouseover"]);E0("onMouseLeave",["mouseout","mouseover"]);E0("onPointerEnter",["pointerout","pointerover"]);E0("onPointerLeave",["pointerout","pointerover"]);Hh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Hh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Hh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Hh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Hh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Hh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),O9=new Set("cancel close invalid load scroll toggle".split(" ").concat(hp));function s4(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,LV(n,e,void 0,t),t.currentTarget=null}function LR(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;s4(s,l,d),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;s4(s,l,d),i=c}}}if(wy)throw t=OC,wy=!1,OC=null,t}function Zn(t,e){var r=e[WC];r===void 0&&(r=e[WC]=new Set);var n=t+"__bubble";r.has(n)||(UR(e,t,2,!1),r.add(n))}function Fw(t,e,r){var n=0;e&&(n|=4),UR(r,t,n,e)}var Cv="_reactListening"+Math.random().toString(36).slice(2);function bg(t){if(!t[Cv]){t[Cv]=!0,q3.forEach(function(r){r!=="selectionchange"&&(O9.has(r)||Fw(r,!1,t),Fw(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Cv]||(e[Cv]=!0,Fw("selectionchange",!1,e))}}function UR(t,e,r,n){switch(bR(e)){case 1:var s=ZV;break;case 4:s=e9;break;default:s=rB}r=s.bind(null,e,r,t),s=void 0,!UC||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function Tw(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=th(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}oR(function(){var d=i,A=YE(r),u=[];e:{var f=DR.get(t);if(f!==void 0){var h=sB,m=t;switch(t){case"keypress":if(q1(r)===0)break e;case"keydown":case"keyup":h=m9;break;case"focusin":m="focus",h=Ew;break;case"focusout":m="blur",h=Ew;break;case"beforeblur":case"afterblur":h=Ew;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=G5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=n9;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=x9;break;case FR:case TR:case PR:h=i9;break;case RR:h=y9;break;case"scroll":h=t9;break;case"wheel":h=w9;break;case"copy":case"cut":case"paste":h=l9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=z5}var p=(e&4)!==0,g=!p&&t==="scroll",x=p?f!==null?f+"Capture":null:f;p=[];for(var b=d,w;b!==null;){w=b;var k=w.stateNode;if(w.tag===5&&k!==null&&(w=k,x!==null&&(k=mg(b,x),k!=null&&p.push(wg(b,k,w)))),g)break;b=b.return}0<p.length&&(f=new h(f,m,null,r,A),u.push({event:f,listeners:p}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&r!==DC&&(m=r.relatedTarget||r.fromElement)&&(th(m)||m[Nd]))break e;if((h||f)&&(f=A.window===A?A:(f=A.ownerDocument)?f.defaultView||f.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=d,m=m?th(m):null,m!==null&&(g=Kh(m),m!==g||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=d),h!==m)){if(p=G5,k="onMouseLeave",x="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(p=z5,k="onPointerLeave",x="onPointerEnter",b="pointer"),g=h==null?f:t0(h),w=m==null?f:t0(m),f=new p(k,b+"leave",h,r,A),f.target=g,f.relatedTarget=w,k=null,th(A)===d&&(p=new p(x,b+"enter",m,r,A),p.target=w,p.relatedTarget=g,k=p),g=k,h&&m)t:{for(p=h,x=m,b=0,w=p;w;w=gf(w))b++;for(w=0,k=x;k;k=gf(k))w++;for(;0<b-w;)p=gf(p),b--;for(;0<w-b;)x=gf(x),w--;for(;b--;){if(p===x||x!==null&&p===x.alternate)break t;p=gf(p),x=gf(x)}p=null}else p=null;h!==null&&a4(u,f,h,p,!1),m!==null&&g!==null&&a4(u,g,m,p,!0)}}e:{if(f=d?t0(d):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var O=I9;else if(X5(f))if(BR)O=T9;else{O=k9;var L=j9}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(O=F9);if(O&&(O=O(t,d))){ER(u,O,r,A);break e}L&&L(t,f,d),t==="focusout"&&(L=f._wrapperState)&&L.controlled&&f.type==="number"&&kC(f,"number",f.value)}switch(L=d?t0(d):window,t){case"focusin":(X5(L)||L.contentEditable==="true")&&(Zf=L,HC=d,Rp=null);break;case"focusout":Rp=HC=Zf=null;break;case"mousedown":KC=!0;break;case"contextmenu":case"mouseup":case"dragend":KC=!1,r4(u,r,A);break;case"selectionchange":if(D9)break;case"keydown":case"keyup":r4(u,r,A)}var E;if(iB)e:{switch(t){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else Yf?CR(t,r)&&(B="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(B="onCompositionStart");B&&(NR&&r.locale!=="ko"&&(Yf||B!=="onCompositionStart"?B==="onCompositionEnd"&&Yf&&(E=wR()):(jA=A,nB="value"in jA?jA.value:jA.textContent,Yf=!0)),L=By(d,B),0<L.length&&(B=new $5(B,t,null,r,A),u.push({event:B,listeners:L}),E?B.data=E:(E=_R(r),E!==null&&(B.data=E)))),(E=C9?_9(t,r):E9(t,r))&&(d=By(d,"onBeforeInput"),0<d.length&&(A=new $5("onBeforeInput","beforeinput",null,r,A),u.push({event:A,listeners:d}),A.data=E))}LR(u,e)})}function wg(t,e,r){return{instance:t,listener:e,currentTarget:r}}function By(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=mg(t,r),i!=null&&n.unshift(wg(t,i,s)),i=mg(t,e),i!=null&&n.push(wg(t,i,s))),t=t.return}return n}function gf(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function a4(t,e,r,n,s){for(var i=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,s?(c=mg(r,i),c!=null&&o.unshift(wg(r,c,l))):s||(c=mg(r,i),c!=null&&o.push(wg(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var M9=/\r\n?/g,Q9=/\u0000|\uFFFD/g;function i4(t){return(typeof t=="string"?t:""+t).replace(M9,`
`).replace(Q9,"")}function _v(t,e,r){if(e=i4(e),i4(t)!==e&&r)throw Error(qt(425))}function Sy(){}var qC=null,GC=null;function $C(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var zC=typeof setTimeout=="function"?setTimeout:void 0,V9=typeof clearTimeout=="function"?clearTimeout:void 0,o4=typeof Promise=="function"?Promise:void 0,H9=typeof queueMicrotask=="function"?queueMicrotask:typeof o4<"u"?function(t){return o4.resolve(null).then(t).catch(K9)}:zC;function K9(t){setTimeout(function(){throw t})}function Pw(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),xg(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);xg(e)}function VA(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function l4(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var J0=Math.random().toString(36).slice(2),gc="__reactFiber$"+J0,Ng="__reactProps$"+J0,Nd="__reactContainer$"+J0,WC="__reactEvents$"+J0,q9="__reactListeners$"+J0,G9="__reactHandles$"+J0;function th(t){var e=t[gc];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Nd]||r[gc]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=l4(t);t!==null;){if(r=t[gc])return r;t=l4(t)}return e}t=r,r=t.parentNode}return null}function xx(t){return t=t[gc]||t[Nd],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function t0(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(qt(33))}function qb(t){return t[Ng]||null}var JC=[],r0=-1;function pu(t){return{current:t}}function rs(t){0>r0||(t.current=JC[r0],JC[r0]=null,r0--)}function Wn(t,e){r0++,JC[r0]=t.current,t.current=e}var ru={},vi=pu(ru),Zi=pu(!1),bh=ru;function B0(t,e){var r=t.type.contextTypes;if(!r)return ru;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function eo(t){return t=t.childContextTypes,t!=null}function Iy(){rs(Zi),rs(vi)}function c4(t,e,r){if(vi.current!==ru)throw Error(qt(168));Wn(vi,e),Wn(Zi,r)}function OR(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(qt(108,jV(t)||"Unknown",s));return _s({},r,n)}function jy(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ru,bh=vi.current,Wn(vi,t),Wn(Zi,Zi.current),!0}function d4(t,e,r){var n=t.stateNode;if(!n)throw Error(qt(169));r?(t=OR(t,e,bh),n.__reactInternalMemoizedMergedChildContext=t,rs(Zi),rs(vi),Wn(vi,t)):rs(Zi),Wn(Zi,r)}var nd=null,Gb=!1,Rw=!1;function MR(t){nd===null?nd=[t]:nd.push(t)}function $9(t){Gb=!0,MR(t)}function gu(){if(!Rw&&nd!==null){Rw=!0;var t=0,e=kn;try{var r=nd;for(kn=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}nd=null,Gb=!1}catch(s){throw nd!==null&&(nd=nd.slice(t+1)),AR(ZE,gu),s}finally{kn=e,Rw=!1}}return null}var n0=[],s0=0,ky=null,Fy=0,al=[],il=0,wh=null,ad=1,id="";function Vu(t,e){n0[s0++]=Fy,n0[s0++]=ky,ky=t,Fy=e}function QR(t,e,r){al[il++]=ad,al[il++]=id,al[il++]=wh,wh=t;var n=ad;t=id;var s=32-Ul(n)-1;n&=~(1<<s),r+=1;var i=32-Ul(e)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,ad=1<<32-Ul(e)+s|r<<s|n,id=i+t}else ad=1<<i|r<<s|n,id=t}function lB(t){t.return!==null&&(Vu(t,1),QR(t,1,0))}function cB(t){for(;t===ky;)ky=n0[--s0],n0[s0]=null,Fy=n0[--s0],n0[s0]=null;for(;t===wh;)wh=al[--il],al[il]=null,id=al[--il],al[il]=null,ad=al[--il],al[il]=null}var jo=null,Bo=null,cs=!1,Rl=null;function VR(t,e){var r=ll(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function A4(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,jo=t,Bo=VA(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,jo=t,Bo=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=wh!==null?{id:ad,overflow:id}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=ll(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,jo=t,Bo=null,!0):!1;default:return!1}}function XC(t){return(t.mode&1)!==0&&(t.flags&128)===0}function YC(t){if(cs){var e=Bo;if(e){var r=e;if(!A4(t,e)){if(XC(t))throw Error(qt(418));e=VA(r.nextSibling);var n=jo;e&&A4(t,e)?VR(n,r):(t.flags=t.flags&-4097|2,cs=!1,jo=t)}}else{if(XC(t))throw Error(qt(418));t.flags=t.flags&-4097|2,cs=!1,jo=t}}}function u4(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;jo=t}function Ev(t){if(t!==jo)return!1;if(!cs)return u4(t),cs=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!$C(t.type,t.memoizedProps)),e&&(e=Bo)){if(XC(t))throw HR(),Error(qt(418));for(;e;)VR(t,e),e=VA(e.nextSibling)}if(u4(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(qt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Bo=VA(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Bo=null}}else Bo=jo?VA(t.stateNode.nextSibling):null;return!0}function HR(){for(var t=Bo;t;)t=VA(t.nextSibling)}function S0(){Bo=jo=null,cs=!1}function dB(t){Rl===null?Rl=[t]:Rl.push(t)}var z9=Fd.ReactCurrentBatchConfig;function Mm(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(qt(309));var n=r.stateNode}if(!n)throw Error(qt(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(qt(284));if(!r._owner)throw Error(qt(290,t))}return t}function Bv(t,e){throw t=Object.prototype.toString.call(e),Error(qt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function h4(t){var e=t._init;return e(t._payload)}function KR(t){function e(x,b){if(t){var w=x.deletions;w===null?(x.deletions=[b],x.flags|=16):w.push(b)}}function r(x,b){if(!t)return null;for(;b!==null;)e(x,b),b=b.sibling;return null}function n(x,b){for(x=new Map;b!==null;)b.key!==null?x.set(b.key,b):x.set(b.index,b),b=b.sibling;return x}function s(x,b){return x=GA(x,b),x.index=0,x.sibling=null,x}function i(x,b,w){return x.index=w,t?(w=x.alternate,w!==null?(w=w.index,w<b?(x.flags|=2,b):w):(x.flags|=2,b)):(x.flags|=1048576,b)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function l(x,b,w,k){return b===null||b.tag!==6?(b=Vw(w,x.mode,k),b.return=x,b):(b=s(b,w),b.return=x,b)}function c(x,b,w,k){var O=w.type;return O===Xf?A(x,b,w.props.children,k,w.key):b!==null&&(b.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===xA&&h4(O)===b.type)?(k=s(b,w.props),k.ref=Mm(x,b,w),k.return=x,k):(k=Y1(w.type,w.key,w.props,null,x.mode,k),k.ref=Mm(x,b,w),k.return=x,k)}function d(x,b,w,k){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=Hw(w,x.mode,k),b.return=x,b):(b=s(b,w.children||[]),b.return=x,b)}function A(x,b,w,k,O){return b===null||b.tag!==7?(b=ch(w,x.mode,k,O),b.return=x,b):(b=s(b,w),b.return=x,b)}function u(x,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Vw(""+b,x.mode,w),b.return=x,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case pv:return w=Y1(b.type,b.key,b.props,null,x.mode,w),w.ref=Mm(x,null,b),w.return=x,w;case Jf:return b=Hw(b,x.mode,w),b.return=x,b;case xA:var k=b._init;return u(x,k(b._payload),w)}if(Ap(b)||Rm(b))return b=ch(b,x.mode,w,null),b.return=x,b;Bv(x,b)}return null}function f(x,b,w,k){var O=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return O!==null?null:l(x,b,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case pv:return w.key===O?c(x,b,w,k):null;case Jf:return w.key===O?d(x,b,w,k):null;case xA:return O=w._init,f(x,b,O(w._payload),k)}if(Ap(w)||Rm(w))return O!==null?null:A(x,b,w,k,null);Bv(x,w)}return null}function h(x,b,w,k,O){if(typeof k=="string"&&k!==""||typeof k=="number")return x=x.get(w)||null,l(b,x,""+k,O);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case pv:return x=x.get(k.key===null?w:k.key)||null,c(b,x,k,O);case Jf:return x=x.get(k.key===null?w:k.key)||null,d(b,x,k,O);case xA:var L=k._init;return h(x,b,w,L(k._payload),O)}if(Ap(k)||Rm(k))return x=x.get(w)||null,A(b,x,k,O,null);Bv(b,k)}return null}function m(x,b,w,k){for(var O=null,L=null,E=b,B=b=0,S=null;E!==null&&B<w.length;B++){E.index>B?(S=E,E=null):S=E.sibling;var U=f(x,E,w[B],k);if(U===null){E===null&&(E=S);break}t&&E&&U.alternate===null&&e(x,E),b=i(U,b,B),L===null?O=U:L.sibling=U,L=U,E=S}if(B===w.length)return r(x,E),cs&&Vu(x,B),O;if(E===null){for(;B<w.length;B++)E=u(x,w[B],k),E!==null&&(b=i(E,b,B),L===null?O=E:L.sibling=E,L=E);return cs&&Vu(x,B),O}for(E=n(x,E);B<w.length;B++)S=h(E,x,B,w[B],k),S!==null&&(t&&S.alternate!==null&&E.delete(S.key===null?B:S.key),b=i(S,b,B),L===null?O=S:L.sibling=S,L=S);return t&&E.forEach(function(_){return e(x,_)}),cs&&Vu(x,B),O}function p(x,b,w,k){var O=Rm(w);if(typeof O!="function")throw Error(qt(150));if(w=O.call(w),w==null)throw Error(qt(151));for(var L=O=null,E=b,B=b=0,S=null,U=w.next();E!==null&&!U.done;B++,U=w.next()){E.index>B?(S=E,E=null):S=E.sibling;var _=f(x,E,U.value,k);if(_===null){E===null&&(E=S);break}t&&E&&_.alternate===null&&e(x,E),b=i(_,b,B),L===null?O=_:L.sibling=_,L=_,E=S}if(U.done)return r(x,E),cs&&Vu(x,B),O;if(E===null){for(;!U.done;B++,U=w.next())U=u(x,U.value,k),U!==null&&(b=i(U,b,B),L===null?O=U:L.sibling=U,L=U);return cs&&Vu(x,B),O}for(E=n(x,E);!U.done;B++,U=w.next())U=h(E,x,B,U.value,k),U!==null&&(t&&U.alternate!==null&&E.delete(U.key===null?B:U.key),b=i(U,b,B),L===null?O=U:L.sibling=U,L=U);return t&&E.forEach(function(F){return e(x,F)}),cs&&Vu(x,B),O}function g(x,b,w,k){if(typeof w=="object"&&w!==null&&w.type===Xf&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case pv:e:{for(var O=w.key,L=b;L!==null;){if(L.key===O){if(O=w.type,O===Xf){if(L.tag===7){r(x,L.sibling),b=s(L,w.props.children),b.return=x,x=b;break e}}else if(L.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===xA&&h4(O)===L.type){r(x,L.sibling),b=s(L,w.props),b.ref=Mm(x,L,w),b.return=x,x=b;break e}r(x,L);break}else e(x,L);L=L.sibling}w.type===Xf?(b=ch(w.props.children,x.mode,k,w.key),b.return=x,x=b):(k=Y1(w.type,w.key,w.props,null,x.mode,k),k.ref=Mm(x,b,w),k.return=x,x=k)}return o(x);case Jf:e:{for(L=w.key;b!==null;){if(b.key===L)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){r(x,b.sibling),b=s(b,w.children||[]),b.return=x,x=b;break e}else{r(x,b);break}else e(x,b);b=b.sibling}b=Hw(w,x.mode,k),b.return=x,x=b}return o(x);case xA:return L=w._init,g(x,b,L(w._payload),k)}if(Ap(w))return m(x,b,w,k);if(Rm(w))return p(x,b,w,k);Bv(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(r(x,b.sibling),b=s(b,w),b.return=x,x=b):(r(x,b),b=Vw(w,x.mode,k),b.return=x,x=b),o(x)):r(x,b)}return g}var I0=KR(!0),qR=KR(!1),Ty=pu(null),Py=null,a0=null,AB=null;function uB(){AB=a0=Py=null}function hB(t){var e=Ty.current;rs(Ty),t._currentValue=e}function ZC(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function m0(t,e){Py=t,AB=a0=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Xi=!0),t.firstContext=null)}function ml(t){var e=t._currentValue;if(AB!==t)if(t={context:t,memoizedValue:e,next:null},a0===null){if(Py===null)throw Error(qt(308));a0=t,Py.dependencies={lanes:0,firstContext:t}}else a0=a0.next=t;return e}var rh=null;function fB(t){rh===null?rh=[t]:rh.push(t)}function GR(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,fB(e)):(r.next=s.next,s.next=r),e.interleaved=r,Cd(t,n)}function Cd(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var vA=!1;function mB(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $R(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ud(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function HA(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,dn&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Cd(t,r)}return s=n.interleaved,s===null?(e.next=e,fB(n)):(e.next=s.next,s.next=e),n.interleaved=e,Cd(t,r)}function G1(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,eB(t,r)}}function f4(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Ry(t,e,r,n){var s=t.updateQueue;vA=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var A=t.alternate;A!==null&&(A=A.updateQueue,l=A.lastBaseUpdate,l!==o&&(l===null?A.firstBaseUpdate=d:l.next=d,A.lastBaseUpdate=c))}if(i!==null){var u=s.baseState;o=0,A=d=c=null,l=i;do{var f=l.lane,h=l.eventTime;if((n&f)===f){A!==null&&(A=A.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,p=l;switch(f=e,h=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){u=m.call(h,u,f);break e}u=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,f=typeof m=="function"?m.call(h,u,f):m,f==null)break e;u=_s({},u,f);break e;case 2:vA=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else h={eventTime:h,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},A===null?(d=A=h,c=u):A=A.next=h,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(A===null&&(c=u),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=A,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ch|=o,t.lanes=o,t.memoizedState=u}}function m4(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(qt(191,s));s.call(n)}}}var vx={},Cc=pu(vx),Cg=pu(vx),_g=pu(vx);function nh(t){if(t===vx)throw Error(qt(174));return t}function pB(t,e){switch(Wn(_g,e),Wn(Cg,t),Wn(Cc,vx),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:TC(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=TC(e,t)}rs(Cc),Wn(Cc,e)}function j0(){rs(Cc),rs(Cg),rs(_g)}function zR(t){nh(_g.current);var e=nh(Cc.current),r=TC(e,t.type);e!==r&&(Wn(Cg,t),Wn(Cc,r))}function gB(t){Cg.current===t&&(rs(Cc),rs(Cg))}var bs=pu(0);function Dy(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Dw=[];function xB(){for(var t=0;t<Dw.length;t++)Dw[t]._workInProgressVersionPrimary=null;Dw.length=0}var $1=Fd.ReactCurrentDispatcher,Lw=Fd.ReactCurrentBatchConfig,Nh=0,Cs=null,Aa=null,Ea=null,Ly=!1,Dp=!1,Eg=0,W9=0;function ti(){throw Error(qt(321))}function vB(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Hl(t[r],e[r]))return!1;return!0}function yB(t,e,r,n,s,i){if(Nh=i,Cs=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$1.current=t===null||t.memoizedState===null?Z9:eH,t=r(n,s),Dp){i=0;do{if(Dp=!1,Eg=0,25<=i)throw Error(qt(301));i+=1,Ea=Aa=null,e.updateQueue=null,$1.current=tH,t=r(n,s)}while(Dp)}if($1.current=Uy,e=Aa!==null&&Aa.next!==null,Nh=0,Ea=Aa=Cs=null,Ly=!1,e)throw Error(qt(300));return t}function bB(){var t=Eg!==0;return Eg=0,t}function pc(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ea===null?Cs.memoizedState=Ea=t:Ea=Ea.next=t,Ea}function pl(){if(Aa===null){var t=Cs.alternate;t=t!==null?t.memoizedState:null}else t=Aa.next;var e=Ea===null?Cs.memoizedState:Ea.next;if(e!==null)Ea=e,Aa=t;else{if(t===null)throw Error(qt(310));Aa=t,t={memoizedState:Aa.memoizedState,baseState:Aa.baseState,baseQueue:Aa.baseQueue,queue:Aa.queue,next:null},Ea===null?Cs.memoizedState=Ea=t:Ea=Ea.next=t}return Ea}function Bg(t,e){return typeof e=="function"?e(t):e}function Uw(t){var e=pl(),r=e.queue;if(r===null)throw Error(qt(311));r.lastRenderedReducer=t;var n=Aa,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=o=null,c=null,d=i;do{var A=d.lane;if((Nh&A)===A)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:t(n,d.action);else{var u={lane:A,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=u,o=n):c=c.next=u,Cs.lanes|=A,Ch|=A}d=d.next}while(d!==null&&d!==i);c===null?o=n:c.next=l,Hl(n,e.memoizedState)||(Xi=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,Cs.lanes|=i,Ch|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Ow(t){var e=pl(),r=e.queue;if(r===null)throw Error(qt(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Hl(i,e.memoizedState)||(Xi=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function WR(){}function JR(t,e){var r=Cs,n=pl(),s=e(),i=!Hl(n.memoizedState,s);if(i&&(n.memoizedState=s,Xi=!0),n=n.queue,wB(ZR.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||Ea!==null&&Ea.memoizedState.tag&1){if(r.flags|=2048,Sg(9,YR.bind(null,r,n,s,e),void 0,null),Ia===null)throw Error(qt(349));Nh&30||XR(r,e,s)}return s}function XR(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Cs.updateQueue,e===null?(e={lastEffect:null,stores:null},Cs.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function YR(t,e,r,n){e.value=r,e.getSnapshot=n,eD(e)&&tD(t)}function ZR(t,e,r){return r(function(){eD(e)&&tD(t)})}function eD(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Hl(t,r)}catch{return!0}}function tD(t){var e=Cd(t,1);e!==null&&Ol(e,t,1,-1)}function p4(t){var e=pc();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bg,lastRenderedState:t},e.queue=t,t=t.dispatch=Y9.bind(null,Cs,t),[e.memoizedState,t]}function Sg(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Cs.updateQueue,e===null?(e={lastEffect:null,stores:null},Cs.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function rD(){return pl().memoizedState}function z1(t,e,r,n){var s=pc();Cs.flags|=t,s.memoizedState=Sg(1|e,r,void 0,n===void 0?null:n)}function $b(t,e,r,n){var s=pl();n=n===void 0?null:n;var i=void 0;if(Aa!==null){var o=Aa.memoizedState;if(i=o.destroy,n!==null&&vB(n,o.deps)){s.memoizedState=Sg(e,r,i,n);return}}Cs.flags|=t,s.memoizedState=Sg(1|e,r,i,n)}function g4(t,e){return z1(8390656,8,t,e)}function wB(t,e){return $b(2048,8,t,e)}function nD(t,e){return $b(4,2,t,e)}function sD(t,e){return $b(4,4,t,e)}function aD(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function iD(t,e,r){return r=r!=null?r.concat([t]):null,$b(4,4,aD.bind(null,e,t),r)}function NB(){}function oD(t,e){var r=pl();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&vB(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function lD(t,e){var r=pl();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&vB(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function cD(t,e,r){return Nh&21?(Hl(r,e)||(r=fR(),Cs.lanes|=r,Ch|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Xi=!0),t.memoizedState=r)}function J9(t,e){var r=kn;kn=r!==0&&4>r?r:4,t(!0);var n=Lw.transition;Lw.transition={};try{t(!1),e()}finally{kn=r,Lw.transition=n}}function dD(){return pl().memoizedState}function X9(t,e,r){var n=qA(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},AD(t))uD(e,r);else if(r=GR(t,e,r,n),r!==null){var s=Ri();Ol(r,t,n,s),hD(r,e,n)}}function Y9(t,e,r){var n=qA(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(AD(t))uD(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,r);if(s.hasEagerState=!0,s.eagerState=l,Hl(l,o)){var c=e.interleaved;c===null?(s.next=s,fB(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=GR(t,e,s,n),r!==null&&(s=Ri(),Ol(r,t,n,s),hD(r,e,n))}}function AD(t){var e=t.alternate;return t===Cs||e!==null&&e===Cs}function uD(t,e){Dp=Ly=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function hD(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,eB(t,r)}}var Uy={readContext:ml,useCallback:ti,useContext:ti,useEffect:ti,useImperativeHandle:ti,useInsertionEffect:ti,useLayoutEffect:ti,useMemo:ti,useReducer:ti,useRef:ti,useState:ti,useDebugValue:ti,useDeferredValue:ti,useTransition:ti,useMutableSource:ti,useSyncExternalStore:ti,useId:ti,unstable_isNewReconciler:!1},Z9={readContext:ml,useCallback:function(t,e){return pc().memoizedState=[t,e===void 0?null:e],t},useContext:ml,useEffect:g4,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,z1(4194308,4,aD.bind(null,e,t),r)},useLayoutEffect:function(t,e){return z1(4194308,4,t,e)},useInsertionEffect:function(t,e){return z1(4,2,t,e)},useMemo:function(t,e){var r=pc();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=pc();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=X9.bind(null,Cs,t),[n.memoizedState,t]},useRef:function(t){var e=pc();return t={current:t},e.memoizedState=t},useState:p4,useDebugValue:NB,useDeferredValue:function(t){return pc().memoizedState=t},useTransition:function(){var t=p4(!1),e=t[0];return t=J9.bind(null,t[1]),pc().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Cs,s=pc();if(cs){if(r===void 0)throw Error(qt(407));r=r()}else{if(r=e(),Ia===null)throw Error(qt(349));Nh&30||XR(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,g4(ZR.bind(null,n,i,t),[t]),n.flags|=2048,Sg(9,YR.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=pc(),e=Ia.identifierPrefix;if(cs){var r=id,n=ad;r=(n&~(1<<32-Ul(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Eg++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=W9++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},eH={readContext:ml,useCallback:oD,useContext:ml,useEffect:wB,useImperativeHandle:iD,useInsertionEffect:nD,useLayoutEffect:sD,useMemo:lD,useReducer:Uw,useRef:rD,useState:function(){return Uw(Bg)},useDebugValue:NB,useDeferredValue:function(t){var e=pl();return cD(e,Aa.memoizedState,t)},useTransition:function(){var t=Uw(Bg)[0],e=pl().memoizedState;return[t,e]},useMutableSource:WR,useSyncExternalStore:JR,useId:dD,unstable_isNewReconciler:!1},tH={readContext:ml,useCallback:oD,useContext:ml,useEffect:wB,useImperativeHandle:iD,useInsertionEffect:nD,useLayoutEffect:sD,useMemo:lD,useReducer:Ow,useRef:rD,useState:function(){return Ow(Bg)},useDebugValue:NB,useDeferredValue:function(t){var e=pl();return Aa===null?e.memoizedState=t:cD(e,Aa.memoizedState,t)},useTransition:function(){var t=Ow(Bg)[0],e=pl().memoizedState;return[t,e]},useMutableSource:WR,useSyncExternalStore:JR,useId:dD,unstable_isNewReconciler:!1};function Tl(t,e){if(t&&t.defaultProps){e=_s({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function e_(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:_s({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var zb={isMounted:function(t){return(t=t._reactInternals)?Kh(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ri(),s=qA(t),i=ud(n,s);i.payload=e,r!=null&&(i.callback=r),e=HA(t,i,s),e!==null&&(Ol(e,t,s,n),G1(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ri(),s=qA(t),i=ud(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=HA(t,i,s),e!==null&&(Ol(e,t,s,n),G1(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ri(),n=qA(t),s=ud(r,n);s.tag=2,e!=null&&(s.callback=e),e=HA(t,s,n),e!==null&&(Ol(e,t,n,r),G1(e,t,n))}};function x4(t,e,r,n,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,o):e.prototype&&e.prototype.isPureReactComponent?!yg(r,n)||!yg(s,i):!0}function fD(t,e,r){var n=!1,s=ru,i=e.contextType;return typeof i=="object"&&i!==null?i=ml(i):(s=eo(e)?bh:vi.current,n=e.contextTypes,i=(n=n!=null)?B0(t,s):ru),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=zb,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function v4(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&zb.enqueueReplaceState(e,e.state,null)}function t_(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},mB(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=ml(i):(i=eo(e)?bh:vi.current,s.context=B0(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(e_(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&zb.enqueueReplaceState(s,s.state,null),Ry(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function k0(t,e){try{var r="",n=e;do r+=IV(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Mw(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function r_(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var rH=typeof WeakMap=="function"?WeakMap:Map;function mD(t,e,r){r=ud(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){My||(My=!0,u_=n),r_(t,e)},r}function pD(t,e,r){r=ud(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){r_(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){r_(t,e),typeof n!="function"&&(KA===null?KA=new Set([this]):KA.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function y4(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new rH;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=pH.bind(null,t,e,r),e.then(t,t))}function b4(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function w4(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=ud(-1,1),e.tag=2,HA(r,e,1))),r.lanes|=1),t)}var nH=Fd.ReactCurrentOwner,Xi=!1;function ki(t,e,r,n){e.child=t===null?qR(e,null,r,n):I0(e,t.child,r,n)}function N4(t,e,r,n,s){r=r.render;var i=e.ref;return m0(e,s),n=yB(t,e,r,n,i,s),r=bB(),t!==null&&!Xi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,_d(t,e,s)):(cs&&r&&lB(e),e.flags|=1,ki(t,e,n,s),e.child)}function C4(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!kB(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,gD(t,e,i,n,s)):(t=Y1(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:yg,r(o,n)&&t.ref===e.ref)return _d(t,e,s)}return e.flags|=1,t=GA(i,n),t.ref=e.ref,t.return=e,e.child=t}function gD(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(yg(i,n)&&t.ref===e.ref)if(Xi=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(Xi=!0);else return e.lanes=t.lanes,_d(t,e,s)}return n_(t,e,r,n,s)}function xD(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wn(o0,wo),wo|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Wn(o0,wo),wo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Wn(o0,wo),wo|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,Wn(o0,wo),wo|=n;return ki(t,e,s,r),e.child}function vD(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function n_(t,e,r,n,s){var i=eo(r)?bh:vi.current;return i=B0(e,i),m0(e,s),r=yB(t,e,r,n,i,s),n=bB(),t!==null&&!Xi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,_d(t,e,s)):(cs&&n&&lB(e),e.flags|=1,ki(t,e,r,s),e.child)}function _4(t,e,r,n,s){if(eo(r)){var i=!0;jy(e)}else i=!1;if(m0(e,s),e.stateNode===null)W1(t,e),fD(e,r,n),t_(e,r,n,s),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=ml(d):(d=eo(r)?bh:vi.current,d=B0(e,d));var A=r.getDerivedStateFromProps,u=typeof A=="function"||typeof o.getSnapshotBeforeUpdate=="function";u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==d)&&v4(e,o,n,d),vA=!1;var f=e.memoizedState;o.state=f,Ry(e,n,o,s),c=e.memoizedState,l!==n||f!==c||Zi.current||vA?(typeof A=="function"&&(e_(e,r,A,n),c=e.memoizedState),(l=vA||x4(e,r,l,n,f,c,d))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=d,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,$R(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Tl(e.type,l),o.props=d,u=e.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=ml(c):(c=eo(r)?bh:vi.current,c=B0(e,c));var h=r.getDerivedStateFromProps;(A=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==u||f!==c)&&v4(e,o,n,c),vA=!1,f=e.memoizedState,o.state=f,Ry(e,n,o,s);var m=e.memoizedState;l!==u||f!==m||Zi.current||vA?(typeof h=="function"&&(e_(e,r,h,n),m=e.memoizedState),(d=vA||x4(e,r,d,n,f,m,c)||!1)?(A||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=c,n=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return s_(t,e,r,n,i,s)}function s_(t,e,r,n,s,i){vD(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return s&&d4(e,r,!1),_d(t,e,i);n=e.stateNode,nH.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=I0(e,t.child,null,i),e.child=I0(e,null,l,i)):ki(t,e,l,i),e.memoizedState=n.state,s&&d4(e,r,!0),e.child}function yD(t){var e=t.stateNode;e.pendingContext?c4(t,e.pendingContext,e.pendingContext!==e.context):e.context&&c4(t,e.context,!1),pB(t,e.containerInfo)}function E4(t,e,r,n,s){return S0(),dB(s),e.flags|=256,ki(t,e,r,n),e.child}var a_={dehydrated:null,treeContext:null,retryLane:0};function i_(t){return{baseLanes:t,cachePool:null,transitions:null}}function bD(t,e,r){var n=e.pendingProps,s=bs.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Wn(bs,s&1),t===null)return YC(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,i?(n=e.mode,i=e.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Xb(o,n,0,null),t=ch(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=i_(r),e.memoizedState=a_,t):CB(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return sH(t,e,o,n,l,s,r);if(i){i=n.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=GA(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=GA(l,i):(i=ch(i,o,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,o=t.child.memoizedState,o=o===null?i_(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~r,e.memoizedState=a_,n}return i=t.child,t=i.sibling,n=GA(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function CB(t,e){return e=Xb({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Sv(t,e,r,n){return n!==null&&dB(n),I0(e,t.child,null,r),t=CB(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function sH(t,e,r,n,s,i,o){if(r)return e.flags&256?(e.flags&=-257,n=Mw(Error(qt(422))),Sv(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=Xb({mode:"visible",children:n.children},s,0,null),i=ch(i,s,o,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&I0(e,t.child,null,o),e.child.memoizedState=i_(o),e.memoizedState=a_,i);if(!(e.mode&1))return Sv(t,e,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(qt(419)),n=Mw(i,n,void 0),Sv(t,e,o,n)}if(l=(o&t.childLanes)!==0,Xi||l){if(n=Ia,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Cd(t,s),Ol(n,t,s,-1))}return jB(),n=Mw(Error(qt(421))),Sv(t,e,o,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=gH.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Bo=VA(s.nextSibling),jo=e,cs=!0,Rl=null,t!==null&&(al[il++]=ad,al[il++]=id,al[il++]=wh,ad=t.id,id=t.overflow,wh=e),e=CB(e,n.children),e.flags|=4096,e)}function B4(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),ZC(t.return,e,r)}function Qw(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function wD(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(ki(t,e,n.children,r),n=bs.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&B4(t,r,e);else if(t.tag===19)B4(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Wn(bs,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&Dy(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),Qw(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Dy(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}Qw(e,!0,r,null,i);break;case"together":Qw(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function W1(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function _d(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ch|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(qt(153));if(e.child!==null){for(t=e.child,r=GA(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=GA(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function aH(t,e,r){switch(e.tag){case 3:yD(e),S0();break;case 5:zR(e);break;case 1:eo(e.type)&&jy(e);break;case 4:pB(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Wn(Ty,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Wn(bs,bs.current&1),e.flags|=128,null):r&e.child.childLanes?bD(t,e,r):(Wn(bs,bs.current&1),t=_d(t,e,r),t!==null?t.sibling:null);Wn(bs,bs.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return wD(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Wn(bs,bs.current),n)break;return null;case 22:case 23:return e.lanes=0,xD(t,e,r)}return _d(t,e,r)}var ND,o_,CD,_D;ND=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};o_=function(){};CD=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,nh(Cc.current);var i=null;switch(r){case"input":s=IC(t,s),n=IC(t,n),i=[];break;case"select":s=_s({},s,{value:void 0}),n=_s({},n,{value:void 0}),i=[];break;case"textarea":s=FC(t,s),n=FC(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Sy)}PC(r,n);var o;r=null;for(d in s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(hg.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(l=s!=null?s[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(hg.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Zn("scroll",t),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};_D=function(t,e,r,n){r!==n&&(e.flags|=4)};function Qm(t,e){if(!cs)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ri(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function iH(t,e,r){var n=e.pendingProps;switch(cB(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ri(e),null;case 1:return eo(e.type)&&Iy(),ri(e),null;case 3:return n=e.stateNode,j0(),rs(Zi),rs(vi),xB(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Ev(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Rl!==null&&(m_(Rl),Rl=null))),o_(t,e),ri(e),null;case 5:gB(e);var s=nh(_g.current);if(r=e.type,t!==null&&e.stateNode!=null)CD(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(qt(166));return ri(e),null}if(t=nh(Cc.current),Ev(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[gc]=e,n[Ng]=i,t=(e.mode&1)!==0,r){case"dialog":Zn("cancel",n),Zn("close",n);break;case"iframe":case"object":case"embed":Zn("load",n);break;case"video":case"audio":for(s=0;s<hp.length;s++)Zn(hp[s],n);break;case"source":Zn("error",n);break;case"img":case"image":case"link":Zn("error",n),Zn("load",n);break;case"details":Zn("toggle",n);break;case"input":D5(n,i),Zn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Zn("invalid",n);break;case"textarea":U5(n,i),Zn("invalid",n)}PC(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&_v(n.textContent,l,t),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&_v(n.textContent,l,t),s=["children",""+l]):hg.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Zn("scroll",n)}switch(r){case"input":gv(n),L5(n,i,!0);break;case"textarea":gv(n),O5(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Sy)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Z3(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[gc]=e,t[Ng]=n,ND(t,e,!1,!1),e.stateNode=t;e:{switch(o=RC(r,n),r){case"dialog":Zn("cancel",t),Zn("close",t),s=n;break;case"iframe":case"object":case"embed":Zn("load",t),s=n;break;case"video":case"audio":for(s=0;s<hp.length;s++)Zn(hp[s],t);s=n;break;case"source":Zn("error",t),s=n;break;case"img":case"image":case"link":Zn("error",t),Zn("load",t),s=n;break;case"details":Zn("toggle",t),s=n;break;case"input":D5(t,n),s=IC(t,n),Zn("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=_s({},n,{value:void 0}),Zn("invalid",t);break;case"textarea":U5(t,n),s=FC(t,n),Zn("invalid",t);break;default:s=n}PC(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?rR(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&eR(t,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&fg(t,c):typeof c=="number"&&fg(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(hg.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Zn("scroll",t):c!=null&&zE(t,i,c,o))}switch(r){case"input":gv(t),L5(t,n,!1);break;case"textarea":gv(t),O5(t);break;case"option":n.value!=null&&t.setAttribute("value",""+tu(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?A0(t,!!n.multiple,i,!1):n.defaultValue!=null&&A0(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Sy)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ri(e),null;case 6:if(t&&e.stateNode!=null)_D(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(qt(166));if(r=nh(_g.current),nh(Cc.current),Ev(e)){if(n=e.stateNode,r=e.memoizedProps,n[gc]=e,(i=n.nodeValue!==r)&&(t=jo,t!==null))switch(t.tag){case 3:_v(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_v(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[gc]=e,e.stateNode=n}return ri(e),null;case 13:if(rs(bs),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(cs&&Bo!==null&&e.mode&1&&!(e.flags&128))HR(),S0(),e.flags|=98560,i=!1;else if(i=Ev(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(qt(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(qt(317));i[gc]=e}else S0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ri(e),i=!1}else Rl!==null&&(m_(Rl),Rl=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||bs.current&1?ma===0&&(ma=3):jB())),e.updateQueue!==null&&(e.flags|=4),ri(e),null);case 4:return j0(),o_(t,e),t===null&&bg(e.stateNode.containerInfo),ri(e),null;case 10:return hB(e.type._context),ri(e),null;case 17:return eo(e.type)&&Iy(),ri(e),null;case 19:if(rs(bs),i=e.memoizedState,i===null)return ri(e),null;if(n=(e.flags&128)!==0,o=i.rendering,o===null)if(n)Qm(i,!1);else{if(ma!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Dy(t),o!==null){for(e.flags|=128,Qm(i,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Wn(bs,bs.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ks()>F0&&(e.flags|=128,n=!0,Qm(i,!1),e.lanes=4194304)}else{if(!n)if(t=Dy(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Qm(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!cs)return ri(e),null}else 2*Ks()-i.renderingStartTime>F0&&r!==1073741824&&(e.flags|=128,n=!0,Qm(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(r=i.last,r!==null?r.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ks(),e.sibling=null,r=bs.current,Wn(bs,n?r&1|2:r&1),e):(ri(e),null);case 22:case 23:return IB(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?wo&1073741824&&(ri(e),e.subtreeFlags&6&&(e.flags|=8192)):ri(e),null;case 24:return null;case 25:return null}throw Error(qt(156,e.tag))}function oH(t,e){switch(cB(e),e.tag){case 1:return eo(e.type)&&Iy(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return j0(),rs(Zi),rs(vi),xB(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return gB(e),null;case 13:if(rs(bs),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(qt(340));S0()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return rs(bs),null;case 4:return j0(),null;case 10:return hB(e.type._context),null;case 22:case 23:return IB(),null;case 24:return null;default:return null}}var Iv=!1,mi=!1,lH=typeof WeakSet=="function"?WeakSet:Set,dr=null;function i0(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ks(t,e,n)}else r.current=null}function l_(t,e,r){try{r()}catch(n){ks(t,e,n)}}var S4=!1;function cH(t,e){if(qC=_y,t=jR(),oB(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,d=0,A=0,u=t,f=null;t:for(;;){for(var h;u!==r||s!==0&&u.nodeType!==3||(l=o+s),u!==i||n!==0&&u.nodeType!==3||(c=o+n),u.nodeType===3&&(o+=u.nodeValue.length),(h=u.firstChild)!==null;)f=u,u=h;for(;;){if(u===t)break t;if(f===r&&++d===s&&(l=o),f===i&&++A===n&&(c=o),(h=u.nextSibling)!==null)break;u=f,f=u.parentNode}u=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(GC={focusedElem:t,selectionRange:r},_y=!1,dr=e;dr!==null;)if(e=dr,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,dr=t;else for(;dr!==null;){e=dr;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,g=m.memoizedState,x=e.stateNode,b=x.getSnapshotBeforeUpdate(e.elementType===e.type?p:Tl(e.type,p),g);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(qt(163))}}catch(k){ks(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,dr=t;break}dr=e.return}return m=S4,S4=!1,m}function Lp(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&l_(e,r,i)}s=s.next}while(s!==n)}}function Wb(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function c_(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function ED(t){var e=t.alternate;e!==null&&(t.alternate=null,ED(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[gc],delete e[Ng],delete e[WC],delete e[q9],delete e[G9])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function BD(t){return t.tag===5||t.tag===3||t.tag===4}function I4(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||BD(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function d_(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Sy));else if(n!==4&&(t=t.child,t!==null))for(d_(t,e,r),t=t.sibling;t!==null;)d_(t,e,r),t=t.sibling}function A_(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(A_(t,e,r),t=t.sibling;t!==null;)A_(t,e,r),t=t.sibling}var Qa=null,Pl=!1;function sA(t,e,r){for(r=r.child;r!==null;)SD(t,e,r),r=r.sibling}function SD(t,e,r){if(Nc&&typeof Nc.onCommitFiberUnmount=="function")try{Nc.onCommitFiberUnmount(Qb,r)}catch{}switch(r.tag){case 5:mi||i0(r,e);case 6:var n=Qa,s=Pl;Qa=null,sA(t,e,r),Qa=n,Pl=s,Qa!==null&&(Pl?(t=Qa,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Qa.removeChild(r.stateNode));break;case 18:Qa!==null&&(Pl?(t=Qa,r=r.stateNode,t.nodeType===8?Pw(t.parentNode,r):t.nodeType===1&&Pw(t,r),xg(t)):Pw(Qa,r.stateNode));break;case 4:n=Qa,s=Pl,Qa=r.stateNode.containerInfo,Pl=!0,sA(t,e,r),Qa=n,Pl=s;break;case 0:case 11:case 14:case 15:if(!mi&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&l_(r,e,o),s=s.next}while(s!==n)}sA(t,e,r);break;case 1:if(!mi&&(i0(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){ks(r,e,l)}sA(t,e,r);break;case 21:sA(t,e,r);break;case 22:r.mode&1?(mi=(n=mi)||r.memoizedState!==null,sA(t,e,r),mi=n):sA(t,e,r);break;default:sA(t,e,r)}}function j4(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new lH),e.forEach(function(n){var s=xH.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Bl(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Qa=l.stateNode,Pl=!1;break e;case 3:Qa=l.stateNode.containerInfo,Pl=!0;break e;case 4:Qa=l.stateNode.containerInfo,Pl=!0;break e}l=l.return}if(Qa===null)throw Error(qt(160));SD(i,o,s),Qa=null,Pl=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){ks(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ID(e,t),e=e.sibling}function ID(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Bl(e,t),lc(t),n&4){try{Lp(3,t,t.return),Wb(3,t)}catch(p){ks(t,t.return,p)}try{Lp(5,t,t.return)}catch(p){ks(t,t.return,p)}}break;case 1:Bl(e,t),lc(t),n&512&&r!==null&&i0(r,r.return);break;case 5:if(Bl(e,t),lc(t),n&512&&r!==null&&i0(r,r.return),t.flags&32){var s=t.stateNode;try{fg(s,"")}catch(p){ks(t,t.return,p)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=r!==null?r.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&X3(s,i),RC(l,o);var d=RC(l,i);for(o=0;o<c.length;o+=2){var A=c[o],u=c[o+1];A==="style"?rR(s,u):A==="dangerouslySetInnerHTML"?eR(s,u):A==="children"?fg(s,u):zE(s,A,u,d)}switch(l){case"input":jC(s,i);break;case"textarea":Y3(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?A0(s,!!i.multiple,h,!1):f!==!!i.multiple&&(i.defaultValue!=null?A0(s,!!i.multiple,i.defaultValue,!0):A0(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ng]=i}catch(p){ks(t,t.return,p)}}break;case 6:if(Bl(e,t),lc(t),n&4){if(t.stateNode===null)throw Error(qt(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(p){ks(t,t.return,p)}}break;case 3:if(Bl(e,t),lc(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{xg(e.containerInfo)}catch(p){ks(t,t.return,p)}break;case 4:Bl(e,t),lc(t);break;case 13:Bl(e,t),lc(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(BB=Ks())),n&4&&j4(t);break;case 22:if(A=r!==null&&r.memoizedState!==null,t.mode&1?(mi=(d=mi)||A,Bl(e,t),mi=d):Bl(e,t),lc(t),n&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!A&&t.mode&1)for(dr=t,A=t.child;A!==null;){for(u=dr=A;dr!==null;){switch(f=dr,h=f.child,f.tag){case 0:case 11:case 14:case 15:Lp(4,f,f.return);break;case 1:i0(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){ks(n,r,p)}}break;case 5:i0(f,f.return);break;case 22:if(f.memoizedState!==null){F4(u);continue}}h!==null?(h.return=f,dr=h):F4(u)}A=A.sibling}e:for(A=null,u=t;;){if(u.tag===5){if(A===null){A=u;try{s=u.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=u.stateNode,c=u.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=tR("display",o))}catch(p){ks(t,t.return,p)}}}else if(u.tag===6){if(A===null)try{u.stateNode.nodeValue=d?"":u.memoizedProps}catch(p){ks(t,t.return,p)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===t)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===t)break e;for(;u.sibling===null;){if(u.return===null||u.return===t)break e;A===u&&(A=null),u=u.return}A===u&&(A=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:Bl(e,t),lc(t),n&4&&j4(t);break;case 21:break;default:Bl(e,t),lc(t)}}function lc(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(BD(r)){var n=r;break e}r=r.return}throw Error(qt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(fg(s,""),n.flags&=-33);var i=I4(t);A_(t,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=I4(t);d_(t,l,o);break;default:throw Error(qt(161))}}catch(c){ks(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function dH(t,e,r){dr=t,jD(t)}function jD(t,e,r){for(var n=(t.mode&1)!==0;dr!==null;){var s=dr,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Iv;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||mi;l=Iv;var d=mi;if(Iv=o,(mi=c)&&!d)for(dr=s;dr!==null;)o=dr,c=o.child,o.tag===22&&o.memoizedState!==null?T4(s):c!==null?(c.return=o,dr=c):T4(s);for(;i!==null;)dr=i,jD(i),i=i.sibling;dr=s,Iv=l,mi=d}k4(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,dr=i):k4(t)}}function k4(t){for(;dr!==null;){var e=dr;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:mi||Wb(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!mi)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Tl(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&m4(e,i,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}m4(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var A=d.memoizedState;if(A!==null){var u=A.dehydrated;u!==null&&xg(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(qt(163))}mi||e.flags&512&&c_(e)}catch(f){ks(e,e.return,f)}}if(e===t){dr=null;break}if(r=e.sibling,r!==null){r.return=e.return,dr=r;break}dr=e.return}}function F4(t){for(;dr!==null;){var e=dr;if(e===t){dr=null;break}var r=e.sibling;if(r!==null){r.return=e.return,dr=r;break}dr=e.return}}function T4(t){for(;dr!==null;){var e=dr;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Wb(4,e)}catch(c){ks(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){ks(e,s,c)}}var i=e.return;try{c_(e)}catch(c){ks(e,i,c)}break;case 5:var o=e.return;try{c_(e)}catch(c){ks(e,o,c)}}}catch(c){ks(e,e.return,c)}if(e===t){dr=null;break}var l=e.sibling;if(l!==null){l.return=e.return,dr=l;break}dr=e.return}}var AH=Math.ceil,Oy=Fd.ReactCurrentDispatcher,_B=Fd.ReactCurrentOwner,ul=Fd.ReactCurrentBatchConfig,dn=0,Ia=null,ra=null,Ja=0,wo=0,o0=pu(0),ma=0,Ig=null,Ch=0,Jb=0,EB=0,Up=null,Ji=null,BB=0,F0=1/0,rd=null,My=!1,u_=null,KA=null,jv=!1,kA=null,Qy=0,Op=0,h_=null,J1=-1,X1=0;function Ri(){return dn&6?Ks():J1!==-1?J1:J1=Ks()}function qA(t){return t.mode&1?dn&2&&Ja!==0?Ja&-Ja:z9.transition!==null?(X1===0&&(X1=fR()),X1):(t=kn,t!==0||(t=window.event,t=t===void 0?16:bR(t.type)),t):1}function Ol(t,e,r,n){if(50<Op)throw Op=0,h_=null,Error(qt(185));px(t,r,n),(!(dn&2)||t!==Ia)&&(t===Ia&&(!(dn&2)&&(Jb|=r),ma===4&&wA(t,Ja)),to(t,n),r===1&&dn===0&&!(e.mode&1)&&(F0=Ks()+500,Gb&&gu()))}function to(t,e){var r=t.callbackNode;zV(t,e);var n=Cy(t,t===Ia?Ja:0);if(n===0)r!==null&&V5(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&V5(r),e===1)t.tag===0?$9(P4.bind(null,t)):MR(P4.bind(null,t)),H9(function(){!(dn&6)&&gu()}),r=null;else{switch(mR(n)){case 1:r=ZE;break;case 4:r=uR;break;case 16:r=Ny;break;case 536870912:r=hR;break;default:r=Ny}r=UD(r,kD.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function kD(t,e){if(J1=-1,X1=0,dn&6)throw Error(qt(327));var r=t.callbackNode;if(p0()&&t.callbackNode!==r)return null;var n=Cy(t,t===Ia?Ja:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Vy(t,n);else{e=n;var s=dn;dn|=2;var i=TD();(Ia!==t||Ja!==e)&&(rd=null,F0=Ks()+500,lh(t,e));do try{fH();break}catch(l){FD(t,l)}while(!0);uB(),Oy.current=i,dn=s,ra!==null?e=0:(Ia=null,Ja=0,e=ma)}if(e!==0){if(e===2&&(s=MC(t),s!==0&&(n=s,e=f_(t,s))),e===1)throw r=Ig,lh(t,0),wA(t,n),to(t,Ks()),r;if(e===6)wA(t,n);else{if(s=t.current.alternate,!(n&30)&&!uH(s)&&(e=Vy(t,n),e===2&&(i=MC(t),i!==0&&(n=i,e=f_(t,i))),e===1))throw r=Ig,lh(t,0),wA(t,n),to(t,Ks()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(qt(345));case 2:Hu(t,Ji,rd);break;case 3:if(wA(t,n),(n&130023424)===n&&(e=BB+500-Ks(),10<e)){if(Cy(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Ri(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=zC(Hu.bind(null,t,Ji,rd),e);break}Hu(t,Ji,rd);break;case 4:if(wA(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var o=31-Ul(n);i=1<<o,o=e[o],o>s&&(s=o),n&=~i}if(n=s,n=Ks()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*AH(n/1960))-n,10<n){t.timeoutHandle=zC(Hu.bind(null,t,Ji,rd),n);break}Hu(t,Ji,rd);break;case 5:Hu(t,Ji,rd);break;default:throw Error(qt(329))}}}return to(t,Ks()),t.callbackNode===r?kD.bind(null,t):null}function f_(t,e){var r=Up;return t.current.memoizedState.isDehydrated&&(lh(t,e).flags|=256),t=Vy(t,e),t!==2&&(e=Ji,Ji=r,e!==null&&m_(e)),t}function m_(t){Ji===null?Ji=t:Ji.push.apply(Ji,t)}function uH(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Hl(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wA(t,e){for(e&=~EB,e&=~Jb,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Ul(e),n=1<<r;t[r]=-1,e&=~n}}function P4(t){if(dn&6)throw Error(qt(327));p0();var e=Cy(t,0);if(!(e&1))return to(t,Ks()),null;var r=Vy(t,e);if(t.tag!==0&&r===2){var n=MC(t);n!==0&&(e=n,r=f_(t,n))}if(r===1)throw r=Ig,lh(t,0),wA(t,e),to(t,Ks()),r;if(r===6)throw Error(qt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Hu(t,Ji,rd),to(t,Ks()),null}function SB(t,e){var r=dn;dn|=1;try{return t(e)}finally{dn=r,dn===0&&(F0=Ks()+500,Gb&&gu())}}function _h(t){kA!==null&&kA.tag===0&&!(dn&6)&&p0();var e=dn;dn|=1;var r=ul.transition,n=kn;try{if(ul.transition=null,kn=1,t)return t()}finally{kn=n,ul.transition=r,dn=e,!(dn&6)&&gu()}}function IB(){wo=o0.current,rs(o0)}function lh(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,V9(r)),ra!==null)for(r=ra.return;r!==null;){var n=r;switch(cB(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Iy();break;case 3:j0(),rs(Zi),rs(vi),xB();break;case 5:gB(n);break;case 4:j0();break;case 13:rs(bs);break;case 19:rs(bs);break;case 10:hB(n.type._context);break;case 22:case 23:IB()}r=r.return}if(Ia=t,ra=t=GA(t.current,null),Ja=wo=e,ma=0,Ig=null,EB=Jb=Ch=0,Ji=Up=null,rh!==null){for(e=0;e<rh.length;e++)if(r=rh[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}rh=null}return t}function FD(t,e){do{var r=ra;try{if(uB(),$1.current=Uy,Ly){for(var n=Cs.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Ly=!1}if(Nh=0,Ea=Aa=Cs=null,Dp=!1,Eg=0,_B.current=null,r===null||r.return===null){ma=1,Ig=e,ra=null;break}e:{var i=t,o=r.return,l=r,c=e;if(e=Ja,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,A=l,u=A.tag;if(!(A.mode&1)&&(u===0||u===11||u===15)){var f=A.alternate;f?(A.updateQueue=f.updateQueue,A.memoizedState=f.memoizedState,A.lanes=f.lanes):(A.updateQueue=null,A.memoizedState=null)}var h=b4(o);if(h!==null){h.flags&=-257,w4(h,o,l,i,e),h.mode&1&&y4(i,d,e),e=h,c=d;var m=e.updateQueue;if(m===null){var p=new Set;p.add(c),e.updateQueue=p}else m.add(c);break e}else{if(!(e&1)){y4(i,d,e),jB();break e}c=Error(qt(426))}}else if(cs&&l.mode&1){var g=b4(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),w4(g,o,l,i,e),dB(k0(c,l));break e}}i=c=k0(c,l),ma!==4&&(ma=2),Up===null?Up=[i]:Up.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=mD(i,c,e);f4(i,x);break e;case 1:l=c;var b=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(KA===null||!KA.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var k=pD(i,l,e);f4(i,k);break e}}i=i.return}while(i!==null)}RD(r)}catch(O){e=O,ra===r&&r!==null&&(ra=r=r.return);continue}break}while(!0)}function TD(){var t=Oy.current;return Oy.current=Uy,t===null?Uy:t}function jB(){(ma===0||ma===3||ma===2)&&(ma=4),Ia===null||!(Ch&268435455)&&!(Jb&268435455)||wA(Ia,Ja)}function Vy(t,e){var r=dn;dn|=2;var n=TD();(Ia!==t||Ja!==e)&&(rd=null,lh(t,e));do try{hH();break}catch(s){FD(t,s)}while(!0);if(uB(),dn=r,Oy.current=n,ra!==null)throw Error(qt(261));return Ia=null,Ja=0,ma}function hH(){for(;ra!==null;)PD(ra)}function fH(){for(;ra!==null&&!OV();)PD(ra)}function PD(t){var e=LD(t.alternate,t,wo);t.memoizedProps=t.pendingProps,e===null?RD(t):ra=e,_B.current=null}function RD(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=oH(r,e),r!==null){r.flags&=32767,ra=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ma=6,ra=null;return}}else if(r=iH(r,e,wo),r!==null){ra=r;return}if(e=e.sibling,e!==null){ra=e;return}ra=e=t}while(e!==null);ma===0&&(ma=5)}function Hu(t,e,r){var n=kn,s=ul.transition;try{ul.transition=null,kn=1,mH(t,e,r,n)}finally{ul.transition=s,kn=n}return null}function mH(t,e,r,n){do p0();while(kA!==null);if(dn&6)throw Error(qt(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(qt(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(WV(t,i),t===Ia&&(ra=Ia=null,Ja=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||jv||(jv=!0,UD(Ny,function(){return p0(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=ul.transition,ul.transition=null;var o=kn;kn=1;var l=dn;dn|=4,_B.current=null,cH(t,r),ID(r,t),R9(GC),_y=!!qC,GC=qC=null,t.current=r,dH(r),MV(),dn=l,kn=o,ul.transition=i}else t.current=r;if(jv&&(jv=!1,kA=t,Qy=s),i=t.pendingLanes,i===0&&(KA=null),HV(r.stateNode),to(t,Ks()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(My)throw My=!1,t=u_,u_=null,t;return Qy&1&&t.tag!==0&&p0(),i=t.pendingLanes,i&1?t===h_?Op++:(Op=0,h_=t):Op=0,gu(),null}function p0(){if(kA!==null){var t=mR(Qy),e=ul.transition,r=kn;try{if(ul.transition=null,kn=16>t?16:t,kA===null)var n=!1;else{if(t=kA,kA=null,Qy=0,dn&6)throw Error(qt(331));var s=dn;for(dn|=4,dr=t.current;dr!==null;){var i=dr,o=i.child;if(dr.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(dr=d;dr!==null;){var A=dr;switch(A.tag){case 0:case 11:case 15:Lp(8,A,i)}var u=A.child;if(u!==null)u.return=A,dr=u;else for(;dr!==null;){A=dr;var f=A.sibling,h=A.return;if(ED(A),A===d){dr=null;break}if(f!==null){f.return=h,dr=f;break}dr=h}}}var m=i.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var g=p.sibling;p.sibling=null,p=g}while(p!==null)}}dr=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,dr=o;else e:for(;dr!==null;){if(i=dr,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Lp(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,dr=x;break e}dr=i.return}}var b=t.current;for(dr=b;dr!==null;){o=dr;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,dr=w;else e:for(o=b;dr!==null;){if(l=dr,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Wb(9,l)}}catch(O){ks(l,l.return,O)}if(l===o){dr=null;break e}var k=l.sibling;if(k!==null){k.return=l.return,dr=k;break e}dr=l.return}}if(dn=s,gu(),Nc&&typeof Nc.onPostCommitFiberRoot=="function")try{Nc.onPostCommitFiberRoot(Qb,t)}catch{}n=!0}return n}finally{kn=r,ul.transition=e}}return!1}function R4(t,e,r){e=k0(r,e),e=mD(t,e,1),t=HA(t,e,1),e=Ri(),t!==null&&(px(t,1,e),to(t,e))}function ks(t,e,r){if(t.tag===3)R4(t,t,r);else for(;e!==null;){if(e.tag===3){R4(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(KA===null||!KA.has(n))){t=k0(r,t),t=pD(e,t,1),e=HA(e,t,1),t=Ri(),e!==null&&(px(e,1,t),to(e,t));break}}e=e.return}}function pH(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ri(),t.pingedLanes|=t.suspendedLanes&r,Ia===t&&(Ja&r)===r&&(ma===4||ma===3&&(Ja&130023424)===Ja&&500>Ks()-BB?lh(t,0):EB|=r),to(t,e)}function DD(t,e){e===0&&(t.mode&1?(e=yv,yv<<=1,!(yv&130023424)&&(yv=4194304)):e=1);var r=Ri();t=Cd(t,e),t!==null&&(px(t,e,r),to(t,r))}function gH(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),DD(t,r)}function xH(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(qt(314))}n!==null&&n.delete(e),DD(t,r)}var LD;LD=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Zi.current)Xi=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Xi=!1,aH(t,e,r);Xi=!!(t.flags&131072)}else Xi=!1,cs&&e.flags&1048576&&QR(e,Fy,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;W1(t,e),t=e.pendingProps;var s=B0(e,vi.current);m0(e,r),s=yB(null,e,n,t,s,r);var i=bB();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,eo(n)?(i=!0,jy(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,mB(e),s.updater=zb,e.stateNode=s,s._reactInternals=e,t_(e,n,t,r),e=s_(null,e,n,!0,i,r)):(e.tag=0,cs&&i&&lB(e),ki(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(W1(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=yH(n),t=Tl(n,t),s){case 0:e=n_(null,e,n,t,r);break e;case 1:e=_4(null,e,n,t,r);break e;case 11:e=N4(null,e,n,t,r);break e;case 14:e=C4(null,e,n,Tl(n.type,t),r);break e}throw Error(qt(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Tl(n,s),n_(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Tl(n,s),_4(t,e,n,s,r);case 3:e:{if(yD(e),t===null)throw Error(qt(387));n=e.pendingProps,i=e.memoizedState,s=i.element,$R(t,e),Ry(e,n,null,r);var o=e.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=k0(Error(qt(423)),e),e=E4(t,e,n,r,s);break e}else if(n!==s){s=k0(Error(qt(424)),e),e=E4(t,e,n,r,s);break e}else for(Bo=VA(e.stateNode.containerInfo.firstChild),jo=e,cs=!0,Rl=null,r=qR(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(S0(),n===s){e=_d(t,e,r);break e}ki(t,e,n,r)}e=e.child}return e;case 5:return zR(e),t===null&&YC(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,$C(n,s)?o=null:i!==null&&$C(n,i)&&(e.flags|=32),vD(t,e),ki(t,e,o,r),e.child;case 6:return t===null&&YC(e),null;case 13:return bD(t,e,r);case 4:return pB(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=I0(e,null,n,r):ki(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Tl(n,s),N4(t,e,n,s,r);case 7:return ki(t,e,e.pendingProps,r),e.child;case 8:return ki(t,e,e.pendingProps.children,r),e.child;case 12:return ki(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Wn(Ty,n._currentValue),n._currentValue=o,i!==null)if(Hl(i.value,o)){if(i.children===s.children&&!Zi.current){e=_d(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=ud(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var A=d.pending;A===null?c.next=c:(c.next=A.next,A.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),ZC(i.return,r,e),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(qt(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),ZC(o,r,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ki(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,m0(e,r),s=ml(s),n=n(s),e.flags|=1,ki(t,e,n,r),e.child;case 14:return n=e.type,s=Tl(n,e.pendingProps),s=Tl(n.type,s),C4(t,e,n,s,r);case 15:return gD(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Tl(n,s),W1(t,e),e.tag=1,eo(n)?(t=!0,jy(e)):t=!1,m0(e,r),fD(e,n,s),t_(e,n,s,r),s_(null,e,n,!0,t,r);case 19:return wD(t,e,r);case 22:return xD(t,e,r)}throw Error(qt(156,e.tag))};function UD(t,e){return AR(t,e)}function vH(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ll(t,e,r,n){return new vH(t,e,r,n)}function kB(t){return t=t.prototype,!(!t||!t.isReactComponent)}function yH(t){if(typeof t=="function")return kB(t)?1:0;if(t!=null){if(t=t.$$typeof,t===JE)return 11;if(t===XE)return 14}return 2}function GA(t,e){var r=t.alternate;return r===null?(r=ll(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Y1(t,e,r,n,s,i){var o=2;if(n=t,typeof t=="function")kB(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Xf:return ch(r.children,s,i,e);case WE:o=8,s|=8;break;case _C:return t=ll(12,r,e,s|2),t.elementType=_C,t.lanes=i,t;case EC:return t=ll(13,r,e,s),t.elementType=EC,t.lanes=i,t;case BC:return t=ll(19,r,e,s),t.elementType=BC,t.lanes=i,t;case z3:return Xb(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case G3:o=10;break e;case $3:o=9;break e;case JE:o=11;break e;case XE:o=14;break e;case xA:o=16,n=null;break e}throw Error(qt(130,t==null?t:typeof t,""))}return e=ll(o,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function ch(t,e,r,n){return t=ll(7,t,n,e),t.lanes=r,t}function Xb(t,e,r,n){return t=ll(22,t,n,e),t.elementType=z3,t.lanes=r,t.stateNode={isHidden:!1},t}function Vw(t,e,r){return t=ll(6,t,null,e),t.lanes=r,t}function Hw(t,e,r){return e=ll(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function bH(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Nw(0),this.expirationTimes=Nw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nw(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function FB(t,e,r,n,s,i,o,l,c){return t=new bH(t,e,r,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ll(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},mB(i),t}function wH(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Jf,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function OD(t){if(!t)return ru;t=t._reactInternals;e:{if(Kh(t)!==t||t.tag!==1)throw Error(qt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(eo(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(qt(171))}if(t.tag===1){var r=t.type;if(eo(r))return OR(t,r,e)}return e}function MD(t,e,r,n,s,i,o,l,c){return t=FB(r,n,!0,t,s,i,o,l,c),t.context=OD(null),r=t.current,n=Ri(),s=qA(r),i=ud(n,s),i.callback=e??null,HA(r,i,s),t.current.lanes=s,px(t,s,n),to(t,n),t}function Yb(t,e,r,n){var s=e.current,i=Ri(),o=qA(s);return r=OD(r),e.context===null?e.context=r:e.pendingContext=r,e=ud(i,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=HA(s,e,o),t!==null&&(Ol(t,s,o,i),G1(t,s,o)),o}function Hy(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function D4(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function TB(t,e){D4(t,e),(t=t.alternate)&&D4(t,e)}function NH(){return null}var QD=typeof reportError=="function"?reportError:function(t){console.error(t)};function PB(t){this._internalRoot=t}Zb.prototype.render=PB.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(qt(409));Yb(t,e,null,null)};Zb.prototype.unmount=PB.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;_h(function(){Yb(null,t,null,null)}),e[Nd]=null}};function Zb(t){this._internalRoot=t}Zb.prototype.unstable_scheduleHydration=function(t){if(t){var e=xR();t={blockedOn:null,target:t,priority:e};for(var r=0;r<bA.length&&e!==0&&e<bA[r].priority;r++);bA.splice(r,0,t),r===0&&yR(t)}};function RB(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function e2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function L4(){}function CH(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var d=Hy(o);i.call(d)}}var o=MD(e,n,t,0,null,!1,!1,"",L4);return t._reactRootContainer=o,t[Nd]=o.current,bg(t.nodeType===8?t.parentNode:t),_h(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var d=Hy(c);l.call(d)}}var c=FB(t,0,!1,null,null,!1,!1,"",L4);return t._reactRootContainer=c,t[Nd]=c.current,bg(t.nodeType===8?t.parentNode:t),_h(function(){Yb(e,c,r,n)}),c}function t2(t,e,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Hy(o);l.call(c)}}Yb(e,o,t,s)}else o=CH(r,e,t,s,n);return Hy(o)}pR=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=up(e.pendingLanes);r!==0&&(eB(e,r|1),to(e,Ks()),!(dn&6)&&(F0=Ks()+500,gu()))}break;case 13:_h(function(){var n=Cd(t,1);if(n!==null){var s=Ri();Ol(n,t,1,s)}}),TB(t,1)}};tB=function(t){if(t.tag===13){var e=Cd(t,134217728);if(e!==null){var r=Ri();Ol(e,t,134217728,r)}TB(t,134217728)}};gR=function(t){if(t.tag===13){var e=qA(t),r=Cd(t,e);if(r!==null){var n=Ri();Ol(r,t,e,n)}TB(t,e)}};xR=function(){return kn};vR=function(t,e){var r=kn;try{return kn=t,e()}finally{kn=r}};LC=function(t,e,r){switch(e){case"input":if(jC(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=qb(n);if(!s)throw Error(qt(90));J3(n),jC(n,s)}}}break;case"textarea":Y3(t,r);break;case"select":e=r.value,e!=null&&A0(t,!!r.multiple,e,!1)}};aR=SB;iR=_h;var _H={usingClientEntryPoint:!1,Events:[xx,t0,qb,nR,sR,SB]},Vm={findFiberByHostInstance:th,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},EH={bundleType:Vm.bundleType,version:Vm.version,rendererPackageName:Vm.rendererPackageName,rendererConfig:Vm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fd.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=cR(t),t===null?null:t.stateNode},findFiberByHostInstance:Vm.findFiberByHostInstance||NH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kv.isDisabled&&kv.supportsFiber)try{Qb=kv.inject(EH),Nc=kv}catch{}}Ro.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_H;Ro.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!RB(e))throw Error(qt(200));return wH(t,e,null,r)};Ro.createRoot=function(t,e){if(!RB(t))throw Error(qt(299));var r=!1,n="",s=QD;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=FB(t,1,!1,null,null,r,!1,n,s),t[Nd]=e.current,bg(t.nodeType===8?t.parentNode:t),new PB(e)};Ro.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(qt(188)):(t=Object.keys(t).join(","),Error(qt(268,t)));return t=cR(e),t=t===null?null:t.stateNode,t};Ro.flushSync=function(t){return _h(t)};Ro.hydrate=function(t,e,r){if(!e2(e))throw Error(qt(200));return t2(null,t,e,!0,r)};Ro.hydrateRoot=function(t,e,r){if(!RB(t))throw Error(qt(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=QD;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=MD(e,null,t,1,r??null,s,!1,i,o),t[Nd]=e.current,bg(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new Zb(e)};Ro.render=function(t,e,r){if(!e2(e))throw Error(qt(200));return t2(null,t,e,!1,r)};Ro.unmountComponentAtNode=function(t){if(!e2(t))throw Error(qt(40));return t._reactRootContainer?(_h(function(){t2(null,null,t,!1,function(){t._reactRootContainer=null,t[Nd]=null})}),!0):!1};Ro.unstable_batchedUpdates=SB;Ro.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!e2(r))throw Error(qt(200));if(t==null||t._reactInternals===void 0)throw Error(qt(38));return t2(t,e,r,!1,n)};Ro.version="18.3.1-next-f1338f8080-20240426";function VD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(VD)}catch(t){console.error(t)}}VD(),V3.exports=Ro;var $A=V3.exports,U4=$A;NC.createRoot=U4.createRoot,NC.hydrateRoot=U4.hydrateRoot;/**
 * react-router v7.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var O4="popstate";function BH(t={}){function e(n,s){let{pathname:i,search:o,hash:l}=n.location;return p_("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:jg(s)}return IH(e,r,null,t)}function hs(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Kl(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function SH(){return Math.random().toString(36).substring(2,10)}function M4(t,e){return{usr:t.state,key:t.key,idx:e}}function p_(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?X0(e):e,state:r,key:e&&e.key||n||SH()}}function jg({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function X0(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function IH(t,e,r,n={}){let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,l="POP",c=null,d=A();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function A(){return(o.state||{idx:null}).idx}function u(){l="POP";let g=A(),x=g==null?null:g-d;d=g,c&&c({action:l,location:p.location,delta:x})}function f(g,x){l="PUSH";let b=p_(p.location,g,x);d=A()+1;let w=M4(b,d),k=p.createHref(b);try{o.pushState(w,"",k)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(k)}i&&c&&c({action:l,location:p.location,delta:1})}function h(g,x){l="REPLACE";let b=p_(p.location,g,x);d=A();let w=M4(b,d),k=p.createHref(b);o.replaceState(w,"",k),i&&c&&c({action:l,location:p.location,delta:0})}function m(g){return jH(g)}let p={get action(){return l},get location(){return t(s,o)},listen(g){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(O4,u),c=g,()=>{s.removeEventListener(O4,u),c=null}},createHref(g){return e(s,g)},createURL:m,encodeLocation(g){let x=m(g);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:h,go(g){return o.go(g)}};return p}function jH(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),hs(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:jg(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function HD(t,e,r="/"){return kH(t,e,r,!1)}function kH(t,e,r,n){let s=typeof e=="string"?X0(e):e,i=Ed(s.pathname||"/",r);if(i==null)return null;let o=KD(t);FH(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=HH(i);l=QH(o[c],d,n)}return l}function KD(t,e=[],r=[],n="",s=!1){let i=(o,l,c=s,d)=>{let A={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(A.relativePath.startsWith("/")){if(!A.relativePath.startsWith(n)&&c)return;hs(A.relativePath.startsWith(n),`Absolute route path "${A.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),A.relativePath=A.relativePath.slice(n.length)}let u=hd([n,A.relativePath]),f=r.concat(A);o.children&&o.children.length>0&&(hs(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),KD(o.children,e,f,u,c)),!(o.path==null&&!o.index)&&e.push({path:u,score:OH(u,o.index),routesMeta:f})};return t.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))i(o,l);else for(let d of qD(o.path))i(o,l,!0,d)}),e}function qD(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let o=qD(n.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function FH(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:MH(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var TH=/^:[\w-]+$/,PH=3,RH=2,DH=1,LH=10,UH=-2,Q4=t=>t==="*";function OH(t,e){let r=t.split("/"),n=r.length;return r.some(Q4)&&(n+=UH),e&&(n+=RH),r.filter(s=>!Q4(s)).reduce((s,i)=>s+(TH.test(i)?PH:i===""?DH:LH),n)}function MH(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function QH(t,e,r=!1){let{routesMeta:n}=t,s={},i="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,A=i==="/"?e:e.slice(i.length)||"/",u=Ky({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},A),f=c.route;if(!u&&d&&r&&!n[n.length-1].route.index&&(u=Ky({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},A)),!u)return null;Object.assign(s,u.params),o.push({params:s,pathname:hd([i,u.pathname]),pathnameBase:$H(hd([i,u.pathnameBase])),route:f}),u.pathnameBase!=="/"&&(i=hd([i,u.pathnameBase]))}return o}function Ky(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=VH(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((d,{paramName:A,isOptional:u},f)=>{if(A==="*"){let m=l[f]||"";o=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const h=l[f];return u&&!h?d[A]=void 0:d[A]=(h||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function VH(t,e=!1,r=!0){Kl(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function HH(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Kl(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Ed(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function KH(t,e="/"){let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?X0(t):t;return{pathname:r?r.startsWith("/")?r:qH(r,e):e,search:zH(n),hash:WH(s)}}function qH(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Kw(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function GH(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function DB(t){let e=GH(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function LB(t,e,r,n=!1){let s;typeof t=="string"?s=X0(t):(s={...t},hs(!s.pathname||!s.pathname.includes("?"),Kw("?","pathname","search",s)),hs(!s.pathname||!s.pathname.includes("#"),Kw("#","pathname","hash",s)),hs(!s.search||!s.search.includes("#"),Kw("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=r;else{let u=e.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),u-=1;s.pathname=f.join("/")}l=u>=0?e[u]:"/"}let c=KH(s,l),d=o&&o!=="/"&&o.endsWith("/"),A=(i||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||A)&&(c.pathname+="/"),c}var hd=t=>t.join("/").replace(/\/\/+/g,"/"),$H=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),zH=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,WH=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function JH(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var GD=["POST","PUT","PATCH","DELETE"];new Set(GD);var XH=["GET",...GD];new Set(XH);var Y0=N.createContext(null);Y0.displayName="DataRouter";var r2=N.createContext(null);r2.displayName="DataRouterState";N.createContext(!1);var $D=N.createContext({isTransitioning:!1});$D.displayName="ViewTransition";var YH=N.createContext(new Map);YH.displayName="Fetchers";var ZH=N.createContext(null);ZH.displayName="Await";var zl=N.createContext(null);zl.displayName="Navigation";var yx=N.createContext(null);yx.displayName="Location";var Wl=N.createContext({outlet:null,matches:[],isDataRoute:!1});Wl.displayName="Route";var UB=N.createContext(null);UB.displayName="RouteError";function eK(t,{relative:e}={}){hs(Z0(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=N.useContext(zl),{hash:s,pathname:i,search:o}=wx(t,{relative:e}),l=i;return r!=="/"&&(l=i==="/"?r:hd([r,i])),n.createHref({pathname:l,search:o,hash:s})}function Z0(){return N.useContext(yx)!=null}function xu(){return hs(Z0(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(yx).location}var zD="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function WD(t){N.useContext(zl).static||N.useLayoutEffect(t)}function bx(){let{isDataRoute:t}=N.useContext(Wl);return t?mK():tK()}function tK(){hs(Z0(),"useNavigate() may be used only in the context of a <Router> component.");let t=N.useContext(Y0),{basename:e,navigator:r}=N.useContext(zl),{matches:n}=N.useContext(Wl),{pathname:s}=xu(),i=JSON.stringify(DB(n)),o=N.useRef(!1);return WD(()=>{o.current=!0}),N.useCallback((c,d={})=>{if(Kl(o.current,zD),!o.current)return;if(typeof c=="number"){r.go(c);return}let A=LB(c,JSON.parse(i),s,d.relative==="path");t==null&&e!=="/"&&(A.pathname=A.pathname==="/"?e:hd([e,A.pathname])),(d.replace?r.replace:r.push)(A,d.state,d)},[e,r,i,s,t])}var rK=N.createContext(null);function nK(t){let e=N.useContext(Wl).outlet;return e&&N.createElement(rK.Provider,{value:t},e)}function wx(t,{relative:e}={}){let{matches:r}=N.useContext(Wl),{pathname:n}=xu(),s=JSON.stringify(DB(r));return N.useMemo(()=>LB(t,JSON.parse(s),n,e==="path"),[t,s,n,e])}function sK(t,e){return JD(t,e)}function JD(t,e,r,n){var x;hs(Z0(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=N.useContext(zl),{matches:i}=N.useContext(Wl),o=i[i.length-1],l=o?o.params:{},c=o?o.pathname:"/",d=o?o.pathnameBase:"/",A=o&&o.route;{let b=A&&A.path||"";XD(c,!A||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let u=xu(),f;if(e){let b=typeof e=="string"?X0(e):e;hs(d==="/"||((x=b.pathname)==null?void 0:x.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${b.pathname}" was given in the \`location\` prop.`),f=b}else f=u;let h=f.pathname||"/",m=h;if(d!=="/"){let b=d.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(b.length).join("/")}let p=HD(t,{pathname:m});Kl(A||p!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),Kl(p==null||p[p.length-1].route.element!==void 0||p[p.length-1].route.Component!==void 0||p[p.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let g=cK(p&&p.map(b=>Object.assign({},b,{params:Object.assign({},l,b.params),pathname:hd([d,s.encodeLocation?s.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?d:hd([d,s.encodeLocation?s.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),i,r,n);return e&&g?N.createElement(yx.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},g):g}function aK(){let t=fK(),e=JH(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:i},"ErrorBoundary")," or"," ",N.createElement("code",{style:i},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),r?N.createElement("pre",{style:s},r):null,o)}var iK=N.createElement(aK,null),oK=class extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?N.createElement(Wl.Provider,{value:this.props.routeContext},N.createElement(UB.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function lK({routeContext:t,match:e,children:r}){let n=N.useContext(Y0);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(Wl.Provider,{value:t},r)}function cK(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let s=t,i=r==null?void 0:r.errors;if(i!=null){let c=s.findIndex(d=>d.route.id&&(i==null?void 0:i[d.route.id])!==void 0);hs(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,c+1))}let o=!1,l=-1;if(r)for(let c=0;c<s.length;c++){let d=s[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=c),d.route.id){let{loaderData:A,errors:u}=r,f=d.route.loader&&!A.hasOwnProperty(d.route.id)&&(!u||u[d.route.id]===void 0);if(d.route.lazy||f){o=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((c,d,A)=>{let u,f=!1,h=null,m=null;r&&(u=i&&d.route.id?i[d.route.id]:void 0,h=d.route.errorElement||iK,o&&(l<0&&A===0?(XD("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,m=null):l===A&&(f=!0,m=d.route.hydrateFallbackElement||null)));let p=e.concat(s.slice(0,A+1)),g=()=>{let x;return u?x=h:f?x=m:d.route.Component?x=N.createElement(d.route.Component,null):d.route.element?x=d.route.element:x=c,N.createElement(lK,{match:d,routeContext:{outlet:c,matches:p,isDataRoute:r!=null},children:x})};return r&&(d.route.ErrorBoundary||d.route.errorElement||A===0)?N.createElement(oK,{location:r.location,revalidation:r.revalidation,component:h,error:u,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}function OB(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function dK(t){let e=N.useContext(Y0);return hs(e,OB(t)),e}function AK(t){let e=N.useContext(r2);return hs(e,OB(t)),e}function uK(t){let e=N.useContext(Wl);return hs(e,OB(t)),e}function MB(t){let e=uK(t),r=e.matches[e.matches.length-1];return hs(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function hK(){return MB("useRouteId")}function fK(){var n;let t=N.useContext(UB),e=AK("useRouteError"),r=MB("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function mK(){let{router:t}=dK("useNavigate"),e=MB("useNavigate"),r=N.useRef(!1);return WD(()=>{r.current=!0}),N.useCallback(async(s,i={})=>{Kl(r.current,zD),r.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var V4={};function XD(t,e,r){!e&&!V4[t]&&(V4[t]=!0,Kl(!1,r))}N.memo(pK);function pK({routes:t,future:e,state:r}){return JD(t,void 0,r,e)}function Ku({to:t,replace:e,state:r,relative:n}){hs(Z0(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=N.useContext(zl);Kl(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=N.useContext(Wl),{pathname:o}=xu(),l=bx(),c=LB(t,DB(i),o,n==="path"),d=JSON.stringify(c);return N.useEffect(()=>{l(JSON.parse(d),{replace:e,state:r,relative:n})},[l,d,n,e,r]),null}function YD(t){return nK(t.context)}function Vr(t){hs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function gK({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:s,static:i=!1}){hs(!Z0(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=N.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof r=="string"&&(r=X0(r));let{pathname:c="/",search:d="",hash:A="",state:u=null,key:f="default"}=r,h=N.useMemo(()=>{let m=Ed(c,o);return m==null?null:{location:{pathname:m,search:d,hash:A,state:u,key:f},navigationType:n}},[o,c,d,A,u,f,n]);return Kl(h!=null,`<Router basename="${o}"> is not able to match the URL "${c}${d}${A}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:N.createElement(zl.Provider,{value:l},N.createElement(yx.Provider,{children:e,value:h}))}function xK({children:t,location:e}){return sK(g_(t),e)}function g_(t,e=[]){let r=[];return N.Children.forEach(t,(n,s)=>{if(!N.isValidElement(n))return;let i=[...e,s];if(n.type===N.Fragment){r.push.apply(r,g_(n.props.children,i));return}hs(n.type===Vr,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),hs(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=g_(n.props.children,i)),r.push(o)}),r}var Z1="get",ey="application/x-www-form-urlencoded";function n2(t){return t!=null&&typeof t.tagName=="string"}function vK(t){return n2(t)&&t.tagName.toLowerCase()==="button"}function yK(t){return n2(t)&&t.tagName.toLowerCase()==="form"}function bK(t){return n2(t)&&t.tagName.toLowerCase()==="input"}function wK(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function NK(t,e){return t.button===0&&(!e||e==="_self")&&!wK(t)}var Fv=null;function CK(){if(Fv===null)try{new FormData(document.createElement("form"),0),Fv=!1}catch{Fv=!0}return Fv}var _K=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function qw(t){return t!=null&&!_K.has(t)?(Kl(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ey}"`),null):t}function EK(t,e){let r,n,s,i,o;if(yK(t)){let l=t.getAttribute("action");n=l?Ed(l,e):null,r=t.getAttribute("method")||Z1,s=qw(t.getAttribute("enctype"))||ey,i=new FormData(t)}else if(vK(t)||bK(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?Ed(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||Z1,s=qw(t.getAttribute("formenctype"))||qw(l.getAttribute("enctype"))||ey,i=new FormData(l,t),!CK()){let{name:d,type:A,value:u}=t;if(A==="image"){let f=d?`${d}.`:"";i.append(`${f}x`,"0"),i.append(`${f}y`,"0")}else d&&i.append(d,u)}}else{if(n2(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Z1,n=null,s=ey,o=t}return i&&s==="text/plain"&&(o=i,i=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function QB(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function BK(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&Ed(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function SK(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function IK(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function jK(t,e,r){let n=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await SK(i,r);return o.links?o.links():[]}return[]}));return PK(n.flat(1).filter(IK).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function H4(t,e,r,n,s,i){let o=(c,d)=>r[d]?c.route.id!==r[d].route.id:!0,l=(c,d)=>{var A;return r[d].pathname!==c.pathname||((A=r[d].route.path)==null?void 0:A.endsWith("*"))&&r[d].params["*"]!==c.params["*"]};return i==="assets"?e.filter((c,d)=>o(c,d)||l(c,d)):i==="data"?e.filter((c,d)=>{var u;let A=n.routes[c.route.id];if(!A||!A.hasLoader)return!1;if(o(c,d)||l(c,d))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((u=r[0])==null?void 0:u.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function kK(t,e,{includeHydrateFallback:r}={}){return FK(t.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function FK(t){return[...new Set(t)]}function TK(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function PK(t,e){let r=new Set;return new Set(e),t.reduce((n,s)=>{let i=JSON.stringify(TK(s));return r.has(i)||(r.add(i),n.push({key:i,link:s})),n},[])}function ZD(){let t=N.useContext(Y0);return QB(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function RK(){let t=N.useContext(r2);return QB(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var VB=N.createContext(void 0);VB.displayName="FrameworkContext";function eL(){let t=N.useContext(VB);return QB(t,"You must render this element inside a <HydratedRouter> element"),t}function DK(t,e){let r=N.useContext(VB),[n,s]=N.useState(!1),[i,o]=N.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:d,onMouseLeave:A,onTouchStart:u}=e,f=N.useRef(null);N.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let p=x=>{x.forEach(b=>{o(b.isIntersecting)})},g=new IntersectionObserver(p,{threshold:.5});return f.current&&g.observe(f.current),()=>{g.disconnect()}}},[t]),N.useEffect(()=>{if(n){let p=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(p)}}},[n]);let h=()=>{s(!0)},m=()=>{s(!1),o(!1)};return r?t!=="intent"?[i,f,{}]:[i,f,{onFocus:Hm(l,h),onBlur:Hm(c,m),onMouseEnter:Hm(d,h),onMouseLeave:Hm(A,m),onTouchStart:Hm(u,h)}]:[!1,f,{}]}function Hm(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function LK({page:t,...e}){let{router:r}=ZD(),n=N.useMemo(()=>HD(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?N.createElement(OK,{page:t,matches:n,...e}):null}function UK(t){let{manifest:e,routeModules:r}=eL(),[n,s]=N.useState([]);return N.useEffect(()=>{let i=!1;return jK(t,e,r).then(o=>{i||s(o)}),()=>{i=!0}},[t,e,r]),n}function OK({page:t,matches:e,...r}){let n=xu(),{manifest:s,routeModules:i}=eL(),{basename:o}=ZD(),{loaderData:l,matches:c}=RK(),d=N.useMemo(()=>H4(t,e,c,s,n,"data"),[t,e,c,s,n]),A=N.useMemo(()=>H4(t,e,c,s,n,"assets"),[t,e,c,s,n]),u=N.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let m=new Set,p=!1;if(e.forEach(x=>{var w;let b=s.routes[x.route.id];!b||!b.hasLoader||(!d.some(k=>k.route.id===x.route.id)&&x.route.id in l&&((w=i[x.route.id])!=null&&w.shouldRevalidate)||b.hasClientLoader?p=!0:m.add(x.route.id))}),m.size===0)return[];let g=BK(t,o,"data");return p&&m.size>0&&g.searchParams.set("_routes",e.filter(x=>m.has(x.route.id)).map(x=>x.route.id).join(",")),[g.pathname+g.search]},[o,l,n,s,d,e,t,i]),f=N.useMemo(()=>kK(A,s),[A,s]),h=UK(A);return N.createElement(N.Fragment,null,u.map(m=>N.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...r})),f.map(m=>N.createElement("link",{key:m,rel:"modulepreload",href:m,...r})),h.map(({key:m,link:p})=>N.createElement("link",{key:m,nonce:r.nonce,...p})))}function MK(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var tL=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{tL&&(window.__reactRouterVersion="7.8.1")}catch{}function QK({basename:t,children:e,window:r}){let n=N.useRef();n.current==null&&(n.current=BH({window:r,v5Compat:!0}));let s=n.current,[i,o]=N.useState({action:s.action,location:s.location}),l=N.useCallback(c=>{N.startTransition(()=>o(c))},[o]);return N.useLayoutEffect(()=>s.listen(l),[s,l]),N.createElement(gK,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var rL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nL=N.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:s,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:A,viewTransition:u,...f},h){let{basename:m}=N.useContext(zl),p=typeof d=="string"&&rL.test(d),g,x=!1;if(typeof d=="string"&&p&&(g=d,tL))try{let S=new URL(window.location.href),U=d.startsWith("//")?new URL(S.protocol+d):new URL(d),_=Ed(U.pathname,m);U.origin===S.origin&&_!=null?d=_+U.search+U.hash:x=!0}catch{Kl(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=eK(d,{relative:s}),[w,k,O]=DK(n,f),L=KK(d,{replace:o,state:l,target:c,preventScrollReset:A,relative:s,viewTransition:u});function E(S){e&&e(S),S.defaultPrevented||L(S)}let B=N.createElement("a",{...f,...O,href:g||b,onClick:x||i?e:E,ref:MK(h,k),target:c,"data-discover":!p&&r==="render"?"true":void 0});return w&&!p?N.createElement(N.Fragment,null,B,N.createElement(LK,{page:b})):B});nL.displayName="Link";var Br=N.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:s=!1,style:i,to:o,viewTransition:l,children:c,...d},A){let u=wx(o,{relative:d.relative}),f=xu(),h=N.useContext(r2),{navigator:m,basename:p}=N.useContext(zl),g=h!=null&&WK(u)&&l===!0,x=m.encodeLocation?m.encodeLocation(u).pathname:u.pathname,b=f.pathname,w=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(b=b.toLowerCase(),w=w?w.toLowerCase():null,x=x.toLowerCase()),w&&p&&(w=Ed(w,p)||w);const k=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let O=b===x||!s&&b.startsWith(x)&&b.charAt(k)==="/",L=w!=null&&(w===x||!s&&w.startsWith(x)&&w.charAt(x.length)==="/"),E={isActive:O,isPending:L,isTransitioning:g},B=O?e:void 0,S;typeof n=="function"?S=n(E):S=[n,O?"active":null,L?"pending":null,g?"transitioning":null].filter(Boolean).join(" ");let U=typeof i=="function"?i(E):i;return N.createElement(nL,{...d,"aria-current":B,className:S,ref:A,style:U,to:o,viewTransition:l},typeof c=="function"?c(E):c)});Br.displayName="NavLink";var VK=N.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:s,state:i,method:o=Z1,action:l,onSubmit:c,relative:d,preventScrollReset:A,viewTransition:u,...f},h)=>{let m=$K(),p=zK(l,{relative:d}),g=o.toLowerCase()==="get"?"get":"post",x=typeof l=="string"&&rL.test(l),b=w=>{if(c&&c(w),w.defaultPrevented)return;w.preventDefault();let k=w.nativeEvent.submitter,O=(k==null?void 0:k.getAttribute("formmethod"))||o;m(k||w.currentTarget,{fetcherKey:e,method:O,navigate:r,replace:s,state:i,relative:d,preventScrollReset:A,viewTransition:u})};return N.createElement("form",{ref:h,method:g,action:p,onSubmit:n?c:b,...f,"data-discover":!x&&t==="render"?"true":void 0})});VK.displayName="Form";function HK(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function sL(t){let e=N.useContext(Y0);return hs(e,HK(t)),e}function KK(t,{target:e,replace:r,state:n,preventScrollReset:s,relative:i,viewTransition:o}={}){let l=bx(),c=xu(),d=wx(t,{relative:i});return N.useCallback(A=>{if(NK(A,e)){A.preventDefault();let u=r!==void 0?r:jg(c)===jg(d);l(t,{replace:u,state:n,preventScrollReset:s,relative:i,viewTransition:o})}},[c,l,d,r,n,e,t,s,i,o])}var qK=0,GK=()=>`__${String(++qK)}__`;function $K(){let{router:t}=sL("useSubmit"),{basename:e}=N.useContext(zl),r=hK();return N.useCallback(async(n,s={})=>{let{action:i,method:o,encType:l,formData:c,body:d}=EK(n,e);if(s.navigate===!1){let A=s.fetcherKey||GK();await t.fetch(A,r,s.action||i,{preventScrollReset:s.preventScrollReset,formData:c,body:d,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:c,body:d,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,r])}function zK(t,{relative:e}={}){let{basename:r}=N.useContext(zl),n=N.useContext(Wl);hs(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),i={...wx(t||".",{relative:e})},o=xu();if(t==null){i.search=o.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(A=>A==="")){l.delete("index"),c.filter(u=>u).forEach(u=>l.append("index",u));let A=l.toString();i.search=A?`?${A}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:hd([r,i.pathname])),jg(i)}function WK(t,{relative:e}={}){let r=N.useContext($D);hs(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=sL("useViewTransitionState"),s=wx(t,{relative:e});if(!r.isTransitioning)return!1;let i=Ed(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Ed(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Ky(s.pathname,o)!=null||Ky(s.pathname,i)!=null}var K4={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aL=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},JK=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],o=t[r++],l=t[r++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const i=t[r++],o=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},iL={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,A=i>>2,u=(i&3)<<4|l>>4;let f=(l&15)<<2|d>>6,h=d&63;c||(h=64,o||(f=64)),n.push(r[A],r[u],r[f],r[h])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(aL(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):JK(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],l=s<t.length?r[t.charAt(s)]:0;++s;const d=s<t.length?r[t.charAt(s)]:64;++s;const u=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||u==null)throw new XK;const f=i<<2|l>>4;if(n.push(f),d!==64){const h=l<<4&240|d>>2;if(n.push(h),u!==64){const m=d<<6&192|u;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class XK extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const YK=function(t){const e=aL(t);return iL.encodeByteArray(e,!0)},qy=function(t){return YK(t).replace(/\./g,"")},oL=function(t){try{return iL.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZK(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eq=()=>ZK().__FIREBASE_DEFAULTS__,tq=()=>{if(typeof process>"u"||typeof K4>"u")return;const t=K4.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},rq=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&oL(t[1]);return e&&JSON.parse(e)},s2=()=>{try{return eq()||tq()||rq()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},lL=t=>{var e,r;return(r=(e=s2())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},nq=t=>{const e=lL(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},cL=()=>{var t;return(t=s2())===null||t===void 0?void 0:t.config},dL=t=>{var e;return(e=s2())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sq{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aq(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[qy(JSON.stringify(r)),qy(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ga(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function iq(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ga())}function oq(){var t;const e=(t=s2())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function lq(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function cq(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function dq(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Aq(){const t=ga();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function AL(){return!oq()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function uL(){try{return typeof indexedDB=="object"}catch{return!1}}function uq(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hq="FirebaseError";class Td extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=hq,Object.setPrototypeOf(this,Td.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Nx.prototype.create)}}class Nx{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?fq(i,n):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Td(s,l,n)}}function fq(t,e){return t.replace(mq,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const mq=/\{\$([^}]+)}/g;function pq(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Gy(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],o=e[s];if(q4(i)&&q4(o)){if(!Gy(i,o))return!1}else if(i!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function q4(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cx(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function fp(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function mp(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function gq(t,e){const r=new xq(t,e);return r.subscribe.bind(r)}class xq{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");vq(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=Gw),s.error===void 0&&(s.error=Gw),s.complete===void 0&&(s.complete=Gw);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function vq(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Gw(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ps(t){return t&&t._delegate?t._delegate:t}class Eh{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qu="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yq{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new sq;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(wq(e))try{this.getOrInitializeService({instanceIdentifier:qu})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=qu){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=qu){return this.instances.has(e)}getOptions(e=qu){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);n===l&&o.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),i=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:bq(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=qu){return this.component?this.component.multipleInstances?e:qu:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function bq(t){return t===qu?void 0:t}function wq(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nq{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new yq(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(rn||(rn={}));const Cq={debug:rn.DEBUG,verbose:rn.VERBOSE,info:rn.INFO,warn:rn.WARN,error:rn.ERROR,silent:rn.SILENT},_q=rn.INFO,Eq={[rn.DEBUG]:"log",[rn.VERBOSE]:"log",[rn.INFO]:"info",[rn.WARN]:"warn",[rn.ERROR]:"error"},Bq=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=Eq[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let HB=class{constructor(e){this.name=e,this._logLevel=_q,this._logHandler=Bq,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in rn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Cq[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,rn.DEBUG,...e),this._logHandler(this,rn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,rn.VERBOSE,...e),this._logHandler(this,rn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,rn.INFO,...e),this._logHandler(this,rn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,rn.WARN,...e),this._logHandler(this,rn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,rn.ERROR,...e),this._logHandler(this,rn.ERROR,...e)}};const Sq=(t,e)=>e.some(r=>t instanceof r);let G4,$4;function Iq(){return G4||(G4=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function jq(){return $4||($4=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const hL=new WeakMap,x_=new WeakMap,fL=new WeakMap,$w=new WeakMap,KB=new WeakMap;function kq(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{r(zA(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&hL.set(r,t)}).catch(()=>{}),KB.set(e,t),e}function Fq(t){if(x_.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{r(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});x_.set(t,e)}let v_={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return x_.get(t);if(e==="objectStoreNames")return t.objectStoreNames||fL.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return zA(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Tq(t){v_=t(v_)}function Pq(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(zw(this),e,...r);return fL.set(n,e.sort?e.sort():[e]),zA(n)}:jq().includes(t)?function(...e){return t.apply(zw(this),e),zA(hL.get(this))}:function(...e){return zA(t.apply(zw(this),e))}}function Rq(t){return typeof t=="function"?Pq(t):(t instanceof IDBTransaction&&Fq(t),Sq(t,Iq())?new Proxy(t,v_):t)}function zA(t){if(t instanceof IDBRequest)return kq(t);if($w.has(t))return $w.get(t);const e=Rq(t);return e!==t&&($w.set(t,e),KB.set(e,t)),e}const zw=t=>KB.get(t);function Dq(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=zA(o);return n&&o.addEventListener("upgradeneeded",c=>{n(zA(o.result),c.oldVersion,c.newVersion,zA(o.transaction),c)}),r&&o.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const Lq=["get","getKey","getAll","getAllKeys","count"],Uq=["put","add","delete","clear"],Ww=new Map;function z4(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ww.get(e))return Ww.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=Uq.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||Lq.includes(r)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return n&&(d=d.index(l.shift())),(await Promise.all([d[r](...l),s&&c.done]))[0]};return Ww.set(e,i),i}Tq(t=>({...t,get:(e,r,n)=>z4(e,r)||t.get(e,r,n),has:(e,r)=>!!z4(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oq{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Mq(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Mq(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const y_="@firebase/app",W4="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bd=new HB("@firebase/app"),Qq="@firebase/app-compat",Vq="@firebase/analytics-compat",Hq="@firebase/analytics",Kq="@firebase/app-check-compat",qq="@firebase/app-check",Gq="@firebase/auth",$q="@firebase/auth-compat",zq="@firebase/database",Wq="@firebase/data-connect",Jq="@firebase/database-compat",Xq="@firebase/functions",Yq="@firebase/functions-compat",Zq="@firebase/installations",eG="@firebase/installations-compat",tG="@firebase/messaging",rG="@firebase/messaging-compat",nG="@firebase/performance",sG="@firebase/performance-compat",aG="@firebase/remote-config",iG="@firebase/remote-config-compat",oG="@firebase/storage",lG="@firebase/storage-compat",cG="@firebase/firestore",dG="@firebase/vertexai-preview",AG="@firebase/firestore-compat",uG="firebase",hG="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b_="[DEFAULT]",fG={[y_]:"fire-core",[Qq]:"fire-core-compat",[Hq]:"fire-analytics",[Vq]:"fire-analytics-compat",[qq]:"fire-app-check",[Kq]:"fire-app-check-compat",[Gq]:"fire-auth",[$q]:"fire-auth-compat",[zq]:"fire-rtdb",[Wq]:"fire-data-connect",[Jq]:"fire-rtdb-compat",[Xq]:"fire-fn",[Yq]:"fire-fn-compat",[Zq]:"fire-iid",[eG]:"fire-iid-compat",[tG]:"fire-fcm",[rG]:"fire-fcm-compat",[nG]:"fire-perf",[sG]:"fire-perf-compat",[aG]:"fire-rc",[iG]:"fire-rc-compat",[oG]:"fire-gcs",[lG]:"fire-gcs-compat",[cG]:"fire-fst",[AG]:"fire-fst-compat",[dG]:"fire-vertex","fire-js":"fire-js",[uG]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T0=new Map,w_=new Map,N_=new Map;function J4(t,e){try{t.container.addComponent(e)}catch(r){Bd.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function P0(t){const e=t.name;if(N_.has(e))return Bd.debug(`There were multiple attempts to register component ${e}.`),!1;N_.set(e,t);for(const r of T0.values())J4(r,t);for(const r of w_.values())J4(r,t);return!0}function qB(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function xc(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mG={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},WA=new Nx("app","Firebase",mG);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pG{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Eh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw WA.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const em=hG;function GB(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:b_,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw WA.create("bad-app-name",{appName:String(s)});if(r||(r=cL()),!r)throw WA.create("no-options");const i=T0.get(s);if(i){if(Gy(r,i.options)&&Gy(n,i.config))return i;throw WA.create("duplicate-app",{appName:s})}const o=new Nq(s);for(const c of N_.values())o.addComponent(c);const l=new pG(r,n,o);return T0.set(s,l),l}function $B(t=b_){const e=T0.get(t);if(!e&&t===b_&&cL())return GB();if(!e)throw WA.create("no-app",{appName:t});return e}async function gG(t){let e=!1;const r=t.name;T0.has(r)?(e=!0,T0.delete(r)):w_.has(r)&&t.decRefCount()<=0&&(w_.delete(r),e=!0),e&&(await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function JA(t,e,r){var n;let s=(n=fG[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Bd.warn(l.join(" "));return}P0(new Eh(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xG="firebase-heartbeat-database",vG=1,kg="firebase-heartbeat-store";let Jw=null;function mL(){return Jw||(Jw=Dq(xG,vG,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(kg)}catch(r){console.warn(r)}}}}).catch(t=>{throw WA.create("idb-open",{originalErrorMessage:t.message})})),Jw}async function yG(t){try{const r=(await mL()).transaction(kg),n=await r.objectStore(kg).get(pL(t));return await r.done,n}catch(e){if(e instanceof Td)Bd.warn(e.message);else{const r=WA.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Bd.warn(r.message)}}}async function X4(t,e){try{const n=(await mL()).transaction(kg,"readwrite");await n.objectStore(kg).put(e,pL(t)),await n.done}catch(r){if(r instanceof Td)Bd.warn(r.message);else{const n=WA.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Bd.warn(n.message)}}}function pL(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bG=1024,wG=30*24*60*60*1e3;class NG{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new _G(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Y4();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=wG}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Bd.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Y4(),{heartbeatsToSend:n,unsentEntries:s}=CG(this._heartbeatsCache.heartbeats),i=qy(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return Bd.warn(r),""}}}function Y4(){return new Date().toISOString().substring(0,10)}function CG(t,e=bG){const r=[];let n=t.slice();for(const s of t){const i=r.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Z4(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),Z4(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class _G{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return uL()?uq().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await yG(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return X4(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return X4(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Z4(t){return qy(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EG(t){P0(new Eh("platform-logger",e=>new Oq(e),"PRIVATE")),P0(new Eh("heartbeat",e=>new NG(e),"PRIVATE")),JA(y_,W4,t),JA(y_,W4,"esm2017"),JA("fire-js","")}EG("");function zB(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function gL(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const BG=gL,xL=new Nx("auth","Firebase",gL());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y=new HB("@firebase/auth");function SG(t,...e){$y.logLevel<=rn.WARN&&$y.warn(`Auth (${em}): ${t}`,...e)}function ty(t,...e){$y.logLevel<=rn.ERROR&&$y.error(`Auth (${em}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ql(t,...e){throw WB(t,...e)}function _c(t,...e){return WB(t,...e)}function vL(t,e,r){const n=Object.assign(Object.assign({},BG()),{[e]:r});return new Nx("auth","Firebase",n).create(e,{appName:t.name})}function fd(t){return vL(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function WB(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return xL.create(t,...e)}function jr(t,e,...r){if(!t)throw WB(e,...r)}function od(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ty(e),new Error(e)}function Sd(t,e){t||od(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function IG(){return ej()==="http:"||ej()==="https:"}function ej(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jG(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(IG()||cq()||"connection"in navigator)?navigator.onLine:!0}function kG(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(e,r){this.shortDelay=e,this.longDelay=r,Sd(r>e,"Short delay should be less than long delay!"),this.isMobile=iq()||dq()}get(){return jG()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JB(t,e){Sd(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;od("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;od("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;od("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FG={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TG=new _x(3e4,6e4);function vu(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function yu(t,e,r,n,s={}){return bL(t,s,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const l=Cx(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:c},i);return lq()||(d.referrerPolicy="no-referrer"),yL.fetch()(wL(t,t.config.apiHost,r,l),d)})}async function bL(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},FG),e);try{const s=new RG(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Tv(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,d]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Tv(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Tv(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Tv(t,"user-disabled",o);const A=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw vL(t,A,d);ql(t,A)}}catch(s){if(s instanceof Td)throw s;ql(t,"network-request-failed",{message:String(s)})}}async function Ex(t,e,r,n,s={}){const i=await yu(t,e,r,n,s);return"mfaPendingCredential"in i&&ql(t,"multi-factor-auth-required",{_serverResponse:i}),i}function wL(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?JB(t.config,s):`${t.config.apiScheme}://${s}`}function PG(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class RG{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(_c(this.auth,"network-request-failed")),TG.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Tv(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=_c(t,e,n);return s.customData._tokenResponse=r,s}function tj(t){return t!==void 0&&t.enterprise!==void 0}class DG{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return PG(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function LG(t,e){return yu(t,"GET","/v2/recaptchaConfig",vu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UG(t,e){return yu(t,"POST","/v1/accounts:delete",e)}async function NL(t,e){return yu(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mp(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function OG(t,e=!1){const r=Ps(t),n=await r.getIdToken(e),s=XB(n);jr(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:Mp(Xw(s.auth_time)),issuedAtTime:Mp(Xw(s.iat)),expirationTime:Mp(Xw(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Xw(t){return Number(t)*1e3}function XB(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return ty("JWT malformed, contained fewer than 3 sections"),null;try{const s=oL(r);return s?JSON.parse(s):(ty("Failed to decode base64 JWT payload"),null)}catch(s){return ty("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function rj(t){const e=XB(t);return jr(e,"internal-error"),jr(typeof e.exp<"u","internal-error"),jr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fg(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Td&&MG(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function MG({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QG{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Mp(this.lastLoginAt),this.creationTime=Mp(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zy(t){var e;const r=t.auth,n=await t.getIdToken(),s=await Fg(t,NL(r,{idToken:n}));jr(s==null?void 0:s.users.length,r,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?CL(i.providerUserInfo):[],l=HG(t.providerData,o),c=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),A=c?d:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new __(i.createdAt,i.lastLoginAt),isAnonymous:A};Object.assign(t,u)}async function VG(t){const e=Ps(t);await zy(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function HG(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function CL(t){return t.map(e=>{var{providerId:r}=e,n=zB(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KG(t,e){const r=await bL(t,{},async()=>{const n=Cx({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=wL(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",yL.fetch()(o,{method:"POST",headers:l,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function qG(t,e){return yu(t,"POST","/v2/accounts:revokeToken",vu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){jr(e.idToken,"internal-error"),jr(typeof e.idToken<"u","internal-error"),jr(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):rj(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){jr(e.length!==0,"internal-error");const r=rj(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(jr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await KG(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,o=new g0;return n&&(jr(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(jr(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(jr(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new g0,this.toJSON())}_performRefresh(){return od("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aA(t,e){jr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ld{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,i=zB(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new QG(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new __(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Fg(this,this.stsTokenManager.getToken(this.auth,e));return jr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return OG(this,e)}reload(){return VG(this)}_assign(e){this!==e&&(jr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new ld(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){jr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await zy(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xc(this.auth.app))return Promise.reject(fd(this.auth));const e=await this.getIdToken();return await Fg(this,UG(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,i,o,l,c,d,A;const u=(n=r.displayName)!==null&&n!==void 0?n:void 0,f=(s=r.email)!==null&&s!==void 0?s:void 0,h=(i=r.phoneNumber)!==null&&i!==void 0?i:void 0,m=(o=r.photoURL)!==null&&o!==void 0?o:void 0,p=(l=r.tenantId)!==null&&l!==void 0?l:void 0,g=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,x=(d=r.createdAt)!==null&&d!==void 0?d:void 0,b=(A=r.lastLoginAt)!==null&&A!==void 0?A:void 0,{uid:w,emailVerified:k,isAnonymous:O,providerData:L,stsTokenManager:E}=r;jr(w&&E,e,"internal-error");const B=g0.fromJSON(this.name,E);jr(typeof w=="string",e,"internal-error"),aA(u,e.name),aA(f,e.name),jr(typeof k=="boolean",e,"internal-error"),jr(typeof O=="boolean",e,"internal-error"),aA(h,e.name),aA(m,e.name),aA(p,e.name),aA(g,e.name),aA(x,e.name),aA(b,e.name);const S=new ld({uid:w,auth:e,email:f,emailVerified:k,displayName:u,isAnonymous:O,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:B,createdAt:x,lastLoginAt:b});return L&&Array.isArray(L)&&(S.providerData=L.map(U=>Object.assign({},U))),g&&(S._redirectEventId=g),S}static async _fromIdTokenResponse(e,r,n=!1){const s=new g0;s.updateFromServerResponse(r);const i=new ld({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await zy(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];jr(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?CL(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new g0;l.updateFromIdToken(n);const c=new ld({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new __(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nj=new Map;function cd(t){Sd(t instanceof Function,"Expected a class definition");let e=nj.get(t);return e?(Sd(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,nj.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}_L.type="NONE";const sj=_L;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ry(t,e,r){return`firebase:${t}:${e}:${r}`}class x0{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=ry(this.userKey,s.apiKey,i),this.fullPersistenceKey=ry("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ld._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new x0(cd(sj),e,n);const s=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||cd(sj);const o=ry(n,e.config.apiKey,e.name);let l=null;for(const d of r)try{const A=await d._get(o);if(A){const u=ld._fromJSON(e,A);d!==i&&(l=u),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new x0(i,e,n):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(r.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new x0(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aj(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(IL(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(EL(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(kL(e))return"Blackberry";if(FL(e))return"Webos";if(BL(e))return"Safari";if((e.includes("chrome/")||SL(e))&&!e.includes("edge/"))return"Chrome";if(jL(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function EL(t=ga()){return/firefox\//i.test(t)}function BL(t=ga()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function SL(t=ga()){return/crios\//i.test(t)}function IL(t=ga()){return/iemobile/i.test(t)}function jL(t=ga()){return/android/i.test(t)}function kL(t=ga()){return/blackberry/i.test(t)}function FL(t=ga()){return/webos/i.test(t)}function YB(t=ga()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function GG(t=ga()){var e;return YB(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function $G(){return Aq()&&document.documentMode===10}function TL(t=ga()){return YB(t)||jL(t)||FL(t)||kL(t)||/windows phone/i.test(t)||IL(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PL(t,e=[]){let r;switch(t){case"Browser":r=aj(ga());break;case"Worker":r=`${aj(ga())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${em}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zG{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WG(t,e={}){return yu(t,"GET","/v2/passwordPolicy",vu(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JG=6;class XG{constructor(e){var r,n,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:JG,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YG{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ij(this),this.idTokenSubscription=new ij(this),this.beforeStateQueue=new zG(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xL,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=cd(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await x0.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await NL(this,{idToken:e}),n=await ld._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(xc(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return jr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await zy(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=kG()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(xc(this.app))return Promise.reject(fd(this));const r=e?Ps(e):null;return r&&jr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&jr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return xc(this.app)?Promise.reject(fd(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return xc(this.app)?Promise.reject(fd(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(cd(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await WG(this),r=new XG(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Nx("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await qG(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&cd(e)||this._popupRedirectResolver;jr(r,this,"argument-error"),this.redirectPersistenceManager=await x0.create(this,[cd(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(jr(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,s);return()=>{o=!0,c()}}else{const c=e.addObserver(r);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return jr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=PL(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&SG(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function qh(t){return Ps(t)}class ij{constructor(e){this.auth=e,this.observer=null,this.addObserver=gq(r=>this.observer=r)}get next(){return jr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a2={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ZG(t){a2=t}function RL(t){return a2.loadJS(t)}function e$(){return a2.recaptchaEnterpriseScript}function t$(){return a2.gapiScript}function r$(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const n$="recaptcha-enterprise",s$="NO_RECAPTCHA";class a${constructor(e){this.type=n$,this.auth=qh(e)}async verify(e="verify",r=!1){async function n(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{LG(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new DG(c);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;tj(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(s$)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{n(this.auth).then(l=>{if(!r&&tj(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=e$();c.length!==0&&(c+=l),RL(c).then(()=>{s(l,i,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function oj(t,e,r,n=!1){const s=new a$(t);let i;try{i=await s.verify(r)}catch{i=await s.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function E_(t,e,r,n){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await oj(t,e,r,r==="getOobCode");return n(t,i)}else return n(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await oj(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i$(t,e){const r=qB(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(Gy(i,e??{}))return s;ql(s,"already-initialized")}return r.initialize({options:e})}function o$(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(cd);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function l$(t,e,r){const n=qh(t);jr(n._canInitEmulator,n,"emulator-config-failed"),jr(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=DL(e),{host:o,port:l}=c$(e),c=l===null?"":`:${l}`;n.config.emulator={url:`${i}//${o}${c}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),d$()}function DL(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function c$(t){const e=DL(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:lj(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:lj(o)}}}function lj(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function d$(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZB{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return od("not implemented")}_getIdTokenResponse(e){return od("not implemented")}_linkToIdToken(e,r){return od("not implemented")}_getReauthenticationResolver(e){return od("not implemented")}}async function A$(t,e){return yu(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u$(t,e){return Ex(t,"POST","/v1/accounts:signInWithPassword",vu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h$(t,e){return Ex(t,"POST","/v1/accounts:signInWithEmailLink",vu(t,e))}async function f$(t,e){return Ex(t,"POST","/v1/accounts:signInWithEmailLink",vu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg extends ZB{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new Tg(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Tg(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return E_(e,r,"signInWithPassword",u$);case"emailLink":return h$(e,{email:this._email,oobCode:this._password});default:ql(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return E_(e,n,"signUpPassword",A$);case"emailLink":return f$(e,{idToken:r,email:this._email,oobCode:this._password});default:ql(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v0(t,e){return Ex(t,"POST","/v1/accounts:signInWithIdp",vu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m$="http://localhost";class Bh extends ZB{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Bh(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ql("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,i=zB(r,["providerId","signInMethod"]);if(!n||!s)return null;const o=new Bh(n,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return v0(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,v0(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,v0(e,r)}buildRequest(){const e={requestUri:m$,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Cx(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p$(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function g$(t){const e=fp(mp(t)).link,r=e?fp(mp(e)).deep_link_id:null,n=fp(mp(t)).deep_link_id;return(n?fp(mp(n)).link:null)||n||r||e||t}class eS{constructor(e){var r,n,s,i,o,l;const c=fp(mp(e)),d=(r=c.apiKey)!==null&&r!==void 0?r:null,A=(n=c.oobCode)!==null&&n!==void 0?n:null,u=p$((s=c.mode)!==null&&s!==void 0?s:null);jr(d&&A&&u,"argument-error"),this.apiKey=d,this.operation=u,this.code=A,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=g$(e);try{return new eS(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(){this.providerId=tm.PROVIDER_ID}static credential(e,r){return Tg._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=eS.parseLink(r);return jr(n,"argument-error"),Tg._fromEmailAndCode(e,n.code,n.tenantId)}}tm.PROVIDER_ID="password";tm.EMAIL_PASSWORD_SIGN_IN_METHOD="password";tm.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx extends LL{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA extends Bx{constructor(){super("facebook.com")}static credential(e){return Bh._fromParams({providerId:NA.PROVIDER_ID,signInMethod:NA.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return NA.credentialFromTaggedObject(e)}static credentialFromError(e){return NA.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return NA.credential(e.oauthAccessToken)}catch{return null}}}NA.FACEBOOK_SIGN_IN_METHOD="facebook.com";NA.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA extends Bx{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Bh._fromParams({providerId:CA.PROVIDER_ID,signInMethod:CA.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return CA.credentialFromTaggedObject(e)}static credentialFromError(e){return CA.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return CA.credential(r,n)}catch{return null}}}CA.GOOGLE_SIGN_IN_METHOD="google.com";CA.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A extends Bx{constructor(){super("github.com")}static credential(e){return Bh._fromParams({providerId:_A.PROVIDER_ID,signInMethod:_A.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _A.credentialFromTaggedObject(e)}static credentialFromError(e){return _A.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _A.credential(e.oauthAccessToken)}catch{return null}}}_A.GITHUB_SIGN_IN_METHOD="github.com";_A.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA extends Bx{constructor(){super("twitter.com")}static credential(e,r){return Bh._fromParams({providerId:EA.PROVIDER_ID,signInMethod:EA.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return EA.credentialFromTaggedObject(e)}static credentialFromError(e){return EA.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return EA.credential(r,n)}catch{return null}}}EA.TWITTER_SIGN_IN_METHOD="twitter.com";EA.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x$(t,e){return Ex(t,"POST","/v1/accounts:signUp",vu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await ld._fromIdTokenResponse(e,n,s),o=cj(n);return new Sh({user:i,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=cj(n);return new Sh({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function cj(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy extends Td{constructor(e,r,n,s){var i;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Wy.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new Wy(e,r,n,s)}}function UL(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Wy._fromErrorAndOperation(t,i,e,n):i})}async function v$(t,e,r=!1){const n=await Fg(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Sh._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y$(t,e,r=!1){const{auth:n}=t;if(xc(n.app))return Promise.reject(fd(n));const s="reauthenticate";try{const i=await Fg(t,UL(n,s,e,t),r);jr(i.idToken,n,"internal-error");const o=XB(i.idToken);jr(o,n,"internal-error");const{sub:l}=o;return jr(t.uid===l,n,"user-mismatch"),Sh._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ql(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OL(t,e,r=!1){if(xc(t.app))return Promise.reject(fd(t));const n="signIn",s=await UL(t,n,e),i=await Sh._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}async function b$(t,e){return OL(qh(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ML(t){const e=qh(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function w$(t,e,r){if(xc(t.app))return Promise.reject(fd(t));const n=qh(t),o=await E_(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",x$).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&ML(t),c}),l=await Sh._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function N$(t,e,r){return xc(t.app)?Promise.reject(fd(t)):b$(Ps(t),tm.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&ML(t),n})}function C$(t,e,r,n){return Ps(t).onIdTokenChanged(e,r,n)}function _$(t,e,r){return Ps(t).beforeAuthStateChanged(e,r)}function QL(t,e,r,n){return Ps(t).onAuthStateChanged(e,r,n)}function tS(t){return Ps(t).signOut()}const Jy="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VL{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Jy,"1"),this.storage.removeItem(Jy),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E$=1e3,B$=10;class HL extends VL{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=TL(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);$G()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,B$):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},E$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}HL.type="LOCAL";const S$=HL;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KL extends VL{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}KL.type="SESSION";const qL=KL;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I$(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new i2(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const l=Array.from(o).map(async d=>d(r.origin,i)),c=await I$(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}i2.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j${constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const d=rS("",20);s.port1.start();const A=setTimeout(()=>{c(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(u){const f=u;if(f.data.eventId===d)switch(f.data.status){case"ack":clearTimeout(A),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(f.data.response);break;default:clearTimeout(A),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ec(){return window}function k$(t){Ec().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GL(){return typeof Ec().WorkerGlobalScope<"u"&&typeof Ec().importScripts=="function"}async function F$(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function T$(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function P$(){return GL()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $L="firebaseLocalStorageDb",R$=1,Xy="firebaseLocalStorage",zL="fbase_key";class Sx{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function o2(t,e){return t.transaction([Xy],e?"readwrite":"readonly").objectStore(Xy)}function D$(){const t=indexedDB.deleteDatabase($L);return new Sx(t).toPromise()}function B_(){const t=indexedDB.open($L,R$);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Xy,{keyPath:zL})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Xy)?e(n):(n.close(),await D$(),e(await B_()))})})}async function dj(t,e,r){const n=o2(t,!0).put({[zL]:e,value:r});return new Sx(n).toPromise()}async function L$(t,e){const r=o2(t,!1).get(e),n=await new Sx(r).toPromise();return n===void 0?null:n.value}function Aj(t,e){const r=o2(t,!0).delete(e);return new Sx(r).toPromise()}const U$=800,O$=3;class WL{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await B_(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>O$)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return GL()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=i2._getInstance(P$()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await F$(),!this.activeServiceWorker)return;this.sender=new j$(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||T$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await B_();return await dj(e,Jy,"1"),await Aj(e,Jy),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>dj(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>L$(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Aj(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=o2(s,!1).getAll();return new Sx(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),U$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}WL.type="LOCAL";const M$=WL;new _x(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q$(t,e){return e?cd(e):(jr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS extends ZB{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return v0(e,this._buildIdpRequest())}_linkToIdToken(e,r){return v0(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return v0(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function V$(t){return OL(t.auth,new nS(t),t.bypassAuthState)}function H$(t){const{auth:e,user:r}=t;return jr(r,e,"internal-error"),y$(r,new nS(t),t.bypassAuthState)}async function K$(t){const{auth:e,user:r}=t;return jr(r,e,"internal-error"),v$(r,new nS(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return V$;case"linkViaPopup":case"linkViaRedirect":return K$;case"reauthViaPopup":case"reauthViaRedirect":return H$;default:ql(this.auth,"internal-error")}}resolve(e){Sd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Sd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q$=new _x(2e3,1e4);class l0 extends JL{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,l0.currentPopupAction&&l0.currentPopupAction.cancel(),l0.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return jr(e,this.auth,"internal-error"),e}async onExecution(){Sd(this.filter.length===1,"Popup operations only handle one event");const e=rS();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(_c(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_c(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,l0.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_c(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,q$.get())};e()}}l0.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G$="pendingRedirect",ny=new Map;class $$ extends JL{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=ny.get(this.auth._key());if(!e){try{const n=await z$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}ny.set(this.auth._key(),e)}return this.bypassAuthState||ny.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function z$(t,e){const r=X$(e),n=J$(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function W$(t,e){ny.set(t._key(),e)}function J$(t){return cd(t._redirectPersistence)}function X$(t){return ry(G$,t.config.apiKey,t.name)}async function Y$(t,e,r=!1){if(xc(t.app))return Promise.reject(fd(t));const n=qh(t),s=Q$(n,e),o=await new $$(n,s,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z$=10*60*1e3;class ez{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!tz(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!XL(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(_c(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Z$&&this.cachedEventUids.clear(),this.cachedEventUids.has(uj(e))}saveEventToCache(e){this.cachedEventUids.add(uj(e)),this.lastProcessedEventTime=Date.now()}}function uj(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function XL({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function tz(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return XL(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rz(t,e={}){return yu(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nz=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,sz=/^https?/;async function az(t){if(t.config.emulator)return;const{authorizedDomains:e}=await rz(t);for(const r of e)try{if(iz(r))return}catch{}ql(t,"unauthorized-domain")}function iz(t){const e=C_(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!sz.test(r))return!1;if(nz.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oz=new _x(3e4,6e4);function hj(){const t=Ec().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function lz(t){return new Promise((e,r)=>{var n,s,i;function o(){hj(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{hj(),r(_c(t,"network-request-failed"))},timeout:oz.get()})}if(!((s=(n=Ec().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Ec().gapi)===null||i===void 0)&&i.load)o();else{const l=r$("iframefcb");return Ec()[l]=()=>{gapi.load?o():r(_c(t,"network-request-failed"))},RL(`${t$()}?onload=${l}`).catch(c=>r(c))}}).catch(e=>{throw sy=null,e})}let sy=null;function cz(t){return sy=sy||lz(t),sy}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dz=new _x(5e3,15e3),Az="__/auth/iframe",uz="emulator/auth/iframe",hz={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fz=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mz(t){const e=t.config;jr(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?JB(e,uz):`https://${t.config.authDomain}/${Az}`,n={apiKey:e.apiKey,appName:t.name,v:em},s=fz.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${Cx(n).slice(1)}`}async function pz(t){const e=await cz(t),r=Ec().gapi;return jr(r,t,"internal-error"),e.open({where:document.body,url:mz(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hz,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const o=_c(t,"network-request-failed"),l=Ec().setTimeout(()=>{i(o)},dz.get());function c(){Ec().clearTimeout(l),s(n)}n.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gz={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},xz=500,vz=600,yz="_blank",bz="http://localhost";class fj{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function wz(t,e,r,n=xz,s=vz){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c=Object.assign(Object.assign({},gz),{width:n.toString(),height:s.toString(),top:i,left:o}),d=ga().toLowerCase();r&&(l=SL(d)?yz:r),EL(d)&&(e=e||bz,c.scrollbars="yes");const A=Object.entries(c).reduce((f,[h,m])=>`${f}${h}=${m},`,"");if(GG(d)&&l!=="_self")return Nz(e||"",l),new fj(null);const u=window.open(e||"",l,A);jr(u,t,"popup-blocked");try{u.focus()}catch{}return new fj(u)}function Nz(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cz="__/auth/handler",_z="emulator/auth/handler",Ez=encodeURIComponent("fac");async function mj(t,e,r,n,s,i){jr(t.config.authDomain,t,"auth-domain-config-required"),jr(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:em,eventId:s};if(e instanceof LL){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",pq(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[A,u]of Object.entries({}))o[A]=u}if(e instanceof Bx){const A=e.getScopes().filter(u=>u!=="");A.length>0&&(o.scopes=A.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const A of Object.keys(l))l[A]===void 0&&delete l[A];const c=await t._getAppCheckToken(),d=c?`#${Ez}=${encodeURIComponent(c)}`:"";return`${Bz(t)}?${Cx(l).slice(1)}${d}`}function Bz({config:t}){return t.emulator?JB(t,_z):`https://${t.authDomain}/${Cz}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw="webStorageSupport";class Sz{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qL,this._completeRedirectFn=Y$,this._overrideRedirectResult=W$}async _openPopup(e,r,n,s){var i;Sd((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await mj(e,r,n,C_(),s);return wz(e,o,rS())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await mj(e,r,n,C_(),s);return k$(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(Sd(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await pz(e),n=new ez(e);return r.register("authEvent",s=>(jr(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Yw,{type:Yw},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Yw];o!==void 0&&r(!!o),ql(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=az(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return TL()||BL()||YB()}}const Iz=Sz;var pj="@firebase/auth",gj="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jz{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){jr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kz(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Fz(t){P0(new Eh("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;jr(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:PL(t)},d=new YG(n,s,i,c);return o$(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),P0(new Eh("auth-internal",e=>{const r=qh(e.getProvider("auth").getImmediate());return(n=>new jz(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),JA(pj,gj,kz(t)),JA(pj,gj,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tz=5*60,Pz=dL("authIdTokenMaxAge")||Tz;let xj=null;const Rz=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>Pz)return;const s=r==null?void 0:r.token;xj!==s&&(xj=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function YL(t=$B()){const e=qB(t,"auth");if(e.isInitialized())return e.getImmediate();const r=i$(t,{popupRedirectResolver:Iz,persistence:[M$,S$,qL]}),n=dL("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=Rz(i.toString());_$(r,o,()=>o(r.currentUser)),C$(r,l=>o(l))}}const s=lL("auth");return s&&l$(r,`http://${s}`),r}function Dz(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}ZG({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=_c("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",Dz().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Fz("Browser");var Lz="firebase",Uz="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */JA(Lz,Uz,"app");var vj=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var dh,ZL;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,B){function S(){}S.prototype=B.prototype,E.D=B.prototype,E.prototype=new S,E.prototype.constructor=E,E.C=function(U,_,F){for(var D=Array(arguments.length-2),X=2;X<arguments.length;X++)D[X-2]=arguments[X];return B.prototype[_].apply(U,D)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,B,S){S||(S=0);var U=Array(16);if(typeof B=="string")for(var _=0;16>_;++_)U[_]=B.charCodeAt(S++)|B.charCodeAt(S++)<<8|B.charCodeAt(S++)<<16|B.charCodeAt(S++)<<24;else for(_=0;16>_;++_)U[_]=B[S++]|B[S++]<<8|B[S++]<<16|B[S++]<<24;B=E.g[0],S=E.g[1],_=E.g[2];var F=E.g[3],D=B+(F^S&(_^F))+U[0]+3614090360&4294967295;B=S+(D<<7&4294967295|D>>>25),D=F+(_^B&(S^_))+U[1]+3905402710&4294967295,F=B+(D<<12&4294967295|D>>>20),D=_+(S^F&(B^S))+U[2]+606105819&4294967295,_=F+(D<<17&4294967295|D>>>15),D=S+(B^_&(F^B))+U[3]+3250441966&4294967295,S=_+(D<<22&4294967295|D>>>10),D=B+(F^S&(_^F))+U[4]+4118548399&4294967295,B=S+(D<<7&4294967295|D>>>25),D=F+(_^B&(S^_))+U[5]+1200080426&4294967295,F=B+(D<<12&4294967295|D>>>20),D=_+(S^F&(B^S))+U[6]+2821735955&4294967295,_=F+(D<<17&4294967295|D>>>15),D=S+(B^_&(F^B))+U[7]+4249261313&4294967295,S=_+(D<<22&4294967295|D>>>10),D=B+(F^S&(_^F))+U[8]+1770035416&4294967295,B=S+(D<<7&4294967295|D>>>25),D=F+(_^B&(S^_))+U[9]+2336552879&4294967295,F=B+(D<<12&4294967295|D>>>20),D=_+(S^F&(B^S))+U[10]+4294925233&4294967295,_=F+(D<<17&4294967295|D>>>15),D=S+(B^_&(F^B))+U[11]+2304563134&4294967295,S=_+(D<<22&4294967295|D>>>10),D=B+(F^S&(_^F))+U[12]+1804603682&4294967295,B=S+(D<<7&4294967295|D>>>25),D=F+(_^B&(S^_))+U[13]+4254626195&4294967295,F=B+(D<<12&4294967295|D>>>20),D=_+(S^F&(B^S))+U[14]+2792965006&4294967295,_=F+(D<<17&4294967295|D>>>15),D=S+(B^_&(F^B))+U[15]+1236535329&4294967295,S=_+(D<<22&4294967295|D>>>10),D=B+(_^F&(S^_))+U[1]+4129170786&4294967295,B=S+(D<<5&4294967295|D>>>27),D=F+(S^_&(B^S))+U[6]+3225465664&4294967295,F=B+(D<<9&4294967295|D>>>23),D=_+(B^S&(F^B))+U[11]+643717713&4294967295,_=F+(D<<14&4294967295|D>>>18),D=S+(F^B&(_^F))+U[0]+3921069994&4294967295,S=_+(D<<20&4294967295|D>>>12),D=B+(_^F&(S^_))+U[5]+3593408605&4294967295,B=S+(D<<5&4294967295|D>>>27),D=F+(S^_&(B^S))+U[10]+38016083&4294967295,F=B+(D<<9&4294967295|D>>>23),D=_+(B^S&(F^B))+U[15]+3634488961&4294967295,_=F+(D<<14&4294967295|D>>>18),D=S+(F^B&(_^F))+U[4]+3889429448&4294967295,S=_+(D<<20&4294967295|D>>>12),D=B+(_^F&(S^_))+U[9]+568446438&4294967295,B=S+(D<<5&4294967295|D>>>27),D=F+(S^_&(B^S))+U[14]+3275163606&4294967295,F=B+(D<<9&4294967295|D>>>23),D=_+(B^S&(F^B))+U[3]+4107603335&4294967295,_=F+(D<<14&4294967295|D>>>18),D=S+(F^B&(_^F))+U[8]+1163531501&4294967295,S=_+(D<<20&4294967295|D>>>12),D=B+(_^F&(S^_))+U[13]+2850285829&4294967295,B=S+(D<<5&4294967295|D>>>27),D=F+(S^_&(B^S))+U[2]+4243563512&4294967295,F=B+(D<<9&4294967295|D>>>23),D=_+(B^S&(F^B))+U[7]+1735328473&4294967295,_=F+(D<<14&4294967295|D>>>18),D=S+(F^B&(_^F))+U[12]+2368359562&4294967295,S=_+(D<<20&4294967295|D>>>12),D=B+(S^_^F)+U[5]+4294588738&4294967295,B=S+(D<<4&4294967295|D>>>28),D=F+(B^S^_)+U[8]+2272392833&4294967295,F=B+(D<<11&4294967295|D>>>21),D=_+(F^B^S)+U[11]+1839030562&4294967295,_=F+(D<<16&4294967295|D>>>16),D=S+(_^F^B)+U[14]+4259657740&4294967295,S=_+(D<<23&4294967295|D>>>9),D=B+(S^_^F)+U[1]+2763975236&4294967295,B=S+(D<<4&4294967295|D>>>28),D=F+(B^S^_)+U[4]+1272893353&4294967295,F=B+(D<<11&4294967295|D>>>21),D=_+(F^B^S)+U[7]+4139469664&4294967295,_=F+(D<<16&4294967295|D>>>16),D=S+(_^F^B)+U[10]+3200236656&4294967295,S=_+(D<<23&4294967295|D>>>9),D=B+(S^_^F)+U[13]+681279174&4294967295,B=S+(D<<4&4294967295|D>>>28),D=F+(B^S^_)+U[0]+3936430074&4294967295,F=B+(D<<11&4294967295|D>>>21),D=_+(F^B^S)+U[3]+3572445317&4294967295,_=F+(D<<16&4294967295|D>>>16),D=S+(_^F^B)+U[6]+76029189&4294967295,S=_+(D<<23&4294967295|D>>>9),D=B+(S^_^F)+U[9]+3654602809&4294967295,B=S+(D<<4&4294967295|D>>>28),D=F+(B^S^_)+U[12]+3873151461&4294967295,F=B+(D<<11&4294967295|D>>>21),D=_+(F^B^S)+U[15]+530742520&4294967295,_=F+(D<<16&4294967295|D>>>16),D=S+(_^F^B)+U[2]+3299628645&4294967295,S=_+(D<<23&4294967295|D>>>9),D=B+(_^(S|~F))+U[0]+4096336452&4294967295,B=S+(D<<6&4294967295|D>>>26),D=F+(S^(B|~_))+U[7]+1126891415&4294967295,F=B+(D<<10&4294967295|D>>>22),D=_+(B^(F|~S))+U[14]+2878612391&4294967295,_=F+(D<<15&4294967295|D>>>17),D=S+(F^(_|~B))+U[5]+4237533241&4294967295,S=_+(D<<21&4294967295|D>>>11),D=B+(_^(S|~F))+U[12]+1700485571&4294967295,B=S+(D<<6&4294967295|D>>>26),D=F+(S^(B|~_))+U[3]+2399980690&4294967295,F=B+(D<<10&4294967295|D>>>22),D=_+(B^(F|~S))+U[10]+4293915773&4294967295,_=F+(D<<15&4294967295|D>>>17),D=S+(F^(_|~B))+U[1]+2240044497&4294967295,S=_+(D<<21&4294967295|D>>>11),D=B+(_^(S|~F))+U[8]+1873313359&4294967295,B=S+(D<<6&4294967295|D>>>26),D=F+(S^(B|~_))+U[15]+4264355552&4294967295,F=B+(D<<10&4294967295|D>>>22),D=_+(B^(F|~S))+U[6]+2734768916&4294967295,_=F+(D<<15&4294967295|D>>>17),D=S+(F^(_|~B))+U[13]+1309151649&4294967295,S=_+(D<<21&4294967295|D>>>11),D=B+(_^(S|~F))+U[4]+4149444226&4294967295,B=S+(D<<6&4294967295|D>>>26),D=F+(S^(B|~_))+U[11]+3174756917&4294967295,F=B+(D<<10&4294967295|D>>>22),D=_+(B^(F|~S))+U[2]+718787259&4294967295,_=F+(D<<15&4294967295|D>>>17),D=S+(F^(_|~B))+U[9]+3951481745&4294967295,E.g[0]=E.g[0]+B&4294967295,E.g[1]=E.g[1]+(_+(D<<21&4294967295|D>>>11))&4294967295,E.g[2]=E.g[2]+_&4294967295,E.g[3]=E.g[3]+F&4294967295}n.prototype.u=function(E,B){B===void 0&&(B=E.length);for(var S=B-this.blockSize,U=this.B,_=this.h,F=0;F<B;){if(_==0)for(;F<=S;)s(this,E,F),F+=this.blockSize;if(typeof E=="string"){for(;F<B;)if(U[_++]=E.charCodeAt(F++),_==this.blockSize){s(this,U),_=0;break}}else for(;F<B;)if(U[_++]=E[F++],_==this.blockSize){s(this,U),_=0;break}}this.h=_,this.o+=B},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var B=1;B<E.length-8;++B)E[B]=0;var S=8*this.o;for(B=E.length-8;B<E.length;++B)E[B]=S&255,S/=256;for(this.u(E),E=Array(16),B=S=0;4>B;++B)for(var U=0;32>U;U+=8)E[S++]=this.g[B]>>>U&255;return E};function i(E,B){var S=l;return Object.prototype.hasOwnProperty.call(S,E)?S[E]:S[E]=B(E)}function o(E,B){this.h=B;for(var S=[],U=!0,_=E.length-1;0<=_;_--){var F=E[_]|0;U&&F==B||(S[_]=F,U=!1)}this.g=S}var l={};function c(E){return-128<=E&&128>E?i(E,function(B){return new o([B|0],0>B?-1:0)}):new o([E|0],0>E?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return u;if(0>E)return g(d(-E));for(var B=[],S=1,U=0;E>=S;U++)B[U]=E/S|0,S*=4294967296;return new o(B,0)}function A(E,B){if(E.length==0)throw Error("number format error: empty string");if(B=B||10,2>B||36<B)throw Error("radix out of range: "+B);if(E.charAt(0)=="-")return g(A(E.substring(1),B));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=d(Math.pow(B,8)),U=u,_=0;_<E.length;_+=8){var F=Math.min(8,E.length-_),D=parseInt(E.substring(_,_+F),B);8>F?(F=d(Math.pow(B,F)),U=U.j(F).add(d(D))):(U=U.j(S),U=U.add(d(D)))}return U}var u=c(0),f=c(1),h=c(16777216);t=o.prototype,t.m=function(){if(p(this))return-g(this).m();for(var E=0,B=1,S=0;S<this.g.length;S++){var U=this.i(S);E+=(0<=U?U:4294967296+U)*B,B*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(m(this))return"0";if(p(this))return"-"+g(this).toString(E);for(var B=d(Math.pow(E,6)),S=this,U="";;){var _=k(S,B).g;S=x(S,_.j(B));var F=((0<S.g.length?S.g[0]:S.h)>>>0).toString(E);if(S=_,m(S))return F+U;for(;6>F.length;)F="0"+F;U=F+U}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function m(E){if(E.h!=0)return!1;for(var B=0;B<E.g.length;B++)if(E.g[B]!=0)return!1;return!0}function p(E){return E.h==-1}t.l=function(E){return E=x(this,E),p(E)?-1:m(E)?0:1};function g(E){for(var B=E.g.length,S=[],U=0;U<B;U++)S[U]=~E.g[U];return new o(S,~E.h).add(f)}t.abs=function(){return p(this)?g(this):this},t.add=function(E){for(var B=Math.max(this.g.length,E.g.length),S=[],U=0,_=0;_<=B;_++){var F=U+(this.i(_)&65535)+(E.i(_)&65535),D=(F>>>16)+(this.i(_)>>>16)+(E.i(_)>>>16);U=D>>>16,F&=65535,D&=65535,S[_]=D<<16|F}return new o(S,S[S.length-1]&-2147483648?-1:0)};function x(E,B){return E.add(g(B))}t.j=function(E){if(m(this)||m(E))return u;if(p(this))return p(E)?g(this).j(g(E)):g(g(this).j(E));if(p(E))return g(this.j(g(E)));if(0>this.l(h)&&0>E.l(h))return d(this.m()*E.m());for(var B=this.g.length+E.g.length,S=[],U=0;U<2*B;U++)S[U]=0;for(U=0;U<this.g.length;U++)for(var _=0;_<E.g.length;_++){var F=this.i(U)>>>16,D=this.i(U)&65535,X=E.i(_)>>>16,ge=E.i(_)&65535;S[2*U+2*_]+=D*ge,b(S,2*U+2*_),S[2*U+2*_+1]+=F*ge,b(S,2*U+2*_+1),S[2*U+2*_+1]+=D*X,b(S,2*U+2*_+1),S[2*U+2*_+2]+=F*X,b(S,2*U+2*_+2)}for(U=0;U<B;U++)S[U]=S[2*U+1]<<16|S[2*U];for(U=B;U<2*B;U++)S[U]=0;return new o(S,0)};function b(E,B){for(;(E[B]&65535)!=E[B];)E[B+1]+=E[B]>>>16,E[B]&=65535,B++}function w(E,B){this.g=E,this.h=B}function k(E,B){if(m(B))throw Error("division by zero");if(m(E))return new w(u,u);if(p(E))return B=k(g(E),B),new w(g(B.g),g(B.h));if(p(B))return B=k(E,g(B)),new w(g(B.g),B.h);if(30<E.g.length){if(p(E)||p(B))throw Error("slowDivide_ only works with positive integers.");for(var S=f,U=B;0>=U.l(E);)S=O(S),U=O(U);var _=L(S,1),F=L(U,1);for(U=L(U,2),S=L(S,2);!m(U);){var D=F.add(U);0>=D.l(E)&&(_=_.add(S),F=D),U=L(U,1),S=L(S,1)}return B=x(E,_.j(B)),new w(_,B)}for(_=u;0<=E.l(B);){for(S=Math.max(1,Math.floor(E.m()/B.m())),U=Math.ceil(Math.log(S)/Math.LN2),U=48>=U?1:Math.pow(2,U-48),F=d(S),D=F.j(B);p(D)||0<D.l(E);)S-=U,F=d(S),D=F.j(B);m(F)&&(F=f),_=_.add(F),E=x(E,D)}return new w(_,E)}t.A=function(E){return k(this,E).h},t.and=function(E){for(var B=Math.max(this.g.length,E.g.length),S=[],U=0;U<B;U++)S[U]=this.i(U)&E.i(U);return new o(S,this.h&E.h)},t.or=function(E){for(var B=Math.max(this.g.length,E.g.length),S=[],U=0;U<B;U++)S[U]=this.i(U)|E.i(U);return new o(S,this.h|E.h)},t.xor=function(E){for(var B=Math.max(this.g.length,E.g.length),S=[],U=0;U<B;U++)S[U]=this.i(U)^E.i(U);return new o(S,this.h^E.h)};function O(E){for(var B=E.g.length+1,S=[],U=0;U<B;U++)S[U]=E.i(U)<<1|E.i(U-1)>>>31;return new o(S,E.h)}function L(E,B){var S=B>>5;B%=32;for(var U=E.g.length-S,_=[],F=0;F<U;F++)_[F]=0<B?E.i(F+S)>>>B|E.i(F+S+1)<<32-B:E.i(F+S);return new o(_,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,ZL=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=A,dh=o}).apply(typeof vj<"u"?vj:typeof self<"u"?self:typeof window<"u"?window:{});var Pv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var e6,pp,t6,ay,S_,r6,n6,s6;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,H,ne){return y==Array.prototype||y==Object.prototype||(y[H]=ne.value),y};function r(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pv=="object"&&Pv];for(var H=0;H<y.length;++H){var ne=y[H];if(ne&&ne.Math==Math)return ne}throw Error("Cannot find global object")}var n=r(this);function s(y,H){if(H)e:{var ne=n;y=y.split(".");for(var ke=0;ke<y.length-1;ke++){var pt=y[ke];if(!(pt in ne))break e;ne=ne[pt]}y=y[y.length-1],ke=ne[y],H=H(ke),H!=ke&&H!=null&&e(ne,y,{configurable:!0,writable:!0,value:H})}}function i(y,H){y instanceof String&&(y+="");var ne=0,ke=!1,pt={next:function(){if(!ke&&ne<y.length){var wt=ne++;return{value:H(wt,y[wt]),done:!1}}return ke=!0,{done:!0,value:void 0}}};return pt[Symbol.iterator]=function(){return pt},pt}s("Array.prototype.values",function(y){return y||function(){return i(this,function(H,ne){return ne})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(y){var H=typeof y;return H=H!="object"?H:y?Array.isArray(y)?"array":H:"null",H=="array"||H=="object"&&typeof y.length=="number"}function d(y){var H=typeof y;return H=="object"&&y!=null||H=="function"}function A(y,H,ne){return y.call.apply(y.bind,arguments)}function u(y,H,ne){if(!y)throw Error();if(2<arguments.length){var ke=Array.prototype.slice.call(arguments,2);return function(){var pt=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(pt,ke),y.apply(H,pt)}}return function(){return y.apply(H,arguments)}}function f(y,H,ne){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?A:u,f.apply(null,arguments)}function h(y,H){var ne=Array.prototype.slice.call(arguments,1);return function(){var ke=ne.slice();return ke.push.apply(ke,arguments),y.apply(this,ke)}}function m(y,H){function ne(){}ne.prototype=H.prototype,y.aa=H.prototype,y.prototype=new ne,y.prototype.constructor=y,y.Qb=function(ke,pt,wt){for(var zt=Array(arguments.length-2),sn=2;sn<arguments.length;sn++)zt[sn-2]=arguments[sn];return H.prototype[pt].apply(ke,zt)}}function p(y){const H=y.length;if(0<H){const ne=Array(H);for(let ke=0;ke<H;ke++)ne[ke]=y[ke];return ne}return[]}function g(y,H){for(let ne=1;ne<arguments.length;ne++){const ke=arguments[ne];if(c(ke)){const pt=y.length||0,wt=ke.length||0;y.length=pt+wt;for(let zt=0;zt<wt;zt++)y[pt+zt]=ke[zt]}else y.push(ke)}}class x{constructor(H,ne){this.i=H,this.j=ne,this.h=0,this.g=null}get(){let H;return 0<this.h?(this.h--,H=this.g,this.g=H.next,H.next=null):H=this.i(),H}}function b(y){return/^[\s\xa0]*$/.test(y)}function w(){var y=l.navigator;return y&&(y=y.userAgent)?y:""}function k(y){return k[" "](y),y}k[" "]=function(){};var O=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function L(y,H,ne){for(const ke in y)H.call(ne,y[ke],ke,y)}function E(y,H){for(const ne in y)H.call(void 0,y[ne],ne,y)}function B(y){const H={};for(const ne in y)H[ne]=y[ne];return H}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(y,H){let ne,ke;for(let pt=1;pt<arguments.length;pt++){ke=arguments[pt];for(ne in ke)y[ne]=ke[ne];for(let wt=0;wt<S.length;wt++)ne=S[wt],Object.prototype.hasOwnProperty.call(ke,ne)&&(y[ne]=ke[ne])}}function _(y){var H=1;y=y.split(":");const ne=[];for(;0<H&&y.length;)ne.push(y.shift()),H--;return y.length&&ne.push(y.join(":")),ne}function F(y){l.setTimeout(()=>{throw y},0)}function D(){var y=Z;let H=null;return y.g&&(H=y.g,y.g=y.g.next,y.g||(y.h=null),H.next=null),H}class X{constructor(){this.h=this.g=null}add(H,ne){const ke=ge.get();ke.set(H,ne),this.h?this.h.next=ke:this.g=ke,this.h=ke}}var ge=new x(()=>new ae,y=>y.reset());class ae{constructor(){this.next=this.g=this.h=null}set(H,ne){this.h=H,this.g=ne,this.next=null}reset(){this.next=this.g=this.h=null}}let fe,me=!1,Z=new X,ye=()=>{const y=l.Promise.resolve(void 0);fe=()=>{y.then(Ie)}};var Ie=()=>{for(var y;y=D();){try{y.h.call(y.g)}catch(ne){F(ne)}var H=ge;H.j(y),100>H.h&&(H.h++,y.next=H.g,H.g=y)}me=!1};function I(){this.s=this.s,this.C=this.C}I.prototype.s=!1,I.prototype.ma=function(){this.s||(this.s=!0,this.N())},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(y,H){this.type=y,this.g=this.target=H,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var Q=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var y=!1,H=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const ne=()=>{};l.addEventListener("test",ne,H),l.removeEventListener("test",ne,H)}catch{}return y}();function T(y,H){if(j.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y){var ne=this.type=y.type,ke=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;if(this.target=y.target||y.srcElement,this.g=H,H=y.relatedTarget){if(O){e:{try{k(H.nodeName);var pt=!0;break e}catch{}pt=!1}pt||(H=null)}}else ne=="mouseover"?H=y.fromElement:ne=="mouseout"&&(H=y.toElement);this.relatedTarget=H,ke?(this.clientX=ke.clientX!==void 0?ke.clientX:ke.pageX,this.clientY=ke.clientY!==void 0?ke.clientY:ke.pageY,this.screenX=ke.screenX||0,this.screenY=ke.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=typeof y.pointerType=="string"?y.pointerType:R[y.pointerType]||"",this.state=y.state,this.i=y,y.defaultPrevented&&T.aa.h.call(this)}}m(T,j);var R={2:"touch",3:"pen",4:"mouse"};T.prototype.h=function(){T.aa.h.call(this);var y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var K="closure_listenable_"+(1e6*Math.random()|0),M=0;function re(y,H,ne,ke,pt){this.listener=y,this.proxy=null,this.src=H,this.type=ne,this.capture=!!ke,this.ha=pt,this.key=++M,this.da=this.fa=!1}function de(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function le(y){this.src=y,this.g={},this.h=0}le.prototype.add=function(y,H,ne,ke,pt){var wt=y.toString();y=this.g[wt],y||(y=this.g[wt]=[],this.h++);var zt=Se(y,H,ke,pt);return-1<zt?(H=y[zt],ne||(H.fa=!1)):(H=new re(H,this.src,wt,!!ke,pt),H.fa=ne,y.push(H)),H};function q(y,H){var ne=H.type;if(ne in y.g){var ke=y.g[ne],pt=Array.prototype.indexOf.call(ke,H,void 0),wt;(wt=0<=pt)&&Array.prototype.splice.call(ke,pt,1),wt&&(de(H),y.g[ne].length==0&&(delete y.g[ne],y.h--))}}function Se(y,H,ne,ke){for(var pt=0;pt<y.length;++pt){var wt=y[pt];if(!wt.da&&wt.listener==H&&wt.capture==!!ne&&wt.ha==ke)return pt}return-1}var ee="closure_lm_"+(1e6*Math.random()|0),z={};function te(y,H,ne,ke,pt){if(Array.isArray(H)){for(var wt=0;wt<H.length;wt++)te(y,H[wt],ne,ke,pt);return null}return ne=vt(ne),y&&y[K]?y.K(H,ne,d(ke)?!!ke.capture:!1,pt):Ne(y,H,ne,!1,ke,pt)}function Ne(y,H,ne,ke,pt,wt){if(!H)throw Error("Invalid event type");var zt=d(pt)?!!pt.capture:!!pt,sn=ot(y);if(sn||(y[ee]=sn=new le(y)),ne=sn.add(H,ne,ke,zt,wt),ne.proxy)return ne;if(ke=Y(),ne.proxy=ke,ke.src=y,ke.listener=ne,y.addEventListener)Q||(pt=zt),pt===void 0&&(pt=!1),y.addEventListener(H.toString(),ke,pt);else if(y.attachEvent)y.attachEvent(Qe(H.toString()),ke);else if(y.addListener&&y.removeListener)y.addListener(ke);else throw Error("addEventListener and attachEvent are unavailable.");return ne}function Y(){function y(ne){return H.call(y.src,y.listener,ne)}const H=tt;return y}function we(y,H,ne,ke,pt){if(Array.isArray(H))for(var wt=0;wt<H.length;wt++)we(y,H[wt],ne,ke,pt);else ke=d(ke)?!!ke.capture:!!ke,ne=vt(ne),y&&y[K]?(y=y.i,H=String(H).toString(),H in y.g&&(wt=y.g[H],ne=Se(wt,ne,ke,pt),-1<ne&&(de(wt[ne]),Array.prototype.splice.call(wt,ne,1),wt.length==0&&(delete y.g[H],y.h--)))):y&&(y=ot(y))&&(H=y.g[H.toString()],y=-1,H&&(y=Se(H,ne,ke,pt)),(ne=-1<y?H[y]:null)&&Pe(ne))}function Pe(y){if(typeof y!="number"&&y&&!y.da){var H=y.src;if(H&&H[K])q(H.i,y);else{var ne=y.type,ke=y.proxy;H.removeEventListener?H.removeEventListener(ne,ke,y.capture):H.detachEvent?H.detachEvent(Qe(ne),ke):H.addListener&&H.removeListener&&H.removeListener(ke),(ne=ot(H))?(q(ne,y),ne.h==0&&(ne.src=null,H[ee]=null)):de(y)}}}function Qe(y){return y in z?z[y]:z[y]="on"+y}function tt(y,H){if(y.da)y=!0;else{H=new T(H,this);var ne=y.listener,ke=y.ha||y.src;y.fa&&Pe(y),y=ne.call(ke,H)}return y}function ot(y){return y=y[ee],y instanceof le?y:null}var dt="__closure_events_fn_"+(1e9*Math.random()>>>0);function vt(y){return typeof y=="function"?y:(y[dt]||(y[dt]=function(H){return y.handleEvent(H)}),y[dt])}function lt(){I.call(this),this.i=new le(this),this.M=this,this.F=null}m(lt,I),lt.prototype[K]=!0,lt.prototype.removeEventListener=function(y,H,ne,ke){we(this,y,H,ne,ke)};function Ue(y,H){var ne,ke=y.F;if(ke)for(ne=[];ke;ke=ke.F)ne.push(ke);if(y=y.M,ke=H.type||H,typeof H=="string")H=new j(H,y);else if(H instanceof j)H.target=H.target||y;else{var pt=H;H=new j(ke,y),U(H,pt)}if(pt=!0,ne)for(var wt=ne.length-1;0<=wt;wt--){var zt=H.g=ne[wt];pt=Xe(zt,ke,!0,H)&&pt}if(zt=H.g=y,pt=Xe(zt,ke,!0,H)&&pt,pt=Xe(zt,ke,!1,H)&&pt,ne)for(wt=0;wt<ne.length;wt++)zt=H.g=ne[wt],pt=Xe(zt,ke,!1,H)&&pt}lt.prototype.N=function(){if(lt.aa.N.call(this),this.i){var y=this.i,H;for(H in y.g){for(var ne=y.g[H],ke=0;ke<ne.length;ke++)de(ne[ke]);delete y.g[H],y.h--}}this.F=null},lt.prototype.K=function(y,H,ne,ke){return this.i.add(String(y),H,!1,ne,ke)},lt.prototype.L=function(y,H,ne,ke){return this.i.add(String(y),H,!0,ne,ke)};function Xe(y,H,ne,ke){if(H=y.i.g[String(H)],!H)return!0;H=H.concat();for(var pt=!0,wt=0;wt<H.length;++wt){var zt=H[wt];if(zt&&!zt.da&&zt.capture==ne){var sn=zt.listener,xs=zt.ha||zt.src;zt.fa&&q(y.i,zt),pt=sn.call(xs,ke)!==!1&&pt}}return pt&&!ke.defaultPrevented}function xe(y,H,ne){if(typeof y=="function")ne&&(y=f(y,ne));else if(y&&typeof y.handleEvent=="function")y=f(y.handleEvent,y);else throw Error("Invalid listener argument");return 2147483647<Number(H)?-1:l.setTimeout(y,H||0)}function ve(y){y.g=xe(()=>{y.g=null,y.i&&(y.i=!1,ve(y))},y.l);const H=y.h;y.h=null,y.m.apply(null,H)}class ie extends I{constructor(H,ne){super(),this.m=H,this.l=ne,this.h=null,this.i=!1,this.g=null}j(H){this.h=arguments,this.g?this.i=!0:ve(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ze(y){I.call(this),this.h=y,this.g={}}m(ze,I);var rt=[];function At(y){L(y.g,function(H,ne){this.g.hasOwnProperty(ne)&&Pe(H)},y),y.g={}}ze.prototype.N=function(){ze.aa.N.call(this),At(this)},ze.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Oe=l.JSON.stringify,at=l.JSON.parse,Ve=class{stringify(y){return l.JSON.stringify(y,void 0)}parse(y){return l.JSON.parse(y,void 0)}};function G(){}G.prototype.h=null;function _e(y){return y.h||(y.h=y.i())}function Me(){}var We={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function He(){j.call(this,"d")}m(He,j);function st(){j.call(this,"c")}m(st,j);var Ct={},Xt=null;function Ot(){return Xt=Xt||new lt}Ct.La="serverreachability";function tr(y){j.call(this,Ct.La,y)}m(tr,j);function Zt(y){const H=Ot();Ue(H,new tr(H))}Ct.STAT_EVENT="statevent";function et(y,H){j.call(this,Ct.STAT_EVENT,y),this.stat=H}m(et,j);function Rt(y){const H=Ot();Ue(H,new et(H,y))}Ct.Ma="timingevent";function er(y,H){j.call(this,Ct.Ma,y),this.size=H}m(er,j);function Lt(y,H){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){y()},H)}function Vt(){this.g=!0}Vt.prototype.xa=function(){this.g=!1};function nr(y,H,ne,ke,pt,wt){y.info(function(){if(y.g)if(wt)for(var zt="",sn=wt.split("&"),xs=0;xs<sn.length;xs++){var Gr=sn[xs].split("=");if(1<Gr.length){var fn=Gr[0];Gr=Gr[1];var qn=fn.split("_");zt=2<=qn.length&&qn[1]=="type"?zt+(fn+"="+Gr+"&"):zt+(fn+"=redacted&")}}else zt=null;else zt=wt;return"XMLHTTP REQ ("+ke+") [attempt "+pt+"]: "+H+`
`+ne+`
`+zt})}function Mt(y,H,ne,ke,pt,wt,zt){y.info(function(){return"XMLHTTP RESP ("+ke+") [ attempt "+pt+"]: "+H+`
`+ne+`
`+wt+" "+zt})}function oe(y,H,ne,ke){y.info(function(){return"XMLHTTP TEXT ("+H+"): "+ce(y,ne)+(ke?" "+ke:"")})}function J(y,H){y.info(function(){return"TIMEOUT: "+H})}Vt.prototype.info=function(){};function ce(y,H){if(!y.g)return H;if(!H)return null;try{var ne=JSON.parse(H);if(ne){for(y=0;y<ne.length;y++)if(Array.isArray(ne[y])){var ke=ne[y];if(!(2>ke.length)){var pt=ke[1];if(Array.isArray(pt)&&!(1>pt.length)){var wt=pt[0];if(wt!="noop"&&wt!="stop"&&wt!="close")for(var zt=1;zt<pt.length;zt++)pt[zt]=""}}}}return Oe(ne)}catch{return H}}var pe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Be={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},De;function se(){}m(se,G),se.prototype.g=function(){return new XMLHttpRequest},se.prototype.i=function(){return{}},De=new se;function Fe(y,H,ne,ke){this.j=y,this.i=H,this.l=ne,this.R=ke||1,this.U=new ze(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new he}function he(){this.i=null,this.g="",this.h=!1}var Re={},Ee={};function Ze(y,H,ne){y.L=1,y.v=Uc(na(H)),y.m=ne,y.P=!0,Je(y,null)}function Je(y,H){y.F=Date.now(),it(y),y.A=na(y.v);var ne=y.A,ke=y.R;Array.isArray(ke)||(ke=[String(ke)]),Af(ne.i,"t",ke),y.C=0,ne=y.j.J,y.h=new he,y.g=Es(y.j,ne?H:null,!y.m),0<y.O&&(y.M=new ie(f(y.Y,y,y.g),y.O)),H=y.U,ne=y.g,ke=y.ca;var pt="readystatechange";Array.isArray(pt)||(pt&&(rt[0]=pt.toString()),pt=rt);for(var wt=0;wt<pt.length;wt++){var zt=te(ne,pt[wt],ke||H.handleEvent,!1,H.h||H);if(!zt)break;H.g[zt.key]=zt}H=y.H?B(y.H):{},y.m?(y.u||(y.u="POST"),H["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.A,y.u,y.m,H)):(y.u="GET",y.g.ea(y.A,y.u,null,H)),Zt(),nr(y.i,y.u,y.A,y.l,y.R,y.m)}Fe.prototype.ca=function(y){y=y.target;const H=this.M;H&&Ni(y)==3?H.j():this.Y(y)},Fe.prototype.Y=function(y){try{if(y==this.g)e:{const qn=Ni(this.g);var H=this.g.Ba();const lo=this.g.Z();if(!(3>qn)&&(qn!=3||this.g&&(this.h.h||this.g.oa()||ju(this.g)))){this.J||qn!=4||H==7||(H==8||0>=lo?Zt(3):Zt(2)),Ut(this);var ne=this.g.Z();this.X=ne;t:if(Ye(this)){var ke=ju(this.g);y="";var pt=ke.length,wt=Ni(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){yr(this),Kt(this);var zt="";break t}this.h.i=new l.TextDecoder}for(H=0;H<pt;H++)this.h.h=!0,y+=this.h.i.decode(ke[H],{stream:!(wt&&H==pt-1)});ke.length=0,this.h.g+=y,this.C=0,zt=this.h.g}else zt=this.g.oa();if(this.o=ne==200,Mt(this.i,this.u,this.A,this.l,this.R,qn,ne),this.o){if(this.T&&!this.K){t:{if(this.g){var sn,xs=this.g;if((sn=xs.g?xs.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(sn)){var Gr=sn;break t}}Gr=null}if(ne=Gr)oe(this.i,this.l,ne,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Hn(this,ne);else{this.o=!1,this.s=3,Rt(12),yr(this),Kt(this);break e}}if(this.P){ne=!0;let Za;for(;!this.J&&this.C<zt.length;)if(Za=$e(this,zt),Za==Ee){qn==4&&(this.s=4,Rt(14),ne=!1),oe(this.i,this.l,null,"[Incomplete Response]");break}else if(Za==Re){this.s=4,Rt(15),oe(this.i,this.l,zt,"[Invalid Chunk]"),ne=!1;break}else oe(this.i,this.l,Za,null),Hn(this,Za);if(Ye(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qn!=4||zt.length!=0||this.h.h||(this.s=1,Rt(16),ne=!1),this.o=this.o&&ne,!ne)oe(this.i,this.l,zt,"[Invalid Chunked Response]"),yr(this),Kt(this);else if(0<zt.length&&!this.W){this.W=!0;var fn=this.j;fn.g==this&&fn.ba&&!fn.M&&(fn.j.info("Great, no buffering proxy detected. Bytes received: "+zt.length),lr(fn),fn.M=!0,Rt(11))}}else oe(this.i,this.l,zt,null),Hn(this,zt);qn==4&&yr(this),this.o&&!this.J&&(qn==4?Tr(this.j,this):(this.o=!1,it(this)))}else hf(this.g),ne==400&&0<zt.indexOf("Unknown SID")?(this.s=3,Rt(12)):(this.s=0,Rt(13)),yr(this),Kt(this)}}}catch{}finally{}};function Ye(y){return y.g?y.u=="GET"&&y.L!=2&&y.j.Ca:!1}function $e(y,H){var ne=y.C,ke=H.indexOf(`
`,ne);return ke==-1?Ee:(ne=Number(H.substring(ne,ke)),isNaN(ne)?Re:(ke+=1,ke+ne>H.length?Ee:(H=H.slice(ke,ke+ne),y.C=ke+ne,H)))}Fe.prototype.cancel=function(){this.J=!0,yr(this)};function it(y){y.S=Date.now()+y.I,ft(y,y.I)}function ft(y,H){if(y.B!=null)throw Error("WatchDog timer not null");y.B=Lt(f(y.ba,y),H)}function Ut(y){y.B&&(l.clearTimeout(y.B),y.B=null)}Fe.prototype.ba=function(){this.B=null;const y=Date.now();0<=y-this.S?(J(this.i,this.A),this.L!=2&&(Zt(),Rt(17)),yr(this),this.s=2,Kt(this)):ft(this,this.S-y)};function Kt(y){y.j.G==0||y.J||Tr(y.j,y)}function yr(y){Ut(y);var H=y.M;H&&typeof H.ma=="function"&&H.ma(),y.M=null,At(y.U),y.g&&(H=y.g,y.g=null,H.abort(),H.ma())}function Hn(y,H){try{var ne=y.j;if(ne.G!=0&&(ne.g==y||Jn(ne.h,y))){if(!y.K&&Jn(ne.h,y)&&ne.G==3){try{var ke=ne.Da.g.parse(H)}catch{ke=null}if(Array.isArray(ke)&&ke.length==3){var pt=ke;if(pt[0]==0){e:if(!ne.u){if(ne.g)if(ne.g.F+3e3<y.F)Cr(ne),Ho(ne);else break e;Ft(ne),Rt(18)}}else ne.za=pt[1],0<ne.za-ne.T&&37500>pt[2]&&ne.F&&ne.v==0&&!ne.C&&(ne.C=Lt(f(ne.Za,ne),6e3));if(1>=ao(ne.h)&&ne.ca){try{ne.ca()}catch{}ne.ca=void 0}}else gn(ne,11)}else if((y.K||ne.g==y)&&Cr(ne),!b(H))for(pt=ne.Da.g.parse(H),H=0;H<pt.length;H++){let Gr=pt[H];if(ne.T=Gr[0],Gr=Gr[1],ne.G==2)if(Gr[0]=="c"){ne.K=Gr[1],ne.ia=Gr[2];const fn=Gr[3];fn!=null&&(ne.la=fn,ne.j.info("VER="+ne.la));const qn=Gr[4];qn!=null&&(ne.Aa=qn,ne.j.info("SVER="+ne.Aa));const lo=Gr[5];lo!=null&&typeof lo=="number"&&0<lo&&(ke=1.5*lo,ne.L=ke,ne.j.info("backChannelRequestTimeoutMs_="+ke)),ke=ne;const Za=y.g;if(Za){const Pa=Za.g?Za.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Pa){var wt=ke.h;wt.g||Pa.indexOf("spdy")==-1&&Pa.indexOf("quic")==-1&&Pa.indexOf("h2")==-1||(wt.j=wt.l,wt.g=new Set,wt.h&&(io(wt,wt.h),wt.h=null))}if(ke.D){const Nl=Za.g?Za.g.getResponseHeader("X-HTTP-Session-Id"):null;Nl&&(ke.ya=Nl,Yr(ke.I,ke.D,Nl))}}ne.G=3,ne.l&&ne.l.ua(),ne.ba&&(ne.R=Date.now()-y.F,ne.j.info("Handshake RTT: "+ne.R+"ms")),ke=ne;var zt=y;if(ke.qa=yn(ke,ke.J?ke.ia:null,ke.W),zt.K){Ud(ke.h,zt);var sn=zt,xs=ke.L;xs&&(sn.I=xs),sn.B&&(Ut(sn),it(sn)),ke.g=zt}else St(ke);0<ne.i.length&&P(ne)}else Gr[0]!="stop"&&Gr[0]!="close"||gn(ne,7);else ne.G==3&&(Gr[0]=="stop"||Gr[0]=="close"?Gr[0]=="stop"?gn(ne,7):Kd(ne):Gr[0]!="noop"&&ne.l&&ne.l.ta(Gr),ne.v=0)}}Zt(4)}catch{}}var Fn=class{constructor(y,H){this.g=y,this.map=H}};function wi(y){this.l=y||10,l.PerformanceNavigationTiming?(y=l.performance.getEntriesByType("navigation"),y=0<y.length&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ds(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function ao(y){return y.h?1:y.g?y.g.size:0}function Jn(y,H){return y.h?y.h==H:y.g?y.g.has(H):!1}function io(y,H){y.g?y.g.add(H):y.h=H}function Ud(y,H){y.h&&y.h==H?y.h=null:y.g&&y.g.has(H)&&y.g.delete(H)}wi.prototype.cancel=function(){if(this.i=Kn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Kn(y){if(y.h!=null)return y.i.concat(y.h.D);if(y.g!=null&&y.g.size!==0){let H=y.i;for(const ne of y.g.values())H=H.concat(ne.D);return H}return p(y.i)}function ec(y){if(y.V&&typeof y.V=="function")return y.V();if(typeof Map<"u"&&y instanceof Map||typeof Set<"u"&&y instanceof Set)return Array.from(y.values());if(typeof y=="string")return y.split("");if(c(y)){for(var H=[],ne=y.length,ke=0;ke<ne;ke++)H.push(y[ke]);return H}H=[],ne=0;for(ke in y)H[ne++]=y[ke];return H}function Lo(y){if(y.na&&typeof y.na=="function")return y.na();if(!y.V||typeof y.V!="function"){if(typeof Map<"u"&&y instanceof Map)return Array.from(y.keys());if(!(typeof Set<"u"&&y instanceof Set)){if(c(y)||typeof y=="string"){var H=[];y=y.length;for(var ne=0;ne<y;ne++)H.push(ne);return H}H=[],ne=0;for(const ke in y)H[ne++]=ke;return H}}}function Dc(y,H){if(y.forEach&&typeof y.forEach=="function")y.forEach(H,void 0);else if(c(y)||typeof y=="string")Array.prototype.forEach.call(y,H,void 0);else for(var ne=Lo(y),ke=ec(y),pt=ke.length,wt=0;wt<pt;wt++)H.call(void 0,ke[wt],ne&&ne[wt],y)}var Eu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qi(y,H){if(y){y=y.split("&");for(var ne=0;ne<y.length;ne++){var ke=y[ne].indexOf("="),pt=null;if(0<=ke){var wt=y[ne].substring(0,ke);pt=y[ne].substring(ke+1)}else wt=y[ne];H(wt,pt?decodeURIComponent(pt.replace(/\+/g," ")):"")}}}function Ln(y){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,y instanceof Ln){this.h=y.h,Lc(this,y.j),this.o=y.o,this.g=y.g,Od(this,y.s),this.l=y.l;var H=y.i,ne=new Ta;ne.i=H.i,H.g&&(ne.g=new Map(H.g),ne.h=H.h),lf(this,ne),this.m=y.m}else y&&(H=String(y).match(Eu))?(this.h=!1,Lc(this,H[1]||"",!0),this.o=tc(H[2]||""),this.g=tc(H[3]||"",!0),Od(this,H[4]),this.l=tc(H[5]||"",!0),lf(this,H[6]||"",!0),this.m=tc(H[7]||"")):(this.h=!1,this.i=new Ta(null,this.h))}Ln.prototype.toString=function(){var y=[],H=this.j;H&&y.push(Uo(H,cf,!0),":");var ne=this.g;return(ne||H=="file")&&(y.push("//"),(H=this.o)&&y.push(Uo(H,cf,!0),"@"),y.push(encodeURIComponent(String(ne)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ne=this.s,ne!=null&&y.push(":",String(ne))),(ne=this.l)&&(this.g&&ne.charAt(0)!="/"&&y.push("/"),y.push(Uo(ne,ne.charAt(0)=="/"?pm:mm,!0))),(ne=this.i.toString())&&y.push("?",ne),(ne=this.m)&&y.push("#",Uo(ne,df)),y.join("")};function na(y){return new Ln(y)}function Lc(y,H,ne){y.j=ne?tc(H,!0):H,y.j&&(y.j=y.j.replace(/:$/,""))}function Od(y,H){if(H){if(H=Number(H),isNaN(H)||0>H)throw Error("Bad port number "+H);y.s=H}else y.s=null}function lf(y,H,ne){H instanceof Ta?(y.i=H,gm(y.i,y.h)):(ne||(H=Uo(H,Bu)),y.i=new Ta(H,y.h))}function Yr(y,H,ne){y.i.set(H,ne)}function Uc(y){return Yr(y,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),y}function tc(y,H){return y?H?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function Uo(y,H,ne){return typeof y=="string"?(y=encodeURI(y).replace(H,Oc),ne&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Oc(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var cf=/[#\/\?@]/g,mm=/[#\?:]/g,pm=/[#\?]/g,Bu=/[#\?@]/g,df=/#/g;function Ta(y,H){this.h=this.g=null,this.i=y||null,this.j=!!H}function Oo(y){y.g||(y.g=new Map,y.h=0,y.i&&Qi(y.i,function(H,ne){y.add(decodeURIComponent(H.replace(/\+/g," ")),ne)}))}t=Ta.prototype,t.add=function(y,H){Oo(this),this.i=null,y=Nr(this,y);var ne=this.g.get(y);return ne||this.g.set(y,ne=[]),ne.push(H),this.h+=1,this};function rc(y,H){Oo(y),H=Nr(y,H),y.g.has(H)&&(y.i=null,y.h-=y.g.get(H).length,y.g.delete(H))}function Md(y,H){return Oo(y),H=Nr(y,H),y.g.has(H)}t.forEach=function(y,H){Oo(this),this.g.forEach(function(ne,ke){ne.forEach(function(pt){y.call(H,pt,ke,this)},this)},this)},t.na=function(){Oo(this);const y=Array.from(this.g.values()),H=Array.from(this.g.keys()),ne=[];for(let ke=0;ke<H.length;ke++){const pt=y[ke];for(let wt=0;wt<pt.length;wt++)ne.push(H[ke])}return ne},t.V=function(y){Oo(this);let H=[];if(typeof y=="string")Md(this,y)&&(H=H.concat(this.g.get(Nr(this,y))));else{y=Array.from(this.g.values());for(let ne=0;ne<y.length;ne++)H=H.concat(y[ne])}return H},t.set=function(y,H){return Oo(this),this.i=null,y=Nr(this,y),Md(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[H]),this.h+=1,this},t.get=function(y,H){return y?(y=this.V(y),0<y.length?String(y[0]):H):H};function Af(y,H,ne){rc(y,H),0<ne.length&&(y.i=null,y.g.set(Nr(y,H),p(ne)),y.h+=ne.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],H=Array.from(this.g.keys());for(var ne=0;ne<H.length;ne++){var ke=H[ne];const wt=encodeURIComponent(String(ke)),zt=this.V(ke);for(ke=0;ke<zt.length;ke++){var pt=wt;zt[ke]!==""&&(pt+="="+encodeURIComponent(String(zt[ke]))),y.push(pt)}}return this.i=y.join("&")};function Nr(y,H){return H=String(H),y.j&&(H=H.toLowerCase()),H}function gm(y,H){H&&!y.j&&(Oo(y),y.i=null,y.g.forEach(function(ne,ke){var pt=ke.toLowerCase();ke!=pt&&(rc(this,ke),Af(this,pt,ne))},y)),y.j=H}function xm(y,H){const ne=new Vt;if(l.Image){const ke=new Image;ke.onload=h(ya,ne,"TestLoadImage: loaded",!0,H,ke),ke.onerror=h(ya,ne,"TestLoadImage: error",!1,H,ke),ke.onabort=h(ya,ne,"TestLoadImage: abort",!1,H,ke),ke.ontimeout=h(ya,ne,"TestLoadImage: timeout",!1,H,ke),l.setTimeout(function(){ke.ontimeout&&ke.ontimeout()},1e4),ke.src=y}else H(!1)}function vm(y,H){const ne=new Vt,ke=new AbortController,pt=setTimeout(()=>{ke.abort(),ya(ne,"TestPingServer: timeout",!1,H)},1e4);fetch(y,{signal:ke.signal}).then(wt=>{clearTimeout(pt),wt.ok?ya(ne,"TestPingServer: ok",!0,H):ya(ne,"TestPingServer: server error",!1,H)}).catch(()=>{clearTimeout(pt),ya(ne,"TestPingServer: error",!1,H)})}function ya(y,H,ne,ke,pt){try{pt&&(pt.onload=null,pt.onerror=null,pt.onabort=null,pt.ontimeout=null),ke(ne)}catch{}}function bl(){this.g=new Ve}function ym(y,H,ne){const ke=ne||"";try{Dc(y,function(pt,wt){let zt=pt;d(pt)&&(zt=Oe(pt)),H.push(ke+wt+"="+encodeURIComponent(zt))})}catch(pt){throw H.push(ke+"type="+encodeURIComponent("_badmap")),pt}}function Qd(y){this.l=y.Ub||null,this.j=y.eb||!1}m(Qd,G),Qd.prototype.g=function(){return new wl(this.l,this.j)},Qd.prototype.i=function(y){return function(){return y}}({});function wl(y,H){lt.call(this),this.D=y,this.o=H,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(wl,lt),t=wl.prototype,t.open=function(y,H){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=y,this.A=H,this.readyState=1,Mc(this)},t.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const H={headers:this.u,method:this.B,credentials:this.m,cache:void 0};y&&(H.body=y),(this.D||l).fetch(new Request(this.A,H)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,oo(this)),this.readyState=0},t.Sa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Mc(this)),this.g&&(this.readyState=3,Mc(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vd(this)}else y.text().then(this.Ra.bind(this),this.ga.bind(this))};function Vd(y){y.j.read().then(y.Pa.bind(y)).catch(y.ga.bind(y))}t.Pa=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var H=y.value?y.value:new Uint8Array(0);(H=this.v.decode(H,{stream:!y.done}))&&(this.response=this.responseText+=H)}y.done?oo(this):Mc(this),this.readyState==3&&Vd(this)}},t.Ra=function(y){this.g&&(this.response=this.responseText=y,oo(this))},t.Qa=function(y){this.g&&(this.response=y,oo(this))},t.ga=function(){this.g&&oo(this)};function oo(y){y.readyState=4,y.l=null,y.j=null,y.v=null,Mc(y)}t.setRequestHeader=function(y,H){this.u.append(y,H)},t.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],H=this.h.entries();for(var ne=H.next();!ne.done;)ne=ne.value,y.push(ne[0]+": "+ne[1]),ne=H.next();return y.join(`\r
`)};function Mc(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(wl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function Mo(y){let H="";return L(y,function(ne,ke){H+=ke,H+=":",H+=ne,H+=`\r
`}),H}function Su(y,H,ne){e:{for(ke in ne){var ke=!1;break e}ke=!0}ke||(ne=Mo(ne),typeof y=="string"?ne!=null&&encodeURIComponent(String(ne)):Yr(y,H,ne))}function Tn(y){lt.call(this),this.headers=new Map,this.o=y||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(Tn,lt);var Iu=/^https?$/i,uf=["POST","PUT"];t=Tn.prototype,t.Ha=function(y){this.J=y},t.ea=function(y,H,ne,ke){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);H=H?H.toUpperCase():"GET",this.D=y,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():De.g(),this.v=this.o?_e(this.o):_e(De),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(H,String(y),!0),this.B=!1}catch(wt){Qo(this,wt);return}if(y=ne||"",ne=new Map(this.headers),ke)if(Object.getPrototypeOf(ke)===Object.prototype)for(var pt in ke)ne.set(pt,ke[pt]);else if(typeof ke.keys=="function"&&typeof ke.get=="function")for(const wt of ke.keys())ne.set(wt,ke.get(wt));else throw Error("Unknown input type for opt_headers: "+String(ke));ke=Array.from(ne.keys()).find(wt=>wt.toLowerCase()=="content-type"),pt=l.FormData&&y instanceof l.FormData,!(0<=Array.prototype.indexOf.call(uf,H,void 0))||ke||pt||ne.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[wt,zt]of ne)this.g.setRequestHeader(wt,zt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{sc(this),this.u=!0,this.g.send(y),this.u=!1}catch(wt){Qo(this,wt)}};function Qo(y,H){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=H,y.m=5,Hd(y),nc(y)}function Hd(y){y.A||(y.A=!0,Ue(y,"complete"),Ue(y,"error"))}t.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=y||7,Ue(this,"complete"),Ue(this,"abort"),nc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),nc(this,!0)),Tn.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Qc(this):this.bb())},t.bb=function(){Qc(this)};function Qc(y){if(y.h&&typeof o<"u"&&(!y.v[1]||Ni(y)!=4||y.Z()!=2)){if(y.u&&Ni(y)==4)xe(y.Ea,0,y);else if(Ue(y,"readystatechange"),Ni(y)==4){y.h=!1;try{const zt=y.Z();e:switch(zt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var H=!0;break e;default:H=!1}var ne;if(!(ne=H)){var ke;if(ke=zt===0){var pt=String(y.D).match(Eu)[1]||null;!pt&&l.self&&l.self.location&&(pt=l.self.location.protocol.slice(0,-1)),ke=!Iu.test(pt?pt.toLowerCase():"")}ne=ke}if(ne)Ue(y,"complete"),Ue(y,"success");else{y.m=6;try{var wt=2<Ni(y)?y.g.statusText:""}catch{wt=""}y.l=wt+" ["+y.Z()+"]",Hd(y)}}finally{nc(y)}}}}function nc(y,H){if(y.g){sc(y);const ne=y.g,ke=y.v[0]?()=>{}:null;y.g=null,y.v=null,H||Ue(y,"ready");try{ne.onreadystatechange=ke}catch{}}}function sc(y){y.I&&(l.clearTimeout(y.I),y.I=null)}t.isActive=function(){return!!this.g};function Ni(y){return y.g?y.g.readyState:0}t.Z=function(){try{return 2<Ni(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(y){if(this.g){var H=this.g.responseText;return y&&H.indexOf(y)==0&&(H=H.substring(y.length)),at(H)}};function ju(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.H){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function hf(y){const H={};y=(y.g&&2<=Ni(y)&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let ke=0;ke<y.length;ke++){if(b(y[ke]))continue;var ne=_(y[ke]);const pt=ne[0];if(ne=ne[1],typeof ne!="string")continue;ne=ne.trim();const wt=H[pt]||[];H[pt]=wt,wt.push(ne)}E(H,function(ke){return ke.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ci(y,H,ne){return ne&&ne.internalChannelParams&&ne.internalChannelParams[y]||H}function Vo(y){this.Aa=0,this.i=[],this.j=new Vt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ci("failFast",!1,y),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ci("baseRetryDelayMs",5e3,y),this.cb=Ci("retryDelaySeedMs",1e4,y),this.Wa=Ci("forwardChannelMaxRetries",2,y),this.wa=Ci("forwardChannelRequestTimeoutMs",2e4,y),this.pa=y&&y.xmlHttpFactory||void 0,this.Xa=y&&y.Tb||void 0,this.Ca=y&&y.useFetchStreams||!1,this.L=void 0,this.J=y&&y.supportsCrossDomainXhr||!1,this.K="",this.h=new wi(y&&y.concurrentRequestLimit),this.Da=new bl,this.P=y&&y.fastHandshake||!1,this.O=y&&y.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=y&&y.Rb||!1,y&&y.xa&&this.j.xa(),y&&y.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&y&&y.detectBufferingProxy||!1,this.ja=void 0,y&&y.longPollingTimeout&&0<y.longPollingTimeout&&(this.ja=y.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Vo.prototype,t.la=8,t.G=1,t.connect=function(y,H,ne,ke){Rt(0),this.W=y,this.H=H||{},ne&&ke!==void 0&&(this.H.OSID=ne,this.H.OAID=ke),this.F=this.X,this.I=yn(this,null,this.W),P(this)};function Kd(y){if(ku(y),y.G==3){var H=y.U++,ne=na(y.I);if(Yr(ne,"SID",y.K),Yr(ne,"RID",H),Yr(ne,"TYPE","terminate"),nt(y,ne),H=new Fe(y,y.j,H),H.L=2,H.v=Uc(na(ne)),ne=!1,l.navigator&&l.navigator.sendBeacon)try{ne=l.navigator.sendBeacon(H.v.toString(),"")}catch{}!ne&&l.Image&&(new Image().src=H.v,ne=!0),ne||(H.g=Es(H.j,null),H.g.ea(H.v)),H.F=Date.now(),it(H)}ms(y)}function Ho(y){y.g&&(lr(y),y.g.cancel(),y.g=null)}function ku(y){Ho(y),y.u&&(l.clearTimeout(y.u),y.u=null),Cr(y),y.h.cancel(),y.s&&(typeof y.s=="number"&&l.clearTimeout(y.s),y.s=null)}function P(y){if(!Ds(y.h)&&!y.s){y.s=!0;var H=y.Ga;fe||ye(),me||(fe(),me=!0),Z.add(H,y),y.B=0}}function Ae(y,H){return ao(y.h)>=y.h.j-(y.s?1:0)?!1:y.s?(y.i=H.D.concat(y.i),!0):y.G==1||y.G==2||y.B>=(y.Va?0:y.Wa)?!1:(y.s=Lt(f(y.Ga,y,H),Zr(y,y.B)),y.B++,!0)}t.Ga=function(y){if(this.s)if(this.s=null,this.G==1){if(!y){this.U=Math.floor(1e5*Math.random()),y=this.U++;const pt=new Fe(this,this.j,y);let wt=this.o;if(this.S&&(wt?(wt=B(wt),U(wt,this.S)):wt=this.S),this.m!==null||this.O||(pt.H=wt,wt=null),this.P)e:{for(var H=0,ne=0;ne<this.i.length;ne++){t:{var ke=this.i[ne];if("__data__"in ke.map&&(ke=ke.map.__data__,typeof ke=="string")){ke=ke.length;break t}ke=void 0}if(ke===void 0)break;if(H+=ke,4096<H){H=ne;break e}if(H===4096||ne===this.i.length-1){H=ne+1;break e}}H=1e3}else H=1e3;H=mt(this,pt,H),ne=na(this.I),Yr(ne,"RID",y),Yr(ne,"CVER",22),this.D&&Yr(ne,"X-HTTP-Session-Id",this.D),nt(this,ne),wt&&(this.O?H="headers="+encodeURIComponent(String(Mo(wt)))+"&"+H:this.m&&Su(ne,this.m,wt)),io(this.h,pt),this.Ua&&Yr(ne,"TYPE","init"),this.P?(Yr(ne,"$req",H),Yr(ne,"SID","null"),pt.T=!0,Ze(pt,ne,null)):Ze(pt,ne,H),this.G=2}}else this.G==3&&(y?Ke(this,y):this.i.length==0||Ds(this.h)||Ke(this))};function Ke(y,H){var ne;H?ne=H.l:ne=y.U++;const ke=na(y.I);Yr(ke,"SID",y.K),Yr(ke,"RID",ne),Yr(ke,"AID",y.T),nt(y,ke),y.m&&y.o&&Su(ke,y.m,y.o),ne=new Fe(y,y.j,ne,y.B+1),y.m===null&&(ne.H=y.o),H&&(y.i=H.D.concat(y.i)),H=mt(y,ne,1e3),ne.I=Math.round(.5*y.wa)+Math.round(.5*y.wa*Math.random()),io(y.h,ne),Ze(ne,ke,H)}function nt(y,H){y.H&&L(y.H,function(ne,ke){Yr(H,ke,ne)}),y.l&&Dc({},function(ne,ke){Yr(H,ke,ne)})}function mt(y,H,ne){ne=Math.min(y.i.length,ne);var ke=y.l?f(y.l.Na,y.l,y):null;e:{var pt=y.i;let wt=-1;for(;;){const zt=["count="+ne];wt==-1?0<ne?(wt=pt[0].g,zt.push("ofs="+wt)):wt=0:zt.push("ofs="+wt);let sn=!0;for(let xs=0;xs<ne;xs++){let Gr=pt[xs].g;const fn=pt[xs].map;if(Gr-=wt,0>Gr)wt=Math.max(0,pt[xs].g-100),sn=!1;else try{ym(fn,zt,"req"+Gr+"_")}catch{ke&&ke(fn)}}if(sn){ke=zt.join("&");break e}}}return y=y.i.splice(0,ne),H.D=y,ke}function St(y){if(!y.g&&!y.u){y.Y=1;var H=y.Fa;fe||ye(),me||(fe(),me=!0),Z.add(H,y),y.v=0}}function Ft(y){return y.g||y.u||3<=y.v?!1:(y.Y++,y.u=Lt(f(y.Fa,y),Zr(y,y.v)),y.v++,!0)}t.Fa=function(){if(this.u=null,fr(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var y=2*this.R;this.j.info("BP detection timer enabled: "+y),this.A=Lt(f(this.ab,this),y)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Rt(10),Ho(this),fr(this))};function lr(y){y.A!=null&&(l.clearTimeout(y.A),y.A=null)}function fr(y){y.g=new Fe(y,y.j,"rpc",y.Y),y.m===null&&(y.g.H=y.o),y.g.O=0;var H=na(y.qa);Yr(H,"RID","rpc"),Yr(H,"SID",y.K),Yr(H,"AID",y.T),Yr(H,"CI",y.F?"0":"1"),!y.F&&y.ja&&Yr(H,"TO",y.ja),Yr(H,"TYPE","xmlhttp"),nt(y,H),y.m&&y.o&&Su(H,y.m,y.o),y.L&&(y.g.I=y.L);var ne=y.g;y=y.ia,ne.L=1,ne.v=Uc(na(H)),ne.m=null,ne.P=!0,Je(ne,y)}t.Za=function(){this.C!=null&&(this.C=null,Ho(this),Ft(this),Rt(19))};function Cr(y){y.C!=null&&(l.clearTimeout(y.C),y.C=null)}function Tr(y,H){var ne=null;if(y.g==H){Cr(y),lr(y),y.g=null;var ke=2}else if(Jn(y.h,H))ne=H.D,Ud(y.h,H),ke=1;else return;if(y.G!=0){if(H.o)if(ke==1){ne=H.m?H.m.length:0,H=Date.now()-H.F;var pt=y.B;ke=Ot(),Ue(ke,new er(ke,ne)),P(y)}else St(y);else if(pt=H.s,pt==3||pt==0&&0<H.X||!(ke==1&&Ae(y,H)||ke==2&&Ft(y)))switch(ne&&0<ne.length&&(H=y.h,H.i=H.i.concat(ne)),pt){case 1:gn(y,5);break;case 4:gn(y,10);break;case 3:gn(y,6);break;default:gn(y,2)}}}function Zr(y,H){let ne=y.Ta+Math.floor(Math.random()*y.cb);return y.isActive()||(ne*=2),ne*H}function gn(y,H){if(y.j.info("Error code "+H),H==2){var ne=f(y.fb,y),ke=y.Xa;const pt=!ke;ke=new Ln(ke||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Lc(ke,"https"),Uc(ke),pt?xm(ke.toString(),ne):vm(ke.toString(),ne)}else Rt(2);y.G=0,y.l&&y.l.sa(H),ms(y),ku(y)}t.fb=function(y){y?(this.j.info("Successfully pinged google.com"),Rt(2)):(this.j.info("Failed to ping google.com"),Rt(1))};function ms(y){if(y.G=0,y.ka=[],y.l){const H=Kn(y.h);(H.length!=0||y.i.length!=0)&&(g(y.ka,H),g(y.ka,y.i),y.h.i.length=0,p(y.i),y.i.length=0),y.l.ra()}}function yn(y,H,ne){var ke=ne instanceof Ln?na(ne):new Ln(ne);if(ke.g!="")H&&(ke.g=H+"."+ke.g),Od(ke,ke.s);else{var pt=l.location;ke=pt.protocol,H=H?H+"."+pt.hostname:pt.hostname,pt=+pt.port;var wt=new Ln(null);ke&&Lc(wt,ke),H&&(wt.g=H),pt&&Od(wt,pt),ne&&(wt.l=ne),ke=wt}return ne=y.D,H=y.ya,ne&&H&&Yr(ke,ne,H),Yr(ke,"VER",y.la),nt(y,ke),ke}function Es(y,H,ne){if(H&&!y.J)throw Error("Can't create secondary domain capable XhrIo object.");return H=y.Ca&&!y.pa?new Tn(new Qd({eb:ne})):new Tn(y.pa),H.Ha(y.J),H}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ps(){}t=ps.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Bs(){}Bs.prototype.g=function(y,H){return new gs(y,H)};function gs(y,H){lt.call(this),this.g=new Vo(H),this.l=y,this.h=H&&H.messageUrlParams||null,y=H&&H.messageHeaders||null,H&&H.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=H&&H.initMessageHeaders||null,H&&H.messageContentType&&(y?y["X-WebChannel-Content-Type"]=H.messageContentType:y={"X-WebChannel-Content-Type":H.messageContentType}),H&&H.va&&(y?y["X-WebChannel-Client-Profile"]=H.va:y={"X-WebChannel-Client-Profile":H.va}),this.g.S=y,(y=H&&H.Sb)&&!b(y)&&(this.g.m=y),this.v=H&&H.supportsCrossDomainXhr||!1,this.u=H&&H.sendRawJson||!1,(H=H&&H.httpSessionIdParam)&&!b(H)&&(this.g.D=H,y=this.h,y!==null&&H in y&&(y=this.h,H in y&&delete y[H])),this.j=new qo(this)}m(gs,lt),gs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gs.prototype.close=function(){Kd(this.g)},gs.prototype.o=function(y){var H=this.g;if(typeof y=="string"){var ne={};ne.__data__=y,y=ne}else this.u&&(ne={},ne.__data__=Oe(y),y=ne);H.i.push(new Fn(H.Ya++,y)),H.G==3&&P(H)},gs.prototype.N=function(){this.g.l=null,delete this.j,Kd(this.g),delete this.g,gs.aa.N.call(this)};function Vi(y){He.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var H=y.__sm__;if(H){e:{for(const ne in H){y=ne;break e}y=void 0}(this.i=y)&&(y=this.i,H=H!==null&&y in H?H[y]:void 0),this.data=H}else this.data=y}m(Vi,He);function Ko(){st.call(this),this.status=1}m(Ko,st);function qo(y){this.g=y}m(qo,ps),qo.prototype.ua=function(){Ue(this.g,"a")},qo.prototype.ta=function(y){Ue(this.g,new Vi(y))},qo.prototype.sa=function(y){Ue(this.g,new Ko)},qo.prototype.ra=function(){Ue(this.g,"b")},Bs.prototype.createWebChannel=Bs.prototype.g,gs.prototype.send=gs.prototype.o,gs.prototype.open=gs.prototype.m,gs.prototype.close=gs.prototype.close,s6=function(){return new Bs},n6=function(){return Ot()},r6=Ct,S_={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},pe.NO_ERROR=0,pe.TIMEOUT=8,pe.HTTP_ERROR=6,ay=pe,Be.COMPLETE="complete",t6=Be,Me.EventType=We,We.OPEN="a",We.CLOSE="b",We.ERROR="c",We.MESSAGE="d",lt.prototype.listen=lt.prototype.K,pp=Me,Tn.prototype.listenOnce=Tn.prototype.L,Tn.prototype.getLastError=Tn.prototype.Ka,Tn.prototype.getLastErrorCode=Tn.prototype.Ba,Tn.prototype.getStatus=Tn.prototype.Z,Tn.prototype.getResponseJson=Tn.prototype.Oa,Tn.prototype.getResponseText=Tn.prototype.oa,Tn.prototype.send=Tn.prototype.ea,Tn.prototype.setWithCredentials=Tn.prototype.Ha,e6=Tn}).apply(typeof Pv<"u"?Pv:typeof self<"u"?self:typeof window<"u"?window:{});const yj="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ha.UNAUTHENTICATED=new Ha(null),Ha.GOOGLE_CREDENTIALS=new Ha("google-credentials-uid"),Ha.FIRST_PARTY=new Ha("first-party-uid"),Ha.MOCK_USER=new Ha("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rm="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ih=new HB("@firebase/firestore");function Mf(){return Ih.logLevel}function Ht(t,...e){if(Ih.logLevel<=rn.DEBUG){const r=e.map(sS);Ih.debug(`Firestore (${rm}): ${t}`,...r)}}function Pi(t,...e){if(Ih.logLevel<=rn.ERROR){const r=e.map(sS);Ih.error(`Firestore (${rm}): ${t}`,...r)}}function nu(t,...e){if(Ih.logLevel<=rn.WARN){const r=e.map(sS);Ih.warn(`Firestore (${rm}): ${t}`,...r)}}function sS(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(t="Unexpected state"){const e=`FIRESTORE (${rm}) INTERNAL ASSERTION FAILED: `+t;throw Pi(e),new Error(e)}function xr(t,e){t||hr()}function Fr(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Wt extends Td{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class i6{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Ha.UNAUTHENTICATED))}shutdown(){}}class Oz{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Mz{constructor(e){this.t=e,this.currentUser=Ha.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){xr(this.o===void 0);let n=this.i;const s=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let i=new Ml;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ml,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{Ht("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Ht("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ml)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ht("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(xr(typeof n.accessToken=="string"),new a6(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return xr(e===null||typeof e=="string"),new Ha(e)}}class Qz{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Ha.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Vz{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Qz(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Ha.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Hz{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Kz{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){xr(this.o===void 0);const n=i=>{i.error!=null&&Ht("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,Ht("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{Ht("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):Ht("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(xr(typeof r.token=="string"),this.R=r.token,new Hz(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qz(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=qz(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%e.length))}return n}}function Lr(t,e){return t<e?-1:t>e?1:0}function R0(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}function o6(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Wt(Bt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Wt(Bt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Wt(Bt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Wt(Bt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return $t.fromMillis(Date.now())}static fromDate(e){return $t.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new $t(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Lr(this.nanoseconds,e.nanoseconds):Lr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e){this.timestamp=e}static fromTimestamp(e){return new br(e)}static min(){return new br(new $t(0,0))}static max(){return new br(new $t(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e,r,n){r===void 0?r=0:r>e.length&&hr(),n===void 0?n=e.length-r:n>e.length-r&&hr(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Pg.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Pg?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=e.get(s),o=r.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class pn extends Pg{construct(e,r,n){return new pn(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Wt(Bt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new pn(r)}static emptyPath(){return new pn([])}}const Gz=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class As extends Pg{construct(e,r,n){return new As(e,r,n)}static isValidIdentifier(e){return Gz.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),As.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new As(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new Wt(Bt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new Wt(Bt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Wt(Bt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(n+=l,s++):(i(),s++)}if(i(),o)throw new Wt(Bt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new As(r)}static emptyPath(){return new As([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e){this.path=e}static fromPath(e){return new sr(pn.fromString(e))}static fromName(e){return new sr(pn.fromString(e).popFirst(5))}static empty(){return new sr(pn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return pn.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new sr(new pn(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e,r,n,s){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=s}}function I_(t){return t.fields.find(e=>e.kind===2)}function Gu(t){return t.fields.filter(e=>e.kind!==2)}Yy.UNKNOWN_ID=-1;class iy{constructor(e,r){this.fieldPath=e,this.kind=r}}class Rg{constructor(e,r){this.sequenceNumber=e,this.offset=r}static empty(){return new Rg(0,Fo.min())}}function $z(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=br.fromTimestamp(n===1e9?new $t(r+1,0):new $t(r,n));return new Fo(s,sr.empty(),e)}function l6(t){return new Fo(t.readTime,t.key,-1)}class Fo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Fo(br.min(),sr.empty(),-1)}static max(){return new Fo(br.max(),sr.empty(),-1)}}function iS(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=sr.comparator(t.documentKey,e.documentKey),r!==0?r:Lr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class d6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gh(t){if(t.code!==Bt.FAILED_PRECONDITION||t.message!==c6)throw t;Ht("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&hr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new bt((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof bt?r:bt.resolve(r)}catch(r){return bt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):bt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):bt.reject(r)}static resolve(e){return new bt((r,n)=>{r(e)})}static reject(e){return new bt((r,n)=>{n(e)})}static waitFor(e){return new bt((r,n)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&r()},c=>n(c))}),o=!0,i===s&&r()})}static or(e){let r=bt.resolve(!1);for(const n of e)r=r.next(s=>s?bt.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new bt((n,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const d=c;r(e[d]).next(A=>{o[d]=A,++l,l===i&&n(o)},A=>s(A))}})}static doWhile(e,r){return new bt((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l2{constructor(e,r){this.action=e,this.transaction=r,this.aborted=!1,this.V=new Ml,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{r.error?this.V.reject(new Qp(e,r.error)):this.V.resolve()},this.transaction.onerror=n=>{const s=oS(n.target.error);this.V.reject(new Qp(e,s))}}static open(e,r,n,s){try{return new l2(r,e.transaction(s,n))}catch(i){throw new Qp(r,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Ht("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const r=this.transaction.objectStore(e);return new Wz(r)}}class XA{constructor(e,r,n){this.name=e,this.version=r,this.p=n,XA.S(ga())===12.2&&Pi("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Ht("SimpleDb","Removing database:",e),Wu(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!uL())return!1;if(XA.v())return!0;const e=ga(),r=XA.S(e),n=0<r&&r<10,s=A6(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,r){return e.store(r)}static S(e){const r=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(Ht("SimpleDb","Opening database:",this.name),this.db=await new Promise((r,n)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;r(o)},s.onblocked=()=>{n(new Qp(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?n(new Wt(Bt.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new Wt(Bt.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new Qp(e,o))},s.onupgradeneeded=i=>{Ht("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{Ht("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=r=>this.N(r)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=r=>e(r))}async runTransaction(e,r,n,s){const i=r==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=l2.open(this.db,e,i?"readonly":"readwrite",n),c=s(l).next(d=>(l.g(),d)).catch(d=>(l.abort(d),bt.reject(d))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,d=c.name!=="FirebaseError"&&o<3;if(Ht("SimpleDb","Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function A6(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class zz{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Wu(this.B.delete())}}class Qp extends Wt{constructor(e,r){super(Bt.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function bu(t){return t.name==="IndexedDbTransactionError"}class Wz{constructor(e){this.store=e}put(e,r){let n;return r!==void 0?(Ht("SimpleDb","PUT",this.store.name,e,r),n=this.store.put(r,e)):(Ht("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Wu(n)}add(e){return Ht("SimpleDb","ADD",this.store.name,e,e),Wu(this.store.add(e))}get(e){return Wu(this.store.get(e)).next(r=>(r===void 0&&(r=null),Ht("SimpleDb","GET",this.store.name,e,r),r))}delete(e){return Ht("SimpleDb","DELETE",this.store.name,e),Wu(this.store.delete(e))}count(){return Ht("SimpleDb","COUNT",this.store.name),Wu(this.store.count())}U(e,r){const n=this.options(e,r),s=n.index?this.store.index(n.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(n.range);return new bt((o,l)=>{i.onerror=c=>{l(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(n),o=[];return this.W(i,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,r){const n=this.store.getAll(e,r===null?void 0:r);return new bt((s,i)=>{n.onerror=o=>{i(o.target.error)},n.onsuccess=o=>{s(o.target.result)}})}j(e,r){Ht("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,r);n.H=!1;const s=this.cursor(n);return this.W(s,(i,o,l)=>l.delete())}J(e,r){let n;r?n=e:(n={},r=e);const s=this.cursor(n);return this.W(s,r)}Y(e){const r=this.cursor({});return new bt((n,s)=>{r.onerror=i=>{const o=oS(i.target.error);s(o)},r.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():n()}):n()}})}W(e,r){const n=[];return new bt((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void s();const c=new zz(l),d=r(l.primaryKey,l.value,c);if(d instanceof bt){const A=d.catch(u=>(c.done(),bt.reject(u)));n.push(A)}c.isDone?s():c.K===null?l.continue():l.continue(c.K)}}).next(()=>bt.waitFor(n))}options(e,r){let n;return e!==void 0&&(typeof e=="string"?n=e:r=e),{index:n,range:r}}cursor(e){let r="next";if(e.reverse&&(r="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,r):n.openCursor(e.range,r)}return this.store.openCursor(e.range,r)}}function Wu(t){return new bt((e,r)=>{t.onsuccess=n=>{const s=n.target.result;e(s)},t.onerror=n=>{const s=oS(n.target.error);r(s)}})}let bj=!1;function oS(t){const e=XA.S(ga());if(e>=12.2&&e<13){const r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){const n=new Wt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return bj||(bj=!0,setTimeout(()=>{throw n},0)),n}}return t}class Jz{constructor(e,r){this.asyncQueue=e,this.Z=r,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){Ht("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Ht("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(r){bu(r)?Ht("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",r):await Gh(r)}await this.X(6e4)})}}class Xz{constructor(e,r){this.localStore=e,this.persistence=r}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.te(r,e))}te(e,r){const n=new Set;let s=r,i=!0;return bt.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return Ht("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(l=>{s-=l,n.add(o)});i=!1})).next(()=>r-s)}ne(e,r,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,r).next(s=>this.localStore.localDocuments.getNextDocuments(e,r,s,n).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(l=>(Ht("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,r,l))).next(()=>o.size)}))}re(e,r){let n=e;return r.changes.forEach((s,i)=>{const o=l6(i);iS(o,n)>0&&(n=o)}),new Fo(n.readTime,n.documentKey,Math.max(r.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}cl.oe=-1;function Ix(t){return t==null}function Dg(t){return t===0&&1/t==-1/0}function Yz(t){return typeof t=="number"&&Number.isInteger(t)&&!Dg(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Di(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=wj(e)),e=Zz(t.get(r),e);return wj(e)}function Zz(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const i=t.charAt(s);switch(i){case"\0":r+="";break;case"":r+="";break;default:r+=i}}return r}function wj(t){return t+""}function vc(t){const e=t.length;if(xr(e>=2),e===2)return xr(t.charAt(0)===""&&t.charAt(1)===""),pn.emptyPath();const r=e-2,n=[];let s="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>r)&&hr(),t.charAt(o+1)){case"":const l=t.substring(i,o);let c;s.length===0?c=l:(s+=l,c=s,s=""),n.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:hr()}i=o+2}return new pn(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nj=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oy(t,e){return[t,Di(e)]}function u6(t,e,r){return[t,Di(e),r]}const eW={},tW=["prefixPath","collectionGroup","readTime","documentId"],rW=["prefixPath","collectionGroup","documentId"],nW=["collectionGroup","readTime","prefixPath","documentId"],sW=["canonicalId","targetId"],aW=["targetId","path"],iW=["path","targetId"],oW=["collectionId","parent"],lW=["indexId","uid"],cW=["uid","sequenceNumber"],dW=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],AW=["indexId","uid","orderedDocumentKey"],uW=["userId","collectionPath","documentId"],hW=["userId","collectionPath","largestBatchId"],fW=["userId","collectionGroup","largestBatchId"],h6=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],mW=[...h6,"documentOverlays"],f6=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],m6=f6,lS=[...m6,"indexConfiguration","indexState","indexEntries"],pW=lS,gW=[...lS,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_ extends d6{constructor(e,r){super(),this._e=e,this.currentSequenceNumber=r}}function va(t,e){const r=Fr(t);return XA.F(r._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cj(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function $h(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function p6(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e,r){this.comparator=e,this.root=r||Ka.EMPTY}insert(e,r){return new fs(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Ka.BLACK,null,null))}remove(e){return new fs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ka.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rv(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rv(this.root,e,this.comparator,!0)}}class Rv{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ka{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??Ka.RED,this.left=s??Ka.EMPTY,this.right=i??Ka.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new Ka(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ka.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return Ka.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ka.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ka.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw hr();const e=this.left.check();if(e!==this.right.check())throw hr();return e+(this.isRed()?0:1)}}Ka.EMPTY=null,Ka.RED=!0,Ka.BLACK=!1;Ka.EMPTY=new class{constructor(){this.size=0}get key(){throw hr()}get value(){throw hr()}get color(){throw hr()}get left(){throw hr()}get right(){throw hr()}copy(e,r,n,s,i){return this}insert(e,r,n){return new Ka(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.comparator=e,this.data=new fs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new _j(this.data.getIterator())}getIteratorFrom(e){return new _j(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Dn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Dn(this.comparator);return r.data=e,r}}class _j{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function xf(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e){this.fields=e,e.sort(As.comparator)}static empty(){return new Yi([])}unionWith(e){let r=new Dn(As.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Yi(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return R0(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new g6("Invalid base64 string: "+i):i}}(e);return new Ws(r)}static fromUint8Array(e){const r=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Ws(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Lr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ws.EMPTY_BYTE_STRING=new Ws("");const xW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Id(t){if(xr(!!t),typeof t=="string"){let e=0;const r=xW.exec(t);if(xr(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ls(t.seconds),nanos:ls(t.nanos)}}function ls(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function su(t){return typeof t=="string"?Ws.fromBase64String(t):Ws.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cS(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function dS(t){const e=t.mapValue.fields.__previous_value__;return cS(e)?dS(e):e}function Lg(t){const e=Id(t.mapValue.fields.__local_write_time__.timestampValue);return new $t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vW{constructor(e,r,n,s,i,o,l,c,d){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=d}}class au{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new au("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof au&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FA={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ly={nullValue:"NULL_VALUE"};function jh(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?cS(t)?4:x6(t)?9007199254740991:c2(t)?10:11:hr()}function Bc(t,e){if(t===e)return!0;const r=jh(t);if(r!==jh(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Lg(t).isEqual(Lg(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Id(s.timestampValue),l=Id(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return su(s.bytesValue).isEqual(su(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ls(s.geoPointValue.latitude)===ls(i.geoPointValue.latitude)&&ls(s.geoPointValue.longitude)===ls(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ls(s.integerValue)===ls(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ls(s.doubleValue),l=ls(i.doubleValue);return o===l?Dg(o)===Dg(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return R0(t.arrayValue.values||[],e.arrayValue.values||[],Bc);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(Cj(o)!==Cj(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Bc(o[c],l[c])))return!1;return!0}(t,e);default:return hr()}}function Ug(t,e){return(t.values||[]).find(r=>Bc(r,e))!==void 0}function iu(t,e){if(t===e)return 0;const r=jh(t),n=jh(e);if(r!==n)return Lr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Lr(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=ls(i.integerValue||i.doubleValue),c=ls(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return Ej(t.timestampValue,e.timestampValue);case 4:return Ej(Lg(t),Lg(e));case 5:return Lr(t.stringValue,e.stringValue);case 6:return function(i,o){const l=su(i),c=su(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let d=0;d<l.length&&d<c.length;d++){const A=Lr(l[d],c[d]);if(A!==0)return A}return Lr(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Lr(ls(i.latitude),ls(o.latitude));return l!==0?l:Lr(ls(i.longitude),ls(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Bj(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,d,A;const u=i.fields||{},f=o.fields||{},h=(l=u.value)===null||l===void 0?void 0:l.arrayValue,m=(c=f.value)===null||c===void 0?void 0:c.arrayValue,p=Lr(((d=h==null?void 0:h.values)===null||d===void 0?void 0:d.length)||0,((A=m==null?void 0:m.values)===null||A===void 0?void 0:A.length)||0);return p!==0?p:Bj(h,m)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===FA.mapValue&&o===FA.mapValue)return 0;if(i===FA.mapValue)return 1;if(o===FA.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),d=o.fields||{},A=Object.keys(d);c.sort(),A.sort();for(let u=0;u<c.length&&u<A.length;++u){const f=Lr(c[u],A[u]);if(f!==0)return f;const h=iu(l[c[u]],d[A[u]]);if(h!==0)return h}return Lr(c.length,A.length)}(t.mapValue,e.mapValue);default:throw hr()}}function Ej(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Lr(t,e);const r=Id(t),n=Id(e),s=Lr(r.seconds,n.seconds);return s!==0?s:Lr(r.nanos,n.nanos)}function Bj(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=iu(r[s],n[s]);if(i)return i}return Lr(r.length,n.length)}function D0(t){return k_(t)}function k_(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Id(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return su(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return sr.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=k_(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const o of n)i?i=!1:s+=",",s+=`${o}:${k_(r.fields[o])}`;return s+"}"}(t.mapValue):hr()}function Og(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function F_(t){return!!t&&"integerValue"in t}function Mg(t){return!!t&&"arrayValue"in t}function Sj(t){return!!t&&"nullValue"in t}function Ij(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function cy(t){return!!t&&"mapValue"in t}function c2(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Vp(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return $h(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Vp(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Vp(t.arrayValue.values[r]);return e}return Object.assign({},t)}function x6(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const v6={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function yW(t){return"nullValue"in t?ly:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Og(au.empty(),sr.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?c2(t)?v6:{mapValue:{}}:hr()}function bW(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Og(au.empty(),sr.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?v6:"mapValue"in t?c2(t)?{mapValue:{}}:FA:hr()}function jj(t,e){const r=iu(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function kj(t,e){const r=iu(t.value,e.value);return r!==0?r:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e){this.value=e}static empty(){return new $a({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!cy(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vp(r)}setAll(e){let r=As.emptyPath(),n={},s=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,s),n={},s=[],r=l.popLast()}o?n[l.lastSegment()]=Vp(o):s.push(l.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());cy(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Bc(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];cy(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){$h(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new $a(Vp(this.value))}}function y6(t){const e=[];return $h(t.fields,(r,n)=>{const s=new As([r]);if(cy(n)){const i=y6(n.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Yi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e,r,n,s,i,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new ds(e,0,br.min(),br.min(),br.min(),$a.empty(),0)}static newFoundDocument(e,r,n,s){return new ds(e,1,r,br.min(),n,s,0)}static newNoDocument(e,r){return new ds(e,2,r,br.min(),br.min(),$a.empty(),0)}static newUnknownDocument(e,r){return new ds(e,3,r,br.min(),br.min(),$a.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(br.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$a.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$a.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=br.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ds&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ds(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(e,r){this.position=e,this.inclusive=r}}function Fj(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?n=sr.comparator(sr.fromName(o.referenceValue),r.key):n=iu(o,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function Tj(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Bc(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e,r="asc"){this.field=e,this.dir=r}}function wW(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{}class nn extends b6{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new NW(e,r,n):r==="array-contains"?new EW(e,n):r==="in"?new B6(e,n):r==="not-in"?new BW(e,n):r==="array-contains-any"?new SW(e,n):new nn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new CW(e,n):new _W(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(iu(r,this.value)):r!==null&&jh(this.value)===jh(r)&&this.matchesComparison(iu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return hr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class In extends b6{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new In(e,r)}matches(e){return U0(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function U0(t){return t.op==="and"}function T_(t){return t.op==="or"}function AS(t){return w6(t)&&U0(t)}function w6(t){for(const e of t.filters)if(e instanceof In)return!1;return!0}function P_(t){if(t instanceof nn)return t.field.canonicalString()+t.op.toString()+D0(t.value);if(AS(t))return t.filters.map(e=>P_(e)).join(",");{const e=t.filters.map(r=>P_(r)).join(",");return`${t.op}(${e})`}}function N6(t,e){return t instanceof nn?function(n,s){return s instanceof nn&&n.op===s.op&&n.field.isEqual(s.field)&&Bc(n.value,s.value)}(t,e):t instanceof In?function(n,s){return s instanceof In&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,o,l)=>i&&N6(o,s.filters[l]),!0):!1}(t,e):void hr()}function C6(t,e){const r=t.filters.concat(e);return In.create(r,t.op)}function _6(t){return t instanceof nn?function(r){return`${r.field.canonicalString()} ${r.op} ${D0(r.value)}`}(t):t instanceof In?function(r){return r.op.toString()+" {"+r.getFilters().map(_6).join(" ,")+"}"}(t):"Filter"}class NW extends nn{constructor(e,r,n){super(e,r,n),this.key=sr.fromName(n.referenceValue)}matches(e){const r=sr.comparator(e.key,this.key);return this.matchesComparison(r)}}class CW extends nn{constructor(e,r){super(e,"in",r),this.keys=E6("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class _W extends nn{constructor(e,r){super(e,"not-in",r),this.keys=E6("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function E6(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>sr.fromName(n.referenceValue))}class EW extends nn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Mg(r)&&Ug(r.arrayValue,this.value)}}class B6 extends nn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Ug(this.value.arrayValue,r)}}class BW extends nn{constructor(e,r){super(e,"not-in",r)}matches(e){if(Ug(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Ug(this.value.arrayValue,r)}}class SW extends nn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Mg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Ug(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IW{constructor(e,r=null,n=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function R_(t,e=null,r=[],n=[],s=null,i=null,o=null){return new IW(t,e,r,n,s,i,o)}function kh(t){const e=Fr(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>P_(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),Ix(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>D0(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>D0(n)).join(",")),e.ue=r}return e.ue}function jx(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!wW(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!N6(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Tj(t.startAt,e.startAt)&&Tj(t.endAt,e.endAt)}function Zy(t){return sr.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function eb(t,e){return t.filters.filter(r=>r instanceof nn&&r.field.isEqual(e))}function Pj(t,e,r){let n=ly,s=!0;for(const i of eb(t,e)){let o=ly,l=!0;switch(i.op){case"<":case"<=":o=yW(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=ly}jj({value:n,inclusive:s},{value:o,inclusive:l})<0&&(n=o,s=l)}if(r!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=r.position[i];jj({value:n,inclusive:s},{value:o,inclusive:r.inclusive})<0&&(n=o,s=r.inclusive);break}}return{value:n,inclusive:s}}function Rj(t,e,r){let n=FA,s=!0;for(const i of eb(t,e)){let o=FA,l=!0;switch(i.op){case">=":case">":o=bW(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=FA}kj({value:n,inclusive:s},{value:o,inclusive:l})>0&&(n=o,s=l)}if(r!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=r.position[i];kj({value:n,inclusive:s},{value:o,inclusive:r.inclusive})>0&&(n=o,s=r.inclusive);break}}return{value:n,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(e,r=null,n=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function jW(t,e,r,n,s,i,o,l){return new nm(t,e,r,n,s,i,o,l)}function kx(t){return new nm(t)}function Dj(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function S6(t){return t.collectionGroup!==null}function Hp(t){const e=Fr(t);if(e.ce===null){e.ce=[];const r=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Dn(As.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Qg(i,n))}),r.has(As.keyField().canonicalString())||e.ce.push(new Qg(As.keyField(),n))}return e.ce}function hl(t){const e=Fr(t);return e.le||(e.le=kW(e,Hp(t))),e.le}function kW(t,e){if(t.limitType==="F")return R_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Qg(s.field,i)});const r=t.endAt?new L0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new L0(t.startAt.position,t.startAt.inclusive):null;return R_(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function D_(t,e){const r=t.filters.concat([e]);return new nm(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function tb(t,e,r){return new nm(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function d2(t,e){return jx(hl(t),hl(e))&&t.limitType===e.limitType}function I6(t){return`${kh(hl(t))}|lt:${t.limitType}`}function Qf(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>_6(s)).join(", ")}]`),Ix(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>D0(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>D0(s)).join(",")),`Target(${n})`}(hl(t))}; limitType=${t.limitType})`}function Fx(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):sr.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of Hp(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(o,l,c){const d=Fj(o,l,c);return o.inclusive?d<=0:d<0}(n.startAt,Hp(n),s)||n.endAt&&!function(o,l,c){const d=Fj(o,l,c);return o.inclusive?d>=0:d>0}(n.endAt,Hp(n),s))}(t,e)}function FW(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function j6(t){return(e,r)=>{let n=!1;for(const s of Hp(t)){const i=TW(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function TW(t,e,r){const n=t.field.isKeyField()?sr.comparator(e.key,r.key):function(i,o,l){const c=o.data.field(i),d=l.data.field(i);return c!==null&&d!==null?iu(c,d):hr()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return hr()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){$h(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return p6(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PW=new fs(sr.comparator);function So(){return PW}const k6=new fs(sr.comparator);function gp(...t){let e=k6;for(const r of t)e=e.insert(r.key,r);return e}function F6(t){let e=k6;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function yc(){return Kp()}function T6(){return Kp()}function Kp(){return new wu(t=>t.toString(),(t,e)=>t.isEqual(e))}const RW=new fs(sr.comparator),DW=new Dn(sr.comparator);function qr(...t){let e=DW;for(const r of t)e=e.add(r);return e}const LW=new Dn(Lr);function UW(){return LW}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dg(e)?"-0":e}}function P6(t){return{integerValue:""+t}}function OW(t,e){return Yz(e)?P6(e):uS(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2{constructor(){this._=void 0}}function MW(t,e,r){return t instanceof Vg?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&cS(i)&&(i=dS(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(r,e):t instanceof O0?D6(t,e):t instanceof M0?L6(t,e):function(s,i){const o=R6(s,i),l=Lj(o)+Lj(s.Pe);return F_(o)&&F_(s.Pe)?P6(l):uS(s.serializer,l)}(t,e)}function QW(t,e,r){return t instanceof O0?D6(t,e):t instanceof M0?L6(t,e):r}function R6(t,e){return t instanceof Hg?function(n){return F_(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class Vg extends A2{}class O0 extends A2{constructor(e){super(),this.elements=e}}function D6(t,e){const r=U6(e);for(const n of t.elements)r.some(s=>Bc(s,n))||r.push(n);return{arrayValue:{values:r}}}class M0 extends A2{constructor(e){super(),this.elements=e}}function L6(t,e){let r=U6(e);for(const n of t.elements)r=r.filter(s=>!Bc(s,n));return{arrayValue:{values:r}}}class Hg extends A2{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function Lj(t){return ls(t.integerValue||t.doubleValue)}function U6(t){return Mg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VW{constructor(e,r){this.field=e,this.transform=r}}function HW(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof O0&&s instanceof O0||n instanceof M0&&s instanceof M0?R0(n.elements,s.elements,Bc):n instanceof Hg&&s instanceof Hg?Bc(n.Pe,s.Pe):n instanceof Vg&&s instanceof Vg}(t.transform,e.transform)}class KW{constructor(e,r){this.version=e,this.transformResults=r}}class us{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new us}static exists(e){return new us(void 0,e)}static updateTime(e){return new us(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function dy(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class u2{}function O6(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new am(t.key,us.none()):new sm(t.key,t.data,us.none());{const r=t.data,n=$a.empty();let s=new Dn(As.comparator);for(let i of e.fields)if(!s.has(i)){let o=r.field(i);o===null&&i.length>1&&(i=i.popLast(),o=r.field(i)),o===null?n.delete(i):n.set(i,o),s=s.add(i)}return new Pd(t.key,n,new Yi(s.toArray()),us.none())}}function qW(t,e,r){t instanceof sm?function(s,i,o){const l=s.value.clone(),c=Oj(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof Pd?function(s,i,o){if(!dy(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Oj(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(M6(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function qp(t,e,r,n){return t instanceof sm?function(i,o,l,c){if(!dy(i.precondition,o))return l;const d=i.value.clone(),A=Mj(i.fieldTransforms,c,o);return d.setAll(A),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof Pd?function(i,o,l,c){if(!dy(i.precondition,o))return l;const d=Mj(i.fieldTransforms,c,o),A=o.data;return A.setAll(M6(i)),A.setAll(d),o.convertToFoundDocument(o.version,A).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(u=>u.field))}(t,e,r,n):function(i,o,l){return dy(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function GW(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=R6(n.transform,s||null);i!=null&&(r===null&&(r=$a.empty()),r.set(n.field,i))}return r||null}function Uj(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&R0(n,s,(i,o)=>HW(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class sm extends u2{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Pd extends u2{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function M6(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Oj(t,e,r){const n=new Map;xr(t.length===r.length);for(let s=0;s<r.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);n.set(i.field,QW(o,l,r[s]))}return n}function Mj(t,e,r){const n=new Map;for(const s of t){const i=s.transform,o=r.data.field(s.field);n.set(s.field,MW(i,o,e))}return n}class am extends u2{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hS extends u2{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&qW(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=qp(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=qp(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=T6();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=r.has(s.key)?null:l;const c=O6(o,l);c!==null&&n.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(br.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),qr())}isEqual(e){return this.batchId===e.batchId&&R0(this.mutations,e.mutations,(r,n)=>Uj(r,n))&&R0(this.baseMutations,e.baseMutations,(r,n)=>Uj(r,n))}}class mS{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){xr(e.mutations.length===n.length);let s=function(){return RW}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,n[o].version);return new mS(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $W{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ys,ln;function Q6(t){switch(t){default:return hr();case Bt.CANCELLED:case Bt.UNKNOWN:case Bt.DEADLINE_EXCEEDED:case Bt.RESOURCE_EXHAUSTED:case Bt.INTERNAL:case Bt.UNAVAILABLE:case Bt.UNAUTHENTICATED:return!1;case Bt.INVALID_ARGUMENT:case Bt.NOT_FOUND:case Bt.ALREADY_EXISTS:case Bt.PERMISSION_DENIED:case Bt.FAILED_PRECONDITION:case Bt.ABORTED:case Bt.OUT_OF_RANGE:case Bt.UNIMPLEMENTED:case Bt.DATA_LOSS:return!0}}function V6(t){if(t===void 0)return Pi("GRPC error has no .code"),Bt.UNKNOWN;switch(t){case Ys.OK:return Bt.OK;case Ys.CANCELLED:return Bt.CANCELLED;case Ys.UNKNOWN:return Bt.UNKNOWN;case Ys.DEADLINE_EXCEEDED:return Bt.DEADLINE_EXCEEDED;case Ys.RESOURCE_EXHAUSTED:return Bt.RESOURCE_EXHAUSTED;case Ys.INTERNAL:return Bt.INTERNAL;case Ys.UNAVAILABLE:return Bt.UNAVAILABLE;case Ys.UNAUTHENTICATED:return Bt.UNAUTHENTICATED;case Ys.INVALID_ARGUMENT:return Bt.INVALID_ARGUMENT;case Ys.NOT_FOUND:return Bt.NOT_FOUND;case Ys.ALREADY_EXISTS:return Bt.ALREADY_EXISTS;case Ys.PERMISSION_DENIED:return Bt.PERMISSION_DENIED;case Ys.FAILED_PRECONDITION:return Bt.FAILED_PRECONDITION;case Ys.ABORTED:return Bt.ABORTED;case Ys.OUT_OF_RANGE:return Bt.OUT_OF_RANGE;case Ys.UNIMPLEMENTED:return Bt.UNIMPLEMENTED;case Ys.DATA_LOSS:return Bt.DATA_LOSS;default:return hr()}}(ln=Ys||(Ys={}))[ln.OK=0]="OK",ln[ln.CANCELLED=1]="CANCELLED",ln[ln.UNKNOWN=2]="UNKNOWN",ln[ln.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ln[ln.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ln[ln.NOT_FOUND=5]="NOT_FOUND",ln[ln.ALREADY_EXISTS=6]="ALREADY_EXISTS",ln[ln.PERMISSION_DENIED=7]="PERMISSION_DENIED",ln[ln.UNAUTHENTICATED=16]="UNAUTHENTICATED",ln[ln.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ln[ln.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ln[ln.ABORTED=10]="ABORTED",ln[ln.OUT_OF_RANGE=11]="OUT_OF_RANGE",ln[ln.UNIMPLEMENTED=12]="UNIMPLEMENTED",ln[ln.INTERNAL=13]="INTERNAL",ln[ln.UNAVAILABLE=14]="UNAVAILABLE",ln[ln.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zW(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WW=new dh([4294967295,4294967295],0);function Qj(t){const e=zW().encode(t),r=new ZL;return r.update(e),new Uint8Array(r.digest())}function Vj(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new dh([r,n],0),new dh([s,i],0)]}class gS{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new xp(`Invalid padding: ${r}`);if(n<0)throw new xp(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new xp(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new xp(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=dh.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(dh.fromNumber(n)));return s.compare(WW)===1&&(s=new dh([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=Qj(e),[n,s]=Vj(r);for(let i=0;i<this.hashCount;i++){const o=this.Ee(n,s,i);if(!this.de(o))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new gS(i,s,r);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const r=Qj(e),[n,s]=Vj(r);for(let i=0;i<this.hashCount;i++){const o=this.Ee(n,s,i);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class xp extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Tx.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new h2(br.min(),s,new fs(Lr),So(),qr())}}class Tx{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Tx(n,r,qr(),qr(),qr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class H6{constructor(e,r){this.targetId=e,this.me=r}}class K6{constructor(e,r,n=Ws.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class Hj{constructor(){this.fe=0,this.ge=qj(),this.pe=Ws.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=qr(),r=qr(),n=qr();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:hr()}}),new Tx(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=qj()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,xr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class JW{constructor(e){this.Le=e,this.Be=new Map,this.ke=So(),this.qe=Kj(),this.Qe=new fs(Lr)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:hr()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const i=s.target;if(Zy(i))if(n===0){const o=new sr(i.path);this.Ue(r,o,ds.newNoDocument(o,br.min()))}else xr(n===1);else{const o=this.Ye(r);if(o!==n){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(r);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,d)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let o,l;try{o=su(n).toUint8Array()}catch(c){if(c instanceof g6)return nu("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new gS(o,s,i)}catch(c){return nu(c instanceof xp?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(r,i,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&Zy(l.target)){const c=new sr(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,ds.newNoDocument(c,e))}i.be&&(r.set(o,i.ve()),i.Ce())}});let n=qr();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const d=this.Je(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new h2(e,r,this.Qe,this.ke,n);return this.ke=So(),this.qe=Kj(),this.Qe=new fs(Lr),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new Hj,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Dn(Lr),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Ht("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Hj),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function Kj(){return new fs(sr.comparator)}function qj(){return new fs(sr.comparator)}const XW={asc:"ASCENDING",desc:"DESCENDING"},YW={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ZW={and:"AND",or:"OR"};class eJ{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function L_(t,e){return t.useProto3Json||Ix(e)?e:{value:e}}function Q0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function q6(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function tJ(t,e){return Q0(t,e.toTimestamp())}function ja(t){return xr(!!t),br.fromTimestamp(function(r){const n=Id(r);return new $t(n.seconds,n.nanos)}(t))}function xS(t,e){return U_(t,e).canonicalString()}function U_(t,e){const r=function(s){return new pn(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function G6(t){const e=pn.fromString(t);return xr(tU(e)),e}function Kg(t,e){return xS(t.databaseId,e.path)}function md(t,e){const r=G6(e);if(r.get(1)!==t.databaseId.projectId)throw new Wt(Bt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Wt(Bt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new sr(W6(r))}function $6(t,e){return xS(t.databaseId,e)}function z6(t){const e=G6(t);return e.length===4?pn.emptyPath():W6(e)}function O_(t){return new pn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function W6(t){return xr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Gj(t,e,r){return{name:Kg(t,e),fields:r.value.mapValue.fields}}function rJ(t,e,r){const n=md(t,e.name),s=ja(e.updateTime),i=e.createTime?ja(e.createTime):br.min(),o=new $a({mapValue:{fields:e.fields}}),l=ds.newFoundDocument(n,s,i,o);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function nJ(t,e){return"found"in e?function(n,s){xr(!!s.found),s.found.name,s.found.updateTime;const i=md(n,s.found.name),o=ja(s.found.updateTime),l=s.found.createTime?ja(s.found.createTime):br.min(),c=new $a({mapValue:{fields:s.found.fields}});return ds.newFoundDocument(i,o,l,c)}(t,e):"missing"in e?function(n,s){xr(!!s.missing),xr(!!s.readTime);const i=md(n,s.missing),o=ja(s.readTime);return ds.newNoDocument(i,o)}(t,e):hr()}function sJ(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:hr()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,A){return d.useProto3Json?(xr(A===void 0||typeof A=="string"),Ws.fromBase64String(A||"")):(xr(A===void 0||A instanceof Buffer||A instanceof Uint8Array),Ws.fromUint8Array(A||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const A=d.code===void 0?Bt.UNKNOWN:V6(d.code);return new Wt(A,d.message||"")}(o);r=new K6(n,s,i,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=md(t,n.document.name),i=ja(n.document.updateTime),o=n.document.createTime?ja(n.document.createTime):br.min(),l=new $a({mapValue:{fields:n.document.fields}}),c=ds.newFoundDocument(s,i,o,l),d=n.targetIds||[],A=n.removedTargetIds||[];r=new Ay(d,A,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=md(t,n.document),i=n.readTime?ja(n.readTime):br.min(),o=ds.newNoDocument(s,i),l=n.removedTargetIds||[];r=new Ay([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=md(t,n.document),i=n.removedTargetIds||[];r=new Ay([],i,s,null)}else{if(!("filter"in e))return hr();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,o=new $W(s,i),l=n.targetId;r=new H6(l,o)}}return r}function qg(t,e){let r;if(e instanceof sm)r={update:Gj(t,e.key,e.value)};else if(e instanceof am)r={delete:Kg(t,e.key)};else if(e instanceof Pd)r={update:Gj(t,e.key,e.data),updateMask:dJ(e.fieldMask)};else{if(!(e instanceof hS))return hr();r={verify:Kg(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,o){const l=o.transform;if(l instanceof Vg)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof O0)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof M0)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Hg)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw hr()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:tJ(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:hr()}(t,e.precondition)),r}function M_(t,e){const r=e.currentDocument?function(i){return i.updateTime!==void 0?us.updateTime(ja(i.updateTime)):i.exists!==void 0?us.exists(i.exists):us.none()}(e.currentDocument):us.none(),n=e.updateTransforms?e.updateTransforms.map(s=>function(o,l){let c=null;if("setToServerValue"in l)xr(l.setToServerValue==="REQUEST_TIME"),c=new Vg;else if("appendMissingElements"in l){const A=l.appendMissingElements.values||[];c=new O0(A)}else if("removeAllFromArray"in l){const A=l.removeAllFromArray.values||[];c=new M0(A)}else"increment"in l?c=new Hg(o,l.increment):hr();const d=As.fromServerFormat(l.fieldPath);return new VW(d,c)}(t,s)):[];if(e.update){e.update.name;const s=md(t,e.update.name),i=new $a({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const d=c.fieldPaths||[];return new Yi(d.map(A=>As.fromServerFormat(A)))}(e.updateMask);return new Pd(s,i,o,r,n)}return new sm(s,i,r,n)}if(e.delete){const s=md(t,e.delete);return new am(s,r)}if(e.verify){const s=md(t,e.verify);return new hS(s,r)}return hr()}function aJ(t,e){return t&&t.length>0?(xr(e!==void 0),t.map(r=>function(s,i){let o=s.updateTime?ja(s.updateTime):ja(i);return o.isEqual(br.min())&&(o=ja(i)),new KW(o,s.transformResults||[])}(r,e))):[]}function J6(t,e){return{documents:[$6(t,e.path)]}}function X6(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=$6(t,s);const i=function(d){if(d.length!==0)return eU(In.create(d,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(A=>function(f){return{field:Vf(f.field),direction:oJ(f.dir)}}(A))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=L_(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:r,parent:s}}function Y6(t){let e=z6(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){xr(n===1);const A=r.from[0];A.allDescendants?s=A.collectionId:e=e.child(A.collectionId)}let i=[];r.where&&(i=function(u){const f=Z6(u);return f instanceof In&&AS(f)?f.getFilters():[f]}(r.where));let o=[];r.orderBy&&(o=function(u){return u.map(f=>function(m){return new Qg(Hf(m.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(f))}(r.orderBy));let l=null;r.limit&&(l=function(u){let f;return f=typeof u=="object"?u.value:u,Ix(f)?null:f}(r.limit));let c=null;r.startAt&&(c=function(u){const f=!!u.before,h=u.values||[];return new L0(h,f)}(r.startAt));let d=null;return r.endAt&&(d=function(u){const f=!u.before,h=u.values||[];return new L0(h,f)}(r.endAt)),jW(e,s,o,i,l,"F",c,d)}function iJ(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return hr()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Z6(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Hf(r.unaryFilter.field);return nn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Hf(r.unaryFilter.field);return nn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Hf(r.unaryFilter.field);return nn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Hf(r.unaryFilter.field);return nn.create(o,"!=",{nullValue:"NULL_VALUE"});default:return hr()}}(t):t.fieldFilter!==void 0?function(r){return nn.create(Hf(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return hr()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return In.create(r.compositeFilter.filters.map(n=>Z6(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return hr()}}(r.compositeFilter.op))}(t):hr()}function oJ(t){return XW[t]}function lJ(t){return YW[t]}function cJ(t){return ZW[t]}function Vf(t){return{fieldPath:t.canonicalString()}}function Hf(t){return As.fromServerFormat(t.fieldPath)}function eU(t){return t instanceof nn?function(r){if(r.op==="=="){if(Ij(r.value))return{unaryFilter:{field:Vf(r.field),op:"IS_NAN"}};if(Sj(r.value))return{unaryFilter:{field:Vf(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Ij(r.value))return{unaryFilter:{field:Vf(r.field),op:"IS_NOT_NAN"}};if(Sj(r.value))return{unaryFilter:{field:Vf(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vf(r.field),op:lJ(r.op),value:r.value}}}(t):t instanceof In?function(r){const n=r.getFilters().map(s=>eU(s));return n.length===1?n[0]:{compositeFilter:{op:cJ(r.op),filters:n}}}(t):hr()}function dJ(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function tU(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,r,n,s,i=br.min(),o=br.min(),l=Ws.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new dd(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new dd(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new dd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new dd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rU{constructor(e){this.ct=e}}function AJ(t,e){let r;if(e.document)r=rJ(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=sr.fromSegments(e.noDocument.path),s=Th(e.noDocument.readTime);r=ds.newNoDocument(n,s),e.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!e.unknownDocument)return hr();{const n=sr.fromSegments(e.unknownDocument.path),s=Th(e.unknownDocument.version);r=ds.newUnknownDocument(n,s)}}return e.readTime&&r.setReadTime(function(s){const i=new $t(s[0],s[1]);return br.fromTimestamp(i)}(e.readTime)),r}function $j(t,e){const r=e.key,n={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:rb(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(i,o){return{name:Kg(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Q0(i,o.version.toTimestamp()),createTime:Q0(i,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())n.noDocument={path:r.path.toArray(),readTime:Fh(e.version)};else{if(!e.isUnknownDocument())return hr();n.unknownDocument={path:r.path.toArray(),version:Fh(e.version)}}return n}function rb(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Fh(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Th(t){const e=new $t(t.seconds,t.nanoseconds);return br.fromTimestamp(e)}function Ju(t,e){const r=(e.baseMutations||[]).map(i=>M_(t.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const n=e.mutations.map(i=>M_(t.ct,i)),s=$t.fromMillis(e.localWriteTimeMs);return new fS(e.batchId,s,r,n)}function vp(t){const e=Th(t.readTime),r=t.lastLimboFreeSnapshotVersion!==void 0?Th(t.lastLimboFreeSnapshotVersion):br.min();let n;return n=function(i){return i.documents!==void 0}(t.query)?function(i){return xr(i.documents.length===1),hl(kx(z6(i.documents[0])))}(t.query):function(i){return hl(Y6(i))}(t.query),new dd(n,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,r,Ws.fromBase64String(t.resumeToken))}function nU(t,e){const r=Fh(e.snapshotVersion),n=Fh(e.lastLimboFreeSnapshotVersion);let s;s=Zy(e.target)?J6(t.ct,e.target):X6(t.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:kh(e.target),readTime:r,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:s}}function sU(t){const e=Y6({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?tb(e,e.limit,"L"):e}function Zw(t,e){return new pS(e.largestBatchId,M_(t.ct,e.overlayMutation))}function zj(t,e){const r=e.path.lastSegment();return[t,Di(e.path.popLast()),r]}function Wj(t,e,r,n){return{indexId:t,uid:e,sequenceNumber:r,readTime:Fh(n.readTime),documentKey:Di(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uJ{getBundleMetadata(e,r){return Jj(e).get(r).next(n=>{if(n)return function(i){return{id:i.bundleId,createTime:Th(i.createTime),version:i.version}}(n)})}saveBundleMetadata(e,r){return Jj(e).put(function(s){return{bundleId:s.id,createTime:Fh(ja(s.createTime)),version:s.version}}(r))}getNamedQuery(e,r){return Xj(e).get(r).next(n=>{if(n)return function(i){return{name:i.name,query:sU(i.bundledQuery),readTime:Th(i.readTime)}}(n)})}saveNamedQuery(e,r){return Xj(e).put(function(s){return{name:s.name,readTime:Fh(ja(s.readTime)),bundledQuery:s.bundledQuery}}(r))}}function Jj(t){return va(t,"bundles")}function Xj(t){return va(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(e,r){this.serializer=e,this.userId=r}static lt(e,r){const n=r.uid||"";return new f2(e,n)}getOverlay(e,r){return Km(e).get(zj(this.userId,r)).next(n=>n?Zw(this.serializer,n):null)}getOverlays(e,r){const n=yc();return bt.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){const s=[];return n.forEach((i,o)=>{const l=new pS(r,o);s.push(this.ht(e,l))}),bt.waitFor(s)}removeOverlaysForBatchId(e,r,n){const s=new Set;r.forEach(o=>s.add(Di(o.getCollectionPath())));const i=[];return s.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);i.push(Km(e).j("collectionPathOverlayIndex",l))}),bt.waitFor(i)}getOverlaysForCollection(e,r,n){const s=yc(),i=Di(r),o=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Km(e).U("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const d=Zw(this.serializer,c);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,r,n,s){const i=yc();let o;const l=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return Km(e).J({index:"collectionGroupOverlayIndex",range:l},(c,d,A)=>{const u=Zw(this.serializer,d);i.size()<s||u.largestBatchId===o?(i.set(u.getKey(),u),o=u.largestBatchId):A.done()}).next(()=>i)}ht(e,r){return Km(e).put(function(s,i,o){const[l,c,d]=zj(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:qg(s.ct,o.mutation)}}(this.serializer,this.userId,r))}}function Km(t){return va(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hJ{Pt(e){return va(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(r=>{const n=r==null?void 0:r.value;return n?Ws.fromUint8Array(n):Ws.EMPTY_BYTE_STRING})}setSessionToken(e,r){return this.Pt(e).put({name:"sessionToken",value:r.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(ls(e.integerValue));else if("doubleValue"in e){const n=ls(e.doubleValue);isNaN(n)?this.dt(r,13):(this.dt(r,15),Dg(n)?r.At(0):r.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(r,20),typeof n=="string"&&(n=Id(n)),r.Rt(`${n.seconds||""}`),r.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(su(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(r,45),r.At(n.latitude||0),r.At(n.longitude||0)}else"mapValue"in e?x6(e)?this.dt(r,Number.MAX_SAFE_INTEGER):c2(e)?this.wt(e.mapValue,r):(this.St(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.bt(e.arrayValue,r),this.ft(r)):hr()}Vt(e,r){this.dt(r,25),this.Dt(e,r)}Dt(e,r){r.Rt(e)}St(e,r){const n=e.fields||{};this.dt(r,55);for(const s of Object.keys(n))this.Vt(s,r),this.Tt(n[s],r)}wt(e,r){var n,s;const i=e.fields||{};this.dt(r,53);const o="value",l=((s=(n=i[o].arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.length)||0;this.dt(r,15),r.At(ls(l)),this.Vt(o,r),this.Tt(i[o],r)}bt(e,r){const n=e.values||[];this.dt(r,50);for(const s of n)this.Tt(s,r)}yt(e,r){this.dt(r,37),sr.fromName(e).path.forEach(n=>{this.dt(r,60),this.Dt(n,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}}Xu.vt=new Xu;function fJ(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function Yj(t){const e=64-function(n){let s=0;for(let i=0;i<8;++i){const o=fJ(255&n[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class mJ{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ft(n.value),n=r.next();this.Mt()}xt(e){const r=e[Symbol.iterator]();let n=r.next();for(;!n.done;)this.Ot(n.value),n=r.next();this.Nt()}Lt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{const s=r.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const r of e){const n=r.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(r<"\uD800"||"\uDBFF"<r)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{const s=r.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const r=this.qt(e),n=Yj(r);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let s=r.length-n;s<r.length;++s)this.buffer[this.position++]=255&r[s]}Kt(e){const r=this.qt(e),n=Yj(r);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let s=r.length-n;s<r.length;++s)this.buffer[this.position++]=~(255&r[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const r=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),n=(128&r[0])!=0;r[0]^=n?255:128;for(let s=1;s<r.length;++s)r[s]^=n?255:0;return r}Ft(e){const r=255&e;r===0?(this.Ut(0),this.Ut(255)):r===255?(this.Ut(255),this.Ut(0)):this.Ut(r)}Ot(e){const r=255&e;r===0?(this.Gt(0),this.Gt(255)):r===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const r=e+this.position;if(r<=this.buffer.length)return;let n=2*this.buffer.length;n<r&&(n=r);const s=new Uint8Array(n);s.set(this.buffer),this.buffer=s}}class pJ{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class gJ{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class qm{constructor(){this.jt=new mJ,this.Ht=new pJ(this.jt),this.Jt=new gJ(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e,r,n,s){this.indexId=e,this.documentKey=r,this.arrayValue=n,this.directionalValue=s}Zt(){const e=this.directionalValue.length,r=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(r);return n.set(this.directionalValue,0),r!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new Yu(this.indexId,this.documentKey,this.arrayValue,n)}}function iA(t,e){let r=t.indexId-e.indexId;return r!==0?r:(r=Zj(t.arrayValue,e.arrayValue),r!==0?r:(r=Zj(t.directionalValue,e.directionalValue),r!==0?r:sr.comparator(t.documentKey,e.documentKey)))}function Zj(t,e){for(let r=0;r<t.length&&r<e.length;++r){const n=t[r]-e[r];if(n!==0)return n}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e){this.Xt=new Dn((r,n)=>As.comparator(r.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const r of e.filters){const n=r;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(xr(e.collectionGroup===this.collectionId),this.nn)return!1;const r=I_(e);if(r!==void 0&&!this.sn(r))return!1;const n=Gu(e);let s=new Set,i=0,o=0;for(;i<n.length&&this.sn(n[i]);++i)s=s.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=n[i];if(!this.on(l,c)||!this._n(this.en[o++],c))return!1}++i}for(;i<n.length;++i){const l=n[i];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new Dn(As.comparator);const r=[];for(const n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")r.push(new iy(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),r.push(new iy(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),r.push(new iy(n.field,n.dir==="asc"?0:1)));return new Yy(Yy.UNKNOWN_ID,this.collectionId,r,Rg.empty())}sn(e){for(const r of this.tn)if(this.on(r,e))return!0;return!1}on(e,r){if(e===void 0||!e.field.isEqual(r.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return r.kind===2===n}_n(e,r){return!!e.field.isEqual(r.fieldPath)&&(r.kind===0&&e.dir==="asc"||r.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aU(t){var e,r;if(xr(t instanceof nn||t instanceof In),t instanceof nn){if(t instanceof B6){const s=((r=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||r===void 0?void 0:r.map(i=>nn.create(t.field,"==",i)))||[];return In.create(s,"or")}return t}const n=t.filters.map(s=>aU(s));return In.create(n,t.op)}function xJ(t){if(t.getFilters().length===0)return[];const e=H_(aU(t));return xr(iU(e)),Q_(e)||V_(e)?[e]:e.getFilters()}function Q_(t){return t instanceof nn}function V_(t){return t instanceof In&&AS(t)}function iU(t){return Q_(t)||V_(t)||function(r){if(r instanceof In&&T_(r)){for(const n of r.getFilters())if(!Q_(n)&&!V_(n))return!1;return!0}return!1}(t)}function H_(t){if(xr(t instanceof nn||t instanceof In),t instanceof nn)return t;if(t.filters.length===1)return H_(t.filters[0]);const e=t.filters.map(n=>H_(n));let r=In.create(e,t.op);return r=nb(r),iU(r)?r:(xr(r instanceof In),xr(U0(r)),xr(r.filters.length>1),r.filters.reduce((n,s)=>vS(n,s)))}function vS(t,e){let r;return xr(t instanceof nn||t instanceof In),xr(e instanceof nn||e instanceof In),r=t instanceof nn?e instanceof nn?function(s,i){return In.create([s,i],"and")}(t,e):tk(t,e):e instanceof nn?tk(e,t):function(s,i){if(xr(s.filters.length>0&&i.filters.length>0),U0(s)&&U0(i))return C6(s,i.getFilters());const o=T_(s)?s:i,l=T_(s)?i:s,c=o.filters.map(d=>vS(d,l));return In.create(c,"or")}(t,e),nb(r)}function tk(t,e){if(U0(e))return C6(e,t.getFilters());{const r=e.filters.map(n=>vS(t,n));return In.create(r,"or")}}function nb(t){if(xr(t instanceof nn||t instanceof In),t instanceof nn)return t;const e=t.getFilters();if(e.length===1)return nb(e[0]);if(w6(t))return t;const r=e.map(s=>nb(s)),n=[];return r.forEach(s=>{s instanceof nn?n.push(s):s instanceof In&&(s.op===t.op?n.push(...s.filters):n.push(s))}),n.length===1?n[0]:In.create(n,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vJ{constructor(){this.un=new yS}addToCollectionParentIndex(e,r){return this.un.add(r),bt.resolve()}getCollectionParents(e,r){return bt.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return bt.resolve()}deleteFieldIndex(e,r){return bt.resolve()}deleteAllFieldIndexes(e){return bt.resolve()}createTargetIndexes(e,r){return bt.resolve()}getDocumentsMatchingTarget(e,r){return bt.resolve(null)}getIndexType(e,r){return bt.resolve(0)}getFieldIndexes(e,r){return bt.resolve([])}getNextCollectionGroupToUpdate(e){return bt.resolve(null)}getMinOffset(e,r){return bt.resolve(Fo.min())}getMinOffsetFromCollectionGroup(e,r){return bt.resolve(Fo.min())}updateCollectionGroup(e,r,n){return bt.resolve()}updateIndexEntries(e,r){return bt.resolve()}}class yS{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Dn(pn.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Dn(pn.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dv=new Uint8Array(0);class yJ{constructor(e,r){this.databaseId=r,this.cn=new yS,this.ln=new wu(n=>kh(n),(n,s)=>jx(n,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,r){if(!this.cn.has(r)){const n=r.lastSegment(),s=r.popLast();e.addOnCommittedListener(()=>{this.cn.add(r)});const i={collectionId:n,parent:Di(s)};return rk(e).put(i)}return bt.resolve()}getCollectionParents(e,r){const n=[],s=IDBKeyRange.bound([r,""],[o6(r),""],!1,!0);return rk(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==r)break;n.push(vc(o.parent))}return n})}addFieldIndex(e,r){const n=Gm(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(r);delete s.indexId;const i=n.add(s);if(r.indexState){const o=yf(e);return i.next(l=>{o.put(Wj(l,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return i.next()}deleteFieldIndex(e,r){const n=Gm(e),s=yf(e),i=vf(e);return n.delete(r.indexId).next(()=>s.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const r=Gm(e),n=vf(e),s=yf(e);return r.j().next(()=>n.j()).next(()=>s.j())}createTargetIndexes(e,r){return bt.forEach(this.hn(r),n=>this.getIndexType(e,n).next(s=>{if(s===0||s===1){const i=new ek(n).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,r){const n=vf(e);let s=!0;const i=new Map;return bt.forEach(this.hn(r),o=>this.Pn(e,o).next(l=>{s&&(s=!!l),i.set(o,l)})).next(()=>{if(s){let o=qr();const l=[];return bt.forEach(i,(c,d)=>{Ht("IndexedDbIndexManager",`Using index ${function(w){return`id=${w.indexId}|cg=${w.collectionGroup}|f=${w.fields.map(k=>`${k.fieldPath}:${k.kind}`).join(",")}`}(c)} to execute ${kh(r)}`);const A=function(w,k){const O=I_(k);if(O===void 0)return null;for(const L of eb(w,O.fieldPath))switch(L.op){case"array-contains-any":return L.value.arrayValue.values||[];case"array-contains":return[L.value]}return null}(d,c),u=function(w,k){const O=new Map;for(const L of Gu(k))for(const E of eb(w,L.fieldPath))switch(E.op){case"==":case"in":O.set(L.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return O.set(L.fieldPath.canonicalString(),E.value),Array.from(O.values())}return null}(d,c),f=function(w,k){const O=[];let L=!0;for(const E of Gu(k)){const B=E.kind===0?Pj(w,E.fieldPath,w.startAt):Rj(w,E.fieldPath,w.startAt);O.push(B.value),L&&(L=B.inclusive)}return new L0(O,L)}(d,c),h=function(w,k){const O=[];let L=!0;for(const E of Gu(k)){const B=E.kind===0?Rj(w,E.fieldPath,w.endAt):Pj(w,E.fieldPath,w.endAt);O.push(B.value),L&&(L=B.inclusive)}return new L0(O,L)}(d,c),m=this.In(c,d,f),p=this.In(c,d,h),g=this.Tn(c,d,u),x=this.En(c.indexId,A,m,f.inclusive,p,h.inclusive,g);return bt.forEach(x,b=>n.G(b,r.limit).next(w=>{w.forEach(k=>{const O=sr.fromSegments(k.documentKey);o.has(O)||(o=o.add(O),l.push(O))})}))}).next(()=>l)}return bt.resolve(null)})}hn(e){let r=this.ln.get(e);return r||(e.filters.length===0?r=[e]:r=xJ(In.create(e.filters,"and")).map(n=>R_(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,r),r)}En(e,r,n,s,i,o,l){const c=(r!=null?r.length:1)*Math.max(n.length,i.length),d=c/(r!=null?r.length:1),A=[];for(let u=0;u<c;++u){const f=r?this.dn(r[u/d]):Dv,h=this.An(e,f,n[u%d],s),m=this.Rn(e,f,i[u%d],o),p=l.map(g=>this.An(e,f,g,!0));A.push(...this.createRange(h,m,p))}return A}An(e,r,n,s){const i=new Yu(e,sr.empty(),r,n);return s?i:i.Zt()}Rn(e,r,n,s){const i=new Yu(e,sr.empty(),r,n);return s?i.Zt():i}Pn(e,r){const n=new ek(r),s=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const l of i)n.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,r){let n=2;const s=this.hn(r);return bt.forEach(s,i=>this.Pn(e,i).next(o=>{o?n!==0&&o.fields.length<function(c){let d=new Dn(As.comparator),A=!1;for(const u of c.filters)for(const f of u.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?A=!0:d=d.add(f.field));for(const u of c.orderBy)u.field.isKeyField()||(d=d.add(u.field));return d.size+(A?1:0)}(i)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(r)&&s.length>1&&n===2?1:n)}Vn(e,r){const n=new qm;for(const s of Gu(e)){const i=r.data.field(s.fieldPath);if(i==null)return null;const o=n.Yt(s.kind);Xu.vt.It(i,o)}return n.zt()}dn(e){const r=new qm;return Xu.vt.It(e,r.Yt(0)),r.zt()}mn(e,r){const n=new qm;return Xu.vt.It(Og(this.databaseId,r),n.Yt(function(i){const o=Gu(i);return o.length===0?0:o[o.length-1].kind}(e))),n.zt()}Tn(e,r,n){if(n===null)return[];let s=[];s.push(new qm);let i=0;for(const o of Gu(e)){const l=n[i++];for(const c of s)if(this.fn(r,o.fieldPath)&&Mg(l))s=this.gn(s,o,l);else{const d=c.Yt(o.kind);Xu.vt.It(l,d)}}return this.pn(s)}In(e,r,n){return this.Tn(e,r,n.position)}pn(e){const r=[];for(let n=0;n<e.length;++n)r[n]=e[n].zt();return r}gn(e,r,n){const s=[...e],i=[];for(const o of n.arrayValue.values||[])for(const l of s){const c=new qm;c.seed(l.zt()),Xu.vt.It(o,c.Yt(r.kind)),i.push(c)}return i}fn(e,r){return!!e.filters.find(n=>n instanceof nn&&n.field.isEqual(r)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,r){const n=Gm(e),s=yf(e);return(r?n.U("collectionGroupIndex",IDBKeyRange.bound(r,r)):n.U()).next(i=>{const o=[];return bt.forEach(i,l=>s.get([l.indexId,this.uid]).next(c=>{o.push(function(A,u){const f=u?new Rg(u.sequenceNumber,new Fo(Th(u.readTime),new sr(vc(u.documentKey)),u.largestBatchId)):Rg.empty(),h=A.fields.map(([m,p])=>new iy(As.fromServerFormat(m),p));return new Yy(A.indexId,A.collectionGroup,h,f)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(r=>r.length===0?null:(r.sort((n,s)=>{const i=n.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:Lr(n.collectionGroup,s.collectionGroup)}),r[0].collectionGroup))}updateCollectionGroup(e,r,n){const s=Gm(e),i=yf(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(r,r)).next(l=>bt.forEach(l,c=>i.put(Wj(c.indexId,this.uid,o,n)))))}updateIndexEntries(e,r){const n=new Map;return bt.forEach(r,(s,i)=>{const o=n.get(s.collectionGroup);return(o?bt.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(n.set(s.collectionGroup,l),bt.forEach(l,c=>this.wn(e,s,c).next(d=>{const A=this.Sn(i,c);return d.isEqual(A)?bt.resolve():this.bn(e,i,c,d,A)}))))})}Dn(e,r,n,s){return vf(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(n,r.key),documentKey:r.key.path.toArray()})}vn(e,r,n,s){return vf(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(n,r.key),r.key.path.toArray()])}wn(e,r,n){const s=vf(e);let i=new Dn(iA);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,r)])},(o,l)=>{i=i.add(new Yu(n.indexId,r,l.arrayValue,l.directionalValue))}).next(()=>i)}Sn(e,r){let n=new Dn(iA);const s=this.Vn(r,e);if(s==null)return n;const i=I_(r);if(i!=null){const o=e.data.field(i.fieldPath);if(Mg(o))for(const l of o.arrayValue.values||[])n=n.add(new Yu(r.indexId,e.key,this.dn(l),s))}else n=n.add(new Yu(r.indexId,e.key,Dv,s));return n}bn(e,r,n,s,i){Ht("IndexedDbIndexManager","Updating index entries for document '%s'",r.key);const o=[];return function(c,d,A,u,f){const h=c.getIterator(),m=d.getIterator();let p=xf(h),g=xf(m);for(;p||g;){let x=!1,b=!1;if(p&&g){const w=A(p,g);w<0?b=!0:w>0&&(x=!0)}else p!=null?b=!0:x=!0;x?(u(g),g=xf(m)):b?(f(p),p=xf(h)):(p=xf(h),g=xf(m))}}(s,i,iA,l=>{o.push(this.Dn(e,r,n,l))},l=>{o.push(this.vn(e,r,n,l))}),bt.waitFor(o)}yn(e){let r=1;return yf(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,s,i)=>{i.done(),r=s.sequenceNumber+1}).next(()=>r)}createRange(e,r,n){n=n.sort((o,l)=>iA(o,l)).filter((o,l,c)=>!l||iA(o,c[l-1])!==0);const s=[];s.push(e);for(const o of n){const l=iA(o,e),c=iA(o,r);if(l===0)s[0]=e.Zt();else if(l>0&&c<0)s.push(o),s.push(o.Zt());else if(c>0)break}s.push(r);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const l=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,Dv,[]],c=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,Dv,[]];i.push(IDBKeyRange.bound(l,c))}return i}Cn(e,r){return iA(e,r)>0}getMinOffsetFromCollectionGroup(e,r){return this.getFieldIndexes(e,r).next(nk)}getMinOffset(e,r){return bt.mapArray(this.hn(r),n=>this.Pn(e,n).next(s=>s||hr())).next(nk)}}function rk(t){return va(t,"collectionParents")}function vf(t){return va(t,"indexEntries")}function Gm(t){return va(t,"indexConfiguration")}function yf(t){return va(t,"indexState")}function nk(t){xr(t.length!==0);let e=t[0].indexState.offset,r=e.largestBatchId;for(let n=1;n<t.length;n++){const s=t[n].indexState.offset;iS(s,e)<0&&(e=s),r<s.largestBatchId&&(r=s.largestBatchId)}return new Fo(e.readTime,e.documentKey,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class zi{constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new zi(e,zi.DEFAULT_COLLECTION_PERCENTILE,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oU(t,e,r){const n=t.store("mutations"),s=t.store("documentMutations"),i=[],o=IDBKeyRange.only(r.batchId);let l=0;const c=n.J({range:o},(A,u,f)=>(l++,f.delete()));i.push(c.next(()=>{xr(l===1)}));const d=[];for(const A of r.mutations){const u=u6(e,A.key.path,r.batchId);i.push(s.delete(u)),d.push(A.key)}return bt.waitFor(i).next(()=>d)}function sb(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw hr();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zi.DEFAULT_COLLECTION_PERCENTILE=10,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zi.DEFAULT=new zi(41943040,zi.DEFAULT_COLLECTION_PERCENTILE,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zi.DISABLED=new zi(-1,0,0);class m2{constructor(e,r,n,s){this.userId=e,this.serializer=r,this.indexManager=n,this.referenceDelegate=s,this.Fn={}}static lt(e,r,n,s){xr(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new m2(i,r,n,s)}checkEmpty(e){let r=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return oA(e).J({index:"userMutationsIndex",range:n},(s,i,o)=>{r=!1,o.done()}).next(()=>r)}addMutationBatch(e,r,n,s){const i=Kf(e),o=oA(e);return o.add({}).next(l=>{xr(typeof l=="number");const c=new fS(l,r,n,s),d=function(h,m,p){const g=p.baseMutations.map(b=>qg(h.ct,b)),x=p.mutations.map(b=>qg(h.ct,b));return{userId:m,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:g,mutations:x}}(this.serializer,this.userId,c),A=[];let u=new Dn((f,h)=>Lr(f.canonicalString(),h.canonicalString()));for(const f of s){const h=u6(this.userId,f.key.path,l);u=u.add(f.key.path.popLast()),A.push(o.put(d)),A.push(i.put(h,eW))}return u.forEach(f=>{A.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),bt.waitFor(A).next(()=>c)})}lookupMutationBatch(e,r){return oA(e).get(r).next(n=>n?(xr(n.userId===this.userId),Ju(this.serializer,n)):null)}Mn(e,r){return this.Fn[r]?bt.resolve(this.Fn[r]):this.lookupMutationBatch(e,r).next(n=>{if(n){const s=n.keys();return this.Fn[r]=s,s}return null})}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return oA(e).J({index:"userMutationsIndex",range:s},(o,l,c)=>{l.userId===this.userId&&(xr(l.batchId>=n),i=Ju(this.serializer,l)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return oA(e).J({index:"userMutationsIndex",range:r,reverse:!0},(s,i,o)=>{n=i.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return oA(e).U("userMutationsIndex",r).next(n=>n.map(s=>Ju(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,r){const n=oy(this.userId,r.path),s=IDBKeyRange.lowerBound(n),i=[];return Kf(e).J({range:s},(o,l,c)=>{const[d,A,u]=o,f=vc(A);if(d===this.userId&&r.path.isEqual(f))return oA(e).get(u).next(h=>{if(!h)throw hr();xr(h.userId===this.userId),i.push(Ju(this.serializer,h))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Dn(Lr);const s=[];return r.forEach(i=>{const o=oy(this.userId,i.path),l=IDBKeyRange.lowerBound(o),c=Kf(e).J({range:l},(d,A,u)=>{const[f,h,m]=d,p=vc(h);f===this.userId&&i.path.isEqual(p)?n=n.add(m):u.done()});s.push(c)}),bt.waitFor(s).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1,i=oy(this.userId,n),o=IDBKeyRange.lowerBound(i);let l=new Dn(Lr);return Kf(e).J({range:o},(c,d,A)=>{const[u,f,h]=c,m=vc(f);u===this.userId&&n.isPrefixOf(m)?m.length===s&&(l=l.add(h)):A.done()}).next(()=>this.xn(e,l))}xn(e,r){const n=[],s=[];return r.forEach(i=>{s.push(oA(e).get(i).next(o=>{if(o===null)throw hr();xr(o.userId===this.userId),n.push(Ju(this.serializer,o))}))}),bt.waitFor(s).next(()=>n)}removeMutationBatch(e,r){return oU(e._e,this.userId,r).next(n=>(e.addOnCommittedListener(()=>{this.On(r.batchId)}),bt.forEach(n,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(r=>{if(!r)return bt.resolve();const n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Kf(e).J({range:n},(i,o,l)=>{if(i[0]===this.userId){const c=vc(i[1]);s.push(c)}else l.done()}).next(()=>{xr(s.length===0)})})}containsKey(e,r){return lU(e,this.userId,r)}Nn(e){return cU(e).get(this.userId).next(r=>r||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function lU(t,e,r){const n=oy(e,r.path),s=n[1],i=IDBKeyRange.lowerBound(n);let o=!1;return Kf(t).J({range:i,H:!0},(l,c,d)=>{const[A,u,f]=l;A===e&&u===s&&(o=!0),d.done()}).next(()=>o)}function oA(t){return va(t,"mutations")}function Kf(t){return va(t,"documentMutations")}function cU(t){return va(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ph(0)}static kn(){return new Ph(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bJ{constructor(e,r){this.referenceDelegate=e,this.serializer=r}allocateTargetId(e){return this.qn(e).next(r=>{const n=new Ph(r.highestTargetId);return r.highestTargetId=n.next(),this.Qn(e,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(r=>br.fromTimestamp(new $t(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(e,r,n){return this.qn(e).next(s=>(s.highestListenSequenceNumber=r,n&&(s.lastRemoteSnapshotVersion=n.toTimestamp()),r>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=r),this.Qn(e,s)))}addTargetData(e,r){return this.Kn(e,r).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(r,n),this.Qn(e,n))))}updateTargetData(e,r){return this.Kn(e,r)}removeTargetData(e,r){return this.removeMatchingKeysForTargetId(e,r.targetId).next(()=>bf(e).delete(r.targetId)).next(()=>this.qn(e)).next(n=>(xr(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,r,n){let s=0;const i=[];return bf(e).J((o,l)=>{const c=vp(l);c.sequenceNumber<=r&&n.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>bt.waitFor(i)).next(()=>s)}forEachTarget(e,r){return bf(e).J((n,s)=>{const i=vp(s);r(i)})}qn(e){return ak(e).get("targetGlobalKey").next(r=>(xr(r!==null),r))}Qn(e,r){return ak(e).put("targetGlobalKey",r)}Kn(e,r){return bf(e).put(nU(this.serializer,r))}$n(e,r){let n=!1;return e.targetId>r.highestTargetId&&(r.highestTargetId=e.targetId,n=!0),e.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(r=>r.targetCount)}getTargetData(e,r){const n=kh(r),s=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return bf(e).J({range:s,index:"queryTargetsIndex"},(o,l,c)=>{const d=vp(l);jx(r,d.target)&&(i=d,c.done())}).next(()=>i)}addMatchingKeys(e,r,n){const s=[],i=BA(e);return r.forEach(o=>{const l=Di(o.path);s.push(i.put({targetId:n,path:l})),s.push(this.referenceDelegate.addReference(e,n,o))}),bt.waitFor(s)}removeMatchingKeys(e,r,n){const s=BA(e);return bt.forEach(r,i=>{const o=Di(i.path);return bt.waitFor([s.delete([n,o]),this.referenceDelegate.removeReference(e,n,i)])})}removeMatchingKeysForTargetId(e,r){const n=BA(e),s=IDBKeyRange.bound([r],[r+1],!1,!0);return n.delete(s)}getMatchingKeysForTargetId(e,r){const n=IDBKeyRange.bound([r],[r+1],!1,!0),s=BA(e);let i=qr();return s.J({range:n,H:!0},(o,l,c)=>{const d=vc(o[1]),A=new sr(d);i=i.add(A)}).next(()=>i)}containsKey(e,r){const n=Di(r.path),s=IDBKeyRange.bound([n],[o6(n)],!1,!0);let i=0;return BA(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,l],c,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}ot(e,r){return bf(e).get(r).next(n=>n?vp(n):null)}}function bf(t){return va(t,"targets")}function ak(t){return va(t,"targetGlobal")}function BA(t){return va(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ik([t,e],[r,n]){const s=Lr(t,r);return s===0?Lr(e,n):s}class wJ{constructor(e){this.Un=e,this.buffer=new Dn(ik),this.Wn=0}Gn(){return++this.Wn}zn(e){const r=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();ik(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class NJ{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){Ht("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){bu(r)?Ht("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await Gh(r)}await this.Hn(3e5)})}}class CJ{constructor(e,r){this.Jn=e,this.params=r}calculateTargetCount(e,r){return this.Jn.Yn(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return bt.resolve(cl.oe);const n=new wJ(r);return this.Jn.forEachTarget(e,s=>n.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>n.zn(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Jn.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Jn.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ht("LruGarbageCollector","Garbage collection skipped; disabled"),bt.resolve(sk)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ht("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),sk):this.Xn(e,r))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,r){let n,s,i,o,l,c,d;const A=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(u=>(u>this.params.maximumSequenceNumbersToCollect?(Ht("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${u}`),s=this.params.maximumSequenceNumbersToCollect):s=u,o=Date.now(),this.nthSequenceNumber(e,s))).next(u=>(n=u,l=Date.now(),this.removeTargets(e,n,r))).next(u=>(i=u,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(u=>(d=Date.now(),Mf()<=rn.DEBUG&&Ht("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-A}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${u} documents in `+(d-c)+`ms
Total Duration: ${d-A}ms`),bt.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:u})))}}function _J(t,e){return new CJ(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EJ{constructor(e,r){this.db=e,this.garbageCollector=_J(this,r)}Yn(e){const r=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}er(e){let r=0;return this.Zn(e,n=>{r++}).next(()=>r)}forEachTarget(e,r){return this.db.getTargetCache().forEachTarget(e,r)}Zn(e,r){return this.tr(e,(n,s)=>r(s))}addReference(e,r,n){return Lv(e,n)}removeReference(e,r,n){return Lv(e,n)}removeTargets(e,r,n){return this.db.getTargetCache().removeTargets(e,r,n)}markPotentiallyOrphaned(e,r){return Lv(e,r)}nr(e,r){return function(s,i){let o=!1;return cU(s).Y(l=>lU(s,l,i).next(c=>(c&&(o=!0),bt.resolve(!c)))).next(()=>o)}(e,r)}removeOrphanedDocuments(e,r){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,l)=>{if(l<=r){const c=this.nr(e,o).next(d=>{if(!d)return i++,n.getEntry(e,o).next(()=>(n.removeEntry(o,br.min()),BA(e).delete(function(u){return[0,Di(u.path)]}(o))))});s.push(c)}}).next(()=>bt.waitFor(s)).next(()=>n.apply(e)).next(()=>i)}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,r){return Lv(e,r)}tr(e,r){const n=BA(e);let s,i=cl.oe;return n.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:d})=>{o===0?(i!==cl.oe&&r(new sr(vc(s)),i),i=d,s=c):i=cl.oe}).next(()=>{i!==cl.oe&&r(new sr(vc(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Lv(t,e){return BA(t).put(function(n,s){return{targetId:0,path:Di(n.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dU{constructor(){this.changes=new wu(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,ds.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?bt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BJ{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,r,n){return Du(e).put(n)}removeEntry(e,r,n){return Du(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],rb(o),l[l.length-1]]}(r,n))}updateMetadata(e,r){return this.getMetadata(e).next(n=>(n.byteSize+=r,this.rr(e,n)))}getEntry(e,r){let n=ds.newInvalidDocument(r);return Du(e).J({index:"documentKeyIndex",range:IDBKeyRange.only($m(r))},(s,i)=>{n=this.ir(r,i)}).next(()=>n)}sr(e,r){let n={size:0,document:ds.newInvalidDocument(r)};return Du(e).J({index:"documentKeyIndex",range:IDBKeyRange.only($m(r))},(s,i)=>{n={document:this.ir(r,i),size:sb(i)}}).next(()=>n)}getEntries(e,r){let n=So();return this._r(e,r,(s,i)=>{const o=this.ir(s,i);n=n.insert(s,o)}).next(()=>n)}ar(e,r){let n=So(),s=new fs(sr.comparator);return this._r(e,r,(i,o)=>{const l=this.ir(i,o);n=n.insert(i,l),s=s.insert(i,sb(o))}).next(()=>({documents:n,ur:s}))}_r(e,r,n){if(r.isEmpty())return bt.resolve();let s=new Dn(ck);r.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound($m(s.first()),$m(s.last())),o=s.getIterator();let l=o.getNext();return Du(e).J({index:"documentKeyIndex",range:i},(c,d,A)=>{const u=sr.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;l&&ck(l,u)<0;)n(l,null),l=o.getNext();l&&l.isEqual(u)&&(n(l,d),l=o.hasNext()?o.getNext():null),l?A.$($m(l)):A.done()}).next(()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,r,n,s,i){const o=r.path,l=[o.popLast().toArray(),o.lastSegment(),rb(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Du(e).U(IDBKeyRange.bound(l,c,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let A=So();for(const u of d){const f=this.ir(sr.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);f.isFoundDocument()&&(Fx(r,f)||s.has(f.key))&&(A=A.insert(f.key,f))}return A})}getAllFromCollectionGroup(e,r,n,s){let i=So();const o=lk(r,n),l=lk(r,Fo.max());return Du(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,d,A)=>{const u=this.ir(sr.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(u.key,u),i.size===s&&A.done()}).next(()=>i)}newChangeBuffer(e){return new SJ(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(r=>r.byteSize)}getMetadata(e){return ok(e).get("remoteDocumentGlobalKey").next(r=>(xr(!!r),r))}rr(e,r){return ok(e).put("remoteDocumentGlobalKey",r)}ir(e,r){if(r){const n=AJ(this.serializer,r);if(!(n.isNoDocument()&&n.version.isEqual(br.min())))return n}return ds.newInvalidDocument(e)}}function AU(t){return new BJ(t)}class SJ extends dU{constructor(e,r){super(),this.cr=e,this.trackRemovals=r,this.lr=new wu(n=>n.toString(),(n,s)=>n.isEqual(s))}applyChanges(e){const r=[];let n=0,s=new Dn((i,o)=>Lr(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.lr.get(i);if(r.push(this.cr.removeEntry(e,i,l.readTime)),o.isValidDocument()){const c=$j(this.cr.serializer,o);s=s.add(i.path.popLast());const d=sb(c);n+=d-l.size,r.push(this.cr.addEntry(e,i,c))}else if(n-=l.size,this.trackRemovals){const c=$j(this.cr.serializer,o.convertToNoDocument(br.min()));r.push(this.cr.addEntry(e,i,c))}}),s.forEach(i=>{r.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),r.push(this.cr.updateMetadata(e,n)),bt.waitFor(r)}getFromCache(e,r){return this.cr.sr(e,r).next(n=>(this.lr.set(r,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,r){return this.cr.ar(e,r).next(({documents:n,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:n.get(i).readTime})}),n))}}function ok(t){return va(t,"remoteDocumentGlobal")}function Du(t){return va(t,"remoteDocumentsV14")}function $m(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function lk(t,e){const r=e.documentKey.path.toArray();return[t,rb(e.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function ck(t,e){const r=t.path.toArray(),n=e.path.toArray();let s=0;for(let i=0;i<r.length-2&&i<n.length-2;++i)if(s=Lr(r[i],n[i]),s)return s;return s=Lr(r.length,n.length),s||(s=Lr(r[r.length-2],n[n.length-2]),s||Lr(r[r.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IJ{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&qp(n.mutation,s,Yi.empty(),$t.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,qr()).next(()=>n))}getLocalViewOfDocuments(e,r,n=qr()){const s=yc();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let o=gp();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=yc();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,qr()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,n,s){let i=So();const o=Kp(),l=function(){return Kp()}();return r.forEach((c,d)=>{const A=n.get(d.key);s.has(d.key)&&(A===void 0||A.mutation instanceof Pd)?i=i.insert(d.key,d):A!==void 0?(o.set(d.key,A.mutation.getFieldMask()),qp(A.mutation,d,A.mutation.getFieldMask(),$t.now())):o.set(d.key,Yi.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,A)=>o.set(d,A)),r.forEach((d,A)=>{var u;return l.set(d,new IJ(A,(u=o.get(d))!==null&&u!==void 0?u:null))}),l))}recalculateAndSaveOverlays(e,r){const n=Kp();let s=new fs((o,l)=>o-l),i=qr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(c=>{const d=r.get(c);if(d===null)return;let A=n.get(c)||Yi.empty();A=l.applyToLocalView(d,A),n.set(c,A);const u=(s.get(l.batchId)||qr()).add(c);s=s.insert(l.batchId,u)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),d=c.key,A=c.value,u=T6();A.forEach(f=>{if(!i.has(f)){const h=O6(r.get(f),n.get(f));h!==null&&u.set(f,h),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,u))}return bt.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(o){return sr.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):S6(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):bt.resolve(yc());let l=-1,c=i;return o.next(d=>bt.forEach(d,(A,u)=>(l<u.largestBatchId&&(l=u.largestBatchId),i.get(A)?bt.resolve():this.remoteDocumentCache.getEntry(e,A).next(f=>{c=c.insert(A,f)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,qr())).next(A=>({batchId:l,changes:F6(A)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new sr(r)).next(n=>{let s=gp();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let o=gp();return this.indexManager.getCollectionParents(e,i).next(l=>bt.forEach(l,c=>{const d=function(u,f){return new nm(f,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(r,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,n,s).next(A=>{A.forEach((u,f)=>{o=o.insert(u,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(o=>{i.forEach((c,d)=>{const A=d.getKey();o.get(A)===null&&(o=o.insert(A,ds.newInvalidDocument(A)))});let l=gp();return o.forEach((c,d)=>{const A=i.get(c);A!==void 0&&qp(A.mutation,d,Yi.empty(),$t.now()),Fx(r,d)&&(l=l.insert(c,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jJ{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return bt.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:ja(s.createTime)}}(r)),bt.resolve()}getNamedQuery(e,r){return bt.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:sU(s.bundledQuery),readTime:ja(s.readTime)}}(r)),bt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kJ{constructor(){this.overlays=new fs(sr.comparator),this.Ir=new Map}getOverlay(e,r){return bt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=yc();return bt.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.ht(e,r,i)}),bt.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(n)),bt.resolve()}getOverlaysForCollection(e,r,n){const s=yc(),i=r.length+1,o=new sr(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,d=c.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>n&&s.set(c.getKey(),c)}return bt.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new fs((d,A)=>d-A);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let A=i.get(d.largestBatchId);A===null&&(A=yc(),i=i.insert(d.largestBatchId,A)),A.set(d.getKey(),d)}}const l=yc(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,A)=>l.set(d,A)),!(l.size()>=s)););return bt.resolve(l)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new pS(r,n));let i=this.Ir.get(r);i===void 0&&(i=qr(),this.Ir.set(r,i)),this.Ir.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FJ{constructor(){this.sessionToken=Ws.EMPTY_BYTE_STRING}getSessionToken(e){return bt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,bt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(){this.Tr=new Dn(Ca.Er),this.dr=new Dn(Ca.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Ca(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Ca(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new sr(new pn([])),n=new Ca(r,e),s=new Ca(r,e+1),i=[];return this.dr.forEachInRange([n,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new sr(new pn([])),n=new Ca(r,e),s=new Ca(r,e+1);let i=qr();return this.dr.forEachInRange([n,s],o=>{i=i.add(o.key)}),i}containsKey(e){const r=new Ca(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Ca{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return sr.comparator(e.key,r.key)||Lr(e.wr,r.wr)}static Ar(e,r){return Lr(e.wr,r.wr)||sr.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TJ{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Dn(Ca.Er)}checkEmpty(e){return bt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new fS(i,r,n,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new Ca(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return bt.resolve(o)}lookupMutationBatch(e,r){return bt.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),i=s<0?0:s;return bt.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return bt.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return bt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Ca(r,0),s=new Ca(r,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,s],o=>{const l=this.Dr(o.wr);i.push(l)}),bt.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Dn(Lr);return r.forEach(s=>{const i=new Ca(s,0),o=new Ca(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{n=n.add(l.wr)})}),bt.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;sr.isDocumentKey(i)||(i=i.child(""));const o=new Ca(new sr(i),0);let l=new Dn(Lr);return this.br.forEachWhile(c=>{const d=c.key.path;return!!n.isPrefixOf(d)&&(d.length===s&&(l=l.add(c.wr)),!0)},o),bt.resolve(this.Cr(l))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){xr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return bt.forEach(r.mutations,s=>{const i=new Ca(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Ca(r,0),s=this.br.firstAfterOrEqual(n);return bt.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,bt.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PJ{constructor(e){this.Mr=e,this.docs=function(){return new fs(sr.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return bt.resolve(n?n.document.mutableCopy():ds.newInvalidDocument(r))}getEntries(e,r){let n=So();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():ds.newInvalidDocument(s))}),bt.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=So();const o=r.path,l=new sr(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:d,value:{document:A}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||iS(l6(A),n)<=0||(s.has(A.key)||Fx(r,A))&&(i=i.insert(A.key,A.mutableCopy()))}return bt.resolve(i)}getAllFromCollectionGroup(e,r,n,s){hr()}Or(e,r){return bt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new RJ(this)}getSize(e){return bt.resolve(this.size)}}class RJ extends dU{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),bt.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DJ{constructor(e){this.persistence=e,this.Nr=new wu(r=>kh(r),jx),this.lastRemoteSnapshotVersion=br.min(),this.highestTargetId=0,this.Lr=0,this.Br=new bS,this.targetCount=0,this.kr=Ph.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),bt.resolve()}getLastRemoteSnapshotVersion(e){return bt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return bt.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),bt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),bt.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Ph(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,bt.resolve()}updateTargetData(e,r){return this.Kn(r),bt.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,bt.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),bt.waitFor(i).next(()=>s)}getTargetCount(e){return bt.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return bt.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),bt.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),bt.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),bt.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return bt.resolve(n)}containsKey(e,r){return bt.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hU{constructor(e,r){this.qr={},this.overlays={},this.Qr=new cl(0),this.Kr=!1,this.Kr=!0,this.$r=new FJ,this.referenceDelegate=e(this),this.Ur=new DJ(this),this.indexManager=new vJ,this.remoteDocumentCache=function(s){return new PJ(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new rU(r),this.Gr=new jJ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new kJ,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new TJ(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Ht("MemoryPersistence","Starting transaction:",e);const s=new LJ(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,r){return bt.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class LJ extends d6{constructor(e){super(),this.currentSequenceNumber=e}}class p2{constructor(e){this.persistence=e,this.Jr=new bS,this.Yr=null}static Zr(e){return new p2(e)}get Xr(){if(this.Yr)return this.Yr;throw hr()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),bt.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),bt.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),bt.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return bt.forEach(this.Xr,n=>{const s=sr.fromPath(n);return this.ei(e,s).next(i=>{i||r.removeEntry(s,br.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return bt.or([()=>bt.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UJ{constructor(e){this.serializer=e}O(e,r,n,s){const i=new l2("createOrUpgrade",r);n<1&&s>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Nj,{unique:!0}),c.createObjectStore("documentMutations")}(e),dk(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=bt.resolve();return n<3&&s>=3&&(n!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),dk(e)),o=o.next(()=>function(c){const d=c.store("targetGlobal"),A={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:br.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",A)}(i))),n<4&&s>=4&&(n!==0&&(o=o.next(()=>function(c,d){return d.store("mutations").U().next(A=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Nj,{unique:!0});const u=d.store("mutations"),f=A.map(h=>u.put(h));return bt.waitFor(f)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&s>=5&&(o=o.next(()=>this.ni(i))),n<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),n<7&&s>=7&&(o=o.next(()=>this.ii(i))),n<8&&s>=8&&(o=o.next(()=>this.si(e,i))),n<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&s>=10&&(o=o.next(()=>this.oi(i))),n<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&s>=12&&(o=o.next(()=>{(function(c){const d=c.createObjectStore("documentOverlays",{keyPath:uW});d.createIndex("collectionPathOverlayIndex",hW,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",fW,{unique:!1})})(e)})),n<13&&s>=13&&(o=o.next(()=>function(c){const d=c.createObjectStore("remoteDocumentsV14",{keyPath:tW});d.createIndex("documentKeyIndex",rW),d.createIndex("collectionGroupIndex",nW)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),n<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:lW}).createIndex("sequenceNumberIndex",cW,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:dW}).createIndex("documentKeyIndex",AW,{unique:!1})}(e))),n<16&&s>=16&&(o=o.next(()=>{r.objectStore("indexState").clear()}).next(()=>{r.objectStore("indexEntries").clear()})),n<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let r=0;return e.store("remoteDocuments").J((n,s)=>{r+=sb(s)}).next(()=>{const n={byteSize:r};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){const r=e.store("mutationQueues"),n=e.store("mutations");return r.U().next(s=>bt.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",o).next(l=>bt.forEach(l,c=>{xr(c.userId===i.userId);const d=Ju(this.serializer,c);return oU(e,i.userId,d).next(()=>{})}))}))}ii(e){const r=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return n.J((o,l)=>{const c=new pn(o),d=function(u){return[0,Di(u)]}(c);i.push(r.get(d).next(A=>A?bt.resolve():(u=>r.put({targetId:0,path:Di(u),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>bt.waitFor(i))})}si(e,r){e.createObjectStore("collectionParents",{keyPath:oW});const n=r.store("collectionParents"),s=new yS,i=o=>{if(s.add(o)){const l=o.lastSegment(),c=o.popLast();return n.put({collectionId:l,parent:Di(c)})}};return r.store("remoteDocuments").J({H:!0},(o,l)=>{const c=new pn(o);return i(c.popLast())}).next(()=>r.store("documentMutations").J({H:!0},([o,l,c],d)=>{const A=vc(l);return i(A.popLast())}))}oi(e){const r=e.store("targets");return r.J((n,s)=>{const i=vp(s),o=nU(this.serializer,i);return r.put(o)})}_i(e,r){const n=r.store("remoteDocuments"),s=[];return n.J((i,o)=>{const l=r.store("remoteDocumentsV14"),c=function(u){return u.document?new sr(pn.fromString(u.document.name).popFirst(5)):u.noDocument?sr.fromSegments(u.noDocument.path):u.unknownDocument?sr.fromSegments(u.unknownDocument.path):hr()}(o).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(l.put(d))}).next(()=>bt.waitFor(s))}ai(e,r){const n=r.store("mutations"),s=AU(this.serializer),i=new hU(p2.Zr,this.serializer.ct);return n.U().next(o=>{const l=new Map;return o.forEach(c=>{var d;let A=(d=l.get(c.userId))!==null&&d!==void 0?d:qr();Ju(this.serializer,c).keys().forEach(u=>A=A.add(u)),l.set(c.userId,A)}),bt.forEach(l,(c,d)=>{const A=new Ha(d),u=f2.lt(this.serializer,A),f=i.getIndexManager(A),h=m2.lt(A,this.serializer,f,i.referenceDelegate);return new uU(s,h,u,f).recalculateAndSaveOverlaysForDocumentKeys(new j_(r,cl.oe),c).next()})})}}function dk(t){t.createObjectStore("targetDocuments",{keyPath:aW}).createIndex("documentTargetsIndex",iW,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",sW,{unique:!0}),t.createObjectStore("targetGlobal")}const eN="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class wS{constructor(e,r,n,s,i,o,l,c,d,A,u=17){if(this.allowTabSynchronization=e,this.persistenceKey=r,this.clientId=n,this.ui=i,this.window=o,this.document=l,this.ci=d,this.li=A,this.hi=u,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=f=>Promise.resolve(),!wS.D())throw new Wt(Bt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new EJ(this,s),this.Ai=r+"main",this.serializer=new rU(c),this.Ri=new XA(this.Ai,this.hi,new UJ(this.serializer)),this.$r=new hJ,this.Ur=new bJ(this.referenceDelegate,this.serializer),this.remoteDocumentCache=AU(this.serializer),this.Gr=new uJ,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,A===!1&&Pi("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Wt(Bt.FAILED_PRECONDITION,eN);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new cl(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async r=>{if(this.started)return e(r)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async r=>{r.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Uv(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(r=>{r||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(r=>this.isPrimary&&!r?this.bi(e).next(()=>!1):!!r&&this.Di(e).next(()=>!0))).catch(e=>{if(bu(e))return Ht("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ht("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return zm(e).get("owner").next(r=>bt.resolve(this.vi(r)))}Ci(e){return Uv(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const n=va(r,"clientMetadata");return n.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(l=>i.indexOf(l)===-1);return bt.forEach(o,l=>n.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const r of e)this.Vi.removeItem(this.Oi(r.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?bt.resolve(!0):zm(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)){if(this.vi(r)&&this.networkEnabled)return!0;if(!this.vi(r)){if(!r.allowTabSynchronization)throw new Wt(Bt.FAILED_PRECONDITION,eN);return!1}}return!(!this.networkEnabled||!this.inForeground)||Uv(e).U().next(n=>this.xi(n,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(r=>(this.isPrimary!==r&&Ht("IndexedDbPersistence",`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const r=new j_(e,cl.oe);return this.bi(r).next(()=>this.Ci(r))}),this.Ri.close(),this.qi()}xi(e,r){return e.filter(n=>this.Mi(n.updateTimeMs,r)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Uv(e).U().next(r=>this.xi(r,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,r){return m2.lt(e,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new yJ(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return f2.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,r,n){Ht("IndexedDbPersistence","Starting transaction:",e);const s=r==="readonly"?"readonly":"readwrite",i=function(c){return c===17?gW:c===16?pW:c===15?lS:c===14?m6:c===13?f6:c===12?mW:c===11?h6:void hr()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,l=>(o=new j_(l,this.Qr?this.Qr.next():cl.oe),r==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw Pi(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new Wt(Bt.FAILED_PRECONDITION,c6);return n(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>n(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return zm(e).get("owner").next(r=>{if(r!==null&&this.Mi(r.leaseTimestampMs,5e3)&&!this.Ni(r.ownerId)&&!this.vi(r)&&!(this.li||this.allowTabSynchronization&&r.allowTabSynchronization))throw new Wt(Bt.FAILED_PRECONDITION,eN)})}Di(e){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return zm(e).put("owner",r)}static D(){return XA.D()}bi(e){const r=zm(e);return r.get("owner").next(n=>this.vi(n)?(Ht("IndexedDbPersistence","Releasing primary lease."),r.delete("owner")):bt.resolve())}Mi(e,r){const n=Date.now();return!(e<n-r)&&(!(e>n)||(Pi(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const r=/(?:Version|Mobile)\/1[456]/;AL()&&(navigator.appVersion.match(r)||navigator.userAgent.match(r))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var r;try{const n=((r=this.Vi)===null||r===void 0?void 0:r.getItem(this.Oi(e)))!==null;return Ht("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Pi("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Pi("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function zm(t){return va(t,"owner")}function Uv(t){return va(t,"clientMetadata")}function OJ(t,e){let r=t.projectId;return t.isDefaultDatabase||(r+="."+t.database),"firestore/"+e+"/"+r+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=qr(),s=qr();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new NS(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MJ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return AL()?8:A6(ga())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.Yi(e,r).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,r,s,n).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new MJ;return this.Xi(e,r,o).next(l=>{if(i.result=l,this.zi)return this.es(e,r,o,l.size)})}).next(()=>i.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(Mf()<=rn.DEBUG&&Ht("QueryEngine","SDK will not create cache indexes for query:",Qf(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),bt.resolve()):(Mf()<=rn.DEBUG&&Ht("QueryEngine","Query:",Qf(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(Mf()<=rn.DEBUG&&Ht("QueryEngine","The SDK decides to create cache indexes for query:",Qf(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,hl(r))):bt.resolve())}Yi(e,r){if(Dj(r))return bt.resolve(null);let n=hl(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=tb(r,null,"F"),n=hl(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const o=qr(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const d=this.ts(r,l);return this.ns(r,d,o,c.readTime)?this.Yi(e,tb(r,null,"F")):this.rs(e,d,r,c)}))})))}Zi(e,r,n,s){return Dj(r)||s.isEqual(br.min())?bt.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const o=this.ts(r,i);return this.ns(r,o,n,s)?bt.resolve(null):(Mf()<=rn.DEBUG&&Ht("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Qf(r)),this.rs(e,o,r,$z(s,-1)).next(l=>l))})}ts(e,r){let n=new Dn(j6(e));return r.forEach((s,i)=>{Fx(e,i)&&(n=n.add(i))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,r,n){return Mf()<=rn.DEBUG&&Ht("QueryEngine","Using full collection scan to execute query:",Qf(r)),this.Ji.getDocumentsMatchingQuery(e,r,Fo.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QJ{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new fs(Lr),this._s=new wu(i=>kh(i),jx),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new uU(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function mU(t,e,r,n){return new QJ(t,e,r,n)}async function pU(t,e){const r=Fr(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const o=[],l=[];let c=qr();for(const d of s){o.push(d.batchId);for(const A of d.mutations)c=c.add(A.key)}for(const d of i){l.push(d.batchId);for(const A of d.mutations)c=c.add(A.key)}return r.localDocuments.getDocuments(n,c).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:l}))})})}function VJ(t,e){const r=Fr(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,d,A){const u=d.batch,f=u.keys();let h=bt.resolve();return f.forEach(m=>{h=h.next(()=>A.getEntry(c,m)).next(p=>{const g=d.docVersions.get(m);xr(g!==null),p.version.compareTo(g)<0&&(u.applyToRemoteDocument(p,d),p.isValidDocument()&&(p.setReadTime(d.commitVersion),A.addEntry(p)))})}),h.next(()=>l.mutationQueue.removeMutationBatch(c,u))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=qr();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(c=c.add(l.batch.mutations[d].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function gU(t){const e=Fr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function HJ(t,e){const r=Fr(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const l=[];e.targetChanges.forEach((A,u)=>{const f=s.get(u);if(!f)return;l.push(r.Ur.removeMatchingKeys(i,A.removedDocuments,u).next(()=>r.Ur.addMatchingKeys(i,A.addedDocuments,u)));let h=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(u)!==null?h=h.withResumeToken(Ws.EMPTY_BYTE_STRING,br.min()).withLastLimboFreeSnapshotVersion(br.min()):A.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(A.resumeToken,n)),s=s.insert(u,h),function(p,g,x){return p.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(f,h,A)&&l.push(r.Ur.updateTargetData(i,h))});let c=So(),d=qr();if(e.documentUpdates.forEach(A=>{e.resolvedLimboDocuments.has(A)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(i,A))}),l.push(KJ(i,o,e.documentUpdates).next(A=>{c=A.Ps,d=A.Is})),!n.isEqual(br.min())){const A=r.Ur.getLastRemoteSnapshotVersion(i).next(u=>r.Ur.setTargetsMetadata(i,i.currentSequenceNumber,n));l.push(A)}return bt.waitFor(l).next(()=>o.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(r.os=s,i))}function KJ(t,e,r){let n=qr(),s=qr();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let o=So();return r.forEach((l,c)=>{const d=i.get(l);c.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(br.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Ht("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function qJ(t,e){const r=Fr(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function GJ(t,e){const r=Fr(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(i=>i?(s=i,bt.resolve(s)):r.Ur.allocateTargetId(n).next(o=>(s=new dd(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function K_(t,e,r){const n=Fr(t),s=n.os.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,o=>n.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!bu(o))throw o;Ht("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function Ak(t,e,r){const n=Fr(t);let s=br.min(),i=qr();return n.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,A){const u=Fr(c),f=u._s.get(A);return f!==void 0?bt.resolve(u.os.get(f)):u.Ur.getTargetData(d,A)}(n,o,hl(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?s:br.min(),r?i:qr())).next(l=>($J(n,FW(e),l),{documents:l,Ts:i})))}function $J(t,e,r){let n=t.us.get(e)||br.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.us.set(e,n)}class uk{constructor(){this.activeTargetIds=UW()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xU{constructor(){this.so=new uk,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new uk,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zJ{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ht("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Ht("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ov=null;function tN(){return Ov===null?Ov=function(){return 268435456+Math.round(2147483648*Math.random())}():Ov++,"0x"+Ov.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WJ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JJ{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ni="WebChannelConnection";class XJ extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(r,n,s,i,o){const l=tN(),c=this.xo(r,n.toUriEncodedString());Ht("RestConnection",`Sending RPC '${r}' ${l}:`,c,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,o),this.No(r,c,d,s).then(A=>(Ht("RestConnection",`Received RPC '${r}' ${l}: `,A),A),A=>{throw nu("RestConnection",`RPC '${r}' ${l} failed with error: `,A,"url: ",c,"request:",s),A})}Lo(r,n,s,i,o,l){return this.Mo(r,n,s,i,o)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+rm}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,o)=>r[o]=i),s&&s.headers.forEach((i,o)=>r[o]=i)}xo(r,n){const s=WJ[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const i=tN();return new Promise((o,l)=>{const c=new e6;c.setWithCredentials(!0),c.listenOnce(t6.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case ay.NO_ERROR:const A=c.getResponseJson();Ht(ni,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(A)),o(A);break;case ay.TIMEOUT:Ht(ni,`RPC '${e}' ${i} timed out`),l(new Wt(Bt.DEADLINE_EXCEEDED,"Request time out"));break;case ay.HTTP_ERROR:const u=c.getStatus();if(Ht(ni,`RPC '${e}' ${i} failed with status:`,u,"response text:",c.getResponseText()),u>0){let f=c.getResponseJson();Array.isArray(f)&&(f=f[0]);const h=f==null?void 0:f.error;if(h&&h.status&&h.message){const m=function(g){const x=g.toLowerCase().replace(/_/g,"-");return Object.values(Bt).indexOf(x)>=0?x:Bt.UNKNOWN}(h.status);l(new Wt(m,h.message))}else l(new Wt(Bt.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Wt(Bt.UNAVAILABLE,"Connection failed."));break;default:hr()}}finally{Ht(ni,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);Ht(ni,`RPC '${e}' ${i} sending request:`,s),c.send(r,"POST",d,n,15)})}Bo(e,r,n){const s=tN(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=s6(),l=n6(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const A=i.join("");Ht(ni,`Creating RPC '${e}' stream ${s}: ${A}`,c);const u=o.createWebChannel(A,c);let f=!1,h=!1;const m=new JJ({Io:g=>{h?Ht(ni,`Not sending because RPC '${e}' stream ${s} is closed:`,g):(f||(Ht(ni,`Opening RPC '${e}' stream ${s} transport.`),u.open(),f=!0),Ht(ni,`RPC '${e}' stream ${s} sending:`,g),u.send(g))},To:()=>u.close()}),p=(g,x,b)=>{g.listen(x,w=>{try{b(w)}catch(k){setTimeout(()=>{throw k},0)}})};return p(u,pp.EventType.OPEN,()=>{h||(Ht(ni,`RPC '${e}' stream ${s} transport opened.`),m.yo())}),p(u,pp.EventType.CLOSE,()=>{h||(h=!0,Ht(ni,`RPC '${e}' stream ${s} transport closed`),m.So())}),p(u,pp.EventType.ERROR,g=>{h||(h=!0,nu(ni,`RPC '${e}' stream ${s} transport errored:`,g),m.So(new Wt(Bt.UNAVAILABLE,"The operation could not be completed")))}),p(u,pp.EventType.MESSAGE,g=>{var x;if(!h){const b=g.data[0];xr(!!b);const w=b,k=w.error||((x=w[0])===null||x===void 0?void 0:x.error);if(k){Ht(ni,`RPC '${e}' stream ${s} received error:`,k);const O=k.status;let L=function(S){const U=Ys[S];if(U!==void 0)return V6(U)}(O),E=k.message;L===void 0&&(L=Bt.INTERNAL,E="Unknown error status: "+O+" with message "+k.message),h=!0,m.So(new Wt(L,E)),u.close()}else Ht(ni,`RPC '${e}' stream ${s} received:`,b),m.bo(b)}}),p(l,r6.STAT_EVENT,g=>{g.stat===S_.PROXY?Ht(ni,`RPC '${e}' stream ${s} detected buffering proxy`):g.stat===S_.NOPROXY&&Ht(ni,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{m.wo()},0),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YJ(){return typeof window<"u"?window:null}function uy(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g2(t){return new eJ(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(e,r,n=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&Ht("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{constructor(e,r,n,s,i,o,l,c){this.ui=e,this.Ho=n,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new CS(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Bt.RESOURCE_EXHAUSTED?(Pi(r.toString()),Pi("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Bt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new Wt(Bt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Ht("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Ht("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class ZJ extends vU{constructor(e,r,n,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=sJ(this.serializer,e),n=function(i){if(!("targetChange"in i))return br.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?br.min():o.readTime?ja(o.readTime):br.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=O_(this.serializer),r.addTarget=function(i,o){let l;const c=o.target;if(l=Zy(c)?{documents:J6(i,c)}:{query:X6(i,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=q6(i,o.resumeToken);const d=L_(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(br.min())>0){l.readTime=Q0(i,o.snapshotVersion.toTimestamp());const d=L_(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const n=iJ(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=O_(this.serializer),r.removeTarget=e,this.a_(r)}}class eX extends vU{constructor(e,r,n,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return xr(!!e.streamToken),this.lastStreamToken=e.streamToken,xr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){xr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=aJ(e.writeResults,e.commitTime),n=ja(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=O_(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>qg(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tX extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Wt(Bt.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,U_(r,n),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Bt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Wt(Bt.UNKNOWN,i.toString())})}Lo(e,r,n,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,U_(r,n),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Bt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Wt(Bt.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class rX{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Pi(r),this.D_=!1):Ht("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nX{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{n.enqueueAndForget(async()=>{zh(this)&&(Ht("RemoteStore","Restarting streams for network reachability change."),await async function(c){const d=Fr(c);d.L_.add(4),await Px(d),d.q_.set("Unknown"),d.L_.delete(4),await x2(d)}(this))})}),this.q_=new rX(n,s)}}async function x2(t){if(zh(t))for(const e of t.B_)await e(!0)}async function Px(t){for(const e of t.B_)await e(!1)}function yU(t,e){const r=Fr(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),SS(r)?BS(r):im(r).r_()&&ES(r,e))}function _S(t,e){const r=Fr(t),n=im(r);r.N_.delete(e),n.r_()&&bU(r,e),r.N_.size===0&&(n.r_()?n.o_():zh(r)&&r.q_.set("Unknown"))}function ES(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(br.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}im(t).A_(e)}function bU(t,e){t.Q_.xe(e),im(t).R_(e)}function BS(t){t.Q_=new JW({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),im(t).start(),t.q_.v_()}function SS(t){return zh(t)&&!im(t).n_()&&t.N_.size>0}function zh(t){return Fr(t).L_.size===0}function wU(t){t.Q_=void 0}async function sX(t){t.q_.set("Online")}async function aX(t){t.N_.forEach((e,r)=>{ES(t,e)})}async function iX(t,e){wU(t),SS(t)?(t.q_.M_(e),BS(t)):t.q_.set("Unknown")}async function oX(t,e,r){if(t.q_.set("Online"),e instanceof K6&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(n){Ht("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await ab(t,n)}else if(e instanceof Ay?t.Q_.Ke(e):e instanceof H6?t.Q_.He(e):t.Q_.We(e),!r.isEqual(br.min()))try{const n=await gU(t.localStore);r.compareTo(n)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const A=i.N_.get(d);A&&i.N_.set(d,A.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,d)=>{const A=i.N_.get(c);if(!A)return;i.N_.set(c,A.withResumeToken(Ws.EMPTY_BYTE_STRING,A.snapshotVersion)),bU(i,c);const u=new dd(A.target,c,d,A.sequenceNumber);ES(i,u)}),i.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){Ht("RemoteStore","Failed to raise snapshot:",n),await ab(t,n)}}async function ab(t,e,r){if(!bu(e))throw e;t.L_.add(1),await Px(t),t.q_.set("Offline"),r||(r=()=>gU(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ht("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await x2(t)})}function NU(t,e){return e().catch(r=>ab(t,r,e))}async function Rx(t){const e=Fr(t),r=ou(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;lX(e);)try{const s=await qJ(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,cX(e,s)}catch(s){await ab(e,s)}CU(e)&&_U(e)}function lX(t){return zh(t)&&t.O_.length<10}function cX(t,e){t.O_.push(e);const r=ou(t);r.r_()&&r.V_&&r.m_(e.mutations)}function CU(t){return zh(t)&&!ou(t).n_()&&t.O_.length>0}function _U(t){ou(t).start()}async function dX(t){ou(t).p_()}async function AX(t){const e=ou(t);for(const r of t.O_)e.m_(r.mutations)}async function uX(t,e,r){const n=t.O_.shift(),s=mS.from(n,e,r);await NU(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Rx(t)}async function hX(t,e){e&&ou(t).V_&&await async function(n,s){if(function(o){return Q6(o)&&o!==Bt.ABORTED}(s.code)){const i=n.O_.shift();ou(n).s_(),await NU(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Rx(n)}}(t,e),CU(t)&&_U(t)}async function fk(t,e){const r=Fr(t);r.asyncQueue.verifyOperationInProgress(),Ht("RemoteStore","RemoteStore received new credentials");const n=zh(r);r.L_.add(3),await Px(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await x2(r)}async function fX(t,e){const r=Fr(t);e?(r.L_.delete(2),await x2(r)):e||(r.L_.add(2),await Px(r),r.q_.set("Unknown"))}function im(t){return t.K_||(t.K_=function(r,n,s){const i=Fr(r);return i.w_(),new ZJ(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:sX.bind(null,t),Ro:aX.bind(null,t),mo:iX.bind(null,t),d_:oX.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),SS(t)?BS(t):t.q_.set("Unknown")):(await t.K_.stop(),wU(t))})),t.K_}function ou(t){return t.U_||(t.U_=function(r,n,s){const i=Fr(r);return i.w_(),new eX(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:dX.bind(null,t),mo:hX.bind(null,t),f_:AX.bind(null,t),g_:uX.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Rx(t)):(await t.U_.stop(),t.O_.length>0&&(Ht("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Ml,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const o=Date.now()+n,l=new IS(e,r,o,s,i);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Wt(Bt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jS(t,e){if(Pi("AsyncQueue",`${e}: ${t}`),bu(t))return new Wt(Bt.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e){this.comparator=e?(r,n)=>e(r,n)||sr.comparator(r.key,n.key):(r,n)=>sr.comparator(r.key,n.key),this.keyedMap=gp(),this.sortedSet=new fs(this.comparator)}static emptySet(e){return new y0(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof y0)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new y0;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(){this.W_=new fs(sr.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):hr():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class V0{constructor(e,r,n,s,i,o,l,c,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,s,i){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new V0(e,r,y0.emptySet(r),o,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&d2(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mX{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class pX{constructor(){this.queries=pk(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Fr(r),i=s.queries;s.queries=pk(),i.forEach((o,l)=>{for(const c of l.j_)c.onError(n)})})(this,new Wt(Bt.ABORTED,"Firestore shutting down"))}}function pk(){return new wu(t=>I6(t),d2)}async function kS(t,e){const r=Fr(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.H_()&&e.J_()&&(n=2):(i=new mX,n=e.J_()?0:1);try{switch(n){case 0:i.z_=await r.onListen(s,!0);break;case 1:i.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(o){const l=jS(o,`Initialization of query '${Qf(e.query)}' failed`);return void e.onError(l)}r.queries.set(s,i),i.j_.push(e),e.Z_(r.onlineState),i.z_&&e.X_(i.z_)&&TS(r)}async function FS(t,e){const r=Fr(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function gX(t,e){const r=Fr(t);let n=!1;for(const s of e){const i=s.query,o=r.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(n=!0);o.z_=s}}n&&TS(r)}function xX(t,e,r){const n=Fr(t),s=n.queries.get(e);if(s)for(const i of s.j_)i.onError(r);n.queries.delete(e)}function TS(t){t.Y_.forEach(e=>{e.next()})}var q_,gk;(gk=q_||(q_={})).ea="default",gk.Cache="cache";class PS{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new V0(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=V0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==q_.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EU{constructor(e){this.key=e}}class BU{constructor(e){this.key=e}}class vX{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=qr(),this.mutatedKeys=qr(),this.Aa=j6(e),this.Ra=new y0(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new mk,s=r?r.Ra:this.Ra;let i=r?r.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((A,u)=>{const f=s.get(A),h=Fx(this.query,u)?u:null,m=!!f&&this.mutatedKeys.has(f.key),p=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let g=!1;f&&h?f.data.isEqual(h.data)?m!==p&&(n.track({type:3,doc:h}),g=!0):this.ga(f,h)||(n.track({type:2,doc:h}),g=!0,(c&&this.Aa(h,c)>0||d&&this.Aa(h,d)<0)&&(l=!0)):!f&&h?(n.track({type:0,doc:h}),g=!0):f&&!h&&(n.track({type:1,doc:f}),g=!0,(c||d)&&(l=!0)),g&&(h?(o=o.add(h),i=p?i.add(A):i.delete(A)):(o=o.delete(A),i=i.delete(A)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const A=this.query.limitType==="F"?o.last():o.first();o=o.delete(A.key),i=i.delete(A.key),n.track({type:1,doc:A})}return{Ra:o,fa:n,ns:l,mutatedKeys:i}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((A,u)=>function(h,m){const p=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return hr()}};return p(h)-p(m)}(A.type,u.type)||this.Aa(A.doc,u.doc)),this.pa(n),s=s!=null&&s;const l=r&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,d=c!==this.Ea;return this.Ea=c,o.length!==0||d?{snapshot:new V0(this.query,e.Ra,i,o,e.mutatedKeys,c===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new mk,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=qr(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new BU(n))}),this.da.forEach(n=>{e.has(n)||r.push(new EU(n))}),r}ba(e){this.Ta=e.Ts,this.da=qr();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return V0.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class yX{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class bX{constructor(e){this.key=e,this.va=!1}}class wX{constructor(e,r,n,s,i,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new wu(l=>I6(l),d2),this.Ma=new Map,this.xa=new Set,this.Oa=new fs(sr.comparator),this.Na=new Map,this.La=new bS,this.Ba={},this.ka=new Map,this.qa=Ph.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function NX(t,e,r=!0){const n=TU(t);let s;const i=n.Fa.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await SU(n,e,r,!0),s}async function CX(t,e){const r=TU(t);await SU(r,e,!0,!1)}async function SU(t,e,r,n){const s=await GJ(t.localStore,hl(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,r);let l;return n&&(l=await _X(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&r&&yU(t.remoteStore,s),l}async function _X(t,e,r,n,s){t.Ka=(u,f,h)=>async function(p,g,x,b){let w=g.view.ma(x);w.ns&&(w=await Ak(p.localStore,g.query,!1).then(({documents:E})=>g.view.ma(E,w)));const k=b&&b.targetChanges.get(g.targetId),O=b&&b.targetMismatches.get(g.targetId)!=null,L=g.view.applyChanges(w,p.isPrimaryClient,k,O);return vk(p,g.targetId,L.wa),L.snapshot}(t,u,f,h);const i=await Ak(t.localStore,e,!0),o=new vX(e,i.Ts),l=o.ma(i.documents),c=Tx.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),d=o.applyChanges(l,t.isPrimaryClient,c);vk(t,r,d.wa);const A=new yX(e,r,o);return t.Fa.set(e,A),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),d.snapshot}async function EX(t,e,r){const n=Fr(t),s=n.Fa.get(e),i=n.Ma.get(s.targetId);if(i.length>1)return n.Ma.set(s.targetId,i.filter(o=>!d2(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await K_(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&_S(n.remoteStore,s.targetId),G_(n,s.targetId)}).catch(Gh)):(G_(n,s.targetId),await K_(n.localStore,s.targetId,!0))}async function BX(t,e){const r=Fr(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),_S(r.remoteStore,n.targetId))}async function SX(t,e,r){const n=PU(t);try{const s=await function(o,l){const c=Fr(o),d=$t.now(),A=l.reduce((h,m)=>h.add(m.key),qr());let u,f;return c.persistence.runTransaction("Locally write mutations","readwrite",h=>{let m=So(),p=qr();return c.cs.getEntries(h,A).next(g=>{m=g,m.forEach((x,b)=>{b.isValidDocument()||(p=p.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(h,m)).next(g=>{u=g;const x=[];for(const b of l){const w=GW(b,u.get(b.key).overlayedDocument);w!=null&&x.push(new Pd(b.key,w,y6(w.value.mapValue),us.exists(!0)))}return c.mutationQueue.addMutationBatch(h,d,x,l)}).next(g=>{f=g;const x=g.applyToLocalDocumentSet(u,p);return c.documentOverlayCache.saveOverlays(h,g.batchId,x)})}).then(()=>({batchId:f.batchId,changes:F6(u)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let d=o.Ba[o.currentUser.toKey()];d||(d=new fs(Lr)),d=d.insert(l,c),o.Ba[o.currentUser.toKey()]=d}(n,s.batchId,r),await Dx(n,s.changes),await Rx(n.remoteStore)}catch(s){const i=jS(s,"Failed to persist write");r.reject(i)}}async function IU(t,e){const r=Fr(t);try{const n=await HJ(r.localStore,e);e.targetChanges.forEach((s,i)=>{const o=r.Na.get(i);o&&(xr(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?xr(o.va):s.removedDocuments.size>0&&(xr(o.va),o.va=!1))}),await Dx(r,n,e)}catch(n){await Gh(n)}}function xk(t,e,r){const n=Fr(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=Fr(o);c.onlineState=l;let d=!1;c.queries.forEach((A,u)=>{for(const f of u.j_)f.Z_(l)&&(d=!0)}),d&&TS(c)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function IX(t,e,r){const n=Fr(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),i=s&&s.key;if(i){let o=new fs(sr.comparator);o=o.insert(i,ds.newNoDocument(i,br.min()));const l=qr().add(i),c=new h2(br.min(),new Map,new fs(Lr),o,l);await IU(n,c),n.Oa=n.Oa.remove(i),n.Na.delete(e),RS(n)}else await K_(n.localStore,e,!1).then(()=>G_(n,e,r)).catch(Gh)}async function jX(t,e){const r=Fr(t),n=e.batch.batchId;try{const s=await VJ(r.localStore,e);kU(r,n,null),jU(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Dx(r,s)}catch(s){await Gh(s)}}async function kX(t,e,r){const n=Fr(t);try{const s=await function(o,l){const c=Fr(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let A;return c.mutationQueue.lookupMutationBatch(d,l).next(u=>(xr(u!==null),A=u.keys(),c.mutationQueue.removeMutationBatch(d,u))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,A,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,A)).next(()=>c.localDocuments.getDocuments(d,A))})}(n.localStore,e);kU(n,e,r),jU(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Dx(n,s)}catch(s){await Gh(s)}}function jU(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function kU(t,e,r){const n=Fr(t);let s=n.Ba[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function G_(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||FU(t,n)})}function FU(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(_S(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),RS(t))}function vk(t,e,r){for(const n of r)n instanceof EU?(t.La.addReference(n.key,e),FX(t,n)):n instanceof BU?(Ht("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||FU(t,n.key)):hr()}function FX(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Ht("SyncEngine","New document in limbo: "+r),t.xa.add(n),RS(t))}function RS(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new sr(pn.fromString(e)),n=t.qa.next();t.Na.set(n,new bX(r)),t.Oa=t.Oa.insert(r,n),yU(t.remoteStore,new dd(hl(kx(r.path)),n,"TargetPurposeLimboResolution",cl.oe))}}async function Dx(t,e,r){const n=Fr(t),s=[],i=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((l,c)=>{o.push(n.Ka(c,e,r).then(d=>{var A;if((d||r)&&n.isPrimaryClient){const u=d?!d.fromCache:(A=r==null?void 0:r.targetChanges.get(c.targetId))===null||A===void 0?void 0:A.current;n.sharedClientState.updateQueryState(c.targetId,u?"current":"not-current")}if(d){s.push(d);const u=NS.Wi(c.targetId,d);i.push(u)}}))}),await Promise.all(o),n.Ca.d_(s),await async function(c,d){const A=Fr(c);try{await A.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>bt.forEach(d,f=>bt.forEach(f.$i,h=>A.persistence.referenceDelegate.addReference(u,f.targetId,h)).next(()=>bt.forEach(f.Ui,h=>A.persistence.referenceDelegate.removeReference(u,f.targetId,h)))))}catch(u){if(!bu(u))throw u;Ht("LocalStore","Failed to update sequence numbers: "+u)}for(const u of d){const f=u.targetId;if(!u.fromCache){const h=A.os.get(f),m=h.snapshotVersion,p=h.withLastLimboFreeSnapshotVersion(m);A.os=A.os.insert(f,p)}}}(n.localStore,i))}async function TX(t,e){const r=Fr(t);if(!r.currentUser.isEqual(e)){Ht("SyncEngine","User change. New user:",e.toKey());const n=await pU(r.localStore,e);r.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new Wt(Bt.CANCELLED,o))})}),i.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Dx(r,n.hs)}}function PX(t,e){const r=Fr(t),n=r.Na.get(e);if(n&&n.va)return qr().add(n.key);{let s=qr();const i=r.Ma.get(e);if(!i)return s;for(const o of i){const l=r.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function TU(t){const e=Fr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=IU.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=PX.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=IX.bind(null,e),e.Ca.d_=gX.bind(null,e.eventManager),e.Ca.$a=xX.bind(null,e.eventManager),e}function PU(t){const e=Fr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=jX.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=kX.bind(null,e),e}class Gg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=g2(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return mU(this.persistence,new fU,e.initialUser,this.serializer)}Ga(e){return new hU(p2.Zr,this.serializer)}Wa(e){return new xU}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Gg.provider={build:()=>new Gg};class RX extends Gg{constructor(e,r,n){super(),this.Ja=e,this.cacheSizeBytes=r,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await PU(this.Ja.syncEngine),await Rx(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return mU(this.persistence,new fU,e.initialUser,this.serializer)}ja(e,r){const n=this.persistence.referenceDelegate.garbageCollector;return new NJ(n,e.asyncQueue,r)}Ha(e,r){const n=new Xz(r,this.persistence);return new Jz(e.asyncQueue,n)}Ga(e){const r=OJ(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?zi.withCacheSize(this.cacheSizeBytes):zi.DEFAULT;return new wS(this.synchronizeTabs,r,e.clientId,n,e.asyncQueue,YJ(),uy(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new xU}}class ib{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>xk(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=TX.bind(null,this.syncEngine),await fX(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new pX}()}createDatastore(e){const r=g2(e.databaseInfo.databaseId),n=function(i){return new XJ(i)}(e.databaseInfo);return function(i,o,l,c){return new tX(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,o,l){return new nX(n,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>xk(this.syncEngine,r,0),function(){return hk.D()?new hk:new zJ}())}createSyncEngine(e,r){return function(s,i,o,l,c,d,A){const u=new wX(s,i,o,l,c,d);return A&&(u.Qa=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Fr(s);Ht("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Px(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}ib.provider={build:()=>new ib};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Pi("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DX{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Wt(Bt.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const r=await async function(s,i){const o=Fr(s),l={documents:i.map(u=>Kg(o.serializer,u))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,pn.emptyPath(),l,i.length),d=new Map;c.forEach(u=>{const f=nJ(o.serializer,u);d.set(f.key.toString(),f)});const A=[];return i.forEach(u=>{const f=d.get(u.toString());xr(!!f),A.push(f)}),A}(this.datastore,e);return r.forEach(n=>this.recordVersion(n)),r}set(e,r){this.write(r.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,r){try{this.write(r.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new am(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((r,n)=>{const s=sr.fromPath(n);this.mutations.push(new hS(s,this.precondition(s)))}),await async function(n,s){const i=Fr(n),o={writes:s.map(l=>qg(i.serializer,l))};await i.Mo("Commit",i.serializer.databaseId,pn.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let r;if(e.isFoundDocument())r=e.version;else{if(!e.isNoDocument())throw hr();r=br.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!r.isEqual(n))throw new Wt(Bt.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),r)}precondition(e){const r=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&r?r.isEqual(br.min())?us.exists(!1):us.updateTime(r):us.none()}preconditionForUpdate(e){const r=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&r){if(r.isEqual(br.min()))throw new Wt(Bt.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return us.updateTime(r)}return us.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LX{constructor(e,r,n,s,i){this.asyncQueue=e,this.datastore=r,this.options=n,this.updateFunction=s,this.deferred=i,this._u=n.maxAttempts,this.t_=new CS(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new DX(this.datastore),r=this.cu(e);r&&r.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(s=>{this.lu(s)}))}).catch(n=>{this.lu(n)})})}cu(e){try{const r=this.updateFunction(e);return!Ix(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const r=e.code;return r==="aborted"||r==="failed-precondition"||r==="already-exists"||!Q6(r)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UX{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Ha.UNAUTHENTICATED,this.clientId=aS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async o=>{Ht("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Ht("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ml;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=jS(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function rN(t,e){t.asyncQueue.verifyOperationInProgress(),Ht("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await pU(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function yk(t,e){t.asyncQueue.verifyOperationInProgress();const r=await OX(t);Ht("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>fk(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>fk(e.remoteStore,s)),t._onlineComponents=e}async function OX(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ht("FirestoreClient","Using user provided OfflineComponentProvider");try{await rN(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===Bt.FAILED_PRECONDITION||s.code===Bt.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;nu("Error using user provided cache. Falling back to memory cache: "+r),await rN(t,new Gg)}}else Ht("FirestoreClient","Using default OfflineComponentProvider"),await rN(t,new Gg);return t._offlineComponents}async function LS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ht("FirestoreClient","Using user provided OnlineComponentProvider"),await yk(t,t._uninitializedComponentsProvider._online)):(Ht("FirestoreClient","Using default OnlineComponentProvider"),await yk(t,new ib))),t._onlineComponents}function MX(t){return LS(t).then(e=>e.syncEngine)}function QX(t){return LS(t).then(e=>e.datastore)}async function ob(t){const e=await LS(t),r=e.eventManager;return r.onListen=NX.bind(null,e.syncEngine),r.onUnlisten=EX.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=CX.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=BX.bind(null,e.syncEngine),r}function VX(t,e,r={}){const n=new Ml;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,d){const A=new DS({next:f=>{A.Za(),o.enqueueAndForget(()=>FS(i,u));const h=f.docs.has(l);!h&&f.fromCache?d.reject(new Wt(Bt.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&f.fromCache&&c&&c.source==="server"?d.reject(new Wt(Bt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(f)},error:f=>d.reject(f)}),u=new PS(kx(l.path),A,{includeMetadataChanges:!0,_a:!0});return kS(i,u)}(await ob(t),t.asyncQueue,e,r,n)),n.promise}function HX(t,e,r={}){const n=new Ml;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,d){const A=new DS({next:f=>{A.Za(),o.enqueueAndForget(()=>FS(i,u)),f.fromCache&&c.source==="server"?d.reject(new Wt(Bt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(f)},error:f=>d.reject(f)}),u=new PS(l,A,{includeMetadataChanges:!0,_a:!0});return kS(i,u)}(await ob(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RU(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bk=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DU(t,e,r){if(!r)throw new Wt(Bt.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function LU(t,e,r,n){if(e===!0&&n===!0)throw new Wt(Bt.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function wk(t){if(!sr.isDocumentKey(t))throw new Wt(Bt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Nk(t){if(sr.isDocumentKey(t))throw new Wt(Bt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function v2(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":hr()}function ka(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Wt(Bt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=v2(t);throw new Wt(Bt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Wt(Bt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Wt(Bt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}LU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=RU((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Wt(Bt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Wt(Bt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Wt(Bt.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class y2{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ck({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Wt(Bt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Wt(Bt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ck(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new i6;switch(n.type){case"firstParty":return new Vz(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Wt(Bt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=bk.get(r);n&&(Ht("ComponentProvider","Removing Datastore"),bk.delete(r),n.terminate())}(this),Promise.resolve()}}function UU(t,e,r,n={}){var s;const i=(t=ka(t,y2))._getSettings(),o=`${e}:${r}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&nu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),n.mockUserToken){let l,c;if(typeof n.mockUserToken=="string")l=n.mockUserToken,c=Ha.MOCK_USER;else{l=aq(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new Wt(Bt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ha(d)}t._authCredentials=new Oz(new a6(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Sc(this.firestore,e,this._query)}}class Fa{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pd(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Fa(this.firestore,e,this._key)}}class pd extends Sc{constructor(e,r,n){super(e,r,kx(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Fa(this.firestore,null,new sr(e))}withConverter(e){return new pd(this.firestore,e,this._path)}}function ht(t,e,...r){if(t=Ps(t),DU("collection","path",e),t instanceof y2){const n=pn.fromString(e,...r);return Nk(n),new pd(t,null,n)}{if(!(t instanceof Fa||t instanceof pd))throw new Wt(Bt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pn.fromString(e,...r));return Nk(n),new pd(t.firestore,null,n)}}function kt(t,e,...r){if(t=Ps(t),arguments.length===1&&(e=aS.newId()),DU("doc","path",e),t instanceof y2){const n=pn.fromString(e,...r);return wk(n),new Fa(t,null,new sr(n))}{if(!(t instanceof Fa||t instanceof pd))throw new Wt(Bt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pn.fromString(e,...r));return wk(n),new Fa(t.firestore,t instanceof pd?t.converter:null,new sr(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _k{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new CS(this,"async_queue_retry"),this.Vu=()=>{const n=uy();n&&Ht("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=uy();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=uy();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Ml;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!bu(e))throw e;Ht("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw Pi("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=IS.createAndSchedule(this,e,r,n,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&hr()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function Ek(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class To extends y2{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new _k,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new _k(e),this._firestoreClient=void 0,await e}}}function OU(t,e){const r=typeof t=="object"?t:$B(),n=typeof t=="string"?t:"(default)",s=qB(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=nq("firestore");i&&UU(s,...i)}return s}function Wh(t){if(t._terminated)throw new Wt(Bt.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||MU(t),t._firestoreClient}function MU(t){var e,r,n;const s=t._freezeSettings(),i=function(l,c,d,A){return new vW(l,c,d,A.host,A.ssl,A.experimentalForceLongPolling,A.experimentalAutoDetectLongPolling,RU(A.experimentalLongPollingOptions),A.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new UX(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function QU(t,e){nu("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings();return KX(t,ib.provider,{build:n=>new RX(n,r.cacheSizeBytes,void 0)}),Promise.resolve()}function KX(t,e,r){if((t=ka(t,To))._firestoreClient||t._terminated)throw new Wt(Bt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Wt(Bt.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:r},MU(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new lu(Ws.fromBase64String(e))}catch(r){throw new Wt(Bt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new lu(Ws.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Wt(Bt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new As(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Wt(Bt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Wt(Bt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Lr(this._lat,e._lat)||Lr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qX=/^__.*__$/;class GX{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Pd(e,this.data,this.fieldMask,r,this.fieldTransforms):new sm(e,this.data,r,this.fieldTransforms)}}class VU{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Pd(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function HU(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw hr()}}class US{constructor(e,r,n,s,i,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new US(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return lb(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(HU(this.Cu)&&qX.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class $X{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||g2(e)}Qu(e,r,n,s=!1){return new US({Cu:e,methodName:r,qu:n,path:As.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function om(t){const e=t._freezeSettings(),r=g2(t._databaseId);return new $X(t._databaseId,!!e.ignoreUndefinedProperties,r)}function C2(t,e,r,n,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,r,s);QS("Data must be an object, but it was:",o,n);const l=KU(n,o);let c,d;if(i.merge)c=new Yi(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const A=[];for(const u of i.mergeFields){const f=$_(e,u,r);if(!o.contains(f))throw new Wt(Bt.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);GU(A,f)||A.push(f)}c=new Yi(A),d=o.fieldTransforms.filter(u=>c.covers(u.field))}else c=null,d=o.fieldTransforms;return new GX(new $a(l),c,d)}class _2 extends b2{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _2}}function OS(t,e,r,n){const s=t.Qu(1,e,r);QS("Data must be an object, but it was:",s,n);const i=[],o=$a.empty();$h(n,(c,d)=>{const A=VS(e,c,r);d=Ps(d);const u=s.Nu(A);if(d instanceof _2)i.push(A);else{const f=Lx(d,u);f!=null&&(i.push(A),o.set(A,f))}});const l=new Yi(i);return new VU(o,l,s.fieldTransforms)}function MS(t,e,r,n,s,i){const o=t.Qu(1,e,r),l=[$_(e,n,r)],c=[s];if(i.length%2!=0)throw new Wt(Bt.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)l.push($_(e,i[f])),c.push(i[f+1]);const d=[],A=$a.empty();for(let f=l.length-1;f>=0;--f)if(!GU(d,l[f])){const h=l[f];let m=c[f];m=Ps(m);const p=o.Nu(h);if(m instanceof _2)d.push(h);else{const g=Lx(m,p);g!=null&&(d.push(h),A.set(h,g))}}const u=new Yi(d);return new VU(A,u,o.fieldTransforms)}function zX(t,e,r,n=!1){return Lx(r,t.Qu(n?4:3,e))}function Lx(t,e){if(qU(t=Ps(t)))return QS("Unsupported field value:",e,t),KU(t,e);if(t instanceof b2)return function(n,s){if(!HU(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const i=[];let o=0;for(const l of n){let c=Lx(l,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=Ps(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return OW(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=$t.fromDate(n);return{timestampValue:Q0(s.serializer,i)}}if(n instanceof $t){const i=new $t(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Q0(s.serializer,i)}}if(n instanceof w2)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof lu)return{bytesValue:q6(s.serializer,n._byteString)};if(n instanceof Fa){const i=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:xS(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof N2)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return uS(l.serializer,c)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${v2(n)}`)}(t,e)}function KU(t,e){const r={};return p6(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):$h(t,(n,s)=>{const i=Lx(s,e.Mu(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function qU(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $t||t instanceof w2||t instanceof lu||t instanceof Fa||t instanceof b2||t instanceof N2)}function QS(t,e,r){if(!qU(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=v2(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function $_(t,e,r){if((e=Ps(e))instanceof Jh)return e._internalPath;if(typeof e=="string")return VS(t,e);throw lb("Field path arguments must be of type string or ",t,!1,void 0,r)}const WX=new RegExp("[~\\*/\\[\\]]");function VS(t,e,r){if(e.search(WX)>=0)throw lb(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Jh(...e.split("."))._internalPath}catch{throw lb(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function lb(t,e,r,n,s){const i=n&&!n.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${n}`),o&&(c+=` in document ${s}`),c+=")"),new Wt(Bt.INVALID_ARGUMENT,l+t+c)}function GU(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Fa(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new JX(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(E2("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class JX extends cb{data(){return super.data()}}function E2(t,e){return typeof e=="string"?VS(t,e):e instanceof Jh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $U(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Wt(Bt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class HS{}class B2 extends HS{}function Dt(t,e,...r){let n=[];e instanceof HS&&n.push(e),n=n.concat(r),function(i){const o=i.filter(c=>c instanceof S2).length,l=i.filter(c=>c instanceof Ux).length;if(o>1||o>0&&l>0)throw new Wt(Bt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class Ux extends B2{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Ux(e,r,n)}_apply(e){const r=this._parse(e);return WU(e._query,r),new Sc(e.firestore,e.converter,D_(e._query,r))}_parse(e){const r=om(e.firestore);return function(i,o,l,c,d,A,u){let f;if(d.isKeyField()){if(A==="array-contains"||A==="array-contains-any")throw new Wt(Bt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${A}' queries on documentId().`);if(A==="in"||A==="not-in"){Sk(u,A);const h=[];for(const m of u)h.push(Bk(c,i,m));f={arrayValue:{values:h}}}else f=Bk(c,i,u)}else A!=="in"&&A!=="not-in"&&A!=="array-contains-any"||Sk(u,A),f=zX(l,o,u,A==="in"||A==="not-in");return nn.create(d,A,f)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Gt(t,e,r){const n=e,s=E2("where",t);return Ux._create(s,n,r)}class S2 extends HS{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new S2(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:In.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)WU(o,c),o=D_(o,c)}(e._query,r),new Sc(e.firestore,e.converter,D_(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class I2 extends B2{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new I2(e,r)}_apply(e){const r=function(s,i,o){if(s.startAt!==null)throw new Wt(Bt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Wt(Bt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Qg(i,o)}(e._query,this._field,this._direction);return new Sc(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new nm(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function Ur(t,e="asc"){const r=e,n=E2("orderBy",t);return I2._create(n,r)}class j2 extends B2{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new j2(e,r,n)}_apply(e){return new Sc(e.firestore,e.converter,tb(e._query,this._limit,this._limitType))}}function zU(t){return j2._create("limit",t,"F")}function Bk(t,e,r){if(typeof(r=Ps(r))=="string"){if(r==="")throw new Wt(Bt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!S6(e)&&r.indexOf("/")!==-1)throw new Wt(Bt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(pn.fromString(r));if(!sr.isDocumentKey(n))throw new Wt(Bt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Og(t,new sr(n))}if(r instanceof Fa)return Og(t,r._key);throw new Wt(Bt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${v2(r)}.`)}function Sk(t,e){if(!Array.isArray(t)||t.length===0)throw new Wt(Bt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function WU(t,e){const r=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Wt(Bt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Wt(Bt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class KS{convertValue(e,r="none"){switch(jh(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ls(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(su(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw hr()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return $h(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var r,n,s;const i=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(o=>ls(o.doubleValue));return new N2(i)}convertGeoPoint(e){return new w2(ls(e.latitude),ls(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=dS(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Lg(e));default:return null}}convertTimestamp(e){const r=Id(e);return new $t(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=pn.fromString(e);xr(tU(n));const s=new au(n.get(1),n.get(3)),i=new sr(n.popFirst(5));return s.isEqual(r)||Pi(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k2(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class XX extends KS{constructor(e){super(),this.firestore=e}convertBytes(e){return new lu(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Fa(this.firestore,null,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class F2 extends cb{constructor(e,r,n,s,i,o){super(e,r,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Gp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(E2("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Gp extends F2{data(e={}){return super.data(e)}}class qS{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new sh(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Gp(this._firestore,this._userDataWriter,n.key,n,new sh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Wt(Bt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new Gp(s._firestore,s._userDataWriter,l.doc.key,l.doc,new sh(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new Gp(s._firestore,s._userDataWriter,l.doc.key,l.doc,new sh(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,A=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),A=o.indexOf(l.doc.key)),{type:YX(l.type),doc:c,oldIndex:d,newIndex:A}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function YX(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return hr()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ya(t){t=ka(t,Fa);const e=ka(t.firestore,To);return VX(Wh(e),t._key).then(r=>XU(e,t,r))}class T2 extends KS{constructor(e){super(),this.firestore=e}convertBytes(e){return new lu(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Fa(this.firestore,null,r)}}function Nt(t){t=ka(t,Sc);const e=ka(t.firestore,To),r=Wh(e),n=new T2(e);return $U(t._query),HX(r,t._query).then(s=>new qS(e,n,t,s))}function JU(t,e,r){t=ka(t,Fa);const n=ka(t.firestore,To),s=k2(t.converter,e,r);return lm(n,[C2(om(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,us.none())])}function Pr(t,e,r,...n){t=ka(t,Fa);const s=ka(t.firestore,To),i=om(s);let o;return o=typeof(e=Ps(e))=="string"||e instanceof Jh?MS(i,"updateDoc",t._key,e,r,n):OS(i,"updateDoc",t._key,e),lm(s,[o.toMutation(t._key,us.exists(!0))])}function un(t){return lm(ka(t.firestore,To),[new am(t._key,us.none())])}function Jr(t,e){const r=ka(t.firestore,To),n=kt(t),s=k2(t.converter,e);return lm(r,[C2(om(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,us.exists(!1))]).then(()=>n)}function H0(t,...e){var r,n,s;t=Ps(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Ek(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Ek(e[o])){const u=e[o];e[o]=(r=u.next)===null||r===void 0?void 0:r.bind(u),e[o+1]=(n=u.error)===null||n===void 0?void 0:n.bind(u),e[o+2]=(s=u.complete)===null||s===void 0?void 0:s.bind(u)}let c,d,A;if(t instanceof Fa)d=ka(t.firestore,To),A=kx(t._key.path),c={next:u=>{e[o]&&e[o](XU(d,t,u))},error:e[o+1],complete:e[o+2]};else{const u=ka(t,Sc);d=ka(u.firestore,To),A=u._query;const f=new T2(d);c={next:h=>{e[o]&&e[o](new qS(d,f,u,h))},error:e[o+1],complete:e[o+2]},$U(t._query)}return function(f,h,m,p){const g=new DS(p),x=new PS(h,g,m);return f.asyncQueue.enqueueAndForget(async()=>kS(await ob(f),x)),()=>{g.Za(),f.asyncQueue.enqueueAndForget(async()=>FS(await ob(f),x))}}(Wh(d),A,l,c)}function lm(t,e){return function(n,s){const i=new Ml;return n.asyncQueue.enqueueAndForget(async()=>SX(await MX(n),s,i)),i.promise}(Wh(t),e)}function XU(t,e,r){const n=r.docs.get(e._key),s=new T2(t);return new F2(t,s,e._key,n,new sh(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZX={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YU{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=om(e)}set(e,r,n){this._verifyNotCommitted();const s=SA(e,this._firestore),i=k2(s.converter,r,n),o=C2(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(o.toMutation(s._key,us.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=SA(e,this._firestore);let o;return o=typeof(r=Ps(r))=="string"||r instanceof Jh?MS(this._dataReader,"WriteBatch.update",i._key,r,n,s):OS(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(o.toMutation(i._key,us.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=SA(e,this._firestore);return this._mutations=this._mutations.concat(new am(r._key,us.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Wt(Bt.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function SA(t,e){if((t=Ps(t)).firestore!==e)throw new Wt(Bt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU extends class{constructor(r,n){this._firestore=r,this._transaction=n,this._dataReader=om(r)}get(r){const n=SA(r,this._firestore),s=new XX(this._firestore);return this._transaction.lookup([n._key]).then(i=>{if(!i||i.length!==1)return hr();const o=i[0];if(o.isFoundDocument())return new cb(this._firestore,s,o.key,o,n.converter);if(o.isNoDocument())return new cb(this._firestore,s,n._key,null,n.converter);throw hr()})}set(r,n,s){const i=SA(r,this._firestore),o=k2(i.converter,n,s),l=C2(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,s);return this._transaction.set(i._key,l),this}update(r,n,s,...i){const o=SA(r,this._firestore);let l;return l=typeof(n=Ps(n))=="string"||n instanceof Jh?MS(this._dataReader,"Transaction.update",o._key,n,s,i):OS(this._dataReader,"Transaction.update",o._key,n),this._transaction.update(o._key,l),this}delete(r){const n=SA(r,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,r){super(e,r),this._firestore=e}get(e){const r=SA(e,this._firestore),n=new T2(this._firestore);return super.get(e).then(s=>new F2(this._firestore,n,r._key,s._document,new sh(!1,!1),r.converter))}}function pa(t,e,r){t=ka(t,To);const n=Object.assign(Object.assign({},ZX),r);return function(i){if(i.maxAttempts<1)throw new Wt(Bt.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(i,o,l){const c=new Ml;return i.asyncQueue.enqueueAndForget(async()=>{const d=await QX(i);new LX(i.asyncQueue,d,l,o,c).au()}),c.promise}(Wh(t),s=>e(new ZU(t,s)),n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(t){return Wh(t=ka(t,To)),new YU(t,e=>lm(t,e))}(function(e,r=!0){(function(s){rm=s})(em),P0(new Eh("firestore",(n,{instanceIdentifier:s,options:i})=>{const o=n.getProvider("app").getImmediate(),l=new To(new Mz(n.getProvider("auth-internal")),new Kz(n.getProvider("app-check-internal")),function(d,A){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Wt(Bt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new au(d.options.projectId,A)}(o,s),o);return i=Object.assign({useFetchStreams:r},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),JA(yj,"4.7.3",e),JA(yj,"4.7.3","esm2017")})();const eY=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:KS,Bytes:lu,CollectionReference:pd,DocumentReference:Fa,DocumentSnapshot:F2,FieldPath:Jh,FieldValue:b2,Firestore:To,FirestoreError:Wt,GeoPoint:w2,Query:Sc,QueryCompositeFilterConstraint:S2,QueryConstraint:B2,QueryDocumentSnapshot:Gp,QueryFieldFilterConstraint:Ux,QueryLimitConstraint:j2,QueryOrderByConstraint:I2,QuerySnapshot:qS,SnapshotMetadata:sh,Timestamp:$t,Transaction:ZU,VectorValue:N2,WriteBatch:YU,_AutoId:aS,_ByteString:Ws,_DatabaseId:au,_DocumentKey:sr,_EmptyAuthCredentialsProvider:i6,_FieldPath:As,_cast:ka,_logWarn:nu,_validateIsNotUsedTogether:LU,addDoc:Jr,collection:ht,connectFirestoreEmulator:UU,deleteDoc:un,doc:kt,enableIndexedDbPersistence:QU,ensureFirestoreConfigured:Wh,executeWrite:lm,getDoc:Ya,getDocs:Nt,getFirestore:OU,limit:zU,onSnapshot:H0,orderBy:Ur,query:Dt,runTransaction:pa,setDoc:JU,updateDoc:Pr,where:Gt,writeBatch:Xh},Symbol.toStringTag,{value:"Module"})),tY={apiKey:"AIzaSyA_ZzeP_DAoXeRuallrOaJ4xFaxjnuhw-8",authDomain:"posys-103de.firebaseapp.com",projectId:"posys-103de",storageBucket:"posys-103de.firebasestorage.app",messagingSenderId:"401054148688",appId:"1:401054148688:web:1c2aea9e8b40958b514955",measurementId:"G-Q2GWQXMFLX"},eO=GB(tY),Te=OU(eO),Ox=YL(eO);QU(Te).catch(t=>{t.code==="failed-precondition"?console.warn(" Ya hay otra pestaa usando persistencia."):t.code==="unimplemented"?console.warn(" El navegador no soporta persistencia offline."):console.error(" Error en persistencia offline:",t)});function rY(){const[t,e]=N.useState(""),[r,n]=N.useState(""),[s,i]=N.useState(!1),[o,l]=N.useState(""),[c,d]=N.useState(!1),A=bx(),u=h=>{if(localStorage.setItem("role",h),h==="admin")return A("/admin");if(h==="vendedor_pollo")return A("/admin/salesV2");if(h==="vendedor_ropa")return A("/admin/salesClothes");if(h==="vendedor_dulces")return A("/admin/salesCandies")},f=async h=>{if(h.preventDefault(),l(""),!t.trim()){l("Ingresa el correo.");return}if(r.length<6){l("La contrasea debe tener al menos 6 caracteres.");return}try{d(!0);const m=await N$(Ox,t,r),p=m.user.uid,g=await Ya(kt(Te,"users",p));if(!g.exists()){l("Tu usuario no tiene perfil en la base de datos.");return}const x=g.data(),b=x.role||"",w=x.name||"";if(!["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"].includes(b)){l("Rol no vlido. Consulta al administrador.");return}localStorage.setItem("user_email",m.user.email||""),w&&localStorage.setItem("user_name",w),u(b)}catch(m){const p=String((m==null?void 0:m.code)||"");l(p==="auth/invalid-credential"||p==="auth/wrong-password"?"Credenciales incorrectas.":p==="auth/user-not-found"?"Usuario no encontrado.":p==="auth/too-many-requests"?"Demasiados intentos. Intenta ms tarde.":(m==null?void 0:m.message)||"Error al iniciar sesin.")}finally{d(!1)}};return a.jsx("div",{className:"min-h-screen grid place-items-center ",children:a.jsxs("form",{onSubmit:f,className:"w-[92%] max-w-md bg-white p-6 rounded-2xl shadow-2xl",children:[a.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Iniciar Sesin"}),a.jsx("label",{className:"block text-sm font-semibold",children:"Correo electrnico"}),a.jsx("input",{type:"email",className:"w-full border rounded-2xl px-3 py-2 mb-3 shadow-2xl",value:t,onChange:h=>e(h.target.value),autoComplete:"username"}),a.jsx("label",{className:"block text-sm font-semibold",children:"Contrasea"}),a.jsxs("div",{className:"flex gap-2 mb-2",children:[a.jsx("input",{type:s?"text":"password",className:"flex-1 border rounded-2xl px-3 py-2 shadow-2xl",value:r,onChange:h=>n(h.target.value),minLength:6,autoComplete:"current-password"}),a.jsx("button",{type:"button",className:"px-3 py-2 rounded-2xl shadow-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>i(h=>!h),children:s?"Ocultar":"Mostrar"})]}),a.jsx("div",{className:"text-xs text-gray-600 mb-3",children:"Mnimo 6 caracteres (requisito de Firebase)."}),a.jsx("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded-2xl shadow-2xl hover:bg-blue-700 disabled:opacity-60",disabled:c,children:c?"Entrando...":"Entrar"}),o&&a.jsx("p",{className:`mt-3 text-sm ${o.startsWith("Error")||o.includes("no vlido")?"text-red-600":"text-gray-700"}`,children:o})]})})}function zr({children:t,allowedRoles:e}){const[r,n]=N.useState(!0),[s,i]=N.useState(!1);return N.useEffect(()=>{const o=QL(Ox,async l=>{if(l){const c=kt(Te,"users",l.uid),d=await Ya(c);if(d.exists()){const A=d.data().role;i(e.includes(A))}}n(!1)});return()=>o()},[e]),r?a.jsx("div",{className:"p-4",children:"Cargando..."}):s?t:a.jsx(Ku,{to:"/"})}function nY({role:t}){const e="/admin",r=({isActive:K})=>`block rounded px-3 py-2 text-sm ${K?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"}`,n=bx(),[s,i]=N.useState(!1),[o,l]=N.useState(!1),[c,d]=N.useState(!1),[A,u]=N.useState(!1),[f,h]=N.useState(!1),[m,p]=N.useState(!1),[g,x]=N.useState(!1),[b,w]=N.useState(!1),[k,O]=N.useState(!1),[L,E]=N.useState(!1),[B,S]=N.useState(!1),[U,_]=N.useState(!1),[F,D]=N.useState(!1),[X,ge]=N.useState(!1),[ae,fe]=N.useState(!1),[me,Z]=N.useState(!1),ye=async()=>{await tS(Ox),n("/")},Ie=({open:K,onClick:M,children:re})=>a.jsxs("button",{type:"button",onClick:M,className:"w-full flex items-center justify-between px-3 py-2 text-left text-sm font-semibold rounded hover:bg-gray-100",children:[a.jsx("span",{children:re}),a.jsx("span",{className:"text-xs",children:K?"":""})]}),I=({open:K,onClick:M,title:re})=>a.jsxs("button",{type:"button",onClick:M,className:"ml-2 w-[calc(100%-0.5rem)] flex items-center justify-between px-3 py-2 text-left text-sm rounded hover:bg-gray-100",children:[a.jsx("span",{className:"text-blue-500 font-medium ",children:re}),a.jsx("span",{className:"text-xs",children:K?"":""})]}),j=t==="admin",Q=t==="vendedor_pollo"||t==="vendedor",T=t==="vendedor_ropa",R=t==="vendedor_dulces";return a.jsxs("div",{className:"min-h-screen flex",children:[a.jsxs("aside",{className:`${s?"w-15 bg-gray-50 border-r p-3 transition-all duration-300 flex flex-col items-center":"w-55"} bg-[#f1f3f7] border-r p-3 transition-all duration-300 flex flex-col`,children:[a.jsx("button",{onClick:()=>i(!s),className:"mb-2 p-2 rounded-2xl shadow-2xl bg-gray-300 hover:bg-gray-400","aria-label":s?"Expandir men":"Colapsar men",children:s?a.jsx("span",{title:"Expandir men",children:"Menu "}):a.jsx("span",{title:"Colapsar men",children:"Cerrar "})}),!s&&a.jsxs(a.Fragment,{children:[a.jsxs("nav",{className:"space-y-1",children:[j&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[a.jsx(Ie,{open:o,onClick:()=>l(K=>!K),children:"Pollos Bea"}),o&&a.jsxs("div",{className:"pb-2",children:[a.jsx(I,{open:c,onClick:()=>d(K=>!K),title:"Inventarios"}),c&&a.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[a.jsx(Br,{to:`${e}/batches`,className:r,children:"Inventario Pollo"}),a.jsx(Br,{to:`${e}/paidBatches`,className:r,children:"Inventarios Pagados"})]}),a.jsx(I,{open:A,onClick:()=>u(K=>!K),title:"Finanzas"}),A&&a.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[a.jsx(Br,{to:`${e}/financialDashboard`,className:r,children:"Dashboard"}),a.jsx(Br,{to:`${e}/billing`,className:r,children:"Facturacion"}),a.jsx(Br,{to:`${e}/expenses`,className:r,children:"Gastos"}),a.jsx(Br,{to:`${e}/salesV2`,className:r,children:"Venta"}),a.jsx(Br,{to:`${e}/bills`,className:r,children:"Cierre"}),a.jsx(Br,{to:`${e}/billhistoric`,className:r,children:"Historial de Cierres"})]}),a.jsx(I,{open:f,onClick:()=>h(K=>!K),title:"Productos"}),f&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/products`,className:r,children:"Productos"})})]})]}),a.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[a.jsx(Ie,{open:m,onClick:()=>p(K=>!K),children:"Chiqui Look"}),m&&a.jsxs("div",{className:"pb-2",children:[a.jsx(I,{open:g,onClick:()=>x(K=>!K),title:"Inventario"}),g&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/InventoryClothesBatches`,className:r,children:"Inventario Ropa"})}),a.jsx(I,{open:b,onClick:()=>w(K=>!K),title:"Productos"}),b&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/productsClothes`,className:r,children:"Agregar Productos"})}),a.jsx(I,{open:k,onClick:()=>O(K=>!K),title:"Clientes"}),k&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/CustomersClothes`,className:r,children:"Listado de Clientes"})}),a.jsx(I,{open:L,onClick:()=>E(K=>!K),title:"Finanzas"}),L&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/salesClothes`,className:r,children:"Venta Ropa"})}),L&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/financialDashboardClothes`,className:r,children:"Dashboard Financiero"})}),L&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/TransactionsReportClothes`,className:r,children:"Transacciones"})}),L&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/ExpensesClothes`,className:r,children:"Gastos Ropa"})})]})]}),a.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[a.jsx(Ie,{open:U,onClick:()=>_(K=>!K),children:"CandyShop"}),U&&a.jsxs("div",{className:"pb-2",children:[a.jsx(I,{open:X,onClick:()=>ge(K=>!K),title:"Vendedores"}),X&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/salesCandies`,className:r,children:"Venta"})}),X&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/productsVendorsCandies`,className:r,children:"Sub ordenes"})}),a.jsx(I,{open:F,onClick:()=>D(K=>!K),title:"Inventario"}),F&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/mainordersCandies`,className:r,children:"Ordenes Maestras"})}),F&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/inventoryMainOrderCandies`,className:r,children:"Lista de Ordenes"})}),F&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/inventoryCandies`,className:r,children:"Lista Productos"})}),F&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/productsCandies`,className:r,children:"Productos"})}),a.jsx(I,{open:ae,onClick:()=>fe(K=>!K),title:"Finanzas"}),ae&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/datacenter`,className:r,children:"Data Center"})}),ae&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/transactionCandies`,className:r,children:"Transacciones"})}),ae&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/cierreVentasCandies`,className:r,children:"Cierres"})}),ae&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/reporteCierresCandies`,className:r,children:"Reporte Cierres"})}),ae&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/billingsCandies`,className:r,children:"Facturas"})}),ae&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/consolidatedVendors`,className:r,children:"Consolidado Vendedores"})}),ae&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/dashboardCandies`,className:r,children:"Dashboard"})}),ae&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/customersCandies`,className:r,children:"Clientes"})}),ae&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/vendorsCandies`,className:r,children:"Vendedores"})}),ae&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/expensesCandies`,className:r,children:"Gastos"})})]})]}),a.jsxs("div",{className:"border rounded mb-1 rounded-2xl shadow-2xl bg-white",children:[a.jsx(Ie,{open:me,onClick:()=>Z(K=>!K),children:"Operaciones Otras"}),me&&a.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[a.jsx(Br,{to:`${e}/users`,className:r,children:"Usuarios"}),a.jsx(Br,{to:`${e}/fix`,className:r,children:"Fix de lotes"}),a.jsx(Br,{to:`${e}/transactionclose`,className:r,children:"Liquidaciones"})]})]})]}),Q&&a.jsxs("div",{className:"border rounded",children:[a.jsx(Ie,{open:A,onClick:()=>u(K=>!K),children:"Finanzas (Pollo)"}),A&&a.jsxs("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:[a.jsx(Br,{to:`${e}/salesV2`,className:r,children:"Venta"}),a.jsx(Br,{to:`${e}/bills`,className:r,children:"Cierre"})]})]}),R&&a.jsxs("div",{className:"border rounded",children:[a.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/salesCandies`,className:r,children:"Venta"})}),a.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/transactionCandies`,className:r,children:"Ventas del dia"})}),a.jsx("div",{className:"pb-2 ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/cierreVentasCandies`,className:r,children:"Cierre de Ventas"})}),a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/productsVendorsCandies`,className:r,children:"Pedidos"})}),a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/customersCandies`,className:r,children:"Clientes"})})]}),T&&a.jsxs("div",{className:"border rounded",children:[a.jsx(Ie,{open:m,onClick:()=>p(K=>!K),children:"Operaciones Ropa"}),m&&a.jsxs("div",{className:"pb-2",children:[a.jsx(I,{open:L,onClick:()=>E(K=>!K),title:"Ventas"}),L&&a.jsxs("div",{className:"ml-4 mt-1 space-y-1",children:[a.jsx(Br,{to:`${e}/salesClothes`,className:r,children:"Venta Ropa"}),a.jsx(Br,{to:`${e}/TransactionsReportClothes`,className:r,children:"Transacciones"})]}),a.jsx(I,{open:b,onClick:()=>w(K=>!K),title:"Productos"}),b&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/productsClothes`,className:r,children:"Agregar Productos"})}),a.jsx(I,{open:k,onClick:()=>O(K=>!K),title:"Clientes"}),k&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:a.jsx(Br,{to:`${e}/CustomersClothes`,className:r,children:"Listado de Clientes"})})]})]})]}),a.jsx("button",{onClick:ye,className:"mt-4 bg-red-500 text-white px-3 py-2 rounded-2xl shadow-2xl hover:bg-red-600",children:"Cerrar sesin"})]})]}),a.jsx("main",{className:"flex-1 p-6",children:a.jsx(YD,{})})]})}function nN(...t){return t.filter(Boolean).join(" ")}function sY({role:t}){const e=bx(),r="/admin",n=t==="admin",s=t==="vendedor_pollo",i=t==="vendedor_dulces",[o,l]=N.useState(()=>s?"POLLO":i?"DULCES":"POLLO"),c=N.useMemo(()=>n?o==="POLLO"?[{key:"dash",label:"Dashboard",to:`${r}/financialDashboard`},{key:"inv",label:"Inventario",to:`${r}/batches`},{key:"invPag",label:"Factura",to:`${r}/paidBatches`},{key:"gastos",label:"Gastos",to:`${r}/expenses`}]:[{key:"dc",label:"Data",to:`${r}/datacenter`},{key:"maes",label:"Inventario",to:`${r}/mainordersCandies`},{key:"ord",label:"Rutas",to:`${r}/productsVendorsCandies`},{key:"cli",label:"Cuentas",to:`${r}/customersCandies`},{key:"trx",label:"Ventas",to:`${r}/transactionCandies`},{key:"cier",label:"Cierres",to:`${r}/cierreVentasCandies`}]:s?[{key:"venta",label:"Venta",to:`${r}/salesV2`},{key:"inv",label:"Inventario",to:`${r}/batches`},{key:"cierre",label:"Cierre",to:`${r}/bills`}]:i?[{key:"venta",label:"Vender",to:`${r}/salesCandies`},{key:"ped",label:"Inventario",to:`${r}/productsVendorsCandies`},{key:"cli",label:"Cuentas",to:`${r}/customersCandies`},{key:"trx",label:"Ventas",to:`${r}/transactionCandies`},{key:"cier",label:"Cierre",to:`${r}/cierreVentasCandies`}]:[{key:"home",label:"Inicio",to:`${r}`}],[n,s,i,o]);N.useEffect(()=>{n&&c.length&&e(c[0].to,{replace:!0})},[o]);const d=async()=>{await tS(Ox),e("/")},A=({isActive:u})=>nN("flex-1 text-center text-[11px] py-1.5 rounded-lg","leading-none select-none",u?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100");return a.jsxs("div",{className:"min-h-screen bg-[#f1f3f7] flex flex-col",children:[a.jsx("header",{className:"sticky top-0 z-50 bg-white border-b shadow-sm",children:a.jsxs("div",{className:"px-3 py-3 flex items-center gap-2",children:[n?a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:()=>l("POLLO"),className:nN("px-3 py-2 rounded-2xl text-sm font-semibold",o==="POLLO"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Pollos Bea"}),a.jsx("button",{type:"button",onClick:()=>l("DULCES"),className:nN("px-3 py-2 rounded-2xl text-sm font-semibold",o==="DULCES"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"CandyShop"})]}):a.jsx("div",{className:"text-sm font-semibold text-gray-800",children:s?"Pollos Bea":i?"CandyShop":"Posys"}),a.jsx("div",{className:"ml-auto flex items-center gap-2",children:a.jsx("button",{onClick:d,className:"px-3 py-2 rounded-2xl bg-red-500 text-white text-sm font-semibold shadow hover:bg-red-600",children:"Cerrar"})})]})}),a.jsx("main",{className:"flex-1 overflow-y-auto px-3 pt-3 pb-[calc(92px+env(safe-area-inset-bottom))]",children:a.jsx(YD,{})}),a.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white border-t shadow-md pb-[env(safe-area-inset-bottom)]",children:a.jsx("div",{className:"max-w-3xl mx-auto px-2 py-1.5 flex gap-1.5",children:c.map(u=>a.jsx(Br,{to:u.to,className:A,children:u.label},u.key))})})]})}const tO=6048e5,aY=864e5,Ik=Symbol.for("constructDateFrom");function Gl(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&Ik in t?t[Ik](e):t instanceof Date?new t.constructor(e):new Date(e)}function Mi(t,e){return Gl(e||t,t)}function iY(t,e,r){const n=Mi(t,r==null?void 0:r.in);return isNaN(e)?Gl(t,NaN):(n.setDate(n.getDate()+e),n)}function oY(t,e,r){const n=Mi(t,r==null?void 0:r.in);if(isNaN(e))return Gl(t,NaN);const s=n.getDate(),i=Gl(t,n.getTime());i.setMonth(n.getMonth()+e+1,0);const o=i.getDate();return s>=o?i:(n.setFullYear(i.getFullYear(),i.getMonth(),s),n)}let lY={};function P2(){return lY}function $g(t,e){var l,c,d,A;const r=P2(),n=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((A=(d=r.locale)==null?void 0:d.options)==null?void 0:A.weekStartsOn)??0,s=Mi(t,e==null?void 0:e.in),i=s.getDay(),o=(i<n?7:0)+i-n;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function db(t,e){return $g(t,{...e,weekStartsOn:1})}function rO(t,e){const r=Mi(t,e==null?void 0:e.in),n=r.getFullYear(),s=Gl(r,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const i=db(s),o=Gl(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=db(o);return r.getTime()>=i.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function jk(t){const e=Mi(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function cY(t,...e){const r=Gl.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function kk(t,e){const r=Mi(t,e==null?void 0:e.in);return r.setHours(0,0,0,0),r}function dY(t,e,r){const[n,s]=cY(r==null?void 0:r.in,t,e),i=kk(n),o=kk(s),l=+i-jk(i),c=+o-jk(o);return Math.round((l-c)/aY)}function AY(t,e){const r=rO(t,e),n=Gl(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),db(n)}function uY(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function hY(t){return!(!uY(t)&&typeof t!="number"||isNaN(+Mi(t)))}function Ic(t,e){const r=Mi(t,e==null?void 0:e.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function jc(t,e){const r=Mi(t,e==null?void 0:e.in);return r.setDate(1),r.setHours(0,0,0,0),r}function fY(t,e){const r=Mi(t,e==null?void 0:e.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const mY={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},pY=(t,e,r)=>{let n;const s=mY[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function sN(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const gY={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},xY={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},vY={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},yY={date:sN({formats:gY,defaultWidth:"full"}),time:sN({formats:xY,defaultWidth:"full"}),dateTime:sN({formats:vY,defaultWidth:"full"})},bY={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},wY=(t,e,r,n)=>bY[t];function Wm(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;s=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;s=t.values[l]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return s[i]}}const NY={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},CY={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},_Y={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},EY={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},BY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},SY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},IY=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},jY={ordinalNumber:IY,era:Wm({values:NY,defaultWidth:"wide"}),quarter:Wm({values:CY,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Wm({values:_Y,defaultWidth:"wide"}),day:Wm({values:EY,defaultWidth:"wide"}),dayPeriod:Wm({values:BY,defaultWidth:"wide",formattingValues:SY,defaultFormattingWidth:"wide"})};function Jm(t){return(e,r={})=>{const n=r.width,s=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],i=e.match(s);if(!i)return null;const o=i[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?FY(l,u=>u.test(o)):kY(l,u=>u.test(o));let d;d=t.valueCallback?t.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const A=e.slice(o.length);return{value:d,rest:A}}}function kY(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function FY(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function TY(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const s=n[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(s.length);return{value:o,rest:l}}}const PY=/^(\d+)(th|st|nd|rd)?/i,RY=/\d+/i,DY={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},LY={any:[/^b/i,/^(a|c)/i]},UY={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},OY={any:[/1/i,/2/i,/3/i,/4/i]},MY={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},QY={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},VY={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},HY={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},KY={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},qY={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},GY={ordinalNumber:TY({matchPattern:PY,parsePattern:RY,valueCallback:t=>parseInt(t,10)}),era:Jm({matchPatterns:DY,defaultMatchWidth:"wide",parsePatterns:LY,defaultParseWidth:"any"}),quarter:Jm({matchPatterns:UY,defaultMatchWidth:"wide",parsePatterns:OY,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Jm({matchPatterns:MY,defaultMatchWidth:"wide",parsePatterns:QY,defaultParseWidth:"any"}),day:Jm({matchPatterns:VY,defaultMatchWidth:"wide",parsePatterns:HY,defaultParseWidth:"any"}),dayPeriod:Jm({matchPatterns:KY,defaultMatchWidth:"any",parsePatterns:qY,defaultParseWidth:"any"})},$Y={code:"en-US",formatDistance:pY,formatLong:yY,formatRelative:wY,localize:jY,match:GY,options:{weekStartsOn:0,firstWeekContainsDate:1}};function zY(t,e){const r=Mi(t,e==null?void 0:e.in);return dY(r,fY(r))+1}function WY(t,e){const r=Mi(t,e==null?void 0:e.in),n=+db(r)-+AY(r);return Math.round(n/tO)+1}function nO(t,e){var A,u,f,h;const r=Mi(t,e==null?void 0:e.in),n=r.getFullYear(),s=P2(),i=(e==null?void 0:e.firstWeekContainsDate)??((u=(A=e==null?void 0:e.locale)==null?void 0:A.options)==null?void 0:u.firstWeekContainsDate)??s.firstWeekContainsDate??((h=(f=s.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,o=Gl((e==null?void 0:e.in)||t,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const l=$g(o,e),c=Gl((e==null?void 0:e.in)||t,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const d=$g(c,e);return+r>=+l?n+1:+r>=+d?n:n-1}function JY(t,e){var l,c,d,A;const r=P2(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((A=(d=r.locale)==null?void 0:d.options)==null?void 0:A.firstWeekContainsDate)??1,s=nO(t,e),i=Gl((e==null?void 0:e.in)||t,0);return i.setFullYear(s,0,n),i.setHours(0,0,0,0),$g(i,e)}function XY(t,e){const r=Mi(t,e==null?void 0:e.in),n=+$g(r,e)-+JY(r,e);return Math.round(n/tO)+1}function En(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const lA={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return En(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):En(r+1,2)},d(t,e){return En(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return En(t.getHours()%12||12,e.length)},H(t,e){return En(t.getHours(),e.length)},m(t,e){return En(t.getMinutes(),e.length)},s(t,e){return En(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return En(s,e.length)}},wf={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Fk={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return lA.y(t,e)},Y:function(t,e,r,n){const s=nO(t,n),i=s>0?s:1-s;if(e==="YY"){const o=i%100;return En(o,2)}return e==="Yo"?r.ordinalNumber(i,{unit:"year"}):En(i,e.length)},R:function(t,e){const r=rO(t);return En(r,e.length)},u:function(t,e){const r=t.getFullYear();return En(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return En(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return En(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return lA.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return En(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const s=XY(t,n);return e==="wo"?r.ordinalNumber(s,{unit:"week"}):En(s,e.length)},I:function(t,e,r){const n=WY(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):En(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):lA.d(t,e)},D:function(t,e,r){const n=zY(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):En(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const s=t.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return En(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const s=t.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return En(i,e.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return En(s,e.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let s;switch(n===12?s=wf.noon:n===0?s=wf.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let s;switch(n>=17?s=wf.evening:n>=12?s=wf.afternoon:n>=4?s=wf.morning:s=wf.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return lA.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):lA.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):En(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):En(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):lA.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):lA.s(t,e)},S:function(t,e){return lA.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return Pk(n);case"XXXX":case"XX":return $u(n);case"XXXXX":case"XXX":default:return $u(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return Pk(n);case"xxxx":case"xx":return $u(n);case"xxxxx":case"xxx":default:return $u(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Tk(n,":");case"OOOO":default:return"GMT"+$u(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Tk(n,":");case"zzzz":default:return"GMT"+$u(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return En(n,e.length)},T:function(t,e,r){return En(+t,e.length)}};function Tk(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=Math.trunc(n/60),i=n%60;return i===0?r+String(s):r+String(s)+e+En(i,2)}function Pk(t,e){return t%60===0?(t>0?"-":"+")+En(Math.abs(t)/60,2):$u(t,e)}function $u(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=En(Math.trunc(n/60),2),i=En(n%60,2);return r+s+e+i}const Rk=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},sO=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},YY=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return Rk(t,e);let i;switch(n){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",Rk(n,e)).replace("{{time}}",sO(s,e))},ZY={p:sO,P:YY},eZ=/^D+$/,tZ=/^Y+$/,rZ=["D","DD","YY","YYYY"];function nZ(t){return eZ.test(t)}function sZ(t){return tZ.test(t)}function aZ(t,e,r){const n=iZ(t,e,r);if(console.warn(n),rZ.includes(t))throw new RangeError(n)}function iZ(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const oZ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,lZ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,cZ=/^'([^]*?)'?$/,dZ=/''/g,AZ=/[a-zA-Z]/;function or(t,e,r){var A,u,f,h;const n=P2(),s=n.locale??$Y,i=n.firstWeekContainsDate??((u=(A=n.locale)==null?void 0:A.options)==null?void 0:u.firstWeekContainsDate)??1,o=n.weekStartsOn??((h=(f=n.locale)==null?void 0:f.options)==null?void 0:h.weekStartsOn)??0,l=Mi(t,r==null?void 0:r.in);if(!hY(l))throw new RangeError("Invalid time value");let c=e.match(lZ).map(m=>{const p=m[0];if(p==="p"||p==="P"){const g=ZY[p];return g(m,s.formatLong)}return m}).join("").match(oZ).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const p=m[0];if(p==="'")return{isToken:!1,value:uZ(m)};if(Fk[p])return{isToken:!0,value:m};if(p.match(AZ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:m}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return c.map(m=>{if(!m.isToken)return m.value;const p=m.value;(sZ(p)||nZ(p))&&aZ(p,e,String(t));const g=Fk[p[0]];return g(l,p,s.localize,d)}).join("")}function uZ(t){const e=t.match(cZ);return e?e[1].replace(dZ,"'"):t}function aO(t,e,r){return iY(t,-14,r)}function hZ(t,e,r){return oY(t,-1,r)}/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var z_=function(t,e){return z_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},z_(t,e)};function Jl(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");z_(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var W_=function(){return W_=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},W_.apply(this,arguments)};function ji(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(A){try{d(n.next(A))}catch(u){o(u)}}function c(A){try{d(n.throw(A))}catch(u){o(u)}}function d(A){A.done?i(A.value):s(A.value).then(l,c)}d((n=n.apply(t,[])).next())})}function di(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(A){return c([d,A])}}function c(d){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=d[0]&2?s.return:d[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,d[1])).done)return i;switch(s=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,s=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){r.label=d[1];break}if(d[0]===6&&r.label<i[1]){r.label=i[1],i=d;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(d);break}i[2]&&r.ops.pop(),r.trys.pop();continue}d=e.call(t,r)}catch(A){d=[6,A],s=0}finally{n=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function Mv(t,e,r){if(arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||e)}var jd=function(){function t(e,r,n,s){this.left=e,this.top=r,this.width=n,this.height=s}return t.prototype.add=function(e,r,n,s){return new t(this.left+e,this.top+r,this.width+n,this.height+s)},t.fromClientRect=function(e,r){return new t(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height)},t.fromDOMRectList=function(e,r){var n=Array.from(r).find(function(s){return s.width!==0});return n?new t(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),R2=function(t,e){return jd.fromClientRect(t,e.getBoundingClientRect())},fZ=function(t){var e=t.body,r=t.documentElement;if(!e||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(e.scrollWidth,r.scrollWidth),Math.max(e.offsetWidth,r.offsetWidth),Math.max(e.clientWidth,r.clientWidth)),s=Math.max(Math.max(e.scrollHeight,r.scrollHeight),Math.max(e.offsetHeight,r.offsetHeight),Math.max(e.clientHeight,r.clientHeight));return new jd(0,0,n,s)},D2=function(t){for(var e=[],r=0,n=t.length;r<n;){var s=t.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var i=t.charCodeAt(r++);(i&64512)===56320?e.push(((s&1023)<<10)+(i&1023)+65536):(e.push(s),r--)}else e.push(s)}return e},Hs=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],s=-1,i="";++s<r;){var o=t[s];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(s+1===r||n.length>16384)&&(i+=String.fromCharCode.apply(String,n),n.length=0)}return i},Dk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mZ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Qv=0;Qv<Dk.length;Qv++)mZ[Dk.charCodeAt(Qv)]=Qv;var Lk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yp=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Vv=0;Vv<Lk.length;Vv++)yp[Lk.charCodeAt(Vv)]=Vv;var pZ=function(t){var e=t.length*.75,r=t.length,n,s=0,i,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),A=Array.isArray(d)?d:new Uint8Array(d);for(n=0;n<r;n+=4)i=yp[t.charCodeAt(n)],o=yp[t.charCodeAt(n+1)],l=yp[t.charCodeAt(n+2)],c=yp[t.charCodeAt(n+3)],A[s++]=i<<2|o>>4,A[s++]=(o&15)<<4|l>>2,A[s++]=(l&3)<<6|c&63;return d},gZ=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},xZ=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},Ah=5,GS=11,aN=2,vZ=GS-Ah,iO=65536>>Ah,yZ=1<<Ah,iN=yZ-1,bZ=1024>>Ah,wZ=iO+bZ,NZ=wZ,CZ=32,_Z=NZ+CZ,EZ=65536>>GS,BZ=1<<vZ,SZ=BZ-1,Uk=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},IZ=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},jZ=function(t,e){var r=pZ(t),n=Array.isArray(r)?xZ(r):new Uint32Array(r),s=Array.isArray(r)?gZ(r):new Uint16Array(r),i=24,o=Uk(s,i/2,n[4]/2),l=n[5]===2?Uk(s,(i+n[4])/2):IZ(n,Math.ceil((i+n[4])/4));return new kZ(n[0],n[1],n[2],n[3],o,l)},kZ=function(){function t(e,r,n,s,i,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=s,this.index=i,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>Ah],r=(r<<aN)+(e&iN),this.data[r];if(e<=65535)return r=this.index[iO+(e-55296>>Ah)],r=(r<<aN)+(e&iN),this.data[r];if(e<this.highStart)return r=_Z-EZ+(e>>GS),r=this.index[r],r+=e>>Ah&SZ,r=this.index[r],r=(r<<aN)+(e&iN),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),Ok="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",FZ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Hv=0;Hv<Ok.length;Hv++)FZ[Ok.charCodeAt(Hv)]=Hv;var TZ="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",Mk=50,PZ=1,oO=2,lO=3,RZ=4,DZ=5,Qk=7,cO=8,Vk=9,TA=10,J_=11,Hk=12,X_=13,LZ=14,bp=15,Y_=16,Kv=17,Xm=18,UZ=19,Kk=20,Z_=21,Ym=22,oN=23,Nf=24,bo=25,wp=26,Np=27,Cf=28,OZ=29,Zu=30,MZ=31,qv=32,Gv=33,eE=34,tE=35,rE=36,zg=37,nE=38,hy=39,fy=40,lN=41,dO=42,QZ=43,VZ=[9001,65288],AO="!",tn="",$v="",sE=jZ(TZ),$c=[Zu,rE],aE=[PZ,oO,lO,DZ],uO=[TA,cO],qk=[Np,wp],HZ=aE.concat(uO),Gk=[nE,hy,fy,eE,tE],KZ=[bp,X_],qZ=function(t,e){e===void 0&&(e="strict");var r=[],n=[],s=[];return t.forEach(function(i,o){var l=sE.get(i);if(l>Mk?(s.push(!0),l-=Mk):s.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(i)!==-1)return n.push(o),r.push(Y_);if(l===RZ||l===J_){if(o===0)return n.push(o),r.push(Zu);var c=r[o-1];return HZ.indexOf(c)===-1?(n.push(n[o-1]),r.push(c)):(n.push(o),r.push(Zu))}if(n.push(o),l===MZ)return r.push(e==="strict"?Z_:zg);if(l===dO||l===OZ)return r.push(Zu);if(l===QZ)return i>=131072&&i<=196605||i>=196608&&i<=262141?r.push(zg):r.push(Zu);r.push(l)}),[n,r,s]},cN=function(t,e,r,n){var s=n[r];if(Array.isArray(t)?t.indexOf(s)!==-1:t===s)for(var i=r;i<=n.length;){i++;var o=n[i];if(o===e)return!0;if(o!==TA)break}if(s===TA)for(var i=r;i>0;){i--;var l=n[i];if(Array.isArray(t)?t.indexOf(l)!==-1:t===l)for(var c=r;c<=n.length;){c++;var o=n[c];if(o===e)return!0;if(o!==TA)break}if(l!==TA)break}return!1},$k=function(t,e){for(var r=t;r>=0;){var n=e[r];if(n===TA)r--;else return n}return 0},GZ=function(t,e,r,n,s){if(r[n]===0)return tn;var i=n-1;if(Array.isArray(s)&&s[i]===!0)return tn;var o=i-1,l=i+1,c=e[i],d=o>=0?e[o]:0,A=e[l];if(c===oO&&A===lO)return tn;if(aE.indexOf(c)!==-1)return AO;if(aE.indexOf(A)!==-1||uO.indexOf(A)!==-1)return tn;if($k(i,e)===cO)return $v;if(sE.get(t[i])===J_||(c===qv||c===Gv)&&sE.get(t[l])===J_||c===Qk||A===Qk||c===Vk||[TA,X_,bp].indexOf(c)===-1&&A===Vk||[Kv,Xm,UZ,Nf,Cf].indexOf(A)!==-1||$k(i,e)===Ym||cN(oN,Ym,i,e)||cN([Kv,Xm],Z_,i,e)||cN(Hk,Hk,i,e))return tn;if(c===TA)return $v;if(c===oN||A===oN)return tn;if(A===Y_||c===Y_)return $v;if([X_,bp,Z_].indexOf(A)!==-1||c===LZ||d===rE&&KZ.indexOf(c)!==-1||c===Cf&&A===rE||A===Kk||$c.indexOf(A)!==-1&&c===bo||$c.indexOf(c)!==-1&&A===bo||c===Np&&[zg,qv,Gv].indexOf(A)!==-1||[zg,qv,Gv].indexOf(c)!==-1&&A===wp||$c.indexOf(c)!==-1&&qk.indexOf(A)!==-1||qk.indexOf(c)!==-1&&$c.indexOf(A)!==-1||[Np,wp].indexOf(c)!==-1&&(A===bo||[Ym,bp].indexOf(A)!==-1&&e[l+1]===bo)||[Ym,bp].indexOf(c)!==-1&&A===bo||c===bo&&[bo,Cf,Nf].indexOf(A)!==-1)return tn;if([bo,Cf,Nf,Kv,Xm].indexOf(A)!==-1)for(var u=i;u>=0;){var f=e[u];if(f===bo)return tn;if([Cf,Nf].indexOf(f)!==-1)u--;else break}if([Np,wp].indexOf(A)!==-1)for(var u=[Kv,Xm].indexOf(c)!==-1?o:i;u>=0;){var f=e[u];if(f===bo)return tn;if([Cf,Nf].indexOf(f)!==-1)u--;else break}if(nE===c&&[nE,hy,eE,tE].indexOf(A)!==-1||[hy,eE].indexOf(c)!==-1&&[hy,fy].indexOf(A)!==-1||[fy,tE].indexOf(c)!==-1&&A===fy||Gk.indexOf(c)!==-1&&[Kk,wp].indexOf(A)!==-1||Gk.indexOf(A)!==-1&&c===Np||$c.indexOf(c)!==-1&&$c.indexOf(A)!==-1||c===Nf&&$c.indexOf(A)!==-1||$c.concat(bo).indexOf(c)!==-1&&A===Ym&&VZ.indexOf(t[l])===-1||$c.concat(bo).indexOf(A)!==-1&&c===Xm)return tn;if(c===lN&&A===lN){for(var h=r[i],m=1;h>0&&(h--,e[h]===lN);)m++;if(m%2!==0)return tn}return c===qv&&A===Gv?tn:$v},$Z=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var r=qZ(t,e.lineBreak),n=r[0],s=r[1],i=r[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(s=s.map(function(l){return[bo,Zu,dO].indexOf(l)!==-1?zg:l}));var o=e.wordBreak==="keep-all"?i.map(function(l,c){return l&&t[c]>=19968&&t[c]<=40959}):void 0;return[n,s,o]},zZ=function(){function t(e,r,n,s){this.codePoints=e,this.required=r===AO,this.start=n,this.end=s}return t.prototype.slice=function(){return Hs.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),WZ=function(t,e){var r=D2(t),n=$Z(r,e),s=n[0],i=n[1],o=n[2],l=r.length,c=0,d=0;return{next:function(){if(d>=l)return{done:!0,value:null};for(var A=tn;d<l&&(A=GZ(r,i,s,++d,o))===tn;);if(A!==tn||d===l){var u=new zZ(r,A,c,d);return c=d,{value:u,done:!1}}return{done:!0,value:null}}}},JZ=1,XZ=2,Mx=4,zk=8,Ab=10,Wk=47,$p=92,YZ=9,ZZ=32,zv=34,Zm=61,eee=35,tee=36,ree=37,Wv=39,Jv=40,ep=41,nee=95,Wi=45,see=33,aee=60,iee=62,oee=64,lee=91,cee=93,dee=61,Aee=123,Xv=63,uee=125,Jk=124,hee=126,fee=128,Xk=65533,dN=42,ah=43,mee=44,pee=58,gee=59,Wg=46,xee=0,vee=8,yee=11,bee=14,wee=31,Nee=127,cc=-1,hO=48,fO=97,mO=101,Cee=102,_ee=117,Eee=122,pO=65,gO=69,xO=70,Bee=85,See=90,hi=function(t){return t>=hO&&t<=57},Iee=function(t){return t>=55296&&t<=57343},_f=function(t){return hi(t)||t>=pO&&t<=xO||t>=fO&&t<=Cee},jee=function(t){return t>=fO&&t<=Eee},kee=function(t){return t>=pO&&t<=See},Fee=function(t){return jee(t)||kee(t)},Tee=function(t){return t>=fee},Yv=function(t){return t===Ab||t===YZ||t===ZZ},ub=function(t){return Fee(t)||Tee(t)||t===nee},Yk=function(t){return ub(t)||hi(t)||t===Wi},Pee=function(t){return t>=xee&&t<=vee||t===yee||t>=bee&&t<=wee||t===Nee},yA=function(t,e){return t!==$p?!1:e!==Ab},Zv=function(t,e,r){return t===Wi?ub(e)||yA(e,r):ub(t)?!0:!!(t===$p&&yA(t,e))},AN=function(t,e,r){return t===ah||t===Wi?hi(e)?!0:e===Wg&&hi(r):hi(t===Wg?e:t)},Ree=function(t){var e=0,r=1;(t[e]===ah||t[e]===Wi)&&(t[e]===Wi&&(r=-1),e++);for(var n=[];hi(t[e]);)n.push(t[e++]);var s=n.length?parseInt(Hs.apply(void 0,n),10):0;t[e]===Wg&&e++;for(var i=[];hi(t[e]);)i.push(t[e++]);var o=i.length,l=o?parseInt(Hs.apply(void 0,i),10):0;(t[e]===gO||t[e]===mO)&&e++;var c=1;(t[e]===ah||t[e]===Wi)&&(t[e]===Wi&&(c=-1),e++);for(var d=[];hi(t[e]);)d.push(t[e++]);var A=d.length?parseInt(Hs.apply(void 0,d),10):0;return r*(s+l*Math.pow(10,-o))*Math.pow(10,c*A)},Dee={type:2},Lee={type:3},Uee={type:4},Oee={type:13},Mee={type:8},Qee={type:21},Vee={type:9},Hee={type:10},Kee={type:11},qee={type:12},Gee={type:14},e1={type:23},$ee={type:1},zee={type:25},Wee={type:24},Jee={type:26},Xee={type:27},Yee={type:28},Zee={type:29},ete={type:31},iE={type:32},vO=function(){function t(){this._value=[]}return t.prototype.write=function(e){this._value=this._value.concat(D2(e))},t.prototype.read=function(){for(var e=[],r=this.consumeToken();r!==iE;)e.push(r),r=this.consumeToken();return e},t.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case zv:return this.consumeStringToken(zv);case eee:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),s=this.peekCodePoint(2);if(Yk(r)||yA(n,s)){var i=Zv(r,n,s)?XZ:JZ,o=this.consumeName();return{type:5,value:o,flags:i}}break;case tee:if(this.peekCodePoint(0)===Zm)return this.consumeCodePoint(),Oee;break;case Wv:return this.consumeStringToken(Wv);case Jv:return Dee;case ep:return Lee;case dN:if(this.peekCodePoint(0)===Zm)return this.consumeCodePoint(),Gee;break;case ah:if(AN(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case mee:return Uee;case Wi:var l=e,c=this.peekCodePoint(0),d=this.peekCodePoint(1);if(AN(l,c,d))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(Zv(l,c,d))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(c===Wi&&d===iee)return this.consumeCodePoint(),this.consumeCodePoint(),Wee;break;case Wg:if(AN(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case Wk:if(this.peekCodePoint(0)===dN)for(this.consumeCodePoint();;){var A=this.consumeCodePoint();if(A===dN&&(A=this.consumeCodePoint(),A===Wk))return this.consumeToken();if(A===cc)return this.consumeToken()}break;case pee:return Jee;case gee:return Xee;case aee:if(this.peekCodePoint(0)===see&&this.peekCodePoint(1)===Wi&&this.peekCodePoint(2)===Wi)return this.consumeCodePoint(),this.consumeCodePoint(),zee;break;case oee:var u=this.peekCodePoint(0),f=this.peekCodePoint(1),h=this.peekCodePoint(2);if(Zv(u,f,h)){var o=this.consumeName();return{type:7,value:o}}break;case lee:return Yee;case $p:if(yA(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case cee:return Zee;case dee:if(this.peekCodePoint(0)===Zm)return this.consumeCodePoint(),Mee;break;case Aee:return Kee;case uee:return qee;case _ee:case Bee:var m=this.peekCodePoint(0),p=this.peekCodePoint(1);return m===ah&&(_f(p)||p===Xv)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case Jk:if(this.peekCodePoint(0)===Zm)return this.consumeCodePoint(),Vee;if(this.peekCodePoint(0)===Jk)return this.consumeCodePoint(),Qee;break;case hee:if(this.peekCodePoint(0)===Zm)return this.consumeCodePoint(),Hee;break;case cc:return iE}return Yv(e)?(this.consumeWhiteSpace(),ete):hi(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):ub(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:Hs(e)}},t.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},t.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},t.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},t.prototype.consumeUnicodeRangeToken=function(){for(var e=[],r=this.consumeCodePoint();_f(r)&&e.length<6;)e.push(r),r=this.consumeCodePoint();for(var n=!1;r===Xv&&e.length<6;)e.push(r),r=this.consumeCodePoint(),n=!0;if(n){var s=parseInt(Hs.apply(void 0,e.map(function(c){return c===Xv?hO:c})),16),i=parseInt(Hs.apply(void 0,e.map(function(c){return c===Xv?xO:c})),16);return{type:30,start:s,end:i}}var o=parseInt(Hs.apply(void 0,e),16);if(this.peekCodePoint(0)===Wi&&_f(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];_f(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var i=parseInt(Hs.apply(void 0,l),16);return{type:30,start:o,end:i}}else return{type:30,start:o,end:o}},t.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===Jv?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Jv?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},t.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===cc)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===Wv||r===zv){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===cc||this.peekCodePoint(0)===ep)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),e1)}for(;;){var s=this.consumeCodePoint();if(s===cc||s===ep)return{type:22,value:Hs.apply(void 0,e)};if(Yv(s))return this.consumeWhiteSpace(),this.peekCodePoint(0)===cc||this.peekCodePoint(0)===ep?(this.consumeCodePoint(),{type:22,value:Hs.apply(void 0,e)}):(this.consumeBadUrlRemnants(),e1);if(s===zv||s===Wv||s===Jv||Pee(s))return this.consumeBadUrlRemnants(),e1;if(s===$p)if(yA(s,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),e1;else e.push(s)}},t.prototype.consumeWhiteSpace=function(){for(;Yv(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===ep||e===cc)return;yA(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(e){for(var r=5e4,n="";e>0;){var s=Math.min(r,e);n+=Hs.apply(void 0,this._value.splice(0,s)),e-=s}return this._value.shift(),n},t.prototype.consumeStringToken=function(e){var r="",n=0;do{var s=this._value[n];if(s===cc||s===void 0||s===e)return r+=this.consumeStringSlice(n),{type:0,value:r};if(s===Ab)return this._value.splice(0,n),$ee;if(s===$p){var i=this._value[n+1];i!==cc&&i!==void 0&&(i===Ab?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):yA(s,i)&&(r+=this.consumeStringSlice(n),r+=Hs(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},t.prototype.consumeNumber=function(){var e=[],r=Mx,n=this.peekCodePoint(0);for((n===ah||n===Wi)&&e.push(this.consumeCodePoint());hi(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var s=this.peekCodePoint(1);if(n===Wg&&hi(s))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=zk;hi(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),s=this.peekCodePoint(1);var i=this.peekCodePoint(2);if((n===gO||n===mO)&&((s===ah||s===Wi)&&hi(i)||hi(s)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),r=zk;hi(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[Ree(e),r]},t.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),r=e[0],n=e[1],s=this.peekCodePoint(0),i=this.peekCodePoint(1),o=this.peekCodePoint(2);if(Zv(s,i,o)){var l=this.consumeName();return{type:15,number:r,flags:n,unit:l}}return s===ree?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},t.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(_f(e)){for(var r=Hs(e);_f(this.peekCodePoint(0))&&r.length<6;)r+=Hs(this.consumeCodePoint());Yv(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||Iee(n)||n>1114111?Xk:n}return e===cc?Xk:e},t.prototype.consumeName=function(){for(var e="";;){var r=this.consumeCodePoint();if(Yk(r))e+=Hs(r);else if(yA(r,this.peekCodePoint(0)))e+=Hs(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),e}},t}(),yO=function(){function t(e){this._tokens=e}return t.create=function(e){var r=new vO;return r.write(e),new t(r.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var r=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var e=[];;){var r=this.consumeComponentValue();if(r.type===32)return e;e.push(r),e.push()}},t.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},t.prototype.consumeSimpleBlock=function(e){for(var r={type:e,values:[]},n=this.consumeToken();;){if(n.type===32||rte(n,e))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},t.prototype.consumeFunction=function(e){for(var r={name:e.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?iE:e},t.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},t}(),Qx=function(t){return t.type===15},cm=function(t){return t.type===17},Pn=function(t){return t.type===20},tte=function(t){return t.type===0},oE=function(t,e){return Pn(t)&&t.value===e},bO=function(t){return t.type!==31},K0=function(t){return t.type!==31&&t.type!==4},kc=function(t){var e=[],r=[];return t.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&e.push(r),e},rte=function(t,e){return e===11&&t.type===12||e===28&&t.type===29?!0:e===2&&t.type===3},cu=function(t){return t.type===17||t.type===15},ta=function(t){return t.type===16||cu(t)},wO=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},Wa={type:17,number:0,flags:Mx},$S={type:16,number:50,flags:Mx},PA={type:16,number:100,flags:Mx},Cp=function(t,e,r){var n=t[0],s=t[1];return[zn(n,e),zn(typeof s<"u"?s:n,r)]},zn=function(t,e){if(t.type===16)return t.number/100*e;if(Qx(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},NO="deg",CO="grad",_O="rad",EO="turn",L2={name:"angle",parse:function(t,e){if(e.type===15)switch(e.unit){case NO:return Math.PI*e.number/180;case CO:return Math.PI/200*e.number;case _O:return e.number;case EO:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},BO=function(t){return t.type===15&&(t.unit===NO||t.unit===CO||t.unit===_O||t.unit===EO)},SO=function(t){var e=t.filter(Pn).map(function(r){return r.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Wa,Wa];case"to top":case"bottom":return dl(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Wa,PA];case"to right":case"left":return dl(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[PA,PA];case"to bottom":case"top":return dl(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[PA,Wa];case"to left":case"right":return dl(270)}return 0},dl=function(t){return Math.PI*t/180},YA={name:"color",parse:function(t,e){if(e.type===18){var r=nte[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return r(t,e.values)}if(e.type===5){if(e.value.length===3){var n=e.value.substring(0,1),s=e.value.substring(1,2),i=e.value.substring(2,3);return RA(parseInt(n+n,16),parseInt(s+s,16),parseInt(i+i,16),1)}if(e.value.length===4){var n=e.value.substring(0,1),s=e.value.substring(1,2),i=e.value.substring(2,3),o=e.value.substring(3,4);return RA(parseInt(n+n,16),parseInt(s+s,16),parseInt(i+i,16),parseInt(o+o,16)/255)}if(e.value.length===6){var n=e.value.substring(0,2),s=e.value.substring(2,4),i=e.value.substring(4,6);return RA(parseInt(n,16),parseInt(s,16),parseInt(i,16),1)}if(e.value.length===8){var n=e.value.substring(0,2),s=e.value.substring(2,4),i=e.value.substring(4,6),o=e.value.substring(6,8);return RA(parseInt(n,16),parseInt(s,16),parseInt(i,16),parseInt(o,16)/255)}}if(e.type===20){var l=gd[e.value.toUpperCase()];if(typeof l<"u")return l}return gd.TRANSPARENT}},ZA=function(t){return(255&t)===0},Na=function(t){var e=255&t,r=255&t>>8,n=255&t>>16,s=255&t>>24;return e<255?"rgba("+s+","+n+","+r+","+e/255+")":"rgb("+s+","+n+","+r+")"},RA=function(t,e,r,n){return(t<<24|e<<16|r<<8|Math.round(n*255)<<0)>>>0},Zk=function(t,e){if(t.type===17)return t.number;if(t.type===16){var r=e===3?1:255;return e===3?t.number/100*r:Math.round(t.number/100*r)}return 0},eF=function(t,e){var r=e.filter(K0);if(r.length===3){var n=r.map(Zk),s=n[0],i=n[1],o=n[2];return RA(s,i,o,1)}if(r.length===4){var l=r.map(Zk),s=l[0],i=l[1],o=l[2],c=l[3];return RA(s,i,o,c)}return 0};function uN(t,e,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(e-t)*r*6+t:r<1/2?e:r<2/3?(e-t)*6*(2/3-r)+t:t}var tF=function(t,e){var r=e.filter(K0),n=r[0],s=r[1],i=r[2],o=r[3],l=(n.type===17?dl(n.number):L2.parse(t,n))/(Math.PI*2),c=ta(s)?s.number/100:0,d=ta(i)?i.number/100:0,A=typeof o<"u"&&ta(o)?zn(o,1):1;if(c===0)return RA(d*255,d*255,d*255,1);var u=d<=.5?d*(c+1):d+c-d*c,f=d*2-u,h=uN(f,u,l+1/3),m=uN(f,u,l),p=uN(f,u,l-1/3);return RA(h*255,m*255,p*255,A)},nte={hsl:tF,hsla:tF,rgb:eF,rgba:eF},zp=function(t,e){return YA.parse(t,yO.create(e).parseComponentValue())},gd={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},ste={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(Pn(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},ate={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},U2=function(t,e){var r=YA.parse(t,e[0]),n=e[1];return n&&ta(n)?{color:r,stop:n}:{color:r,stop:null}},rF=function(t,e){var r=t[0],n=t[t.length-1];r.stop===null&&(r.stop=Wa),n.stop===null&&(n.stop=PA);for(var s=[],i=0,o=0;o<t.length;o++){var l=t[o].stop;if(l!==null){var c=zn(l,e);c>i?s.push(c):s.push(i),i=c}else s.push(null)}for(var d=null,o=0;o<s.length;o++){var A=s[o];if(A===null)d===null&&(d=o);else if(d!==null){for(var u=o-d,f=s[d-1],h=(A-f)/(u+1),m=1;m<=u;m++)s[d+m-1]=h*m;d=null}}return t.map(function(p,g){var x=p.color;return{color:x,stop:Math.max(Math.min(1,s[g]/e),0)}})},ite=function(t,e,r){var n=e/2,s=r/2,i=zn(t[0],e)-n,o=s-zn(t[1],r);return(Math.atan2(o,i)+Math.PI*2)%(Math.PI*2)},ote=function(t,e,r){var n=typeof t=="number"?t:ite(t,e,r),s=Math.abs(e*Math.sin(n))+Math.abs(r*Math.cos(n)),i=e/2,o=r/2,l=s/2,c=Math.sin(n-Math.PI/2)*l,d=Math.cos(n-Math.PI/2)*l;return[s,i-d,i+d,o-c,o+c]},Fl=function(t,e){return Math.sqrt(t*t+e*e)},nF=function(t,e,r,n,s){var i=[[0,0],[0,e],[t,0],[t,e]];return i.reduce(function(o,l){var c=l[0],d=l[1],A=Fl(r-c,n-d);return(s?A<o.optimumDistance:A>o.optimumDistance)?{optimumCorner:l,optimumDistance:A}:o},{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner},lte=function(t,e,r,n,s){var i=0,o=0;switch(t.size){case 0:t.shape===0?i=o=Math.min(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-s)):t.shape===1&&(i=Math.min(Math.abs(e),Math.abs(e-n)),o=Math.min(Math.abs(r),Math.abs(r-s)));break;case 2:if(t.shape===0)i=o=Math.min(Fl(e,r),Fl(e,r-s),Fl(e-n,r),Fl(e-n,r-s));else if(t.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-s))/Math.min(Math.abs(e),Math.abs(e-n)),c=nF(n,s,e,r,!0),d=c[0],A=c[1];i=Fl(d-e,(A-r)/l),o=l*i}break;case 1:t.shape===0?i=o=Math.max(Math.abs(e),Math.abs(e-n),Math.abs(r),Math.abs(r-s)):t.shape===1&&(i=Math.max(Math.abs(e),Math.abs(e-n)),o=Math.max(Math.abs(r),Math.abs(r-s)));break;case 3:if(t.shape===0)i=o=Math.max(Fl(e,r),Fl(e,r-s),Fl(e-n,r),Fl(e-n,r-s));else if(t.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-s))/Math.max(Math.abs(e),Math.abs(e-n)),u=nF(n,s,e,r,!1),d=u[0],A=u[1];i=Fl(d-e,(A-r)/l),o=l*i}break}return Array.isArray(t.size)&&(i=zn(t.size[0],n),o=t.size.length===2?zn(t.size[1],s):i),[i,o]},cte=function(t,e){var r=dl(180),n=[];return kc(e).forEach(function(s,i){if(i===0){var o=s[0];if(o.type===20&&o.value==="to"){r=SO(s);return}else if(BO(o)){r=L2.parse(t,o);return}}var l=U2(t,s);n.push(l)}),{angle:r,stops:n,type:1}},t1=function(t,e){var r=dl(180),n=[];return kc(e).forEach(function(s,i){if(i===0){var o=s[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=SO(s);return}else if(BO(o)){r=(L2.parse(t,o)+dl(270))%dl(360);return}}var l=U2(t,s);n.push(l)}),{angle:r,stops:n,type:1}},dte=function(t,e){var r=dl(180),n=[],s=1,i=0,o=3,l=[];return kc(e).forEach(function(c,d){var A=c[0];if(d===0){if(Pn(A)&&A.value==="linear"){s=1;return}else if(Pn(A)&&A.value==="radial"){s=2;return}}if(A.type===18){if(A.name==="from"){var u=YA.parse(t,A.values[0]);n.push({stop:Wa,color:u})}else if(A.name==="to"){var u=YA.parse(t,A.values[0]);n.push({stop:PA,color:u})}else if(A.name==="color-stop"){var f=A.values.filter(K0);if(f.length===2){var u=YA.parse(t,f[1]),h=f[0];cm(h)&&n.push({stop:{type:16,number:h.number*100,flags:h.flags},color:u})}}}}),s===1?{angle:(r+dl(180))%dl(360),stops:n,type:s}:{size:o,shape:i,stops:n,position:l,type:s}},IO="closest-side",jO="farthest-side",kO="closest-corner",FO="farthest-corner",TO="circle",PO="ellipse",RO="cover",DO="contain",Ate=function(t,e){var r=0,n=3,s=[],i=[];return kc(e).forEach(function(o,l){var c=!0;if(l===0){var d=!1;c=o.reduce(function(u,f){if(d)if(Pn(f))switch(f.value){case"center":return i.push($S),u;case"top":case"left":return i.push(Wa),u;case"right":case"bottom":return i.push(PA),u}else(ta(f)||cu(f))&&i.push(f);else if(Pn(f))switch(f.value){case TO:return r=0,!1;case PO:return r=1,!1;case"at":return d=!0,!1;case IO:return n=0,!1;case RO:case jO:return n=1,!1;case DO:case kO:return n=2,!1;case FO:return n=3,!1}else if(cu(f)||ta(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return u},c)}if(c){var A=U2(t,o);s.push(A)}}),{size:n,shape:r,stops:s,position:i,type:2}},r1=function(t,e){var r=0,n=3,s=[],i=[];return kc(e).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(A,u){if(Pn(u))switch(u.value){case"center":return i.push($S),!1;case"top":case"left":return i.push(Wa),!1;case"right":case"bottom":return i.push(PA),!1}else if(ta(u)||cu(u))return i.push(u),!1;return A},c):l===1&&(c=o.reduce(function(A,u){if(Pn(u))switch(u.value){case TO:return r=0,!1;case PO:return r=1,!1;case DO:case IO:return n=0,!1;case jO:return n=1,!1;case kO:return n=2,!1;case RO:case FO:return n=3,!1}else if(cu(u)||ta(u))return Array.isArray(n)||(n=[]),n.push(u),!1;return A},c)),c){var d=U2(t,o);s.push(d)}}),{size:n,shape:r,stops:s,position:i,type:2}},ute=function(t){return t.type===1},hte=function(t){return t.type===2},zS={name:"image",parse:function(t,e){if(e.type===22){var r={url:e.value,type:0};return t.cache.addImage(e.value),r}if(e.type===18){var n=LO[e.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(t,e.values)}throw new Error("Unsupported image type "+e.type)}};function fte(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!LO[t.name])}var LO={"linear-gradient":cte,"-moz-linear-gradient":t1,"-ms-linear-gradient":t1,"-o-linear-gradient":t1,"-webkit-linear-gradient":t1,"radial-gradient":Ate,"-moz-radial-gradient":r1,"-ms-radial-gradient":r1,"-o-radial-gradient":r1,"-webkit-radial-gradient":r1,"-webkit-gradient":dte},mte={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e.filter(function(n){return K0(n)&&fte(n)}).map(function(n){return zS.parse(t,n)})}},pte={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(r){if(Pn(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},gte={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return kc(e).map(function(r){return r.filter(ta)}).map(wO)}},xte={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return kc(e).map(function(r){return r.filter(Pn).map(function(n){return n.value}).join(" ")}).map(vte)}},vte=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},b0;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(b0||(b0={}));var yte={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return kc(e).map(function(r){return r.filter(bte)})}},bte=function(t){return Pn(t)||ta(t)},O2=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},wte=O2("top"),Nte=O2("right"),Cte=O2("bottom"),_te=O2("left"),M2=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(e,r){return wO(r.filter(ta))}}},Ete=M2("top-left"),Bte=M2("top-right"),Ste=M2("bottom-right"),Ite=M2("bottom-left"),Q2=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},jte=Q2("top"),kte=Q2("right"),Fte=Q2("bottom"),Tte=Q2("left"),V2=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,r){return Qx(r)?r.number:0}}},Pte=V2("top"),Rte=V2("right"),Dte=V2("bottom"),Lte=V2("left"),Ute={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Ote={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},Mte={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter(Pn).reduce(function(r,n){return r|Qte(n.value)},0)}},Qte=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Vte={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Hte={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},hb;(function(t){t.NORMAL="normal",t.STRICT="strict"})(hb||(hb={}));var Kte={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"strict":return hb.STRICT;case"normal":default:return hb.NORMAL}}},qte={name:"line-height",initialValue:"normal",prefix:!1,type:4},sF=function(t,e){return Pn(t)&&t.value==="normal"?1.2*e:t.type===17?e*t.number:ta(t)?zn(t,e):e},Gte={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return e.type===20&&e.value==="none"?null:zS.parse(t,e)}},$te={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},lE={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},H2=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},zte=H2("top"),Wte=H2("right"),Jte=H2("bottom"),Xte=H2("left"),Yte={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter(Pn).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Zte={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},K2=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},ere=K2("top"),tre=K2("right"),rre=K2("bottom"),nre=K2("left"),sre={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},are={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},ire={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&oE(e[0],"none")?[]:kc(e).map(function(r){for(var n={color:gd.TRANSPARENT,offsetX:Wa,offsetY:Wa,blur:Wa},s=0,i=0;i<r.length;i++){var o=r[i];cu(o)?(s===0?n.offsetX=o:s===1?n.offsetY=o:n.blur=o,s++):n.color=YA.parse(t,o)}return n})}},ore={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},lre={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var r=Are[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return r(e.values)}return null}},cre=function(t){var e=t.filter(function(r){return r.type===17}).map(function(r){return r.number});return e.length===6?e:null},dre=function(t){var e=t.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=e[0],n=e[1];e[2],e[3];var s=e[4],i=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var o=e[12],l=e[13];return e[14],e[15],e.length===16?[r,n,s,i,o,l]:null},Are={matrix:cre,matrix3d:dre},aF={type:16,number:50,flags:Mx},ure=[aF,aF],hre={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var r=e.filter(ta);return r.length!==2?ure:[r[0],r[1]]}},fre={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Wp;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(Wp||(Wp={}));var mre={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return Wp.BREAK_ALL;case"keep-all":return Wp.KEEP_ALL;case"normal":default:return Wp.NORMAL}}},pre={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(e.type===20)return{auto:!0,order:0};if(cm(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},UO={name:"time",parse:function(t,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},gre={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return cm(e)?e.number:1}},xre={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},vre={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter(Pn).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},yre={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var r=[],n=[];return e.forEach(function(s){switch(s.type){case 20:case 0:r.push(s.value);break;case 17:r.push(s.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(s){return s.indexOf(" ")===-1?s:"'"+s+"'"})}},bre={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},wre={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){if(cm(e))return e.number;if(Pn(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},Nre={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter(Pn).map(function(r){return r.value})}},Cre={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},ha=function(t,e){return(t&e)!==0},_re={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(e.length===0)return[];var r=e[0];return r.type===20&&r.value==="none"?[]:e}},Ere={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;for(var n=[],s=e.filter(bO),i=0;i<s.length;i++){var o=s[i],l=s[i+1];if(o.type===20){var c=l&&cm(l)?l.number:1;n.push({counter:o.value,increment:c})}}return n}},Bre={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return[];for(var r=[],n=e.filter(bO),s=0;s<n.length;s++){var i=n[s],o=n[s+1];if(Pn(i)&&i.value!=="none"){var l=o&&cm(o)?o.number:0;r.push({counter:i.value,reset:l})}}return r}},Sre={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(Qx).map(function(r){return UO.parse(t,r)})}},Ire={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(e.length===0)return null;var r=e[0];if(r.type===20&&r.value==="none")return null;var n=[],s=e.filter(tte);if(s.length%2!==0)return null;for(var i=0;i<s.length;i+=2){var o=s[i].value,l=s[i+1].value;n.push({open:o,close:l})}return n}},iF=function(t,e,r){if(!t)return"";var n=t[Math.min(e,t.length-1)];return n?r?n.open:n.close:""},jre={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.length===1&&oE(e[0],"none")?[]:kc(e).map(function(r){for(var n={color:255,offsetX:Wa,offsetY:Wa,blur:Wa,spread:Wa,inset:!1},s=0,i=0;i<r.length;i++){var o=r[i];oE(o,"inset")?n.inset=!0:cu(o)?(s===0?n.offsetX=o:s===1?n.offsetY=o:s===2?n.blur=o:n.spread=o,s++):n.color=YA.parse(t,o)}return n})}},kre={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var r=[0,1,2],n=[];return e.filter(Pn).forEach(function(s){switch(s.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(s){n.indexOf(s)===-1&&n.push(s)}),n}},Fre={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Tre={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Qx(e)?e.number:0}},Pre=function(){function t(e,r){var n,s;this.animationDuration=ir(e,Sre,r.animationDuration),this.backgroundClip=ir(e,ste,r.backgroundClip),this.backgroundColor=ir(e,ate,r.backgroundColor),this.backgroundImage=ir(e,mte,r.backgroundImage),this.backgroundOrigin=ir(e,pte,r.backgroundOrigin),this.backgroundPosition=ir(e,gte,r.backgroundPosition),this.backgroundRepeat=ir(e,xte,r.backgroundRepeat),this.backgroundSize=ir(e,yte,r.backgroundSize),this.borderTopColor=ir(e,wte,r.borderTopColor),this.borderRightColor=ir(e,Nte,r.borderRightColor),this.borderBottomColor=ir(e,Cte,r.borderBottomColor),this.borderLeftColor=ir(e,_te,r.borderLeftColor),this.borderTopLeftRadius=ir(e,Ete,r.borderTopLeftRadius),this.borderTopRightRadius=ir(e,Bte,r.borderTopRightRadius),this.borderBottomRightRadius=ir(e,Ste,r.borderBottomRightRadius),this.borderBottomLeftRadius=ir(e,Ite,r.borderBottomLeftRadius),this.borderTopStyle=ir(e,jte,r.borderTopStyle),this.borderRightStyle=ir(e,kte,r.borderRightStyle),this.borderBottomStyle=ir(e,Fte,r.borderBottomStyle),this.borderLeftStyle=ir(e,Tte,r.borderLeftStyle),this.borderTopWidth=ir(e,Pte,r.borderTopWidth),this.borderRightWidth=ir(e,Rte,r.borderRightWidth),this.borderBottomWidth=ir(e,Dte,r.borderBottomWidth),this.borderLeftWidth=ir(e,Lte,r.borderLeftWidth),this.boxShadow=ir(e,jre,r.boxShadow),this.color=ir(e,Ute,r.color),this.direction=ir(e,Ote,r.direction),this.display=ir(e,Mte,r.display),this.float=ir(e,Vte,r.cssFloat),this.fontFamily=ir(e,yre,r.fontFamily),this.fontSize=ir(e,bre,r.fontSize),this.fontStyle=ir(e,Cre,r.fontStyle),this.fontVariant=ir(e,Nre,r.fontVariant),this.fontWeight=ir(e,wre,r.fontWeight),this.letterSpacing=ir(e,Hte,r.letterSpacing),this.lineBreak=ir(e,Kte,r.lineBreak),this.lineHeight=ir(e,qte,r.lineHeight),this.listStyleImage=ir(e,Gte,r.listStyleImage),this.listStylePosition=ir(e,$te,r.listStylePosition),this.listStyleType=ir(e,lE,r.listStyleType),this.marginTop=ir(e,zte,r.marginTop),this.marginRight=ir(e,Wte,r.marginRight),this.marginBottom=ir(e,Jte,r.marginBottom),this.marginLeft=ir(e,Xte,r.marginLeft),this.opacity=ir(e,gre,r.opacity);var i=ir(e,Yte,r.overflow);this.overflowX=i[0],this.overflowY=i[i.length>1?1:0],this.overflowWrap=ir(e,Zte,r.overflowWrap),this.paddingTop=ir(e,ere,r.paddingTop),this.paddingRight=ir(e,tre,r.paddingRight),this.paddingBottom=ir(e,rre,r.paddingBottom),this.paddingLeft=ir(e,nre,r.paddingLeft),this.paintOrder=ir(e,kre,r.paintOrder),this.position=ir(e,are,r.position),this.textAlign=ir(e,sre,r.textAlign),this.textDecorationColor=ir(e,xre,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=ir(e,vre,(s=r.textDecorationLine)!==null&&s!==void 0?s:r.textDecoration),this.textShadow=ir(e,ire,r.textShadow),this.textTransform=ir(e,ore,r.textTransform),this.transform=ir(e,lre,r.transform),this.transformOrigin=ir(e,hre,r.transformOrigin),this.visibility=ir(e,fre,r.visibility),this.webkitTextStrokeColor=ir(e,Fre,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=ir(e,Tre,r.webkitTextStrokeWidth),this.wordBreak=ir(e,mre,r.wordBreak),this.zIndex=ir(e,pre,r.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return ZA(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return ha(this.display,4)||ha(this.display,33554432)||ha(this.display,268435456)||ha(this.display,536870912)||ha(this.display,67108864)||ha(this.display,134217728)},t}(),Rre=function(){function t(e,r){this.content=ir(e,_re,r.content),this.quotes=ir(e,Ire,r.quotes)}return t}(),oF=function(){function t(e,r){this.counterIncrement=ir(e,Ere,r.counterIncrement),this.counterReset=ir(e,Bre,r.counterReset)}return t}(),ir=function(t,e,r){var n=new vO,s=r!==null&&typeof r<"u"?r.toString():e.initialValue;n.write(s);var i=new yO(n.read());switch(e.type){case 2:var o=i.parseComponentValue();return e.parse(t,Pn(o)?o.value:e.initialValue);case 0:return e.parse(t,i.parseComponentValue());case 1:return e.parse(t,i.parseComponentValues());case 4:return i.parseComponentValue();case 3:switch(e.format){case"angle":return L2.parse(t,i.parseComponentValue());case"color":return YA.parse(t,i.parseComponentValue());case"image":return zS.parse(t,i.parseComponentValue());case"length":var l=i.parseComponentValue();return cu(l)?l:Wa;case"length-percentage":var c=i.parseComponentValue();return ta(c)?c:Wa;case"time":return UO.parse(t,i.parseComponentValue())}break}},Dre="data-html2canvas-debug",Lre=function(t){var e=t.getAttribute(Dre);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},cE=function(t,e){var r=Lre(t);return r===1||e===r},Fc=function(){function t(e,r){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,cE(r,3))debugger;this.styles=new Pre(e,window.getComputedStyle(r,null)),uE(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=R2(this.context,r),cE(r,4)&&(this.flags|=16)}return t}(),Ure="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",lF="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_p=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var n1=0;n1<lF.length;n1++)_p[lF.charCodeAt(n1)]=n1;var Ore=function(t){var e=t.length*.75,r=t.length,n,s=0,i,o,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),A=Array.isArray(d)?d:new Uint8Array(d);for(n=0;n<r;n+=4)i=_p[t.charCodeAt(n)],o=_p[t.charCodeAt(n+1)],l=_p[t.charCodeAt(n+2)],c=_p[t.charCodeAt(n+3)],A[s++]=i<<2|o>>4,A[s++]=(o&15)<<4|l>>2,A[s++]=(l&3)<<6|c&63;return d},Mre=function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r.push(t[n+1]<<8|t[n]);return r},Qre=function(t){for(var e=t.length,r=[],n=0;n<e;n+=4)r.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return r},uh=5,WS=11,hN=2,Vre=WS-uh,OO=65536>>uh,Hre=1<<uh,fN=Hre-1,Kre=1024>>uh,qre=OO+Kre,Gre=qre,$re=32,zre=Gre+$re,Wre=65536>>WS,Jre=1<<Vre,Xre=Jre-1,cF=function(t,e,r){return t.slice?t.slice(e,r):new Uint16Array(Array.prototype.slice.call(t,e,r))},Yre=function(t,e,r){return t.slice?t.slice(e,r):new Uint32Array(Array.prototype.slice.call(t,e,r))},Zre=function(t,e){var r=Ore(t),n=Array.isArray(r)?Qre(r):new Uint32Array(r),s=Array.isArray(r)?Mre(r):new Uint16Array(r),i=24,o=cF(s,i/2,n[4]/2),l=n[5]===2?cF(s,(i+n[4])/2):Yre(n,Math.ceil((i+n[4])/4));return new ene(n[0],n[1],n[2],n[3],o,l)},ene=function(){function t(e,r,n,s,i,o){this.initialValue=e,this.errorValue=r,this.highStart=n,this.highValueIndex=s,this.index=i,this.data=o}return t.prototype.get=function(e){var r;if(e>=0){if(e<55296||e>56319&&e<=65535)return r=this.index[e>>uh],r=(r<<hN)+(e&fN),this.data[r];if(e<=65535)return r=this.index[OO+(e-55296>>uh)],r=(r<<hN)+(e&fN),this.data[r];if(e<this.highStart)return r=zre-Wre+(e>>WS),r=this.index[r],r+=e>>uh&Xre,r=this.index[r],r=(r<<hN)+(e&fN),this.data[r];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),dF="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",tne=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var s1=0;s1<dF.length;s1++)tne[dF.charCodeAt(s1)]=s1;var rne=1,mN=2,pN=3,AF=4,uF=5,nne=7,hF=8,gN=9,xN=10,fF=11,mF=12,pF=13,gF=14,vN=15,sne=function(t){for(var e=[],r=0,n=t.length;r<n;){var s=t.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var i=t.charCodeAt(r++);(i&64512)===56320?e.push(((s&1023)<<10)+(i&1023)+65536):(e.push(s),r--)}else e.push(s)}return e},ane=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var n=[],s=-1,i="";++s<r;){var o=t[s];o<=65535?n.push(o):(o-=65536,n.push((o>>10)+55296,o%1024+56320)),(s+1===r||n.length>16384)&&(i+=String.fromCharCode.apply(String,n),n.length=0)}return i},ine=Zre(Ure),rl="",yN="",one=function(t){return ine.get(t)},lne=function(t,e,r){var n=r-2,s=e[n],i=e[r-1],o=e[r];if(i===mN&&o===pN)return rl;if(i===mN||i===pN||i===AF||o===mN||o===pN||o===AF)return yN;if(i===hF&&[hF,gN,fF,mF].indexOf(o)!==-1||(i===fF||i===gN)&&(o===gN||o===xN)||(i===mF||i===xN)&&o===xN||o===pF||o===uF||o===nne||i===rne)return rl;if(i===pF&&o===gF){for(;s===uF;)s=e[--n];if(s===gF)return rl}if(i===vN&&o===vN){for(var l=0;s===vN;)l++,s=e[--n];if(l%2===0)return rl}return yN},cne=function(t){var e=sne(t),r=e.length,n=0,s=0,i=e.map(one);return{next:function(){if(n>=r)return{done:!0,value:null};for(var o=rl;n<r&&(o=lne(e,i,++n))===rl;);if(o!==rl||n===r){var l=ane.apply(null,e.slice(s,n));return s=n,{value:l,done:!1}}return{done:!0,value:null}}}},dne=function(t){for(var e=cne(t),r=[],n;!(n=e.next()).done;)n.value&&r.push(n.value.slice());return r},Ane=function(t){var e=123;if(t.createRange){var r=t.createRange();if(r.getBoundingClientRect){var n=t.createElement("boundtest");n.style.height=e+"px",n.style.display="block",t.body.appendChild(n),r.selectNode(n);var s=r.getBoundingClientRect(),i=Math.round(s.height);if(t.body.removeChild(n),i===e)return!0}}return!1},une=function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var r=t.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=e.firstChild,s=D2(n.data).map(function(c){return Hs(c)}),i=0,o={},l=s.every(function(c,d){r.setStart(n,i),r.setEnd(n,i+c.length);var A=r.getBoundingClientRect();i+=c.length;var u=A.x>o.x||A.y>o.y;return o=A,d===0?!0:u});return t.body.removeChild(e),l},hne=function(){return typeof new Image().crossOrigin<"u"},fne=function(){return typeof new XMLHttpRequest().responseType=="string"},mne=function(t){var e=new Image,r=t.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),r.toDataURL()}catch{return!1}return!0},xF=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},pne=function(t){var e=t.createElement("canvas"),r=100;e.width=r,e.height=r;var n=e.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var s=new Image,i=e.toDataURL();s.src=i;var o=dE(r,r,0,0,s);return n.fillStyle="red",n.fillRect(0,0,r,r),vF(o).then(function(l){n.drawImage(l,0,0);var c=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var d=t.createElement("div");return d.style.backgroundImage="url("+i+")",d.style.height=r+"px",xF(c)?vF(dE(r,r,0,0,d)):Promise.reject(!1)}).then(function(l){return n.drawImage(l,0,0),xF(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},dE=function(t,e,r,n,s){var i="http://www.w3.org/2000/svg",o=document.createElementNS(i,"svg"),l=document.createElementNS(i,"foreignObject");return o.setAttributeNS(null,"width",t.toString()),o.setAttributeNS(null,"height",e.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",n.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(s),o},vF=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){return e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Va={get SUPPORT_RANGE_BOUNDS(){var t=Ane(document);return Object.defineProperty(Va,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=Va.SUPPORT_RANGE_BOUNDS&&une(document);return Object.defineProperty(Va,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=mne(document);return Object.defineProperty(Va,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?pne(document):Promise.resolve(!1);return Object.defineProperty(Va,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=hne();return Object.defineProperty(Va,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=fne();return Object.defineProperty(Va,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Va,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Va,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},Jp=function(){function t(e,r){this.text=e,this.bounds=r}return t}(),gne=function(t,e,r,n){var s=yne(e,r),i=[],o=0;return s.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if(Va.SUPPORT_RANGE_BOUNDS){var c=yF(n,o,l.length).getClientRects();if(c.length>1){var d=JS(l),A=0;d.forEach(function(f){i.push(new Jp(f,jd.fromDOMRectList(t,yF(n,A+o,f.length).getClientRects()))),A+=f.length})}else i.push(new Jp(l,jd.fromDOMRectList(t,c)))}else{var u=n.splitText(l.length);i.push(new Jp(l,xne(t,n))),n=u}else Va.SUPPORT_RANGE_BOUNDS||(n=n.splitText(l.length));o+=l.length}),i},xne=function(t,e){var r=e.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(e.cloneNode(!0));var s=e.parentNode;if(s){s.replaceChild(n,e);var i=R2(t,n);return n.firstChild&&s.replaceChild(n.firstChild,n),i}}return jd.EMPTY},yF=function(t,e,r){var n=t.ownerDocument;if(!n)throw new Error("Node has no owner document");var s=n.createRange();return s.setStart(t,e),s.setEnd(t,e+r),s},JS=function(t){if(Va.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map(function(r){return r.segment})}return dne(t)},vne=function(t,e){if(Va.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(t)).map(function(n){return n.segment})}return wne(t,e)},yne=function(t,e){return e.letterSpacing!==0?JS(t):vne(t,e)},bne=[32,160,4961,65792,65793,4153,4241],wne=function(t,e){for(var r=WZ(t,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),n=[],s,i=function(){if(s.value){var o=s.value.slice(),l=D2(o),c="";l.forEach(function(d){bne.indexOf(d)===-1?c+=Hs(d):(c.length&&n.push(c),n.push(Hs(d)),c="")}),c.length&&n.push(c)}};!(s=r.next()).done;)i();return n},Nne=function(){function t(e,r,n){this.text=Cne(r.data,n.textTransform),this.textBounds=gne(e,this.text,n,r)}return t}(),Cne=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(_ne,Ene);case 2:return t.toUpperCase();default:return t}},_ne=/(^|\s|:|-|\(|\))([a-z])/g,Ene=function(t,e,r){return t.length>0?e+r.toUpperCase():t},MO=function(t){Jl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.src=n.currentSrc||n.src,s.intrinsicWidth=n.naturalWidth,s.intrinsicHeight=n.naturalHeight,s.context.cache.addImage(s.src),s}return e}(Fc),QO=function(t){Jl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.canvas=n,s.intrinsicWidth=n.width,s.intrinsicHeight=n.height,s}return e}(Fc),VO=function(t){Jl(e,t);function e(r,n){var s=t.call(this,r,n)||this,i=new XMLSerializer,o=R2(r,n);return n.setAttribute("width",o.width+"px"),n.setAttribute("height",o.height+"px"),s.svg="data:image/svg+xml,"+encodeURIComponent(i.serializeToString(n)),s.intrinsicWidth=n.width.baseVal.value,s.intrinsicHeight=n.height.baseVal.value,s.context.cache.addImage(s.svg),s}return e}(Fc),HO=function(t){Jl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.value=n.value,s}return e}(Fc),AE=function(t){Jl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.start=n.start,s.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,s}return e}(Fc),Bne=[{type:15,flags:0,unit:"px",number:3}],Sne=[{type:16,flags:0,number:50}],Ine=function(t){return t.width>t.height?new jd(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new jd(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},jne=function(t){var e=t.type===kne?new Array(t.value.length+1).join(""):t.value;return e.length===0?t.placeholder||"":e},fb="checkbox",mb="radio",kne="password",bF=707406591,XS=function(t){Jl(e,t);function e(r,n){var s=t.call(this,r,n)||this;switch(s.type=n.type.toLowerCase(),s.checked=n.checked,s.value=jne(n),(s.type===fb||s.type===mb)&&(s.styles.backgroundColor=3739148031,s.styles.borderTopColor=s.styles.borderRightColor=s.styles.borderBottomColor=s.styles.borderLeftColor=2779096575,s.styles.borderTopWidth=s.styles.borderRightWidth=s.styles.borderBottomWidth=s.styles.borderLeftWidth=1,s.styles.borderTopStyle=s.styles.borderRightStyle=s.styles.borderBottomStyle=s.styles.borderLeftStyle=1,s.styles.backgroundClip=[0],s.styles.backgroundOrigin=[0],s.bounds=Ine(s.bounds)),s.type){case fb:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=Bne;break;case mb:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=Sne;break}return s}return e}(Fc),KO=function(t){Jl(e,t);function e(r,n){var s=t.call(this,r,n)||this,i=n.options[n.selectedIndex||0];return s.value=i&&i.text||"",s}return e}(Fc),qO=function(t){Jl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.value=n.value,s}return e}(Fc),GO=function(t){Jl(e,t);function e(r,n){var s=t.call(this,r,n)||this;s.src=n.src,s.width=parseInt(n.width,10)||0,s.height=parseInt(n.height,10)||0,s.backgroundColor=s.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){s.tree=zO(r,n.contentWindow.document.documentElement);var i=n.contentWindow.document.documentElement?zp(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):gd.TRANSPARENT,o=n.contentWindow.document.body?zp(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):gd.TRANSPARENT;s.backgroundColor=ZA(i)?ZA(o)?s.styles.backgroundColor:o:i}}catch{}return s}return e}(Fc),Fne=["OL","UL","MENU"],my=function(t,e,r,n){for(var s=e.firstChild,i=void 0;s;s=i)if(i=s.nextSibling,WO(s)&&s.data.trim().length>0)r.textNodes.push(new Nne(t,s,r.styles));else if(c0(s))if(ZO(s)&&s.assignedNodes)s.assignedNodes().forEach(function(l){return my(t,l,r,n)});else{var o=$O(t,s);o.styles.isVisible()&&(Tne(s,o,n)?o.flags|=4:Pne(o.styles)&&(o.flags|=2),Fne.indexOf(s.tagName)!==-1&&(o.flags|=8),r.elements.push(o),s.slot,s.shadowRoot?my(t,s.shadowRoot,o,n):!pb(s)&&!JO(s)&&!gb(s)&&my(t,s,o,n))}},$O=function(t,e){return hE(e)?new MO(t,e):XO(e)?new QO(t,e):JO(e)?new VO(t,e):Rne(e)?new HO(t,e):Dne(e)?new AE(t,e):Lne(e)?new XS(t,e):gb(e)?new KO(t,e):pb(e)?new qO(t,e):YO(e)?new GO(t,e):new Fc(t,e)},zO=function(t,e){var r=$O(t,e);return r.flags|=4,my(t,e,r,r),r},Tne=function(t,e,r){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||YS(t)&&r.styles.isTransparent()},Pne=function(t){return t.isPositioned()||t.isFloating()},WO=function(t){return t.nodeType===Node.TEXT_NODE},c0=function(t){return t.nodeType===Node.ELEMENT_NODE},uE=function(t){return c0(t)&&typeof t.style<"u"&&!py(t)},py=function(t){return typeof t.className=="object"},Rne=function(t){return t.tagName==="LI"},Dne=function(t){return t.tagName==="OL"},Lne=function(t){return t.tagName==="INPUT"},Une=function(t){return t.tagName==="HTML"},JO=function(t){return t.tagName==="svg"},YS=function(t){return t.tagName==="BODY"},XO=function(t){return t.tagName==="CANVAS"},wF=function(t){return t.tagName==="VIDEO"},hE=function(t){return t.tagName==="IMG"},YO=function(t){return t.tagName==="IFRAME"},NF=function(t){return t.tagName==="STYLE"},One=function(t){return t.tagName==="SCRIPT"},pb=function(t){return t.tagName==="TEXTAREA"},gb=function(t){return t.tagName==="SELECT"},ZO=function(t){return t.tagName==="SLOT"},CF=function(t){return t.tagName.indexOf("-")>0},Mne=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(e){var r=this.counters[e];return r&&r.length?r[r.length-1]:1},t.prototype.getCounterValues=function(e){var r=this.counters[e];return r||[]},t.prototype.pop=function(e){var r=this;e.forEach(function(n){return r.counters[n].pop()})},t.prototype.parse=function(e){var r=this,n=e.counterIncrement,s=e.counterReset,i=!0;n!==null&&n.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(i=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return i&&s.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},t}(),_F={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},EF={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Qne={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Vne={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Ef=function(t,e,r,n,s,i){return t<e||t>r?Jg(t,s,i.length>0):n.integers.reduce(function(o,l,c){for(;t>=l;)t-=l,o+=n.values[c];return o},"")+i},eM=function(t,e,r,n){var s="";do r||t--,s=n(t)+s,t/=e;while(t*e>=e);return s},Qs=function(t,e,r,n,s){var i=r-e+1;return(t<0?"-":"")+(eM(Math.abs(t),i,n,function(o){return Hs(Math.floor(o%i)+e)})+s)},Lu=function(t,e,r){r===void 0&&(r=". ");var n=e.length;return eM(Math.abs(t),n,!1,function(s){return e[Math.floor(s%n)]})+r},qf=1,mA=2,pA=4,Ep=8,zc=function(t,e,r,n,s,i){if(t<-9999||t>9999)return Jg(t,4,s.length>0);var o=Math.abs(t),l=s;if(o===0)return e[0]+l;for(var c=0;o>0&&c<=4;c++){var d=o%10;d===0&&ha(i,qf)&&l!==""?l=e[d]+l:d>1||d===1&&c===0||d===1&&c===1&&ha(i,mA)||d===1&&c===1&&ha(i,pA)&&t>100||d===1&&c>1&&ha(i,Ep)?l=e[d]+(c>0?r[c-1]:"")+l:d===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(t<0?n:"")+l},BF="",SF="",IF="",bN="",Jg=function(t,e,r){var n=r?". ":"",s=r?"":"",i=r?", ":"",o=r?" ":"";switch(e){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=Qs(t,48,57,!0,n);return l.length<4?"0"+l:l;case 4:return Lu(t,"",s);case 6:return Ef(t,1,3999,_F,3,n).toLowerCase();case 7:return Ef(t,1,3999,_F,3,n);case 8:return Qs(t,945,969,!1,n);case 9:return Qs(t,97,122,!1,n);case 10:return Qs(t,65,90,!1,n);case 11:return Qs(t,1632,1641,!0,n);case 12:case 49:return Ef(t,1,9999,EF,3,n);case 35:return Ef(t,1,9999,EF,3,n).toLowerCase();case 13:return Qs(t,2534,2543,!0,n);case 14:case 30:return Qs(t,6112,6121,!0,n);case 15:return Lu(t,"",s);case 16:return Lu(t,"",s);case 17:case 48:return zc(t,"",BF,"",s,mA|pA|Ep);case 47:return zc(t,"",SF,"",s,qf|mA|pA|Ep);case 42:return zc(t,"",BF,"",s,mA|pA|Ep);case 41:return zc(t,"",SF,"",s,qf|mA|pA|Ep);case 26:return zc(t,"","",IF,s,0);case 25:return zc(t,"","",IF,s,qf|mA|pA);case 31:return zc(t,"","",bN,i,qf|mA|pA);case 33:return zc(t,"","",bN,i,0);case 32:return zc(t,"","",bN,i,qf|mA|pA);case 18:return Qs(t,2406,2415,!0,n);case 20:return Ef(t,1,19999,Vne,3,n);case 21:return Qs(t,2790,2799,!0,n);case 22:return Qs(t,2662,2671,!0,n);case 22:return Ef(t,1,10999,Qne,3,n);case 23:return Lu(t,"");case 24:return Lu(t,"");case 27:return Qs(t,3302,3311,!0,n);case 28:return Lu(t,"",s);case 29:return Lu(t,"",s);case 34:return Qs(t,3792,3801,!0,n);case 37:return Qs(t,6160,6169,!0,n);case 38:return Qs(t,4160,4169,!0,n);case 39:return Qs(t,2918,2927,!0,n);case 40:return Qs(t,1776,1785,!0,n);case 43:return Qs(t,3046,3055,!0,n);case 44:return Qs(t,3174,3183,!0,n);case 45:return Qs(t,3664,3673,!0,n);case 46:return Qs(t,3872,3881,!0,n);case 3:default:return Qs(t,48,57,!0,n)}},tM="data-html2canvas-ignore",jF=function(){function t(e,r,n){if(this.context=e,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new Mne,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(e,r){var n=this,s=Hne(e,r);if(!s.contentWindow)return Promise.reject("Unable to find iframe window");var i=e.defaultView.pageXOffset,o=e.defaultView.pageYOffset,l=s.contentWindow,c=l.document,d=Gne(s).then(function(){return ji(n,void 0,void 0,function(){var A,u;return di(this,function(f){switch(f.label){case 0:return this.scrolledElements.forEach(Jne),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),A=this.options.onclone,u=this.clonedReferenceElement,typeof u>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:f.sent(),f.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,qne(c)]:[3,4];case 3:f.sent(),f.label=4;case 4:return typeof A=="function"?[2,Promise.resolve().then(function(){return A(c,u)}).then(function(){return s})]:[2,s]}})})});return c.open(),c.write(zne(document.doctype)+"<html></html>"),Wne(this.referenceElement.ownerDocument,i,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),d},t.prototype.createElementClone=function(e){if(cE(e,2))debugger;if(XO(e))return this.createCanvasClone(e);if(wF(e))return this.createVideoClone(e);if(NF(e))return this.createStyleClone(e);var r=e.cloneNode(!1);return hE(r)&&(hE(e)&&e.currentSrc&&e.currentSrc!==e.src&&(r.src=e.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),CF(r)?this.createCustomElementClone(r):r},t.prototype.createCustomElementClone=function(e){var r=document.createElement("html2canvascustomelement");return wN(e.style,r),r},t.prototype.createStyleClone=function(e){try{var r=e.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(i,o){return o&&typeof o.cssText=="string"?i+o.cssText:i},""),s=e.cloneNode(!1);return s.textContent=n,s}}catch(i){if(this.context.logger.error("Unable to access cssRules property",i),i.name!=="SecurityError")throw i}return e.cloneNode(!1)},t.prototype.createCanvasClone=function(e){var r;if(this.options.inlineImages&&e.ownerDocument){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var s=e.cloneNode(!1);try{s.width=e.width,s.height=e.height;var i=e.getContext("2d"),o=s.getContext("2d");if(o)if(!this.options.allowTaint&&i)o.putImageData(i.getImageData(0,0,e.width,e.height),0,0);else{var l=(r=e.getContext("webgl2"))!==null&&r!==void 0?r:e.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}o.drawImage(e,0,0)}return s}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return s},t.prototype.createVideoClone=function(e){var r=e.ownerDocument.createElement("canvas");r.width=e.offsetWidth,r.height=e.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(e,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var s=e.ownerDocument.createElement("canvas");return s.width=e.offsetWidth,s.height=e.offsetHeight,s},t.prototype.appendChildNode=function(e,r,n){(!c0(r)||!One(r)&&!r.hasAttribute(tM)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!c0(r)||!NF(r))&&e.appendChild(this.cloneNode(r,n))},t.prototype.cloneChildNodes=function(e,r,n){for(var s=this,i=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;i;i=i.nextSibling)if(c0(i)&&ZO(i)&&typeof i.assignedNodes=="function"){var o=i.assignedNodes();o.length&&o.forEach(function(l){return s.appendChildNode(r,l,n)})}else this.appendChildNode(r,i,n)},t.prototype.cloneNode=function(e,r){if(WO(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var n=e.ownerDocument.defaultView;if(n&&c0(e)&&(uE(e)||py(e))){var s=this.createElementClone(e);s.style.transitionProperty="none";var i=n.getComputedStyle(e),o=n.getComputedStyle(e,":before"),l=n.getComputedStyle(e,":after");this.referenceElement===e&&uE(s)&&(this.clonedReferenceElement=s),YS(s)&&Zne(s);var c=this.counters.parse(new oF(this.context,i)),d=this.resolvePseudoContent(e,s,o,Xp.BEFORE);CF(e)&&(r=!0),wF(e)||this.cloneChildNodes(e,s,r),d&&s.insertBefore(d,s.firstChild);var A=this.resolvePseudoContent(e,s,l,Xp.AFTER);return A&&s.appendChild(A),this.counters.pop(c),(i&&(this.options.copyStyles||py(e))&&!YO(e)||r)&&wN(i,s),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([s,e.scrollLeft,e.scrollTop]),(pb(e)||gb(e))&&(pb(s)||gb(s))&&(s.value=e.value),s}return e.cloneNode(!1)},t.prototype.resolvePseudoContent=function(e,r,n,s){var i=this;if(n){var o=n.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||n.display==="none")){this.counters.parse(new oF(this.context,n));var c=new Rre(this.context,n),d=l.createElement("html2canvaspseudoelement");wN(n,d),c.content.forEach(function(u){if(u.type===0)d.appendChild(l.createTextNode(u.value));else if(u.type===22){var f=l.createElement("img");f.src=u.value,f.style.opacity="1",d.appendChild(f)}else if(u.type===18){if(u.name==="attr"){var h=u.values.filter(Pn);h.length&&d.appendChild(l.createTextNode(e.getAttribute(h[0].value)||""))}else if(u.name==="counter"){var m=u.values.filter(K0),p=m[0],g=m[1];if(p&&Pn(p)){var x=i.counters.getCounterValue(p.value),b=g&&Pn(g)?lE.parse(i.context,g.value):3;d.appendChild(l.createTextNode(Jg(x,b,!1)))}}else if(u.name==="counters"){var w=u.values.filter(K0),p=w[0],k=w[1],g=w[2];if(p&&Pn(p)){var O=i.counters.getCounterValues(p.value),L=g&&Pn(g)?lE.parse(i.context,g.value):3,E=k&&k.type===0?k.value:"",B=O.map(function(_){return Jg(_,L,!1)}).join(E);d.appendChild(l.createTextNode(B))}}}else if(u.type===20)switch(u.value){case"open-quote":d.appendChild(l.createTextNode(iF(c.quotes,i.quoteDepth++,!0)));break;case"close-quote":d.appendChild(l.createTextNode(iF(c.quotes,--i.quoteDepth,!1)));break;default:d.appendChild(l.createTextNode(u.value))}}),d.className=fE+" "+mE;var A=s===Xp.BEFORE?" "+fE:" "+mE;return py(r)?r.className.baseValue+=A:r.className+=A,d}}},t.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},t}(),Xp;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(Xp||(Xp={}));var Hne=function(t,e){var r=t.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=e.width.toString(),r.height=e.height.toString(),r.scrolling="no",r.setAttribute(tM,"true"),t.body.appendChild(r),r},Kne=function(t){return new Promise(function(e){if(t.complete){e();return}if(!t.src){e();return}t.onload=e,t.onerror=e})},qne=function(t){return Promise.all([].slice.call(t.images,0).map(Kne))},Gne=function(t){return new Promise(function(e,r){var n=t.contentWindow;if(!n)return r("No window assigned for iframe");var s=n.document;n.onload=t.onload=function(){n.onload=t.onload=null;var i=setInterval(function(){s.body.childNodes.length>0&&s.readyState==="complete"&&(clearInterval(i),e(t))},50)}})},$ne=["all","d","content"],wN=function(t,e){for(var r=t.length-1;r>=0;r--){var n=t.item(r);$ne.indexOf(n)===-1&&e.style.setProperty(n,t.getPropertyValue(n))}return e},zne=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},Wne=function(t,e,r){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||r!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,r)},Jne=function(t){var e=t[0],r=t[1],n=t[2];e.scrollLeft=r,e.scrollTop=n},Xne=":before",Yne=":after",fE="___html2canvas___pseudoelement_before",mE="___html2canvas___pseudoelement_after",kF=`{
    content: "" !important;
    display: none !important;
}`,Zne=function(t){ese(t,"."+fE+Xne+kF+`
         .`+mE+Yne+kF)},ese=function(t,e){var r=t.ownerDocument;if(r){var n=r.createElement("style");n.textContent=e,t.appendChild(n)}},rM=function(){function t(){}return t.getOrigin=function(e){var r=t._link;return r?(r.href=e,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),tse=function(){function t(e,r){this.context=e,this._options=r,this._cache={}}return t.prototype.addImage=function(e){var r=Promise.resolve();return this.has(e)||(CN(e)||ase(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),r},t.prototype.match=function(e){return this._cache[e]},t.prototype.loadImage=function(e){return ji(this,void 0,void 0,function(){var r,n,s,i,o=this;return di(this,function(l){switch(l.label){case 0:return r=rM.isSameOrigin(e),n=!NN(e)&&this._options.useCORS===!0&&Va.SUPPORT_CORS_IMAGES&&!r,s=!NN(e)&&!r&&!CN(e)&&typeof this._options.proxy=="string"&&Va.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!NN(e)&&!CN(e)&&!s&&!n?[2]:(i=e,s?[4,this.proxy(i)]:[3,2]);case 1:i=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(c,d){var A=new Image;A.onload=function(){return c(A)},A.onerror=d,(ise(i)||n)&&(A.crossOrigin="anonymous"),A.src=i,A.complete===!0&&setTimeout(function(){return c(A)},500),o._options.imageTimeout>0&&setTimeout(function(){return d("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},t.prototype.has=function(e){return typeof this._cache[e]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(e){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var s=e.substring(0,256);return new Promise(function(i,o){var l=Va.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")i(c.response);else{var u=new FileReader;u.addEventListener("load",function(){return i(u.result)},!1),u.addEventListener("error",function(f){return o(f)},!1),u.readAsDataURL(c.response)}else o("Failed to proxy resource "+s+" with status code "+c.status)},c.onerror=o;var d=n.indexOf("?")>-1?"&":"?";if(c.open("GET",""+n+d+"url="+encodeURIComponent(e)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var A=r._options.imageTimeout;c.timeout=A,c.ontimeout=function(){return o("Timed out ("+A+"ms) proxying "+s)}}c.send()})},t}(),rse=/^data:image\/svg\+xml/i,nse=/^data:image\/.*;base64,/i,sse=/^data:image\/.*/i,ase=function(t){return Va.SUPPORT_SVG_DRAWING||!ose(t)},NN=function(t){return sse.test(t)},ise=function(t){return nse.test(t)},CN=function(t){return t.substr(0,4)==="blob"},ose=function(t){return t.substr(-3).toLowerCase()==="svg"||rse.test(t)},ar=function(){function t(e,r){this.type=0,this.x=e,this.y=r}return t.prototype.add=function(e,r){return new t(this.x+e,this.y+r)},t}(),Bf=function(t,e,r){return new ar(t.x+(e.x-t.x)*r,t.y+(e.y-t.y)*r)},a1=function(){function t(e,r,n,s){this.type=1,this.start=e,this.startControl=r,this.endControl=n,this.end=s}return t.prototype.subdivide=function(e,r){var n=Bf(this.start,this.startControl,e),s=Bf(this.startControl,this.endControl,e),i=Bf(this.endControl,this.end,e),o=Bf(n,s,e),l=Bf(s,i,e),c=Bf(o,l,e);return r?new t(this.start,n,o,c):new t(c,l,i,this.end)},t.prototype.add=function(e,r){return new t(this.start.add(e,r),this.startControl.add(e,r),this.endControl.add(e,r),this.end.add(e,r))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),ol=function(t){return t.type===1},lse=function(){function t(e){var r=e.styles,n=e.bounds,s=Cp(r.borderTopLeftRadius,n.width,n.height),i=s[0],o=s[1],l=Cp(r.borderTopRightRadius,n.width,n.height),c=l[0],d=l[1],A=Cp(r.borderBottomRightRadius,n.width,n.height),u=A[0],f=A[1],h=Cp(r.borderBottomLeftRadius,n.width,n.height),m=h[0],p=h[1],g=[];g.push((i+c)/n.width),g.push((m+u)/n.width),g.push((o+p)/n.height),g.push((d+f)/n.height);var x=Math.max.apply(Math,g);x>1&&(i/=x,o/=x,c/=x,d/=x,u/=x,f/=x,m/=x,p/=x);var b=n.width-c,w=n.height-f,k=n.width-u,O=n.height-p,L=r.borderTopWidth,E=r.borderRightWidth,B=r.borderBottomWidth,S=r.borderLeftWidth,U=zn(r.paddingTop,e.bounds.width),_=zn(r.paddingRight,e.bounds.width),F=zn(r.paddingBottom,e.bounds.width),D=zn(r.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=i>0||o>0?as(n.left+S/3,n.top+L/3,i-S/3,o-L/3,vn.TOP_LEFT):new ar(n.left+S/3,n.top+L/3),this.topRightBorderDoubleOuterBox=i>0||o>0?as(n.left+b,n.top+L/3,c-E/3,d-L/3,vn.TOP_RIGHT):new ar(n.left+n.width-E/3,n.top+L/3),this.bottomRightBorderDoubleOuterBox=u>0||f>0?as(n.left+k,n.top+w,u-E/3,f-B/3,vn.BOTTOM_RIGHT):new ar(n.left+n.width-E/3,n.top+n.height-B/3),this.bottomLeftBorderDoubleOuterBox=m>0||p>0?as(n.left+S/3,n.top+O,m-S/3,p-B/3,vn.BOTTOM_LEFT):new ar(n.left+S/3,n.top+n.height-B/3),this.topLeftBorderDoubleInnerBox=i>0||o>0?as(n.left+S*2/3,n.top+L*2/3,i-S*2/3,o-L*2/3,vn.TOP_LEFT):new ar(n.left+S*2/3,n.top+L*2/3),this.topRightBorderDoubleInnerBox=i>0||o>0?as(n.left+b,n.top+L*2/3,c-E*2/3,d-L*2/3,vn.TOP_RIGHT):new ar(n.left+n.width-E*2/3,n.top+L*2/3),this.bottomRightBorderDoubleInnerBox=u>0||f>0?as(n.left+k,n.top+w,u-E*2/3,f-B*2/3,vn.BOTTOM_RIGHT):new ar(n.left+n.width-E*2/3,n.top+n.height-B*2/3),this.bottomLeftBorderDoubleInnerBox=m>0||p>0?as(n.left+S*2/3,n.top+O,m-S*2/3,p-B*2/3,vn.BOTTOM_LEFT):new ar(n.left+S*2/3,n.top+n.height-B*2/3),this.topLeftBorderStroke=i>0||o>0?as(n.left+S/2,n.top+L/2,i-S/2,o-L/2,vn.TOP_LEFT):new ar(n.left+S/2,n.top+L/2),this.topRightBorderStroke=i>0||o>0?as(n.left+b,n.top+L/2,c-E/2,d-L/2,vn.TOP_RIGHT):new ar(n.left+n.width-E/2,n.top+L/2),this.bottomRightBorderStroke=u>0||f>0?as(n.left+k,n.top+w,u-E/2,f-B/2,vn.BOTTOM_RIGHT):new ar(n.left+n.width-E/2,n.top+n.height-B/2),this.bottomLeftBorderStroke=m>0||p>0?as(n.left+S/2,n.top+O,m-S/2,p-B/2,vn.BOTTOM_LEFT):new ar(n.left+S/2,n.top+n.height-B/2),this.topLeftBorderBox=i>0||o>0?as(n.left,n.top,i,o,vn.TOP_LEFT):new ar(n.left,n.top),this.topRightBorderBox=c>0||d>0?as(n.left+b,n.top,c,d,vn.TOP_RIGHT):new ar(n.left+n.width,n.top),this.bottomRightBorderBox=u>0||f>0?as(n.left+k,n.top+w,u,f,vn.BOTTOM_RIGHT):new ar(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=m>0||p>0?as(n.left,n.top+O,m,p,vn.BOTTOM_LEFT):new ar(n.left,n.top+n.height),this.topLeftPaddingBox=i>0||o>0?as(n.left+S,n.top+L,Math.max(0,i-S),Math.max(0,o-L),vn.TOP_LEFT):new ar(n.left+S,n.top+L),this.topRightPaddingBox=c>0||d>0?as(n.left+Math.min(b,n.width-E),n.top+L,b>n.width+E?0:Math.max(0,c-E),Math.max(0,d-L),vn.TOP_RIGHT):new ar(n.left+n.width-E,n.top+L),this.bottomRightPaddingBox=u>0||f>0?as(n.left+Math.min(k,n.width-S),n.top+Math.min(w,n.height-B),Math.max(0,u-E),Math.max(0,f-B),vn.BOTTOM_RIGHT):new ar(n.left+n.width-E,n.top+n.height-B),this.bottomLeftPaddingBox=m>0||p>0?as(n.left+S,n.top+Math.min(O,n.height-B),Math.max(0,m-S),Math.max(0,p-B),vn.BOTTOM_LEFT):new ar(n.left+S,n.top+n.height-B),this.topLeftContentBox=i>0||o>0?as(n.left+S+D,n.top+L+U,Math.max(0,i-(S+D)),Math.max(0,o-(L+U)),vn.TOP_LEFT):new ar(n.left+S+D,n.top+L+U),this.topRightContentBox=c>0||d>0?as(n.left+Math.min(b,n.width+S+D),n.top+L+U,b>n.width+S+D?0:c-S+D,d-(L+U),vn.TOP_RIGHT):new ar(n.left+n.width-(E+_),n.top+L+U),this.bottomRightContentBox=u>0||f>0?as(n.left+Math.min(k,n.width-(S+D)),n.top+Math.min(w,n.height+L+U),Math.max(0,u-(E+_)),f-(B+F),vn.BOTTOM_RIGHT):new ar(n.left+n.width-(E+_),n.top+n.height-(B+F)),this.bottomLeftContentBox=m>0||p>0?as(n.left+S+D,n.top+O,Math.max(0,m-(S+D)),p-(B+F),vn.BOTTOM_LEFT):new ar(n.left+S+D,n.top+n.height-(B+F))}return t}(),vn;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(vn||(vn={}));var as=function(t,e,r,n,s){var i=4*((Math.sqrt(2)-1)/3),o=r*i,l=n*i,c=t+r,d=e+n;switch(s){case vn.TOP_LEFT:return new a1(new ar(t,d),new ar(t,d-l),new ar(c-o,e),new ar(c,e));case vn.TOP_RIGHT:return new a1(new ar(t,e),new ar(t+o,e),new ar(c,d-l),new ar(c,d));case vn.BOTTOM_RIGHT:return new a1(new ar(c,e),new ar(c,e+l),new ar(t+o,d),new ar(t,d));case vn.BOTTOM_LEFT:default:return new a1(new ar(c,d),new ar(c-o,d),new ar(t,e+l),new ar(t,e))}},xb=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},cse=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},vb=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},dse=function(){function t(e,r,n){this.offsetX=e,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return t}(),i1=function(){function t(e,r){this.path=e,this.target=r,this.type=1}return t}(),Ase=function(){function t(e){this.opacity=e,this.type=2,this.target=6}return t}(),use=function(t){return t.type===0},nM=function(t){return t.type===1},hse=function(t){return t.type===2},FF=function(t,e){return t.length===e.length?t.some(function(r,n){return r===e[n]}):!1},fse=function(t,e,r,n,s){return t.map(function(i,o){switch(o){case 0:return i.add(e,r);case 1:return i.add(e+n,r);case 2:return i.add(e+n,r+s);case 3:return i.add(e,r+s)}return i})},sM=function(){function t(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t}(),aM=function(){function t(e,r){if(this.container=e,this.parent=r,this.effects=[],this.curves=new lse(this.container),this.container.styles.opacity<1&&this.effects.push(new Ase(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,s=this.container.bounds.top+this.container.styles.transformOrigin[1].number,i=this.container.styles.transform;this.effects.push(new dse(n,s,i))}if(this.container.styles.overflowX!==0){var o=xb(this.curves),l=vb(this.curves);FF(o,l)?this.effects.push(new i1(o,6)):(this.effects.push(new i1(o,2)),this.effects.push(new i1(l,4)))}}return t.prototype.getEffects=function(e){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,s=this.effects.slice(0);n;){var i=n.effects.filter(function(c){return!nM(c)});if(r||n.container.styles.position!==0||!n.parent){if(s.unshift.apply(s,i),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var o=xb(n.curves),l=vb(n.curves);FF(o,l)||s.unshift(new i1(l,6))}}else s.unshift.apply(s,i);n=n.parent}return s.filter(function(c){return ha(c.target,e)})},t}(),pE=function(t,e,r,n){t.container.elements.forEach(function(s){var i=ha(s.flags,4),o=ha(s.flags,2),l=new aM(s,t);ha(s.styles.display,2048)&&n.push(l);var c=ha(s.flags,8)?[]:n;if(i||o){var d=i||s.styles.isPositioned()?r:e,A=new sM(l);if(s.styles.isPositioned()||s.styles.opacity<1||s.styles.isTransformed()){var u=s.styles.zIndex.order;if(u<0){var f=0;d.negativeZIndex.some(function(m,p){return u>m.element.container.styles.zIndex.order?(f=p,!1):f>0}),d.negativeZIndex.splice(f,0,A)}else if(u>0){var h=0;d.positiveZIndex.some(function(m,p){return u>=m.element.container.styles.zIndex.order?(h=p+1,!1):h>0}),d.positiveZIndex.splice(h,0,A)}else d.zeroOrAutoZIndexOrTransformedOrOpacity.push(A)}else s.styles.isFloating()?d.nonPositionedFloats.push(A):d.nonPositionedInlineLevel.push(A);pE(l,A,i?A:r,c)}else s.styles.isInlineLevel()?e.inlineLevel.push(l):e.nonInlineLevel.push(l),pE(l,e,r,c);ha(s.flags,8)&&iM(s,c)})},iM=function(t,e){for(var r=t instanceof AE?t.start:1,n=t instanceof AE?t.reversed:!1,s=0;s<e.length;s++){var i=e[s];i.container instanceof HO&&typeof i.container.value=="number"&&i.container.value!==0&&(r=i.container.value),i.listValue=Jg(r,i.container.styles.listStyleType,!0),r+=n?-1:1}},mse=function(t){var e=new aM(t,null),r=new sM(e),n=[];return pE(e,r,r,n),iM(e.container,n),r},TF=function(t,e){switch(e){case 0:return Al(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return Al(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return Al(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return Al(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},pse=function(t,e){switch(e){case 0:return Al(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return Al(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return Al(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return Al(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},gse=function(t,e){switch(e){case 0:return Al(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return Al(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return Al(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return Al(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},xse=function(t,e){switch(e){case 0:return o1(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return o1(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return o1(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return o1(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},o1=function(t,e){var r=[];return ol(t)?r.push(t.subdivide(.5,!1)):r.push(t),ol(e)?r.push(e.subdivide(.5,!0)):r.push(e),r},Al=function(t,e,r,n){var s=[];return ol(t)?s.push(t.subdivide(.5,!1)):s.push(t),ol(r)?s.push(r.subdivide(.5,!0)):s.push(r),ol(n)?s.push(n.subdivide(.5,!0).reverse()):s.push(n),ol(e)?s.push(e.subdivide(.5,!1).reverse()):s.push(e),s},oM=function(t){var e=t.bounds,r=t.styles;return e.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},yb=function(t){var e=t.styles,r=t.bounds,n=zn(e.paddingLeft,r.width),s=zn(e.paddingRight,r.width),i=zn(e.paddingTop,r.width),o=zn(e.paddingBottom,r.width);return r.add(n+e.borderLeftWidth,i+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+n+s),-(e.borderTopWidth+e.borderBottomWidth+i+o))},vse=function(t,e){return t===0?e.bounds:t===2?yb(e):oM(e)},yse=function(t,e){return t===0?e.bounds:t===2?yb(e):oM(e)},_N=function(t,e,r){var n=vse(Gf(t.styles.backgroundOrigin,e),t),s=yse(Gf(t.styles.backgroundClip,e),t),i=bse(Gf(t.styles.backgroundSize,e),r,n),o=i[0],l=i[1],c=Cp(Gf(t.styles.backgroundPosition,e),n.width-o,n.height-l),d=wse(Gf(t.styles.backgroundRepeat,e),c,i,n,s),A=Math.round(n.left+c[0]),u=Math.round(n.top+c[1]);return[d,A,u,o,l]},Sf=function(t){return Pn(t)&&t.value===b0.AUTO},l1=function(t){return typeof t=="number"},bse=function(t,e,r){var n=e[0],s=e[1],i=e[2],o=t[0],l=t[1];if(!o)return[0,0];if(ta(o)&&l&&ta(l))return[zn(o,r.width),zn(l,r.height)];var c=l1(i);if(Pn(o)&&(o.value===b0.CONTAIN||o.value===b0.COVER)){if(l1(i)){var d=r.width/r.height;return d<i!=(o.value===b0.COVER)?[r.width,r.width/i]:[r.height*i,r.height]}return[r.width,r.height]}var A=l1(n),u=l1(s),f=A||u;if(Sf(o)&&(!l||Sf(l))){if(A&&u)return[n,s];if(!c&&!f)return[r.width,r.height];if(f&&c){var h=A?n:s*i,m=u?s:n/i;return[h,m]}var p=A?n:r.width,g=u?s:r.height;return[p,g]}if(c){var x=0,b=0;return ta(o)?x=zn(o,r.width):ta(l)&&(b=zn(l,r.height)),Sf(o)?x=b*i:(!l||Sf(l))&&(b=x/i),[x,b]}var w=null,k=null;if(ta(o)?w=zn(o,r.width):l&&ta(l)&&(k=zn(l,r.height)),w!==null&&(!l||Sf(l))&&(k=A&&u?w/n*s:r.height),k!==null&&Sf(o)&&(w=A&&u?k/s*n:r.width),w!==null&&k!==null)return[w,k];throw new Error("Unable to calculate background-size for element")},Gf=function(t,e){var r=t[e];return typeof r>"u"?t[0]:r},wse=function(t,e,r,n,s){var i=e[0],o=e[1],l=r[0],c=r[1];switch(t){case 2:return[new ar(Math.round(n.left),Math.round(n.top+o)),new ar(Math.round(n.left+n.width),Math.round(n.top+o)),new ar(Math.round(n.left+n.width),Math.round(c+n.top+o)),new ar(Math.round(n.left),Math.round(c+n.top+o))];case 3:return[new ar(Math.round(n.left+i),Math.round(n.top)),new ar(Math.round(n.left+i+l),Math.round(n.top)),new ar(Math.round(n.left+i+l),Math.round(n.height+n.top)),new ar(Math.round(n.left+i),Math.round(n.height+n.top))];case 1:return[new ar(Math.round(n.left+i),Math.round(n.top+o)),new ar(Math.round(n.left+i+l),Math.round(n.top+o)),new ar(Math.round(n.left+i+l),Math.round(n.top+o+c)),new ar(Math.round(n.left+i),Math.round(n.top+o+c))];default:return[new ar(Math.round(s.left),Math.round(s.top)),new ar(Math.round(s.left+s.width),Math.round(s.top)),new ar(Math.round(s.left+s.width),Math.round(s.height+s.top)),new ar(Math.round(s.left),Math.round(s.height+s.top))]}},Nse="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",PF="Hidden Text",Cse=function(){function t(e){this._data={},this._document=e}return t.prototype.parseMetrics=function(e,r){var n=this._document.createElement("div"),s=this._document.createElement("img"),i=this._document.createElement("span"),o=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),s.src=Nse,s.width=1,s.height=1,s.style.margin="0",s.style.padding="0",s.style.verticalAlign="baseline",i.style.fontFamily=e,i.style.fontSize=r,i.style.margin="0",i.style.padding="0",i.appendChild(this._document.createTextNode(PF)),n.appendChild(i),n.appendChild(s);var l=s.offsetTop-i.offsetTop+2;n.removeChild(i),n.appendChild(this._document.createTextNode(PF)),n.style.lineHeight="normal",s.style.verticalAlign="super";var c=s.offsetTop-n.offsetTop+2;return o.removeChild(n),{baseline:l,middle:c}},t.prototype.getMetrics=function(e,r){var n=e+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(e,r)),this._data[n]},t}(),lM=function(){function t(e,r){this.context=e,this.options=r}return t}(),_se=1e4,Ese=function(t){Jl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s._activeEffects=[],s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),n.canvas||(s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px"),s.fontMetrics=new Cse(document),s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.ctx.textBaseline="bottom",s._activeEffects=[],s.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),s}return e.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(s){return n.applyEffect(s)})},e.prototype.applyEffect=function(r){this.ctx.save(),hse(r)&&(this.ctx.globalAlpha=r.opacity),use(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),nM(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(r){return ji(this,void 0,void 0,function(){var n;return di(this,function(s){switch(s.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(r){return ji(this,void 0,void 0,function(){return di(this,function(n){switch(n.label){case 0:if(ha(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(r,n,s){var i=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+s);else{var o=JS(r.text);o.reduce(function(l,c){return i.ctx.fillText(c,l,r.bounds.top+s),l+i.ctx.measureText(c).width},r.bounds.left)}},e.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),s=kse(r.fontFamily).join(", "),i=Qx(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,i,s].join(" "),s,i]},e.prototype.renderTextNode=function(r,n){return ji(this,void 0,void 0,function(){var s,i,o,l,c,d,A,u,f=this;return di(this,function(h){return s=this.createFontStyle(n),i=s[0],o=s[1],l=s[2],this.ctx.font=i,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),d=c.baseline,A=c.middle,u=n.paintOrder,r.textBounds.forEach(function(m){u.forEach(function(p){switch(p){case 0:f.ctx.fillStyle=Na(n.color),f.renderTextWithLetterSpacing(m,n.letterSpacing,d);var g=n.textShadow;g.length&&m.text.trim().length&&(g.slice(0).reverse().forEach(function(x){f.ctx.shadowColor=Na(x.color),f.ctx.shadowOffsetX=x.offsetX.number*f.options.scale,f.ctx.shadowOffsetY=x.offsetY.number*f.options.scale,f.ctx.shadowBlur=x.blur.number,f.renderTextWithLetterSpacing(m,n.letterSpacing,d)}),f.ctx.shadowColor="",f.ctx.shadowOffsetX=0,f.ctx.shadowOffsetY=0,f.ctx.shadowBlur=0),n.textDecorationLine.length&&(f.ctx.fillStyle=Na(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(x){switch(x){case 1:f.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top+d),m.bounds.width,1);break;case 2:f.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top),m.bounds.width,1);break;case 3:f.ctx.fillRect(m.bounds.left,Math.ceil(m.bounds.top+A),m.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&m.text.trim().length&&(f.ctx.strokeStyle=Na(n.webkitTextStrokeColor),f.ctx.lineWidth=n.webkitTextStrokeWidth,f.ctx.lineJoin=window.chrome?"miter":"round",f.ctx.strokeText(m.text,m.bounds.left,m.bounds.top+d)),f.ctx.strokeStyle="",f.ctx.lineWidth=0,f.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(r,n,s){if(s&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var i=yb(r),o=vb(n);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(s,0,0,r.intrinsicWidth,r.intrinsicHeight,i.left,i.top,i.width,i.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(r){return ji(this,void 0,void 0,function(){var n,s,i,o,l,c,b,b,d,A,u,f,k,h,m,O,p,g,x,b,w,k,O;return di(this,function(L){switch(L.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,s=r.curves,i=n.styles,o=0,l=n.textNodes,L.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,i)]):[3,4];case 2:L.sent(),L.label=3;case 3:return o++,[3,1];case 4:if(!(n instanceof MO))return[3,8];L.label=5;case 5:return L.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return b=L.sent(),this.renderReplacedElement(n,s,b),[3,8];case 7:return L.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof QO&&this.renderReplacedElement(n,s,n.canvas),!(n instanceof VO))return[3,12];L.label=9;case 9:return L.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return b=L.sent(),this.renderReplacedElement(n,s,b),[3,12];case 11:return L.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof GO&&n.tree?(d=new e(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,d.render(n.tree)]):[3,14];case 13:A=L.sent(),n.width&&n.height&&this.ctx.drawImage(A,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),L.label=14;case 14:if(n instanceof XS&&(u=Math.min(n.bounds.width,n.bounds.height),n.type===fb?n.checked&&(this.ctx.save(),this.path([new ar(n.bounds.left+u*.39363,n.bounds.top+u*.79),new ar(n.bounds.left+u*.16,n.bounds.top+u*.5549),new ar(n.bounds.left+u*.27347,n.bounds.top+u*.44071),new ar(n.bounds.left+u*.39694,n.bounds.top+u*.5649),new ar(n.bounds.left+u*.72983,n.bounds.top+u*.23),new ar(n.bounds.left+u*.84,n.bounds.top+u*.34085),new ar(n.bounds.left+u*.39363,n.bounds.top+u*.79)]),this.ctx.fillStyle=Na(bF),this.ctx.fill(),this.ctx.restore()):n.type===mb&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+u/2,n.bounds.top+u/2,u/4,0,Math.PI*2,!0),this.ctx.fillStyle=Na(bF),this.ctx.fill(),this.ctx.restore())),Bse(n)&&n.value.length){switch(f=this.createFontStyle(i),k=f[0],h=f[1],m=this.fontMetrics.getMetrics(k,h).baseline,this.ctx.font=k,this.ctx.fillStyle=Na(i.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Ise(n.styles.textAlign),O=yb(n),p=0,n.styles.textAlign){case 1:p+=O.width/2;break;case 2:p+=O.width;break}g=O.add(p,0,0,-O.height/2+1),this.ctx.save(),this.path([new ar(O.left,O.top),new ar(O.left+O.width,O.top),new ar(O.left+O.width,O.top+O.height),new ar(O.left,O.top+O.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Jp(n.value,g),i.letterSpacing,m),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!ha(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(x=n.styles.listStyleImage,x.type!==0)return[3,18];b=void 0,w=x.url,L.label=15;case 15:return L.trys.push([15,17,,18]),[4,this.context.cache.match(w)];case 16:return b=L.sent(),this.ctx.drawImage(b,n.bounds.left-(b.width+10),n.bounds.top),[3,18];case 17:return L.sent(),this.context.logger.error("Error loading list-style-image "+w),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(k=this.createFontStyle(i)[0],this.ctx.font=k,this.ctx.fillStyle=Na(i.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",O=new jd(n.bounds.left,n.bounds.top+zn(n.styles.paddingTop,n.bounds.width),n.bounds.width,sF(i.lineHeight,i.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Jp(r.listValue,O),i.letterSpacing,sF(i.lineHeight,i.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),L.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(r){return ji(this,void 0,void 0,function(){var n,s,x,i,o,x,l,c,x,d,A,x,u,f,x,h,m,x,p,g,x;return di(this,function(b){switch(b.label){case 0:if(ha(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:b.sent(),n=0,s=r.negativeZIndex,b.label=2;case 2:return n<s.length?(x=s[n],[4,this.renderStack(x)]):[3,5];case 3:b.sent(),b.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:b.sent(),i=0,o=r.nonInlineLevel,b.label=7;case 7:return i<o.length?(x=o[i],[4,this.renderNode(x)]):[3,10];case 8:b.sent(),b.label=9;case 9:return i++,[3,7];case 10:l=0,c=r.nonPositionedFloats,b.label=11;case 11:return l<c.length?(x=c[l],[4,this.renderStack(x)]):[3,14];case 12:b.sent(),b.label=13;case 13:return l++,[3,11];case 14:d=0,A=r.nonPositionedInlineLevel,b.label=15;case 15:return d<A.length?(x=A[d],[4,this.renderStack(x)]):[3,18];case 16:b.sent(),b.label=17;case 17:return d++,[3,15];case 18:u=0,f=r.inlineLevel,b.label=19;case 19:return u<f.length?(x=f[u],[4,this.renderNode(x)]):[3,22];case 20:b.sent(),b.label=21;case 21:return u++,[3,19];case 22:h=0,m=r.zeroOrAutoZIndexOrTransformedOrOpacity,b.label=23;case 23:return h<m.length?(x=m[h],[4,this.renderStack(x)]):[3,26];case 24:b.sent(),b.label=25;case 25:return h++,[3,23];case 26:p=0,g=r.positiveZIndex,b.label=27;case 27:return p<g.length?(x=g[p],[4,this.renderStack(x)]):[3,30];case 28:b.sent(),b.label=29;case 29:return p++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},e.prototype.formatPath=function(r){var n=this;r.forEach(function(s,i){var o=ol(s)?s.start:s;i===0?n.ctx.moveTo(o.x,o.y):n.ctx.lineTo(o.x,o.y),ol(s)&&n.ctx.bezierCurveTo(s.startControl.x,s.startControl.y,s.endControl.x,s.endControl.y,s.end.x,s.end.y)})},e.prototype.renderRepeat=function(r,n,s,i){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(s,i),this.ctx.fill(),this.ctx.translate(-s,-i)},e.prototype.resizeImage=function(r,n,s){var i;if(r.width===n&&r.height===s)return r;var o=(i=this.canvas.ownerDocument)!==null&&i!==void 0?i:document,l=o.createElement("canvas");l.width=Math.max(1,n),l.height=Math.max(1,s);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,n,s),l},e.prototype.renderBackgroundImage=function(r){return ji(this,void 0,void 0,function(){var n,s,i,o,l,c;return di(this,function(d){switch(d.label){case 0:n=r.styles.backgroundImage.length-1,s=function(A){var u,f,h,U,ae,fe,D,X,B,m,U,ae,fe,D,X,p,g,x,b,w,k,O,L,E,B,S,U,_,F,D,X,ge,ae,fe,me,Z,ye,Ie,I,j,Q,T;return di(this,function(R){switch(R.label){case 0:if(A.type!==0)return[3,5];u=void 0,f=A.url,R.label=1;case 1:return R.trys.push([1,3,,4]),[4,i.context.cache.match(f)];case 2:return u=R.sent(),[3,4];case 3:return R.sent(),i.context.logger.error("Error loading background-image "+f),[3,4];case 4:return u&&(h=_N(r,n,[u.width,u.height,u.width/u.height]),U=h[0],ae=h[1],fe=h[2],D=h[3],X=h[4],B=i.ctx.createPattern(i.resizeImage(u,D,X),"repeat"),i.renderRepeat(U,B,ae,fe)),[3,6];case 5:ute(A)?(m=_N(r,n,[null,null,null]),U=m[0],ae=m[1],fe=m[2],D=m[3],X=m[4],p=ote(A.angle,D,X),g=p[0],x=p[1],b=p[2],w=p[3],k=p[4],O=document.createElement("canvas"),O.width=D,O.height=X,L=O.getContext("2d"),E=L.createLinearGradient(x,w,b,k),rF(A.stops,g).forEach(function(K){return E.addColorStop(K.stop,Na(K.color))}),L.fillStyle=E,L.fillRect(0,0,D,X),D>0&&X>0&&(B=i.ctx.createPattern(O,"repeat"),i.renderRepeat(U,B,ae,fe))):hte(A)&&(S=_N(r,n,[null,null,null]),U=S[0],_=S[1],F=S[2],D=S[3],X=S[4],ge=A.position.length===0?[$S]:A.position,ae=zn(ge[0],D),fe=zn(ge[ge.length-1],X),me=lte(A,ae,fe,D,X),Z=me[0],ye=me[1],Z>0&&ye>0&&(Ie=i.ctx.createRadialGradient(_+ae,F+fe,0,_+ae,F+fe,Z),rF(A.stops,Z*2).forEach(function(K){return Ie.addColorStop(K.stop,Na(K.color))}),i.path(U),i.ctx.fillStyle=Ie,Z!==ye?(I=r.bounds.left+.5*r.bounds.width,j=r.bounds.top+.5*r.bounds.height,Q=ye/Z,T=1/Q,i.ctx.save(),i.ctx.translate(I,j),i.ctx.transform(1,0,0,Q,0,0),i.ctx.translate(-I,-j),i.ctx.fillRect(_,T*(F-j)+j,D,X*T),i.ctx.restore()):i.ctx.fill())),R.label=6;case 6:return n--,[2]}})},i=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),d.label=1;case 1:return o<l.length?(c=l[o],[5,s(c)]):[3,4];case 2:d.sent(),d.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(r,n,s){return ji(this,void 0,void 0,function(){return di(this,function(i){return this.path(TF(s,n)),this.ctx.fillStyle=Na(r),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(r,n,s,i){return ji(this,void 0,void 0,function(){var o,l;return di(this,function(c){switch(c.label){case 0:return n<3?[4,this.renderSolidBorder(r,s,i)]:[3,2];case 1:return c.sent(),[2];case 2:return o=pse(i,s),this.path(o),this.ctx.fillStyle=Na(r),this.ctx.fill(),l=gse(i,s),this.path(l),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(r){return ji(this,void 0,void 0,function(){var n,s,i,o,l,c,d,A,u=this;return di(this,function(f){switch(f.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,s=!ZA(n.backgroundColor)||n.backgroundImage.length,i=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],o=Sse(Gf(n.backgroundClip,0),r.curves),s||n.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),ZA(n.backgroundColor)||(this.ctx.fillStyle=Na(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:f.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(h){u.ctx.save();var m=xb(r.curves),p=h.inset?0:_se,g=fse(m,-p+(h.inset?1:-1)*h.spread.number,(h.inset?1:-1)*h.spread.number,h.spread.number*(h.inset?-2:2),h.spread.number*(h.inset?-2:2));h.inset?(u.path(m),u.ctx.clip(),u.mask(g)):(u.mask(m),u.ctx.clip(),u.path(g)),u.ctx.shadowOffsetX=h.offsetX.number+p,u.ctx.shadowOffsetY=h.offsetY.number,u.ctx.shadowColor=Na(h.color),u.ctx.shadowBlur=h.blur.number,u.ctx.fillStyle=h.inset?Na(h.color):"rgba(0,0,0,1)",u.ctx.fill(),u.ctx.restore()}),f.label=2;case 2:l=0,c=0,d=i,f.label=3;case 3:return c<d.length?(A=d[c],A.style!==0&&!ZA(A.color)&&A.width>0?A.style!==2?[3,5]:[4,this.renderDashedDottedBorder(A.color,A.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return f.sent(),[3,11];case 5:return A.style!==3?[3,7]:[4,this.renderDashedDottedBorder(A.color,A.width,l,r.curves,3)];case 6:return f.sent(),[3,11];case 7:return A.style!==4?[3,9]:[4,this.renderDoubleBorder(A.color,A.width,l,r.curves)];case 8:return f.sent(),[3,11];case 9:return[4,this.renderSolidBorder(A.color,l,r.curves)];case 10:f.sent(),f.label=11;case 11:l++,f.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(r,n,s,i,o){return ji(this,void 0,void 0,function(){var l,c,d,A,u,f,h,m,p,g,x,b,w,k,O,L,O,L;return di(this,function(E){return this.ctx.save(),l=xse(i,s),c=TF(i,s),o===2&&(this.path(c),this.ctx.clip()),ol(c[0])?(d=c[0].start.x,A=c[0].start.y):(d=c[0].x,A=c[0].y),ol(c[1])?(u=c[1].end.x,f=c[1].end.y):(u=c[1].x,f=c[1].y),s===0||s===2?h=Math.abs(d-u):h=Math.abs(A-f),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),m=n<3?n*3:n*2,p=n<3?n*2:n,o===3&&(m=n,p=n),g=!0,h<=m*2?g=!1:h<=m*2+p?(x=h/(2*m+p),m*=x,p*=x):(b=Math.floor((h+p)/(m+p)),w=(h-b*m)/(b-1),k=(h-(b+1)*m)/b,p=k<=0||Math.abs(p-w)<Math.abs(p-k)?w:k),g&&(o===3?this.ctx.setLineDash([0,m+p]):this.ctx.setLineDash([m,p])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=Na(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(ol(c[0])&&(O=c[3],L=c[0],this.ctx.beginPath(),this.formatPath([new ar(O.end.x,O.end.y),new ar(L.start.x,L.start.y)]),this.ctx.stroke()),ol(c[1])&&(O=c[1],L=c[2],this.ctx.beginPath(),this.formatPath([new ar(O.end.x,O.end.y),new ar(L.start.x,L.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(r){return ji(this,void 0,void 0,function(){var n;return di(this,function(s){switch(s.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Na(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=mse(r),[4,this.renderStack(n)];case 1:return s.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(lM),Bse=function(t){return t instanceof qO||t instanceof KO?!0:t instanceof XS&&t.type!==mb&&t.type!==fb},Sse=function(t,e){switch(t){case 0:return xb(e);case 2:return cse(e);case 1:default:return vb(e)}},Ise=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},jse=["-apple-system","system-ui"],kse=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(e){return jse.indexOf(e)===-1}):t},Fse=function(t){Jl(e,t);function e(r,n){var s=t.call(this,r,n)||this;return s.canvas=n.canvas?n.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),s.options=n,s.canvas.width=Math.floor(n.width*n.scale),s.canvas.height=Math.floor(n.height*n.scale),s.canvas.style.width=n.width+"px",s.canvas.style.height=n.height+"px",s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-n.x,-n.y),s.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),s}return e.prototype.render=function(r){return ji(this,void 0,void 0,function(){var n,s;return di(this,function(i){switch(i.label){case 0:return n=dE(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,Tse(n)];case 1:return s=i.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Na(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(s,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(lM),Tse=function(t){return new Promise(function(e,r){var n=new Image;n.onload=function(){e(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Pse=function(){function t(e){var r=e.id,n=e.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Mv([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Mv([this.id,this.getTime()+"ms"],e))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Mv([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Mv([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},t.instances={},t}(),Rse=function(){function t(e,r){var n;this.windowBounds=r,this.instanceName="#"+t.instanceCount++,this.logger=new Pse({id:this.instanceName,enabled:e.logging}),this.cache=(n=e.cache)!==null&&n!==void 0?n:new tse(this,e)}return t.instanceCount=1,t}(),Yh=function(t,e){return e===void 0&&(e={}),Dse(t,e)};typeof window<"u"&&rM.setContext(window);var Dse=function(t,e){return ji(void 0,void 0,void 0,function(){var r,n,s,i,o,l,c,d,A,u,f,h,m,p,g,x,b,w,k,O,E,L,E,B,S,U,_,F,D,X,ge,ae,fe,me,Z,ye,Ie,I,j,Q;return di(this,function(T){switch(T.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=t.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return s={allowTaint:(B=e.allowTaint)!==null&&B!==void 0?B:!1,imageTimeout:(S=e.imageTimeout)!==null&&S!==void 0?S:15e3,proxy:e.proxy,useCORS:(U=e.useCORS)!==null&&U!==void 0?U:!1},i=W_({logging:(_=e.logging)!==null&&_!==void 0?_:!0,cache:e.cache},s),o={windowWidth:(F=e.windowWidth)!==null&&F!==void 0?F:n.innerWidth,windowHeight:(D=e.windowHeight)!==null&&D!==void 0?D:n.innerHeight,scrollX:(X=e.scrollX)!==null&&X!==void 0?X:n.pageXOffset,scrollY:(ge=e.scrollY)!==null&&ge!==void 0?ge:n.pageYOffset},l=new jd(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new Rse(i,l),d=(ae=e.foreignObjectRendering)!==null&&ae!==void 0?ae:!1,A={allowTaint:(fe=e.allowTaint)!==null&&fe!==void 0?fe:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:d,copyStyles:d},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),u=new jF(c,t,A),f=u.clonedReferenceElement,f?[4,u.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return h=T.sent(),m=YS(f)||Une(f)?fZ(f.ownerDocument):R2(c,f),p=m.width,g=m.height,x=m.left,b=m.top,w=Lse(c,f,e.backgroundColor),k={canvas:e.canvas,backgroundColor:w,scale:(Z=(me=e.scale)!==null&&me!==void 0?me:n.devicePixelRatio)!==null&&Z!==void 0?Z:1,x:((ye=e.x)!==null&&ye!==void 0?ye:0)+x,y:((Ie=e.y)!==null&&Ie!==void 0?Ie:0)+b,width:(I=e.width)!==null&&I!==void 0?I:Math.ceil(p),height:(j=e.height)!==null&&j!==void 0?j:Math.ceil(g)},d?(c.logger.debug("Document cloned, using foreign object rendering"),E=new Fse(c,k),[4,E.render(f)]):[3,3];case 2:return O=T.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+x+","+b+" with size "+p+"x"+g+" using computed rendering"),c.logger.debug("Starting DOM parsing"),L=zO(c,f),w===L.styles.backgroundColor&&(L.styles.backgroundColor=gd.TRANSPARENT),c.logger.debug("Starting renderer for element at "+k.x+","+k.y+" with size "+k.width+"x"+k.height),E=new Ese(c,k),[4,E.render(L)];case 4:O=T.sent(),T.label=5;case 5:return(!((Q=e.removeContainer)!==null&&Q!==void 0)||Q)&&(jF.destroy(h)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,O]}})})},Lse=function(t,e,r){var n=e.ownerDocument,s=n.documentElement?zp(t,getComputedStyle(n.documentElement).backgroundColor):gd.TRANSPARENT,i=n.body?zp(t,getComputedStyle(n.body).backgroundColor):gd.TRANSPARENT,o=typeof r=="string"?zp(t,r):r===null?gd.TRANSPARENT:4294967295;return e===n.documentElement?ZA(s)?ZA(i)?o:i:s:o};const ZS=Object.freeze(Object.defineProperty({__proto__:null,default:Yh},Symbol.toStringTag,{value:"Module"})),Use="modulepreload",Ose=function(t){return"/"+t},RF={},xd=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=Ose(c),c in RF)return;RF[c]=!0;const d=c.endsWith(".css"),A=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${A}`))return;const u=document.createElement("link");if(u.rel=d?"stylesheet":Use,d||(u.as="script"),u.crossOrigin="",u.href=c,l&&u.setAttribute("nonce",l),document.head.appendChild(u),d)return new Promise((f,h)=>{u.addEventListener("load",f),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};function Sn(t){"@babel/helpers - typeof";return Sn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sn(t)}var $l=Uint8Array,Io=Uint16Array,eI=Int32Array,tI=new $l([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rI=new $l([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),DF=new $l([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),cM=function(t,e){for(var r=new Io(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var s=new eI(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)s[i]=i-r[n]<<5|n;return{b:r,r:s}},dM=cM(tI,2),Mse=dM.b,gE=dM.r;Mse[28]=258,gE[258]=28;var Qse=cM(rI,0),LF=Qse.r,xE=new Io(32768);for(var ts=0;ts<32768;++ts){var cA=(ts&43690)>>1|(ts&21845)<<1;cA=(cA&52428)>>2|(cA&13107)<<2,cA=(cA&61680)>>4|(cA&3855)<<4,xE[ts]=((cA&65280)>>8|(cA&255)<<8)>>1}var Yp=function(t,e,r){for(var n=t.length,s=0,i=new Io(e);s<n;++s)t[s]&&++i[t[s]-1];var o=new Io(e);for(s=1;s<e;++s)o[s]=o[s-1]+i[s-1]<<1;var l;if(r){l=new Io(1<<e);var c=15-e;for(s=0;s<n;++s)if(t[s])for(var d=s<<4|t[s],A=e-t[s],u=o[t[s]-1]++<<A,f=u|(1<<A)-1;u<=f;++u)l[xE[u]>>c]=d}else for(l=new Io(n),s=0;s<n;++s)t[s]&&(l[s]=xE[o[t[s]-1]++]>>15-t[s]);return l},Rh=new $l(288);for(var ts=0;ts<144;++ts)Rh[ts]=8;for(var ts=144;ts<256;++ts)Rh[ts]=9;for(var ts=256;ts<280;++ts)Rh[ts]=7;for(var ts=280;ts<288;++ts)Rh[ts]=8;var bb=new $l(32);for(var ts=0;ts<32;++ts)bb[ts]=5;var Vse=Yp(Rh,9,0),Hse=Yp(bb,5,0),AM=function(t){return(t+7)/8|0},Kse=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new $l(t.subarray(e,r))},Wc=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},tp=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},EN=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var s=r.length,i=r.slice();if(!s)return{t:hM,l:0};if(s==1){var o=new $l(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(O,L){return O.f-L.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],d=0,A=1,u=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};A!=s-1;)l=r[r[d].f<r[u].f?d++:u++],c=r[d!=A&&r[d].f<r[u].f?d++:u++],r[A++]={s:-1,f:l.f+c.f,l,r:c};for(var f=i[0].s,n=1;n<s;++n)i[n].s>f&&(f=i[n].s);var h=new Io(f+1),m=vE(r[A-1],h,0);if(m>e){var n=0,p=0,g=m-e,x=1<<g;for(i.sort(function(L,E){return h[E.s]-h[L.s]||L.f-E.f});n<s;++n){var b=i[n].s;if(h[b]>e)p+=x-(1<<m-h[b]),h[b]=e;else break}for(p>>=g;p>0;){var w=i[n].s;h[w]<e?p-=1<<e-h[w]++-1:++n}for(;n>=0&&p;--n){var k=i[n].s;h[k]==e&&(--h[k],++p)}m=e}return{t:new $l(h),l:m}},vE=function(t,e,r){return t.s==-1?Math.max(vE(t.l,e,r+1),vE(t.r,e,r+1)):e[t.s]=r},UF=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Io(++e),n=0,s=t[0],i=1,o=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==s&&l!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(s),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(s);i=1,s=t[l]}return{c:r.subarray(0,n),n:e}},rp=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},uM=function(t,e,r){var n=r.length,s=AM(e+2);t[s]=n&255,t[s+1]=n>>8,t[s+2]=t[s]^255,t[s+3]=t[s+1]^255;for(var i=0;i<n;++i)t[s+i+4]=r[i];return(s+4+n)*8},OF=function(t,e,r,n,s,i,o,l,c,d,A){Wc(e,A++,r),++s[256];for(var u=EN(s,15),f=u.t,h=u.l,m=EN(i,15),p=m.t,g=m.l,x=UF(f),b=x.c,w=x.n,k=UF(p),O=k.c,L=k.n,E=new Io(19),B=0;B<b.length;++B)++E[b[B]&31];for(var B=0;B<O.length;++B)++E[O[B]&31];for(var S=EN(E,7),U=S.t,_=S.l,F=19;F>4&&!U[DF[F-1]];--F);var D=d+5<<3,X=rp(s,Rh)+rp(i,bb)+o,ge=rp(s,f)+rp(i,p)+o+14+3*F+rp(E,U)+2*E[16]+3*E[17]+7*E[18];if(c>=0&&D<=X&&D<=ge)return uM(e,A,t.subarray(c,c+d));var ae,fe,me,Z;if(Wc(e,A,1+(ge<X)),A+=2,ge<X){ae=Yp(f,h,0),fe=f,me=Yp(p,g,0),Z=p;var ye=Yp(U,_,0);Wc(e,A,w-257),Wc(e,A+5,L-1),Wc(e,A+10,F-4),A+=14;for(var B=0;B<F;++B)Wc(e,A+3*B,U[DF[B]]);A+=3*F;for(var Ie=[b,O],I=0;I<2;++I)for(var j=Ie[I],B=0;B<j.length;++B){var Q=j[B]&31;Wc(e,A,ye[Q]),A+=U[Q],Q>15&&(Wc(e,A,j[B]>>5&127),A+=j[B]>>12)}}else ae=Vse,fe=Rh,me=Hse,Z=bb;for(var B=0;B<l;++B){var T=n[B];if(T>255){var Q=T>>18&31;tp(e,A,ae[Q+257]),A+=fe[Q+257],Q>7&&(Wc(e,A,T>>23&31),A+=tI[Q]);var R=T&31;tp(e,A,me[R]),A+=Z[R],R>3&&(tp(e,A,T>>5&8191),A+=rI[R])}else tp(e,A,ae[T]),A+=fe[T]}return tp(e,A,ae[256]),A+fe[256]},qse=new eI([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),hM=new $l(0),Gse=function(t,e,r,n,s,i){var o=i.z||t.length,l=new $l(n+o+5*(1+Math.ceil(o/7e3))+s),c=l.subarray(n,l.length-s),d=i.l,A=(i.r||0)&7;if(e){A&&(c[0]=i.r>>3);for(var u=qse[e-1],f=u>>13,h=u&8191,m=(1<<r)-1,p=i.p||new Io(32768),g=i.h||new Io(m+1),x=Math.ceil(r/3),b=2*x,w=function(ee){return(t[ee]^t[ee+1]<<x^t[ee+2]<<b)&m},k=new eI(25e3),O=new Io(288),L=new Io(32),E=0,B=0,S=i.i||0,U=0,_=i.w||0,F=0;S+2<o;++S){var D=w(S),X=S&32767,ge=g[D];if(p[X]=ge,g[D]=X,_<=S){var ae=o-S;if((E>7e3||U>24576)&&(ae>423||!d)){A=OF(t,c,0,k,O,L,B,U,F,S-F,A),U=E=B=0,F=S;for(var fe=0;fe<286;++fe)O[fe]=0;for(var fe=0;fe<30;++fe)L[fe]=0}var me=2,Z=0,ye=h,Ie=X-ge&32767;if(ae>2&&D==w(S-Ie))for(var I=Math.min(f,ae)-1,j=Math.min(32767,S),Q=Math.min(258,ae);Ie<=j&&--ye&&X!=ge;){if(t[S+me]==t[S+me-Ie]){for(var T=0;T<Q&&t[S+T]==t[S+T-Ie];++T);if(T>me){if(me=T,Z=Ie,T>I)break;for(var R=Math.min(Ie,T-2),K=0,fe=0;fe<R;++fe){var M=S-Ie+fe&32767,re=p[M],de=M-re&32767;de>K&&(K=de,ge=M)}}}X=ge,ge=p[X],Ie+=X-ge&32767}if(Z){k[U++]=268435456|gE[me]<<18|LF[Z];var le=gE[me]&31,q=LF[Z]&31;B+=tI[le]+rI[q],++O[257+le],++L[q],_=S+me,++E}else k[U++]=t[S],++O[t[S]]}}for(S=Math.max(S,_);S<o;++S)k[U++]=t[S],++O[t[S]];A=OF(t,c,d,k,O,L,B,U,F,S-F,A),d||(i.r=A&7|c[A/8|0]<<3,A-=7,i.h=g,i.p=p,i.i=S,i.w=_)}else{for(var S=i.w||0;S<o+d;S+=65535){var Se=S+65535;Se>=o&&(c[A/8|0]=d,Se=o),A=uM(c,A+1,t.subarray(S,Se))}i.i=o}return Kse(l,0,n+AM(A)+s)},fM=function(){var t=1,e=0;return{p:function(r){for(var n=t,s=e,i=r.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)s+=n+=r[o];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}t=n,e=s},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},$se=function(t,e,r,n,s){if(!s&&(s={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),o=new $l(i.length+t.length);o.set(i),o.set(t,i.length),t=o,s.w=i.length}return Gse(t,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,s)},mM=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},zse=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var s=fM();s.p(e.dictionary),mM(t,2,s.d())}};function yE(t,e){e||(e={});var r=fM();r.p(t);var n=$se(t,e,e.dictionary?6:2,4);return zse(n,e),mM(n,n.length-4,r.d()),n}var Wse=typeof TextDecoder<"u"&&new TextDecoder,Jse=0;try{Wse.decode(hM,{stream:!0}),Jse=1}catch{}function Xse(t){if(Array.isArray(t))return t}function Yse(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(t)).next,e!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(A){d=!0,s=A}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function MF(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Zse(t,e){if(t){if(typeof t=="string")return MF(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?MF(t,e):void 0}}function eae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QF(t,e){return Xse(t)||Yse(t,e)||Zse(t,e)||eae()}function VF(t,e="utf8"){return new TextDecoder(e).decode(t)}const tae=new TextEncoder;function rae(t){return tae.encode(t)}const nae=1024*8,sae=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),BN={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class nI{constructor(e=nae,r={}){Nn(this,"buffer");Nn(this,"byteLength");Nn(this,"byteOffset");Nn(this,"length");Nn(this,"offset");Nn(this,"lastWrittenByte");Nn(this,"littleEndian");Nn(this,"_data");Nn(this,"_mark");Nn(this,"_marks");let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const s=r.offset?r.offset>>>0:0,i=e.byteLength-s;let o=s;(ArrayBuffer.isView(e)||e instanceof nI)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+s),e=e.buffer),n?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=e,this.length=i,this.byteLength=i,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,i),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,r){const n=BN[r].BYTES_PER_ELEMENT*e,s=this.byteOffset+this.offset,i=this.buffer.slice(s,s+n);if(this.littleEndian===sae&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(s,s+n));l.reverse();const c=new BN[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new BN[r](i);return this.offset+=n,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let r="";for(let n=0;n<e;n++)r+=this.readChar();return r}readUtf8(e=1){return VF(this.readBytes(e))}decodeText(e=1,r="utf8"){return VF(this.readBytes(e),r)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let r=0;r<e.length;r++)this._data.setUint8(this.offset++,e[r]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let r=0;r<e.length;r++)this.writeUint8(e.charCodeAt(r));return this}writeUtf8(e){return this.writeBytes(rae(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function dm(t){let e=t.length;for(;--e>=0;)t[e]=0}const aae=3,iae=258,pM=29,oae=256,lae=oae+1+pM,gM=30,cae=512,dae=new Array((lae+2)*2);dm(dae);const Aae=new Array(gM*2);dm(Aae);const uae=new Array(cae);dm(uae);const hae=new Array(iae-aae+1);dm(hae);const fae=new Array(pM);dm(fae);const mae=new Array(gM);dm(mae);const pae=(t,e,r,n)=>{let s=t&65535|0,i=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+e[n++]|0,i=i+s|0;while(--o);s%=65521,i%=65521}return s|i<<16|0};var bE=pae;const gae=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},xae=new Uint32Array(gae()),vae=(t,e,r,n)=>{const s=xae,i=n+r;t^=-1;for(let o=n;o<i;o++)t=t>>>8^s[(t^e[o])&255];return t^-1};var dc=vae,wE={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},xM={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const yae=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var bae=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)yae(r,n)&&(t[n]=r[n])}}return t},wae=t=>{let e=0;for(let n=0,s=t.length;n<s;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,s=0,i=t.length;n<i;n++){let o=t[n];r.set(o,s),s+=o.length}return r},vM={assign:bae,flattenChunks:wae};let yM=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{yM=!1}const Xg=new Uint8Array(256);for(let t=0;t<256;t++)Xg[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Xg[254]=Xg[254]=1;var Nae=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,s,i,o=t.length,l=0;for(s=0;s<o;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),i=0,s=0;i<l;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?e[i++]=r:r<2048?(e[i++]=192|r>>>6,e[i++]=128|r&63):r<65536?(e[i++]=224|r>>>12,e[i++]=128|r>>>6&63,e[i++]=128|r&63):(e[i++]=240|r>>>18,e[i++]=128|r>>>12&63,e[i++]=128|r>>>6&63,e[i++]=128|r&63);return e};const Cae=(t,e)=>{if(e<65534&&t.subarray&&yM)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var _ae=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,s;const i=new Array(r*2);for(s=0,n=0;n<r;){let o=t[n++];if(o<128){i[s++]=o;continue}let l=Xg[o];if(l>4){i[s++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|t[n++]&63,l--;if(l>1){i[s++]=65533;continue}o<65536?i[s++]=o:(o-=65536,i[s++]=55296|o>>10&1023,i[s++]=56320|o&1023)}return Cae(i,s)},Eae=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+Xg[t[r]]>e?r:e},NE={string2buf:Nae,buf2string:_ae,utf8border:Eae};function Bae(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Sae=Bae;const c1=16209,Iae=16191;var jae=function(e,r){let n,s,i,o,l,c,d,A,u,f,h,m,p,g,x,b,w,k,O,L,E,B,S,U;const _=e.state;n=e.next_in,S=e.input,s=n+(e.avail_in-5),i=e.next_out,U=e.output,o=i-(r-e.avail_out),l=i+(e.avail_out-257),c=_.dmax,d=_.wsize,A=_.whave,u=_.wnext,f=_.window,h=_.hold,m=_.bits,p=_.lencode,g=_.distcode,x=(1<<_.lenbits)-1,b=(1<<_.distbits)-1;e:do{m<15&&(h+=S[n++]<<m,m+=8,h+=S[n++]<<m,m+=8),w=p[h&x];t:for(;;){if(k=w>>>24,h>>>=k,m-=k,k=w>>>16&255,k===0)U[i++]=w&65535;else if(k&16){O=w&65535,k&=15,k&&(m<k&&(h+=S[n++]<<m,m+=8),O+=h&(1<<k)-1,h>>>=k,m-=k),m<15&&(h+=S[n++]<<m,m+=8,h+=S[n++]<<m,m+=8),w=g[h&b];r:for(;;){if(k=w>>>24,h>>>=k,m-=k,k=w>>>16&255,k&16){if(L=w&65535,k&=15,m<k&&(h+=S[n++]<<m,m+=8,m<k&&(h+=S[n++]<<m,m+=8)),L+=h&(1<<k)-1,L>c){e.msg="invalid distance too far back",_.mode=c1;break e}if(h>>>=k,m-=k,k=i-o,L>k){if(k=L-k,k>A&&_.sane){e.msg="invalid distance too far back",_.mode=c1;break e}if(E=0,B=f,u===0){if(E+=d-k,k<O){O-=k;do U[i++]=f[E++];while(--k);E=i-L,B=U}}else if(u<k){if(E+=d+u-k,k-=u,k<O){O-=k;do U[i++]=f[E++];while(--k);if(E=0,u<O){k=u,O-=k;do U[i++]=f[E++];while(--k);E=i-L,B=U}}}else if(E+=u-k,k<O){O-=k;do U[i++]=f[E++];while(--k);E=i-L,B=U}for(;O>2;)U[i++]=B[E++],U[i++]=B[E++],U[i++]=B[E++],O-=3;O&&(U[i++]=B[E++],O>1&&(U[i++]=B[E++]))}else{E=i-L;do U[i++]=U[E++],U[i++]=U[E++],U[i++]=U[E++],O-=3;while(O>2);O&&(U[i++]=U[E++],O>1&&(U[i++]=U[E++]))}}else if(k&64){e.msg="invalid distance code",_.mode=c1;break e}else{w=g[(w&65535)+(h&(1<<k)-1)];continue r}break}}else if(k&64)if(k&32){_.mode=Iae;break e}else{e.msg="invalid literal/length code",_.mode=c1;break e}else{w=p[(w&65535)+(h&(1<<k)-1)];continue t}break}}while(n<s&&i<l);O=m>>3,n-=O,m-=O<<3,h&=(1<<m)-1,e.next_in=n,e.next_out=i,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=i<l?257+(l-i):257-(i-l),_.hold=h,_.bits=m};const If=15,HF=852,KF=592,qF=0,SN=1,GF=2,kae=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Fae=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Tae=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Pae=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Rae=(t,e,r,n,s,i,o,l)=>{const c=l.bits;let d=0,A=0,u=0,f=0,h=0,m=0,p=0,g=0,x=0,b=0,w,k,O,L,E,B=null,S;const U=new Uint16Array(If+1),_=new Uint16Array(If+1);let F=null,D,X,ge;for(d=0;d<=If;d++)U[d]=0;for(A=0;A<n;A++)U[e[r+A]]++;for(h=c,f=If;f>=1&&U[f]===0;f--);if(h>f&&(h=f),f===0)return s[i++]=1<<24|64<<16|0,s[i++]=1<<24|64<<16|0,l.bits=1,0;for(u=1;u<f&&U[u]===0;u++);for(h<u&&(h=u),g=1,d=1;d<=If;d++)if(g<<=1,g-=U[d],g<0)return-1;if(g>0&&(t===qF||f!==1))return-1;for(_[1]=0,d=1;d<If;d++)_[d+1]=_[d]+U[d];for(A=0;A<n;A++)e[r+A]!==0&&(o[_[e[r+A]]++]=A);if(t===qF?(B=F=o,S=20):t===SN?(B=kae,F=Fae,S=257):(B=Tae,F=Pae,S=0),b=0,A=0,d=u,E=i,m=h,p=0,O=-1,x=1<<h,L=x-1,t===SN&&x>HF||t===GF&&x>KF)return 1;for(;;){D=d-p,o[A]+1<S?(X=0,ge=o[A]):o[A]>=S?(X=F[o[A]-S],ge=B[o[A]-S]):(X=96,ge=0),w=1<<d-p,k=1<<m,u=k;do k-=w,s[E+(b>>p)+k]=D<<24|X<<16|ge|0;while(k!==0);for(w=1<<d-1;b&w;)w>>=1;if(w!==0?(b&=w-1,b+=w):b=0,A++,--U[d]===0){if(d===f)break;d=e[r+o[A]]}if(d>h&&(b&L)!==O){for(p===0&&(p=h),E+=u,m=d-p,g=1<<m;m+p<f&&(g-=U[m+p],!(g<=0));)m++,g<<=1;if(x+=1<<m,t===SN&&x>HF||t===GF&&x>KF)return 1;O=b&L,s[O]=h<<24|m<<16|E-i|0}}return b!==0&&(s[E+b]=d-p<<24|64<<16|0),l.bits=h,0};var Zp=Rae;const Dae=0,bM=1,wM=2,{Z_FINISH:$F,Z_BLOCK:Lae,Z_TREES:d1,Z_OK:Dh,Z_STREAM_END:Uae,Z_NEED_DICT:Oae,Z_STREAM_ERROR:gl,Z_DATA_ERROR:NM,Z_MEM_ERROR:CM,Z_BUF_ERROR:Mae,Z_DEFLATED:zF}=xM,q2=16180,WF=16181,JF=16182,XF=16183,YF=16184,ZF=16185,eT=16186,tT=16187,rT=16188,nT=16189,wb=16190,Jc=16191,IN=16192,sT=16193,jN=16194,aT=16195,iT=16196,oT=16197,lT=16198,A1=16199,u1=16200,cT=16201,dT=16202,AT=16203,uT=16204,hT=16205,kN=16206,fT=16207,mT=16208,is=16209,_M=16210,EM=16211,Qae=852,Vae=592,Hae=15,Kae=Hae,pT=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function qae(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Zh=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<q2||e.mode>EM?1:0},BM=t=>{if(Zh(t))return gl;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=q2,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Qae),e.distcode=e.distdyn=new Int32Array(Vae),e.sane=1,e.back=-1,Dh},SM=t=>{if(Zh(t))return gl;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,BM(t)},IM=(t,e)=>{let r;if(Zh(t))return gl;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?gl:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,SM(t))},jM=(t,e)=>{if(!t)return gl;const r=new qae;t.state=r,r.strm=t,r.window=null,r.mode=q2;const n=IM(t,e);return n!==Dh&&(t.state=null),n},Gae=t=>jM(t,Kae);let gT=!0,FN,TN;const $ae=t=>{if(gT){FN=new Int32Array(512),TN=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Zp(bM,t.lens,0,288,FN,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Zp(wM,t.lens,0,32,TN,0,t.work,{bits:5}),gT=!1}t.lencode=FN,t.lenbits=9,t.distcode=TN,t.distbits=5},kM=(t,e,r,n)=>{let s;const i=t.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(e.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>n&&(s=n),i.window.set(e.subarray(r-n,r-n+s),i.wnext),n-=s,n?(i.window.set(e.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0},zae=(t,e)=>{let r,n,s,i,o,l,c,d,A,u,f,h,m,p,g=0,x,b,w,k,O,L,E,B;const S=new Uint8Array(4);let U,_;const F=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Zh(t)||!t.output||!t.input&&t.avail_in!==0)return gl;r=t.state,r.mode===Jc&&(r.mode=IN),o=t.next_out,s=t.output,c=t.avail_out,i=t.next_in,n=t.input,l=t.avail_in,d=r.hold,A=r.bits,u=l,f=c,B=Dh;e:for(;;)switch(r.mode){case q2:if(r.wrap===0){r.mode=IN;break}for(;A<16;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,S[0]=d&255,S[1]=d>>>8&255,r.check=dc(r.check,S,2,0),d=0,A=0,r.mode=WF;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){t.msg="incorrect header check",r.mode=is;break}if((d&15)!==zF){t.msg="unknown compression method",r.mode=is;break}if(d>>>=4,A-=4,E=(d&15)+8,r.wbits===0&&(r.wbits=E),E>15||E>r.wbits){t.msg="invalid window size",r.mode=is;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=d&512?nT:Jc,d=0,A=0;break;case WF:for(;A<16;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}if(r.flags=d,(r.flags&255)!==zF){t.msg="unknown compression method",r.mode=is;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=is;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(S[0]=d&255,S[1]=d>>>8&255,r.check=dc(r.check,S,2,0)),d=0,A=0,r.mode=JF;case JF:for(;A<32;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(S[0]=d&255,S[1]=d>>>8&255,S[2]=d>>>16&255,S[3]=d>>>24&255,r.check=dc(r.check,S,4,0)),d=0,A=0,r.mode=XF;case XF:for(;A<16;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(S[0]=d&255,S[1]=d>>>8&255,r.check=dc(r.check,S,2,0)),d=0,A=0,r.mode=YF;case YF:if(r.flags&1024){for(;A<16;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(S[0]=d&255,S[1]=d>>>8&255,r.check=dc(r.check,S,2,0)),d=0,A=0}else r.head&&(r.head.extra=null);r.mode=ZF;case ZF:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(E=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+h),E)),r.flags&512&&r.wrap&4&&(r.check=dc(r.check,n,h,i)),l-=h,i+=h,r.length-=h),r.length))break e;r.length=0,r.mode=eT;case eT:if(r.flags&2048){if(l===0)break e;h=0;do E=n[i+h++],r.head&&E&&r.length<65536&&(r.head.name+=String.fromCharCode(E));while(E&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=dc(r.check,n,h,i)),l-=h,i+=h,E)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=tT;case tT:if(r.flags&4096){if(l===0)break e;h=0;do E=n[i+h++],r.head&&E&&r.length<65536&&(r.head.comment+=String.fromCharCode(E));while(E&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=dc(r.check,n,h,i)),l-=h,i+=h,E)break e}else r.head&&(r.head.comment=null);r.mode=rT;case rT:if(r.flags&512){for(;A<16;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}if(r.wrap&4&&d!==(r.check&65535)){t.msg="header crc mismatch",r.mode=is;break}d=0,A=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Jc;break;case nT:for(;A<32;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}t.adler=r.check=pT(d),d=0,A=0,r.mode=wb;case wb:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=i,t.avail_in=l,r.hold=d,r.bits=A,Oae;t.adler=r.check=1,r.mode=Jc;case Jc:if(e===Lae||e===d1)break e;case IN:if(r.last){d>>>=A&7,A-=A&7,r.mode=kN;break}for(;A<3;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}switch(r.last=d&1,d>>>=1,A-=1,d&3){case 0:r.mode=sT;break;case 1:if($ae(r),r.mode=A1,e===d1){d>>>=2,A-=2;break e}break;case 2:r.mode=iT;break;case 3:t.msg="invalid block type",r.mode=is}d>>>=2,A-=2;break;case sT:for(d>>>=A&7,A-=A&7;A<32;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}if((d&65535)!==(d>>>16^65535)){t.msg="invalid stored block lengths",r.mode=is;break}if(r.length=d&65535,d=0,A=0,r.mode=jN,e===d1)break e;case jN:r.mode=aT;case aT:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;s.set(n.subarray(i,i+h),o),l-=h,i+=h,c-=h,o+=h,r.length-=h;break}r.mode=Jc;break;case iT:for(;A<14;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}if(r.nlen=(d&31)+257,d>>>=5,A-=5,r.ndist=(d&31)+1,d>>>=5,A-=5,r.ncode=(d&15)+4,d>>>=4,A-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=is;break}r.have=0,r.mode=oT;case oT:for(;r.have<r.ncode;){for(;A<3;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}r.lens[F[r.have++]]=d&7,d>>>=3,A-=3}for(;r.have<19;)r.lens[F[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,U={bits:r.lenbits},B=Zp(Dae,r.lens,0,19,r.lencode,0,r.work,U),r.lenbits=U.bits,B){t.msg="invalid code lengths set",r.mode=is;break}r.have=0,r.mode=lT;case lT:for(;r.have<r.nlen+r.ndist;){for(;g=r.lencode[d&(1<<r.lenbits)-1],x=g>>>24,b=g>>>16&255,w=g&65535,!(x<=A);){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}if(w<16)d>>>=x,A-=x,r.lens[r.have++]=w;else{if(w===16){for(_=x+2;A<_;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}if(d>>>=x,A-=x,r.have===0){t.msg="invalid bit length repeat",r.mode=is;break}E=r.lens[r.have-1],h=3+(d&3),d>>>=2,A-=2}else if(w===17){for(_=x+3;A<_;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}d>>>=x,A-=x,E=0,h=3+(d&7),d>>>=3,A-=3}else{for(_=x+7;A<_;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}d>>>=x,A-=x,E=0,h=11+(d&127),d>>>=7,A-=7}if(r.have+h>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=is;break}for(;h--;)r.lens[r.have++]=E}}if(r.mode===is)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=is;break}if(r.lenbits=9,U={bits:r.lenbits},B=Zp(bM,r.lens,0,r.nlen,r.lencode,0,r.work,U),r.lenbits=U.bits,B){t.msg="invalid literal/lengths set",r.mode=is;break}if(r.distbits=6,r.distcode=r.distdyn,U={bits:r.distbits},B=Zp(wM,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,U),r.distbits=U.bits,B){t.msg="invalid distances set",r.mode=is;break}if(r.mode=A1,e===d1)break e;case A1:r.mode=u1;case u1:if(l>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=i,t.avail_in=l,r.hold=d,r.bits=A,jae(t,f),o=t.next_out,s=t.output,c=t.avail_out,i=t.next_in,n=t.input,l=t.avail_in,d=r.hold,A=r.bits,r.mode===Jc&&(r.back=-1);break}for(r.back=0;g=r.lencode[d&(1<<r.lenbits)-1],x=g>>>24,b=g>>>16&255,w=g&65535,!(x<=A);){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}if(b&&!(b&240)){for(k=x,O=b,L=w;g=r.lencode[L+((d&(1<<k+O)-1)>>k)],x=g>>>24,b=g>>>16&255,w=g&65535,!(k+x<=A);){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}d>>>=k,A-=k,r.back+=k}if(d>>>=x,A-=x,r.back+=x,r.length=w,b===0){r.mode=hT;break}if(b&32){r.back=-1,r.mode=Jc;break}if(b&64){t.msg="invalid literal/length code",r.mode=is;break}r.extra=b&15,r.mode=cT;case cT:if(r.extra){for(_=r.extra;A<_;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,A-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=dT;case dT:for(;g=r.distcode[d&(1<<r.distbits)-1],x=g>>>24,b=g>>>16&255,w=g&65535,!(x<=A);){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}if(!(b&240)){for(k=x,O=b,L=w;g=r.distcode[L+((d&(1<<k+O)-1)>>k)],x=g>>>24,b=g>>>16&255,w=g&65535,!(k+x<=A);){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}d>>>=k,A-=k,r.back+=k}if(d>>>=x,A-=x,r.back+=x,b&64){t.msg="invalid distance code",r.mode=is;break}r.offset=w,r.extra=b&15,r.mode=AT;case AT:if(r.extra){for(_=r.extra;A<_;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,A-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=is;break}r.mode=uT;case uT:if(c===0)break e;if(h=f-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=is;break}h>r.wnext?(h-=r.wnext,m=r.wsize-h):m=r.wnext-h,h>r.length&&(h=r.length),p=r.window}else p=s,m=o-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do s[o++]=p[m++];while(--h);r.length===0&&(r.mode=u1);break;case hT:if(c===0)break e;s[o++]=r.length,c--,r.mode=u1;break;case kN:if(r.wrap){for(;A<32;){if(l===0)break e;l--,d|=n[i++]<<A,A+=8}if(f-=c,t.total_out+=f,r.total+=f,r.wrap&4&&f&&(t.adler=r.check=r.flags?dc(r.check,s,f,o-f):bE(r.check,s,f,o-f)),f=c,r.wrap&4&&(r.flags?d:pT(d))!==r.check){t.msg="incorrect data check",r.mode=is;break}d=0,A=0}r.mode=fT;case fT:if(r.wrap&&r.flags){for(;A<32;){if(l===0)break e;l--,d+=n[i++]<<A,A+=8}if(r.wrap&4&&d!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=is;break}d=0,A=0}r.mode=mT;case mT:B=Uae;break e;case is:B=NM;break e;case _M:return CM;case EM:default:return gl}return t.next_out=o,t.avail_out=c,t.next_in=i,t.avail_in=l,r.hold=d,r.bits=A,(r.wsize||f!==t.avail_out&&r.mode<is&&(r.mode<kN||e!==$F))&&kM(t,t.output,t.next_out,f-t.avail_out),u-=t.avail_in,f-=t.avail_out,t.total_in+=u,t.total_out+=f,r.total+=f,r.wrap&4&&f&&(t.adler=r.check=r.flags?dc(r.check,s,f,t.next_out-f):bE(r.check,s,f,t.next_out-f)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Jc?128:0)+(r.mode===A1||r.mode===jN?256:0),(u===0&&f===0||e===$F)&&B===Dh&&(B=Mae),B},Wae=t=>{if(Zh(t))return gl;let e=t.state;return e.window&&(e.window=null),t.state=null,Dh},Jae=(t,e)=>{if(Zh(t))return gl;const r=t.state;return r.wrap&2?(r.head=e,e.done=!1,Dh):gl},Xae=(t,e)=>{const r=e.length;let n,s,i;return Zh(t)||(n=t.state,n.wrap!==0&&n.mode!==wb)?gl:n.mode===wb&&(s=1,s=bE(s,e,r,0),s!==n.check)?NM:(i=kM(t,e,r,r),i?(n.mode=_M,CM):(n.havedict=1,Dh))};var Yae=SM,Zae=IM,eie=BM,tie=Gae,rie=jM,nie=zae,sie=Wae,aie=Jae,iie=Xae,oie="pako inflate (from Nodeca project)",sd={inflateReset:Yae,inflateReset2:Zae,inflateResetKeep:eie,inflateInit:tie,inflateInit2:rie,inflate:nie,inflateEnd:sie,inflateGetHeader:aie,inflateSetDictionary:iie,inflateInfo:oie};function lie(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var cie=lie;const FM=Object.prototype.toString,{Z_NO_FLUSH:die,Z_FINISH:Aie,Z_OK:Yg,Z_STREAM_END:PN,Z_NEED_DICT:RN,Z_STREAM_ERROR:uie,Z_DATA_ERROR:xT,Z_MEM_ERROR:hie}=xM;function Vx(t){this.options=vM.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Sae,this.strm.avail_out=0;let r=sd.inflateInit2(this.strm,e.windowBits);if(r!==Yg)throw new Error(wE[r]);if(this.header=new cie,sd.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=NE.string2buf(e.dictionary):FM.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=sd.inflateSetDictionary(this.strm,e.dictionary),r!==Yg)))throw new Error(wE[r])}Vx.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let i,o,l;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?Aie:die,FM.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),i=sd.inflate(r,o),i===RN&&s&&(i=sd.inflateSetDictionary(r,s),i===Yg?i=sd.inflate(r,o):i===xT&&(i=RN));r.avail_in>0&&i===PN&&r.state.wrap>0&&t[r.next_in]!==0;)sd.inflateReset(r),i=sd.inflate(r,o);switch(i){case uie:case xT:case RN:case hie:return this.onEnd(i),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||i===PN))if(this.options.to==="string"){let c=NE.utf8border(r.output,r.next_out),d=r.next_out-c,A=NE.buf2string(r.output,c);r.next_out=d,r.avail_out=n-d,d&&r.output.set(r.output.subarray(c,c+d),0),this.onData(A)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===Yg&&l===0)){if(i===PN)return i=sd.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Vx.prototype.onData=function(t){this.chunks.push(t)};Vx.prototype.onEnd=function(t){t===Yg&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=vM.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function fie(t,e){const r=new Vx(e);if(r.push(t),r.err)throw r.msg||wE[r.err];return r.result}var mie=Vx,pie=fie,gie={Inflate:mie,inflate:pie};const{Inflate:xie,inflate:vie}=gie;var vT=xie,yie=vie;const TM=[];for(let t=0;t<256;t++){let e=t;for(let r=0;r<8;r++)e&1?e=3988292384^e>>>1:e=e>>>1;TM[t]=e}const yT=4294967295;function bie(t,e,r){let n=t;for(let s=0;s<r;s++)n=TM[(n^e[s])&255]^n>>>8;return n}function wie(t,e){return(bie(yT,t,e)^yT)>>>0}function bT(t,e,r){const n=t.readUint32(),s=wie(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(s!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${s}`)}function PM(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function RM(t,e,r,n){let s=0;for(;s<n;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+e[s-n]&255}function DM(t,e,r,n){let s=0;if(r.length===0)for(;s<n;s++)e[s]=t[s];else for(;s<n;s++)e[s]=t[s]+r[s]&255}function LM(t,e,r,n,s){let i=0;if(r.length===0){for(;i<s;i++)e[i]=t[i];for(;i<n;i++)e[i]=t[i]+(e[i-s]>>1)&255}else{for(;i<s;i++)e[i]=t[i]+(r[i]>>1)&255;for(;i<n;i++)e[i]=t[i]+(e[i-s]+r[i]>>1)&255}}function UM(t,e,r,n,s){let i=0;if(r.length===0){for(;i<s;i++)e[i]=t[i];for(;i<n;i++)e[i]=t[i]+e[i-s]&255}else{for(;i<s;i++)e[i]=t[i]+r[i]&255;for(;i<n;i++)e[i]=t[i]+Nie(e[i-s],r[i],r[i-s])&255}}function Nie(t,e,r){const n=t+e-r,s=Math.abs(n-t),i=Math.abs(n-e),o=Math.abs(n-r);return s<=i&&s<=o?t:i<=o?e:r}function Cie(t,e,r,n,s,i){switch(t){case 0:PM(e,r,s);break;case 1:RM(e,r,s,i);break;case 2:DM(e,r,n,s);break;case 3:LM(e,r,n,s,i);break;case 4:UM(e,r,n,s,i);break;default:throw new Error(`Unsupported filter: ${t}`)}}const _ie=new Uint16Array([255]),Eie=new Uint8Array(_ie.buffer),Bie=Eie[0]===255;function Sie(t){const{data:e,width:r,height:n,channels:s,depth:i}=t,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(i/8)*s,c=new Uint8Array(n*r*l);let d=0;for(let A=0;A<7;A++){const u=o[A],f=Math.ceil((r-u.x)/u.xStep),h=Math.ceil((n-u.y)/u.yStep);if(f<=0||h<=0)continue;const m=f*l,p=new Uint8Array(m);for(let g=0;g<h;g++){const x=e[d++],b=e.subarray(d,d+m);d+=m;const w=new Uint8Array(m);Cie(x,b,w,p,m,l),p.set(w);for(let k=0;k<f;k++){const O=u.x+k*u.xStep,L=u.y+g*u.yStep;if(!(O>=r||L>=n))for(let E=0;E<l;E++)c[(L*r+O)*l+E]=w[k*l+E]}}}if(i===16){const A=new Uint16Array(c.buffer);if(Bie)for(let u=0;u<A.length;u++)A[u]=Iie(A[u]);return A}else return c}function Iie(t){return(t&255)<<8|t>>8&255}const jie=new Uint16Array([255]),kie=new Uint8Array(jie.buffer),Fie=kie[0]===255,Tie=new Uint8Array(0);function wT(t){const{data:e,width:r,height:n,channels:s,depth:i}=t,o=Math.ceil(i/8)*s,l=Math.ceil(i/8*s*r),c=new Uint8Array(n*l);let d=Tie,A=0,u,f;for(let h=0;h<n;h++){switch(u=e.subarray(A+1,A+1+l),f=c.subarray(h*l,(h+1)*l),e[A]){case 0:PM(u,f,l);break;case 1:RM(u,f,l,o);break;case 2:DM(u,f,d,l);break;case 3:LM(u,f,d,l,o);break;case 4:UM(u,f,d,l,o);break;default:throw new Error(`Unsupported filter: ${e[A]}`)}d=f,A+=l+1}if(i===16){const h=new Uint16Array(c.buffer);if(Fie)for(let m=0;m<h.length;m++)h[m]=Pie(h[m]);return h}else return c}function Pie(t){return(t&255)<<8|t>>8&255}const gy=Uint8Array.of(137,80,78,71,13,10,26,10);function NT(t){if(!Rie(t.readBytes(gy.length)))throw new Error("wrong PNG signature")}function Rie(t){if(t.length<gy.length)return!1;for(let e=0;e<gy.length;e++)if(t[e]!==gy[e])return!1;return!0}const Die="tEXt",Lie=0,OM=new TextDecoder("latin1");function Uie(t){if(Mie(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const Oie=/^[\u0000-\u00FF]*$/;function Mie(t){if(!Oie.test(t))throw new Error("invalid latin1 text")}function Qie(t,e,r){const n=MM(e);t[n]=Vie(e,r-n.length-1)}function MM(t){for(t.mark();t.readByte()!==Lie;);const e=t.offset;t.reset();const r=OM.decode(t.readBytes(e-t.offset-1));return t.skip(1),Uie(r),r}function Vie(t,e){return OM.decode(t.readBytes(e))}const xo={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},DN={UNKNOWN:-1,DEFLATE:0},CT={UNKNOWN:-1,ADAPTIVE:0},LN={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},h1={NONE:0,BACKGROUND:1,PREVIOUS:2},UN={SOURCE:0,OVER:1};class Hie extends nI{constructor(r,n={}){super(r);Nn(this,"_checkCrc");Nn(this,"_inflator");Nn(this,"_png");Nn(this,"_apng");Nn(this,"_end");Nn(this,"_hasPalette");Nn(this,"_palette");Nn(this,"_hasTransparency");Nn(this,"_transparency");Nn(this,"_compressionMethod");Nn(this,"_filterMethod");Nn(this,"_interlaceMethod");Nn(this,"_colorType");Nn(this,"_isAnimated");Nn(this,"_numberOfFrames");Nn(this,"_numberOfPlays");Nn(this,"_frames");Nn(this,"_writingDataChunks");const{checkCrc:s=!1}=n;this._checkCrc=s,this._inflator=new vT,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=DN.UNKNOWN,this._filterMethod=CT.UNKNOWN,this._interlaceMethod=LN.UNKNOWN,this._colorType=xo.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(NT(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(NT(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const s=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case Die:Qie(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?bT(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const s=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?bT(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=Kie(this.readUint8());const n=this.readUint8();this._colorType=n;let s;switch(n){case xo.GREYSCALE:s=1;break;case xo.TRUECOLOUR:s=3;break;case xo.INDEXED_COLOUR:s=1;break;case xo.GREYSCALE_ALPHA:s=2;break;case xo.TRUECOLOUR_ALPHA:s=4;break;case xo.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==DN.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let i=0;i<n;i++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,s=this.offset+this.byteOffset;if(s+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case xo.GREYSCALE:case xo.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case xo.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const s=this.readByte();this._palette[n].push(s)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case xo.UNKNOWN:case xo.GREYSCALE_ALPHA:case xo.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=MM(this),s=this.readUint8();if(s!==DN.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const i=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:yie(i)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:n,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=wT({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)n.data=s.data;else{const i=this._apng.frames.at(r-1);this.disposeFrame(s,i,n),this.addFrameDataToCanvas(n,s)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,s){switch(r.disposeOp){case h1.NONE:break;case h1.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let o=0;o<this._png.width;o++){const l=(i*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)s.data[l+c]=0}break;case h1.PREVIOUS:s.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const s=1<<this._png.depth,i=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,d=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:d}};switch(n.blendOp){case UN.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=i(o,l);for(let A=0;A<this._png.channels;A++)r.data[c+A]=n.data[d+A]}break;case UN.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=i(o,l);for(let A=0;A<this._png.channels;A++){const u=n.data[d+this._png.channels-1]/s,f=A%(this._png.channels-1)===0?1:n.data[d+A],h=Math.floor(u*f+(1-u)*r.data[c+A]);r.data[c+A]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==CT.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===LN.NO_INTERLACE)this._png.data=wT({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===LN.ADAM7)this._png.data=Sie({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:h1.NONE,blendOp:UN.SOURCE,data:r}),this._inflator=new vT,this._writingDataChunks=!1}}function Kie(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var _T;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(_T||(_T={}));function qie(t,e){return new Hie(t,e).decode()}var kr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function ON(){kr.console&&typeof kr.console.log=="function"&&kr.console.log.apply(kr.console,arguments)}var Vn={log:ON,warn:function(t){kr.console&&(typeof kr.console.warn=="function"?kr.console.warn.apply(kr.console,arguments):ON.call(null,arguments))},error:function(t){kr.console&&(typeof kr.console.error=="function"?kr.console.error.apply(kr.console,arguments):ON(t))}};function MN(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){zu(n.response,e,r)},n.onerror=function(){Vn.error("could not download file")},n.send()}function ET(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function f1(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var zu=kr.saveAs||((typeof window>"u"?"undefined":Sn(window))!=="object"||window!==kr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=kr.URL||kr.webkitURL,s=document.createElement("a");e=e||t.name||"download",s.download=e,s.rel="noopener",typeof t=="string"?(s.href=t,s.origin!==location.origin?ET(s.href)?MN(t,e,r):f1(s,s.target="_blank"):f1(s)):(s.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){f1(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(ET(t))MN(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){f1(n)})}else navigator.msSaveOrOpenBlob(function(s,i){return i===void 0?i={autoBom:!1}:Sn(i)!=="object"&&(Vn.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return MN(t,e,r);var s=t.type==="application/octet-stream",i=/constructor/i.test(kr.HTMLElement)||kr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&i)&&(typeof FileReader>"u"?"undefined":Sn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var A=l.result;A=o?A:A.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=A:location=A,n=null},l.readAsDataURL(t)}else{var c=kr.URL||kr.webkitURL,d=c.createObjectURL(t);n?n.location=d:location.href=d,n=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function QM(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,i=r[n].process,o=s.exec(t);o&&(e=i(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}var xy=kr.atob.bind(kr),BT=kr.btoa.bind(kr);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function QN(t,e){var r=t[0],n=t[1],s=t[2],i=t[3];r=si(r,n,s,i,e[0],7,-680876936),i=si(i,r,n,s,e[1],12,-389564586),s=si(s,i,r,n,e[2],17,606105819),n=si(n,s,i,r,e[3],22,-1044525330),r=si(r,n,s,i,e[4],7,-176418897),i=si(i,r,n,s,e[5],12,1200080426),s=si(s,i,r,n,e[6],17,-1473231341),n=si(n,s,i,r,e[7],22,-45705983),r=si(r,n,s,i,e[8],7,1770035416),i=si(i,r,n,s,e[9],12,-1958414417),s=si(s,i,r,n,e[10],17,-42063),n=si(n,s,i,r,e[11],22,-1990404162),r=si(r,n,s,i,e[12],7,1804603682),i=si(i,r,n,s,e[13],12,-40341101),s=si(s,i,r,n,e[14],17,-1502002290),r=ai(r,n=si(n,s,i,r,e[15],22,1236535329),s,i,e[1],5,-165796510),i=ai(i,r,n,s,e[6],9,-1069501632),s=ai(s,i,r,n,e[11],14,643717713),n=ai(n,s,i,r,e[0],20,-373897302),r=ai(r,n,s,i,e[5],5,-701558691),i=ai(i,r,n,s,e[10],9,38016083),s=ai(s,i,r,n,e[15],14,-660478335),n=ai(n,s,i,r,e[4],20,-405537848),r=ai(r,n,s,i,e[9],5,568446438),i=ai(i,r,n,s,e[14],9,-1019803690),s=ai(s,i,r,n,e[3],14,-187363961),n=ai(n,s,i,r,e[8],20,1163531501),r=ai(r,n,s,i,e[13],5,-1444681467),i=ai(i,r,n,s,e[2],9,-51403784),s=ai(s,i,r,n,e[7],14,1735328473),r=ii(r,n=ai(n,s,i,r,e[12],20,-1926607734),s,i,e[5],4,-378558),i=ii(i,r,n,s,e[8],11,-2022574463),s=ii(s,i,r,n,e[11],16,1839030562),n=ii(n,s,i,r,e[14],23,-35309556),r=ii(r,n,s,i,e[1],4,-1530992060),i=ii(i,r,n,s,e[4],11,1272893353),s=ii(s,i,r,n,e[7],16,-155497632),n=ii(n,s,i,r,e[10],23,-1094730640),r=ii(r,n,s,i,e[13],4,681279174),i=ii(i,r,n,s,e[0],11,-358537222),s=ii(s,i,r,n,e[3],16,-722521979),n=ii(n,s,i,r,e[6],23,76029189),r=ii(r,n,s,i,e[9],4,-640364487),i=ii(i,r,n,s,e[12],11,-421815835),s=ii(s,i,r,n,e[15],16,530742520),r=oi(r,n=ii(n,s,i,r,e[2],23,-995338651),s,i,e[0],6,-198630844),i=oi(i,r,n,s,e[7],10,1126891415),s=oi(s,i,r,n,e[14],15,-1416354905),n=oi(n,s,i,r,e[5],21,-57434055),r=oi(r,n,s,i,e[12],6,1700485571),i=oi(i,r,n,s,e[3],10,-1894986606),s=oi(s,i,r,n,e[10],15,-1051523),n=oi(n,s,i,r,e[1],21,-2054922799),r=oi(r,n,s,i,e[8],6,1873313359),i=oi(i,r,n,s,e[15],10,-30611744),s=oi(s,i,r,n,e[6],15,-1560198380),n=oi(n,s,i,r,e[13],21,1309151649),r=oi(r,n,s,i,e[4],6,-145523070),i=oi(i,r,n,s,e[11],10,-1120210379),s=oi(s,i,r,n,e[2],15,718787259),n=oi(n,s,i,r,e[9],21,-343485551),t[0]=DA(r,t[0]),t[1]=DA(n,t[1]),t[2]=DA(s,t[2]),t[3]=DA(i,t[3])}function G2(t,e,r,n,s,i){return e=DA(DA(e,t),DA(n,i)),DA(e<<s|e>>>32-s,r)}function si(t,e,r,n,s,i,o){return G2(e&r|~e&n,t,e,s,i,o)}function ai(t,e,r,n,s,i,o){return G2(e&n|r&~n,t,e,s,i,o)}function ii(t,e,r,n,s,i,o){return G2(e^r^n,t,e,s,i,o)}function oi(t,e,r,n,s,i,o){return G2(r^(e|~n),t,e,s,i,o)}function VM(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)QN(n,Gie(t.substring(e-64,e)));t=t.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)s[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(QN(n,s),e=0;e<16;e++)s[e]=0;return s[14]=8*r,QN(n,s),n}function Gie(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}var ST="0123456789abcdef".split("");function $ie(t){for(var e="",r=0;r<4;r++)e+=ST[t>>8*r+4&15]+ST[t>>8*r&15];return e}function zie(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function CE(t){return VM(t).map(zie).join("")}var Wie=function(t){for(var e=0;e<t.length;e++)t[e]=$ie(t[e]);return t.join("")}(VM("hello"))!="5d41402abc4b2a76b9719d911017c592";function DA(t,e){if(Wie){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function _E(t,e){var r,n,s,i;if(t!==r){for(var o=(s=t,i=1+(256/t.length|0),new Array(i+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var A=l[c];d=(d+A+o.charCodeAt(c))%256,l[c]=l[d],l[d]=A}r=t,n=l}else l=n;var u=e.length,f=0,h=0,m="";for(c=0;c<u;c++)h=(h+(A=l[f=(f+1)%256]))%256,l[f]=l[h],l[h]=A,o=l[(l[f]+l[h])%256],m+=String.fromCharCode(e.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var IT={print:4,modify:8,copy:16,"annot-forms":32};function $f(t,e,r,n){this.v=1,this.r=2;var s=192;t.forEach(function(l){if(IT.perm!==void 0)throw new Error("Invalid permission: "+l);s+=IT[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^s)),this.encryptionKey=CE(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=_E(this.encryptionKey,this.padding)}function zf(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var s=t.charCodeAt(n);e+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):t[n]}return e}function jT(t){if(Sn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var i=Math.random().toString(35);return e[r][i]=[n,!!s],i},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var i in e[r]){var o=e[r][i];try{o[0].apply(t,n)}catch(l){kr.console&&Vn.error("jsPDF PubSub Error",l.message,l)}o[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Zg(t){if(!(this instanceof Zg))return new Zg(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function HM(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function IA(t,e,r,n,s){if(!(this instanceof IA))return new IA(t,e,r,n,s);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,HM.call(this,n,s)}function ih(t,e,r,n,s){if(!(this instanceof ih))return new ih(t,e,r,n,s);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,HM.call(this,n,s)}function cr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],i=arguments[3],o=[],l=1,c=16,d="S",A=null;Sn(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,s=t.format||s,i=t.compress||t.compressPdf||i,(A=t.encryption||null)!==null&&(A.userPassword=A.userPassword||"",A.ownerPassword=A.ownerPassword||"",A.userPermissions=A.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),d=t.defaultPathOperation||"S"),o=t.filters||(i===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var u=t.putOnlyUsedFonts||!1,f={},h={internal:{},__private__:{}};h.__private__.PubSub=jT;var m="1.3",p=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(P){m=P};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return g};var x=h.__private__.getPageFormat=function(P){return g[P]};s=s||"a4";var b="compat",w="advanced",k=b;function O(){this.saveGraphicsState(),z(new et(ve,0,0,-ve,0,Ho()*ve).toString()+" cm"),this.setFontSize(this.getFontSize()/ve),d="n",k=w}function L(){this.restoreGraphicsState(),d="S",k=b}var E=h.__private__.combineFontStyleAndFontWeight=function(P,Ae){if(P=="bold"&&Ae=="normal"||P=="bold"&&Ae==400||P=="normal"&&Ae=="italic"||P=="bold"&&Ae=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Ae&&(P=Ae==400||Ae==="normal"?P==="italic"?"italic":"normal":Ae!=700&&Ae!=="bold"||P!=="normal"?(Ae==700?"bold":Ae)+""+P:"bold"),P};h.advancedAPI=function(P){var Ae=k===b;return Ae&&O.call(this),typeof P!="function"||(P(this),Ae&&L.call(this)),this},h.compatAPI=function(P){var Ae=k===w;return Ae&&L.call(this),typeof P!="function"||(P(this),Ae&&O.call(this)),this},h.isAdvancedAPI=function(){return k===w};var B,S=function(P){if(k!==w)throw new Error(P+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},U=h.roundToPrecision=h.__private__.roundToPrecision=function(P,Ae){var Ke=e||Ae;if(isNaN(P)||isNaN(Ke))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return P.toFixed(Ke).replace(/0+$/,"")};B=h.hpf=h.__private__.hpf=typeof c=="number"?function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return U(P,c)}:c==="smart"?function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return U(P,P>-1&&P<1?16:5)}:function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return U(P,16)};var _=h.f2=h.__private__.f2=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.f2");return U(P,2)},F=h.__private__.f3=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.f3");return U(P,3)},D=h.scale=h.__private__.scale=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.scale");return k===b?P*ve:k===w?P:void 0},X=function(P){return D(function(Ae){return k===b?Ho()-Ae:k===w?Ae:void 0}(P))};h.__private__.setPrecision=h.setPrecision=function(P){typeof parseInt(P,10)=="number"&&(e=parseInt(P,10))};var ge,ae="00000000000000000000000000000000",fe=h.__private__.getFileId=function(){return ae},me=h.__private__.setFileId=function(P){return ae=P!==void 0&&/^[a-fA-F0-9]{32}$/.test(P)?P.toUpperCase():ae.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),A!==null&&(Ln=new $f(A.userPermissions,A.userPassword,A.ownerPassword,ae)),ae};h.setFileId=function(P){return me(P),this},h.getFileId=function(){return fe()};var Z=h.__private__.convertDateToPDFDate=function(P){var Ae=P.getTimezoneOffset(),Ke=Ae<0?"+":"-",nt=Math.floor(Math.abs(Ae/60)),mt=Math.abs(Ae%60),St=[Ke,Q(nt),"'",Q(mt),"'"].join("");return["D:",P.getFullYear(),Q(P.getMonth()+1),Q(P.getDate()),Q(P.getHours()),Q(P.getMinutes()),Q(P.getSeconds()),St].join("")},ye=h.__private__.convertPDFDateToDate=function(P){var Ae=parseInt(P.substr(2,4),10),Ke=parseInt(P.substr(6,2),10)-1,nt=parseInt(P.substr(8,2),10),mt=parseInt(P.substr(10,2),10),St=parseInt(P.substr(12,2),10),Ft=parseInt(P.substr(14,2),10);return new Date(Ae,Ke,nt,mt,St,Ft,0)},Ie=h.__private__.setCreationDate=function(P){var Ae;if(P===void 0&&(P=new Date),P instanceof Date)Ae=Z(P);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(P))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Ae=P}return ge=Ae},I=h.__private__.getCreationDate=function(P){var Ae=ge;return P==="jsDate"&&(Ae=ye(ge)),Ae};h.setCreationDate=function(P){return Ie(P),this},h.getCreationDate=function(P){return I(P)};var j,Q=h.__private__.padd2=function(P){return("0"+parseInt(P)).slice(-2)},T=h.__private__.padd2Hex=function(P){return("00"+(P=P.toString())).substr(P.length)},R=0,K=[],M=[],re=0,de=[],le=[],q=!1,Se=M;h.__private__.setCustomOutputDestination=function(P){q=!0,Se=P};var ee=function(P){q||(Se=P)};h.__private__.resetCustomOutputDestination=function(){q=!1,Se=M};var z=h.__private__.out=function(P){return P=P.toString(),re+=P.length+1,Se.push(P),Se},te=h.__private__.write=function(P){return z(arguments.length===1?P.toString():Array.prototype.join.call(arguments," "))},Ne=h.__private__.getArrayBuffer=function(P){for(var Ae=P.length,Ke=new ArrayBuffer(Ae),nt=new Uint8Array(Ke);Ae--;)nt[Ae]=P.charCodeAt(Ae);return Ke},Y=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return Y};var we=t.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(P){return we=k===w?P/ve:P,this};var Pe,Qe=h.__private__.getFontSize=h.getFontSize=function(){return k===b?we:we*ve},tt=t.R2L||!1;h.__private__.setR2L=h.setR2L=function(P){return tt=P,this},h.__private__.getR2L=h.getR2L=function(){return tt};var ot,dt=h.__private__.setZoomMode=function(P){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(P))Pe=P;else if(isNaN(P)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(P)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+P+'" is not recognized.');Pe=P}else Pe=parseInt(P,10)};h.__private__.getZoomMode=function(){return Pe};var vt,lt=h.__private__.setPageMode=function(P){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(P)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+P+'" is not recognized.');ot=P};h.__private__.getPageMode=function(){return ot};var Ue=h.__private__.setLayoutMode=function(P){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(P)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+P+'" is not recognized.');vt=P};h.__private__.getLayoutMode=function(){return vt},h.__private__.setDisplayMode=h.setDisplayMode=function(P,Ae,Ke){return dt(P),Ue(Ae),lt(Ke),this};var Xe={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(P){if(Object.keys(Xe).indexOf(P)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Xe[P]},h.__private__.getDocumentProperties=function(){return Xe},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(P){for(var Ae in Xe)Xe.hasOwnProperty(Ae)&&P[Ae]&&(Xe[Ae]=P[Ae]);return this},h.__private__.setDocumentProperty=function(P,Ae){if(Object.keys(Xe).indexOf(P)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Xe[P]=Ae};var xe,ve,ie,ze,rt,At={},Oe={},at=[],Ve={},G={},_e={},Me={},We=null,He=0,st=[],Ct=new jT(h),Xt=t.hotfixes||[],Ot={},tr={},Zt=[],et=function P(Ae,Ke,nt,mt,St,Ft){if(!(this instanceof P))return new P(Ae,Ke,nt,mt,St,Ft);isNaN(Ae)&&(Ae=1),isNaN(Ke)&&(Ke=0),isNaN(nt)&&(nt=0),isNaN(mt)&&(mt=1),isNaN(St)&&(St=0),isNaN(Ft)&&(Ft=0),this._matrix=[Ae,Ke,nt,mt,St,Ft]};Object.defineProperty(et.prototype,"sx",{get:function(){return this._matrix[0]},set:function(P){this._matrix[0]=P}}),Object.defineProperty(et.prototype,"shy",{get:function(){return this._matrix[1]},set:function(P){this._matrix[1]=P}}),Object.defineProperty(et.prototype,"shx",{get:function(){return this._matrix[2]},set:function(P){this._matrix[2]=P}}),Object.defineProperty(et.prototype,"sy",{get:function(){return this._matrix[3]},set:function(P){this._matrix[3]=P}}),Object.defineProperty(et.prototype,"tx",{get:function(){return this._matrix[4]},set:function(P){this._matrix[4]=P}}),Object.defineProperty(et.prototype,"ty",{get:function(){return this._matrix[5]},set:function(P){this._matrix[5]=P}}),Object.defineProperty(et.prototype,"a",{get:function(){return this._matrix[0]},set:function(P){this._matrix[0]=P}}),Object.defineProperty(et.prototype,"b",{get:function(){return this._matrix[1]},set:function(P){this._matrix[1]=P}}),Object.defineProperty(et.prototype,"c",{get:function(){return this._matrix[2]},set:function(P){this._matrix[2]=P}}),Object.defineProperty(et.prototype,"d",{get:function(){return this._matrix[3]},set:function(P){this._matrix[3]=P}}),Object.defineProperty(et.prototype,"e",{get:function(){return this._matrix[4]},set:function(P){this._matrix[4]=P}}),Object.defineProperty(et.prototype,"f",{get:function(){return this._matrix[5]},set:function(P){this._matrix[5]=P}}),Object.defineProperty(et.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(et.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(et.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(et.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),et.prototype.join=function(P){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(B).join(P)},et.prototype.multiply=function(P){var Ae=P.sx*this.sx+P.shy*this.shx,Ke=P.sx*this.shy+P.shy*this.sy,nt=P.shx*this.sx+P.sy*this.shx,mt=P.shx*this.shy+P.sy*this.sy,St=P.tx*this.sx+P.ty*this.shx+this.tx,Ft=P.tx*this.shy+P.ty*this.sy+this.ty;return new et(Ae,Ke,nt,mt,St,Ft)},et.prototype.decompose=function(){var P=this.sx,Ae=this.shy,Ke=this.shx,nt=this.sy,mt=this.tx,St=this.ty,Ft=Math.sqrt(P*P+Ae*Ae),lr=(P/=Ft)*Ke+(Ae/=Ft)*nt;Ke-=P*lr,nt-=Ae*lr;var fr=Math.sqrt(Ke*Ke+nt*nt);return lr/=fr,P*(nt/=fr)<Ae*(Ke/=fr)&&(P=-P,Ae=-Ae,lr=-lr,Ft=-Ft),{scale:new et(Ft,0,0,fr,0,0),translate:new et(1,0,0,1,mt,St),rotate:new et(P,Ae,-Ae,P,0,0),skew:new et(1,0,lr,1,0,0)}},et.prototype.toString=function(P){return this.join(" ")},et.prototype.inversed=function(){var P=this.sx,Ae=this.shy,Ke=this.shx,nt=this.sy,mt=this.tx,St=this.ty,Ft=1/(P*nt-Ae*Ke),lr=nt*Ft,fr=-Ae*Ft,Cr=-Ke*Ft,Tr=P*Ft;return new et(lr,fr,Cr,Tr,-lr*mt-Cr*St,-fr*mt-Tr*St)},et.prototype.applyToPoint=function(P){var Ae=P.x*this.sx+P.y*this.shx+this.tx,Ke=P.x*this.shy+P.y*this.sy+this.ty;return new Qo(Ae,Ke)},et.prototype.applyToRectangle=function(P){var Ae=this.applyToPoint(P),Ke=this.applyToPoint(new Qo(P.x+P.w,P.y+P.h));return new Hd(Ae.x,Ae.y,Ke.x-Ae.x,Ke.y-Ae.y)},et.prototype.clone=function(){var P=this.sx,Ae=this.shy,Ke=this.shx,nt=this.sy,mt=this.tx,St=this.ty;return new et(P,Ae,Ke,nt,mt,St)},h.Matrix=et;var Rt=h.matrixMult=function(P,Ae){return Ae.multiply(P)},er=new et(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=er;var Lt=function(P,Ae){if(!G[P]){var Ke=(Ae instanceof IA?"Sh":"P")+(Object.keys(Ve).length+1).toString(10);Ae.id=Ke,G[P]=Ke,Ve[Ke]=Ae,Ct.publish("addPattern",Ae)}};h.ShadingPattern=IA,h.TilingPattern=ih,h.addShadingPattern=function(P,Ae){return S("addShadingPattern()"),Lt(P,Ae),this},h.beginTilingPattern=function(P){S("beginTilingPattern()"),nc(P.boundingBox[0],P.boundingBox[1],P.boundingBox[2]-P.boundingBox[0],P.boundingBox[3]-P.boundingBox[1],P.matrix)},h.endTilingPattern=function(P,Ae){S("endTilingPattern()"),Ae.stream=le[j].join(`
`),Lt(P,Ae),Ct.publish("endTilingPattern",Ae),Zt.pop().restore()};var Vt,nr=h.__private__.newObject=function(){var P=Mt();return oe(P,!0),P},Mt=h.__private__.newObjectDeferred=function(){return R++,K[R]=function(){return re},R},oe=function(P,Ae){return Ae=typeof Ae=="boolean"&&Ae,K[P]=re,Ae&&z(P+" 0 obj"),P},J=h.__private__.newAdditionalObject=function(){var P={objId:Mt(),content:""};return de.push(P),P},ce=Mt(),pe=Mt(),Be=h.__private__.decodeColorString=function(P){var Ae=P.split(" ");if(Ae.length!==2||Ae[1]!=="g"&&Ae[1]!=="G")Ae.length!==5||Ae[4]!=="k"&&Ae[4]!=="K"||(Ae=[(1-Ae[0])*(1-Ae[3]),(1-Ae[1])*(1-Ae[3]),(1-Ae[2])*(1-Ae[3]),"r"]);else{var Ke=parseFloat(Ae[0]);Ae=[Ke,Ke,Ke,"r"]}for(var nt="#",mt=0;mt<3;mt++)nt+=("0"+Math.floor(255*parseFloat(Ae[mt])).toString(16)).slice(-2);return nt},De=h.__private__.encodeColorString=function(P){var Ae;typeof P=="string"&&(P={ch1:P});var Ke=P.ch1,nt=P.ch2,mt=P.ch3,St=P.ch4,Ft=P.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ke=="string"&&Ke.charAt(0)!=="#"){var lr=new QM(Ke);if(lr.ok)Ke=lr.toHex();else if(!/^\d*\.?\d*$/.test(Ke))throw new Error('Invalid color "'+Ke+'" passed to jsPDF.encodeColorString.')}if(typeof Ke=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ke)&&(Ke="#"+Ke[1]+Ke[1]+Ke[2]+Ke[2]+Ke[3]+Ke[3]),typeof Ke=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ke)){var fr=parseInt(Ke.substr(1),16);Ke=fr>>16&255,nt=fr>>8&255,mt=255&fr}if(nt===void 0||St===void 0&&Ke===nt&&nt===mt)Ae=typeof Ke=="string"?Ke+" "+Ft[0]:P.precision===2?_(Ke/255)+" "+Ft[0]:F(Ke/255)+" "+Ft[0];else if(St===void 0||Sn(St)==="object"){if(St&&!isNaN(St.a)&&St.a===0)return["1.","1.","1.",Ft[1]].join(" ");Ae=typeof Ke=="string"?[Ke,nt,mt,Ft[1]].join(" "):P.precision===2?[_(Ke/255),_(nt/255),_(mt/255),Ft[1]].join(" "):[F(Ke/255),F(nt/255),F(mt/255),Ft[1]].join(" ")}else Ae=typeof Ke=="string"?[Ke,nt,mt,St,Ft[2]].join(" "):P.precision===2?[_(Ke),_(nt),_(mt),_(St),Ft[2]].join(" "):[F(Ke),F(nt),F(mt),F(St),Ft[2]].join(" ");return Ae},se=h.__private__.getFilters=function(){return o},Fe=h.__private__.putStream=function(P){var Ae=(P=P||{}).data||"",Ke=P.filters||se(),nt=P.alreadyAppliedFilters||[],mt=P.addLength1||!1,St=Ae.length,Ft=P.objectId,lr=function(Es){return Es};if(A!==null&&Ft===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");A!==null&&(lr=Ln.encryptor(Ft,0));var fr={};Ke===!0&&(Ke=["FlateEncode"]);var Cr=P.additionalKeyValues||[],Tr=(fr=cr.API.processDataByFilters!==void 0?cr.API.processDataByFilters(Ae,Ke):{data:Ae,reverseChain:[]}).reverseChain+(Array.isArray(nt)?nt.join(" "):nt.toString());if(fr.data.length!==0&&(Cr.push({key:"Length",value:fr.data.length}),mt===!0&&Cr.push({key:"Length1",value:St})),Tr.length!=0)if(Tr.split("/").length-1==1)Cr.push({key:"Filter",value:Tr});else{Cr.push({key:"Filter",value:"["+Tr+"]"});for(var Zr=0;Zr<Cr.length;Zr+=1)if(Cr[Zr].key==="DecodeParms"){for(var gn=[],ms=0;ms<fr.reverseChain.split("/").length-1;ms+=1)gn.push("null");gn.push(Cr[Zr].value),Cr[Zr].value="["+gn.join(" ")+"]"}}z("<<");for(var yn=0;yn<Cr.length;yn++)z("/"+Cr[yn].key+" "+Cr[yn].value);z(">>"),fr.data.length!==0&&(z("stream"),z(lr(fr.data)),z("endstream"))},he=h.__private__.putPage=function(P){var Ae=P.number,Ke=P.data,nt=P.objId,mt=P.contentsObjId;oe(nt,!0),z("<</Type /Page"),z("/Parent "+P.rootDictionaryObjId+" 0 R"),z("/Resources "+P.resourceDictionaryObjId+" 0 R"),z("/MediaBox ["+parseFloat(B(P.mediaBox.bottomLeftX))+" "+parseFloat(B(P.mediaBox.bottomLeftY))+" "+B(P.mediaBox.topRightX)+" "+B(P.mediaBox.topRightY)+"]"),P.cropBox!==null&&z("/CropBox ["+B(P.cropBox.bottomLeftX)+" "+B(P.cropBox.bottomLeftY)+" "+B(P.cropBox.topRightX)+" "+B(P.cropBox.topRightY)+"]"),P.bleedBox!==null&&z("/BleedBox ["+B(P.bleedBox.bottomLeftX)+" "+B(P.bleedBox.bottomLeftY)+" "+B(P.bleedBox.topRightX)+" "+B(P.bleedBox.topRightY)+"]"),P.trimBox!==null&&z("/TrimBox ["+B(P.trimBox.bottomLeftX)+" "+B(P.trimBox.bottomLeftY)+" "+B(P.trimBox.topRightX)+" "+B(P.trimBox.topRightY)+"]"),P.artBox!==null&&z("/ArtBox ["+B(P.artBox.bottomLeftX)+" "+B(P.artBox.bottomLeftY)+" "+B(P.artBox.topRightX)+" "+B(P.artBox.topRightY)+"]"),typeof P.userUnit=="number"&&P.userUnit!==1&&z("/UserUnit "+P.userUnit),Ct.publish("putPage",{objId:nt,pageContext:st[Ae],pageNumber:Ae,page:Ke}),z("/Contents "+mt+" 0 R"),z(">>"),z("endobj");var St=Ke.join(`
`);return k===w&&(St+=`
Q`),oe(mt,!0),Fe({data:St,filters:se(),objectId:mt}),z("endobj"),nt},Re=h.__private__.putPages=function(){var P,Ae,Ke=[];for(P=1;P<=He;P++)st[P].objId=Mt(),st[P].contentsObjId=Mt();for(P=1;P<=He;P++)Ke.push(he({number:P,data:le[P],objId:st[P].objId,contentsObjId:st[P].contentsObjId,mediaBox:st[P].mediaBox,cropBox:st[P].cropBox,bleedBox:st[P].bleedBox,trimBox:st[P].trimBox,artBox:st[P].artBox,userUnit:st[P].userUnit,rootDictionaryObjId:ce,resourceDictionaryObjId:pe}));oe(ce,!0),z("<</Type /Pages");var nt="/Kids [";for(Ae=0;Ae<He;Ae++)nt+=Ke[Ae]+" 0 R ";z(nt+"]"),z("/Count "+He),z(">>"),z("endobj"),Ct.publish("postPutPages")},Ee=function(P){Ct.publish("putFont",{font:P,out:z,newObject:nr,putStream:Fe}),P.isAlreadyPutted!==!0&&(P.objectNumber=nr(),z("<<"),z("/Type /Font"),z("/BaseFont /"+zf(P.postScriptName)),z("/Subtype /Type1"),typeof P.encoding=="string"&&z("/Encoding /"+P.encoding),z("/FirstChar 32"),z("/LastChar 255"),z(">>"),z("endobj"))},Ze=function(P){P.objectNumber=nr();var Ae=[];Ae.push({key:"Type",value:"/XObject"}),Ae.push({key:"Subtype",value:"/Form"}),Ae.push({key:"BBox",value:"["+[B(P.x),B(P.y),B(P.x+P.width),B(P.y+P.height)].join(" ")+"]"}),Ae.push({key:"Matrix",value:"["+P.matrix.toString()+"]"});var Ke=P.pages[1].join(`
`);Fe({data:Ke,additionalKeyValues:Ae,objectId:P.objectNumber}),z("endobj")},Je=function(P,Ae){Ae||(Ae=21);var Ke=nr(),nt=function(Ft,lr){var fr,Cr=[],Tr=1/(lr-1);for(fr=0;fr<1;fr+=Tr)Cr.push(fr);if(Cr.push(1),Ft[0].offset!=0){var Zr={offset:0,color:Ft[0].color};Ft.unshift(Zr)}if(Ft[Ft.length-1].offset!=1){var gn={offset:1,color:Ft[Ft.length-1].color};Ft.push(gn)}for(var ms="",yn=0,Es=0;Es<Cr.length;Es++){for(fr=Cr[Es];fr>Ft[yn+1].offset;)yn++;var ps=Ft[yn].offset,Bs=(fr-ps)/(Ft[yn+1].offset-ps),gs=Ft[yn].color,Vi=Ft[yn+1].color;ms+=T(Math.round((1-Bs)*gs[0]+Bs*Vi[0]).toString(16))+T(Math.round((1-Bs)*gs[1]+Bs*Vi[1]).toString(16))+T(Math.round((1-Bs)*gs[2]+Bs*Vi[2]).toString(16))}return ms.trim()}(P.colors,Ae),mt=[];mt.push({key:"FunctionType",value:"0"}),mt.push({key:"Domain",value:"[0.0 1.0]"}),mt.push({key:"Size",value:"["+Ae+"]"}),mt.push({key:"BitsPerSample",value:"8"}),mt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),mt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Fe({data:nt,additionalKeyValues:mt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ke}),z("endobj"),P.objectNumber=nr(),z("<< /ShadingType "+P.type),z("/ColorSpace /DeviceRGB");var St="/Coords ["+B(parseFloat(P.coords[0]))+" "+B(parseFloat(P.coords[1]))+" ";P.type===2?St+=B(parseFloat(P.coords[2]))+" "+B(parseFloat(P.coords[3])):St+=B(parseFloat(P.coords[2]))+" "+B(parseFloat(P.coords[3]))+" "+B(parseFloat(P.coords[4]))+" "+B(parseFloat(P.coords[5])),z(St+="]"),P.matrix&&z("/Matrix ["+P.matrix.toString()+"]"),z("/Function "+Ke+" 0 R"),z("/Extend [true true]"),z(">>"),z("endobj")},Ye=function(P,Ae){var Ke=Mt(),nt=nr();Ae.push({resourcesOid:Ke,objectOid:nt}),P.objectNumber=nt;var mt=[];mt.push({key:"Type",value:"/Pattern"}),mt.push({key:"PatternType",value:"1"}),mt.push({key:"PaintType",value:"1"}),mt.push({key:"TilingType",value:"1"}),mt.push({key:"BBox",value:"["+P.boundingBox.map(B).join(" ")+"]"}),mt.push({key:"XStep",value:B(P.xStep)}),mt.push({key:"YStep",value:B(P.yStep)}),mt.push({key:"Resources",value:Ke+" 0 R"}),P.matrix&&mt.push({key:"Matrix",value:"["+P.matrix.toString()+"]"}),Fe({data:P.stream,additionalKeyValues:mt,objectId:P.objectNumber}),z("endobj")},$e=function(P){for(var Ae in P.objectNumber=nr(),z("<<"),P)switch(Ae){case"opacity":z("/ca "+_(P[Ae]));break;case"stroke-opacity":z("/CA "+_(P[Ae]))}z(">>"),z("endobj")},it=function(P){oe(P.resourcesOid,!0),z("<<"),z("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var Ae in z("/Font <<"),At)At.hasOwnProperty(Ae)&&(u===!1||u===!0&&f.hasOwnProperty(Ae))&&z("/"+Ae+" "+At[Ae].objectNumber+" 0 R");z(">>")}(),function(){if(Object.keys(Ve).length>0){for(var Ae in z("/Shading <<"),Ve)Ve.hasOwnProperty(Ae)&&Ve[Ae]instanceof IA&&Ve[Ae].objectNumber>=0&&z("/"+Ae+" "+Ve[Ae].objectNumber+" 0 R");Ct.publish("putShadingPatternDict"),z(">>")}}(),function(Ae){if(Object.keys(Ve).length>0){for(var Ke in z("/Pattern <<"),Ve)Ve.hasOwnProperty(Ke)&&Ve[Ke]instanceof h.TilingPattern&&Ve[Ke].objectNumber>=0&&Ve[Ke].objectNumber<Ae&&z("/"+Ke+" "+Ve[Ke].objectNumber+" 0 R");Ct.publish("putTilingPatternDict"),z(">>")}}(P.objectOid),function(){if(Object.keys(_e).length>0){var Ae;for(Ae in z("/ExtGState <<"),_e)_e.hasOwnProperty(Ae)&&_e[Ae].objectNumber>=0&&z("/"+Ae+" "+_e[Ae].objectNumber+" 0 R");Ct.publish("putGStateDict"),z(">>")}}(),function(){for(var Ae in z("/XObject <<"),Ot)Ot.hasOwnProperty(Ae)&&Ot[Ae].objectNumber>=0&&z("/"+Ae+" "+Ot[Ae].objectNumber+" 0 R");Ct.publish("putXobjectDict"),z(">>")}(),z(">>"),z("endobj")},ft=function(P){Oe[P.fontName]=Oe[P.fontName]||{},Oe[P.fontName][P.fontStyle]=P.id},Ut=function(P,Ae,Ke,nt,mt){var St={id:"F"+(Object.keys(At).length+1).toString(10),postScriptName:P,fontName:Ae,fontStyle:Ke,encoding:nt,isStandardFont:mt||!1,metadata:{}};return Ct.publish("addFont",{font:St,instance:this}),At[St.id]=St,ft(St),St.id},Kt=h.__private__.pdfEscape=h.pdfEscape=function(P,Ae){return function(Ke,nt){var mt,St,Ft,lr,fr,Cr,Tr,Zr,gn;if(Ft=(nt=nt||{}).sourceEncoding||"Unicode",fr=nt.outputEncoding,(nt.autoencode||fr)&&At[xe].metadata&&At[xe].metadata[Ft]&&At[xe].metadata[Ft].encoding&&(lr=At[xe].metadata[Ft].encoding,!fr&&At[xe].encoding&&(fr=At[xe].encoding),!fr&&lr.codePages&&(fr=lr.codePages[0]),typeof fr=="string"&&(fr=lr[fr]),fr)){for(Tr=!1,Cr=[],mt=0,St=Ke.length;mt<St;mt++)(Zr=fr[Ke.charCodeAt(mt)])?Cr.push(String.fromCharCode(Zr)):Cr.push(Ke[mt]),Cr[mt].charCodeAt(0)>>8&&(Tr=!0);Ke=Cr.join("")}for(mt=Ke.length;Tr===void 0&&mt!==0;)Ke.charCodeAt(mt-1)>>8&&(Tr=!0),mt--;if(!Tr)return Ke;for(Cr=nt.noBOM?[]:[254,255],mt=0,St=Ke.length;mt<St;mt++){if((gn=(Zr=Ke.charCodeAt(mt))>>8)>>8)throw new Error("Character at position "+mt+" of string '"+Ke+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Cr.push(gn),Cr.push(Zr-(gn<<8))}return String.fromCharCode.apply(void 0,Cr)}(P,Ae).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},yr=h.__private__.beginPage=function(P){le[++He]=[],st[He]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(P[0]),topRightY:Number(P[1])}},wi(He),ee(le[j])},Hn=function(P,Ae){var Ke,nt,mt;switch(r=Ae||r,typeof P=="string"&&(Ke=x(P.toLowerCase()),Array.isArray(Ke)&&(nt=Ke[0],mt=Ke[1])),Array.isArray(P)&&(nt=P[0]*ve,mt=P[1]*ve),isNaN(nt)&&(nt=s[0],mt=s[1]),(nt>14400||mt>14400)&&(Vn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),nt=Math.min(14400,nt),mt=Math.min(14400,mt)),s=[nt,mt],r.substr(0,1)){case"l":mt>nt&&(s=[mt,nt]);break;case"p":nt>mt&&(s=[mt,nt])}yr(s),Nr(Md),z(wl),Tn!==0&&z(Tn+" J"),Iu!==0&&z(Iu+" j"),Ct.publish("addPage",{pageNumber:He})},Fn=function(P){P>0&&P<=He&&(le.splice(P,1),st.splice(P,1),He--,j>He&&(j=He),this.setPage(j))},wi=function(P){P>0&&P<=He&&(j=P)},Ds=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return le.length-1},ao=function(P,Ae,Ke){var nt,mt=void 0;return Ke=Ke||{},P=P!==void 0?P:At[xe].fontName,Ae=Ae!==void 0?Ae:At[xe].fontStyle,nt=P.toLowerCase(),Oe[nt]!==void 0&&Oe[nt][Ae]!==void 0?mt=Oe[nt][Ae]:Oe[P]!==void 0&&Oe[P][Ae]!==void 0?mt=Oe[P][Ae]:Ke.disableWarning===!1&&Vn.warn("Unable to look up font label for font '"+P+"', '"+Ae+"'. Refer to getFontList() for available fonts."),mt||Ke.noFallback||(mt=Oe.times[Ae])==null&&(mt=Oe.times.normal),mt},Jn=h.__private__.putInfo=function(){var P=nr(),Ae=function(nt){return nt};for(var Ke in A!==null&&(Ae=Ln.encryptor(P,0)),z("<<"),z("/Producer ("+Kt(Ae("jsPDF "+cr.version))+")"),Xe)Xe.hasOwnProperty(Ke)&&Xe[Ke]&&z("/"+Ke.substr(0,1).toUpperCase()+Ke.substr(1)+" ("+Kt(Ae(Xe[Ke]))+")");z("/CreationDate ("+Kt(Ae(ge))+")"),z(">>"),z("endobj")},io=h.__private__.putCatalog=function(P){var Ae=(P=P||{}).rootDictionaryObjId||ce;switch(nr(),z("<<"),z("/Type /Catalog"),z("/Pages "+Ae+" 0 R"),Pe||(Pe="fullwidth"),Pe){case"fullwidth":z("/OpenAction [3 0 R /FitH null]");break;case"fullheight":z("/OpenAction [3 0 R /FitV null]");break;case"fullpage":z("/OpenAction [3 0 R /Fit]");break;case"original":z("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ke=""+Pe;Ke.substr(Ke.length-1)==="%"&&(Pe=parseInt(Pe)/100),typeof Pe=="number"&&z("/OpenAction [3 0 R /XYZ null null "+_(Pe)+"]")}switch(vt||(vt="continuous"),vt){case"continuous":z("/PageLayout /OneColumn");break;case"single":z("/PageLayout /SinglePage");break;case"two":case"twoleft":z("/PageLayout /TwoColumnLeft");break;case"tworight":z("/PageLayout /TwoColumnRight")}ot&&z("/PageMode /"+ot),Ct.publish("putCatalog"),z(">>"),z("endobj")},Ud=h.__private__.putTrailer=function(){z("trailer"),z("<<"),z("/Size "+(R+1)),z("/Root "+R+" 0 R"),z("/Info "+(R-1)+" 0 R"),A!==null&&z("/Encrypt "+Ln.oid+" 0 R"),z("/ID [ <"+ae+"> <"+ae+"> ]"),z(">>")},Kn=h.__private__.putHeader=function(){z("%PDF-"+m),z("%")},ec=h.__private__.putXRef=function(){var P="0000000000";z("xref"),z("0 "+(R+1)),z("0000000000 65535 f ");for(var Ae=1;Ae<=R;Ae++)typeof K[Ae]=="function"?z((P+K[Ae]()).slice(-10)+" 00000 n "):K[Ae]!==void 0?z((P+K[Ae]).slice(-10)+" 00000 n "):z("0000000000 00000 n ")},Lo=h.__private__.buildDocument=function(){var P;R=0,re=0,M=[],K=[],de=[],ce=Mt(),pe=Mt(),ee(M),Ct.publish("buildDocument"),Kn(),Re(),function(){Ct.publish("putAdditionalObjects");for(var Ke=0;Ke<de.length;Ke++){var nt=de[Ke];oe(nt.objId,!0),z(nt.content),z("endobj")}Ct.publish("postPutAdditionalObjects")}(),P=[],function(){for(var Ke in At)At.hasOwnProperty(Ke)&&(u===!1||u===!0&&f.hasOwnProperty(Ke))&&Ee(At[Ke])}(),function(){var Ke;for(Ke in _e)_e.hasOwnProperty(Ke)&&$e(_e[Ke])}(),function(){for(var Ke in Ot)Ot.hasOwnProperty(Ke)&&Ze(Ot[Ke])}(),function(Ke){var nt;for(nt in Ve)Ve.hasOwnProperty(nt)&&(Ve[nt]instanceof IA?Je(Ve[nt]):Ve[nt]instanceof ih&&Ye(Ve[nt],Ke))}(P),Ct.publish("putResources"),P.forEach(it),it({resourcesOid:pe,objectOid:Number.MAX_SAFE_INTEGER}),Ct.publish("postPutResources"),A!==null&&(Ln.oid=nr(),z("<<"),z("/Filter /Standard"),z("/V "+Ln.v),z("/R "+Ln.r),z("/U <"+Ln.toHexString(Ln.U)+">"),z("/O <"+Ln.toHexString(Ln.O)+">"),z("/P "+Ln.P),z(">>"),z("endobj")),Jn(),io();var Ae=re;return ec(),Ud(),z("startxref"),z(""+Ae),z("%%EOF"),ee(le[j]),M.join(`
`)},Dc=h.__private__.getBlob=function(P){return new Blob([Ne(P)],{type:"application/pdf"})},Eu=h.output=h.__private__.output=(Vt=function(P,Ae){switch(typeof(Ae=Ae||{})=="string"?Ae={filename:Ae}:Ae.filename=Ae.filename||"generated.pdf",P){case void 0:return Lo();case"save":h.save(Ae.filename);break;case"arraybuffer":return Ne(Lo());case"blob":return Dc(Lo());case"bloburi":case"bloburl":if(kr.URL!==void 0&&typeof kr.URL.createObjectURL=="function")return kr.URL&&kr.URL.createObjectURL(Dc(Lo()))||void 0;Vn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ke="",nt=Lo();try{Ke=BT(nt)}catch{Ke=BT(unescape(encodeURIComponent(nt)))}return"data:application/pdf;filename="+Ae.filename+";base64,"+Ke;case"pdfobjectnewwindow":if(Object.prototype.toString.call(kr)==="[object Window]"){var mt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",St=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Ae.pdfObjectUrl&&(mt=Ae.pdfObjectUrl,St="");var Ft='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+mt+'"'+St+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Ae)+");<\/script></body></html>",lr=kr.open();return lr!==null&&lr.document.write(Ft),lr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(kr)==="[object Window]"){var fr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Ae.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Ae.filename+'" width="500px" height="400px" /></body></html>',Cr=kr.open();if(Cr!==null){Cr.document.write(fr);var Tr=this;Cr.document.documentElement.querySelector("#pdfViewer").onload=function(){Cr.document.title=Ae.filename,Cr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Tr.output("bloburl"))}}return Cr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(kr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Zr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Ae)+'"></iframe></body></html>',gn=kr.open();if(gn!==null&&(gn.document.write(Zr),gn.document.title=Ae.filename),gn||typeof safari>"u")return gn;break;case"datauri":case"dataurl":return kr.document.location.href=this.output("datauristring",Ae);default:return null}},Vt.foo=function(){try{return Vt.apply(this,arguments)}catch(Ke){var P=Ke.stack||"";~P.indexOf(" at ")&&(P=P.split(" at ")[1]);var Ae="Error in function "+P.split(`
`)[0].split("<")[0]+": "+Ke.message;if(!kr.console)throw new Error(Ae);kr.console.error(Ae,Ke),kr.alert&&alert(Ae)}},Vt.foo.bar=Vt,Vt.foo),Qi=function(P){return Array.isArray(Xt)===!0&&Xt.indexOf(P)>-1};switch(n){case"pt":ve=1;break;case"mm":ve=72/25.4;break;case"cm":ve=72/2.54;break;case"in":ve=72;break;case"px":ve=Qi("px_scaling")==1?.75:96/72;break;case"pc":case"em":ve=12;break;case"ex":ve=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);ve=n}var Ln=null;Ie(),me();var na=h.__private__.getPageInfo=h.getPageInfo=function(P){if(isNaN(P)||P%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:st[P].objId,pageNumber:P,pageContext:st[P]}},Lc=h.__private__.getPageInfoByObjId=function(P){if(isNaN(P)||P%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Ae in st)if(st[Ae].objId===P)break;return na(Ae)},Od=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:st[j].objId,pageNumber:j,pageContext:st[j]}};h.addPage=function(){return Hn.apply(this,arguments),this},h.setPage=function(){return wi.apply(this,arguments),ee.call(this,le[j]),this},h.insertPage=function(P){return this.addPage(),this.movePage(j,P),this},h.movePage=function(P,Ae){var Ke,nt;if(P>Ae){Ke=le[P],nt=st[P];for(var mt=P;mt>Ae;mt--)le[mt]=le[mt-1],st[mt]=st[mt-1];le[Ae]=Ke,st[Ae]=nt,this.setPage(Ae)}else if(P<Ae){Ke=le[P],nt=st[P];for(var St=P;St<Ae;St++)le[St]=le[St+1],st[St]=st[St+1];le[Ae]=Ke,st[Ae]=nt,this.setPage(Ae)}return this},h.deletePage=function(){return Fn.apply(this,arguments),this},h.__private__.text=h.text=function(P,Ae,Ke,nt,mt){var St,Ft,lr,fr,Cr,Tr,Zr,gn,ms,yn=(nt=nt||{}).scope||this;if(typeof P=="number"&&typeof Ae=="number"&&(typeof Ke=="string"||Array.isArray(Ke))){var Es=Ke;Ke=Ae,Ae=P,P=Es}if(arguments[3]instanceof et==0?(lr=arguments[4],fr=arguments[5],Sn(Zr=arguments[3])==="object"&&Zr!==null||(typeof lr=="string"&&(fr=lr,lr=null),typeof Zr=="string"&&(fr=Zr,Zr=null),typeof Zr=="number"&&(lr=Zr,Zr=null),nt={flags:Zr,angle:lr,align:fr})):(S("The transform parameter of text() with a Matrix value"),ms=mt),isNaN(Ae)||isNaN(Ke)||P==null)throw new Error("Invalid arguments passed to jsPDF.text");if(P.length===0)return yn;var ps,Bs="",gs=typeof nt.lineHeightFactor=="number"?nt.lineHeightFactor:rc,Vi=yn.internal.scaleFactor;function Ko(xn){return xn=xn.split("	").join(Array(nt.TabLen||9).join(" ")),Kt(xn,Zr)}function qo(xn){for(var Un,Us=xn.concat(),sa=[],Hc=Us.length;Hc--;)typeof(Un=Us.shift())=="string"?sa.push(Un):Array.isArray(xn)&&(Un.length===1||Un[1]===void 0&&Un[2]===void 0)?sa.push(Un[0]):sa.push([Un[0],Un[1],Un[2]]);return sa}function y(xn,Un){var Us;if(typeof xn=="string")Us=Un(xn)[0];else if(Array.isArray(xn)){for(var sa,Hc,Sm=xn.concat(),mf=[],Yx=Sm.length;Yx--;)typeof(sa=Sm.shift())=="string"?mf.push(Un(sa)[0]):Array.isArray(sa)&&typeof sa[0]=="string"&&(Hc=Un(sa[0],sa[1],sa[2]),mf.push([Hc[0],Hc[1],Hc[2]]));Us=mf}return Us}var H=!1,ne=!0;if(typeof P=="string")H=!0;else if(Array.isArray(P)){var ke=P.concat();Ft=[];for(var pt,wt=ke.length;wt--;)(typeof(pt=ke.shift())!="string"||Array.isArray(pt)&&typeof pt[0]!="string")&&(ne=!1);H=ne}if(H===!1)throw new Error('Type of text must be string or Array. "'+P+'" is not recognized.');typeof P=="string"&&(P=P.match(/[\r?\n]/)?P.split(/\r\n|\r|\n/g):[P]);var zt=we/yn.internal.scaleFactor,sn=zt*(gs-1);switch(nt.baseline){case"bottom":Ke-=sn;break;case"top":Ke+=zt-sn;break;case"hanging":Ke+=zt-2*sn;break;case"middle":Ke+=zt/2-sn}if((Tr=nt.maxWidth||0)>0&&(typeof P=="string"?P=yn.splitTextToSize(P,Tr):Object.prototype.toString.call(P)==="[object Array]"&&(P=P.reduce(function(xn,Un){return xn.concat(yn.splitTextToSize(Un,Tr))},[]))),St={text:P,x:Ae,y:Ke,options:nt,mutex:{pdfEscape:Kt,activeFontKey:xe,fonts:At,activeFontSize:we}},Ct.publish("preProcessText",St),P=St.text,lr=(nt=St.options).angle,ms instanceof et==0&&lr&&typeof lr=="number"){lr*=Math.PI/180,nt.rotationDirection===0&&(lr=-lr),k===w&&(lr=-lr);var xs=Math.cos(lr),Gr=Math.sin(lr);ms=new et(xs,Gr,-Gr,xs,0,0)}else lr&&lr instanceof et&&(ms=lr);k!==w||ms||(ms=er),(Cr=nt.charSpace||Mo)!==void 0&&(Bs+=B(D(Cr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(gn=nt.horizontalScale)!==void 0&&(Bs+=B(100*gn)+` Tz
`),nt.lang;var fn=-1,qn=nt.renderingMode!==void 0?nt.renderingMode:nt.stroke,lo=yn.internal.getCurrentPageInfo().pageContext;switch(qn){case 0:case!1:case"fill":fn=0;break;case 1:case!0:case"stroke":fn=1;break;case 2:case"fillThenStroke":fn=2;break;case 3:case"invisible":fn=3;break;case 4:case"fillAndAddForClipping":fn=4;break;case 5:case"strokeAndAddPathForClipping":fn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":fn=6;break;case 7:case"addToPathForClipping":fn=7}var Za=lo.usedRenderingMode!==void 0?lo.usedRenderingMode:-1;fn!==-1?Bs+=fn+` Tr
`:Za!==-1&&(Bs+=`0 Tr
`),fn!==-1&&(lo.usedRenderingMode=fn),fr=nt.align||"left";var Pa,Nl=we*gs,bm=yn.internal.pageSize.getWidth(),wm=At[xe];Cr=nt.charSpace||Mo,Tr=nt.maxWidth||0,Zr=Object.assign({autoencode:!0,noBOM:!0},nt.flags);var qd=[],Fu=function(xn){return yn.getStringUnitWidth(xn,{font:wm,charSpace:Cr,fontSize:we,doKerning:!1})*we/Vi};if(Object.prototype.toString.call(P)==="[object Array]"){var co;Ft=qo(P),fr!=="left"&&(Pa=Ft.map(Fu));var Ao,Gd=0;if(fr==="right"){Ae-=Pa[0],P=[],wt=Ft.length;for(var Vc=0;Vc<wt;Vc++)Vc===0?(Ao=ya(Ae),co=bl(Ke)):(Ao=D(Gd-Pa[Vc]),co=-Nl),P.push([Ft[Vc],Ao,co]),Gd=Pa[Vc]}else if(fr==="center"){Ae-=Pa[0]/2,P=[],wt=Ft.length;for(var $d=0;$d<wt;$d++)$d===0?(Ao=ya(Ae),co=bl(Ke)):(Ao=D((Gd-Pa[$d])/2),co=-Nl),P.push([Ft[$d],Ao,co]),Gd=Pa[$d]}else if(fr==="left"){P=[],wt=Ft.length;for(var Nm=0;Nm<wt;Nm++)P.push(Ft[Nm])}else if(fr==="justify"&&wm.encoding==="Identity-H"){P=[],wt=Ft.length,Tr=Tr!==0?Tr:bm;for(var ff=0,Ls=0;Ls<wt;Ls++)if(co=Ls===0?bl(Ke):-Nl,Ao=Ls===0?ya(Ae):ff,Ls<wt-1){var Xx=D((Tr-Pa[Ls])/(Ft[Ls].split(" ").length-1)),ac=Ft[Ls].split(" ");P.push([ac[0]+" ",Ao,co]),ff=0;for(var ic=1;ic<ac.length;ic++){var Cm=(Fu(ac[ic-1]+" "+ac[ic])-Fu(ac[ic]))*Vi+Xx;ic==ac.length-1?P.push([ac[ic],Cm,0]):P.push([ac[ic]+" ",Cm,0]),ff-=Cm}}else P.push([Ft[Ls],Ao,co]);P.push(["",ff,0])}else{if(fr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(P=[],wt=Ft.length,Tr=Tr!==0?Tr:bm,Ls=0;Ls<wt;Ls++){co=Ls===0?bl(Ke):-Nl,Ao=Ls===0?ya(Ae):0;var _m=Ft[Ls].split(" ").length-1,Em=_m>0?(Tr-Pa[Ls])/_m:0;Ls<wt-1?qd.push(B(D(Em))):qd.push(0),P.push([Ft[Ls],Ao,co])}}}(typeof nt.R2L=="boolean"?nt.R2L:tt)===!0&&(P=y(P,function(xn,Un,Us){return[xn.split("").reverse().join(""),Un,Us]})),St={text:P,x:Ae,y:Ke,options:nt,mutex:{pdfEscape:Kt,activeFontKey:xe,fonts:At,activeFontSize:we}},Ct.publish("postProcessText",St),P=St.text,ps=St.mutex.isHex||!1;var Bm=At[xe].encoding;Bm!=="WinAnsiEncoding"&&Bm!=="StandardEncoding"||(P=y(P,function(xn,Un,Us){return[Ko(xn),Un,Us]})),Ft=qo(P),P=[];for(var zd,Wd,Jd,Tu=Array.isArray(Ft[0])?1:0,Xd="",Pu=function(xn,Un,Us){var sa="";return Us instanceof et?(Us=typeof nt.angle=="number"?Rt(Us,new et(1,0,0,1,xn,Un)):Rt(new et(1,0,0,1,xn,Un),Us),k===w&&(Us=Rt(new et(1,0,0,-1,0,0),Us)),sa=Us.join(" ")+` Tm
`):sa=B(xn)+" "+B(Un)+` Td
`,sa},Go=0;Go<Ft.length;Go++){switch(Xd="",Tu){case 1:Jd=(ps?"<":"(")+Ft[Go][0]+(ps?">":")"),zd=parseFloat(Ft[Go][1]),Wd=parseFloat(Ft[Go][2]);break;case 0:Jd=(ps?"<":"(")+Ft[Go]+(ps?">":")"),zd=ya(Ae),Wd=bl(Ke)}qd!==void 0&&qd[Go]!==void 0&&(Xd=qd[Go]+` Tw
`),Go===0?P.push(Xd+Pu(zd,Wd,ms)+Jd):Tu===0?P.push(Xd+Jd):Tu===1&&P.push(Xd+Pu(zd,Wd,ms)+Jd)}P=Tu===0?P.join(` Tj
T* `):P.join(` Tj
`),P+=` Tj
`;var oc=`BT
/`;return oc+=xe+" "+we+` Tf
`,oc+=B(we*gs)+` TL
`,oc+=oo+`
`,oc+=Bs,oc+=P,z(oc+="ET"),f[xe]=!0,yn};var lf=h.__private__.clip=h.clip=function(P){return z(P==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return lf("evenodd")},h.__private__.discardPath=h.discardPath=function(){return z("n"),this};var Yr=h.__private__.isValidStyle=function(P){var Ae=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(P)!==-1&&(Ae=!0),Ae};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(P){return Yr(P)&&(d=P),this};var Uc=h.__private__.getStyle=h.getStyle=function(P){var Ae=d;switch(P){case"D":case"S":Ae="S";break;case"F":Ae="f";break;case"FD":case"DF":Ae="B";break;case"f":case"f*":case"B":case"B*":Ae=P}return Ae},tc=h.close=function(){return z("h"),this};h.stroke=function(){return z("S"),this},h.fill=function(P){return Uo("f",P),this},h.fillEvenOdd=function(P){return Uo("f*",P),this},h.fillStroke=function(P){return Uo("B",P),this},h.fillStrokeEvenOdd=function(P){return Uo("B*",P),this};var Uo=function(P,Ae){Sn(Ae)==="object"?mm(Ae,P):z(P)},Oc=function(P){P===null||k===w&&P===void 0||(P=Uc(P),z(P))};function cf(P,Ae,Ke,nt,mt){var St=new ih(Ae||this.boundingBox,Ke||this.xStep,nt||this.yStep,this.gState,mt||this.matrix);St.stream=this.stream;var Ft=P+"$$"+this.cloneIndex+++"$$";return Lt(Ft,St),St}var mm=function(P,Ae){var Ke=G[P.key],nt=Ve[Ke];if(nt instanceof IA)z("q"),z(pm(Ae)),nt.gState&&h.setGState(nt.gState),z(P.matrix.toString()+" cm"),z("/"+Ke+" sh"),z("Q");else if(nt instanceof ih){var mt=new et(1,0,0,-1,0,Ho());P.matrix&&(mt=mt.multiply(P.matrix||er),Ke=cf.call(nt,P.key,P.boundingBox,P.xStep,P.yStep,mt).id),z("q"),z("/Pattern cs"),z("/"+Ke+" scn"),nt.gState&&h.setGState(nt.gState),z(Ae),z("Q")}},pm=function(P){switch(P){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Bu=h.moveTo=function(P,Ae){return z(B(D(P))+" "+B(X(Ae))+" m"),this},df=h.lineTo=function(P,Ae){return z(B(D(P))+" "+B(X(Ae))+" l"),this},Ta=h.curveTo=function(P,Ae,Ke,nt,mt,St){return z([B(D(P)),B(X(Ae)),B(D(Ke)),B(X(nt)),B(D(mt)),B(X(St)),"c"].join(" ")),this};h.__private__.line=h.line=function(P,Ae,Ke,nt,mt){if(isNaN(P)||isNaN(Ae)||isNaN(Ke)||isNaN(nt)||!Yr(mt))throw new Error("Invalid arguments passed to jsPDF.line");return k===b?this.lines([[Ke-P,nt-Ae]],P,Ae,[1,1],mt||"S"):this.lines([[Ke-P,nt-Ae]],P,Ae,[1,1]).stroke()},h.__private__.lines=h.lines=function(P,Ae,Ke,nt,mt,St){var Ft,lr,fr,Cr,Tr,Zr,gn,ms,yn,Es,ps,Bs;if(typeof P=="number"&&(Bs=Ke,Ke=Ae,Ae=P,P=Bs),nt=nt||[1,1],St=St||!1,isNaN(Ae)||isNaN(Ke)||!Array.isArray(P)||!Array.isArray(nt)||!Yr(mt)||typeof St!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Bu(Ae,Ke),Ft=nt[0],lr=nt[1],Cr=P.length,Es=Ae,ps=Ke,fr=0;fr<Cr;fr++)(Tr=P[fr]).length===2?(Es=Tr[0]*Ft+Es,ps=Tr[1]*lr+ps,df(Es,ps)):(Zr=Tr[0]*Ft+Es,gn=Tr[1]*lr+ps,ms=Tr[2]*Ft+Es,yn=Tr[3]*lr+ps,Es=Tr[4]*Ft+Es,ps=Tr[5]*lr+ps,Ta(Zr,gn,ms,yn,Es,ps));return St&&tc(),Oc(mt),this},h.path=function(P){for(var Ae=0;Ae<P.length;Ae++){var Ke=P[Ae],nt=Ke.c;switch(Ke.op){case"m":Bu(nt[0],nt[1]);break;case"l":df(nt[0],nt[1]);break;case"c":Ta.apply(this,nt);break;case"h":tc()}}return this},h.__private__.rect=h.rect=function(P,Ae,Ke,nt,mt){if(isNaN(P)||isNaN(Ae)||isNaN(Ke)||isNaN(nt)||!Yr(mt))throw new Error("Invalid arguments passed to jsPDF.rect");return k===b&&(nt=-nt),z([B(D(P)),B(X(Ae)),B(D(Ke)),B(D(nt)),"re"].join(" ")),Oc(mt),this},h.__private__.triangle=h.triangle=function(P,Ae,Ke,nt,mt,St,Ft){if(isNaN(P)||isNaN(Ae)||isNaN(Ke)||isNaN(nt)||isNaN(mt)||isNaN(St)||!Yr(Ft))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ke-P,nt-Ae],[mt-Ke,St-nt],[P-mt,Ae-St]],P,Ae,[1,1],Ft,!0),this},h.__private__.roundedRect=h.roundedRect=function(P,Ae,Ke,nt,mt,St,Ft){if(isNaN(P)||isNaN(Ae)||isNaN(Ke)||isNaN(nt)||isNaN(mt)||isNaN(St)||!Yr(Ft))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var lr=4/3*(Math.SQRT2-1);return mt=Math.min(mt,.5*Ke),St=Math.min(St,.5*nt),this.lines([[Ke-2*mt,0],[mt*lr,0,mt,St-St*lr,mt,St],[0,nt-2*St],[0,St*lr,-mt*lr,St,-mt,St],[2*mt-Ke,0],[-mt*lr,0,-mt,-St*lr,-mt,-St],[0,2*St-nt],[0,-St*lr,mt*lr,-St,mt,-St]],P+mt,Ae,[1,1],Ft,!0),this},h.__private__.ellipse=h.ellipse=function(P,Ae,Ke,nt,mt){if(isNaN(P)||isNaN(Ae)||isNaN(Ke)||isNaN(nt)||!Yr(mt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var St=4/3*(Math.SQRT2-1)*Ke,Ft=4/3*(Math.SQRT2-1)*nt;return Bu(P+Ke,Ae),Ta(P+Ke,Ae-Ft,P+St,Ae-nt,P,Ae-nt),Ta(P-St,Ae-nt,P-Ke,Ae-Ft,P-Ke,Ae),Ta(P-Ke,Ae+Ft,P-St,Ae+nt,P,Ae+nt),Ta(P+St,Ae+nt,P+Ke,Ae+Ft,P+Ke,Ae),Oc(mt),this},h.__private__.circle=h.circle=function(P,Ae,Ke,nt){if(isNaN(P)||isNaN(Ae)||isNaN(Ke)||!Yr(nt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(P,Ae,Ke,Ke,nt)},h.setFont=function(P,Ae,Ke){return Ke&&(Ae=E(Ae,Ke)),xe=ao(P,Ae,{disableWarning:!1}),this};var Oo=h.__private__.getFont=h.getFont=function(){return At[ao.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var P,Ae,Ke={};for(P in Oe)if(Oe.hasOwnProperty(P))for(Ae in Ke[P]=[],Oe[P])Oe[P].hasOwnProperty(Ae)&&Ke[P].push(Ae);return Ke},h.addFont=function(P,Ae,Ke,nt,mt){var St=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&St.indexOf(arguments[3])!==-1?mt=arguments[3]:arguments[3]&&St.indexOf(arguments[3])==-1&&(Ke=E(Ke,nt)),Ut.call(this,P,Ae,Ke,mt=mt||"Identity-H")};var rc,Md=t.lineWidth||.200025,Af=h.__private__.getLineWidth=h.getLineWidth=function(){return Md},Nr=h.__private__.setLineWidth=h.setLineWidth=function(P){return Md=P,z(B(D(P))+" w"),this};h.__private__.setLineDash=cr.API.setLineDash=cr.API.setLineDashPattern=function(P,Ae){if(P=P||[],Ae=Ae||0,isNaN(Ae)||!Array.isArray(P))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return P=P.map(function(Ke){return B(D(Ke))}).join(" "),Ae=B(D(Ae)),z("["+P+"] "+Ae+" d"),this};var gm=h.__private__.getLineHeight=h.getLineHeight=function(){return we*rc};h.__private__.getLineHeight=h.getLineHeight=function(){return we*rc};var xm=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(P){return typeof(P=P||1.15)=="number"&&(rc=P),this},vm=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return rc};xm(t.lineHeight);var ya=h.__private__.getHorizontalCoordinate=function(P){return D(P)},bl=h.__private__.getVerticalCoordinate=function(P){return k===w?P:st[j].mediaBox.topRightY-st[j].mediaBox.bottomLeftY-D(P)},ym=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(P){return B(ya(P))},Qd=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(P){return B(bl(P))},wl=t.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return Be(wl)},h.__private__.setStrokeColor=h.setDrawColor=function(P,Ae,Ke,nt){return wl=De({ch1:P,ch2:Ae,ch3:Ke,ch4:nt,pdfColorType:"draw",precision:2}),z(wl),this};var Vd=t.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return Be(Vd)},h.__private__.setFillColor=h.setFillColor=function(P,Ae,Ke,nt){return Vd=De({ch1:P,ch2:Ae,ch3:Ke,ch4:nt,pdfColorType:"fill",precision:2}),z(Vd),this};var oo=t.textColor||"0 g",Mc=h.__private__.getTextColor=h.getTextColor=function(){return Be(oo)};h.__private__.setTextColor=h.setTextColor=function(P,Ae,Ke,nt){return oo=De({ch1:P,ch2:Ae,ch3:Ke,ch4:nt,pdfColorType:"text",precision:3}),this};var Mo=t.charSpace,Su=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Mo||0)};h.__private__.setCharSpace=h.setCharSpace=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Mo=P,this};var Tn=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(P){var Ae=h.CapJoinStyles[P];if(Ae===void 0)throw new Error("Line cap style of '"+P+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Tn=Ae,z(Ae+" J"),this};var Iu=0;h.__private__.setLineJoin=h.setLineJoin=function(P){var Ae=h.CapJoinStyles[P];if(Ae===void 0)throw new Error("Line join style of '"+P+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Iu=Ae,z(Ae+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(P){if(P=P||0,isNaN(P))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return z(B(D(P))+" M"),this},h.GState=Zg,h.setGState=function(P){(P=typeof P=="string"?_e[Me[P]]:uf(null,P)).equals(We)||(z("/"+P.id+" gs"),We=P)};var uf=function(P,Ae){if(!P||!Me[P]){var Ke=!1;for(var nt in _e)if(_e.hasOwnProperty(nt)&&_e[nt].equals(Ae)){Ke=!0;break}if(Ke)Ae=_e[nt];else{var mt="GS"+(Object.keys(_e).length+1).toString(10);_e[mt]=Ae,Ae.id=mt}return P&&(Me[P]=Ae.id),Ct.publish("addGState",Ae),Ae}};h.addGState=function(P,Ae){return uf(P,Ae),this},h.saveGraphicsState=function(){return z("q"),at.push({key:xe,size:we,color:oo}),this},h.restoreGraphicsState=function(){z("Q");var P=at.pop();return xe=P.key,we=P.size,oo=P.color,We=null,this},h.setCurrentTransformationMatrix=function(P){return z(P.toString()+" cm"),this},h.comment=function(P){return z("#"+P),this};var Qo=function(P,Ae){var Ke=P||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ke},set:function(St){isNaN(St)||(Ke=parseFloat(St))}});var nt=Ae||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return nt},set:function(St){isNaN(St)||(nt=parseFloat(St))}});var mt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return mt},set:function(St){mt=St.toString()}}),this},Hd=function(P,Ae,Ke,nt){Qo.call(this,P,Ae),this.type="rect";var mt=Ke||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return mt},set:function(Ft){isNaN(Ft)||(mt=parseFloat(Ft))}});var St=nt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return St},set:function(Ft){isNaN(Ft)||(St=parseFloat(Ft))}}),this},Qc=function(){this.page=He,this.currentPage=j,this.pages=le.slice(0),this.pagesContext=st.slice(0),this.x=ie,this.y=ze,this.matrix=rt,this.width=Ni(j),this.height=hf(j),this.outputDestination=Se,this.id="",this.objectNumber=-1};Qc.prototype.restore=function(){He=this.page,j=this.currentPage,st=this.pagesContext,le=this.pages,ie=this.x,ze=this.y,rt=this.matrix,ju(j,this.width),Ci(j,this.height),Se=this.outputDestination};var nc=function(P,Ae,Ke,nt,mt){Zt.push(new Qc),He=j=0,le=[],ie=P,ze=Ae,rt=mt,yr([Ke,nt])};for(var sc in h.beginFormObject=function(P,Ae,Ke,nt,mt){return nc(P,Ae,Ke,nt,mt),this},h.endFormObject=function(P){return function(Ae){if(tr[Ae])Zt.pop().restore();else{var Ke=new Qc,nt="Xo"+(Object.keys(Ot).length+1).toString(10);Ke.id=nt,tr[Ae]=nt,Ot[nt]=Ke,Ct.publish("addFormObject",Ke),Zt.pop().restore()}}(P),this},h.doFormObject=function(P,Ae){var Ke=Ot[tr[P]];return z("q"),z(Ae.toString()+" cm"),z("/"+Ke.id+" Do"),z("Q"),this},h.getFormObject=function(P){var Ae=Ot[tr[P]];return{x:Ae.x,y:Ae.y,width:Ae.width,height:Ae.height,matrix:Ae.matrix}},h.save=function(P,Ae){return P=P||"generated.pdf",(Ae=Ae||{}).returnPromise=Ae.returnPromise||!1,Ae.returnPromise===!1?(zu(Dc(Lo()),P),typeof zu.unload=="function"&&kr.setTimeout&&setTimeout(zu.unload,911),this):new Promise(function(Ke,nt){try{var mt=zu(Dc(Lo()),P);typeof zu.unload=="function"&&kr.setTimeout&&setTimeout(zu.unload,911),Ke(mt)}catch(St){nt(St.message)}})},cr.API)cr.API.hasOwnProperty(sc)&&(sc==="events"&&cr.API.events.length?function(P,Ae){var Ke,nt,mt;for(mt=Ae.length-1;mt!==-1;mt--)Ke=Ae[mt][0],nt=Ae[mt][1],P.subscribe.apply(P,[Ke].concat(typeof nt=="function"?[nt]:nt))}(Ct,cr.API.events):h[sc]=cr.API[sc]);function Ni(P){return st[P].mediaBox.topRightX-st[P].mediaBox.bottomLeftX}function ju(P,Ae){st[P].mediaBox.topRightX=Ae+st[P].mediaBox.bottomLeftX}function hf(P){return st[P].mediaBox.topRightY-st[P].mediaBox.bottomLeftY}function Ci(P,Ae){st[P].mediaBox.topRightY=Ae+st[P].mediaBox.bottomLeftY}var Vo=h.getPageWidth=function(P){return Ni(P=P||j)/ve},Kd=h.setPageWidth=function(P,Ae){ju(P,Ae*ve)},Ho=h.getPageHeight=function(P){return hf(P=P||j)/ve},ku=h.setPageHeight=function(P,Ae){Ci(P,Ae*ve)};return h.internal={pdfEscape:Kt,getStyle:Uc,getFont:Oo,getFontSize:Qe,getCharSpace:Su,getTextColor:Mc,getLineHeight:gm,getLineHeightFactor:vm,getLineWidth:Af,write:te,getHorizontalCoordinate:ya,getVerticalCoordinate:bl,getCoordinateString:ym,getVerticalCoordinateString:Qd,collections:{},newObject:nr,newAdditionalObject:J,newObjectDeferred:Mt,newObjectDeferredBegin:oe,getFilters:se,putStream:Fe,events:Ct,scaleFactor:ve,pageSize:{getWidth:function(){return Vo(j)},setWidth:function(P){Kd(j,P)},getHeight:function(){return Ho(j)},setHeight:function(P){ku(j,P)}},encryptionOptions:A,encryption:Ln,getEncryptor:function(P){return A!==null?Ln.encryptor(P,0):function(Ae){return Ae}},output:Eu,getNumberOfPages:Ds,get pages(){return le},out:z,f2:_,f3:F,getPageInfo:na,getPageInfoByObjId:Lc,getCurrentPageInfo:Od,getPDFVersion:p,Point:Qo,Rectangle:Hd,Matrix:et,hasHotfix:Qi},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Vo(j)},set:function(P){Kd(j,P)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Ho(j)},set:function(P){ku(j,P)},enumerable:!0,configurable:!0}),(function(P){for(var Ae=0,Ke=Y.length;Ae<Ke;Ae++){var nt=Ut.call(this,P[Ae][0],P[Ae][1],P[Ae][2],Y[Ae][3],!0);u===!1&&(f[nt]=!0);var mt=P[Ae][0].split("-");ft({id:nt,fontName:mt[0],fontStyle:mt[1]||""})}Ct.publish("addFonts",{fonts:At,dictionary:Oe})}).call(h,Y),xe="F1",Hn(s,r),Ct.publish("initialized"),h}$f.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},$f.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},$f.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},$f.prototype.processOwnerPassword=function(t,e){return _E(CE(e).substr(0,5),t)},$f.prototype.encryptor=function(t,e){var r=CE(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return _E(r,n)}},Zg.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||Sn(t)!==Sn(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},cr.API={events:[]},cr.version="3.0.4";var js=cr.API,sI=1,ef=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},jf=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Rr=function(t){return t.toFixed(2)},dA=function(t){return t.toFixed(5)};js.__acroform__={};var so=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},kT=function(t){return t*sI},hc=function(t){var e=new qM,r=ur.internal.getHeight(t)||0,n=ur.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Rr(n)),Number(Rr(r))],e},Jie=js.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},Xie=js.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},Yie=js.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},qs=js.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Yie(t,e-1)},Gs=js.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Jie(t,e-1)},$s=js.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Xie(t,e-1)},Zie=js.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,s=t[0],i=t[1],o=t[2],l=t[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(i+l)||0,c.upperRight_X=r(s+o)||0,c.upperRight_Y=n(i)||0,[Number(Rr(c.lowerLeft_X)),Number(Rr(c.lowerLeft_Y)),Number(Rr(c.upperRight_X)),Number(Rr(c.upperRight_Y))]},eoe=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=EE(t,r),s=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+s+" "+Rr(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=hc(t);return i.scope=t.scope,i.stream=e.join(`
`),i}},EE=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=t.multiline?s.map(function(_){return _.split(`
`)}):s.map(function(_){return[_]});var i=r,o=ur.internal.getHeight(t)||0;o=o<0?-o:o;var l=ur.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(_,F,D){if(_+1<s.length){var X=F+" "+s[_+1][0];return m1(X,t,D).width<=l-4}return!1};i++;e:for(;i>0;){e="",i--;var d,A,u=m1("3",t,i).height,f=t.multiline?o-i:(o-u)/2,h=f+=2,m=0,p=0,g=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+m1(e,t,i=12).width+", FieldWidth:"+l+`
`;break}for(var x="",b=0,w=0;w<s.length;w++)if(s.hasOwnProperty(w)){var k=!1;if(s[w].length!==1&&g!==s[w].length-1){if((u+2)*(b+2)+2>o)continue e;x+=s[w][g],k=!0,p=w,w--}else{x=(x+=s[w][g]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var O=parseInt(w),L=c(O,x,i),E=w>=s.length-1;if(L&&!E){x+=" ",g=0;continue}if(L||E){if(E)p=O;else if(t.multiline&&(u+2)*(b+2)+2>o)continue e}else{if(!t.multiline||(u+2)*(b+2)+2>o)continue e;p=O}}for(var B="",S=m;S<=p;S++){var U=s[S];if(t.multiline){if(S===p){B+=U[g]+" ",g=(g+1)%U.length;continue}if(S===m){B+=U[U.length-1]+" ";continue}}B+=U[0]+" "}switch(B=B.substr(B.length-1)==" "?B.substr(0,B.length-1):B,A=m1(B,t,i).width,t.textAlign){case"right":d=l-A-2;break;case"center":d=(l-A)/2;break;default:d=2}e+=Rr(d)+" "+Rr(h)+` Td
`,e+="("+ef(B)+`) Tj
`,e+=-Rr(d)+` 0 Td
`,h=-(i+2),A=0,m=k?p:p+1,b++,x=""}break}return n.text=e,n.fontSize=i,n},m1=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},toe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},roe=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},noe=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Xl.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(toe)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");sI=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new GM,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var i=n[s];i.objId=void 0,i.hasAnnotation&&roe(i,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,s){var i=!n;for(var o in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],d=l.Rect;if(l.Rect&&(l.Rect=Zie(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=ur.createDefaultAppearanceStream(l),Sn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var A=eoe(l);c.push({key:"AP",value:"<</N "+A+">>"}),s.internal.acroformPlugin.xForms.push(A)}if(l.appearanceStreamContent){var u="";for(var f in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(f)){var h=l.appearanceStreamContent[f];if(u+="/"+f+" ",u+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var m=h[o];typeof m=="function"&&(m=m.call(s,l)),u+="/"+o+" "+m+" ",s.internal.acroformPlugin.xForms.indexOf(m)>=0||s.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(s,l)),u+="/"+o+" "+m,s.internal.acroformPlugin.xForms.indexOf(m)>=0||s.internal.acroformPlugin.xForms.push(m);u+=">>"}c.push({key:"AP",value:`<<
`+u+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}i&&function(p,g){for(var x in p)if(p.hasOwnProperty(x)){var b=x,w=p[x];g.internal.newObjectDeferredBegin(w.objId,!0),Sn(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete p[b]}}(s.internal.acroformPlugin.xForms,s)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},KM=js.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var s="[",i=0;i<t.length;i++)switch(i!==0&&(s+=" "),Sn(t[i])){case"boolean":case"number":case"object":s+=t[i].toString();break;case"string":t[i].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),s+="("+ef(n(t[i].toString()))+")"):s+=t[i].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},VN=function(t,e,r){var n=function(s){return s};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),"("+ef(n(t))+")"},bc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};bc.prototype.toString=function(){return this.objId+" 0 R"},bc.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},bc.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],s=this[n];s&&(Array.isArray(s)?t.push({key:n,value:KM(s,this.objId,this.scope)}):s instanceof bc?(s.scope=this.scope,t.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&t.push({key:n,value:s}))}return t};var qM=function(){bc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};so(qM,bc);var GM=function(){bc.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+ef(r(t))+")"}},set:function(r){t=r}})};so(GM,bc);var Xl=function t(){bc.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');e=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!qs(e,3)},set:function(x){x?this.F=Gs(e,3):this.F=$s(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Nb)return;i="FieldObject"+t.FieldNum++}var x=function(b){return b};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+ef(x(i))+")"},set:function(x){i=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(x){i=x}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(x){c=x}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/sI:d},set:function(x){d=x}});var A="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return A},set:function(x){A=x}});var u="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!u||this instanceof Nb||this instanceof eu))return VN(u,this.objId,this.scope)},set:function(x){x=x.toString(),u=x}});var f=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof ua==0?VN(f,this.objId,this.scope):f},set:function(x){x=x.toString(),f=this instanceof ua==0?x.substr(0,1)==="("?jf(x.substr(1,x.length-2)):jf(x):x}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ua==1?jf(f.substr(1,f.length-1)):f},set:function(x){x=x.toString(),f=this instanceof ua==1?"/"+x:x}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof ua==0?VN(h,this.objId,this.scope):h},set:function(x){x=x.toString(),h=this instanceof ua==0?x.substr(0,1)==="("?jf(x.substr(1,x.length-2)):jf(x):x}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ua==1?jf(h.substr(1,h.length-1)):h},set:function(x){x=x.toString(),h=this instanceof ua==1?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(x){x=!!x,p=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(x){m=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,1)},set:function(x){x?this.Ff=Gs(this.Ff,1):this.Ff=$s(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,2)},set:function(x){x?this.Ff=Gs(this.Ff,2):this.Ff=$s(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,3)},set:function(x){x?this.Ff=Gs(this.Ff,3):this.Ff=$s(this.Ff,3)}});var g=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(g!==null)return g},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');g=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(g){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:g=2;break;case"center":case 1:g=1;break;default:g=0}}})};so(Xl,bc);var hh=function(){Xl.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return KM(e,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(i,o,l){l||(l=1);for(var c,d=[];c=o.exec(i);)d.push(c[l]);return d}(n,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,18)},set:function(r){r?this.Ff=Gs(this.Ff,18):this.Ff=$s(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Gs(this.Ff,19):this.Ff=$s(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,20)},set:function(r){r?(this.Ff=Gs(this.Ff,20),e.sort()):this.Ff=$s(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,22)},set:function(r){r?this.Ff=Gs(this.Ff,22):this.Ff=$s(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,23)},set:function(r){r?this.Ff=Gs(this.Ff,23):this.Ff=$s(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,27)},set:function(r){r?this.Ff=Gs(this.Ff,27):this.Ff=$s(this.Ff,27)}}),this.hasAppearanceStream=!1};so(hh,Xl);var fh=function(){hh.call(this),this.fontName="helvetica",this.combo=!1};so(fh,hh);var mh=function(){fh.call(this),this.combo=!0};so(mh,fh);var eg=function(){mh.call(this),this.edit=!0};so(eg,mh);var ua=function(){Xl.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,15)},set:function(r){r?this.Ff=Gs(this.Ff,15):this.Ff=$s(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,16)},set:function(r){r?this.Ff=Gs(this.Ff,16):this.Ff=$s(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,17)},set:function(r){r?this.Ff=Gs(this.Ff,17):this.Ff=$s(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,26)},set:function(r){r?this.Ff=Gs(this.Ff,26):this.Ff=$s(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,s=[];for(n in s.push("<<"),e)s.push("/"+n+" ("+ef(r(e[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){Sn(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};so(ua,Xl);var tg=function(){ua.call(this),this.pushButton=!0};so(tg,ua);var ph=function(){ua.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};so(ph,ua);var Nb=function(){var t,e;Xl.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),n)o.push("/"+i+" ("+ef(s(n[i]))+")");return o.push(">>"),o.join(`
`)},set:function(s){Sn(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ur.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};so(Nb,Xl),ph.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},ph.prototype.createOption=function(t){var e=new Nb;return e.Parent=this,e.optionName=t,this.Kids.push(e),soe.call(this.scope,e),e};var rg=function(){ua.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ur.CheckBox.createAppearanceStream()};so(rg,ua);var eu=function(){Xl.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,13)},set:function(e){e?this.Ff=Gs(this.Ff,13):this.Ff=$s(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,21)},set:function(e){e?this.Ff=Gs(this.Ff,21):this.Ff=$s(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,23)},set:function(e){e?this.Ff=Gs(this.Ff,23):this.Ff=$s(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,24)},set:function(e){e?this.Ff=Gs(this.Ff,24):this.Ff=$s(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,25)},set:function(e){e?this.Ff=Gs(this.Ff,25):this.Ff=$s(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,26)},set:function(e){e?this.Ff=Gs(this.Ff,26):this.Ff=$s(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};so(eu,Xl);var ng=function(){eu.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!qs(this.Ff,14)},set:function(t){t?this.Ff=Gs(this.Ff,14):this.Ff=$s(this.Ff,14)}}),this.password=!0};so(ng,eu);var ur={CheckBox:{createAppearanceStream:function(){return{N:{On:ur.CheckBox.YesNormal},D:{On:ur.CheckBox.YesPushDown,Off:ur.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=hc(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),i=EE(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Rr(ur.internal.getWidth(t))+" "+Rr(ur.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Rr(i.fontSize)+" Tf "+s),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=hc(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=[],i=ur.internal.getHeight(t),o=ur.internal.getWidth(t),l=EE(t,t.caption);return s.push("1 g"),s.push("0 0 "+Rr(o)+" "+Rr(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+Rr(o-1)+" "+Rr(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+Rr(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(t){var e=hc(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Rr(ur.internal.getWidth(t))+" "+Rr(ur.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:ur.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=ur.RadioButton.Circle.YesNormal,e.D[t]=ur.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=hc(t);e.scope=t.scope;var r=[],n=ur.internal.getWidth(t)<=ur.internal.getHeight(t)?ur.internal.getWidth(t)/4:ur.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=ur.internal.Bezier_C,i=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+dA(ur.internal.getWidth(t)/2)+" "+dA(ur.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=hc(t);e.scope=t.scope;var r=[],n=ur.internal.getWidth(t)<=ur.internal.getHeight(t)?ur.internal.getWidth(t)/4:ur.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*ur.internal.Bezier_C).toFixed(5)),o=Number((n*ur.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+dA(ur.internal.getWidth(t)/2)+" "+dA(ur.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+dA(ur.internal.getWidth(t)/2)+" "+dA(ur.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=hc(t);e.scope=t.scope;var r=[],n=ur.internal.getWidth(t)<=ur.internal.getHeight(t)?ur.internal.getWidth(t)/4:ur.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),i=Number((s*ur.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+dA(ur.internal.getWidth(t)/2)+" "+dA(ur.internal.getHeight(t)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:ur.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=ur.RadioButton.Cross.YesNormal,e.D[t]=ur.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=hc(t);e.scope=t.scope;var r=[],n=ur.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Rr(ur.internal.getWidth(t)-2)+" "+Rr(ur.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Rr(n.x1.x)+" "+Rr(n.x1.y)+" m"),r.push(Rr(n.x2.x)+" "+Rr(n.x2.y)+" l"),r.push(Rr(n.x4.x)+" "+Rr(n.x4.y)+" m"),r.push(Rr(n.x3.x)+" "+Rr(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=hc(t);e.scope=t.scope;var r=ur.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+Rr(ur.internal.getWidth(t))+" "+Rr(ur.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Rr(ur.internal.getWidth(t)-2)+" "+Rr(ur.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Rr(r.x1.x)+" "+Rr(r.x1.y)+" m"),n.push(Rr(r.x2.x)+" "+Rr(r.x2.y)+" l"),n.push(Rr(r.x4.x)+" "+Rr(r.x4.y)+" m"),n.push(Rr(r.x3.x)+" "+Rr(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=hc(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Rr(ur.internal.getWidth(t))+" "+Rr(ur.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};ur.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=ur.internal.getWidth(t),r=ur.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},ur.internal.getWidth=function(t){var e=0;return Sn(t)==="object"&&(e=kT(t.Rect[2])),e},ur.internal.getHeight=function(t){var e=0;return Sn(t)==="object"&&(e=kT(t.Rect[3])),e};var soe=js.addField=function(t){if(noe(this,t),!(t instanceof Xl))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};js.AcroFormChoiceField=hh,js.AcroFormListBox=fh,js.AcroFormComboBox=mh,js.AcroFormEditBox=eg,js.AcroFormButton=ua,js.AcroFormPushButton=tg,js.AcroFormRadioButton=ph,js.AcroFormCheckBox=rg,js.AcroFormTextField=eu,js.AcroFormPasswordField=ng,js.AcroFormAppearance=ur,js.AcroForm={ChoiceField:hh,ListBox:fh,ComboBox:mh,EditBox:eg,Button:ua,PushButton:tg,RadioButton:ph,CheckBox:rg,TextField:eu,PasswordField:ng,Appearance:ur},cr.AcroForm={ChoiceField:hh,ListBox:fh,ComboBox:mh,EditBox:eg,Button:ua,PushButton:tg,RadioButton:ph,CheckBox:rg,TextField:eu,PasswordField:ng,Appearance:ur};var aoe=cr.AcroForm;function $M(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){var e="addImage_";t.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=t.__addimage__.getImageFileTypeByImageData=function(_,F){var D,X,ge,ae,fe,me=r;if((F=F||r)==="RGBA"||_.data!==void 0&&_.data instanceof Uint8ClampedArray&&"height"in _&&"width"in _)return"RGBA";if(L(_))for(fe in n)for(ge=n[fe],D=0;D<ge.length;D+=1){for(ae=!0,X=0;X<ge[D].length;X+=1)if(ge[D][X]!==void 0&&ge[D][X]!==_[X]){ae=!1;break}if(ae===!0){me=fe;break}}else for(fe in n)for(ge=n[fe],D=0;D<ge.length;D+=1){for(ae=!0,X=0;X<ge[D].length;X+=1)if(ge[D][X]!==void 0&&ge[D][X]!==_.charCodeAt(X)){ae=!1;break}if(ae===!0){me=fe;break}}return me===r&&F!==r&&(me=F),me},i=function _(F){for(var D=this.internal.write,X=this.internal.putStream,ge=(0,this.internal.getFilters)();ge.indexOf("FlateEncode")!==-1;)ge.splice(ge.indexOf("FlateEncode"),1);F.objectId=this.internal.newObject();var ae=[];if(ae.push({key:"Type",value:"/XObject"}),ae.push({key:"Subtype",value:"/Image"}),ae.push({key:"Width",value:F.width}),ae.push({key:"Height",value:F.height}),F.colorSpace===x.INDEXED?ae.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(F.palette.length/3-1)+" "+("sMask"in F&&F.sMask!==void 0?F.objectId+2:F.objectId+1)+" 0 R]"}):(ae.push({key:"ColorSpace",value:"/"+F.colorSpace}),F.colorSpace===x.DEVICE_CMYK&&ae.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ae.push({key:"BitsPerComponent",value:F.bitsPerComponent}),"decodeParameters"in F&&F.decodeParameters!==void 0&&ae.push({key:"DecodeParms",value:"<<"+F.decodeParameters+">>"}),"transparency"in F&&Array.isArray(F.transparency)&&F.transparency.length>0){for(var fe="",me=0,Z=F.transparency.length;me<Z;me++)fe+=F.transparency[me]+" "+F.transparency[me]+" ";ae.push({key:"Mask",value:"["+fe+"]"})}F.sMask!==void 0&&ae.push({key:"SMask",value:F.objectId+1+" 0 R"});var ye=F.filter!==void 0?["/"+F.filter]:void 0;if(X({data:F.data,additionalKeyValues:ae,alreadyAppliedFilters:ye,objectId:F.objectId}),D("endobj"),"sMask"in F&&F.sMask!==void 0){var Ie,I=(Ie=F.sMaskBitsPerComponent)!==null&&Ie!==void 0?Ie:F.bitsPerComponent,j={width:F.width,height:F.height,colorSpace:"DeviceGray",bitsPerComponent:I,data:F.sMask};"filter"in F&&(j.decodeParameters="/Predictor ".concat(F.predictor," /Colors 1 /BitsPerComponent ").concat(I," /Columns ").concat(F.width),j.filter=F.filter),_.call(this,j)}if(F.colorSpace===x.INDEXED){var Q=this.internal.newObject();X({data:B(new Uint8Array(F.palette)),objectId:Q}),D("endobj")}},o=function(){var _=this.internal.collections[e+"images"];for(var F in _)i.call(this,_[F])},l=function(){var _,F=this.internal.collections[e+"images"],D=this.internal.write;for(var X in F)D("/I"+(_=F[X]).index,_.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var _=this.internal.collections[e+"images"];return c.call(this),_},A=function(){return Object.keys(this.internal.collections[e+"images"]).length},u=function(_){return typeof t["process"+_.toUpperCase()]=="function"},f=function(_){return Sn(_)==="object"&&_.nodeType===1},h=function(_,F){if(_.nodeName==="IMG"&&_.hasAttribute("src")){var D=""+_.getAttribute("src");if(D.indexOf("data:image/")===0)return xy(unescape(D).split("base64,").pop());var X=t.loadFile(D,!0);if(X!==void 0)return X}if(_.nodeName==="CANVAS"){if(_.width===0||_.height===0)throw new Error("Given canvas must have data. Canvas width: "+_.width+", height: "+_.height);var ge;switch(F){case"PNG":ge="image/png";break;case"WEBP":ge="image/webp";break;default:ge="image/jpeg"}return xy(_.toDataURL(ge,1).split("base64,").pop())}},m=function(_){var F=this.internal.collections[e+"images"];if(F){for(var D in F)if(_===F[D].alias)return F[D]}},p=function(_,F,D){return _||F||(_=-96,F=-96),_<0&&(_=-1*D.width*72/_/this.internal.scaleFactor),F<0&&(F=-1*D.height*72/F/this.internal.scaleFactor),_===0&&(_=F*D.width/D.height),F===0&&(F=_*D.height/D.width),[_,F]},g=function(_,F,D,X,ge,ae){var fe=p.call(this,D,X,ge),me=this.internal.getCoordinateString,Z=this.internal.getVerticalCoordinateString,ye=d.call(this);if(D=fe[0],X=fe[1],ye[ge.index]=ge,ae){ae*=Math.PI/180;var Ie=Math.cos(ae),I=Math.sin(ae),j=function(T){return T.toFixed(4)},Q=[j(Ie),j(I),j(-1*I),j(Ie),0,0,"cm"]}this.internal.write("q"),ae?(this.internal.write([1,"0","0",1,me(_),Z(F+X),"cm"].join(" ")),this.internal.write(Q.join(" ")),this.internal.write([me(D),"0","0",me(X),"0","0","cm"].join(" "))):this.internal.write([me(D),"0","0",me(X),me(_),Z(F+X),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ge.index+" Do"),this.internal.write("Q")},x=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=t.__addimage__.sHashCode=function(_){var F,D,X=0;if(typeof _=="string")for(D=_.length,F=0;F<D;F++)X=(X<<5)-X+_.charCodeAt(F),X|=0;else if(L(_))for(D=_.byteLength/2,F=0;F<D;F++)X=(X<<5)-X+_[F],X|=0;return X},k=t.__addimage__.validateStringAsBase64=function(_){(_=_||"").toString().trim();var F=!0;return _.length===0&&(F=!1),_.length%4!=0&&(F=!1),/^[A-Za-z0-9+/]+$/.test(_.substr(0,_.length-2))===!1&&(F=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(_.substr(-2))===!1&&(F=!1),F},O=t.__addimage__.extractImageFromDataUrl=function(_){if(_==null||!(_=_.trim()).startsWith("data:"))return null;var F=_.indexOf(",");return F<0?null:_.substring(0,F).trim().endsWith("base64")?_.substring(F+1):null};t.__addimage__.isArrayBuffer=function(_){return _ instanceof ArrayBuffer};var L=t.__addimage__.isArrayBufferView=function(_){return _ instanceof Int8Array||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Int16Array||_ instanceof Uint16Array||_ instanceof Int32Array||_ instanceof Uint32Array||_ instanceof Float32Array||_ instanceof Float64Array},E=t.__addimage__.binaryStringToUint8Array=function(_){for(var F=_.length,D=new Uint8Array(F),X=0;X<F;X++)D[X]=_.charCodeAt(X);return D},B=t.__addimage__.arrayBufferToBinaryString=function(_){for(var F="",D=L(_)?_:new Uint8Array(_),X=0;X<D.length;X+=8192)F+=String.fromCharCode.apply(null,D.subarray(X,X+8192));return F};t.addImage=function(){var _,F,D,X,ge,ae,fe,me,Z;if(typeof arguments[1]=="number"?(F=r,D=arguments[1],X=arguments[2],ge=arguments[3],ae=arguments[4],fe=arguments[5],me=arguments[6],Z=arguments[7]):(F=arguments[1],D=arguments[2],X=arguments[3],ge=arguments[4],ae=arguments[5],fe=arguments[6],me=arguments[7],Z=arguments[8]),Sn(_=arguments[0])==="object"&&!f(_)&&"imageData"in _){var ye=_;_=ye.imageData,F=ye.format||F||r,D=ye.x||D||0,X=ye.y||X||0,ge=ye.w||ye.width||ge,ae=ye.h||ye.height||ae,fe=ye.alias||fe,me=ye.compression||me,Z=ye.rotation||ye.angle||Z}var Ie=this.internal.getFilters();if(me===void 0&&Ie.indexOf("FlateEncode")!==-1&&(me="SLOW"),isNaN(D)||isNaN(X))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var I=S.call(this,_,F,fe,me);return g.call(this,D,X,ge,ae,I,Z),this};var S=function(_,F,D,X){var ge,ae,fe;if(typeof _=="string"&&s(_)===r){_=unescape(_);var me=U(_,!1);(me!==""||(me=t.loadFile(_,!0))!==void 0)&&(_=me)}if(f(_)&&(_=h(_,F)),F=s(_,F),!u(F))throw new Error("addImage does not support files of type '"+F+"', please ensure that a plugin for '"+F+"' support is added.");if(((fe=D)==null||fe.length===0)&&(D=function(Z){return typeof Z=="string"||L(Z)?w(Z):L(Z.data)?w(Z.data):null}(_)),(ge=m.call(this,D))||(_ instanceof Uint8Array||F==="RGBA"||(ae=_,_=E(_)),ge=this["process"+F.toUpperCase()](_,A.call(this),D,function(Z){return Z&&typeof Z=="string"&&(Z=Z.toUpperCase()),Z in t.image_compression?Z:b.NONE}(X),ae)),!ge)throw new Error("An unknown error occurred whilst processing the image.");return ge},U=t.__addimage__.convertBase64ToBinaryString=function(_,F){F=typeof F!="boolean"||F;var D,X="";if(typeof _=="string"){var ge;D=(ge=O(_))!==null&&ge!==void 0?ge:_;try{X=xy(D)}catch(ae){if(F)throw k(D)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ae.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return X};t.getImageProperties=function(_){var F,D,X="";if(f(_)&&(_=h(_)),typeof _=="string"&&s(_)===r&&((X=U(_,!1))===""&&(X=t.loadFile(_)||""),_=X),D=s(_),!u(D))throw new Error("addImage does not support files of type '"+D+"', please ensure that a plugin for '"+D+"' support is added.");if(_ instanceof Uint8Array||(_=E(_)),!(F=this["process"+D.toUpperCase()](_)))throw new Error("An unknown error occurred whilst processing the image");return F.fileType=D,F}})(cr.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};cr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,s,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,A=!1,u=0;u<d.length&&!A;u++)switch((n=d[u]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(A=!0);break;case"reference":case"text":case"freetext":A=!0}if(A!=0){this.internal.write("/Annots [");for(var f=0;f<d.length;f++){n=d[f];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),g=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(p.objId),b=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(x(n.contents))+")",i+=" /Popup "+g.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+h(x(b))+") >>",p.content=i;var w=p.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(i+=" /Open true"),i+=" >>",g.content=i,this.internal.write(p.objId,"0 R",g.objId,"0 R");break;case"freetext":s="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var k=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+h(m(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+k+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var O=this.annotations._nameMap[n.options.name];n.options.pageNumber=O.page,n.options.top=O.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;default:var L=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+L+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,s,i,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:d(n),w:c(r+s),h:d(n+i)},options:o,type:"link"})},t.textWithLink=function(r,n,s,i){var o,l,c=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var A=this.splitTextToSize(r,l).length;o=Math.ceil(d*A)}else l=c,o=d;return this.text(r,n,s,i),s+=.2*d,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,s-d,l,o,i),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(cr.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];t.__arabicParser__={};var i=t.__arabicParser__.isInArabicSubstitutionA=function(p){return e[p.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},l=t.__arabicParser__.isArabicEndLetter=function(p){return o(p)&&i(p)&&e[p.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(p){return o(p)&&s.indexOf(p.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return o(p)&&i(p)&&e[p.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(p){return o(p)&&i(p)&&e[p.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(p){return o(p)&&i(p)&&e[p.charCodeAt(0)].length>=3};var A=t.__arabicParser__.arabicLetterHasMedialForm=function(p){return o(p)&&i(p)&&e[p.charCodeAt(0)].length==4},u=t.__arabicParser__.resolveLigatures=function(p){var g=0,x=r,b="",w=0;for(g=0;g<p.length;g+=1)x[p.charCodeAt(g)]!==void 0?(w++,typeof(x=x[p.charCodeAt(g)])=="number"&&(b+=String.fromCharCode(x),x=r,w=0),g===p.length-1&&(x=r,b+=p.charAt(g-(w-1)),g-=w-1,w=0)):(x=r,b+=p.charAt(g-w),g-=w,w=0);return b};t.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&n[p.charCodeAt(0)]!==void 0};var f=t.__arabicParser__.getCorrectForm=function(p,g,x){return o(p)?i(p)===!1?-1:!d(p)||!o(g)&&!o(x)||!o(x)&&l(g)||l(p)&&!o(g)||l(p)&&c(g)||l(p)&&l(g)?0:A(p)&&o(g)&&!l(g)&&o(x)&&d(x)?3:l(p)||!o(x)?1:2:-1},h=function(p){var g=0,x=0,b=0,w="",k="",O="",L=(p=p||"").split("\\s+"),E=[];for(g=0;g<L.length;g+=1){for(E.push(""),x=0;x<L[g].length;x+=1)w=L[g][x],k=L[g][x-1],O=L[g][x+1],o(w)?(b=f(w,k,O),E[g]+=b!==-1?String.fromCharCode(e[w.charCodeAt(0)][b]):w):E[g]+=w;E[g]=u(E[g])}return E.join(" ")},m=t.__arabicParser__.processArabic=t.processArabic=function(){var p,g=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(g)){var b=0;for(x=[],b=0;b<g.length;b+=1)Array.isArray(g[b])?x.push([h(g[b][0]),g[b][1],g[b][2]]):x.push([h(g[b])]);p=x}else p=h(g);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};t.events.push(["preProcessText",m])}(cr.API),cr.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(cr.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var A=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return A},set:function(p){A=p}});var u=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var f=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return f},set:function(p){f=p}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(p){m=p}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,d){n.call(this);var A=(d=d||{}).fontSize||this.getFontSize(),u=d.font||this.getFont(),f=d.scaleFactor||this.internal.scaleFactor,h=0,m=0,p=0,g=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var x=d.maxWidth;x>0?typeof c=="string"?c=this.splitTextToSize(c,x):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,k){return w.concat(g.splitTextToSize(k,x))},[])):c=Array.isArray(c)?c:[c];for(var b=0;b<c.length;b++)h<(p=this.getStringUnitWidth(c[b],{font:u})*A)&&(h=p);return h!==0&&(m=c.length),{w:h/=f,h:Math.max((m*A*this.getLineHeightFactor()-A*(this.getLineHeightFactor()-1))/f,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var d=this.internal.__cell__.lastCell,A=this.internal.__cell__.padding,u=this.internal.__cell__.margins||e,f=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+u.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=u.top,h&&f&&(this.printHeaderRow(c.lineNumber,!0),c.y+=f[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-A,c.y+A,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+A,{align:"center",baseline:"top",maxWidth:c.width-A-A}):this.text(c.text,c.x+A,c.y+A,{align:"left",baseline:"top",maxWidth:c.width-A-A})),this.internal.__cell__.lastCell=c,this};t.table=function(c,d,A,u,f){if(n.call(this),!A)throw new Error("No data for PDF table.");var h,m,p,g,x=[],b=[],w=[],k={},O={},L=[],E=[],B=(f=f||{}).autoSize||!1,S=f.printHeaders!==!1,U=f.css&&f.css["font-size"]!==void 0?16*f.css["font-size"]:f.fontSize||12,_=f.margins||Object.assign({width:this.getPageWidth()},e),F=typeof f.padding=="number"?f.padding:3,D=f.headerBackgroundColor||"#c8c8c8",X=f.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=S,this.internal.__cell__.margins=_,this.internal.__cell__.table_font_size=U,this.internal.__cell__.padding=F,this.internal.__cell__.headerBackgroundColor=D,this.internal.__cell__.headerTextColor=X,this.setFontSize(U),u==null)b=x=Object.keys(A[0]),w=x.map(function(){return"left"});else if(Array.isArray(u)&&Sn(u[0])==="object")for(x=u.map(function(ye){return ye.name}),b=u.map(function(ye){return ye.prompt||ye.name||""}),w=u.map(function(ye){return ye.align||"left"}),h=0;h<u.length;h+=1)O[u[h].name]=.7499990551181103*u[h].width;else Array.isArray(u)&&typeof u[0]=="string"&&(b=x=u,w=x.map(function(){return"left"}));if(B||Array.isArray(u)&&typeof u[0]=="string")for(h=0;h<x.length;h+=1){for(k[g=x[h]]=A.map(function(ye){return ye[g]}),this.setFont(void 0,"bold"),L.push(this.getTextDimensions(b[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=k[g],this.setFont(void 0,"normal"),p=0;p<m.length;p+=1)L.push(this.getTextDimensions(m[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);O[g]=Math.max.apply(null,L)+F+F,L=[]}if(S){var ge={};for(h=0;h<x.length;h+=1)ge[x[h]]={},ge[x[h]].text=b[h],ge[x[h]].align=w[h];var ae=l.call(this,ge,O);E=x.map(function(ye){return new i(c,d,O[ye],ae,ge[ye].text,void 0,ge[ye].align)}),this.setTableHeaderRow(E),this.printHeaderRow(1,!1)}var fe=u.reduce(function(ye,Ie){return ye[Ie.name]=Ie.align,ye},{});for(h=0;h<A.length;h+=1){"rowStart"in f&&f.rowStart instanceof Function&&f.rowStart({row:h,data:A[h]},this);var me=l.call(this,A[h],O);for(p=0;p<x.length;p+=1){var Z=A[h][x[p]];"cellStart"in f&&f.cellStart instanceof Function&&f.cellStart({row:h,col:p,data:Z},this),o.call(this,new i(c,d,O[x[p]],me,Z,h+2,fe[x[p]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var A=this.internal.__cell__.padding,u=this.internal.__cell__.table_font_size,f=this.internal.scaleFactor;return Object.keys(c).map(function(h){var m=c[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,d[h]-A-A)},this).map(function(h){return this.getLineHeightFactor()*h.length*u/f+A+A},this).reduce(function(h,m){return Math.max(h,m)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,d){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var A;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var u=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(u[0],u[1],u[2],u[3],void 0,-1)}this.setFont(void 0,"bold");for(var f=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){A=this.internal.__cell__.tableHeaderRow[h].clone(),d&&(A.y=this.internal.__cell__.margins.top||0,f.push(A)),A.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,A),this.setTextColor(m)}f.length>0&&this.setTableHeaderRow(f),this.setFont(void 0,"normal"),r=!1}}(cr.API);var zM={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},WM=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],BE=$M(WM),JM=[100,200,300,400,500,600,700,800,900],ioe=$M(JM);function HN(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return zM[i=i||"normal"]?i:"normal"}(t.style),n=function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400}(t.weight),s=function(i){return typeof BE[i=i||"normal"]=="number"?i:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:s,src:t.src||[],ref:t.ref||{name:e,style:[s,r,n].join(" ")}}}function FT(t,e,r,n){var s;for(s=r;s>=0&&s<e.length;s+=n)if(t[e[s]])return t[e[s]];for(s=r;s>=0&&s<e.length;s-=n)if(t[e[s]])return t[e[s]]}var ooe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},TT={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function PT(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function RT(t){return t.trimLeft()}function loe(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function coe(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var p1,DT,LT,kf,g1,UT,OT,MT,KN=["times"];function QT(t,e,r,n,s){var i=4,o=HT;switch(s){case cr.API.image_compression.FAST:i=1,o=VT;break;case cr.API.image_compression.MEDIUM:i=6,o=KT;break;case cr.API.image_compression.SLOW:i=9,o=qT}t=function(c,d,A,u){for(var f,h=c.length/d,m=new Uint8Array(c.length+h),p=[doe,VT,HT,KT,qT],g=0;g<h;g+=1){var x=g*d,b=c.subarray(x,x+d);if(u)m.set(u(b,A,f),x+g);else{for(var w=p.length,k=[],O=0;O<w;O+=1)k[O]=p[O](b,A,f);var L=uoe(k.concat());m.set(k[L],x+g)}f=b}return m}(t,e,Math.ceil(r*n/8),o);var l=yE(t,{level:i});return cr.API.__addimage__.arrayBufferToBinaryString(l)}function doe(t){var e=Array.apply([],t);return e.unshift(0),e}function VT(t,e){var r=t.length,n=[];n[0]=1;for(var s=0;s<r;s+=1){var i=t[s-e]||0;n[s+1]=t[s]-i+256&255}return n}function HT(t,e,r){var n=t.length,s=[];s[0]=2;for(var i=0;i<n;i+=1){var o=r&&r[i]||0;s[i+1]=t[i]-o+256&255}return s}function KT(t,e,r){var n=t.length,s=[];s[0]=3;for(var i=0;i<n;i+=1){var o=t[i-e]||0,l=r&&r[i]||0;s[i+1]=t[i]+256-(o+l>>>1)&255}return s}function qT(t,e,r){var n=t.length,s=[];s[0]=4;for(var i=0;i<n;i+=1){var o=Aoe(t[i-e]||0,r&&r[i]||0,r&&r[i-e]||0);s[i+1]=t[i]-o+256&255}return s}function Aoe(t,e,r){if(t===e&&e===r)return t;var n=Math.abs(e-r),s=Math.abs(t-r),i=Math.abs(t+e-r-r);return n<=s&&n<=i?t:s<=i?e:r}function uoe(t){var e=t.map(function(r){return r.reduce(function(n,s){return n+Math.abs(s)},0)});return e.indexOf(Math.min.apply(null,e))}function qN(t,e,r){var n=e*r,s=Math.floor(n/8),i=16-(n-8*s+r),o=(1<<r)-1;return XM(t,s)>>i&o}function GT(t,e,r,n){var s=r*n,i=Math.floor(s/8),o=16-(s-8*i+n),l=(1<<n)-1,c=(e&l)<<o;(function(d,A,u){if(A+1<d.byteLength)d.setUint16(A,u,!1);else{var f=u>>8&255;d.setUint8(A,f)}})(t,i,XM(t,i)&~(l<<o)&65535|c)}function XM(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function hoe(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,s=t[e++],i=s>>7,o=1<<1+(7&s);t[e++],t[e++];var l=null,c=null;i&&(l=e,c=o,e+=3*o);var d=!0,A=[],u=0,f=null,h=0,m=null;for(this.width=r,this.height=n;d&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,m=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var p=t[e++];u=t[e++]|t[e++]<<8,f=t[e++],1&p||(f=null),h=p>>2&7,e++;break;case 254:for(;;){if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var g=t[e++]|t[e++]<<8,x=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,w=t[e++]|t[e++]<<8,k=t[e++],O=k>>6&1,L=1<<1+(7&k),E=l,B=c,S=!1;k>>7&&(S=!0,E=e,B=L,e+=3*L);var U=e;for(e++;;){var _;if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}A.push({x:g,y:x,width:b,height:w,has_local_palette:S,palette_offset:E,palette_size:B,data_offset:U,data_length:e-U,transparent_index:f,interlaced:!!O,delay:u,disposal:h});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return A.length},this.loopCount=function(){return m},this.frameInfo=function(F){if(F<0||F>=A.length)throw new Error("Frame index out of range.");return A[F]},this.decodeAndBlitFrameBGRA=function(F,D){var X=this.frameInfo(F),ge=X.width*X.height,ae=new Uint8Array(ge);$T(t,X.data_offset,ae,ge);var fe=X.palette_offset,me=X.transparent_index;me===null&&(me=256);var Z=X.width,ye=r-Z,Ie=Z,I=4*(X.y*r+X.x),j=4*((X.y+X.height)*r+X.x),Q=I,T=4*ye;X.interlaced===!0&&(T+=4*r*7);for(var R=8,K=0,M=ae.length;K<M;++K){var re=ae[K];if(Ie===0&&(Ie=Z,(Q+=T)>=j&&(T=4*ye+4*r*(R-1),Q=I+(Z+ye)*(R<<1),R>>=1)),re===me)Q+=4;else{var de=t[fe+3*re],le=t[fe+3*re+1],q=t[fe+3*re+2];D[Q++]=q,D[Q++]=le,D[Q++]=de,D[Q++]=255}--Ie}},this.decodeAndBlitFrameRGBA=function(F,D){var X=this.frameInfo(F),ge=X.width*X.height,ae=new Uint8Array(ge);$T(t,X.data_offset,ae,ge);var fe=X.palette_offset,me=X.transparent_index;me===null&&(me=256);var Z=X.width,ye=r-Z,Ie=Z,I=4*(X.y*r+X.x),j=4*((X.y+X.height)*r+X.x),Q=I,T=4*ye;X.interlaced===!0&&(T+=4*r*7);for(var R=8,K=0,M=ae.length;K<M;++K){var re=ae[K];if(Ie===0&&(Ie=Z,(Q+=T)>=j&&(T=4*ye+4*r*(R-1),Q=I+(Z+ye)*(R<<1),R>>=1)),re===me)Q+=4;else{var de=t[fe+3*re],le=t[fe+3*re+1],q=t[fe+3*re+2];D[Q++]=de,D[Q++]=le,D[Q++]=q,D[Q++]=255}--Ie}}}function $T(t,e,r,n){for(var s=t[e++],i=1<<s,o=i+1,l=o+1,c=s+1,d=(1<<c)-1,A=0,u=0,f=0,h=t[e++],m=new Int32Array(4096),p=null;;){for(;A<16&&h!==0;)u|=t[e++]<<A,A+=8,h===1?h=t[e++]:--h;if(A<c)break;var g=u&d;if(u>>=c,A-=c,g!==i){if(g===o)break;for(var x=g<l?g:p,b=0,w=x;w>i;)w=m[w]>>8,++b;var k=w;if(f+b+(x!==g?1:0)>n)return void Vn.log("Warning, gif stream longer than expected.");r[f++]=k;var O=f+=b;for(x!==g&&(r[f++]=k),w=x;b--;)w=m[w],r[--O]=255&w,w>>=8;p!==null&&l<4096&&(m[l++]=p<<8|k,l>=d+1&&c<12&&(++c,d=d<<1|1)),p=g}else l=o+1,d=(1<<(c=s+1))-1,p=null}return f!==n&&Vn.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function GN(t){var e,r,n,s,i,o=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),A=new Array(64),u=new Array(65535),f=new Array(65535),h=new Array(64),m=new Array(64),p=[],g=0,x=7,b=new Array(64),w=new Array(64),k=new Array(64),O=new Array(256),L=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],B=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],S=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],F=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],D=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ge=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ae(I,j){for(var Q=0,T=0,R=new Array,K=1;K<=16;K++){for(var M=1;M<=I[K];M++)R[j[T]]=[],R[j[T]][0]=Q,R[j[T]][1]=K,T++,Q++;Q*=2}return R}function fe(I){for(var j=I[0],Q=I[1]-1;Q>=0;)j&1<<Q&&(g|=1<<x),Q--,--x<0&&(g==255?(me(255),me(0)):me(g),x=7,g=0)}function me(I){p.push(I)}function Z(I){me(I>>8&255),me(255&I)}function ye(I,j,Q,T,R){for(var K,M=R[0],re=R[240],de=function(we,Pe){var Qe,tt,ot,dt,vt,lt,Ue,Xe,xe,ve,ie=0;for(xe=0;xe<8;++xe){Qe=we[ie],tt=we[ie+1],ot=we[ie+2],dt=we[ie+3],vt=we[ie+4],lt=we[ie+5],Ue=we[ie+6];var ze=Qe+(Xe=we[ie+7]),rt=Qe-Xe,At=tt+Ue,Oe=tt-Ue,at=ot+lt,Ve=ot-lt,G=dt+vt,_e=dt-vt,Me=ze+G,We=ze-G,He=At+at,st=At-at;we[ie]=Me+He,we[ie+4]=Me-He;var Ct=.707106781*(st+We);we[ie+2]=We+Ct,we[ie+6]=We-Ct;var Xt=.382683433*((Me=_e+Ve)-(st=Oe+rt)),Ot=.5411961*Me+Xt,tr=1.306562965*st+Xt,Zt=.707106781*(He=Ve+Oe),et=rt+Zt,Rt=rt-Zt;we[ie+5]=Rt+Ot,we[ie+3]=Rt-Ot,we[ie+1]=et+tr,we[ie+7]=et-tr,ie+=8}for(ie=0,xe=0;xe<8;++xe){Qe=we[ie],tt=we[ie+8],ot=we[ie+16],dt=we[ie+24],vt=we[ie+32],lt=we[ie+40],Ue=we[ie+48];var er=Qe+(Xe=we[ie+56]),Lt=Qe-Xe,Vt=tt+Ue,nr=tt-Ue,Mt=ot+lt,oe=ot-lt,J=dt+vt,ce=dt-vt,pe=er+J,Be=er-J,De=Vt+Mt,se=Vt-Mt;we[ie]=pe+De,we[ie+32]=pe-De;var Fe=.707106781*(se+Be);we[ie+16]=Be+Fe,we[ie+48]=Be-Fe;var he=.382683433*((pe=ce+oe)-(se=nr+Lt)),Re=.5411961*pe+he,Ee=1.306562965*se+he,Ze=.707106781*(De=oe+nr),Je=Lt+Ze,Ye=Lt-Ze;we[ie+40]=Ye+Re,we[ie+24]=Ye-Re,we[ie+8]=Je+Ee,we[ie+56]=Je-Ee,ie++}for(xe=0;xe<64;++xe)ve=we[xe]*Pe[xe],h[xe]=ve>0?ve+.5|0:ve-.5|0;return h}(I,j),le=0;le<64;++le)m[E[le]]=de[le];var q=m[0]-Q;Q=m[0],q==0?fe(T[0]):(fe(T[f[K=32767+q]]),fe(u[K]));for(var Se=63;Se>0&&m[Se]==0;)Se--;if(Se==0)return fe(M),Q;for(var ee,z=1;z<=Se;){for(var te=z;m[z]==0&&z<=Se;)++z;var Ne=z-te;if(Ne>=16){ee=Ne>>4;for(var Y=1;Y<=ee;++Y)fe(re);Ne&=15}K=32767+m[z],fe(R[(Ne<<4)+f[K]]),fe(u[K]),z++}return Se!=63&&fe(M),Q}function Ie(I){I=Math.min(Math.max(I,1),100),i!=I&&(function(j){for(var Q=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],T=0;T<64;T++){var R=o((Q[T]*j+50)/100);R=Math.min(Math.max(R,1),255),l[E[T]]=R}for(var K=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],M=0;M<64;M++){var re=o((K[M]*j+50)/100);re=Math.min(Math.max(re,1),255),c[E[M]]=re}for(var de=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],le=0,q=0;q<8;q++)for(var Se=0;Se<8;Se++)d[le]=1/(l[E[le]]*de[q]*de[Se]*8),A[le]=1/(c[E[le]]*de[q]*de[Se]*8),le++}(I<50?Math.floor(5e3/I):Math.floor(200-2*I)),i=I)}this.encode=function(I,j){j&&Ie(j),p=new Array,g=0,x=7,Z(65496),Z(65504),Z(16),me(74),me(70),me(73),me(70),me(0),me(1),me(1),me(0),Z(1),Z(1),me(0),me(0),function(){Z(65499),Z(132),me(0);for(var tt=0;tt<64;tt++)me(l[tt]);me(1);for(var ot=0;ot<64;ot++)me(c[ot])}(),function(tt,ot){Z(65472),Z(17),me(8),Z(ot),Z(tt),me(3),me(1),me(17),me(0),me(2),me(17),me(1),me(3),me(17),me(1)}(I.width,I.height),function(){Z(65476),Z(418),me(0);for(var tt=0;tt<16;tt++)me(B[tt+1]);for(var ot=0;ot<=11;ot++)me(S[ot]);me(16);for(var dt=0;dt<16;dt++)me(U[dt+1]);for(var vt=0;vt<=161;vt++)me(_[vt]);me(1);for(var lt=0;lt<16;lt++)me(F[lt+1]);for(var Ue=0;Ue<=11;Ue++)me(D[Ue]);me(17);for(var Xe=0;Xe<16;Xe++)me(X[Xe+1]);for(var xe=0;xe<=161;xe++)me(ge[xe])}(),Z(65498),Z(12),me(3),me(1),me(0),me(2),me(17),me(3),me(17),me(0),me(63),me(0);var Q=0,T=0,R=0;g=0,x=7,this.encode.displayName="_encode_";for(var K,M,re,de,le,q,Se,ee,z,te=I.data,Ne=I.width,Y=I.height,we=4*Ne,Pe=0;Pe<Y;){for(K=0;K<we;){for(le=we*Pe+K,Se=-1,ee=0,z=0;z<64;z++)q=le+(ee=z>>3)*we+(Se=4*(7&z)),Pe+ee>=Y&&(q-=we*(Pe+1+ee-Y)),K+Se>=we&&(q-=K+Se-we+4),M=te[q++],re=te[q++],de=te[q++],b[z]=(L[M]+L[re+256|0]+L[de+512|0]>>16)-128,w[z]=(L[M+768|0]+L[re+1024|0]+L[de+1280|0]>>16)-128,k[z]=(L[M+1280|0]+L[re+1536|0]+L[de+1792|0]>>16)-128;Q=ye(b,d,Q,e,n),T=ye(w,A,T,r,s),R=ye(k,A,R,r,s),K+=32}Pe+=8}if(x>=0){var Qe=[];Qe[1]=x+1,Qe[0]=(1<<x+1)-1,fe(Qe)}return Z(65497),new Uint8Array(p)},t=t||50,function(){for(var I=String.fromCharCode,j=0;j<256;j++)O[j]=I(j)}(),e=ae(B,S),r=ae(F,D),n=ae(U,_),s=ae(X,ge),function(){for(var I=1,j=2,Q=1;Q<=15;Q++){for(var T=I;T<j;T++)f[32767+T]=Q,u[32767+T]=[],u[32767+T][1]=Q,u[32767+T][0]=T;for(var R=-(j-1);R<=-I;R++)f[32767+R]=Q,u[32767+R]=[],u[32767+R][1]=Q,u[32767+R][0]=j-1+R;I<<=1,j<<=1}}(),function(){for(var I=0;I<256;I++)L[I]=19595*I,L[I+256|0]=38470*I,L[I+512|0]=7471*I+32768,L[I+768|0]=-11059*I,L[I+1024|0]=-21709*I,L[I+1280|0]=32768*I+8421375,L[I+1536|0]=-27439*I,L[I+1792|0]=-5329*I}(),Ie(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Sl(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function zT(t){function e(S){if(!S)throw Error("assert :P")}function r(S,U,_){for(var F=0;4>F;F++)if(S[U+F]!=_.charCodeAt(F))return!0;return!1}function n(S,U,_,F,D){for(var X=0;X<D;X++)S[U+X]=_[F+X]}function s(S,U,_,F){for(var D=0;D<F;D++)S[U+D]=_}function i(S){return new Int32Array(S)}function o(S,U){for(var _=[],F=0;F<S;F++)_.push(new U);return _}function l(S,U){var _=[];return function F(D,X,ge){for(var ae=ge[X],fe=0;fe<ae&&(D.push(ge.length>X+1?[]:new U),!(ge.length<X+1));fe++)F(D[fe],X+1,ge)}(_,0,S),_}var c=function(){var S=this;function U(v,C){for(var V=1<<C-1>>>0;v&V;)V>>>=1;return V?(v&V-1)+V:v}function _(v,C,V,W,ue){e(!(W%V));do v[C+(W-=V)]=ue;while(0<W)}function F(v,C,V,W,ue){if(e(2328>=ue),512>=ue)var be=i(512);else if((be=i(ue))==null)return 0;return function(Ce,je,Le,qe,ct,yt){var Ge,ut,gt=je,Et=1<<Le,xt=i(16),It=i(16);for(e(ct!=0),e(qe!=null),e(Ce!=null),e(0<Le),ut=0;ut<ct;++ut){if(15<qe[ut])return 0;++xt[qe[ut]]}if(xt[0]==ct)return 0;for(It[1]=0,Ge=1;15>Ge;++Ge){if(xt[Ge]>1<<Ge)return 0;It[Ge+1]=It[Ge]+xt[Ge]}for(ut=0;ut<ct;++ut)Ge=qe[ut],0<qe[ut]&&(yt[It[Ge]++]=ut);if(It[15]==1)return(qe=new D).g=0,qe.value=yt[0],_(Ce,gt,1,Et,qe),Et;var jt,Qt=-1,Pt=Et-1,vr=0,Ar=1,Mr=1,pr=1<<Le;for(ut=0,Ge=1,ct=2;Ge<=Le;++Ge,ct<<=1){if(Ar+=Mr<<=1,0>(Mr-=xt[Ge]))return 0;for(;0<xt[Ge];--xt[Ge])(qe=new D).g=Ge,qe.value=yt[ut++],_(Ce,gt+vr,ct,pr,qe),vr=U(vr,Ge)}for(Ge=Le+1,ct=2;15>=Ge;++Ge,ct<<=1){if(Ar+=Mr<<=1,0>(Mr-=xt[Ge]))return 0;for(;0<xt[Ge];--xt[Ge]){if(qe=new D,(vr&Pt)!=Qt){for(gt+=pr,jt=1<<(Qt=Ge)-Le;15>Qt&&!(0>=(jt-=xt[Qt]));)++Qt,jt<<=1;Et+=pr=1<<(jt=Qt-Le),Ce[je+(Qt=vr&Pt)].g=jt+Le,Ce[je+Qt].value=gt-je-Qt}qe.g=Ge-Le,qe.value=yt[ut++],_(Ce,gt+(vr>>Le),ct,pr,qe),vr=U(vr,Ge)}}return Ar!=2*It[15]-1?0:Et}(v,C,V,W,ue,be)}function D(){this.value=this.g=0}function X(){this.value=this.g=0}function ge(){this.G=o(5,D),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Fu,X)}function ae(v,C,V,W){e(v!=null),e(C!=null),e(2147483648>W),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=C,v.pa=V,v.Jd=C,v.Yc=V+W,v.Zc=4<=W?V+W-4+1:V,M(v)}function fe(v,C){for(var V=0;0<C--;)V|=de(v,128)<<C;return V}function me(v,C){var V=fe(v,C);return re(v)?-V:V}function Z(v,C,V,W){var ue,be=0;for(e(v!=null),e(C!=null),e(4294967288>W),v.Sb=W,v.Ra=0,v.u=0,v.h=0,4<W&&(W=4),ue=0;ue<W;++ue)be+=C[V+ue]<<8*ue;v.Ra=be,v.bb=W,v.oa=C,v.pa=V}function ye(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<Gd-8>>>0,++v.bb,v.u-=8;T(v)&&(v.h=1,v.u=0)}function Ie(v,C){if(e(0<=C),!v.h&&C<=Ao){var V=Q(v)&co[C];return v.u+=C,ye(v),V}return v.h=1,v.u=0}function I(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function j(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Q(v){return v.Ra>>>(v.u&Gd-1)>>>0}function T(v){return e(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>Gd}function R(v,C){v.u=C,v.h=T(v)}function K(v){v.u>=Vc&&(e(v.u>=Vc),ye(v))}function M(v){e(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(e(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function re(v){return fe(v,1)}function de(v,C){var V=v.Ca;0>v.b&&M(v);var W=v.b,ue=V*C>>>8,be=(v.I>>>W>ue)+0;for(be?(V-=ue,v.I-=ue+1<<W>>>0):V=ue+1,W=V,ue=0;256<=W;)ue+=8,W>>=8;return W=7^ue+$d[W],v.b-=W,v.Ca=(V<<W)-1,be}function le(v,C,V){v[C+0]=V>>24&255,v[C+1]=V>>16&255,v[C+2]=V>>8&255,v[C+3]=255&V}function q(v,C){return v[C+0]|v[C+1]<<8}function Se(v,C){return q(v,C)|v[C+2]<<16}function ee(v,C){return q(v,C)|q(v,C+2)<<16}function z(v,C){var V=1<<C;return e(v!=null),e(0<C),v.X=i(V),v.X==null?0:(v.Mb=32-C,v.Xa=C,1)}function te(v,C){e(v!=null),e(C!=null),e(v.Xa==C.Xa),n(C.X,0,v.X,0,1<<C.Xa)}function Ne(){this.X=[],this.Xa=this.Mb=0}function Y(v,C,V,W){e(V!=null),e(W!=null);var ue=V[0],be=W[0];return ue==0&&(ue=(v*be+C/2)/C),be==0&&(be=(C*ue+v/2)/v),0>=ue||0>=be?0:(V[0]=ue,W[0]=be,1)}function we(v,C){return v+(1<<C)-1>>>C}function Pe(v,C){return((4278255360&v)+(4278255360&C)>>>0&4278255360)+((16711935&v)+(16711935&C)>>>0&16711935)>>>0}function Qe(v,C){S[C]=function(V,W,ue,be,Ce,je,Le){var qe;for(qe=0;qe<Ce;++qe){var ct=S[v](je[Le+qe-1],ue,be+qe);je[Le+qe]=Pe(V[W+qe],ct)}}}function tt(){this.ud=this.hd=this.jd=0}function ot(v,C){return((4278124286&(v^C))>>>1)+(v&C)>>>0}function dt(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function vt(v,C){return dt(v+(v-C+.5>>1))}function lt(v,C,V){return Math.abs(C-V)-Math.abs(v-V)}function Ue(v,C,V,W,ue,be,Ce){for(W=be[Ce-1],V=0;V<ue;++V)be[Ce+V]=W=Pe(v[C+V],W)}function Xe(v,C,V,W,ue){var be;for(be=0;be<V;++be){var Ce=v[C+be],je=Ce>>8&255,Le=16711935&(Le=(Le=16711935&Ce)+((je<<16)+je));W[ue+be]=(4278255360&Ce)+Le>>>0}}function xe(v,C){C.jd=255&v,C.hd=v>>8&255,C.ud=v>>16&255}function ve(v,C,V,W,ue,be){var Ce;for(Ce=0;Ce<W;++Ce){var je=C[V+Ce],Le=je>>>8,qe=je,ct=255&(ct=(ct=je>>>16)+((v.jd<<24>>24)*(Le<<24>>24)>>>5));qe=255&(qe=(qe+=(v.hd<<24>>24)*(Le<<24>>24)>>>5)+((v.ud<<24>>24)*(ct<<24>>24)>>>5)),ue[be+Ce]=(4278255360&je)+(ct<<16)+qe}}function ie(v,C,V,W,ue){S[C]=function(be,Ce,je,Le,qe,ct,yt,Ge,ut){for(Le=yt;Le<Ge;++Le)for(yt=0;yt<ut;++yt)qe[ct++]=ue(je[W(be[Ce++])])},S[v]=function(be,Ce,je,Le,qe,ct,yt){var Ge=8>>be.b,ut=be.Ea,gt=be.K[0],Et=be.w;if(8>Ge)for(be=(1<<be.b)-1,Et=(1<<Ge)-1;Ce<je;++Ce){var xt,It=0;for(xt=0;xt<ut;++xt)xt&be||(It=W(Le[qe++])),ct[yt++]=ue(gt[It&Et]),It>>=Ge}else S["VP8LMapColor"+V](Le,qe,gt,Et,ct,yt,Ce,je,ut)}}function ze(v,C,V,W,ue){for(V=C+V;C<V;){var be=v[C++];W[ue++]=be>>16&255,W[ue++]=be>>8&255,W[ue++]=255&be}}function rt(v,C,V,W,ue){for(V=C+V;C<V;){var be=v[C++];W[ue++]=be>>16&255,W[ue++]=be>>8&255,W[ue++]=255&be,W[ue++]=be>>24&255}}function At(v,C,V,W,ue){for(V=C+V;C<V;){var be=(Ce=v[C++])>>16&240|Ce>>12&15,Ce=240&Ce|Ce>>28&15;W[ue++]=be,W[ue++]=Ce}}function Oe(v,C,V,W,ue){for(V=C+V;C<V;){var be=(Ce=v[C++])>>16&248|Ce>>13&7,Ce=Ce>>5&224|Ce>>3&31;W[ue++]=be,W[ue++]=Ce}}function at(v,C,V,W,ue){for(V=C+V;C<V;){var be=v[C++];W[ue++]=255&be,W[ue++]=be>>8&255,W[ue++]=be>>16&255}}function Ve(v,C,V,W,ue,be){if(be==0)for(V=C+V;C<V;)le(W,((be=v[C++])[0]>>24|be[1]>>8&65280|be[2]<<8&16711680|be[3]<<24)>>>0),ue+=32;else n(W,ue,v,C,V)}function G(v,C){S[C][0]=S[v+"0"],S[C][1]=S[v+"1"],S[C][2]=S[v+"2"],S[C][3]=S[v+"3"],S[C][4]=S[v+"4"],S[C][5]=S[v+"5"],S[C][6]=S[v+"6"],S[C][7]=S[v+"7"],S[C][8]=S[v+"8"],S[C][9]=S[v+"9"],S[C][10]=S[v+"10"],S[C][11]=S[v+"11"],S[C][12]=S[v+"12"],S[C][13]=S[v+"13"],S[C][14]=S[v+"0"],S[C][15]=S[v+"0"]}function _e(v){return v==sw||v==aw||v==sv||v==iw}function Me(){this.eb=[],this.size=this.A=this.fb=0}function We(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function He(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Me,this.f.kb=new We,this.sd=null}function st(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ct(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Xt(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function Ot(v,C){var V=v.T,W=C.ba.f.RGBA,ue=W.eb,be=W.fb+v.ka*W.A,Ce=zo[C.ba.S],je=v.y,Le=v.O,qe=v.f,ct=v.N,yt=v.ea,Ge=v.W,ut=C.cc,gt=C.dc,Et=C.Mc,xt=C.Nc,It=v.ka,jt=v.ka+v.T,Qt=v.U,Pt=Qt+1>>1;for(It==0?Ce(je,Le,null,null,qe,ct,yt,Ge,qe,ct,yt,Ge,ue,be,null,null,Qt):(Ce(C.ec,C.fc,je,Le,ut,gt,Et,xt,qe,ct,yt,Ge,ue,be-W.A,ue,be,Qt),++V);It+2<jt;It+=2)ut=qe,gt=ct,Et=yt,xt=Ge,ct+=v.Rc,Ge+=v.Rc,be+=2*W.A,Ce(je,(Le+=2*v.fa)-v.fa,je,Le,ut,gt,Et,xt,qe,ct,yt,Ge,ue,be-W.A,ue,be,Qt);return Le+=v.fa,v.j+jt<v.o?(n(C.ec,C.fc,je,Le,Qt),n(C.cc,C.dc,qe,ct,Pt),n(C.Mc,C.Nc,yt,Ge,Pt),V--):1&jt||Ce(je,Le,null,null,qe,ct,yt,Ge,qe,ct,yt,Ge,ue,be+W.A,null,null,Qt),V}function tr(v,C,V){var W=v.F,ue=[v.J];if(W!=null){var be=v.U,Ce=C.ba.S,je=Ce==nv||Ce==sv;C=C.ba.f.RGBA;var Le=[0],qe=v.ka;Le[0]=v.T,v.Kb&&(qe==0?--Le[0]:(--qe,ue[0]-=v.width),v.j+v.ka+v.T==v.o&&(Le[0]=v.o-v.j-qe));var ct=C.eb;qe=C.fb+qe*C.A,v=e5(W,ue[0],v.width,be,Le,ct,qe+(je?0:3),C.A),e(V==Le),v&&_e(Ce)&&Im(ct,qe,je,be,Le,C.A)}return 0}function Zt(v){var C=v.ma,V=C.ba.S,W=11>V,ue=V==tv||V==rv||V==nv||V==nw||V==12||_e(V);if(C.memory=null,C.Ib=null,C.Jb=null,C.Nd=null,!bm(C.Oa,v,ue?11:12))return 0;if(ue&&_e(V)&&qo(),v.da)alert("todo:use_scaling");else{if(W){if(C.Ib=Xt,v.Kb){if(V=v.U+1>>1,C.memory=i(v.U+2*V),C.memory==null)return 0;C.ec=C.memory,C.fc=0,C.cc=C.ec,C.dc=C.fc+v.U,C.Mc=C.cc,C.Nc=C.dc+V,C.Ib=Ot,qo()}}else alert("todo:EmitYUV");ue&&(C.Jb=tr,W&&Vi())}if(W&&!p5){for(v=0;256>v;++v)P7[v]=89858*(v-128)+iv>>av,L7[v]=-22014*(v-128)+iv,D7[v]=-45773*(v-128),R7[v]=113618*(v-128)+iv>>av;for(v=km;v<cw;++v)C=76283*(v-16)+iv>>av,U7[v-km]=Jn(C,255),O7[v-km]=Jn(C+8>>4,15);p5=1}return 1}function et(v){var C=v.ma,V=v.U,W=v.T;return e(!(1&v.ka)),0>=V||0>=W?0:(V=C.Ib(v,C),C.Jb!=null&&C.Jb(v,C,V),C.Dc+=V,1)}function Rt(v){v.ma.memory=null}function er(v,C,V,W){return Ie(v,8)!=47?0:(C[0]=Ie(v,14)+1,V[0]=Ie(v,14)+1,W[0]=Ie(v,1),Ie(v,3)!=0?0:!v.h)}function Lt(v,C){if(4>v)return v+1;var V=v-2>>1;return(2+(1&v)<<V)+Ie(C,V)+1}function Vt(v,C){return 120<C?C-120:1<=(V=((V=y7[C-1])>>4)*v+(8-(15&V)))?V:1;var V}function nr(v,C,V){var W=Q(V),ue=v[C+=255&W].g-8;return 0<ue&&(R(V,V.u+8),W=Q(V),C+=v[C].value,C+=W&(1<<ue)-1),R(V,V.u+v[C].g),v[C].value}function Mt(v,C,V){return V.g+=v.g,V.value+=v.value<<C>>>0,e(8>=V.g),v.g}function oe(v,C,V){var W=v.xc;return e((C=W==0?0:v.vc[v.md*(V>>W)+(C>>W)])<v.Wb),v.Ya[C]}function J(v,C,V,W){var ue=v.ab,be=v.c*C,Ce=v.C;C=Ce+C;var je=V,Le=W;for(W=v.Ta,V=v.Ua;0<ue--;){var qe=v.gc[ue],ct=Ce,yt=C,Ge=je,ut=Le,gt=(Le=W,je=V,qe.Ea);switch(e(ct<yt),e(yt<=qe.nc),qe.hc){case 2:Ls(Ge,ut,(yt-ct)*gt,Le,je);break;case 0:var Et=ct,xt=yt,It=Le,jt=je,Qt=(pr=qe).Ea;Et==0&&(Nm(Ge,ut,null,null,1,It,jt),Ue(Ge,ut+1,0,0,Qt-1,It,jt+1),ut+=Qt,jt+=Qt,++Et);for(var Pt=1<<pr.b,vr=Pt-1,Ar=we(Qt,pr.b),Mr=pr.K,pr=pr.w+(Et>>pr.b)*Ar;Et<xt;){var an=Mr,aa=pr,Qr=1;for(ff(Ge,ut,It,jt-Qt,1,It,jt);Qr<Qt;){var gr=(Qr&~vr)+Pt;gr>Qt&&(gr=Qt),(0,_m[an[aa++]>>8&15])(Ge,ut+ +Qr,It,jt+Qr-Qt,gr-Qr,It,jt+Qr),Qr=gr}ut+=Qt,jt+=Qt,++Et&vr||(pr+=Ar)}yt!=qe.nc&&n(Le,je-gt,Le,je+(yt-ct-1)*gt,gt);break;case 1:for(gt=Ge,xt=ut,Qt=(Ge=qe.Ea)-(jt=Ge&~(It=(ut=1<<qe.b)-1)),Et=we(Ge,qe.b),Pt=qe.K,qe=qe.w+(ct>>qe.b)*Et;ct<yt;){for(vr=Pt,Ar=qe,Mr=new tt,pr=xt+jt,an=xt+Ge;xt<pr;)xe(vr[Ar++],Mr),Em(Mr,gt,xt,ut,Le,je),xt+=ut,je+=ut;xt<an&&(xe(vr[Ar++],Mr),Em(Mr,gt,xt,Qt,Le,je),xt+=Qt,je+=Qt),++ct&It||(qe+=Et)}break;case 3:if(Ge==Le&&ut==je&&0<qe.b){for(xt=Le,Ge=gt=je+(yt-ct)*gt-(jt=(yt-ct)*we(qe.Ea,qe.b)),ut=Le,It=je,Et=[],jt=(Qt=jt)-1;0<=jt;--jt)Et[jt]=ut[It+jt];for(jt=Qt-1;0<=jt;--jt)xt[Ge+jt]=Et[jt];Xx(qe,ct,yt,Le,gt,Le,je)}else Xx(qe,ct,yt,Ge,ut,Le,je)}je=W,Le=V}Le!=V&&n(W,V,je,Le,be)}function ce(v,C){var V=v.V,W=v.Ba+v.c*v.C,ue=C-v.C;if(e(C<=v.l.o),e(16>=ue),0<ue){var be=v.l,Ce=v.Ta,je=v.Ua,Le=be.width;if(J(v,ue,V,W),ue=je=[je],e((V=v.C)<(W=C)),e(be.v<be.va),W>be.o&&(W=be.o),V<be.j){var qe=be.j-V;V=be.j,ue[0]+=qe*Le}if(V>=W?V=0:(ue[0]+=4*be.v,be.ka=V-be.j,be.U=be.va-be.v,be.T=W-V,V=1),V){if(je=je[0],11>(V=v.ca).S){var ct=V.f.RGBA,yt=(W=V.S,ue=be.U,be=be.T,qe=ct.eb,ct.A),Ge=be;for(ct=ct.fb+v.Ma*ct.A;0<Ge--;){var ut=Ce,gt=je,Et=ue,xt=qe,It=ct;switch(W){case ev:Bm(ut,gt,Et,xt,It);break;case tv:zd(ut,gt,Et,xt,It);break;case sw:zd(ut,gt,Et,xt,It),Im(xt,It,0,Et,1,0);break;case o5:Tu(ut,gt,Et,xt,It);break;case rv:Ve(ut,gt,Et,xt,It,1);break;case aw:Ve(ut,gt,Et,xt,It,1),Im(xt,It,0,Et,1,0);break;case nv:Ve(ut,gt,Et,xt,It,0);break;case sv:Ve(ut,gt,Et,xt,It,0),Im(xt,It,1,Et,1,0);break;case nw:Wd(ut,gt,Et,xt,It);break;case iw:Wd(ut,gt,Et,xt,It),ZI(xt,It,Et,1,0);break;case l5:Jd(ut,gt,Et,xt,It);break;default:e(0)}je+=Le,ct+=yt}v.Ma+=be}else alert("todo:EmitRescaledRowsYUVA");e(v.Ma<=V.height)}}v.C=C,e(v.C<=v.i)}function pe(v){var C;if(0<v.ua)return 0;for(C=0;C<v.Wb;++C){var V=v.Ya[C].G,W=v.Ya[C].H;if(0<V[1][W[1]+0].g||0<V[2][W[2]+0].g||0<V[3][W[3]+0].g)return 0}return 1}function Be(v,C,V,W,ue,be){if(v.Z!=0){var Ce=v.qd,je=v.rd;for(e(Zd[v.Z]!=null);C<V;++C)Zd[v.Z](Ce,je,W,ue,W,ue,be),Ce=W,je=ue,ue+=be;v.qd=Ce,v.rd=je}}function De(v,C){var V=v.l.ma,W=V.Z==0||V.Z==1?v.l.j:v.C;if(W=v.C<W?W:v.C,e(C<=v.l.o),C>W){var ue=v.l.width,be=V.ca,Ce=V.tb+ue*W,je=v.V,Le=v.Ba+v.c*W,qe=v.gc;e(v.ab==1),e(qe[0].hc==3),ic(qe[0],W,C,je,Le,be,Ce),Be(V,W,C,be,Ce,ue)}v.C=v.Ma=C}function se(v,C,V,W,ue,be,Ce){var je=v.$/W,Le=v.$%W,qe=v.m,ct=v.s,yt=V+v.$,Ge=yt;ue=V+W*ue;var ut=V+W*be,gt=280+ct.ua,Et=v.Pb?je:16777216,xt=0<ct.ua?ct.Wa:null,It=ct.wc,jt=yt<ut?oe(ct,Le,je):null;e(v.C<be),e(ut<=ue);var Qt=!1;e:for(;;){for(;Qt||yt<ut;){var Pt=0;if(je>=Et){var vr=yt-V;e((Et=v).Pb),Et.wd=Et.m,Et.xd=vr,0<Et.s.ua&&te(Et.s.Wa,Et.s.vb),Et=je+w7}if(Le&It||(jt=oe(ct,Le,je)),e(jt!=null),jt.Qb&&(C[yt]=jt.qb,Qt=!0),!Qt)if(K(qe),jt.jc){Pt=qe,vr=C;var Ar=yt,Mr=jt.pd[Q(Pt)&Fu-1];e(jt.jc),256>Mr.g?(R(Pt,Pt.u+Mr.g),vr[Ar]=Mr.value,Pt=0):(R(Pt,Pt.u+Mr.g-256),e(256<=Mr.value),Pt=Mr.value),Pt==0&&(Qt=!0)}else Pt=nr(jt.G[0],jt.H[0],qe);if(qe.h)break;if(Qt||256>Pt){if(!Qt)if(jt.nd)C[yt]=(jt.qb|Pt<<8)>>>0;else{if(K(qe),Qt=nr(jt.G[1],jt.H[1],qe),K(qe),vr=nr(jt.G[2],jt.H[2],qe),Ar=nr(jt.G[3],jt.H[3],qe),qe.h)break;C[yt]=(Ar<<24|Qt<<16|Pt<<8|vr)>>>0}if(Qt=!1,++yt,++Le>=W&&(Le=0,++je,Ce!=null&&je<=be&&!(je%16)&&Ce(v,je),xt!=null))for(;Ge<yt;)Pt=C[Ge++],xt.X[(506832829*Pt&4294967295)>>>xt.Mb]=Pt}else if(280>Pt){if(Pt=Lt(Pt-256,qe),vr=nr(jt.G[4],jt.H[4],qe),K(qe),vr=Vt(W,vr=Lt(vr,qe)),qe.h)break;if(yt-V<vr||ue-yt<Pt)break e;for(Ar=0;Ar<Pt;++Ar)C[yt+Ar]=C[yt+Ar-vr];for(yt+=Pt,Le+=Pt;Le>=W;)Le-=W,++je,Ce!=null&&je<=be&&!(je%16)&&Ce(v,je);if(e(yt<=ue),Le&It&&(jt=oe(ct,Le,je)),xt!=null)for(;Ge<yt;)Pt=C[Ge++],xt.X[(506832829*Pt&4294967295)>>>xt.Mb]=Pt}else{if(!(Pt<gt))break e;for(Qt=Pt-280,e(xt!=null);Ge<yt;)Pt=C[Ge++],xt.X[(506832829*Pt&4294967295)>>>xt.Mb]=Pt;Pt=yt,e(!(Qt>>>(vr=xt).Xa)),C[Pt]=vr.X[Qt],Qt=!0}Qt||e(qe.h==T(qe))}if(v.Pb&&qe.h&&yt<ue)e(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&te(v.s.vb,v.s.Wa);else{if(qe.h)break e;Ce!=null&&Ce(v,je>be?be:je),v.a=0,v.$=yt-V}return 1}return v.a=3,0}function Fe(v){e(v!=null),v.vc=null,v.yc=null,v.Ya=null;var C=v.Wa;C!=null&&(C.X=null),v.vb=null,e(v!=null)}function he(){var v=new Cr;return v==null?null:(v.a=0,v.xb=A5,G("Predictor","VP8LPredictors"),G("Predictor","VP8LPredictors_C"),G("PredictorAdd","VP8LPredictorsAdd"),G("PredictorAdd","VP8LPredictorsAdd_C"),Ls=Xe,Em=ve,Bm=ze,zd=rt,Wd=At,Jd=Oe,Tu=at,S.VP8LMapColor32b=ac,S.VP8LMapColor8b=Cm,v)}function Re(v,C,V,W,ue){var be=1,Ce=[v],je=[C],Le=W.m,qe=W.s,ct=null,yt=0;e:for(;;){if(V)for(;be&&Ie(Le,1);){var Ge=Ce,ut=je,gt=W,Et=1,xt=gt.m,It=gt.gc[gt.ab],jt=Ie(xt,2);if(gt.Oc&1<<jt)be=0;else{switch(gt.Oc|=1<<jt,It.hc=jt,It.Ea=Ge[0],It.nc=ut[0],It.K=[null],++gt.ab,e(4>=gt.ab),jt){case 0:case 1:It.b=Ie(xt,3)+2,Et=Re(we(It.Ea,It.b),we(It.nc,It.b),0,gt,It.K),It.K=It.K[0];break;case 3:var Qt,Pt=Ie(xt,8)+1,vr=16<Pt?0:4<Pt?1:2<Pt?2:3;if(Ge[0]=we(It.Ea,vr),It.b=vr,Qt=Et=Re(Pt,1,0,gt,It.K)){var Ar,Mr=Pt,pr=It,an=1<<(8>>pr.b),aa=i(an);if(aa==null)Qt=0;else{var Qr=pr.K[0],gr=pr.w;for(aa[0]=pr.K[0][0],Ar=1;Ar<1*Mr;++Ar)aa[Ar]=Pe(Qr[gr+Ar],aa[Ar-1]);for(;Ar<4*an;++Ar)aa[Ar]=0;pr.K[0]=null,pr.K[0]=aa,Qt=1}}Et=Qt;break;case 2:break;default:e(0)}be=Et}}if(Ce=Ce[0],je=je[0],be&&Ie(Le,1)&&!(be=1<=(yt=Ie(Le,4))&&11>=yt)){W.a=3;break e}var rr;if(rr=be)t:{var Os,Dr,on,Xn=W,Ra=Ce,_i=je,Ss=yt,ei=V,Ei=Xn.m,ia=Xn.s,cn=[null],bn=1,Is=0,wn=b7[Ss];r:for(;;){if(ei&&Ie(Ei,1)){var Da=Ie(Ei,3)+2,_l=we(Ra,Da),Ms=we(_i,Da),Hi=_l*Ms;if(!Re(_l,Ms,0,Xn,cn))break r;for(cn=cn[0],ia.xc=Da,Os=0;Os<Hi;++Os){var On=cn[Os]>>8&65535;cn[Os]=On,On>=bn&&(bn=On+1)}}if(Ei.h)break r;for(Dr=0;5>Dr;++Dr){var oa=c5[Dr];!Dr&&0<Ss&&(oa+=1<<Ss),Is<oa&&(Is=oa)}var ho=o(bn*wn,D),Bi=bn,fo=o(Bi,ge);if(fo==null)var mo=null;else e(65536>=Bi),mo=fo;var Ki=i(Is);if(mo==null||Ki==null||ho==null){Xn.a=1;break r}var po=ho;for(Os=on=0;Os<bn;++Os){var Gn=mo[Os],go=Gn.G,El=Gn.H,Ru=0,qc=1,La=0;for(Dr=0;5>Dr;++Dr){oa=c5[Dr],go[Dr]=po,El[Dr]=on,!Dr&&0<Ss&&(oa+=1<<Ss);s:{var lv,dw=oa,cv=Xn,Fm=Ki,V7=po,H7=on,Aw=0,eA=cv.m,K7=Ie(eA,1);if(s(Fm,0,0,dw),K7){var q7=Ie(eA,1)+1,G7=Ie(eA,1),v5=Ie(eA,G7==0?1:8);Fm[v5]=1,q7==2&&(Fm[v5=Ie(eA,8)]=1);var dv=1}else{var y5=i(19),b5=Ie(eA,4)+4;if(19<b5){cv.a=3;var Av=0;break s}for(lv=0;lv<b5;++lv)y5[v7[lv]]=Ie(eA,3);var uw=void 0,Tm=void 0,w5=cv,$7=y5,uv=dw,N5=Fm,hw=0,tA=w5.m,C5=8,_5=o(128,D);n:for(;F(_5,0,7,$7,19);){if(Ie(tA,1)){var z7=2+2*Ie(tA,3);if((uw=2+Ie(tA,z7))>uv)break n}else uw=uv;for(Tm=0;Tm<uv&&uw--;){K(tA);var E5=_5[0+(127&Q(tA))];R(tA,tA.u+E5.g);var pf=E5.value;if(16>pf)N5[Tm++]=pf,pf!=0&&(C5=pf);else{var W7=pf==16,B5=pf-16,J7=g7[B5],S5=Ie(tA,p7[B5])+J7;if(Tm+S5>uv)break n;for(var X7=W7?C5:0;0<S5--;)N5[Tm++]=X7}}hw=1;break n}hw||(w5.a=3),dv=hw}(dv=dv&&!eA.h)&&(Aw=F(V7,H7,8,Fm,dw)),dv&&Aw!=0?Av=Aw:(cv.a=3,Av=0)}if(Av==0)break r;if(qc&&x7[Dr]==1&&(qc=po[on].g==0),Ru+=po[on].g,on+=Av,3>=Dr){var Pm,fw=Ki[0];for(Pm=1;Pm<oa;++Pm)Ki[Pm]>fw&&(fw=Ki[Pm]);La+=fw}}if(Gn.nd=qc,Gn.Qb=0,qc&&(Gn.qb=(go[3][El[3]+0].value<<24|go[1][El[1]+0].value<<16|go[2][El[2]+0].value)>>>0,Ru==0&&256>go[0][El[0]+0].value&&(Gn.Qb=1,Gn.qb+=go[0][El[0]+0].value<<8)),Gn.jc=!Gn.Qb&&6>La,Gn.jc){var hv,Gc=Gn;for(hv=0;hv<Fu;++hv){var rA=hv,nA=Gc.pd[rA],fv=Gc.G[0][Gc.H[0]+rA];256<=fv.value?(nA.g=fv.g+256,nA.value=fv.value):(nA.g=0,nA.value=0,rA>>=Mt(fv,8,nA),rA>>=Mt(Gc.G[1][Gc.H[1]+rA],16,nA),rA>>=Mt(Gc.G[2][Gc.H[2]+rA],0,nA),Mt(Gc.G[3][Gc.H[3]+rA],24,nA))}}}ia.vc=cn,ia.Wb=bn,ia.Ya=mo,ia.yc=ho,rr=1;break t}rr=0}if(!(be=rr)){W.a=3;break e}if(0<yt){if(qe.ua=1<<yt,!z(qe.Wa,yt)){W.a=1,be=0;break e}}else qe.ua=0;var mw=W,I5=Ce,Y7=je,pw=mw.s,gw=pw.xc;if(mw.c=I5,mw.i=Y7,pw.md=we(I5,gw),pw.wc=gw==0?-1:(1<<gw)-1,V){W.xb=I7;break e}if((ct=i(Ce*je))==null){W.a=1,be=0;break e}be=(be=se(W,ct,0,Ce,je,je,null))&&!Le.h;break e}return be?(ue!=null?ue[0]=ct:(e(ct==null),e(V)),W.$=0,V||Fe(qe)):Fe(qe),be}function Ee(v,C){var V=v.c*v.i,W=V+C+16*C;return e(v.c<=C),v.V=i(W),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+V+C,1)}function Ze(v,C){var V=v.C,W=C-V,ue=v.V,be=v.Ba+v.c*V;for(e(C<=v.l.o);0<W;){var Ce=16<W?16:W,je=v.l.ma,Le=v.l.width,qe=Le*Ce,ct=je.ca,yt=je.tb+Le*V,Ge=v.Ta,ut=v.Ua;J(v,Ce,ue,be),t5(Ge,ut,ct,yt,qe),Be(je,V,V+Ce,ct,yt,Le),W-=Ce,ue+=Ce*v.c,V+=Ce}e(V==C),v.C=v.Ma=C}function Je(){this.ub=this.yd=this.td=this.Rb=0}function Ye(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function $e(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function it(){this.Yb=function(){var v=[];return function C(V,W,ue){for(var be=ue[W],Ce=0;Ce<be&&(V.push(ue.length>W+1?[]:0),!(ue.length<W+1));Ce++)C(V[Ce],W+1,ue)}(v,0,[3,11]),v}()}function ft(){this.jb=i(3),this.Wc=l([4,8],it),this.Xc=l([4,17],it)}function Ut(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Kt(){this.ld=this.La=this.dd=this.tc=0}function yr(){this.Na=this.la=0}function Hn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Fn(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function wi(){this.uc=this.M=this.Nb=0,this.wa=Array(new Kt),this.Y=0,this.ya=Array(new Fn),this.aa=0,this.l=new io}function Ds(){this.y=i(16),this.f=i(8),this.ea=i(8)}function ao(){this.cb=this.a=0,this.sc="",this.m=new I,this.Od=new Je,this.Kc=new Ye,this.ed=new Ut,this.Qa=new $e,this.Ic=this.$c=this.Aa=0,this.D=new wi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,I),this.ia=0,this.pb=o(4,Hn),this.Pa=new ft,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ds),this.Hd=0,this.rb=Array(new yr),this.sb=0,this.wa=Array(new Kt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Fn),this.L=this.aa=0,this.gd=l([4,2],Kt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Jn(v,C){return 0>v?0:v>C?C:v}function io(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ud(){var v=new ao;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,jm||(jm=Dc)),v}function Kn(v,C,V){return v.a==0&&(v.a=C,v.sc=V,v.cb=0),0}function ec(v,C,V){return 3<=V&&v[C+0]==157&&v[C+1]==1&&v[C+2]==42}function Lo(v,C){if(v==null)return 0;if(v.a=0,v.sc="OK",C==null)return Kn(v,2,"null VP8Io passed to VP8GetHeaders()");var V=C.data,W=C.w,ue=C.ha;if(4>ue)return Kn(v,7,"Truncated header.");var be=V[W+0]|V[W+1]<<8|V[W+2]<<16,Ce=v.Od;if(Ce.Rb=!(1&be),Ce.td=be>>1&7,Ce.yd=be>>4&1,Ce.ub=be>>5,3<Ce.td)return Kn(v,3,"Incorrect keyframe parameters.");if(!Ce.yd)return Kn(v,4,"Frame not displayable.");W+=3,ue-=3;var je=v.Kc;if(Ce.Rb){if(7>ue)return Kn(v,7,"cannot parse picture header");if(!ec(V,W,ue))return Kn(v,3,"Bad code word");je.c=16383&(V[W+4]<<8|V[W+3]),je.Td=V[W+4]>>6,je.i=16383&(V[W+6]<<8|V[W+5]),je.Ud=V[W+6]>>6,W+=7,ue-=7,v.za=je.c+15>>4,v.Ub=je.i+15>>4,C.width=je.c,C.height=je.i,C.Da=0,C.j=0,C.v=0,C.va=C.width,C.o=C.height,C.da=0,C.ib=C.width,C.hb=C.height,C.U=C.width,C.T=C.height,s((be=v.Pa).jb,0,255,be.jb.length),e((be=v.Qa)!=null),be.Cb=0,be.Bb=0,be.Fb=1,s(be.Zb,0,0,be.Zb.length),s(be.Lb,0,0,be.Lb)}if(Ce.ub>ue)return Kn(v,7,"bad partition length");ae(be=v.m,V,W,Ce.ub),W+=Ce.ub,ue-=Ce.ub,Ce.Rb&&(je.Ld=re(be),je.Kd=re(be)),je=v.Qa;var Le,qe=v.Pa;if(e(be!=null),e(je!=null),je.Cb=re(be),je.Cb){if(je.Bb=re(be),re(be)){for(je.Fb=re(be),Le=0;4>Le;++Le)je.Zb[Le]=re(be)?me(be,7):0;for(Le=0;4>Le;++Le)je.Lb[Le]=re(be)?me(be,6):0}if(je.Bb)for(Le=0;3>Le;++Le)qe.jb[Le]=re(be)?fe(be,8):255}else je.Bb=0;if(be.Ka)return Kn(v,3,"cannot parse segment header");if((je=v.ed).zd=re(be),je.Tb=fe(be,6),je.wb=fe(be,3),je.Pc=re(be),je.Pc&&re(be)){for(qe=0;4>qe;++qe)re(be)&&(je.vd[qe]=me(be,6));for(qe=0;4>qe;++qe)re(be)&&(je.od[qe]=me(be,6))}if(v.L=je.Tb==0?0:je.zd?1:2,be.Ka)return Kn(v,3,"cannot parse filter header");var ct=ue;if(ue=Le=W,W=Le+ct,je=ct,v.Xb=(1<<fe(v.m,2))-1,ct<3*(qe=v.Xb))V=7;else{for(Le+=3*qe,je-=3*qe,ct=0;ct<qe;++ct){var yt=V[ue+0]|V[ue+1]<<8|V[ue+2]<<16;yt>je&&(yt=je),ae(v.Jc[+ct],V,Le,yt),Le+=yt,je-=yt,ue+=3}ae(v.Jc[+qe],V,Le,je),V=Le<W?0:5}if(V!=0)return Kn(v,V,"cannot parse partitions");for(V=fe(Le=v.m,7),ue=re(Le)?me(Le,4):0,W=re(Le)?me(Le,4):0,je=re(Le)?me(Le,4):0,qe=re(Le)?me(Le,4):0,Le=re(Le)?me(Le,4):0,ct=v.Qa,yt=0;4>yt;++yt){if(ct.Cb){var Ge=ct.Zb[yt];ct.Fb||(Ge+=V)}else{if(0<yt){v.pb[yt]=v.pb[0];continue}Ge=V}var ut=v.pb[yt];ut.Sc[0]=ow[Jn(Ge+ue,127)],ut.Sc[1]=lw[Jn(Ge+0,127)],ut.Eb[0]=2*ow[Jn(Ge+W,127)],ut.Eb[1]=101581*lw[Jn(Ge+je,127)]>>16,8>ut.Eb[1]&&(ut.Eb[1]=8),ut.Qc[0]=ow[Jn(Ge+qe,117)],ut.Qc[1]=lw[Jn(Ge+Le,127)],ut.lc=Ge+Le}if(!Ce.Rb)return Kn(v,4,"Not a key frame.");for(re(be),Ce=v.Pa,V=0;4>V;++V){for(ue=0;8>ue;++ue)for(W=0;3>W;++W)for(je=0;11>je;++je)qe=de(be,B7[V][ue][W][je])?fe(be,8):_7[V][ue][W][je],Ce.Wc[V][ue].Yb[W][je]=qe;for(ue=0;17>ue;++ue)Ce.Xc[V][ue]=Ce.Wc[V][S7[ue]]}return v.kc=re(be),v.kc&&(v.Bd=fe(be,8)),v.cb=1}function Dc(v,C,V,W,ue,be,Ce){var je=C[ue].Yb[V];for(V=0;16>ue;++ue){if(!de(v,je[V+0]))return ue;for(;!de(v,je[V+1]);)if(je=C[++ue].Yb[0],V=0,ue==16)return 16;var Le=C[ue+1].Yb;if(de(v,je[V+2])){var qe=v,ct=0;if(de(qe,(Ge=je)[(yt=V)+3]))if(de(qe,Ge[yt+6])){for(je=0,yt=2*(ct=de(qe,Ge[yt+8]))+(Ge=de(qe,Ge[yt+9+ct])),ct=0,Ge=N7[yt];Ge[je];++je)ct+=ct+de(qe,Ge[je]);ct+=3+(8<<yt)}else de(qe,Ge[yt+7])?(ct=7+2*de(qe,165),ct+=de(qe,145)):ct=5+de(qe,159);else ct=de(qe,Ge[yt+4])?3+de(qe,Ge[yt+5]):2;je=Le[2]}else ct=1,je=Le[1];Le=Ce+C7[ue],0>(qe=v).b&&M(qe);var yt,Ge=qe.b,ut=(yt=qe.Ca>>1)-(qe.I>>Ge)>>31;--qe.b,qe.Ca+=ut,qe.Ca|=1,qe.I-=(yt+1&ut)<<Ge,be[Le]=((ct^ut)-ut)*W[(0<ue)+0]}return 16}function Eu(v){var C=v.rb[v.sb-1];C.la=0,C.Na=0,s(v.zc,0,0,v.zc.length),v.ja=0}function Qi(v,C,V,W,ue){ue=v[C+V+32*W]+(ue>>3),v[C+V+32*W]=-256&ue?0>ue?0:255:ue}function Ln(v,C,V,W,ue,be){Qi(v,C,0,V,W+ue),Qi(v,C,1,V,W+be),Qi(v,C,2,V,W-be),Qi(v,C,3,V,W-ue)}function na(v){return(20091*v>>16)+v}function Lc(v,C,V,W){var ue,be=0,Ce=i(16);for(ue=0;4>ue;++ue){var je=v[C+0]+v[C+8],Le=v[C+0]-v[C+8],qe=(35468*v[C+4]>>16)-na(v[C+12]),ct=na(v[C+4])+(35468*v[C+12]>>16);Ce[be+0]=je+ct,Ce[be+1]=Le+qe,Ce[be+2]=Le-qe,Ce[be+3]=je-ct,be+=4,C++}for(ue=be=0;4>ue;++ue)je=(v=Ce[be+0]+4)+Ce[be+8],Le=v-Ce[be+8],qe=(35468*Ce[be+4]>>16)-na(Ce[be+12]),Qi(V,W,0,0,je+(ct=na(Ce[be+4])+(35468*Ce[be+12]>>16))),Qi(V,W,1,0,Le+qe),Qi(V,W,2,0,Le-qe),Qi(V,W,3,0,je-ct),be++,W+=32}function Od(v,C,V,W){var ue=v[C+0]+4,be=35468*v[C+4]>>16,Ce=na(v[C+4]),je=35468*v[C+1]>>16;Ln(V,W,0,ue+Ce,v=na(v[C+1]),je),Ln(V,W,1,ue+be,v,je),Ln(V,W,2,ue-be,v,je),Ln(V,W,3,ue-Ce,v,je)}function lf(v,C,V,W,ue){Lc(v,C,V,W),ue&&Lc(v,C+16,V,W+4)}function Yr(v,C,V,W){Pu(v,C+0,V,W,1),Pu(v,C+32,V,W+128,1)}function Uc(v,C,V,W){var ue;for(v=v[C+0]+4,ue=0;4>ue;++ue)for(C=0;4>C;++C)Qi(V,W,C,ue,v)}function tc(v,C,V,W){v[C+0]&&xn(v,C+0,V,W),v[C+16]&&xn(v,C+16,V,W+4),v[C+32]&&xn(v,C+32,V,W+128),v[C+48]&&xn(v,C+48,V,W+128+4)}function Uo(v,C,V,W){var ue,be=i(16);for(ue=0;4>ue;++ue){var Ce=v[C+0+ue]+v[C+12+ue],je=v[C+4+ue]+v[C+8+ue],Le=v[C+4+ue]-v[C+8+ue],qe=v[C+0+ue]-v[C+12+ue];be[0+ue]=Ce+je,be[8+ue]=Ce-je,be[4+ue]=qe+Le,be[12+ue]=qe-Le}for(ue=0;4>ue;++ue)Ce=(v=be[0+4*ue]+3)+be[3+4*ue],je=be[1+4*ue]+be[2+4*ue],Le=be[1+4*ue]-be[2+4*ue],qe=v-be[3+4*ue],V[W+0]=Ce+je>>3,V[W+16]=qe+Le>>3,V[W+32]=Ce-je>>3,V[W+48]=qe-Le>>3,W+=64}function Oc(v,C,V){var W,ue=C-32,be=uo,Ce=255-v[ue-1];for(W=0;W<V;++W){var je,Le=be,qe=Ce+v[C-1];for(je=0;je<V;++je)v[C+je]=Le[qe+v[ue+je]];C+=32}}function cf(v,C){Oc(v,C,4)}function mm(v,C){Oc(v,C,8)}function pm(v,C){Oc(v,C,16)}function Bu(v,C){var V;for(V=0;16>V;++V)n(v,C+32*V,v,C-32,16)}function df(v,C){var V;for(V=16;0<V;--V)s(v,C,v[C-1],16),C+=32}function Ta(v,C,V){var W;for(W=0;16>W;++W)s(C,V+32*W,v,16)}function Oo(v,C){var V,W=16;for(V=0;16>V;++V)W+=v[C-1+32*V]+v[C+V-32];Ta(W>>5,v,C)}function rc(v,C){var V,W=8;for(V=0;16>V;++V)W+=v[C-1+32*V];Ta(W>>4,v,C)}function Md(v,C){var V,W=8;for(V=0;16>V;++V)W+=v[C+V-32];Ta(W>>4,v,C)}function Af(v,C){Ta(128,v,C)}function Nr(v,C,V){return v+2*C+V+2>>2}function gm(v,C){var V,W=C-32;for(W=new Uint8Array([Nr(v[W-1],v[W+0],v[W+1]),Nr(v[W+0],v[W+1],v[W+2]),Nr(v[W+1],v[W+2],v[W+3]),Nr(v[W+2],v[W+3],v[W+4])]),V=0;4>V;++V)n(v,C+32*V,W,0,W.length)}function xm(v,C){var V=v[C-1],W=v[C-1+32],ue=v[C-1+64],be=v[C-1+96];le(v,C+0,16843009*Nr(v[C-1-32],V,W)),le(v,C+32,16843009*Nr(V,W,ue)),le(v,C+64,16843009*Nr(W,ue,be)),le(v,C+96,16843009*Nr(ue,be,be))}function vm(v,C){var V,W=4;for(V=0;4>V;++V)W+=v[C+V-32]+v[C-1+32*V];for(W>>=3,V=0;4>V;++V)s(v,C+32*V,W,4)}function ya(v,C){var V=v[C-1+0],W=v[C-1+32],ue=v[C-1+64],be=v[C-1-32],Ce=v[C+0-32],je=v[C+1-32],Le=v[C+2-32],qe=v[C+3-32];v[C+0+96]=Nr(W,ue,v[C-1+96]),v[C+1+96]=v[C+0+64]=Nr(V,W,ue),v[C+2+96]=v[C+1+64]=v[C+0+32]=Nr(be,V,W),v[C+3+96]=v[C+2+64]=v[C+1+32]=v[C+0+0]=Nr(Ce,be,V),v[C+3+64]=v[C+2+32]=v[C+1+0]=Nr(je,Ce,be),v[C+3+32]=v[C+2+0]=Nr(Le,je,Ce),v[C+3+0]=Nr(qe,Le,je)}function bl(v,C){var V=v[C+1-32],W=v[C+2-32],ue=v[C+3-32],be=v[C+4-32],Ce=v[C+5-32],je=v[C+6-32],Le=v[C+7-32];v[C+0+0]=Nr(v[C+0-32],V,W),v[C+1+0]=v[C+0+32]=Nr(V,W,ue),v[C+2+0]=v[C+1+32]=v[C+0+64]=Nr(W,ue,be),v[C+3+0]=v[C+2+32]=v[C+1+64]=v[C+0+96]=Nr(ue,be,Ce),v[C+3+32]=v[C+2+64]=v[C+1+96]=Nr(be,Ce,je),v[C+3+64]=v[C+2+96]=Nr(Ce,je,Le),v[C+3+96]=Nr(je,Le,Le)}function ym(v,C){var V=v[C-1+0],W=v[C-1+32],ue=v[C-1+64],be=v[C-1-32],Ce=v[C+0-32],je=v[C+1-32],Le=v[C+2-32],qe=v[C+3-32];v[C+0+0]=v[C+1+64]=be+Ce+1>>1,v[C+1+0]=v[C+2+64]=Ce+je+1>>1,v[C+2+0]=v[C+3+64]=je+Le+1>>1,v[C+3+0]=Le+qe+1>>1,v[C+0+96]=Nr(ue,W,V),v[C+0+64]=Nr(W,V,be),v[C+0+32]=v[C+1+96]=Nr(V,be,Ce),v[C+1+32]=v[C+2+96]=Nr(be,Ce,je),v[C+2+32]=v[C+3+96]=Nr(Ce,je,Le),v[C+3+32]=Nr(je,Le,qe)}function Qd(v,C){var V=v[C+0-32],W=v[C+1-32],ue=v[C+2-32],be=v[C+3-32],Ce=v[C+4-32],je=v[C+5-32],Le=v[C+6-32],qe=v[C+7-32];v[C+0+0]=V+W+1>>1,v[C+1+0]=v[C+0+64]=W+ue+1>>1,v[C+2+0]=v[C+1+64]=ue+be+1>>1,v[C+3+0]=v[C+2+64]=be+Ce+1>>1,v[C+0+32]=Nr(V,W,ue),v[C+1+32]=v[C+0+96]=Nr(W,ue,be),v[C+2+32]=v[C+1+96]=Nr(ue,be,Ce),v[C+3+32]=v[C+2+96]=Nr(be,Ce,je),v[C+3+64]=Nr(Ce,je,Le),v[C+3+96]=Nr(je,Le,qe)}function wl(v,C){var V=v[C-1+0],W=v[C-1+32],ue=v[C-1+64],be=v[C-1+96];v[C+0+0]=V+W+1>>1,v[C+2+0]=v[C+0+32]=W+ue+1>>1,v[C+2+32]=v[C+0+64]=ue+be+1>>1,v[C+1+0]=Nr(V,W,ue),v[C+3+0]=v[C+1+32]=Nr(W,ue,be),v[C+3+32]=v[C+1+64]=Nr(ue,be,be),v[C+3+64]=v[C+2+64]=v[C+0+96]=v[C+1+96]=v[C+2+96]=v[C+3+96]=be}function Vd(v,C){var V=v[C-1+0],W=v[C-1+32],ue=v[C-1+64],be=v[C-1+96],Ce=v[C-1-32],je=v[C+0-32],Le=v[C+1-32],qe=v[C+2-32];v[C+0+0]=v[C+2+32]=V+Ce+1>>1,v[C+0+32]=v[C+2+64]=W+V+1>>1,v[C+0+64]=v[C+2+96]=ue+W+1>>1,v[C+0+96]=be+ue+1>>1,v[C+3+0]=Nr(je,Le,qe),v[C+2+0]=Nr(Ce,je,Le),v[C+1+0]=v[C+3+32]=Nr(V,Ce,je),v[C+1+32]=v[C+3+64]=Nr(W,V,Ce),v[C+1+64]=v[C+3+96]=Nr(ue,W,V),v[C+1+96]=Nr(be,ue,W)}function oo(v,C){var V;for(V=0;8>V;++V)n(v,C+32*V,v,C-32,8)}function Mc(v,C){var V;for(V=0;8>V;++V)s(v,C,v[C-1],8),C+=32}function Mo(v,C,V){var W;for(W=0;8>W;++W)s(C,V+32*W,v,8)}function Su(v,C){var V,W=8;for(V=0;8>V;++V)W+=v[C+V-32]+v[C-1+32*V];Mo(W>>4,v,C)}function Tn(v,C){var V,W=4;for(V=0;8>V;++V)W+=v[C+V-32];Mo(W>>3,v,C)}function Iu(v,C){var V,W=4;for(V=0;8>V;++V)W+=v[C-1+32*V];Mo(W>>3,v,C)}function uf(v,C){Mo(128,v,C)}function Qo(v,C,V){var W=v[C-V],ue=v[C+0],be=3*(ue-W)+rw[1020+v[C-2*V]-v[C+V]],Ce=Zx[112+(be+4>>3)];v[C-V]=uo[255+W+Zx[112+(be+3>>3)]],v[C+0]=uo[255+ue-Ce]}function Hd(v,C,V,W){var ue=v[C+0],be=v[C+V];return $o[255+v[C-2*V]-v[C-V]]>W||$o[255+be-ue]>W}function Qc(v,C,V,W){return 4*$o[255+v[C-V]-v[C+0]]+$o[255+v[C-2*V]-v[C+V]]<=W}function nc(v,C,V,W,ue){var be=v[C-3*V],Ce=v[C-2*V],je=v[C-V],Le=v[C+0],qe=v[C+V],ct=v[C+2*V],yt=v[C+3*V];return 4*$o[255+je-Le]+$o[255+Ce-qe]>W?0:$o[255+v[C-4*V]-be]<=ue&&$o[255+be-Ce]<=ue&&$o[255+Ce-je]<=ue&&$o[255+yt-ct]<=ue&&$o[255+ct-qe]<=ue&&$o[255+qe-Le]<=ue}function sc(v,C,V,W){var ue=2*W+1;for(W=0;16>W;++W)Qc(v,C+W,V,ue)&&Qo(v,C+W,V)}function Ni(v,C,V,W){var ue=2*W+1;for(W=0;16>W;++W)Qc(v,C+W*V,1,ue)&&Qo(v,C+W*V,1)}function ju(v,C,V,W){var ue;for(ue=3;0<ue;--ue)sc(v,C+=4*V,V,W)}function hf(v,C,V,W){var ue;for(ue=3;0<ue;--ue)Ni(v,C+=4,V,W)}function Ci(v,C,V,W,ue,be,Ce,je){for(be=2*be+1;0<ue--;){if(nc(v,C,V,be,Ce))if(Hd(v,C,V,je))Qo(v,C,V);else{var Le=v,qe=C,ct=V,yt=Le[qe-2*ct],Ge=Le[qe-ct],ut=Le[qe+0],gt=Le[qe+ct],Et=Le[qe+2*ct],xt=27*(jt=rw[1020+3*(ut-Ge)+rw[1020+yt-gt]])+63>>7,It=18*jt+63>>7,jt=9*jt+63>>7;Le[qe-3*ct]=uo[255+Le[qe-3*ct]+jt],Le[qe-2*ct]=uo[255+yt+It],Le[qe-ct]=uo[255+Ge+xt],Le[qe+0]=uo[255+ut-xt],Le[qe+ct]=uo[255+gt-It],Le[qe+2*ct]=uo[255+Et-jt]}C+=W}}function Vo(v,C,V,W,ue,be,Ce,je){for(be=2*be+1;0<ue--;){if(nc(v,C,V,be,Ce))if(Hd(v,C,V,je))Qo(v,C,V);else{var Le=v,qe=C,ct=V,yt=Le[qe-ct],Ge=Le[qe+0],ut=Le[qe+ct],gt=Zx[112+(4+(Et=3*(Ge-yt))>>3)],Et=Zx[112+(Et+3>>3)],xt=gt+1>>1;Le[qe-2*ct]=uo[255+Le[qe-2*ct]+xt],Le[qe-ct]=uo[255+yt+Et],Le[qe+0]=uo[255+Ge-gt],Le[qe+ct]=uo[255+ut-xt]}C+=W}}function Kd(v,C,V,W,ue,be){Ci(v,C,V,1,16,W,ue,be)}function Ho(v,C,V,W,ue,be){Ci(v,C,1,V,16,W,ue,be)}function ku(v,C,V,W,ue,be){var Ce;for(Ce=3;0<Ce;--Ce)Vo(v,C+=4*V,V,1,16,W,ue,be)}function P(v,C,V,W,ue,be){var Ce;for(Ce=3;0<Ce;--Ce)Vo(v,C+=4,1,V,16,W,ue,be)}function Ae(v,C,V,W,ue,be,Ce,je){Ci(v,C,ue,1,8,be,Ce,je),Ci(V,W,ue,1,8,be,Ce,je)}function Ke(v,C,V,W,ue,be,Ce,je){Ci(v,C,1,ue,8,be,Ce,je),Ci(V,W,1,ue,8,be,Ce,je)}function nt(v,C,V,W,ue,be,Ce,je){Vo(v,C+4*ue,ue,1,8,be,Ce,je),Vo(V,W+4*ue,ue,1,8,be,Ce,je)}function mt(v,C,V,W,ue,be,Ce,je){Vo(v,C+4,1,ue,8,be,Ce,je),Vo(V,W+4,1,ue,8,be,Ce,je)}function St(){this.ba=new He,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ct,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ft(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function lr(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function fr(){this.ua=0,this.Wa=new Ne,this.vb=new Ne,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ge,this.yc=new D}function Cr(){this.xb=this.a=0,this.l=new io,this.ca=new He,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new j,this.Pb=0,this.wd=new j,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new fr,this.ab=0,this.gc=o(4,lr),this.Oc=0}function Tr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new io,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Zr(v,C,V,W,ue,be,Ce){for(v=v==null?0:v[C+0],C=0;C<Ce;++C)ue[be+C]=v+V[W+C]&255,v=ue[be+C]}function gn(v,C,V,W,ue,be,Ce){var je;if(v==null)Zr(null,null,V,W,ue,be,Ce);else for(je=0;je<Ce;++je)ue[be+je]=v[C+je]+V[W+je]&255}function ms(v,C,V,W,ue,be,Ce){if(v==null)Zr(null,null,V,W,ue,be,Ce);else{var je,Le=v[C+0],qe=Le,ct=Le;for(je=0;je<Ce;++je)qe=ct+(Le=v[C+je])-qe,ct=V[W+je]+(-256&qe?0>qe?0:255:qe)&255,qe=Le,ue[be+je]=ct}}function yn(v,C,V,W){var ue=C.width,be=C.o;if(e(v!=null&&C!=null),0>V||0>=W||V+W>be)return null;if(!v.Cc){if(v.ga==null){var Ce;if(v.ga=new Tr,(Ce=v.ga==null)||(Ce=C.width*C.o,e(v.Gb.length==0),v.Gb=i(Ce),v.Uc=0,v.Gb==null?Ce=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,Ce=1),Ce=!Ce),!Ce){Ce=v.ga;var je=v.Fa,Le=v.P,qe=v.qc,ct=v.mb,yt=v.nb,Ge=Le+1,ut=qe-1,gt=Ce.l;if(e(je!=null&&ct!=null&&C!=null),Zd[0]=null,Zd[1]=Zr,Zd[2]=gn,Zd[3]=ms,Ce.ca=ct,Ce.tb=yt,Ce.c=C.width,Ce.i=C.height,e(0<Ce.c&&0<Ce.i),1>=qe)C=0;else if(Ce.$a=3&je[Le+0],Ce.Z=je[Le+0]>>2&3,Ce.Lc=je[Le+0]>>4&3,Le=je[Le+0]>>6&3,0>Ce.$a||1<Ce.$a||4<=Ce.Z||1<Ce.Lc||Le)C=0;else if(gt.put=et,gt.ac=Zt,gt.bc=Rt,gt.ma=Ce,gt.width=C.width,gt.height=C.height,gt.Da=C.Da,gt.v=C.v,gt.va=C.va,gt.j=C.j,gt.o=C.o,Ce.$a)e:{e(Ce.$a==1),C=he();t:for(;;){if(C==null){C=0;break e}if(e(Ce!=null),Ce.mc=C,C.c=Ce.c,C.i=Ce.i,C.l=Ce.l,C.l.ma=Ce,C.l.width=Ce.c,C.l.height=Ce.i,C.a=0,Z(C.m,je,Ge,ut),!Re(Ce.c,Ce.i,1,C,null)||(C.ab==1&&C.gc[0].hc==3&&pe(C.s)?(Ce.ic=1,je=C.c*C.i,C.Ta=null,C.Ua=0,C.V=i(je),C.Ba=0,C.V==null?(C.a=1,C=0):C=1):(Ce.ic=0,C=Ee(C,Ce.c)),!C))break t;C=1;break e}Ce.mc=null,C=0}else C=ut>=Ce.c*Ce.i;Ce=!C}if(Ce)return null;v.ga.Lc!=1?v.Ga=0:W=be-V}e(v.ga!=null),e(V+W<=be);e:{if(C=(je=v.ga).c,be=je.l.o,je.$a==0){if(Ge=v.rc,ut=v.Vc,gt=v.Fa,Le=v.P+1+V*C,qe=v.mb,ct=v.nb+V*C,e(Le<=v.P+v.qc),je.Z!=0)for(e(Zd[je.Z]!=null),Ce=0;Ce<W;++Ce)Zd[je.Z](Ge,ut,gt,Le,qe,ct,C),Ge=qe,ut=ct,ct+=C,Le+=C;else for(Ce=0;Ce<W;++Ce)n(qe,ct,gt,Le,C),Ge=qe,ut=ct,ct+=C,Le+=C;v.rc=Ge,v.Vc=ut}else{if(e(je.mc!=null),C=V+W,e((Ce=je.mc)!=null),e(C<=Ce.i),Ce.C>=C)C=1;else if(je.ic||Vi(),je.ic){je=Ce.V,Ge=Ce.Ba,ut=Ce.c;var Et=Ce.i,xt=(gt=1,Le=Ce.$/ut,qe=Ce.$%ut,ct=Ce.m,yt=Ce.s,Ce.$),It=ut*Et,jt=ut*C,Qt=yt.wc,Pt=xt<jt?oe(yt,qe,Le):null;e(xt<=It),e(C<=Et),e(pe(yt));t:for(;;){for(;!ct.h&&xt<jt;){if(qe&Qt||(Pt=oe(yt,qe,Le)),e(Pt!=null),K(ct),256>(Et=nr(Pt.G[0],Pt.H[0],ct)))je[Ge+xt]=Et,++xt,++qe>=ut&&(qe=0,++Le<=C&&!(Le%16)&&De(Ce,Le));else{if(!(280>Et)){gt=0;break t}Et=Lt(Et-256,ct);var vr,Ar=nr(Pt.G[4],Pt.H[4],ct);if(K(ct),!(xt>=(Ar=Vt(ut,Ar=Lt(Ar,ct)))&&It-xt>=Et)){gt=0;break t}for(vr=0;vr<Et;++vr)je[Ge+xt+vr]=je[Ge+xt+vr-Ar];for(xt+=Et,qe+=Et;qe>=ut;)qe-=ut,++Le<=C&&!(Le%16)&&De(Ce,Le);xt<jt&&qe&Qt&&(Pt=oe(yt,qe,Le))}e(ct.h==T(ct))}De(Ce,Le>C?C:Le);break t}!gt||ct.h&&xt<It?(gt=0,Ce.a=ct.h?5:3):Ce.$=xt,C=gt}else C=se(Ce,Ce.V,Ce.Ba,Ce.c,Ce.i,C,Ze);if(!C){W=0;break e}}V+W>=be&&(v.Cc=1),W=1}if(!W)return null;if(v.Cc&&((W=v.ga)!=null&&(W.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+V*ue}function Es(v,C,V,W,ue,be){for(;0<ue--;){var Ce,je=v,Le=C+(V?1:0),qe=v,ct=C+(V?0:3);for(Ce=0;Ce<W;++Ce){var yt=qe[ct+4*Ce];yt!=255&&(yt*=32897,je[Le+4*Ce+0]=je[Le+4*Ce+0]*yt>>23,je[Le+4*Ce+1]=je[Le+4*Ce+1]*yt>>23,je[Le+4*Ce+2]=je[Le+4*Ce+2]*yt>>23)}C+=be}}function ps(v,C,V,W,ue){for(;0<W--;){var be;for(be=0;be<V;++be){var Ce=v[C+2*be+0],je=15&(qe=v[C+2*be+1]),Le=4369*je,qe=(240&qe|qe>>4)*Le>>16;v[C+2*be+0]=(240&Ce|Ce>>4)*Le>>16&240|(15&Ce|Ce<<4)*Le>>16>>4&15,v[C+2*be+1]=240&qe|je}C+=ue}}function Bs(v,C,V,W,ue,be,Ce,je){var Le,qe,ct=255;for(qe=0;qe<ue;++qe){for(Le=0;Le<W;++Le){var yt=v[C+Le];be[Ce+4*Le]=yt,ct&=yt}C+=V,Ce+=je}return ct!=255}function gs(v,C,V,W,ue){var be;for(be=0;be<ue;++be)V[W+be]=v[C+be]>>8}function Vi(){Im=Es,ZI=ps,e5=Bs,t5=gs}function Ko(v,C,V){S[v]=function(W,ue,be,Ce,je,Le,qe,ct,yt,Ge,ut,gt,Et,xt,It,jt,Qt){var Pt,vr=Qt-1>>1,Ar=je[Le+0]|qe[ct+0]<<16,Mr=yt[Ge+0]|ut[gt+0]<<16;e(W!=null);var pr=3*Ar+Mr+131074>>2;for(C(W[ue+0],255&pr,pr>>16,Et,xt),be!=null&&(pr=3*Mr+Ar+131074>>2,C(be[Ce+0],255&pr,pr>>16,It,jt)),Pt=1;Pt<=vr;++Pt){var an=je[Le+Pt]|qe[ct+Pt]<<16,aa=yt[Ge+Pt]|ut[gt+Pt]<<16,Qr=Ar+an+Mr+aa+524296,gr=Qr+2*(an+Mr)>>3;pr=gr+Ar>>1,Ar=(Qr=Qr+2*(Ar+aa)>>3)+an>>1,C(W[ue+2*Pt-1],255&pr,pr>>16,Et,xt+(2*Pt-1)*V),C(W[ue+2*Pt-0],255&Ar,Ar>>16,Et,xt+(2*Pt-0)*V),be!=null&&(pr=Qr+Mr>>1,Ar=gr+aa>>1,C(be[Ce+2*Pt-1],255&pr,pr>>16,It,jt+(2*Pt-1)*V),C(be[Ce+2*Pt+0],255&Ar,Ar>>16,It,jt+(2*Pt+0)*V)),Ar=an,Mr=aa}1&Qt||(pr=3*Ar+Mr+131074>>2,C(W[ue+Qt-1],255&pr,pr>>16,Et,xt+(Qt-1)*V),be!=null&&(pr=3*Mr+Ar+131074>>2,C(be[Ce+Qt-1],255&pr,pr>>16,It,jt+(Qt-1)*V)))}}function qo(){zo[ev]=j7,zo[tv]=u5,zo[o5]=k7,zo[rv]=h5,zo[nv]=f5,zo[nw]=m5,zo[l5]=F7,zo[sw]=u5,zo[aw]=h5,zo[sv]=f5,zo[iw]=m5}function y(v){return v&-16384?0>v?0:255:v>>T7}function H(v,C){return y((19077*v>>8)+(26149*C>>8)-14234)}function ne(v,C,V){return y((19077*v>>8)-(6419*C>>8)-(13320*V>>8)+8708)}function ke(v,C){return y((19077*v>>8)+(33050*C>>8)-17685)}function pt(v,C,V,W,ue){W[ue+0]=H(v,V),W[ue+1]=ne(v,C,V),W[ue+2]=ke(v,C)}function wt(v,C,V,W,ue){W[ue+0]=ke(v,C),W[ue+1]=ne(v,C,V),W[ue+2]=H(v,V)}function zt(v,C,V,W,ue){var be=ne(v,C,V);C=be<<3&224|ke(v,C)>>3,W[ue+0]=248&H(v,V)|be>>5,W[ue+1]=C}function sn(v,C,V,W,ue){var be=240&ke(v,C)|15;W[ue+0]=240&H(v,V)|ne(v,C,V)>>4,W[ue+1]=be}function xs(v,C,V,W,ue){W[ue+0]=255,pt(v,C,V,W,ue+1)}function Gr(v,C,V,W,ue){wt(v,C,V,W,ue),W[ue+3]=255}function fn(v,C,V,W,ue){pt(v,C,V,W,ue),W[ue+3]=255}function qn(v,C,V){S[v]=function(W,ue,be,Ce,je,Le,qe,ct,yt){for(var Ge=ct+(-2&yt)*V;ct!=Ge;)C(W[ue+0],be[Ce+0],je[Le+0],qe,ct),C(W[ue+1],be[Ce+0],je[Le+0],qe,ct+V),ue+=2,++Ce,++Le,ct+=2*V;1&yt&&C(W[ue+0],be[Ce+0],je[Le+0],qe,ct)}}function lo(v,C,V){return V==0?v==0?C==0?6:5:C==0?4:0:V}function Za(v,C,V,W,ue){switch(v>>>30){case 3:Pu(C,V,W,ue,0);break;case 2:Go(C,V,W,ue);break;case 1:xn(C,V,W,ue)}}function Pa(v,C){var V,W,ue=C.M,be=C.Nb,Ce=v.oc,je=v.pc+40,Le=v.oc,qe=v.pc+584,ct=v.oc,yt=v.pc+600;for(V=0;16>V;++V)Ce[je+32*V-1]=129;for(V=0;8>V;++V)Le[qe+32*V-1]=129,ct[yt+32*V-1]=129;for(0<ue?Ce[je-1-32]=Le[qe-1-32]=ct[yt-1-32]=129:(s(Ce,je-32-1,127,21),s(Le,qe-32-1,127,9),s(ct,yt-32-1,127,9)),W=0;W<v.za;++W){var Ge=C.ya[C.aa+W];if(0<W){for(V=-1;16>V;++V)n(Ce,je+32*V-4,Ce,je+32*V+12,4);for(V=-1;8>V;++V)n(Le,qe+32*V-4,Le,qe+32*V+4,4),n(ct,yt+32*V-4,ct,yt+32*V+4,4)}var ut=v.Gd,gt=v.Hd+W,Et=Ge.ad,xt=Ge.Hc;if(0<ue&&(n(Ce,je-32,ut[gt].y,0,16),n(Le,qe-32,ut[gt].f,0,8),n(ct,yt-32,ut[gt].ea,0,8)),Ge.Za){var It=Ce,jt=je-32+16;for(0<ue&&(W>=v.za-1?s(It,jt,ut[gt].y[15],4):n(It,jt,ut[gt+1].y,0,4)),V=0;4>V;V++)It[jt+128+V]=It[jt+256+V]=It[jt+384+V]=It[jt+0+V];for(V=0;16>V;++V,xt<<=2)It=Ce,jt=je+g5[V],Cl[Ge.Ob[V]](It,jt),Za(xt,Et,16*+V,It,jt)}else if(It=lo(W,ue,Ge.Ob[0]),Yd[It](Ce,je),xt!=0)for(V=0;16>V;++V,xt<<=2)Za(xt,Et,16*+V,Ce,je+g5[V]);for(V=Ge.Gc,It=lo(W,ue,Ge.Dd),Kc[It](Le,qe),Kc[It](ct,yt),xt=Et,It=Le,jt=qe,255&(Ge=0|V)&&(170&Ge?oc(xt,256,It,jt):Un(xt,256,It,jt)),Ge=ct,xt=yt,255&(V>>=8)&&(170&V?oc(Et,320,Ge,xt):Un(Et,320,Ge,xt)),ue<v.Ub-1&&(n(ut[gt].y,0,Ce,je+480,16),n(ut[gt].f,0,Le,qe+224,8),n(ut[gt].ea,0,ct,yt+224,8)),V=8*be*v.B,ut=v.sa,gt=v.ta+16*W+16*be*v.R,Et=v.qa,Ge=v.ra+8*W+V,xt=v.Ha,It=v.Ia+8*W+V,V=0;16>V;++V)n(ut,gt+V*v.R,Ce,je+32*V,16);for(V=0;8>V;++V)n(Et,Ge+V*v.B,Le,qe+32*V,8),n(xt,It+V*v.B,ct,yt+32*V,8)}}function Nl(v,C,V,W,ue,be,Ce,je,Le){var qe=[0],ct=[0],yt=0,Ge=Le!=null?Le.kd:0,ut=Le??new Ft;if(v==null||12>V)return 7;ut.data=v,ut.w=C,ut.ha=V,C=[C],V=[V],ut.gb=[ut.gb];e:{var gt=C,Et=V,xt=ut.gb;if(e(v!=null),e(Et!=null),e(xt!=null),xt[0]=0,12<=Et[0]&&!r(v,gt[0],"RIFF")){if(r(v,gt[0]+8,"WEBP")){xt=3;break e}var It=ee(v,gt[0]+4);if(12>It||4294967286<It){xt=3;break e}if(Ge&&It>Et[0]-8){xt=7;break e}xt[0]=It,gt[0]+=12,Et[0]-=12}xt=0}if(xt!=0)return xt;for(It=0<ut.gb[0],V=V[0];;){e:{var jt=v;Et=C,xt=V;var Qt=qe,Pt=ct,vr=gt=[0];if((pr=yt=[yt])[0]=0,8>xt[0])xt=7;else{if(!r(jt,Et[0],"VP8X")){if(ee(jt,Et[0]+4)!=10){xt=3;break e}if(18>xt[0]){xt=7;break e}var Ar=ee(jt,Et[0]+8),Mr=1+Se(jt,Et[0]+12);if(2147483648<=Mr*(jt=1+Se(jt,Et[0]+15))){xt=3;break e}vr!=null&&(vr[0]=Ar),Qt!=null&&(Qt[0]=Mr),Pt!=null&&(Pt[0]=jt),Et[0]+=18,xt[0]-=18,pr[0]=1}xt=0}}if(yt=yt[0],gt=gt[0],xt!=0)return xt;if(Et=!!(2&gt),!It&&yt)return 3;if(be!=null&&(be[0]=!!(16&gt)),Ce!=null&&(Ce[0]=Et),je!=null&&(je[0]=0),Ce=qe[0],gt=ct[0],yt&&Et&&Le==null){xt=0;break}if(4>V){xt=7;break}if(It&&yt||!It&&!yt&&!r(v,C[0],"ALPH")){V=[V],ut.na=[ut.na],ut.P=[ut.P],ut.Sa=[ut.Sa];e:{Ar=v,xt=C,It=V;var pr=ut.gb;Qt=ut.na,Pt=ut.P,vr=ut.Sa,Mr=22,e(Ar!=null),e(It!=null),jt=xt[0];var an=It[0];for(e(Qt!=null),e(vr!=null),Qt[0]=null,Pt[0]=null,vr[0]=0;;){if(xt[0]=jt,It[0]=an,8>an){xt=7;break e}var aa=ee(Ar,jt+4);if(4294967286<aa){xt=3;break e}var Qr=8+aa+1&-2;if(Mr+=Qr,0<pr&&Mr>pr){xt=3;break e}if(!r(Ar,jt,"VP8 ")||!r(Ar,jt,"VP8L")){xt=0;break e}if(an[0]<Qr){xt=7;break e}r(Ar,jt,"ALPH")||(Qt[0]=Ar,Pt[0]=jt+8,vr[0]=aa),jt+=Qr,an-=Qr}}if(V=V[0],ut.na=ut.na[0],ut.P=ut.P[0],ut.Sa=ut.Sa[0],xt!=0)break}V=[V],ut.Ja=[ut.Ja],ut.xa=[ut.xa];e:if(pr=v,xt=C,It=V,Qt=ut.gb[0],Pt=ut.Ja,vr=ut.xa,Ar=xt[0],jt=!r(pr,Ar,"VP8 "),Mr=!r(pr,Ar,"VP8L"),e(pr!=null),e(It!=null),e(Pt!=null),e(vr!=null),8>It[0])xt=7;else{if(jt||Mr){if(pr=ee(pr,Ar+4),12<=Qt&&pr>Qt-12){xt=3;break e}if(Ge&&pr>It[0]-8){xt=7;break e}Pt[0]=pr,xt[0]+=8,It[0]-=8,vr[0]=Mr}else vr[0]=5<=It[0]&&pr[Ar+0]==47&&!(pr[Ar+4]>>5),Pt[0]=It[0];xt=0}if(V=V[0],ut.Ja=ut.Ja[0],ut.xa=ut.xa[0],C=C[0],xt!=0)break;if(4294967286<ut.Ja)return 3;if(je==null||Et||(je[0]=ut.xa?2:1),Ce=[Ce],gt=[gt],ut.xa){if(5>V){xt=7;break}je=Ce,Ge=gt,Et=be,v==null||5>V?v=0:5<=V&&v[C+0]==47&&!(v[C+4]>>5)?(It=[0],pr=[0],Qt=[0],Z(Pt=new j,v,C,V),er(Pt,It,pr,Qt)?(je!=null&&(je[0]=It[0]),Ge!=null&&(Ge[0]=pr[0]),Et!=null&&(Et[0]=Qt[0]),v=1):v=0):v=0}else{if(10>V){xt=7;break}je=gt,v==null||10>V||!ec(v,C+3,V-3)?v=0:(Ge=v[C+0]|v[C+1]<<8|v[C+2]<<16,Et=16383&(v[C+7]<<8|v[C+6]),v=16383&(v[C+9]<<8|v[C+8]),1&Ge||3<(Ge>>1&7)||!(Ge>>4&1)||Ge>>5>=ut.Ja||!Et||!v?v=0:(Ce&&(Ce[0]=Et),je&&(je[0]=v),v=1))}if(!v||(Ce=Ce[0],gt=gt[0],yt&&(qe[0]!=Ce||ct[0]!=gt)))return 3;Le!=null&&(Le[0]=ut,Le.offset=C-Le.w,e(4294967286>C-Le.w),e(Le.offset==Le.ha-V));break}return xt==0||xt==7&&yt&&Le==null?(be!=null&&(be[0]|=ut.na!=null&&0<ut.na.length),W!=null&&(W[0]=Ce),ue!=null&&(ue[0]=gt),0):xt}function bm(v,C,V){var W=C.width,ue=C.height,be=0,Ce=0,je=W,Le=ue;if(C.Da=v!=null&&0<v.Da,C.Da&&(je=v.cd,Le=v.bd,be=v.v,Ce=v.j,11>V||(be&=-2,Ce&=-2),0>be||0>Ce||0>=je||0>=Le||be+je>W||Ce+Le>ue))return 0;if(C.v=be,C.j=Ce,C.va=be+je,C.o=Ce+Le,C.U=je,C.T=Le,C.da=v!=null&&0<v.da,C.da){if(!Y(je,Le,V=[v.ib],be=[v.hb]))return 0;C.ib=V[0],C.hb=be[0]}return C.ob=v!=null&&v.ob,C.Kb=v==null||!v.Sd,C.da&&(C.ob=C.ib<3*W/4&&C.hb<3*ue/4,C.Kb=0),1}function wm(v){if(v==null)return 2;if(11>v.S){var C=v.f.RGBA;C.fb+=(v.height-1)*C.A,C.A=-C.A}else C=v.f.kb,v=v.height,C.O+=(v-1)*C.fa,C.fa=-C.fa,C.N+=(v-1>>1)*C.Ab,C.Ab=-C.Ab,C.W+=(v-1>>1)*C.Db,C.Db=-C.Db,C.F!=null&&(C.J+=(v-1)*C.lb,C.lb=-C.lb);return 0}function qd(v,C,V,W){if(W==null||0>=v||0>=C)return 2;if(V!=null){if(V.Da){var ue=V.cd,be=V.bd,Ce=-2&V.v,je=-2&V.j;if(0>Ce||0>je||0>=ue||0>=be||Ce+ue>v||je+be>C)return 2;v=ue,C=be}if(V.da){if(!Y(v,C,ue=[V.ib],be=[V.hb]))return 2;v=ue[0],C=be[0]}}W.width=v,W.height=C;e:{var Le=W.width,qe=W.height;if(v=W.S,0>=Le||0>=qe||!(v>=ev&&13>v))v=2;else{if(0>=W.Rd&&W.sd==null){Ce=be=ue=C=0;var ct=(je=Le*x5[v])*qe;if(11>v||(be=(qe+1)/2*(C=(Le+1)/2),v==12&&(Ce=(ue=Le)*qe)),(qe=i(ct+2*be+Ce))==null){v=1;break e}W.sd=qe,11>v?((Le=W.f.RGBA).eb=qe,Le.fb=0,Le.A=je,Le.size=ct):((Le=W.f.kb).y=qe,Le.O=0,Le.fa=je,Le.Fd=ct,Le.f=qe,Le.N=0+ct,Le.Ab=C,Le.Cd=be,Le.ea=qe,Le.W=0+ct+be,Le.Db=C,Le.Ed=be,v==12&&(Le.F=qe,Le.J=0+ct+2*be),Le.Tc=Ce,Le.lb=ue)}if(C=1,ue=W.S,be=W.width,Ce=W.height,ue>=ev&&13>ue)if(11>ue)v=W.f.RGBA,C&=(je=Math.abs(v.A))*(Ce-1)+be<=v.size,C&=je>=be*x5[ue],C&=v.eb!=null;else{v=W.f.kb,je=(be+1)/2,ct=(Ce+1)/2,Le=Math.abs(v.fa),qe=Math.abs(v.Ab);var yt=Math.abs(v.Db),Ge=Math.abs(v.lb),ut=Ge*(Ce-1)+be;C&=Le*(Ce-1)+be<=v.Fd,C&=qe*(ct-1)+je<=v.Cd,C=(C&=yt*(ct-1)+je<=v.Ed)&Le>=be&qe>=je&yt>=je,C&=v.y!=null,C&=v.f!=null,C&=v.ea!=null,ue==12&&(C&=Ge>=be,C&=ut<=v.Tc,C&=v.F!=null)}else C=0;v=C?0:2}}return v!=0||V!=null&&V.fd&&(v=wm(W)),v}var Fu=64,co=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ao=24,Gd=32,Vc=8,$d=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Qe("Predictor0","PredictorAdd0"),S.Predictor0=function(){return 4278190080},S.Predictor1=function(v){return v},S.Predictor2=function(v,C,V){return C[V+0]},S.Predictor3=function(v,C,V){return C[V+1]},S.Predictor4=function(v,C,V){return C[V-1]},S.Predictor5=function(v,C,V){return ot(ot(v,C[V+1]),C[V+0])},S.Predictor6=function(v,C,V){return ot(v,C[V-1])},S.Predictor7=function(v,C,V){return ot(v,C[V+0])},S.Predictor8=function(v,C,V){return ot(C[V-1],C[V+0])},S.Predictor9=function(v,C,V){return ot(C[V+0],C[V+1])},S.Predictor10=function(v,C,V){return ot(ot(v,C[V-1]),ot(C[V+0],C[V+1]))},S.Predictor11=function(v,C,V){var W=C[V+0];return 0>=lt(W>>24&255,v>>24&255,(C=C[V-1])>>24&255)+lt(W>>16&255,v>>16&255,C>>16&255)+lt(W>>8&255,v>>8&255,C>>8&255)+lt(255&W,255&v,255&C)?W:v},S.Predictor12=function(v,C,V){var W=C[V+0];return(dt((v>>24&255)+(W>>24&255)-((C=C[V-1])>>24&255))<<24|dt((v>>16&255)+(W>>16&255)-(C>>16&255))<<16|dt((v>>8&255)+(W>>8&255)-(C>>8&255))<<8|dt((255&v)+(255&W)-(255&C)))>>>0},S.Predictor13=function(v,C,V){var W=C[V-1];return(vt((v=ot(v,C[V+0]))>>24&255,W>>24&255)<<24|vt(v>>16&255,W>>16&255)<<16|vt(v>>8&255,W>>8&255)<<8|vt(255&v,255&W))>>>0};var Nm=S.PredictorAdd0;S.PredictorAdd1=Ue,Qe("Predictor2","PredictorAdd2"),Qe("Predictor3","PredictorAdd3"),Qe("Predictor4","PredictorAdd4"),Qe("Predictor5","PredictorAdd5"),Qe("Predictor6","PredictorAdd6"),Qe("Predictor7","PredictorAdd7"),Qe("Predictor8","PredictorAdd8"),Qe("Predictor9","PredictorAdd9"),Qe("Predictor10","PredictorAdd10"),Qe("Predictor11","PredictorAdd11"),Qe("Predictor12","PredictorAdd12"),Qe("Predictor13","PredictorAdd13");var ff=S.PredictorAdd2;ie("ColorIndexInverseTransform","MapARGB","32b",function(v){return v>>8&255},function(v){return v}),ie("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(v){return v},function(v){return v>>8&255});var Ls,Xx=S.ColorIndexInverseTransform,ac=S.MapARGB,ic=S.VP8LColorIndexInverseTransformAlpha,Cm=S.MapAlpha,_m=S.VP8LPredictorsAdd=[];_m.length=16,(S.VP8LPredictors=[]).length=16,(S.VP8LPredictorsAdd_C=[]).length=16,(S.VP8LPredictors_C=[]).length=16;var Em,Bm,zd,Wd,Jd,Tu,Xd,Pu,Go,oc,xn,Un,Us,sa,Hc,Sm,mf,Yx,$I,zI,WI,JI,XI,YI,Im,ZI,e5,t5,r5=i(511),n5=i(2041),s5=i(225),a5=i(767),i5=0,rw=n5,Zx=s5,uo=a5,$o=r5,ev=0,tv=1,o5=2,rv=3,nv=4,nw=5,l5=6,sw=7,aw=8,sv=9,iw=10,p7=[2,3,7],g7=[3,3,11],c5=[280,256,256,256,40],x7=[0,1,1,1,0],v7=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],y7=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],b7=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],w7=8,ow=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],lw=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],jm=null,N7=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],C7=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],d5=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],_7=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],E7=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],B7=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],S7=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Yd=[],Cl=[],Kc=[],I7=1,A5=2,Zd=[],zo=[];Ko("UpsampleRgbLinePair",pt,3),Ko("UpsampleBgrLinePair",wt,3),Ko("UpsampleRgbaLinePair",fn,4),Ko("UpsampleBgraLinePair",Gr,4),Ko("UpsampleArgbLinePair",xs,4),Ko("UpsampleRgba4444LinePair",sn,2),Ko("UpsampleRgb565LinePair",zt,2);var j7=S.UpsampleRgbLinePair,k7=S.UpsampleBgrLinePair,u5=S.UpsampleRgbaLinePair,h5=S.UpsampleBgraLinePair,f5=S.UpsampleArgbLinePair,m5=S.UpsampleRgba4444LinePair,F7=S.UpsampleRgb565LinePair,av=16,iv=1<<av-1,km=-227,cw=482,T7=6,p5=0,P7=i(256),R7=i(256),D7=i(256),L7=i(256),U7=i(cw-km),O7=i(cw-km);qn("YuvToRgbRow",pt,3),qn("YuvToBgrRow",wt,3),qn("YuvToRgbaRow",fn,4),qn("YuvToBgraRow",Gr,4),qn("YuvToArgbRow",xs,4),qn("YuvToRgba4444Row",sn,2),qn("YuvToRgb565Row",zt,2);var g5=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],ov=[0,2,8],M7=[8,7,6,4,4,2,2,2,1,1,1,1],Q7=1;this.WebPDecodeRGBA=function(v,C,V,W,ue){var be=tv,Ce=new St,je=new He;Ce.ba=je,je.S=be,je.width=[je.width],je.height=[je.height];var Le=je.width,qe=je.height,ct=new st;if(ct==null||v==null)var yt=2;else e(ct!=null),yt=Nl(v,C,V,ct.width,ct.height,ct.Pd,ct.Qd,ct.format,null);if(yt!=0?Le=0:(Le!=null&&(Le[0]=ct.width[0]),qe!=null&&(qe[0]=ct.height[0]),Le=1),Le){je.width=je.width[0],je.height=je.height[0],W!=null&&(W[0]=je.width),ue!=null&&(ue[0]=je.height);e:{if(W=new io,(ue=new Ft).data=v,ue.w=C,ue.ha=V,ue.kd=1,C=[0],e(ue!=null),((v=Nl(ue.data,ue.w,ue.ha,null,null,null,C,null,ue))==0||v==7)&&C[0]&&(v=4),(C=v)==0){if(e(Ce!=null),W.data=ue.data,W.w=ue.w+ue.offset,W.ha=ue.ha-ue.offset,W.put=et,W.ac=Zt,W.bc=Rt,W.ma=Ce,ue.xa){if((v=he())==null){Ce=1;break e}if(function(Ge,ut){var gt=[0],Et=[0],xt=[0];t:for(;;){if(Ge==null)return 0;if(ut==null)return Ge.a=2,0;if(Ge.l=ut,Ge.a=0,Z(Ge.m,ut.data,ut.w,ut.ha),!er(Ge.m,gt,Et,xt)){Ge.a=3;break t}if(Ge.xb=A5,ut.width=gt[0],ut.height=Et[0],!Re(gt[0],Et[0],1,Ge,null))break t;return 1}return e(Ge.a!=0),0}(v,W)){if(W=(C=qd(W.width,W.height,Ce.Oa,Ce.ba))==0){t:{W=v;r:for(;;){if(W==null){W=0;break t}if(e(W.s.yc!=null),e(W.s.Ya!=null),e(0<W.s.Wb),e((V=W.l)!=null),e((ue=V.ma)!=null),W.xb!=0){if(W.ca=ue.ba,W.tb=ue.tb,e(W.ca!=null),!bm(ue.Oa,V,rv)){W.a=2;break r}if(!Ee(W,V.width)||V.da)break r;if((V.da||_e(W.ca.S))&&Vi(),11>W.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),W.ca.f.kb.F!=null&&Vi()),W.Pb&&0<W.s.ua&&W.s.vb.X==null&&!z(W.s.vb,W.s.Wa.Xa)){W.a=1;break r}W.xb=0}if(!se(W,W.V,W.Ba,W.c,W.i,V.o,ce))break r;ue.Dc=W.Ma,W=1;break t}e(W.a!=0),W=0}W=!W}W&&(C=v.a)}else C=v.a}else{if((v=new Ud)==null){Ce=1;break e}if(v.Fa=ue.na,v.P=ue.P,v.qc=ue.Sa,Lo(v,W)){if((C=qd(W.width,W.height,Ce.Oa,Ce.ba))==0){if(v.Aa=0,V=Ce.Oa,e((ue=v)!=null),V!=null){if(0<(Le=0>(Le=V.Md)?0:100<Le?255:255*Le/100)){for(qe=ct=0;4>qe;++qe)12>(yt=ue.pb[qe]).lc&&(yt.ia=Le*M7[0>yt.lc?0:yt.lc]>>3),ct|=yt.ia;ct&&(alert("todo:VP8InitRandom"),ue.ia=1)}ue.Ga=V.Id,100<ue.Ga?ue.Ga=100:0>ue.Ga&&(ue.Ga=0)}(function(Ge,ut){if(Ge==null)return 0;if(ut==null)return Kn(Ge,2,"NULL VP8Io parameter in VP8Decode().");if(!Ge.cb&&!Lo(Ge,ut))return 0;if(e(Ge.cb),ut.ac==null||ut.ac(ut)){ut.ob&&(Ge.L=0);var gt=ov[Ge.L];if(Ge.L==2?(Ge.yb=0,Ge.zb=0):(Ge.yb=ut.v-gt>>4,Ge.zb=ut.j-gt>>4,0>Ge.yb&&(Ge.yb=0),0>Ge.zb&&(Ge.zb=0)),Ge.Va=ut.o+15+gt>>4,Ge.Hb=ut.va+15+gt>>4,Ge.Hb>Ge.za&&(Ge.Hb=Ge.za),Ge.Va>Ge.Ub&&(Ge.Va=Ge.Ub),0<Ge.L){var Et=Ge.ed;for(gt=0;4>gt;++gt){var xt;if(Ge.Qa.Cb){var It=Ge.Qa.Lb[gt];Ge.Qa.Fb||(It+=Et.Tb)}else It=Et.Tb;for(xt=0;1>=xt;++xt){var jt=Ge.gd[gt][xt],Qt=It;if(Et.Pc&&(Qt+=Et.vd[0],xt&&(Qt+=Et.od[0])),0<(Qt=0>Qt?0:63<Qt?63:Qt)){var Pt=Qt;0<Et.wb&&(Pt=4<Et.wb?Pt>>2:Pt>>1)>9-Et.wb&&(Pt=9-Et.wb),1>Pt&&(Pt=1),jt.dd=Pt,jt.tc=2*Qt+Pt,jt.ld=40<=Qt?2:15<=Qt?1:0}else jt.tc=0;jt.La=xt}}}gt=0}else Kn(Ge,6,"Frame setup failed"),gt=Ge.a;if(gt=gt==0){if(gt){Ge.$c=0,0<Ge.Aa||(Ge.Ic=Q7);t:{gt=Ge.Ic,Et=4*(Pt=Ge.za);var vr=32*Pt,Ar=Pt+1,Mr=0<Ge.L?Pt*(0<Ge.Aa?2:1):0,pr=(Ge.Aa==2?2:1)*Pt;if((jt=Et+832+(xt=3*(16*gt+ov[Ge.L])/2*vr)+(It=Ge.Fa!=null&&0<Ge.Fa.length?Ge.Kc.c*Ge.Kc.i:0))!=jt)gt=0;else{if(jt>Ge.Vb){if(Ge.Vb=0,Ge.Ec=i(jt),Ge.Fc=0,Ge.Ec==null){gt=Kn(Ge,1,"no memory during frame initialization.");break t}Ge.Vb=jt}jt=Ge.Ec,Qt=Ge.Fc,Ge.Ac=jt,Ge.Bc=Qt,Qt+=Et,Ge.Gd=o(vr,Ds),Ge.Hd=0,Ge.rb=o(Ar+1,yr),Ge.sb=1,Ge.wa=Mr?o(Mr,Kt):null,Ge.Y=0,Ge.D.Nb=0,Ge.D.wa=Ge.wa,Ge.D.Y=Ge.Y,0<Ge.Aa&&(Ge.D.Y+=Pt),e(!0),Ge.oc=jt,Ge.pc=Qt,Qt+=832,Ge.ya=o(pr,Fn),Ge.aa=0,Ge.D.ya=Ge.ya,Ge.D.aa=Ge.aa,Ge.Aa==2&&(Ge.D.aa+=Pt),Ge.R=16*Pt,Ge.B=8*Pt,Pt=(vr=ov[Ge.L])*Ge.R,vr=vr/2*Ge.B,Ge.sa=jt,Ge.ta=Qt+Pt,Ge.qa=Ge.sa,Ge.ra=Ge.ta+16*gt*Ge.R+vr,Ge.Ha=Ge.qa,Ge.Ia=Ge.ra+8*gt*Ge.B+vr,Ge.$c=0,Qt+=xt,Ge.mb=It?jt:null,Ge.nb=It?Qt:null,e(Qt+It<=Ge.Fc+Ge.Vb),Eu(Ge),s(Ge.Ac,Ge.Bc,0,Et),gt=1}}if(gt){if(ut.ka=0,ut.y=Ge.sa,ut.O=Ge.ta,ut.f=Ge.qa,ut.N=Ge.ra,ut.ea=Ge.Ha,ut.Vd=Ge.Ia,ut.fa=Ge.R,ut.Rc=Ge.B,ut.F=null,ut.J=0,!i5){for(gt=-255;255>=gt;++gt)r5[255+gt]=0>gt?-gt:gt;for(gt=-1020;1020>=gt;++gt)n5[1020+gt]=-128>gt?-128:127<gt?127:gt;for(gt=-112;112>=gt;++gt)s5[112+gt]=-16>gt?-16:15<gt?15:gt;for(gt=-255;510>=gt;++gt)a5[255+gt]=0>gt?0:255<gt?255:gt;i5=1}Xd=Uo,Pu=lf,oc=Yr,xn=Uc,Un=tc,Go=Od,Us=Kd,sa=Ho,Hc=Ae,Sm=Ke,mf=ku,Yx=P,$I=nt,zI=mt,WI=sc,JI=Ni,XI=ju,YI=hf,Cl[0]=vm,Cl[1]=cf,Cl[2]=gm,Cl[3]=xm,Cl[4]=ya,Cl[5]=ym,Cl[6]=bl,Cl[7]=Qd,Cl[8]=Vd,Cl[9]=wl,Yd[0]=Oo,Yd[1]=pm,Yd[2]=Bu,Yd[3]=df,Yd[4]=rc,Yd[5]=Md,Yd[6]=Af,Kc[0]=Su,Kc[1]=mm,Kc[2]=oo,Kc[3]=Mc,Kc[4]=Iu,Kc[5]=Tn,Kc[6]=uf,gt=1}else gt=0}gt&&(gt=function(an,aa){for(an.M=0;an.M<an.Va;++an.M){var Qr,gr=an.Jc[an.M&an.Xb],rr=an.m,Os=an;for(Qr=0;Qr<Os.za;++Qr){var Dr=rr,on=Os,Xn=on.Ac,Ra=on.Bc+4*Qr,_i=on.zc,Ss=on.ya[on.aa+Qr];if(on.Qa.Bb?Ss.$b=de(Dr,on.Pa.jb[0])?2+de(Dr,on.Pa.jb[2]):de(Dr,on.Pa.jb[1]):Ss.$b=0,on.kc&&(Ss.Ad=de(Dr,on.Bd)),Ss.Za=!de(Dr,145)+0,Ss.Za){var ei=Ss.Ob,Ei=0;for(on=0;4>on;++on){var ia,cn=_i[0+on];for(ia=0;4>ia;++ia){cn=E7[Xn[Ra+ia]][cn];for(var bn=d5[de(Dr,cn[0])];0<bn;)bn=d5[2*bn+de(Dr,cn[bn])];cn=-bn,Xn[Ra+ia]=cn}n(ei,Ei,Xn,Ra,4),Ei+=4,_i[0+on]=cn}}else cn=de(Dr,156)?de(Dr,128)?1:3:de(Dr,163)?2:0,Ss.Ob[0]=cn,s(Xn,Ra,cn,4),s(_i,0,cn,4);Ss.Dd=de(Dr,142)?de(Dr,114)?de(Dr,183)?1:3:2:0}if(Os.m.Ka)return Kn(an,7,"Premature end-of-partition0 encountered.");for(;an.ja<an.za;++an.ja){if(Os=gr,Dr=(rr=an).rb[rr.sb-1],Xn=rr.rb[rr.sb+rr.ja],Qr=rr.ya[rr.aa+rr.ja],Ra=rr.kc?Qr.Ad:0)Dr.la=Xn.la=0,Qr.Za||(Dr.Na=Xn.Na=0),Qr.Hc=0,Qr.Gc=0,Qr.ia=0;else{var Is,wn;if(Dr=Xn,Xn=Os,Ra=rr.Pa.Xc,_i=rr.ya[rr.aa+rr.ja],Ss=rr.pb[_i.$b],on=_i.ad,ei=0,Ei=rr.rb[rr.sb-1],cn=ia=0,s(on,ei,0,384),_i.Za)var Da=0,_l=Ra[3];else{bn=i(16);var Ms=Dr.Na+Ei.Na;if(Ms=jm(Xn,Ra[1],Ms,Ss.Eb,0,bn,0),Dr.Na=Ei.Na=(0<Ms)+0,1<Ms)Xd(bn,0,on,ei);else{var Hi=bn[0]+3>>3;for(bn=0;256>bn;bn+=16)on[ei+bn]=Hi}Da=1,_l=Ra[0]}var On=15&Dr.la,oa=15&Ei.la;for(bn=0;4>bn;++bn){var ho=1&oa;for(Hi=wn=0;4>Hi;++Hi)On=On>>1|(ho=(Ms=jm(Xn,_l,Ms=ho+(1&On),Ss.Sc,Da,on,ei))>Da)<<7,wn=wn<<2|(3<Ms?3:1<Ms?2:on[ei+0]!=0),ei+=16;On>>=4,oa=oa>>1|ho<<7,ia=(ia<<8|wn)>>>0}for(_l=On,Da=oa>>4,Is=0;4>Is;Is+=2){for(wn=0,On=Dr.la>>4+Is,oa=Ei.la>>4+Is,bn=0;2>bn;++bn){for(ho=1&oa,Hi=0;2>Hi;++Hi)Ms=ho+(1&On),On=On>>1|(ho=0<(Ms=jm(Xn,Ra[2],Ms,Ss.Qc,0,on,ei)))<<3,wn=wn<<2|(3<Ms?3:1<Ms?2:on[ei+0]!=0),ei+=16;On>>=2,oa=oa>>1|ho<<5}cn|=wn<<4*Is,_l|=On<<4<<Is,Da|=(240&oa)<<Is}Dr.la=_l,Ei.la=Da,_i.Hc=ia,_i.Gc=cn,_i.ia=43690&cn?0:Ss.ia,Ra=!(ia|cn)}if(0<rr.L&&(rr.wa[rr.Y+rr.ja]=rr.gd[Qr.$b][Qr.Za],rr.wa[rr.Y+rr.ja].La|=!Ra),Os.Ka)return Kn(an,7,"Premature end-of-file encountered.")}if(Eu(an),rr=aa,Os=1,Qr=(gr=an).D,Dr=0<gr.L&&gr.M>=gr.zb&&gr.M<=gr.Va,gr.Aa==0)t:{if(Qr.M=gr.M,Qr.uc=Dr,Pa(gr,Qr),Os=1,Qr=(wn=gr.D).Nb,Dr=(cn=ov[gr.L])*gr.R,Xn=cn/2*gr.B,bn=16*Qr*gr.R,Hi=8*Qr*gr.B,Ra=gr.sa,_i=gr.ta-Dr+bn,Ss=gr.qa,on=gr.ra-Xn+Hi,ei=gr.Ha,Ei=gr.Ia-Xn+Hi,oa=(On=wn.M)==0,ia=On>=gr.Va-1,gr.Aa==2&&Pa(gr,wn),wn.uc)for(ho=(Ms=gr).D.M,e(Ms.D.uc),wn=Ms.yb;wn<Ms.Hb;++wn){Da=wn,_l=ho;var Bi=(fo=(La=Ms).D).Nb;Is=La.R;var fo=fo.wa[fo.Y+Da],mo=La.sa,Ki=La.ta+16*Bi*Is+16*Da,po=fo.dd,Gn=fo.tc;if(Gn!=0)if(e(3<=Gn),La.L==1)0<Da&&JI(mo,Ki,Is,Gn+4),fo.La&&YI(mo,Ki,Is,Gn),0<_l&&WI(mo,Ki,Is,Gn+4),fo.La&&XI(mo,Ki,Is,Gn);else{var go=La.B,El=La.qa,Ru=La.ra+8*Bi*go+8*Da,qc=La.Ha,La=La.Ia+8*Bi*go+8*Da;Bi=fo.ld,0<Da&&(sa(mo,Ki,Is,Gn+4,po,Bi),Sm(El,Ru,qc,La,go,Gn+4,po,Bi)),fo.La&&(Yx(mo,Ki,Is,Gn,po,Bi),zI(El,Ru,qc,La,go,Gn,po,Bi)),0<_l&&(Us(mo,Ki,Is,Gn+4,po,Bi),Hc(El,Ru,qc,La,go,Gn+4,po,Bi)),fo.La&&(mf(mo,Ki,Is,Gn,po,Bi),$I(El,Ru,qc,La,go,Gn,po,Bi))}}if(gr.ia&&alert("todo:DitherRow"),rr.put!=null){if(wn=16*On,On=16*(On+1),oa?(rr.y=gr.sa,rr.O=gr.ta+bn,rr.f=gr.qa,rr.N=gr.ra+Hi,rr.ea=gr.Ha,rr.W=gr.Ia+Hi):(wn-=cn,rr.y=Ra,rr.O=_i,rr.f=Ss,rr.N=on,rr.ea=ei,rr.W=Ei),ia||(On-=cn),On>rr.o&&(On=rr.o),rr.F=null,rr.J=null,gr.Fa!=null&&0<gr.Fa.length&&wn<On&&(rr.J=yn(gr,rr,wn,On-wn),rr.F=gr.mb,rr.F==null&&rr.F.length==0)){Os=Kn(gr,3,"Could not decode alpha data.");break t}wn<rr.j&&(cn=rr.j-wn,wn=rr.j,e(!(1&cn)),rr.O+=gr.R*cn,rr.N+=gr.B*(cn>>1),rr.W+=gr.B*(cn>>1),rr.F!=null&&(rr.J+=rr.width*cn)),wn<On&&(rr.O+=rr.v,rr.N+=rr.v>>1,rr.W+=rr.v>>1,rr.F!=null&&(rr.J+=rr.v),rr.ka=wn-rr.j,rr.U=rr.va-rr.v,rr.T=On-wn,Os=rr.put(rr))}Qr+1!=gr.Ic||ia||(n(gr.sa,gr.ta-Dr,Ra,_i+16*gr.R,Dr),n(gr.qa,gr.ra-Xn,Ss,on+8*gr.B,Xn),n(gr.Ha,gr.Ia-Xn,ei,Ei+8*gr.B,Xn))}if(!Os)return Kn(an,6,"Output aborted.")}return 1}(Ge,ut)),ut.bc!=null&&ut.bc(ut),gt&=1}return gt?(Ge.cb=0,gt):0})(v,W)||(C=v.a)}}else C=v.a}C==0&&Ce.Oa!=null&&Ce.Oa.fd&&(C=wm(Ce.ba))}Ce=C}be=Ce!=0?null:11>be?je.f.RGBA.eb:je.f.kb.y}else be=null;return be};var x5=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(S,U){for(var _="",F=0;F<4;F++)_+=String.fromCharCode(S[U++]);return _}function A(S,U){return S[U+0]|S[U+1]<<8}function u(S,U){return(S[U+0]|S[U+1]<<8|S[U+2]<<16)>>>0}function f(S,U){return(S[U+0]|S[U+1]<<8|S[U+2]<<16|S[U+3]<<24)>>>0}new c;var h=[0],m=[0],p=[],g=new c,x=t,b=function(S,U){var _={},F=0,D=!1,X=0,ge=0;if(_.frames=[],!function(I,j){for(var Q=0;Q<4;Q++)if(I[j+Q]!="RIFF".charCodeAt(Q))return!0;return!1}(S,U)){for(f(S,U+=4),U+=8;U<S.length;){var ae=d(S,U),fe=f(S,U+=4);U+=4;var me=fe+(1&fe);switch(ae){case"VP8 ":case"VP8L":_.frames[F]===void 0&&(_.frames[F]={}),(Ie=_.frames[F]).src_off=D?ge:U-8,Ie.src_size=X+fe+8,F++,D&&(D=!1,X=0,ge=0);break;case"VP8X":(Ie=_.header={}).feature_flags=S[U];var Z=U+4;Ie.canvas_width=1+u(S,Z),Z+=3,Ie.canvas_height=1+u(S,Z),Z+=3;break;case"ALPH":D=!0,X=me+8,ge=U-8;break;case"ANIM":(Ie=_.header).bgcolor=f(S,U),Z=U+4,Ie.loop_count=A(S,Z),Z+=2;break;case"ANMF":var ye,Ie;(Ie=_.frames[F]={}).offset_x=2*u(S,U),U+=3,Ie.offset_y=2*u(S,U),U+=3,Ie.width=1+u(S,U),U+=3,Ie.height=1+u(S,U),U+=3,Ie.duration=u(S,U),U+=3,ye=S[U++],Ie.dispose=1&ye,Ie.blend=ye>>1&1}ae!="ANMF"&&(U+=me)}return _}}(x,0);b.response=x,b.rgbaoutput=!0,b.dataurl=!1;var w=b.header?b.header:null,k=b.frames?b.frames:null;if(w){w.loop_counter=w.loop_count,h=[w.canvas_height],m=[w.canvas_width];for(var O=0;O<k.length&&k[O].blend!=0;O++);}var L=k[0],E=g.WebPDecodeRGBA(x,L.src_off,L.src_size,m,h);L.rgba=E,L.imgwidth=m[0],L.imgheight=h[0];for(var B=0;B<m[0]*h[0]*4;B++)p[B]=E[B];return this.width=m,this.height=h,this.data=p,this}(function(t){var e,r,n,s,i,o,l,c,d,A=function(I){return I=I||{},this.isStrokeTransparent=I.isStrokeTransparent||!1,this.strokeOpacity=I.strokeOpacity||1,this.strokeStyle=I.strokeStyle||"#000000",this.fillStyle=I.fillStyle||"#000000",this.isFillTransparent=I.isFillTransparent||!1,this.fillOpacity=I.fillOpacity||1,this.font=I.font||"10px sans-serif",this.textBaseline=I.textBaseline||"alphabetic",this.textAlign=I.textAlign||"left",this.lineWidth=I.lineWidth||1,this.lineJoin=I.lineJoin||"miter",this.lineCap=I.lineCap||"butt",this.path=I.path||[],this.transform=I.transform!==void 0?I.transform.clone():new c,this.globalCompositeOperation=I.globalCompositeOperation||"normal",this.globalAlpha=I.globalAlpha||1,this.clip_path=I.clip_path||[],this.currentPoint=I.currentPoint||new o,this.miterLimit=I.miterLimit||10,this.lastPoint=I.lastPoint||new o,this.lineDashOffset=I.lineDashOffset||0,this.lineDash=I.lineDash||[],this.margin=I.margin||[0,0,0,0],this.prevPageLastElemOffset=I.prevPageLastElemOffset||0,this.ignoreClearRect=typeof I.ignoreClearRect!="boolean"||I.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new u(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new A}]);var u=function(I){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var j=I;Object.defineProperty(this,"pdf",{get:function(){return j}});var Q=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Q},set:function(z){Q=!!z}});var T=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return T},set:function(z){T=!!z}});var R=0;Object.defineProperty(this,"posX",{get:function(){return R},set:function(z){isNaN(z)||(R=z)}});var K=0;Object.defineProperty(this,"posY",{get:function(){return K},set:function(z){isNaN(z)||(K=z)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(z){var te;typeof z=="number"?te=[z,z,z,z]:((te=new Array(4))[0]=z[0],te[1]=z.length>=2?z[1]:te[0],te[2]=z.length>=3?z[2]:te[0],te[3]=z.length>=4?z[3]:te[1]),d.margin=te}});var M=!1;Object.defineProperty(this,"autoPaging",{get:function(){return M},set:function(z){M=z}});var re=0;Object.defineProperty(this,"lastBreak",{get:function(){return re},set:function(z){re=z}});var de=[];Object.defineProperty(this,"pageBreaks",{get:function(){return de},set:function(z){de=z}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(z){z instanceof A&&(d=z)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(z){d.path=z}});var le=[];Object.defineProperty(this,"ctxStack",{get:function(){return le},set:function(z){le=z}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(z){var te;te=f(z),this.ctx.fillStyle=te.style,this.ctx.isFillTransparent=te.a===0,this.ctx.fillOpacity=te.a,this.pdf.setFillColor(te.r,te.g,te.b,{a:te.a}),this.pdf.setTextColor(te.r,te.g,te.b,{a:te.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(z){var te=f(z);this.ctx.strokeStyle=te.style,this.ctx.isStrokeTransparent=te.a===0,this.ctx.strokeOpacity=te.a,te.a===0?this.pdf.setDrawColor(255,255,255):(te.a,this.pdf.setDrawColor(te.r,te.g,te.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(z){["butt","round","square"].indexOf(z)!==-1&&(this.ctx.lineCap=z,this.pdf.setLineCap(z))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(z){isNaN(z)||(this.ctx.lineWidth=z,this.pdf.setLineWidth(z))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(z){["bevel","round","miter"].indexOf(z)!==-1&&(this.ctx.lineJoin=z,this.pdf.setLineJoin(z))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(z){isNaN(z)||(this.ctx.miterLimit=z,this.pdf.setMiterLimit(z))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(z){this.ctx.textBaseline=z}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(z){["right","end","center","left","start"].indexOf(z)!==-1&&(this.ctx.textAlign=z)}});var q=null,Se=null,ee=null;Object.defineProperty(this,"fontFaces",{get:function(){return ee},set:function(z){q=null,Se=null,ee=z}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(z){var te;if(this.ctx.font=z,(te=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(z))!==null){var Ne=te[1];te[2];var Y=te[3],we=te[4];te[5];var Pe=te[6],Qe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(we)[2];we=Math.floor(Qe==="px"?parseFloat(we)*this.pdf.internal.scaleFactor:Qe==="em"?parseFloat(we)*this.pdf.getFontSize():parseFloat(we)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(we);var tt=function(ie){var ze,rt,At=[],Oe=ie.trim();if(Oe==="")return KN;if(Oe in TT)return[TT[Oe]];for(;Oe!=="";){switch(rt=null,ze=(Oe=RT(Oe)).charAt(0)){case'"':case"'":rt=loe(Oe.substring(1),ze);break;default:rt=coe(Oe)}if(rt===null||(At.push(rt[0]),(Oe=RT(rt[1]))!==""&&Oe.charAt(0)!==","))return KN;Oe=Oe.replace(/^,/,"")}return At}(Pe);if(this.fontFaces){var ot=function(ie,ze){var rt=ie.getFontList(),At=JSON.stringify(rt);if(q===null||Se!==At){var Oe=function(at){var Ve=[];return Object.keys(at).forEach(function(G){at[G].forEach(function(_e){var Me=null;switch(_e){case"bold":Me={family:G,weight:"bold"};break;case"italic":Me={family:G,style:"italic"};break;case"bolditalic":Me={family:G,weight:"bold",style:"italic"};break;case"":case"normal":Me={family:G}}Me!==null&&(Me.ref={name:G,style:_e},Ve.push(Me))})}),Ve}(rt);q=function(at){for(var Ve={},G=0;G<at.length;++G){var _e=HN(at[G]),Me=_e.family,We=_e.stretch,He=_e.style,st=_e.weight;Ve[Me]=Ve[Me]||{},Ve[Me][We]=Ve[Me][We]||{},Ve[Me][We][He]=Ve[Me][We][He]||{},Ve[Me][We][He][st]=_e}return Ve}(Oe.concat(ze)),Se=At}return q}(this.pdf,this.fontFaces),dt=tt.map(function(ie){return{family:ie,stretch:"normal",weight:Y,style:Ne}}),vt=function(ie,ze,rt){for(var At=(rt=rt||{}).defaultFontFamily||"times",Oe=Object.assign({},ooe,rt.genericFontFamilies||{}),at=null,Ve=null,G=0;G<ze.length;++G)if(Oe[(at=HN(ze[G])).family]&&(at.family=Oe[at.family]),ie.hasOwnProperty(at.family)){Ve=ie[at.family];break}if(!(Ve=Ve||ie[At]))throw new Error("Could not find a font-family for the rule '"+PT(at)+"' and default family '"+At+"'.");if(Ve=function(_e,Me){if(Me[_e])return Me[_e];var We=BE[_e],He=We<=BE.normal?-1:1,st=FT(Me,WM,We,He);if(!st)throw new Error("Could not find a matching font-stretch value for "+_e);return st}(at.stretch,Ve),Ve=function(_e,Me){if(Me[_e])return Me[_e];for(var We=zM[_e],He=0;He<We.length;++He)if(Me[We[He]])return Me[We[He]];throw new Error("Could not find a matching font-style for "+_e)}(at.style,Ve),!(Ve=function(_e,Me){if(Me[_e])return Me[_e];if(_e===400&&Me[500])return Me[500];if(_e===500&&Me[400])return Me[400];var We=ioe[_e],He=FT(Me,JM,We,_e<400?-1:1);if(!He)throw new Error("Could not find a matching font-weight for value "+_e);return He}(at.weight,Ve)))throw new Error("Failed to resolve a font for the rule '"+PT(at)+"'.");return Ve}(ot,dt);this.pdf.setFont(vt.ref.name,vt.ref.style)}else{var lt="";(Y==="bold"||parseInt(Y,10)>=700||Ne==="bold")&&(lt="bold"),Ne==="italic"&&(lt+="italic"),lt.length===0&&(lt="normal");for(var Ue="",Xe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},xe=0;xe<tt.length;xe++){if(this.pdf.internal.getFont(tt[xe],lt,{noFallback:!0,disableWarning:!0})!==void 0){Ue=tt[xe];break}if(lt==="bolditalic"&&this.pdf.internal.getFont(tt[xe],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ue=tt[xe],lt="bold";else if(this.pdf.internal.getFont(tt[xe],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ue=tt[xe],lt="normal";break}}if(Ue===""){for(var ve=0;ve<tt.length;ve++)if(Xe[tt[ve]]){Ue=Xe[tt[ve]];break}}Ue=Ue===""?"Times":Ue,this.pdf.setFont(Ue,lt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(z){this.ctx.globalCompositeOperation=z}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(z){this.ctx.globalAlpha=z}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(z){this.ctx.lineDashOffset=z,Ie.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(z){this.ctx.lineDash=z,Ie.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(z){this.ctx.ignoreClearRect=!!z}})};u.prototype.setLineDash=function(I){this.lineDash=I},u.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},u.prototype.fill=function(){k.call(this,"fill",!1)},u.prototype.stroke=function(){k.call(this,"stroke",!1)},u.prototype.beginPath=function(){this.path=[{type:"begin"}]},u.prototype.moveTo=function(I,j){if(isNaN(I)||isNaN(j))throw Vn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Q=this.ctx.transform.applyToPoint(new o(I,j));this.path.push({type:"mt",x:Q.x,y:Q.y}),this.ctx.lastPoint=new o(I,j)},u.prototype.closePath=function(){var I=new o(0,0),j=0;for(j=this.path.length-1;j!==-1;j--)if(this.path[j].type==="begin"&&Sn(this.path[j+1])==="object"&&typeof this.path[j+1].x=="number"){I=new o(this.path[j+1].x,this.path[j+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(I.x,I.y)},u.prototype.lineTo=function(I,j){if(isNaN(I)||isNaN(j))throw Vn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Q=this.ctx.transform.applyToPoint(new o(I,j));this.path.push({type:"lt",x:Q.x,y:Q.y}),this.ctx.lastPoint=new o(Q.x,Q.y)},u.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),k.call(this,null,!0)},u.prototype.quadraticCurveTo=function(I,j,Q,T){if(isNaN(Q)||isNaN(T)||isNaN(I)||isNaN(j))throw Vn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var R=this.ctx.transform.applyToPoint(new o(Q,T)),K=this.ctx.transform.applyToPoint(new o(I,j));this.path.push({type:"qct",x1:K.x,y1:K.y,x:R.x,y:R.y}),this.ctx.lastPoint=new o(R.x,R.y)},u.prototype.bezierCurveTo=function(I,j,Q,T,R,K){if(isNaN(R)||isNaN(K)||isNaN(I)||isNaN(j)||isNaN(Q)||isNaN(T))throw Vn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var M=this.ctx.transform.applyToPoint(new o(R,K)),re=this.ctx.transform.applyToPoint(new o(I,j)),de=this.ctx.transform.applyToPoint(new o(Q,T));this.path.push({type:"bct",x1:re.x,y1:re.y,x2:de.x,y2:de.y,x:M.x,y:M.y}),this.ctx.lastPoint=new o(M.x,M.y)},u.prototype.arc=function(I,j,Q,T,R,K){if(isNaN(I)||isNaN(j)||isNaN(Q)||isNaN(T)||isNaN(R))throw Vn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(K=!!K,!this.ctx.transform.isIdentity){var M=this.ctx.transform.applyToPoint(new o(I,j));I=M.x,j=M.y;var re=this.ctx.transform.applyToPoint(new o(0,Q)),de=this.ctx.transform.applyToPoint(new o(0,0));Q=Math.sqrt(Math.pow(re.x-de.x,2)+Math.pow(re.y-de.y,2))}Math.abs(R-T)>=2*Math.PI&&(T=0,R=2*Math.PI),this.path.push({type:"arc",x:I,y:j,radius:Q,startAngle:T,endAngle:R,counterclockwise:K})},u.prototype.arcTo=function(I,j,Q,T,R){throw new Error("arcTo not implemented.")},u.prototype.rect=function(I,j,Q,T){if(isNaN(I)||isNaN(j)||isNaN(Q)||isNaN(T))throw Vn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(I,j),this.lineTo(I+Q,j),this.lineTo(I+Q,j+T),this.lineTo(I,j+T),this.lineTo(I,j),this.lineTo(I+Q,j),this.lineTo(I,j)},u.prototype.fillRect=function(I,j,Q,T){if(isNaN(I)||isNaN(j)||isNaN(Q)||isNaN(T))throw Vn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var R={};this.lineCap!=="butt"&&(R.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(R.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(I,j,Q,T),this.fill(),R.hasOwnProperty("lineCap")&&(this.lineCap=R.lineCap),R.hasOwnProperty("lineJoin")&&(this.lineJoin=R.lineJoin)}},u.prototype.strokeRect=function(I,j,Q,T){if(isNaN(I)||isNaN(j)||isNaN(Q)||isNaN(T))throw Vn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(I,j,Q,T),this.stroke())},u.prototype.clearRect=function(I,j,Q,T){if(isNaN(I)||isNaN(j)||isNaN(Q)||isNaN(T))throw Vn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(I,j,Q,T))},u.prototype.save=function(I){I=typeof I!="boolean"||I;for(var j=this.pdf.internal.getCurrentPageInfo().pageNumber,Q=0;Q<this.pdf.internal.getNumberOfPages();Q++)this.pdf.setPage(Q+1),this.pdf.internal.out("q");if(this.pdf.setPage(j),I){this.ctx.fontSize=this.pdf.internal.getFontSize();var T=new A(this.ctx);this.ctxStack.push(this.ctx),this.ctx=T}},u.prototype.restore=function(I){I=typeof I!="boolean"||I;for(var j=this.pdf.internal.getCurrentPageInfo().pageNumber,Q=0;Q<this.pdf.internal.getNumberOfPages();Q++)this.pdf.setPage(Q+1),this.pdf.internal.out("Q");this.pdf.setPage(j),I&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},u.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(I){var j,Q,T,R;if(I.isCanvasGradient===!0&&(I=I.getColor()),!I)return{r:0,g:0,b:0,a:0,style:I};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(I))j=0,Q=0,T=0,R=0;else{var K=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(I);if(K!==null)j=parseInt(K[1]),Q=parseInt(K[2]),T=parseInt(K[3]),R=1;else if((K=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(I))!==null)j=parseInt(K[1]),Q=parseInt(K[2]),T=parseInt(K[3]),R=parseFloat(K[4]);else{if(R=1,typeof I=="string"&&I.charAt(0)!=="#"){var M=new QM(I);I=M.ok?M.toHex():"#000000"}I.length===4?(j=I.substring(1,2),j+=j,Q=I.substring(2,3),Q+=Q,T=I.substring(3,4),T+=T):(j=I.substring(1,3),Q=I.substring(3,5),T=I.substring(5,7)),j=parseInt(j,16),Q=parseInt(Q,16),T=parseInt(T,16)}}return{r:j,g:Q,b:T,a:R,style:I}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};u.prototype.fillText=function(I,j,Q,T){if(isNaN(j)||isNaN(Q)||typeof I!="string")throw Vn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(T=isNaN(T)?void 0:T,!h.call(this)){var R=me(this.ctx.transform.rotation),K=this.ctx.transform.scaleX;F.call(this,{text:I,x:j,y:Q,scale:K,angle:R,align:this.textAlign,maxWidth:T})}},u.prototype.strokeText=function(I,j,Q,T){if(isNaN(j)||isNaN(Q)||typeof I!="string")throw Vn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){T=isNaN(T)?void 0:T;var R=me(this.ctx.transform.rotation),K=this.ctx.transform.scaleX;F.call(this,{text:I,x:j,y:Q,scale:K,renderingMode:"stroke",angle:R,align:this.textAlign,maxWidth:T})}},u.prototype.measureText=function(I){if(typeof I!="string")throw Vn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var j=this.pdf,Q=this.pdf.internal.scaleFactor,T=j.internal.getFontSize(),R=j.getStringUnitWidth(I)*T/j.internal.scaleFactor;return new function(K){var M=(K=K||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return M}}),this}({width:R*=Math.round(96*Q/72*1e4)/1e4})},u.prototype.scale=function(I,j){if(isNaN(I)||isNaN(j))throw Vn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Q=new c(I,0,0,j,0,0);this.ctx.transform=this.ctx.transform.multiply(Q)},u.prototype.rotate=function(I){if(isNaN(I))throw Vn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var j=new c(Math.cos(I),Math.sin(I),-Math.sin(I),Math.cos(I),0,0);this.ctx.transform=this.ctx.transform.multiply(j)},u.prototype.translate=function(I,j){if(isNaN(I)||isNaN(j))throw Vn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Q=new c(1,0,0,1,I,j);this.ctx.transform=this.ctx.transform.multiply(Q)},u.prototype.transform=function(I,j,Q,T,R,K){if(isNaN(I)||isNaN(j)||isNaN(Q)||isNaN(T)||isNaN(R)||isNaN(K))throw Vn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var M=new c(I,j,Q,T,R,K);this.ctx.transform=this.ctx.transform.multiply(M)},u.prototype.setTransform=function(I,j,Q,T,R,K){I=isNaN(I)?1:I,j=isNaN(j)?0:j,Q=isNaN(Q)?0:Q,T=isNaN(T)?1:T,R=isNaN(R)?0:R,K=isNaN(K)?0:K,this.ctx.transform=new c(I,j,Q,T,R,K)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};u.prototype.drawImage=function(I,j,Q,T,R,K,M,re,de){var le=this.pdf.getImageProperties(I),q=1,Se=1,ee=1,z=1;T!==void 0&&re!==void 0&&(ee=re/T,z=de/R,q=le.width/T*re/T,Se=le.height/R*de/R),K===void 0&&(K=j,M=Q,j=0,Q=0),T!==void 0&&re===void 0&&(re=T,de=R),T===void 0&&re===void 0&&(re=le.width,de=le.height);var te=this.ctx.transform.decompose(),Ne=me(te.rotate.shx),Y=new c,we=(Y=(Y=(Y=Y.multiply(te.translate)).multiply(te.skew)).multiply(te.scale)).applyToRectangle(new l(K-j*ee,M-Q*z,T*q,R*Se));if(this.autoPaging){for(var Pe,Qe=g.call(this,we),tt=[],ot=0;ot<Qe.length;ot+=1)tt.indexOf(Qe[ot])===-1&&tt.push(Qe[ot]);w(tt);for(var dt=tt[0],vt=tt[tt.length-1],lt=dt;lt<vt+1;lt++){this.pdf.setPage(lt);var Ue=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Xe=lt===1?this.posY+this.margin[0]:this.margin[0],xe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ve=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ie=lt===1?0:xe+(lt-2)*ve;if(this.ctx.clip_path.length!==0){var ze=this.path;Pe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(Pe,this.posX+this.margin[3],-ie+Xe+this.ctx.prevPageLastElemOffset),O.call(this,"fill",!0),this.path=ze}var rt=JSON.parse(JSON.stringify(we));rt=b([rt],this.posX+this.margin[3],-ie+Xe+this.ctx.prevPageLastElemOffset)[0];var At=(lt>dt||lt<vt)&&p.call(this);At&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ue,ve,null).clip().discardPath()),this.pdf.addImage(I,"JPEG",rt.x,rt.y,rt.w,rt.h,null,null,Ne),At&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(I,"JPEG",we.x,we.y,we.w,we.h,null,null,Ne)};var g=function(I,j,Q){var T=[];j=j||this.pdf.internal.pageSize.width,Q=Q||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var R=this.posY+this.ctx.prevPageLastElemOffset;switch(I.type){default:case"mt":case"lt":T.push(Math.floor((I.y+R)/Q)+1);break;case"arc":T.push(Math.floor((I.y+R-I.radius)/Q)+1),T.push(Math.floor((I.y+R+I.radius)/Q)+1);break;case"qct":var K=Z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,I.x1,I.y1,I.x,I.y);T.push(Math.floor((K.y+R)/Q)+1),T.push(Math.floor((K.y+K.h+R)/Q)+1);break;case"bct":var M=ye(this.ctx.lastPoint.x,this.ctx.lastPoint.y,I.x1,I.y1,I.x2,I.y2,I.x,I.y);T.push(Math.floor((M.y+R)/Q)+1),T.push(Math.floor((M.y+M.h+R)/Q)+1);break;case"rect":T.push(Math.floor((I.y+R)/Q)+1),T.push(Math.floor((I.y+I.h+R)/Q)+1)}for(var re=0;re<T.length;re+=1)for(;this.pdf.internal.getNumberOfPages()<T[re];)x.call(this);return T},x=function(){var I=this.fillStyle,j=this.strokeStyle,Q=this.font,T=this.lineCap,R=this.lineWidth,K=this.lineJoin;this.pdf.addPage(),this.fillStyle=I,this.strokeStyle=j,this.font=Q,this.lineCap=T,this.lineWidth=R,this.lineJoin=K},b=function(I,j,Q){for(var T=0;T<I.length;T++)switch(I[T].type){case"bct":I[T].x2+=j,I[T].y2+=Q;case"qct":I[T].x1+=j,I[T].y1+=Q;default:I[T].x+=j,I[T].y+=Q}return I},w=function(I){return I.sort(function(j,Q){return j-Q})},k=function(I,j){var Q=this.fillStyle,T=this.strokeStyle,R=this.lineCap,K=this.lineWidth,M=Math.abs(K*this.ctx.transform.scaleX),re=this.lineJoin;if(this.autoPaging){for(var de,le,q=JSON.parse(JSON.stringify(this.path)),Se=JSON.parse(JSON.stringify(this.path)),ee=[],z=0;z<Se.length;z++)if(Se[z].x!==void 0)for(var te=g.call(this,Se[z]),Ne=0;Ne<te.length;Ne+=1)ee.indexOf(te[Ne])===-1&&ee.push(te[Ne]);for(var Y=0;Y<ee.length;Y++)for(;this.pdf.internal.getNumberOfPages()<ee[Y];)x.call(this);w(ee);for(var we=ee[0],Pe=ee[ee.length-1],Qe=we;Qe<Pe+1;Qe++){this.pdf.setPage(Qe),this.fillStyle=Q,this.strokeStyle=T,this.lineCap=R,this.lineWidth=M,this.lineJoin=re;var tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ot=Qe===1?this.posY+this.margin[0]:this.margin[0],dt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],vt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],lt=Qe===1?0:dt+(Qe-2)*vt;if(this.ctx.clip_path.length!==0){var Ue=this.path;de=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(de,this.posX+this.margin[3],-lt+ot+this.ctx.prevPageLastElemOffset),O.call(this,I,!0),this.path=Ue}if(le=JSON.parse(JSON.stringify(q)),this.path=b(le,this.posX+this.margin[3],-lt+ot+this.ctx.prevPageLastElemOffset),j===!1||Qe===0){var Xe=(Qe>we||Qe<Pe)&&p.call(this);Xe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],tt,vt,null).clip().discardPath()),O.call(this,I,j),Xe&&this.pdf.restoreGraphicsState()}this.lineWidth=K}this.path=q}else this.lineWidth=M,O.call(this,I,j),this.lineWidth=K},O=function(I,j){if((I!=="stroke"||j||!m.call(this))&&(I==="stroke"||j||!h.call(this))){for(var Q,T,R=[],K=this.path,M=0;M<K.length;M++){var re=K[M];switch(re.type){case"begin":R.push({begin:!0});break;case"close":R.push({close:!0});break;case"mt":R.push({start:re,deltas:[],abs:[]});break;case"lt":var de=R.length;if(K[M-1]&&!isNaN(K[M-1].x)&&(Q=[re.x-K[M-1].x,re.y-K[M-1].y],de>0)){for(;de>=0;de--)if(R[de-1].close!==!0&&R[de-1].begin!==!0){R[de-1].deltas.push(Q),R[de-1].abs.push(re);break}}break;case"bct":Q=[re.x1-K[M-1].x,re.y1-K[M-1].y,re.x2-K[M-1].x,re.y2-K[M-1].y,re.x-K[M-1].x,re.y-K[M-1].y],R[R.length-1].deltas.push(Q);break;case"qct":var le=K[M-1].x+2/3*(re.x1-K[M-1].x),q=K[M-1].y+2/3*(re.y1-K[M-1].y),Se=re.x+2/3*(re.x1-re.x),ee=re.y+2/3*(re.y1-re.y),z=re.x,te=re.y;Q=[le-K[M-1].x,q-K[M-1].y,Se-K[M-1].x,ee-K[M-1].y,z-K[M-1].x,te-K[M-1].y],R[R.length-1].deltas.push(Q);break;case"arc":R.push({deltas:[],abs:[],arc:!0}),Array.isArray(R[R.length-1].abs)&&R[R.length-1].abs.push(re)}}T=j?null:I==="stroke"?"stroke":"fill";for(var Ne=!1,Y=0;Y<R.length;Y++)if(R[Y].arc)for(var we=R[Y].abs,Pe=0;Pe<we.length;Pe++){var Qe=we[Pe];Qe.type==="arc"?B.call(this,Qe.x,Qe.y,Qe.radius,Qe.startAngle,Qe.endAngle,Qe.counterclockwise,void 0,j,!Ne):D.call(this,Qe.x,Qe.y),Ne=!0}else if(R[Y].close===!0)this.pdf.internal.out("h"),Ne=!1;else if(R[Y].begin!==!0){var tt=R[Y].start.x,ot=R[Y].start.y;X.call(this,R[Y].deltas,tt,ot),Ne=!0}T&&S.call(this,T),j&&U.call(this)}},L=function(I){var j=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Q=j*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return I-Q;case"top":return I+j-Q;case"hanging":return I+j-2*Q;case"middle":return I+j/2-Q;default:return I}},E=function(I){return I+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};u.prototype.createLinearGradient=function(){var I=function(){};return I.colorStops=[],I.addColorStop=function(j,Q){this.colorStops.push([j,Q])},I.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},I.isCanvasGradient=!0,I},u.prototype.createPattern=function(){return this.createLinearGradient()},u.prototype.createRadialGradient=function(){return this.createLinearGradient()};var B=function(I,j,Q,T,R,K,M,re,de){for(var le=ae.call(this,Q,T,R,K),q=0;q<le.length;q++){var Se=le[q];q===0&&(de?_.call(this,Se.x1+I,Se.y1+j):D.call(this,Se.x1+I,Se.y1+j)),ge.call(this,I,j,Se.x2,Se.y2,Se.x3,Se.y3,Se.x4,Se.y4)}re?U.call(this):S.call(this,M)},S=function(I){switch(I){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},U=function(){this.pdf.clip(),this.pdf.discardPath()},_=function(I,j){this.pdf.internal.out(r(I)+" "+n(j)+" m")},F=function(I){var j;switch(I.align){case"right":case"end":j="right";break;case"center":j="center";break;default:j="left"}var Q,T,R,K=this.pdf.getTextDimensions(I.text),M=L.call(this,I.y),re=E.call(this,M)-K.h,de=this.ctx.transform.applyToPoint(new o(I.x,M));if(this.autoPaging){var le=this.ctx.transform.decompose(),q=new c;q=(q=(q=q.multiply(le.translate)).multiply(le.skew)).multiply(le.scale);for(var Se=this.ctx.transform.applyToRectangle(new l(I.x,M,K.w,K.h)),ee=q.applyToRectangle(new l(I.x,re,K.w,K.h)),z=g.call(this,ee),te=[],Ne=0;Ne<z.length;Ne+=1)te.indexOf(z[Ne])===-1&&te.push(z[Ne]);w(te);for(var Y=te[0],we=te[te.length-1],Pe=Y;Pe<we+1;Pe++){this.pdf.setPage(Pe);var Qe=Pe===1?this.posY+this.margin[0]:this.margin[0],tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ot=this.pdf.internal.pageSize.height-this.margin[2],dt=ot-this.margin[0],vt=this.pdf.internal.pageSize.width-this.margin[1],lt=vt-this.margin[3],Ue=Pe===1?0:tt+(Pe-2)*dt;if(this.ctx.clip_path.length!==0){var Xe=this.path;Q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(Q,this.posX+this.margin[3],-1*Ue+Qe),O.call(this,"fill",!0),this.path=Xe}var xe=b([JSON.parse(JSON.stringify(ee))],this.posX+this.margin[3],-Ue+Qe+this.ctx.prevPageLastElemOffset)[0];I.scale>=.01&&(T=this.pdf.internal.getFontSize(),this.pdf.setFontSize(T*I.scale),R=this.lineWidth,this.lineWidth=R*I.scale);var ve=this.autoPaging!=="text";if(ve||xe.y+xe.h<=ot){if(ve||xe.y>=Qe&&xe.x<=vt){var ie=ve?I.text:this.pdf.splitTextToSize(I.text,I.maxWidth||vt-xe.x)[0],ze=b([JSON.parse(JSON.stringify(Se))],this.posX+this.margin[3],-Ue+Qe+this.ctx.prevPageLastElemOffset)[0],rt=ve&&(Pe>Y||Pe<we)&&p.call(this);rt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lt,dt,null).clip().discardPath()),this.pdf.text(ie,ze.x,ze.y,{angle:I.angle,align:j,renderingMode:I.renderingMode}),rt&&this.pdf.restoreGraphicsState()}}else xe.y<ot&&(this.ctx.prevPageLastElemOffset+=ot-xe.y);I.scale>=.01&&(this.pdf.setFontSize(T),this.lineWidth=R)}}else I.scale>=.01&&(T=this.pdf.internal.getFontSize(),this.pdf.setFontSize(T*I.scale),R=this.lineWidth,this.lineWidth=R*I.scale),this.pdf.text(I.text,de.x+this.posX,de.y+this.posY,{angle:I.angle,align:j,renderingMode:I.renderingMode,maxWidth:I.maxWidth}),I.scale>=.01&&(this.pdf.setFontSize(T),this.lineWidth=R)},D=function(I,j,Q,T){Q=Q||0,T=T||0,this.pdf.internal.out(r(I+Q)+" "+n(j+T)+" l")},X=function(I,j,Q){return this.pdf.lines(I,j,Q,null,null)},ge=function(I,j,Q,T,R,K,M,re){this.pdf.internal.out([e(s(Q+I)),e(i(T+j)),e(s(R+I)),e(i(K+j)),e(s(M+I)),e(i(re+j)),"c"].join(" "))},ae=function(I,j,Q,T){for(var R=2*Math.PI,K=Math.PI/2;j>Q;)j-=R;var M=Math.abs(Q-j);M<R&&T&&(M=R-M);for(var re=[],de=T?-1:1,le=j;M>1e-5;){var q=le+de*Math.min(M,K);re.push(fe.call(this,I,le,q)),M-=Math.abs(q-le),le=q}return re},fe=function(I,j,Q){var T=(Q-j)/2,R=I*Math.cos(T),K=I*Math.sin(T),M=R,re=-K,de=M*M+re*re,le=de+M*R+re*K,q=4/3*(Math.sqrt(2*de*le)-le)/(M*K-re*R),Se=M-q*re,ee=re+q*M,z=Se,te=-ee,Ne=T+j,Y=Math.cos(Ne),we=Math.sin(Ne);return{x1:I*Math.cos(j),y1:I*Math.sin(j),x2:Se*Y-ee*we,y2:Se*we+ee*Y,x3:z*Y-te*we,y3:z*we+te*Y,x4:I*Math.cos(Q),y4:I*Math.sin(Q)}},me=function(I){return 180*I/Math.PI},Z=function(I,j,Q,T,R,K){var M=I+.5*(Q-I),re=j+.5*(T-j),de=R+.5*(Q-R),le=K+.5*(T-K),q=Math.min(I,R,M,de),Se=Math.max(I,R,M,de),ee=Math.min(j,K,re,le),z=Math.max(j,K,re,le);return new l(q,ee,Se-q,z-ee)},ye=function(I,j,Q,T,R,K,M,re){var de,le,q,Se,ee,z,te,Ne,Y,we,Pe,Qe,tt,ot,dt=Q-I,vt=T-j,lt=R-Q,Ue=K-T,Xe=M-R,xe=re-K;for(le=0;le<41;le++)Y=(te=(q=I+(de=le/40)*dt)+de*((ee=Q+de*lt)-q))+de*(ee+de*(R+de*Xe-ee)-te),we=(Ne=(Se=j+de*vt)+de*((z=T+de*Ue)-Se))+de*(z+de*(K+de*xe-z)-Ne),le==0?(Pe=Y,Qe=we,tt=Y,ot=we):(Pe=Math.min(Pe,Y),Qe=Math.min(Qe,we),tt=Math.max(tt,Y),ot=Math.max(ot,we));return new l(Math.round(Pe),Math.round(Qe),Math.round(tt-Pe),Math.round(ot-Qe))},Ie=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var I,j,Q=(I=this.ctx.lineDash,j=this.ctx.lineDashOffset,JSON.stringify({lineDash:I,lineDashOffset:j}));this.prevLineDash!==Q&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Q)}}})(cr.API),function(t){var e=function(o){var l,c,d,A,u,f,h,m,p,g;for(c=[],d=0,A=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;A>d;d+=4)(u=(o.charCodeAt(d)<<24)+(o.charCodeAt(d+1)<<16)+(o.charCodeAt(d+2)<<8)+o.charCodeAt(d+3))!==0?(f=(u=((u=((u=((u=(u-(g=u%85))/85)-(p=u%85))/85)-(m=u%85))/85)-(h=u%85))/85)%85,c.push(f+33,h+33,m+33,p+33,g+33)):c.push(122);return function(x,b){for(var w=b;w>0;w--)x.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,d,A,u,f=String,h="length",m=255,p="charCodeAt",g="slice",x="replace";for(o[g](-2),o=o[g](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),d=[],A=0,u=(o+=l="uuuuu"[g](o[h]%5||5))[h];u>A;A+=5)c=52200625*(o[p](A)-33)+614125*(o[p](A+1)-33)+7225*(o[p](A+2)-33)+85*(o[p](A+3)-33)+(o[p](A+4)-33),d.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(b,w){for(var k=w;k>0;k--)b.pop()}(d,l[h]),f.fromCharCode.apply(f,d)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",d=0;d<o.length;d+=2)c+=String.fromCharCode("0x"+(o[d]+o[d+1]));return c},i=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=yE(l)).reduce(function(d,A){return d+String.fromCharCode(A)},"")};t.processDataByFilters=function(o,l){var c=0,d=o||"",A=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":d=r(d),A.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=e(d),A.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=s(d),A.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=n(d),A.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=i(d),A.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:d,reverseChain:A.reverse().join(" ")}}}(cr.API),function(t){t.loadFile=function(e,r,n){return function(s,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,d,A){var u=new XMLHttpRequest,f=0,h=function(m){var p=m.length,g=[],x=String.fromCharCode;for(f=0;f<p;f+=1)g.push(x(255&m.charCodeAt(f)));return g.join("")};if(u.open("GET",c,!d),u.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(u.onload=function(){u.status===200?A(h(this.responseText)):A(void 0)}),u.send(null),d&&u.status===200)return h(u.responseText)}(s,i,o)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(cr.API),function(t){function e(){return(kr.html2canvas?Promise.resolve(kr.html2canvas):xd(()=>Promise.resolve().then(()=>ZS),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(kr.DOMPurify?Promise.resolve(kr.DOMPurify):xd(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Sn(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(l,c){var d=document.createElement(l);for(var A in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[A]=c.style[A];return d},i=function l(c,d){for(var A=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),u=c.firstChild;u;u=u.nextSibling)d!==!0&&u.nodeType===1&&u.nodeName==="SCRIPT"||A.appendChild(l(u,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(A.width=c.width,A.height=c.height,A.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(A.value=c.value),A.addEventListener("load",function(){A.scrollTop=c.scrollTop,A.scrollLeft=c.scrollLeft},!0)),A},o=function l(c){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),A=l.convert(Promise.resolve(),d);return(A=A.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(d){return this.set({src:s("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(e).then(function(c){var d=this.opt.jsPDF,A=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=A,A)for(var h=0;h<A.length;++h){var m=A[h],p=m.src.find(function(g){return g.format==="truetype"});p&&d.addFont(p.url,m.ref.name,m.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,d.context2d.save(!0),c(this.prop.container,f)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(d){if(d in o.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var d=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(d):d})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(d,A){return Math.floor(d*A/72*96)}return this.then(function(){(l=l||cr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,d,A){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),A!=null&&(this.progress.stack=A),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,d,A){return this.setProgress(l?this.progress.val+l:null,c||null,d?this.progress.n+d:null,A?this.progress.stack.concat(A):null)},o.prototype.then=function(l,c){var d=this;return this.thenCore(l,c,function(A,u){return d.updateProgress(null,null,1,[A]),Promise.prototype.then.call(this,function(f){return d.updateProgress(null,A),f}).then(A,u).then(function(f){return d.updateProgress(1),f})})},o.prototype.thenCore=function(l,c,d){d=d||Promise.prototype.then;var A=this;l&&(l=l.bind(A)),c&&(c=c.bind(A));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?A:o.convert(Object.assign({},A),Promise.prototype),f=d.call(u,l,c);return o.convert(f,A.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(d){c=c.thenCore(d)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,cr.getPageSize=function(l,c,d){if(Sn(l)==="object"){var A=l;l=A.orientation,c=A.unit||c,d=A.format||d}c=c||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var u,f=(""+d).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+c}var m,p=0,g=0;if(h.hasOwnProperty(f))p=h[f][1]/u,g=h[f][0]/u;else try{p=d[1],g=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",g>p&&(m=g,g=p,p=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",p>g&&(m=g,g=p,p=m)}return{width:g,height:p,unit:c,k:u,orientation:l}},t.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(HN):null;var d=new o(c);return c.worker?d:d.from(l).doCallback()}}(cr.API),cr.API.addJS=function(t){return LT=t,this.internal.events.subscribe("postPutResources",function(){p1=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(p1+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),DT=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+LT+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){p1!==void 0&&DT!==void 0&&this.internal.out("/Names <</JavaScript "+p1+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),i=0;i<s.length;i++){var o=s[i],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,A=[];for(i=0;i<d;i++){var u=r.internal.newObject();A.push(u);var f=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+f.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<A.length;i++)r.internal.write("(page_"+(i+1)+")"+A[i]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,i){var o={title:s,options:i,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var o=n.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var d=0;d<n.children.length;d++)this.renderItems(n.children[d])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var i=0;i<s.children.length;i++)n.count++,this.count_r(n,s.children[i]);return n.count}}])}(cr.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,s,i,o,l){var c,d=this.decode.DCT_DECODE,A=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(u){for(var f,h=256*u.charCodeAt(4)+u.charCodeAt(5),m=u.length,p={width:0,height:0,numcomponents:1},g=4;g<m;g+=2){if(g+=h,e.indexOf(u.charCodeAt(g+1))!==-1){f=256*u.charCodeAt(g+5)+u.charCodeAt(g+6),p={width:256*u.charCodeAt(g+7)+u.charCodeAt(g+8),height:f,numcomponents:u.charCodeAt(g+9)};break}h=256*u.charCodeAt(g+2)+u.charCodeAt(g+3)}return p}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}A={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:n,alias:s}}return A}}(cr.API),cr.API.processPNG=function(t,e,r,n){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var s,i=qie(t,{checkCrc:!0}),o=i.width,l=i.height,c=i.channels,d=i.palette,A=i.depth;s=d&&c===1?function(B){for(var S=B.width,U=B.height,_=B.data,F=B.palette,D=B.depth,X=!1,ge=[],ae=[],fe=void 0,me=!1,Z=0,ye=0;ye<F.length;ye++){var Ie=QF(F[ye],4),I=Ie[0],j=Ie[1],Q=Ie[2],T=Ie[3];ge.push(I,j,Q),T!=null&&(T===0?(Z++,ae.length<1&&ae.push(ye)):T<255&&(me=!0))}if(me||Z>1){X=!0,ae=void 0;var R=S*U;fe=new Uint8Array(R);for(var K=new DataView(_.buffer),M=0;M<R;M++){var re=qN(K,M,D),de=QF(F[re],4)[3];fe[M]=de}}else Z===0&&(ae=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:X?8:void 0,colorBytes:_,alphaBytes:fe,needSMask:X,palette:ge,mask:ae}}(i):c===2||c===4?function(B){for(var S=B.data,U=B.width,_=B.height,F=B.channels,D=B.depth,X=F===2?"DeviceGray":"DeviceRGB",ge=F-1,ae=U*_,fe=ge,me=ae*fe,Z=1*ae,ye=Math.ceil(me*D/8),Ie=Math.ceil(Z*D/8),I=new Uint8Array(ye),j=new Uint8Array(Ie),Q=new DataView(S.buffer),T=new DataView(I.buffer),R=new DataView(j.buffer),K=!1,M=0;M<ae;M++){for(var re=M*F,de=0;de<fe;de++)GT(T,qN(Q,re+de,D),M*fe+de,D);var le=qN(Q,re+fe,D);le<(1<<D)-1&&(K=!0),GT(R,le,1*M,D)}return{colorSpace:X,colorsPerPixel:ge,sMaskBitsPerComponent:K?D:void 0,colorBytes:I,alphaBytes:j,needSMask:K}}(i):function(B){var S=B.data,U=B.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:U,colorsPerPixel:U==="DeviceGray"?1:3,colorBytes:S instanceof Uint16Array?function(_){for(var F=_.length,D=new Uint8Array(2*F),X=new DataView(D.buffer,D.byteOffset,D.byteLength),ge=0;ge<F;ge++)X.setUint16(2*ge,_[ge],!1);return D}(S):S,needSMask:!1}}(i);var u,f,h,m=s,p=m.colorSpace,g=m.colorsPerPixel,x=m.sMaskBitsPerComponent,b=m.colorBytes,w=m.alphaBytes,k=m.needSMask,O=m.palette,L=m.mask,E=null;return n!==cr.API.image_compression.NONE&&typeof yE=="function"?(E=function(B){var S;switch(B){case cr.API.image_compression.FAST:S=11;break;case cr.API.image_compression.MEDIUM:S=13;break;case cr.API.image_compression.SLOW:S=14;break;default:S=12}return S}(n),u=this.decode.FLATE_DECODE,f="/Predictor ".concat(E," /Colors ").concat(g," /BitsPerComponent ").concat(A," /Columns ").concat(o),t=QT(b,Math.ceil(o*g*A/8),g,A,n),k&&(h=QT(w,Math.ceil(o*x/8),1,x,n))):(u=void 0,f=void 0,t=b,k&&(h=w)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:t,index:e,filter:u,decodeParameters:f,transparency:L,palette:O,sMask:h,predictor:E,width:o,height:l,bitsPerComponent:A,sMaskBitsPerComponent:x,colorSpace:p}}},function(t){t.processGIF89A=function(e,r,n,s){var i=new hoe(e),o=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:o,height:l},A=new GN(100).encode(d,100);return t.processJPEG.call(this,A,r,n,s)},t.processGIF87A=t.processGIF89A}(cr.API),Sl.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Sl.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Vn.log("bit decode error:"+r)}},Sl.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<e;s++)for(var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Sl.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<t;s++){var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*s*4,l=i>>4,c=15&i,d=this.palette[l];if(this.data[o]=d.blue,this.data[o+1]=d.green,this.data[o+2]=d.red,this.data[o+3]=255,2*s+1>=this.width)break;d=this.palette[c],this.data[o+4]=d.blue,this.data[o+4+1]=d.green,this.data[o+4+2]=d.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Sl.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(s<this.palette.length){var o=this.palette[s];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}t!==0&&(this.pos+=4-t)}},Sl.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&e)/e*255|0,l=(i>>5&e)/e*255|0,c=(i>>10&e)/e*255|0,d=i>>15?255:0,A=n*this.width*4+4*s;this.data[A]=c,this.data[A+1]=l,this.data[A+2]=o,this.data[A+3]=d}this.pos+=t}},Sl.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&r)/r*255|0,d=(o>>11)/e*255|0,A=s*this.width*4+4*i;this.data[A]=d,this.data[A+1]=c,this.data[A+2]=l,this.data[A+3]=255}this.pos+=t}},Sl.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=i,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Sl.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=i,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=o}},Sl.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,s){var i=new Sl(e,!1),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},d=new GN(100).encode(c,100);return t.processJPEG.call(this,d,r,n,s)}}(cr.API),zT.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,s){var i=new zT(e),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},d=new GN(100).encode(c,100);return t.processJPEG.call(this,d,r,n,s)}}(cr.API),cr.API.processRGBA=function(t,e,r){for(var n=t.data,s=n.length,i=new Uint8Array(s/4*3),o=new Uint8Array(s/4),l=0,c=0,d=0;d<s;d+=4){var A=n[d],u=n[d+1],f=n[d+2],h=n[d+3];i[l++]=A,i[l++]=u,i[l++]=f,o[c++]=h}var m=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},cr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},kf=cr.API,g1=kf.getCharWidthsArray=function(t,e){var r,n,s=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,d=e.kerning?e.kerning:s.metadata.Unicode.kerning,A=d.fof?d.fof:1,u=e.doKerning!==!1,f=0,h=t.length,m=0,p=l[0]||c,g=[];for(r=0;r<h;r++)n=t.charCodeAt(r),typeof s.metadata.widthOfString=="function"?g.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+o*(1e3/i)||0)/1e3):(f=u&&Sn(d[n])==="object"&&!isNaN(parseInt(d[n][m],10))?d[n][m]/A:0,g.push((l[n]||p)/c+f)),m=n;return g},UT=kf.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return kf.processArabic&&(t=kf.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,s)/r:g1.apply(this,arguments).reduce(function(i,o){return i+o},0)},OT=function(t,e,r,n){for(var s=[],i=0,o=t.length,l=0;i!==o&&l+e[i]<r;)l+=e[i],i++;s.push(t.slice(0,i));var c=i;for(l=0;i!==o;)l+e[i]>n&&(s.push(t.slice(c,i)),l=0,c=i),l+=e[i],i++;return c!==i&&s.push(t.slice(c,i)),s},MT=function(t,e,r){r||(r={});var n,s,i,o,l,c,d,A=[],u=[A],f=r.textIndent||0,h=0,m=0,p=t.split(" "),g=g1.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?p[0].length+2:r.lineIndent||0){var x=Array(c).join(" "),b=[];p.map(function(k){(k=k.split(/\s*\n/)).length>1?b=b.concat(k.map(function(O,L){return(L&&O.length?`
`:"")+O})):b.push(k[0])}),p=b,c=UT.apply(this,[x,r])}for(i=0,o=p.length;i<o;i++){var w=0;if(n=p[i],c&&n[0]==`
`&&(n=n.substr(1),w=1),f+h+(m=(s=g1.apply(this,[n,r])).reduce(function(k,O){return k+O},0))>e||w){if(m>e){for(l=OT.apply(this,[n,s,e-(f+h),e]),A.push(l.shift()),A=[l.pop()];l.length;)u.push([l.shift()]);m=s.slice(n.length-(A[0]?A[0].length:0)).reduce(function(k,O){return k+O},0)}else A=[n];u.push(A),f=m+c,h=g}else A.push(n),f+=h+m,h=g}return d=c?function(k,O){return(O?x:"")+k.join(" ")}:function(k){return k.join(" ")},u.map(d)},kf.splitTextToSize=function(t,e,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(A){if(A.widths&&A.kerning)return{widths:A.widths,kerning:A.kerning};var u=this.internal.getFont(A.fontName,A.fontStyle),f="Unicode";return u.metadata[f]?{widths:u.metadata[f].widths||{0:1},kerning:u.metadata[f].kerning||{}}:{font:u.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/s;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=r.lineIndent;var l,c,d=[];for(l=0,c=n.length;l<c;l++)d=d.concat(MT.apply(this,[n[l],o,i]));return d},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",r="klmnopqrstuvwxyz",n={},s={},i=0;i<16;i++)n[r[i]]=e[i],s[e[i]]=r[i];var o=function(f){return"0x"+parseInt(f,10).toString(16)},l=t.__fontmetrics__.compress=function(f){var h,m,p,g,x=["{"];for(var b in f){if(h=f[b],isNaN(parseInt(b,10))?m="'"+b+"'":(b=parseInt(b,10),m=(m=o(b).slice(2)).slice(0,-1)+s[m.slice(-1)]),typeof h=="number")h<0?(p=o(h).slice(3),g="-"):(p=o(h).slice(2),g=""),p=g+p.slice(0,-1)+s[p.slice(-1)];else{if(Sn(h)!=="object")throw new Error("Don't know what to do with value type "+Sn(h)+".");p=l(h)}x.push(m+p)}return x.push("}"),x.join("")},c=t.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,m,p,g,x={},b=1,w=x,k=[],O="",L="",E=f.length-1,B=1;B<E;B+=1)(g=f[B])=="'"?h?(p=h.join(""),h=void 0):h=[]:h?h.push(g):g=="{"?(k.push([w,p]),w={},p=void 0):g=="}"?((m=k.pop())[0][m[1]]=w,p=void 0,w=m[0]):g=="-"?b=-1:p===void 0?n.hasOwnProperty(g)?(O+=n[g],p=parseInt(O,16)*b,b=1,O=""):O+=g:n.hasOwnProperty(g)?(L+=n[g],w[p]=parseInt(L,16)*b,b=1,p=void 0,L=""):L+=g;return x},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},A={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},u={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(f){var h=f.font,m=u.Unicode[h.postScriptName];m&&(h.metadata.Unicode={},h.metadata.Unicode.widths=m.widths,h.metadata.Unicode.kerning=m.kerning);var p=A.Unicode[h.postScriptName];p&&(h.metadata.Unicode.encoding=p,h.encoding=p.codePages[0])}])}(cr.API),function(t){var e=function(r){for(var n=r.length,s=new Uint8Array(n),i=0;i<n;i++)s[i]=r.charCodeAt(i);return s};t.API.events.push(["addFont",function(r){var n=void 0,s=r.font,i=r.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(xy(l)),o.metadata=t.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,n)}}])}(cr),cr.API.addSvgAsImage=function(t,e,r,n,s,i,o,l){if(isNaN(e)||isNaN(r))throw Vn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw Vn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=s;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var A={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},u=this;return(kr.canvg?Promise.resolve(kr.canvg):xd(()=>import("./index.es-BIe7WqYa.js"),[])).catch(function(f){return Promise.reject(new Error("Could not load canvg: "+f))}).then(function(f){return f.default?f.default:f}).then(function(f){return f.fromString(d,t,A)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(f){return f.render(A)}).then(function(){u.addImage(c.toDataURL("image/jpeg",1),e,r,n,s,o,l)})},cr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(e,r);return this},cr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,s,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],d=0,A=0,u=0;function f(m,p){var g,x=!1;for(g=0;g<m.length;g+=1)m[g]===p&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var h=l.length;for(u=0;u<h;u+=1)r[l[u]].value=r[l[u]].defaultValue,r[l[u]].explicitSet=!1}if(Sn(t)==="object"){for(s in t)if(i=t[s],f(l,s)&&i!==void 0){if(r[s].type==="boolean"&&typeof i=="boolean")r[s].value=i;else if(r[s].type==="name"&&f(r[s].valueSet,i))r[s].value=i;else if(r[s].type==="integer"&&Number.isInteger(i))r[s].value=i;else if(r[s].type==="array"){for(d=0;d<i.length;d+=1)if(n=!0,i[d].length===1&&typeof i[d][0]=="number")c.push(String(i[d]-1));else if(i[d].length>1){for(A=0;A<i[d].length;A+=1)typeof i[d][A]!="number"&&(n=!1);n===!0&&c.push([i[d][0]-1,i[d][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,p=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?p.push("/"+m+" /"+r[m].value):p.push("/"+m+" "+r[m].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=i.length+o.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(s+i+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(cr.API),function(t){var e=t.API,r=e.pdfEscape16=function(i,o){for(var l,c=o.metadata.Unicode.widths,d=["","0","00","000","0000"],A=[""],u=0,f=i.length;u<f;++u){if(l=o.metadata.characterToGlyph(i.charCodeAt(u)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(u),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return A.join("");l=l.toString(16),A.push(d[4-l.length],l)}return A.join("")},n=function(i){var o,l,c,d,A,u,f;for(A=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],u=0,f=(l=Object.keys(i).sort(function(h,m){return h-m})).length;u<f;u++)o=l[u],c.length>=100&&(A+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(d=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+d+">"));return c.length&&(A+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),A+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,d=o.newObject,A=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var u=l.metadata.Unicode.widths,f=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",m=0;m<f.length;m++)h+=String.fromCharCode(f[m]);var p=d();A({data:h,addLength1:!0,objectId:p}),c("endobj");var g=d();A({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var x=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+zf(l.fontName)),c("/FontFile2 "+p+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var b=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+zf(l.fontName)),c("/FontDescriptor "+x+" 0 R"),c("/W "+t.API.PDFObject.convert(u)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+g+" 0 R"),c("/BaseFont /"+zf(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+b+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,d=o.newObject,A=o.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var u=l.metadata.rawData,f="",h=0;h<u.length;h++)f+=String.fromCharCode(u[h]);var m=d();A({data:f,addLength1:!0,objectId:m}),c("endobj");var p=d();A({data:n(l.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var g=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+zf(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var x=0;x<l.metadata.hmtx.widths.length;x++)l.metadata.hmtx.widths[x]=parseInt(l.metadata.hmtx.widths[x]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+zf(l.fontName)+"/FontDescriptor "+g+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var s=function(i){var o,l=i.text||"",c=i.x,d=i.y,A=i.options||{},u=i.mutex||{},f=u.pdfEscape,h=u.activeFontKey,m=u.fonts,p=h,g="",x=0,b="",w=m[p].encoding;if(m[p].encoding!=="Identity-H")return{text:l,x:c,y:d,options:A,mutex:u};for(b=l,p=h,Array.isArray(l)&&(b=l[0]),x=0;x<b.length;x+=1)m[p].metadata.hasOwnProperty("cmap")&&(o=m[p].metadata.cmap.unicode.codeMap[b[x].charCodeAt(0)]),o||b[x].charCodeAt(0)<256&&m[p].metadata.hasOwnProperty("Unicode")?g+=b[x]:g+="";var k="";return parseInt(p.slice(1))<14||w==="WinAnsiEncoding"?k=f(g,p).split("").map(function(O){return O.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(k=r(g,m[p])),u.isHex=!0,{text:k,x:c,y:d,options:A,mutex:u}};e.events.push(["postProcessText",function(i){var o=i.text||"",l=[],c={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var d=0;for(d=0;d<o.length;d+=1)Array.isArray(o[d])&&o[d].length===3?l.push([s(Object.assign({},c,{text:o[d][0]})).text,o[d][1],o[d][2]]):l.push(s(Object.assign({},c,{text:o[d]})).text);i.text=l}else i.text=s(Object.assign({},c,{text:o})).text}])}(cr),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(cr.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var s,i,o,l,c,d,A,u=e,f=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},g=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,w=0;this.__bidiEngine__={};var k=function(_){var F=_.charCodeAt(),D=F>>8,X=p[D];return X!==void 0?u[256*X+(255&F)]:D===252||D===253?"AL":x.test(D)?"L":D===8?"R":"N"},O=function(_){for(var F,D=0;D<_.length;D++){if((F=k(_.charAt(D)))==="L")return!1;if(F==="R")return!0}return!1},L=function(_,F,D,X){var ge,ae,fe,me,Z=F[X];switch(Z){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"N":case"AN":break;case"EN":b&&(Z="AN");break;case"AL":b=!0,Z="R";break;case"WS":case"BN":Z="N";break;case"CS":X<1||X+1>=F.length||(ge=D[X-1])!=="EN"&&ge!=="AN"||(ae=F[X+1])!=="EN"&&ae!=="AN"?Z="N":b&&(ae="AN"),Z=ae===ge?ae:"N";break;case"ES":Z=(ge=X>0?D[X-1]:"B")==="EN"&&X+1<F.length&&F[X+1]==="EN"?"EN":"N";break;case"ET":if(X>0&&D[X-1]==="EN"){Z="EN";break}if(b){Z="N";break}for(fe=X+1,me=F.length;fe<me&&F[fe]==="ET";)fe++;Z=fe<me&&F[fe]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(me=F.length,fe=X+1;fe<me&&F[fe]==="NSM";)fe++;if(fe<me){var ye=_[X],Ie=ye>=1425&&ye<=2303||ye===64286;if(ge=F[fe],Ie&&(ge==="R"||ge==="AL")){Z="R";break}}}Z=X<1||(ge=F[X-1])==="B"?"N":D[X-1];break;case"B":b=!1,s=!0,Z=w;break;case"S":i=!0,Z="N"}return Z},E=function(_,F,D){var X=_.split("");return D&&B(X,D,{hiLevel:w}),X.reverse(),F&&F.reverse(),X.join("")},B=function(_,F,D){var X,ge,ae,fe,me,Z=-1,ye=_.length,Ie=0,I=[],j=w?h:f,Q=[];for(b=!1,s=!1,i=!1,ge=0;ge<ye;ge++)Q[ge]=k(_[ge]);for(ae=0;ae<ye;ae++){if(me=Ie,I[ae]=L(_,Q,I,ae),X=240&(Ie=j[me][m[I[ae]]]),Ie&=15,F[ae]=fe=j[Ie][5],X>0)if(X===16){for(ge=Z;ge<ae;ge++)F[ge]=1;Z=-1}else Z=-1;if(j[Ie][6])Z===-1&&(Z=ae);else if(Z>-1){for(ge=Z;ge<ae;ge++)F[ge]=fe;Z=-1}Q[ae]==="B"&&(F[ae]=0),D.hiLevel|=fe}i&&function(T,R,K){for(var M=0;M<K;M++)if(T[M]==="S"){R[M]=w;for(var re=M-1;re>=0&&T[re]==="WS";re--)R[re]=w}}(Q,F,ye)},S=function(_,F,D,X,ge){if(!(ge.hiLevel<_)){if(_===1&&w===1&&!s)return F.reverse(),void(D&&D.reverse());for(var ae,fe,me,Z,ye=F.length,Ie=0;Ie<ye;){if(X[Ie]>=_){for(me=Ie+1;me<ye&&X[me]>=_;)me++;for(Z=Ie,fe=me-1;Z<fe;Z++,fe--)ae=F[Z],F[Z]=F[fe],F[fe]=ae,D&&(ae=D[Z],D[Z]=D[fe],D[fe]=ae);Ie=me}Ie++}}},U=function(_,F,D){var X=_.split(""),ge={hiLevel:w};return D||(D=[]),B(X,D,ge),function(ae,fe,me){if(me.hiLevel!==0&&A)for(var Z,ye=0;ye<ae.length;ye++)fe[ye]===1&&(Z=g.indexOf(ae[ye]))>=0&&(ae[ye]=g[Z+1])}(X,D,ge),S(2,X,F,D,ge),S(1,X,F,D,ge),X.join("")};return this.__bidiEngine__.doBidiReorder=function(_,F,D){if(function(ge,ae){if(ae)for(var fe=0;fe<ge.length;fe++)ae[fe]=fe;l===void 0&&(l=O(ge)),d===void 0&&(d=O(ge))}(_,F),o||!c||d)if(o&&c&&l^d)w=l?1:0,_=E(_,F,D);else if(!o&&c&&d)w=l?1:0,_=U(_,F,D),_=E(_,F);else if(!o||l||c||d){if(o&&!c&&l^d)_=E(_,F),l?(w=0,_=U(_,F,D)):(w=1,_=U(_,F,D),_=E(_,F));else if(o&&l&&!c&&d)w=1,_=U(_,F,D),_=E(_,F);else if(!o&&!c&&l^d){var X=A;l?(w=1,_=U(_,F,D),w=0,A=!1,_=U(_,F,D),A=X):(w=0,_=U(_,F,D),_=E(_,F),w=1,A=!1,_=U(_,F,D),A=X,_=E(_,F))}}else w=0,_=U(_,F,D);else w=l?1:0,_=U(_,F,D);return _},this.__bidiEngine__.setOptions=function(_){_&&(o=_.isInputVisual,c=_.isOutputVisual,l=_.isInputRtl,d=_.isOutputRtl,A=_.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(o=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?o.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):o.push([r.doBidiReorder(s[l])]);n.text=o}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(cr),cr.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new du(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new Soe(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new foe(this.contents),this.head=new poe(this),this.name=new boe(this),this.cmap=new YM(this),this.toUnicode={},this.hhea=new goe(this),this.maxp=new woe(this),this.hmtx=new Noe(this),this.post=new voe(this),this.os2=new xoe(this),this.loca=new Boe(this),this.glyf=new Coe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,d;for(d=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],d.push(Math.round(e*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var s,i,o,l;for(o=0,i=0,l=(e=""+e).length;0<=l?i<l:i>l;i=0<=l?++i:--i)s=e.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var Yl,du=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,s;for(s=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(e.charCodeAt(r)));return s},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,s,i,o,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*s+16777216*i+65536*o+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,s,i;for(i=[],n=0,s=e.length;n<s;n++)r=e[n],i.push(this.writeByte(r));return i},t}(),foe=function(){var t;function e(r){var n,s,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,s,i,o,l,c,d,A,u,f,h,m,p;for(p in h=Object.keys(r).length,c=Math.log(2),u=16*Math.floor(Math.log(h)/c),o=Math.floor(u/c),A=16*h-u,(s=new du).writeInt(this.scalarType),s.writeShort(h),s.writeShort(u),s.writeShort(o),s.writeShort(A),i=16*h,d=s.pos+i,l=null,m=[],r)for(f=r[p],s.writeString(p),s.writeInt(t(f)),s.writeInt(d),s.writeInt(f.length),m=m.concat(f),p==="head"&&(l=d),d+=f.length;d%4;)m.push(0),d++;return s.write(m),n=2981146554-t(s.data),s.pos=l+8,s.writeUInt32(n),s.data},t=function(r){var n,s,i,o;for(r=ZM.call(r);r.length%4;)r.push(0);for(i=new du(r),s=0,n=0,o=r.length;n<o;n=n+=4)s+=i.readUInt32();return 4294967295&s},e}(),moe={}.hasOwnProperty,Tc=function(t,e){for(var r in e)moe.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Yl=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var poe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tc(t,Yl),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new du).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t}(),WT=function(){function t(e,r){var n,s,i,o,l,c,d,A,u,f,h,m,p,g,x,b,w;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),u=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(h=e.readUInt16(),f=h/2,e.pos+=6,i=function(){var k,O;for(O=[],c=k=0;0<=f?k<f:k>f;c=0<=f?++k:--k)O.push(e.readUInt16());return O}(),e.pos+=2,p=function(){var k,O;for(O=[],c=k=0;0<=f?k<f:k>f;c=0<=f?++k:--k)O.push(e.readUInt16());return O}(),d=function(){var k,O;for(O=[],c=k=0;0<=f?k<f:k>f;c=0<=f?++k:--k)O.push(e.readUInt16());return O}(),A=function(){var k,O;for(O=[],c=k=0;0<=f?k<f:k>f;c=0<=f?++k:--k)O.push(e.readUInt16());return O}(),s=(this.length-e.pos+this.offset)/2,l=function(){var k,O;for(O=[],c=k=0;0<=s?k<s:k>s;c=0<=s?++k:--k)O.push(e.readUInt16());return O}(),c=x=0,w=i.length;x<w;c=++x)for(g=i[c],n=b=m=p[c];m<=g?b<=g:b>=g;n=m<=g?++b:--b)A[c]===0?o=n+d[c]:(o=l[A[c]/2+(n-m)-(f-c)]||0)!==0&&(o+=d[c]),this.codeMap[n]=65535&o}e.pos=u}return t.encode=function(e,r){var n,s,i,o,l,c,d,A,u,f,h,m,p,g,x,b,w,k,O,L,E,B,S,U,_,F,D,X,ge,ae,fe,me,Z,ye,Ie,I,j,Q,T,R,K,M,re,de,le,q;switch(X=new du,o=Object.keys(e).sort(function(Se,ee){return Se-ee}),r){case"macroman":for(p=0,g=function(){var Se=[];for(m=0;m<256;++m)Se.push(0);return Se}(),b={0:0},i={},ge=0,Z=o.length;ge<Z;ge++)b[re=e[s=o[ge]]]==null&&(b[re]=++p),i[s]={old:e[s],new:b[e[s]]},g[s]=b[e[s]];return X.writeUInt16(1),X.writeUInt16(0),X.writeUInt32(12),X.writeUInt16(0),X.writeUInt16(262),X.writeUInt16(0),X.write(g),{charMap:i,subtable:X.data,maxGlyphID:p+1};case"unicode":for(F=[],u=[],w=0,b={},n={},x=d=null,ae=0,ye=o.length;ae<ye;ae++)b[O=e[s=o[ae]]]==null&&(b[O]=++w),n[s]={old:O,new:b[O]},l=b[O]-s,x!=null&&l===d||(x&&u.push(x),F.push(s),d=l),x=s;for(x&&u.push(x),u.push(65535),F.push(65535),U=2*(S=F.length),B=2*Math.pow(Math.log(S)/Math.LN2,2),f=Math.log(B/2)/Math.LN2,E=2*S-B,c=[],L=[],h=[],m=fe=0,Ie=F.length;fe<Ie;m=++fe){if(_=F[m],A=u[m],_===65535){c.push(0),L.push(0);break}if(_-(D=n[_].new)>=32768)for(c.push(0),L.push(2*(h.length+S-m)),s=me=_;_<=A?me<=A:me>=A;s=_<=A?++me:--me)h.push(n[s].new);else c.push(D-_),L.push(0)}for(X.writeUInt16(3),X.writeUInt16(1),X.writeUInt32(12),X.writeUInt16(4),X.writeUInt16(16+8*S+2*h.length),X.writeUInt16(0),X.writeUInt16(U),X.writeUInt16(B),X.writeUInt16(f),X.writeUInt16(E),K=0,I=u.length;K<I;K++)s=u[K],X.writeUInt16(s);for(X.writeUInt16(0),M=0,j=F.length;M<j;M++)s=F[M],X.writeUInt16(s);for(de=0,Q=c.length;de<Q;de++)l=c[de],X.writeUInt16(l);for(le=0,T=L.length;le<T;le++)k=L[le],X.writeUInt16(k);for(q=0,R=h.length;q<R;q++)p=h[q],X.writeUInt16(p);return{charMap:n,subtable:X.data,maxGlyphID:w+1}}},t}(),YM=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tc(t,Yl),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)r=new WT(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,s;return r==null&&(r="macroman"),n=WT.encode(e,r),(s=new du).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},t}(),goe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tc(t,Yl),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),xoe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tc(t,Yl),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),voe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tc(t,Yl),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(n=e.readUInt16(),this.glyphNameIndex=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)r=e.readByte(),s.push(this.names.push(e.readString(r)));return s;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],i=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;i=0<=l?++o:--o)c.push(e.readUInt32());return c}).call(this)}},t}(),yoe=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},boe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tc(t,Yl),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,s,i,o,l,c,d,A,u,f;for(e.pos=this.offset,e.readShort(),r=e.readShort(),l=e.readShort(),n=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(c={},i=A=0,u=n.length;A<u;i=++A)s=n[i],e.pos=s.offset,d=e.readString(s.length),o=new yoe(d,s),c[f=s.nameID]==null&&(c[f]=[]),c[s.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),woe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tc(t,Yl),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),Noe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tc(t,Yl),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,s,i,o,l,c;for(e.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,A;for(A=[],r=d=0;0<=s?d<s:d>s;r=0<=s?++d:--d)A.push(e.readInt16());return A}(),this.widths=(function(){var d,A,u,f;for(f=[],d=0,A=(u=this.metrics).length;d<A;d++)i=u[d],f.push(i.advance);return f}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=s?o<s:o>s;r=0<=s?++o:--o)c.push(this.widths.push(n));return c},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),ZM=[].slice,Coe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tc(t,Yl),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,s,i,o,l,c,d,A,u;return e in this.cache?this.cache[e]:(i=this.file.loca,r=this.file.contents,n=i.indexOf(e),(s=i.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,o=(l=new du(r.read(s))).readShort(),d=l.readShort(),u=l.readShort(),c=l.readShort(),A=l.readShort(),this.cache[e]=o===-1?new Eoe(l,d,u,c,A):new _oe(l,o,d,u,c,A),this.cache[e]))},t.prototype.encode=function(e,r,n){var s,i,o,l,c;for(o=[],i=[],l=0,c=r.length;l<c;l++)s=e[r[l]],i.push(o.length),s&&(o=o.concat(s.encode(n)));return i.push(o.length),{table:o,offsets:i}},t}(),_oe=function(){function t(e,r,n,s,i,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=i,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),Eoe=function(){function t(e,r,n,s,i){var o,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new du(ZM.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),Boe=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return Tc(t,Yl),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,i;for(i=[],n=0,s=this.length;n<s;n+=2)i.push(2*e.readUInt16());return i}).call(this):(function(){var s,i;for(i=[],n=0,s=this.length;n<s;n+=4)i.push(e.readUInt32());return i}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),s=0,i=0,o=0;o<n.length;++o)if(n[o]=s,i<r.length&&r[i]==o){++i,n[o]=s;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(s+=c)}for(var d=new Array(4*n.length),A=0;A<n.length;++A)d[4*A+3]=255&n[A],d[4*A+2]=(65280&n[A])>>8,d[4*A+1]=(16711680&n[A])>>16,d[4*A]=(4278190080&n[A])>>24;return d},t}(),Soe=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,s,i;for(r in s=this.font.cmap.tables[0].codeMap,e={},i=this.subset)n=i[r],e[r]=s[n];return e},t.prototype.glyphsFor=function(e){var r,n,s,i,o,l,c;for(s={},o=0,l=e.length;o<l;o++)s[i=e[o]]=this.font.glyf.glyphFor(i);for(i in r=[],s)(n=s[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))n=c[i],s[i]=n;return s},t.prototype.encode=function(e,r){var n,s,i,o,l,c,d,A,u,f,h,m,p,g,x;for(s in n=YM.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),h={0:0},x=n.charMap)h[(c=x[s]).old]=c.new;for(m in f=n.maxGlyphID,o)m in h||(h[m]=f++);return A=function(b){var w,k;for(w in k={},b)k[b[w]]=w;return k}(h),u=Object.keys(A).sort(function(b,w){return b-w}),p=function(){var b,w,k;for(k=[],b=0,w=u.length;b<w;b++)l=u[b],k.push(A[l]);return k}(),i=this.font.glyf.encode(o,p,h),d=this.font.loca.encode(i.offsets,p),g={cmap:this.font.cmap.raw(),glyf:i.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(g["OS/2"]=this.font.os2.raw()),this.font.directory.encode(g)},t}();cr.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,s,i,o;if(Array.isArray(r))return"["+function(){var l,c,d;for(d=[],l=0,c=r.length;l<c;l++)n=r[l],d.push(e.convert(n));return d}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in i=["<<"],r)o=r[s],i.push("/"+s+" "+e.convert(o));return i.push(">>"),i.join(`
`)}return""+r},e}();const SE=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:aoe,AcroFormAppearance:ur,AcroFormButton:ua,AcroFormCheckBox:rg,AcroFormChoiceField:hh,AcroFormComboBox:mh,AcroFormEditBox:eg,AcroFormListBox:fh,AcroFormPasswordField:ng,AcroFormPushButton:tg,AcroFormRadioButton:ph,AcroFormTextField:eu,GState:Zg,ShadingPattern:IA,TilingPattern:ih,default:cr,jsPDF:cr},Symbol.toStringTag,{value:"Module"}));async function JT(t){const e={...t,remaining:t.quantity,status:"PENDIENTE",createdAt:$t.now()};return Jr(ht(Te,"inventory_batches"),e)}async function e8(t,e){await Pr(kt(Te,"inventory_batches",t),{status:"PAGADO",paidAmount:null,paidAt:$t.now()})}async function Ioe(t,e){const r=Dt(ht(Te,"batch_allocations"),Gt("saleDate",">=",t),Gt("saleDate","<=",e)),n=await Nt(r),s={};return n.forEach(i=>{const o=i.data(),l=o.batchId;s[l]||(s[l]={batchId:o.batchId,batchDate:o.batchDate,productName:o.productName,quantity:0,amountCharged:0}),s[l].quantity+=Number(o.quantity||0),s[l].amountCharged+=Number(o.amountCharged||0)}),Object.values(s)}async function joe(t){const e=kt(Te,"salesV2",t),r=await Ya(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),s=[];if(Array.isArray(n.items)){for(const l of n.items)if(Array.isArray(l==null?void 0:l.allocations))for(const c of l.allocations){const d=String((c==null?void 0:c.batchId)||"").trim(),A=Number((c==null?void 0:c.qty)||0);d&&A&&s.push({batchId:d,qty:A})}}if(Array.isArray(n.allocations))for(const l of n.allocations){const c=String((l==null?void 0:l.batchId)||"").trim(),d=Number((l==null?void 0:l.qty)||0);c&&d&&s.push({batchId:c,qty:d})}if(s.length===0)return await pa(Te,async l=>{l.delete(e)}),{restored:0};const i=new Map;for(const l of s)i.set(l.batchId,Number((i.get(l.batchId)||0)+l.qty));let o=0;return await pa(Te,async l=>{const c=Array.from(i.entries()),d=c.map(([u])=>kt(Te,"inventory_batches",u)),A=await Promise.all(d.map(u=>l.get(u)));c.forEach(([u,f],h)=>{const m=A[h];if(!m.exists())return;const p=m.data(),g=Number((p==null?void 0:p.remaining)??0),x=Number((g+Number(f||0)).toFixed(3));l.update(d[h],{remaining:x}),o+=Number(f||0)}),l.delete(e)}),{restored:o}}function vl(){const[t,e]=N.useState(0),r=N.useCallback(()=>e(n=>n+1),[]);return{refreshKey:t,refresh:r}}const Yo=t=>Math.round((Number(t)||0)*100)/100,x1=t=>Math.round((Number(t)||0)*1e3)/1e3,np=t=>Number(t??0).toFixed(2),$N=t=>Number(t??0).toFixed(3),XT=(t,e)=>{var n;const r=t.date??((n=t.timestamp)!=null&&n.toDate?or(t.timestamp.toDate(),"yyyy-MM-dd"):"");return r?Array.isArray(t.items)&&t.items.length>0?t.items.map((s,i)=>{const o=Number((s==null?void 0:s.qty)??0),l=Number((s==null?void 0:s.lineFinal)??0)||Math.max(0,Number((s==null?void 0:s.unitPrice)||0)*o-Number((s==null?void 0:s.discount)||0));return{id:`${e}#${i}`,productName:String((s==null?void 0:s.productName)??"(sin nombre)"),quantity:o,amount:Yo(l),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:Array.isArray(s==null?void 0:s.allocations)?s.allocations:t.allocations,avgUnitCost:Number((s==null?void 0:s.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((s==null?void 0:s.cogsAmount)??0)}}):[{id:e,productName:t.productName??"(sin nombre)",quantity:Number(t.quantity??0),amount:Number(t.amount??t.amountCharged??0),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:t.userEmail??t.vendor??"(sin usuario)",clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount}]:[]};function koe({role:t}){const[e,r]=N.useState([]),[n,s]=N.useState([]),[i,o]=N.useState(null),[l,c]=N.useState(!0),[d,A]=N.useState(""),[u,f]=N.useState("ALL"),[h,m]=N.useState(null),[p,g]=N.useState(0),[x,b]=N.useState(0),[w,k]=N.useState(""),[O,L]=N.useState(0),[E,B]=N.useState("0"),S=or(new Date,"yyyy-MM-dd"),U=N.useRef(null),{refreshKey:_}=vl();N.useEffect(()=>{const R=Dt(ht(Te,"salesV2"),Gt("date","==",S)),K=H0(R,M=>{const re=[];M.forEach(de=>{const le=XT(de.data(),de.id);re.push(...le)}),r(re),c(!1)});return()=>K()},[S,_]),N.useEffect(()=>{const R=Dt(ht(Te,"salesV2"),Gt("status","==","FLOTANTE")),K=H0(R,M=>{const re=[];M.forEach(de=>{const le=XT(de.data(),de.id);re.push(...le)}),s(re)});return()=>K()},[_]),N.useEffect(()=>{(async()=>{const K=Dt(ht(Te,"daily_closures"),Gt("date","==",S)),M=await Nt(K);if(M.empty)o(null);else{const re=M.docs[0];o({id:re.id,...re.data()})}})()},[S,_]);const F=ui.useMemo(()=>{if(u==="FLOTANTE"){const R=[...e,...n],K=new Map;for(const M of R)M.status==="FLOTANTE"&&K.set(M.id,M);return Array.from(K.values())}if(u==="ALL"){const R=[...e,...n],K=new Map;for(const M of R)K.set(M.id,M);return Array.from(K.values())}return e.filter(R=>R.status==="PROCESADA")},[u,e,n]);Yo(F.reduce((R,K)=>R+(K.amountSuggested||0),0));const D=Yo(F.reduce((R,K)=>R+(K.amount||0),0)),X=x1(F.reduce((R,K)=>R+(K.quantity||0),0)),ge=Yo(F.reduce((R,K)=>R+Number(K.cogsAmount??0),0)),ae=Yo(D-ge),fe={};F.forEach(R=>{const K=R.productName||"(sin nombre)";fe[K]||(fe[K]={totalQuantity:0,totalAmount:0}),fe[K].totalQuantity=x1(fe[K].totalQuantity+(R.quantity||0)),fe[K].totalAmount=Yo(fe[K].totalAmount+(R.amount||0))});const me=Object.entries(fe).map(([R,K])=>({productName:R,totalQuantity:K.totalQuantity,totalAmount:K.totalAmount})),Z=async()=>{try{const R=F.filter(Se=>Se.status==="FLOTANTE"),K=R.length>0?R:e.filter(Se=>Se.status!=="PROCESADA");if(K.length===0){A("No hay ventas para procesar.");return}const M={totalCharged:Yo(K.reduce((Se,ee)=>Se+(ee.amount||0),0)),totalSuggested:Yo(K.reduce((Se,ee)=>Se+(ee.amountSuggested||0),0)),totalUnits:x1(K.reduce((Se,ee)=>Se+(ee.quantity||0),0)),totalCOGS:Yo(K.reduce((Se,ee)=>Se+Number(ee.cogsAmount??0),0))},re=Yo(M.totalCharged-M.totalSuggested),de=Yo(M.totalCharged-M.totalCOGS),le=await Jr(ht(Te,"daily_closures"),{date:S,createdAt:$t.now(),totalCharged:M.totalCharged,totalSuggested:M.totalSuggested,totalDifference:re,totalUnits:M.totalUnits,totalCOGS:M.totalCOGS,grossProfit:de,products:K.map(Se=>({productName:Se.productName,quantity:Se.quantity,amount:Se.amount})),salesV2:K.map(Se=>({id:Se.id,productName:Se.productName,quantity:Se.quantity,amount:Se.amount,amountSuggested:Se.amountSuggested,userEmail:Se.userEmail,clientName:Se.clientName,amountReceived:Se.amountReceived,change:Se.change,status:Se.status,cogsAmount:Se.cogsAmount??0,avgUnitCost:Se.avgUnitCost??null,allocations:Se.allocations??[],date:Se.date})),productSummary:Object.entries(K.reduce((Se,ee)=>{const z=ee.productName||"(sin nombre)";return Se[z]||(Se[z]={totalQuantity:0,totalAmount:0}),Se[z].totalQuantity=x1(Se[z].totalQuantity+(ee.quantity||0)),Se[z].totalAmount=Yo(Se[z].totalAmount+(ee.amount||0)),Se},{})).map(([Se,ee])=>({productName:Se,totalQuantity:ee.totalQuantity,totalAmount:ee.totalAmount}))}),q=Xh(Te);K.forEach(Se=>{q.update(kt(Te,"salesV2",Se.id.split("#")[0]),{status:"PROCESADA",closureId:le.id,closureDate:S})}),await q.commit(),A(` Cierre guardado. Ventas procesadas: ${K.length}.`)}catch(R){console.error(R),A(" Error al guardar el cierre.")}},ye=async R=>{if(window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await Pr(kt(Te,"salesV2",R.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null}),A(" Venta revertida a FLOTANTE.")}catch(K){console.error(K),A(" No se pudo revertir la venta.")}},Ie=R=>{m(R),g(R.quantity),b(R.amount),k(R.clientName),L(R.amountReceived),B(R.change)},I=async()=>{if(h)try{await Pr(kt(Te,"salesV2",h.id.split("#")[0]),{quantity:p,amount:x,amountCharged:x,clientName:w,amountReceived:O,change:E}),m(null),A(" Venta actualizada.")}catch(R){console.error(R),A(" No se pudo actualizar la venta.")}},j=async R=>{if(window.confirm("Eliminar esta venta? Se restaurar el stock en los lotes asignados."))try{const{restored:K}=await joe(R.split("#")[0]);A(` Venta eliminada. Stock restaurado: ${Number(K).toFixed(2)}.`)}catch(K){console.error(K),A(" No se pudo eliminar la venta.")}},Q=async()=>{if(U.current){U.current.classList.add("force-pdf-colors");try{const K=(await Yh(U.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),M=new cr;M.addImage(K,"PNG",10,10,190,0),M.save(`cierre_${S}.pdf`)}finally{U.current.classList.remove("force-pdf-colors")}}},T=!t||t==="admin";return a.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[a.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Cierre de Ventas - ",S]}),a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx("label",{className:"text-sm",children:"Filtrar:"}),a.jsxs("select",{className:"border rounded px-2 py-1",value:u,onChange:R=>f(R.target.value),children:[a.jsx("option",{value:"ALL",children:"Todas"}),a.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),a.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),l?a.jsx("p",{children:"Cargando ventas..."}):a.jsxs("div",{ref:U,children:[a.jsxs("table",{className:"min-w-full border text-sm mb-4  shadow-2xl",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Estado"}),a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Libras - Unidad"}),a.jsx("th",{className:"border p-2",children:"Monto"}),a.jsx("th",{className:"border p-2",children:"Fecha venta"}),a.jsx("th",{className:"border p-2",children:"Vendedor"}),a.jsx("th",{className:"border p-2",children:"Acciones"})]})}),a.jsxs("tbody",{children:[F.map(R=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${R.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:R.status})}),a.jsx("td",{className:"border p-1",children:R.productName}),a.jsx("td",{className:"border p-1",children:$N(R.quantity)}),a.jsxs("td",{className:"border p-1",children:["C$",np(R.amount)]}),a.jsx("td",{className:"border p-1",children:R.date}),a.jsx("td",{className:"border p-1",children:R.userEmail}),a.jsx("td",{className:"border p-1",children:R.status==="FLOTANTE"?a.jsxs("div",{className:"flex gap-2 justify-center",children:[T&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>Ie(R),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),a.jsx("button",{onClick:()=>j(R.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}),!T&&a.jsx("span",{className:"text-gray-400 text-xs",children:""})]}):R.status==="PROCESADA"?a.jsx("div",{className:"flex gap-2 justify-center",children:T?a.jsx("button",{onClick:()=>ye(R.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):a.jsx("span",{className:"text-gray-400 text-xs",children:""})}):a.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},R.id)),F.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm mb-2",children:[a.jsxs("div",{children:[" ","Total Libras/Unidades: ",a.jsx("strong",{children:$N(X)})]}),a.jsxs("div",{children:[" ","Total cobrado: ",a.jsxs("strong",{children:["C$",np(D)]})]})]}),(ge>0||ae!==D)&&a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm mb-6",children:[a.jsxs("div",{children:[" ","Calculo a Precio compra:"," ",a.jsxs("strong",{children:["C$",np(ge)]})]}),a.jsxs("div",{children:[" ","Ganancia antes de gasto:"," ",a.jsxs("strong",{children:["C$",np(ae)]})]})]}),a.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),a.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),a.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),a.jsxs("tbody",{children:[me.map(R=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:R.productName}),a.jsx("td",{className:"border p-1",children:$N(R.totalQuantity)}),a.jsxs("td",{className:"border p-1",children:["C$",np(R.totalAmount)]})]},R.productName)),me.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:Z,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del da"}),a.jsx("button",{onClick:Q,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),d&&a.jsx("p",{className:"mt-2 text-sm",children:d}),h&&a.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[a.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta"}),a.jsxs("div",{className:"text-sm text-gray-500",children:[h.productName,"  ",h.userEmail]}),a.jsx("label",{className:"text-sm",children:"Cantidad"}),a.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:p,onChange:R=>g(parseFloat(R.target.value||"0"))}),a.jsx("label",{className:"text-sm",children:"Monto cobrado"}),a.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:x,onChange:R=>b(parseFloat(R.target.value||"0"))}),a.jsx("label",{className:"text-sm",children:"Cliente"}),a.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:w,onChange:R=>k(R.target.value)}),a.jsx("label",{className:"text-sm",children:"Paga con"}),a.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:O,onChange:R=>L(parseFloat(R.target.value||"0"))}),a.jsx("label",{className:"text-sm",children:"Vuelto"}),a.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:E,onChange:R=>B(R.target.value)}),a.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[a.jsx("button",{onClick:()=>m(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),a.jsx("button",{onClick:I,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const Wo=t=>Number(t??0).toFixed(2),Ff=t=>Number(t??0).toFixed(3);function Foe(){var b,w,k,O;const t=async L=>{if(!window.confirm(`Eliminar el cierre del ${L.date}?`))return;const E=window.confirm("Tambin quieres reabrir (revertir a FLOTANTE) las ventas vinculadas a este cierre?");try{if(E){const B=await Nt(Dt(ht(Te,"salesV2"),Gt("closureId","==",L.id)));if(!B.empty){const S=Xh(Te);B.forEach(U=>{S.update(kt(Te,"salesV2",U.id),{status:"FLOTANTE",closureId:null,closureDate:null})}),await S.commit()}}await un(kt(Te,"daily_closures",L.id)),(d==null?void 0:d.id)===L.id&&A(null),await m(),f(` Cierre eliminado${E?" y ventas reabiertas.":"."}`)}catch(B){console.error(B),f(" No se pudo eliminar el cierre.")}},[e,r]=N.useState(or(aO(new Date),"yyyy-MM-dd")),[n,s]=N.useState(or(new Date,"yyyy-MM-dd")),[i,o]=N.useState(!0),[l,c]=N.useState([]),[d,A]=N.useState(null),[u,f]=N.useState(""),h=N.useRef(null),m=async()=>{try{o(!0);const L=Dt(ht(Te,"daily_closures"),Gt("date",">=",e),Gt("date","<=",n)),E=await Nt(L),B=[];E.forEach(S=>B.push({id:S.id,...S.data()})),B.sort((S,U)=>S.date<U.date?1:S.date>U.date?-1:0),c(B)}catch(L){console.error(L),f(" Error cargando el historial.")}finally{o(!1)}};N.useEffect(()=>{m()},[]);const p=async L=>{L.preventDefault(),m()},g=N.useMemo(()=>{if(!d)return{units:0,sug:0,chg:0,diff:0,cogs:0,profit:0};const L=Number(d.totalUnits??0),E=Number(d.totalSuggested??0),B=Number(d.totalCharged??0),S=Number(d.totalDifference??(isFinite(B-E)?B-E:0)),U=Number(d.totalCOGS??0),_=Number(d.grossProfit??(isFinite(B-U)?B-U:0));return{units:L,sug:E,chg:B,diff:S,cogs:U,profit:_}},[d]),x=async()=>{if(!h.current||!d)return;const L=h.current;L.classList.add("force-pdf-colors");try{const[{default:E},{jsPDF:B}]=await Promise.all([xd(()=>Promise.resolve().then(()=>ZS),void 0),xd(()=>Promise.resolve().then(()=>SE),void 0)]),U=(await E(L,{backgroundColor:"#ffffff",onclone:D=>{const X=D.defaultView;D.body.querySelectorAll("*").forEach(ae=>{const fe=X.getComputedStyle(ae);fe.color&&(ae.style.color=fe.color),fe.backgroundColor&&fe.backgroundColor!=="rgba(0, 0, 0, 0)"&&(ae.style.backgroundColor=fe.backgroundColor),fe.borderColor&&(ae.style.borderColor=fe.borderColor)})}})).toDataURL("image/png"),{jsPDF:_}=await xd(async()=>{const{jsPDF:D}=await Promise.resolve().then(()=>SE);return{jsPDF:D}},void 0),F=new _;F.addImage(U,"PNG",10,10,190,0),F.save(`cierre_${d.date}.pdf`)}finally{L.classList.remove("force-pdf-colors")}};return a.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Histrico de cierres"}),a.jsxs("form",{onSubmit:p,className:"flex flex-wrap items-end gap-3 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:e,onChange:L=>r(L.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:n,onChange:L=>s(L.target.value)})]}),a.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),i?a.jsx("p",{children:"Cargando..."}):l.length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):a.jsxs("table",{className:"min-w-full text-sm mb-6  shadow-lg p-4 bg-white border-gray-100",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Fecha"}),a.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),a.jsx("th",{className:"border p-2",children:"Monto de venta"}),a.jsx("th",{className:"border p-2",children:"Monto al costo"}),a.jsx("th",{className:"border p-2",children:"Ganancia sin gastos"}),a.jsx("th",{className:"border p-2",children:"Acciones"})]})}),a.jsx("tbody",{children:l.map(L=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:L.date}),a.jsx("td",{className:"border p-1",children:Ff(L.totalUnits)}),a.jsxs("td",{className:"border p-1",children:["C$",Wo(L.totalCharged)]}),a.jsxs("td",{className:"border p-1",children:["C$",Wo(L.totalCOGS)]}),a.jsxs("td",{className:"border p-1",children:["C$",Wo(L.grossProfit??Number(L.totalCharged??0)-Number(L.totalCOGS??0))]}),a.jsx("td",{className:"border p-1",children:a.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[a.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>A(L),children:"Ver detalle"}),a.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>t(L),children:"Eliminar"})]})})]},L.id))})]}),d&&a.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[a.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",d.date]}),a.jsx("button",{onClick:()=>A(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),a.jsx("button",{onClick:x,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),a.jsxs("div",{ref:h,className:"space-y-4",children:[a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:a.jsxs("div",{children:["Total Libras/Unidades: ",a.jsx("strong",{children:Ff(g.units)})]})}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:[a.jsxs("div",{children:["Monto al costo:"," ",a.jsxs("strong",{children:["C$",Wo(g.cogs)]})]}),a.jsxs("div",{children:["Ganancia sin gastos:"," ",a.jsxs("strong",{children:["C$",Wo(g.profit)]})]})]}),(b=d.salesV2)!=null&&b.length?a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),a.jsxs("table",{className:"min-w-full border text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Cantidad"}),a.jsx("th",{className:"border p-2",children:"Monto de ventas"}),a.jsx("th",{className:"border p-2",children:"Monto al costo"}),a.jsx("th",{className:"border p-2",children:"Fecha venta"}),a.jsx("th",{className:"border p-2",children:"Vendedor"})]})}),a.jsx("tbody",{children:d.salesV2.map((L,E)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:L.productName??"(sin nombre)"}),a.jsx("td",{className:"border p-1",children:Ff(L.quantity)}),a.jsxs("td",{className:"border p-1",children:["C$",Wo(L.amount)]}),a.jsxs("td",{className:"border p-1",children:["C$",Wo(L.cogsAmount)]}),a.jsx("td",{className:"border p-1",children:L.date??""}),a.jsx("td",{className:"border p-1",children:L.userEmail??""})]},E))})]})]}):(w=d.sales)!=null&&w.length?a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),a.jsxs("table",{className:"min-w-full border text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Cantidad"}),a.jsx("th",{className:"border p-2",children:"Monto"}),a.jsx("th",{className:"border p-2",children:"Vendedor"}),a.jsx("th",{className:"border p-2",children:"Cliente"}),a.jsx("th",{className:"border p-2",children:"Paga con"}),a.jsx("th",{className:"border p-2",children:"Vuelto"})]})}),a.jsx("tbody",{children:d.sales.map((L,E)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:L.productName??"(sin nombre)"}),a.jsx("td",{className:"border p-1",children:Ff(L.quantity)}),a.jsxs("td",{className:"border p-1",children:["C$",Wo(L.amount)]}),a.jsx("td",{className:"border p-1",children:L.userEmail??""}),a.jsx("td",{className:"border p-1",children:L.clientName??""}),a.jsxs("td",{className:"border p-1",children:["C$",Wo(L.amountReceived)]}),a.jsx("td",{className:"border p-1",children:typeof L.change=="number"?Wo(L.change):L.change??"0"})]},E))})]})]}):(k=d.products)!=null&&k.length?a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"font-semibold",children:"Productos en el cierre"}),a.jsxs("table",{className:"min-w-full border text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Cantidad"}),a.jsx("th",{className:"border p-2",children:"Monto"})]})}),a.jsx("tbody",{children:d.products.map((L,E)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:L.productName}),a.jsx("td",{className:"border p-1",children:Ff(L.quantity)}),a.jsxs("td",{className:"border p-1",children:["C$",Wo(L.amount)]})]},E))})]})]}):a.jsx("p",{className:"text-sm text-gray-500",children:"Sin detalle de ventas en este cierre."}),(O=d.productSummary)!=null&&O.length?a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),a.jsxs("table",{className:"min-w-full border text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),a.jsx("th",{className:"border p-2",children:"Total dinero"})]})}),a.jsx("tbody",{children:d.productSummary.map((L,E)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:L.productName}),a.jsx("td",{className:"border p-1",children:Ff(L.totalQuantity)}),a.jsxs("td",{className:"border p-1",children:["C$",Wo(L.totalAmount)]})]},E))})]})]}):null]})]}),u&&a.jsx("p",{className:"mt-3 text-sm",children:u})]})}function Toe(){const[t,e]=N.useState(""),[r,n]=N.useState(""),[s,i]=N.useState(""),[o,l]=N.useState(!1),[c,d]=N.useState("vendedor_pollo"),[A,u]=N.useState(""),[f,h]=N.useState(""),[m,p]=N.useState([]),[g,x]=N.useState(!0),[b,w]=N.useState(null),[k,O]=N.useState("vendedor_pollo"),[L,E]=N.useState(""),[B,S]=N.useState(!1),[U,_]=N.useState([]),F=j=>!j||j==="vendedor"?"vendedor_pollo":j==="admin"||j==="vendedor_pollo"||j==="vendedor_ropa"||j==="vendedor_dulces"?j:"vendedor_pollo",D=async()=>{x(!0);const j=await Nt(ht(Te,"users")),Q=[];j.forEach(T=>{const R=T.data();Q.push({id:T.id,email:R.email??"",name:R.name??"",role:F(R.role),sellerCandyId:R.sellerCandyId??""})}),p(Q),x(!1)},X=async()=>{try{const j=await Nt(ht(Te,"sellers_candies")),Q=[];j.forEach(T=>{const R=T.data();Q.push({id:T.id,name:R.name??"(sin nombre)",branchLabel:R.branch??"",commissionPercent:Number(R.commissionPercent??0)})}),_(Q)}catch(j){console.error("Error cargando sellers_candies:",j)}};N.useEffect(()=>{D(),X()},[]);const ge=()=>{e(""),n(""),i(""),d("vendedor_pollo"),h("")},ae=async j=>{if(j.preventDefault(),u(""),s.length<4){u(" La contrasea debe tener al menos 4 caracteres.");return}if(!t.trim()){u(" El nombre es obligatorio.");return}try{const Q=$B(),T=GB(Q.options,"Secondary"),R=YL(T),K=await w$(R,r,s),M=F(c),re=M==="vendedor_dulces"&&f||"";await JU(kt(ht(Te,"users"),K.user.uid),{email:r,name:t.trim(),role:M,sellerCandyId:re}),await tS(R),await gG(T),p(de=>[{id:K.user.uid,email:r,name:t.trim(),role:M,sellerCandyId:re},...de]),u(" Usuario creado correctamente."),ge(),S(!1)}catch(Q){console.error(Q),u(" Error al crear el usuario: "+Q.message)}},fe=j=>{w(j.id),O(F(j.role)),E(j.sellerCandyId||"")},me=()=>{w(null),O("vendedor_pollo"),E("")},Z=async()=>{if(!b)return;const j=kt(Te,"users",b),Q=F(k),T=Q==="vendedor_dulces"&&L||"";await Pr(j,{role:Q,sellerCandyId:T}),p(R=>R.map(K=>K.id===b?{...K,role:Q,sellerCandyId:T}:K)),me()},ye=async j=>{confirm("Eliminar este usuario del listado?")&&(await un(kt(Te,"users",j)),p(T=>T.filter(R=>R.id!==j)))},Ie=j=>{const Q=j==="admin"?"admin":j==="vendedor_ropa"?"vendedor_ropa":j==="vendedor_dulces"?"vendedor_dulces":"vendedor_pollo",T=Q==="admin"?"bg-blue-100 text-blue-700":Q==="vendedor_ropa"?"bg-indigo-100 text-indigo-700":Q==="vendedor_dulces"?"bg-pink-100 text-pink-700":"bg-green-100 text-green-700";return a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${T}`,children:Q})},I=j=>`${j.name}  ${j.branchLabel||"Sin sucursal"}  ${j.commissionPercent.toFixed(2)}%`;return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Usuarios"}),a.jsx("button",{className:"px-3 py-2 rounded bg-purple-600 text-white hover:bg-purple-700",onClick:()=>S(!0),type:"button",children:"Crear usuario"})]}),a.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Nombre"}),a.jsx("th",{className:"p-2 border",children:"Email"}),a.jsx("th",{className:"p-2 border",children:"Rol"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:g?a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Cargando"})}):m.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"p-4 text-center",children:"Sin usuarios"})}):m.map(j=>{const Q=b===j.id,T=(Q?k:j.role)==="vendedor_dulces";return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:j.name||""}),a.jsx("td",{className:"p-2 border",children:j.email}),a.jsx("td",{className:"p-2 border",children:Q?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("select",{className:"w-full border p-1 rounded",value:k,onChange:R=>O(R.target.value),children:[a.jsx("option",{value:"admin",children:"Admin"}),a.jsx("option",{value:"vendedor_pollo",children:"Vendedor Pollo"}),a.jsx("option",{value:"vendedor_ropa",children:"Vendedor Ropa"}),a.jsx("option",{value:"vendedor_dulces",children:"Vendedor Dulces"})]}),k==="vendedor_dulces"&&a.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:L,onChange:R=>E(R.target.value),children:[a.jsx("option",{value:"",children:"Selecciona vendedor de dulces"}),U.map(R=>a.jsx("option",{value:R.id,children:I(R)},R.id))]})]}):a.jsxs(a.Fragment,{children:[Ie(j.role),T&&j.sellerCandyId&&a.jsx("div",{className:"mt-1 text-[11px] text-gray-500",children:"Vendedor asignado"})]})}),a.jsx("td",{className:"p-2 border space-x-2",children:Q?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Z,children:"Guardar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:me,children:"Cancelar"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>fe(j),children:"Editar"}),a.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>ye(j.id),children:"Eliminar"})]})})]},j.id)})})]})}),A&&a.jsx("p",{className:"text-sm mt-2",children:A}),B&&a.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>S(!1)}),a.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-lg max-h-[92vh] overflow-auto p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-lg font-bold",children:"Registrar nuevo usuario"}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>S(!1),type:"button",children:"Cerrar"})]}),a.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre completo"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:t,onChange:j=>e(j.target.value),required:!0})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Correo electrnico"}),a.jsx("input",{type:"email",className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400",value:r,onChange:j=>n(j.target.value),required:!0})]}),a.jsxs("div",{className:"space-y-1 relative",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Contrasea (mnimo 6 caracteres)"}),a.jsx("input",{type:o?"text":"password",minLength:6,className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-purple-400 pr-10",value:s,onChange:j=>i(j.target.value),required:!0}),a.jsx("button",{type:"button",className:"absolute right-2 top-8 text-sm text-gray-600 hover:text-gray-800",onClick:()=>l(j=>!j),children:o?"":""})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Rol"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:c,onChange:j=>d(j.target.value),children:[a.jsx("option",{value:"admin",children:"Admin"}),a.jsx("option",{value:"vendedor_pollo",children:"Vendedor Pollo"}),a.jsx("option",{value:"vendedor_ropa",children:"Vendedor Ropa"}),a.jsx("option",{value:"vendedor_dulces",children:"Vendedor Dulces"})]})]}),c==="vendedor_dulces"&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Vendedor (dulces)"}),a.jsxs("select",{className:"w-full border p-2 rounded text-sm",value:f,onChange:j=>h(j.target.value),children:[a.jsx("option",{value:"",children:"Selecciona vendedor de dulces asignado"}),U.map(j=>a.jsx("option",{value:j.id,children:I(j)},j.id))]})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[a.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>S(!1),children:"Cancelar"}),a.jsx("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Crear usuario"})]})]}),A&&a.jsx("p",{className:"text-sm mt-2",children:A})]})]})]})}const Poe=t=>`C$${(Number(t)||0).toFixed(2)}`;function Roe(){const[t,e]=N.useState(""),[r,n]=N.useState(0),[s,i]=N.useState(""),[o,l]=N.useState(""),[c,d]=N.useState(""),[A,u]=N.useState([]),[f,h]=N.useState(!0),[m,p]=N.useState(!1),[g,x]=N.useState(null),[b,w]=N.useState(""),[k,O]=N.useState(""),[L,E]=N.useState(""),[B,S]=N.useState(0),[U,_]=N.useState(!1),F=async()=>{h(!0);const ye=await Nt(ht(Te,"products")),Ie=[];ye.forEach(I=>{const j=I.data();Ie.push({id:I.id,name:j.name??"",price:Number(j.price??0),category:j.category??"",measurement:j.measurement??"",active:j.active!==!1})}),u(Ie),h(!1)};N.useEffect(()=>{F()},[]);const D=async ye=>{if(ye.preventDefault(),i(""),!t||r<=0||!c){i(" Completa nombre, precio vlido y unidad de medida");return}try{const Ie={name:t,price:parseFloat(r.toFixed(2)),category:o,measurement:c,active:!0},I=await Jr(ht(Te,"products"),Ie);u(j=>[{id:I.id,...Ie},...j]),i(" Producto registrado con exito."),e(""),n(0),d(""),l(""),_(!1)}catch(Ie){i(" Error: "+Ie.message)}},X=ye=>{x(ye.id),w(ye.name),O(ye.category),E(ye.measurement),S(ye.price)},ge=()=>{x(null),w(""),O(""),E(""),S(0)},ae=async()=>{if(!g)return;const ye=kt(Te,"products",g);await Pr(ye,{name:b,category:k,measurement:L,price:parseFloat((B||0).toFixed(2))}),u(Ie=>Ie.map(I=>I.id===g?{...I,name:b,category:k,measurement:L,price:parseFloat((B||0).toFixed(2))}:I)),ge()},fe=async ye=>{const Ie=kt(Te,"products",ye.id),I=ye.active===!1;await Pr(Ie,{active:I}),u(j=>j.map(Q=>Q.id===ye.id?{...Q,active:I}:Q))},me=async ye=>{const Ie=Dt(ht(Te,"inventory_batches"),Gt("productId","==",ye),zU(1));if(!(await Nt(Ie)).empty){alert(`No se puede eliminar: hay lotes asociados a este producto.
Sugerencia: desactvalo para ocultarlo.`);return}confirm("Eliminar este producto definitivamente?")&&(await un(kt(Te,"products",ye)),u(Q=>Q.filter(T=>T.id!==ye)))},Z=m?A:A.filter(ye=>ye.active!==!1);return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Productos"}),a.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{i(""),_(!0)},children:[a.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]}),U&&a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>_(!1)}),a.jsxs("div",{className:"relative z-10 w-[95%] max-w-lg bg-white rounded-lg shadow-2xl border p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h3",{className:"text-lg font-bold text-green-700 flex items-center gap-2",children:[a.jsx("span",{className:"inline-block bg-green-100 text-green-700 rounded-full p-2",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Registrar producto"]}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>_(!1),children:"Cerrar"})]}),a.jsxs("form",{onSubmit:D,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Categora"}),a.jsxs("select",{value:o,onChange:ye=>l(ye.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[a.jsx("option",{value:"",children:"Selecciona"}),a.jsx("option",{value:"pollo",children:"Pollo"}),a.jsx("option",{value:"cerdo",children:"Cerdo"}),a.jsx("option",{value:"huevo",children:"Huevos"}),a.jsx("option",{value:"ropa",children:"Ropa"}),a.jsx("option",{value:"otros",children:"Otros"})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nombre del producto"}),a.jsx("input",{type:"text",className:"w-full border p-2 rounded",value:t,onChange:ye=>e(ye.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Tipo de unidad de medida"}),a.jsxs("select",{value:c,onChange:ye=>d(ye.target.value),className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-400",children:[a.jsx("option",{value:"",children:"Selecciona"}),a.jsx("option",{value:"lb",children:"Libra"}),a.jsx("option",{value:"kg",children:"Kilogramo"}),a.jsx("option",{value:"unidad",children:"Unidad"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm",children:"Precio por unidad (ej: 55.50)"}),a.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded",value:Number.isNaN(r)?"":r,onChange:ye=>n(parseFloat(ye.target.value)),onFocus:ye=>ye.target.value==="0"?n(NaN):null})]}),a.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",children:"Agregar producto"}),s&&a.jsx("p",{className:"text-sm mt-2",children:s})]})]})]}),a.jsxs("div",{className:"flex items-center justify-between mt-6 mb-2",children:[a.jsx("h3",{className:"text-lg font-semibold p-2",children:"Productos"}),a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:m,onChange:ye=>p(ye.target.checked)}),"Mostrar inactivos"]})]}),a.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Nombre"}),a.jsx("th",{className:"p-2 border",children:"Categora"}),a.jsx("th",{className:"p-2 border",children:"Unidad"}),a.jsx("th",{className:"p-2 border",children:"Precio"}),a.jsx("th",{className:"p-2 border",children:"Estado"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:f?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):Z.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin productos"})}):Z.map(ye=>{const Ie=g===ye.id,I=ye.active!==!1;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:Ie?a.jsx("input",{className:"w-full border p-1 rounded",value:b,onChange:j=>w(j.target.value)}):ye.name}),a.jsx("td",{className:"p-2 border",children:Ie?a.jsxs("select",{className:"w-full border p-1 rounded",value:k,onChange:j=>O(j.target.value),children:[a.jsx("option",{value:"",children:"Selecciona"}),a.jsx("option",{value:"pollo",children:"Pollo"}),a.jsx("option",{value:"cerdo",children:"Cerdo"}),a.jsx("option",{value:"huevo",children:"Huevos"}),a.jsx("option",{value:"ropa",children:"Ropa"}),a.jsx("option",{value:"otros",children:"Otros"})]}):ye.category}),a.jsx("td",{className:"p-2 border",children:Ie?a.jsxs("select",{className:"w-full border p-1 rounded",value:L,onChange:j=>E(j.target.value),children:[a.jsx("option",{value:"",children:"Selecciona"}),a.jsx("option",{value:"lb",children:"Libra"}),a.jsx("option",{value:"kg",children:"Kilogramo"}),a.jsx("option",{value:"unidad",children:"Unidad"})]}):ye.measurement}),a.jsx("td",{className:"p-2 border",children:Ie?a.jsx("input",{type:"number",step:"0.01",className:"w-full border p-1 rounded text-right",value:Number.isNaN(B)?"":B,onChange:j=>S(parseFloat(j.target.value))}):Poe(ye.price)}),a.jsx("td",{className:"p-2 border",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${I?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`,children:I?"Activo":"Inactivo"})}),a.jsx("td",{className:"p-2 border space-x-2",children:Ie?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:ae,children:"Guardar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ge,children:"Cancelar"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>X(ye),children:"Editar"}),a.jsx("button",{className:`px-2 py-1 rounded ${I?"bg-gray-600 hover:bg-gray-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,onClick:()=>fe(ye),children:I?"Desactivar":"Activar"}),a.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>me(ye.id),children:"Eliminar"})]})})]},ye.id)})})]})})]})}const Oa=[];for(let t=0;t<256;++t)Oa.push((t+256).toString(16).slice(1));function Doe(t,e=0){return(Oa[t[e+0]]+Oa[t[e+1]]+Oa[t[e+2]]+Oa[t[e+3]]+"-"+Oa[t[e+4]]+Oa[t[e+5]]+"-"+Oa[t[e+6]]+Oa[t[e+7]]+"-"+Oa[t[e+8]]+Oa[t[e+9]]+"-"+Oa[t[e+10]]+Oa[t[e+11]]+Oa[t[e+12]]+Oa[t[e+13]]+Oa[t[e+14]]+Oa[t[e+15]]).toLowerCase()}let zN;const Loe=new Uint8Array(16);function Uoe(){if(!zN){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");zN=crypto.getRandomValues.bind(crypto)}return zN(Loe)}const Ooe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),YT={randomUUID:Ooe};function Moe(t,e,r){var s;if(YT.randomUUID&&!t)return YT.randomUUID();t=t||{};const n=t.random??((s=t.rng)==null?void 0:s.call(t))??Uoe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Doe(n)}async function Qoe(t,e,r,n=!1){if(r<=0)return{allocations:[],avgUnitCost:0,cogsAmount:0};const s=ht(t,"inventory_batches"),i=Dt(s,Gt("productName","==",e)),c=(await Nt(i)).docs.map(d=>({id:d.id,data:d.data()})).sort((d,A)=>{var p,g;const u=d.data.date??"",f=A.data.date??"";if(u!==f)return u<f?-1:1;const h=((p=d.data.createdAt)==null?void 0:p.seconds)??0,m=((g=A.data.createdAt)==null?void 0:g.seconds)??0;return h-m}).map(d=>kt(t,"inventory_batches",d.id));return pa(t,async d=>{let A=Number(r);const u=[],f=await Promise.all(c.map(g=>d.get(g)));for(let g=0;g<c.length&&A>0;g++){const x=c[g],b=f[g];if(!b.exists())continue;const w=b.data(),k=Number(w.quantity??0),O=Number(w.remaining??k??0),L=Number(w.purchasePrice??0);if(O<=0)continue;const E=Math.min(O,A),B=Number((O-E).toFixed(3));d.update(x,{remaining:B}),u.push({batchId:x.id,qty:E,unitCost:L,lineCost:Number((E*L).toFixed(2))}),A=Number((A-E).toFixed(3))}if(A>0&&!n)throw new Error(`Stock insuficiente para "${e}". Faltan ${A} unidades.`);const h=Number(u.reduce((g,x)=>g+x.lineCost,0).toFixed(2)),m=u.reduce((g,x)=>g+x.qty,0),p=m>0?Number((h/m).toFixed(4)):0;return{allocations:u,avgUnitCost:p,cogsAmount:h}})}const t8=3,Voe=.5*10**-t8;function ys(t){const e=Number(t??0);return Number(e.toFixed(t8))}function WN(t,e){return ys((t??0)+(e??0))}function v1(t,e){return ys(t)+Voe>=ys(e)}async function Hoe(t,e){const r=await Nt(ht(Te,"inventory_batches")),n=t.trim().toLowerCase();let s=0;for(const i of r.docs){const o=i.data();(o.productName||"").trim().toLowerCase()===n&&o.productId!==e&&(await Pr(kt(Te,"inventory_batches",i.id),{productId:e}),s++)}return s}function ZT({user:t}){const[e,r]=N.useState([]),[n,s]=N.useState([]),[i,o]=N.useState(""),[l,c]=N.useState(or(new Date,"yyyy-MM-dd")),[d,A]=N.useState(""),[u,f]=N.useState([]),[h,m]=N.useState(0),[p,g]=N.useState(0),[x,b]=N.useState("0"),[w,k]=N.useState(""),[O,L]=N.useState(!1),[E,B]=N.useState({}),S=T=>Math.round(T*100)/100,U=T=>ys(T).toFixed(3),_=T=>{const R=Number(T.specialPrice||0);return R>0?R:Number(T.price||0)},F=async T=>{if(!T)return 0;const R=Dt(ht(Te,"inventory_batches"),Gt("productId","==",T)),K=await Nt(R);let M=0;return K.forEach(re=>{const de=re.data();M=WN(M,Number(de.remaining||0))}),ys(M)},D=async T=>{if(!T)return 0;const R=await Nt(ht(Te,"inventory_batches"));let K=0;return R.forEach(M=>{const re=M.data();(re.productName||"").trim().toLowerCase()===T.trim().toLowerCase()&&(K=WN(K,Number(re.remaining||0)))}),ys(K)};N.useEffect(()=>{(async()=>{const T=await Nt(ht(Te,"products")),R=[];T.forEach(K=>{const M=K.data();(M==null?void 0:M.active)!==!1&&R.push({id:K.id,productName:M.name??M.productName??"(sin nombre)",price:Number(M.price??0),measurement:M.measurement??"(sin unidad)",category:M.category??"(sin categora)"})}),r(R)})()},[]),N.useEffect(()=>{(async()=>{const T=await Nt(ht(Te,"inventory_batches")),R={};T.forEach(K=>{const M=K.data(),re=M.productId,de=Number(M.remaining||0);re&&(R[re]=WN(R[re]||0,de))}),Object.keys(R).forEach(K=>R[K]=ys(R[K])),B(R)})()},[]),N.useEffect(()=>{(async()=>{const T=await Nt(ht(Te,"users")),R=[];T.forEach(K=>{const M=K.data();R.push({id:K.id,email:M.email??"(sin email)",role:M.role??"USER"})}),s(R)})()},[]);const X=async()=>{if(!i)return;const T=e.find(K=>K.id===i);if(!T)return;if(u.some(K=>K.productId===T.id)){o("");return}const R=await F(T.id);f(K=>[...K,{productId:T.id,productName:T.productName,measurement:T.measurement,price:Number(T.price||0),specialPrice:0,stock:R,qty:0,discount:0}]),o("")},ge=T=>{f(R=>R.filter(K=>K.productId!==T))},ae=async(T,R)=>{f(K=>K.map(M=>{if(M.productId!==T)return M;const re=(M.measurement||"").toLowerCase()!=="lb",de=R===""?0:Number(R),le=re?Math.max(0,Math.round(de)):ys(de);return{...M,qty:le}}))},fe=(T,R)=>{f(K=>K.map(M=>{if(M.productId!==T)return M;const re=(R||"").replace(",","."),de=re.trim()===""?0:Number(re),le=Number.isFinite(de)?Math.max(0,S(de)):0;return{...M,specialPrice:le}}))},me=(T,R)=>{f(K=>K.map(M=>{if(M.productId!==T)return M;const re=Math.max(0,Math.floor(Number(R||0)));return{...M,discount:re}}))},Z=N.useMemo(()=>{let T=0;for(const R of u){const K=_(R),M=Number(K||0)*Number(R.qty||0),re=Math.max(0,M-Math.max(0,Number(R.discount||0)));T+=re}return S(T)},[u]);N.useEffect(()=>{m(Z)},[Z]),N.useEffect(()=>{const T=Number(p)||0,R=Number(h)||0;b((T-R).toFixed(2))},[p,h]);const ye=T=>{T.key===","&&(T.preventDefault(),T.target.value+=".")},Ie=async()=>{if(u.length===0)return"Agrega al menos un producto.";for(const T of u){if(!T.qty||T.qty<=0)return`Cantidad invlida para "${T.productName}".`;const R=await F(T.productId);if(!v1(R,T.qty)){const K=await D(T.productName);if(v1(K,0)&&!v1(R,0)){const M=await Hoe(T.productName,T.productId),re=await F(T.productId);if(!v1(re,T.qty))return`Stock insuficiente tras corregir ${M} lote(s) para "${T.productName}".`}else return`Stock insuficiente para "${T.productName}". Disponible: ${R}`}}return null},I=async T=>{var K,M;T.preventDefault(),k("");const R=await Ie();if(R){k(" "+R);return}try{L(!0);const re=[];for(const q of u){const Se=q.qty,{allocations:ee,avgUnitCost:z,cogsAmount:te}=await Qoe(Te,q.productName,Se,!1),Ne=_(q),Y=Number(Ne||0)*Number(Se||0),we=Math.max(0,Number(q.discount||0)),Pe=Math.max(0,Y-we);re.push({productId:q.productId,productName:q.productName,measurement:q.measurement,unitPrice:Number(Ne||0),regularPrice:Number(q.price||0),specialPrice:Number(q.specialPrice||0)>0?Number(q.specialPrice):null,qty:Se,discount:we,lineTotal:S(Y),lineFinal:S(Pe),allocations:ee,avgUnitCost:z,cogsAmount:te})}const de=re.reduce((q,Se)=>q+Se.lineFinal,0),le=re.reduce((q,Se)=>q+Number(Se.qty||0),0);await Jr(ht(Te,"salesV2"),{id:Moe(),quantity:le,amount:de,amountCharged:de,amountReceived:Number(p)||0,change:x,clientName:d.trim(),timestamp:$t.now(),date:l,userEmail:((K=n[0])==null?void 0:K.email)??"sin usuario",vendor:((M=n[0])==null?void 0:M.role)??"sin usuario",status:"FLOTANTE",items:re,itemsTotal:de}),k(" Venta registrada y asignada a inventario (FIFO)."),f([]),o(""),m(0),g(0),b("0"),A(""),c(or(new Date,"yyyy-MM-dd"))}catch(re){console.error(re),k(` ${(re==null?void 0:re.message)||"Error al registrar la venta."}`)}finally{L(!1)}},j=N.useMemo(()=>new Set(u.map(T=>T.productId)),[u]),Q=N.useMemo(()=>e.filter(T=>(E[T.id]||0)>0),[e,E]);return a.jsxs("div",{className:"relative",children:[a.jsxs("form",{onSubmit:I,className:`w-full mx-auto bg-white rounded-2xl shadow-2xl\r
                 p-4 sm:p-6 md:p-8\r
                 max-w-5xl space-y-4`,children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-blue-700 whitespace-nowrap",children:"Registrar venta (Pollo)"})}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Producto | Precio por Libra/Unidad"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("select",{className:"flex-1 border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:i,onChange:T=>o(T.target.value),children:[a.jsx("option",{value:"",disabled:!0,children:"Selecciona un producto"}),Q.map(T=>a.jsxs("option",{value:T.id,disabled:j.has(T.id),title:j.has(T.id)?"Ya est en la lista":`Disponible: ${U(E[T.id]||0)}`,children:[T.productName,"  ",T.measurement,"  C$ ",T.price," (disp:"," ",U(E[T.id]||0),")"]},T.id))]}),a.jsx("button",{type:"button",onClick:X,disabled:!i||j.has(i),className:"px-3 py-2 rounded-2xl shadow-2xl bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:"Agregar"})]})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Fecha de la venta"}),a.jsx("input",{type:"date",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl focus:ring-2 focus:ring-blue-400",value:l,onChange:T=>c(T.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cliente"}),a.jsx("input",{className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:d,onChange:T=>A(T.target.value),placeholder:"Opcional"})]})]}),a.jsx("div",{className:"rounded border overflow-x-auto shadow-2xl",children:a.jsxs("table",{className:"min-w-full text-sm r",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{className:"text-center",children:[a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio especial"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Existencias"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cantidad"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descuento"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:""})]})}),a.jsx("tbody",{children:u.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Agrega productos al carrito."})}):u.map(T=>{const R=_(T),K=Number(R||0)*Number(T.qty||0),M=Math.max(0,K-Math.max(0,Number(T.discount||0))),re=(T.measurement||"").toLowerCase()!=="lb",de=ys(Number(T.stock)-Number(T.qty||0));return a.jsxs("tr",{className:"text-center",children:[a.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[T.productName,"  ",T.measurement]}),a.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",S(T.price).toFixed(2)]}),a.jsxs("td",{className:"p-2 border",children:[a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:T.specialPrice===0?"":T.specialPrice,onKeyDown:ye,onChange:le=>fe(T.productId,le.target.value),placeholder:"",title:"Precio especial (si se deja vaco, se usa el precio normal)"}),a.jsxs("div",{className:"text-[11px] text-gray-500 mt-1",children:["Aplicado: C$ ",S(R).toFixed(2)]})]}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:de.toFixed(3)}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"number",step:re?1:.01,inputMode:re?"numeric":"decimal",className:"w-28 border p-1 rounded text-right",value:T.qty===0?"":T.qty,onKeyDown:ye,onChange:le=>ae(T.productId,le.target.value),placeholder:"0",title:"Cantidad"})}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"number",step:1,min:0,className:"w-24 border p-1 rounded text-right",value:T.discount===0?"":T.discount,onChange:le=>me(T.productId,le.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento (entero C$)"})}),a.jsxs("td",{className:"p-2 border whitespace-nowrap",children:["C$ ",S(M).toFixed(2)]}),a.jsx("td",{className:"p-2 border",children:a.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 text-red-600 hover:bg-red-200",onClick:()=>ge(T.productId),title:"Quitar",children:""})})]},T.productId)})})]})}),a.jsxs("div",{className:"space-y-1 ",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 ",children:" Monto total"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${h.toFixed(2)}`,readOnly:!0,title:"Suma de (precio aplicado  cantidad  descuento) de cada producto."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-x-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Monto recibido"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl",value:p===0?"":p,onChange:T=>g(Number(T.target.value||0))})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Cambio"}),a.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded-2xl shadow-2xl bg-gray-100",value:`C$ ${x}`,readOnly:!0})]})]}),a.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-3 sm:py-2 rounded-2xl shadow-2xl font-semibold shadow hover:bg-blue-700 transition disabled:opacity-50",disabled:u.length===0||O,children:O?"Guardando...":"Guardar venta"}),w&&a.jsx("p",{className:`text-sm mt-2 ${w.startsWith("")?"text-green-600":w.startsWith("")?"text-yellow-600":"text-red-600"}`,children:w})]}),O&&a.jsx("div",{className:"fixed inset-0 bg-black/40 z-[60] flex items-center justify-center",children:a.jsx("div",{className:"bg-white rounded-lg shadow-xl border px-6 py-5",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",fill:"none",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),a.jsx("span",{className:"font-semibold",children:"Guardando venta"})]})})})]})}var r8={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},eP=ui.createContext&&ui.createContext(r8),Koe=["attr","size","title"];function qoe(t,e){if(t==null)return{};var r=Goe(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Goe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Cb(){return Cb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Cb.apply(this,arguments)}function tP(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function _b(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tP(Object(r),!0).forEach(function(n){$oe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tP(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $oe(t,e,r){return e=zoe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zoe(t){var e=Woe(t,"string");return typeof e=="symbol"?e:e+""}function Woe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function n8(t){return t&&t.map((e,r)=>ui.createElement(e.tag,_b({key:r},e.attr),n8(e.child)))}function Joe(t){return e=>ui.createElement(Xoe,Cb({attr:_b({},t.attr)},e),n8(t.child))}function Xoe(t){var e=r=>{var{attr:n,size:s,title:i}=t,o=qoe(t,Koe),l=s||r.size||"1em",c;return r.className&&(c=r.className),t.className&&(c=(c?c+" ":"")+t.className),ui.createElement("svg",Cb({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:c,style:_b(_b({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&ui.createElement("title",null,i),t.children)};return eP!==void 0?ui.createElement(eP.Consumer,null,r=>e(r)):e(r8)}function Yoe(t){return Joe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(t)}function Zl({onClick:t,loading:e,className:r=""}){return a.jsxs("button",{onClick:t,disabled:e,className:`flex items-center gap-2 px-3 py-1.5 rounded-2xl  border 
        bg-white hover:bg-gray-100 text-sm font-medium shadow-2xl
        disabled:opacity-50 disabled:cursor-not-allowed ${r}`,title:"Refrescar datos",children:[a.jsx(Yoe,{className:`w-4 h-4 ${e?"animate-spin text-blue-500":""}`}),e?"Actualizando...":"Refrescar"]})}const ba=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function JN(t="LOT"){return`${t}-${Date.now()}-${Math.random().toString(16).slice(2)}`}function Zoe({role:t="",sellerCandyId:e="",currentUserEmail:r}){const[n,s]=N.useState([]),[i,o]=N.useState([]),[l,c]=N.useState(!0),[d,A]=N.useState(""),{refreshKey:u,refresh:f}=vl(),h=t==="admin",[m,p]=N.useState(or(jc(new Date),"yyyy-MM-dd")),[g,x]=N.useState(or(Ic(new Date),"yyyy-MM-dd")),[b,w]=N.useState(""),[k,O]=N.useState(!1),[L,E]=N.useState(""),[B,S]=N.useState(or(new Date,"yyyy-MM-dd")),[U,_]=N.useState("lb"),[F,D]=N.useState(""),[X,ge]=N.useState(0),[ae,fe]=N.useState(0),[me,Z]=N.useState(0),[ye,Ie]=N.useState([]),[I,j]=N.useState(null),[Q,T]=N.useState([]),[R,K]=N.useState(!1),[M,re]=N.useState(null),[de,le]=N.useState(!1),[q,Se]=N.useState(null),ee=ie=>{const ze=(ie||"").toLowerCase();return/(^|\s)(lb|lbs|libra|libras)(\s|$)/.test(ze)||ze==="lb"};N.useEffect(()=>{(async()=>{c(!0),A("");const ie=await Nt(ht(Te,"products")),ze=[];ie.forEach(at=>{const Ve=at.data();Ve.active===!0&&ze.push({id:at.id,name:Ve.name??Ve.productName??"(sin nombre)",category:Ve.category??"(sin categora)",measurement:Ve.measurement??"lb",price:Number(Ve.price??0)})}),s(ze);const rt=Dt(ht(Te,"inventory_batches"),Ur("date","desc")),At=await Nt(rt),Oe=[];At.forEach(at=>{const Ve=at.data(),G=ys(Number(Ve.quantity||0)),_e=Number(Ve.purchasePrice||0),Me=Number(Ve.salePrice||0),We=Number((G*_e).toFixed(2)),He=Number((G*Me).toFixed(2));Oe.push({id:at.id,productId:Ve.productId,productName:Ve.productName,category:Ve.category,unit:Ve.unit,quantity:G,remaining:ys(Number(Ve.remaining||0)),purchasePrice:_e,salePrice:Me,invoiceTotal:Ve.invoiceTotal!=null?Number(Ve.invoiceTotal):We,expectedTotal:Ve.expectedTotal!=null?Number(Ve.expectedTotal):He,date:Ve.date,createdAt:Ve.createdAt,status:Ve.status,notes:Ve.notes,paidAmount:Number(Ve.paidAmount||0),paidAt:Ve.paidAt,batchGroupId:Ve.batchGroupId,orderName:Ve.orderName})}),o(Oe),c(!1)})()},[u]);const z=N.useMemo(()=>i.filter(ie=>!(m&&ie.date<m||g&&ie.date>g||b&&ie.productId!==b)),[i,m,g,b]),te=N.useMemo(()=>{const ie=z.reduce((_e,Me)=>_e+Number(Me.invoiceTotal||0),0),ze=z.reduce((_e,Me)=>_e+Number(Me.expectedTotal||0),0);let rt=0,At=0,Oe=0,at=0;for(const _e of z)ee(_e.unit)?(rt+=_e.quantity,At+=_e.remaining):(Oe+=_e.quantity,at+=_e.remaining);const Ve=z.reduce((_e,Me)=>_e+Me.quantity,0),G=z.reduce((_e,Me)=>_e+Me.remaining,0);return{lbsIng:rt,lbsRem:At,udsIng:Oe,udsRem:at,qty:Ve,rem:G,totalFacturado:ie,totalEsperado:ze}},[z]),Ne=N.useMemo(()=>{var rt,At;const ie=new Map;for(const Oe of z){const at=Oe.batchGroupId&&String(Oe.batchGroupId).trim()||Oe.id;ie.has(at)||ie.set(at,[]),ie.get(at).push(Oe)}const ze=[];for(const[Oe,at]of ie.entries()){const Ve=[...at].sort((Zt,et)=>{var Lt,Vt;const Rt=((Lt=Zt.createdAt)==null?void 0:Lt.seconds)??0;return(((Vt=et.createdAt)==null?void 0:Vt.seconds)??0)-Rt}),G=((rt=Ve[0])==null?void 0:rt.date)||"",_e=String(((At=Ve[0])==null?void 0:At.orderName)||"").trim()||`Pedido ${G||""}`.trim()||"Pedido",Me=new Set(Ve.map(Zt=>String(Zt.category||"").trim()).filter(Boolean)),We=Me.size===1?Array.from(Me)[0].toUpperCase():"MIXTO",He=Ve.some(Zt=>Zt.status==="PENDIENTE")?"PENDIENTE":"PAGADO",st=ys(Ve.reduce((Zt,et)=>Zt+(ee(et.unit)?Number(et.quantity||0):0),0)),Ct=ys(Ve.reduce((Zt,et)=>Zt+(ee(et.unit)?Number(et.remaining||0):0),0)),Xt=Number(Ve.reduce((Zt,et)=>Zt+Number(et.invoiceTotal||0),0).toFixed(2)),Ot=Number(Ve.reduce((Zt,et)=>Zt+Number(et.expectedTotal||0),0).toFixed(2)),tr=Number((Ot-Xt).toFixed(2));ze.push({groupId:Oe,orderName:_e,date:G,typeLabel:We,status:He,lbsIn:st,lbsRem:Ct,totalFacturado:Xt,totalEsperado:Ot,utilidadBruta:tr,items:Ve})}return ze.sort((Oe,at)=>Oe.date===at.date?Oe.groupId<at.groupId?1:-1:Oe.date<at.date?1:-1),ze},[z]),Y=N.useMemo(()=>{const ie=String(U||"").toLowerCase().trim();return n.filter(rt=>String(rt.measurement||"").toLowerCase().trim()===ie).sort((rt,At)=>rt.name.localeCompare(At.name,"es"))},[n,U]);N.useEffect(()=>{const ie=n.find(ze=>ze.id===F);ie&&Z(Number(ie.price||0))},[F,n,u]);const we=()=>{A("");const ie=n.find(G=>G.id===F);if(!ie)return A("Selecciona un producto.");if(X<=0||ae<=0)return A("Completa libras a ingresar y precio proveedor.");const ze=ys(X),rt=ie.measurement,At=Number((ze*Number(ae||0)).toFixed(2)),Oe=Number((ze*Number(me||0)).toFixed(2)),at=Number((Oe-At).toFixed(2)),Ve=ye.findIndex(G=>G.productId===ie.id);Ve>=0?Ie(G=>G.map((_e,Me)=>Me!==Ve?_e:{..._e,quantity:ze,remaining:ze,purchasePrice:Number(ae||0),salePrice:Number(me||0),invoiceTotal:At,expectedTotal:Oe,utilidadBruta:at})):Ie(G=>[...G,{tempId:JN("IT"),productId:ie.id,productName:ie.name,category:ie.category,unit:rt,quantity:ze,remaining:ze,purchasePrice:Number(ae||0),salePrice:Number(me||0),invoiceTotal:At,expectedTotal:Oe,utilidadBruta:at}]),D(""),ge(0),fe(0),Z(0)},Pe=ie=>{Ie(ze=>ze.filter(rt=>rt.tempId!==ie))},Qe=(ie,ze,rt)=>{Ie(At=>At.map(Oe=>{if(Oe.tempId!==ie)return Oe;const at={...Oe};return ze==="quantity"&&(at.quantity=ys(Math.max(0,rt)),I||(at.remaining=at.quantity)),ze==="purchasePrice"&&(at.purchasePrice=Math.max(0,Number(rt||0))),ze==="salePrice"&&(at.salePrice=Math.max(0,Number(rt||0))),at.invoiceTotal=Number((at.quantity*at.purchasePrice).toFixed(2)),at.expectedTotal=Number((at.quantity*at.salePrice).toFixed(2)),at.utilidadBruta=Number((at.expectedTotal-at.invoiceTotal).toFixed(2)),at}))},tt=N.useMemo(()=>{const ie=ys(ye.reduce((at,Ve)=>at+(ee(Ve.unit)?Number(Ve.quantity||0):0),0)),ze=ys(ye.reduce((at,Ve)=>at+(ee(Ve.unit)?Number(Ve.remaining||0):0),0)),rt=Number(ye.reduce((at,Ve)=>at+Number(Ve.invoiceTotal||0),0).toFixed(2)),At=Number(ye.reduce((at,Ve)=>at+Number(Ve.expectedTotal||0),0).toFixed(2)),Oe=Number((At-rt).toFixed(2));return{lbsIn:ie,lbsRem:ze,totalFacturado:rt,totalEsperado:At,utilidadBruta:Oe}},[ye]),ot=()=>{j(null),T([]),E(""),S(or(new Date,"yyyy-MM-dd")),_("lb"),D(""),ge(0),fe(0),Z(0),Ie([])},dt=async()=>{if(A(""),!ye.length)return A("Agrega al menos un producto al pedido.");const ie=B||or(new Date,"yyyy-MM-dd"),ze=String(L||"").trim()||`Pedido ${ie}`,rt=I||JN("BATCH");try{if(!I){for(const Ve of ye)await JT({productId:Ve.productId,productName:Ve.productName,category:Ve.category,unit:Ve.unit,quantity:ys(Ve.quantity),purchasePrice:Number(Ve.purchasePrice||0),salePrice:Number(Ve.salePrice||0),invoiceTotal:Number(Ve.invoiceTotal||0),expectedTotal:Number(Ve.expectedTotal||0),date:ie,notes:"",batchGroupId:rt,orderName:ze});A(" Pedido creado"),O(!1),ot(),f();return}const At=Q,Oe=new Map;for(const Ve of At)Oe.set(Ve.productId,Ve);const at=new Set(ye.map(Ve=>Ve.productId));for(const Ve of ye){const G=Oe.get(Ve.productId),_e=ys(Ve.quantity);if(G){const Me=ys(G.quantity-G.remaining),We=Math.max(0,ys(_e-Me));await Pr(kt(Te,"inventory_batches",G.id),{date:ie,orderName:ze,batchGroupId:rt,quantity:_e,purchasePrice:Number(Ve.purchasePrice||0),salePrice:Number(Ve.salePrice||0),invoiceTotal:Number(Ve.invoiceTotal||0),expectedTotal:Number(Ve.expectedTotal||0),remaining:We})}else await JT({productId:Ve.productId,productName:Ve.productName,category:Ve.category,unit:Ve.unit,quantity:_e,purchasePrice:Number(Ve.purchasePrice||0),salePrice:Number(Ve.salePrice||0),invoiceTotal:Number(Ve.invoiceTotal||0),expectedTotal:Number(Ve.expectedTotal||0),date:ie,notes:"",batchGroupId:rt,orderName:ze})}for(const Ve of At)at.has(Ve.productId)||await un(kt(Te,"inventory_batches",Ve.id));A(" Pedido actualizado"),O(!1),ot(),f()}catch(At){console.error(At),A(" Error al guardar pedido")}},vt=ie=>{re(ie),K(!0)},lt=ie=>{j(ie.groupId),T(ie.items),E(ie.orderName),S(ie.date||or(new Date,"yyyy-MM-dd"));const ze=ie.items.map(rt=>{const At=Number(rt.invoiceTotal||0),Oe=Number(rt.expectedTotal||0);return{tempId:JN("IT"),productId:rt.productId,productName:rt.productName,category:rt.category,unit:rt.unit,quantity:ys(rt.quantity),remaining:ys(rt.remaining),purchasePrice:Number(rt.purchasePrice||0),salePrice:Number(rt.salePrice||0),invoiceTotal:At,expectedTotal:Oe,utilidadBruta:Number((Oe-At).toFixed(2))}});Ie(ze),O(!0)},Ue=async ie=>{if(confirm(`Eliminar el pedido "${ie.orderName}" del ${ie.date}?`))try{for(const rt of ie.items)await un(kt(Te,"inventory_batches",rt.id));A(" Pedido eliminado"),f()}catch(rt){console.error(rt),A(" Error al eliminar pedido")}},Xe=ie=>{Se(ie),le(!0)},xe=async()=>{if(q)try{for(const ie of q.items){if(ie.status!=="PENDIENTE")continue;await e8(ie.id),await Pr(kt(Te,"inventory_batches",ie.id),{remaining:0});const ze={date:ie.date,productName:ie.productName,quantity:ie.quantity,amount:Number((ie.expectedTotal??ie.salePrice*ie.quantity).toFixed(2)),allocations:[{batchId:ie.id,qty:ie.quantity,unitCost:ie.purchasePrice,lineCost:Number((ie.purchasePrice*ie.quantity).toFixed(2))}],avgUnitCost:ie.purchasePrice,measurement:ie.unit,createdAt:$t.now(),autoGeneratedFromInventory:!0};await Jr(ht(Te,"salesV2"),ze)}A(" Pedido pagado y reflejado como venta"),f()}catch(ie){console.error(ie),A(" Error al pagar pedido")}finally{le(!1),Se(null)}},ve=()=>{le(!1),Se(null)};return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Inventario"}),h&&a.jsx("button",{className:"px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",type:"button",onClick:()=>{ot(),O(!0)},children:"Crear Lote"})]}),a.jsxs("div",{className:"bg-white p-3 rounded shadow-2xl border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:m,onChange:ie=>p(ie.target.value)})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:g,onChange:ie=>x(ie.target.value)})]}),a.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[a.jsx("label",{className:"font-semibold",children:"Producto"}),a.jsxs("select",{className:"border rounded px-2 py-1",value:b,onChange:ie=>w(ie.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),n.map(ie=>a.jsxs("option",{value:ie.id,children:[ie.name,"  ",ie.category]},ie.id))]})]}),a.jsx("button",{className:"px-3 rounded-2xl shadow-2xl py-1 bg-gray-200 hover:bg-gray-300",onClick:()=>{p(""),x(""),w("")},children:"Quitar filtro"}),a.jsx("div",{className:"ml-auto",children:a.jsx(Zl,{onClick:()=>f(),loading:l})})]}),a.jsx("div",{className:"bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-y-2 gap-x-8",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",te.lbsIng.toFixed(3)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",te.lbsRem.toFixed(3)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",te.udsIng.toFixed(3)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",te.udsRem.toFixed(3)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," C$"," ",te.totalEsperado.toFixed(2)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total facturado:"})," C$"," ",te.totalFacturado.toFixed(2)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," C$"," ",(te.totalEsperado-te.totalFacturado).toFixed(2)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes (por filtro):"})," ",z.length.toLocaleString()]})]})}),a.jsx("div",{className:"md:hidden space-y-3",children:l?a.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow",children:"Cargando"}):Ne.length===0?a.jsx("div",{className:"bg-white border rounded-2xl p-4 shadow text-center",children:"Sin lotes"}):Ne.map(ie=>a.jsxs("div",{className:"bg-white border rounded-2xl p-4 shadow",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-semibold text-lg",children:ie.date}),a.jsx("div",{className:"text-xs text-gray-500 truncate",children:ie.orderName})]}),a.jsx("span",{className:`px-2 py-1 rounded text-xs shrink-0 ${ie.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ie.status})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-[11px] text-gray-500",children:"Tipo"}),a.jsx("div",{className:"font-semibold",children:ie.typeLabel})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-[11px] text-gray-500",children:"Utilidad bruta"}),a.jsx("div",{className:"font-semibold",children:ba(ie.utilidadBruta)})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-[11px] text-gray-500",children:"Lbs ingresadas"}),a.jsx("div",{className:"font-semibold",children:ie.lbsIn.toFixed(3)})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-[11px] text-gray-500",children:"Lbs restantes"}),a.jsx("div",{className:"font-semibold",children:ie.lbsRem.toFixed(3)})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2 col-span-2",children:[a.jsxs("div",{className:"flex justify-between text-[11px] text-gray-500",children:[a.jsx("span",{children:"Total facturado"}),a.jsx("span",{children:"Total esperado"})]}),a.jsxs("div",{className:"flex justify-between font-semibold",children:[a.jsx("span",{children:ba(ie.totalFacturado)}),a.jsx("span",{children:ba(ie.totalEsperado)})]})]})]}),a.jsxs("div",{className:"mt-3 flex gap-2",children:[a.jsx("button",{className:"flex-1 px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-sm",onClick:()=>vt(ie),children:"Ver detalle"}),h?a.jsxs(a.Fragment,{children:[ie.status==="PENDIENTE"&&a.jsx("button",{className:"px-3 py-2 rounded-xl bg-green-600 hover:bg-green-700 text-white text-sm",onClick:()=>Xe(ie),children:"Pagar"}),a.jsx("button",{className:"px-3 py-2 rounded-xl bg-yellow-600 hover:bg-yellow-700 text-white text-sm",onClick:()=>lt(ie),children:"Editar"}),a.jsx("button",{className:"px-3 py-2 rounded-xl bg-red-600 hover:bg-red-700 text-white text-sm",onClick:()=>Ue(ie),children:"Borrar"})]}):null]})]},ie.groupId))}),a.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto",children:a.jsxs("table",{className:"min-w-[1100px] w-full text-sm shadow-2xl",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{className:"whitespace-nowrap",children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Tipo"}),a.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),a.jsx("th",{className:"p-2 border",children:"Libras restantes"}),a.jsx("th",{className:"p-2 border",children:"Total Facturado"}),a.jsx("th",{className:"p-2 border",children:"Total esperado"}),a.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),a.jsx("th",{className:"p-2 border",children:"Estado"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:l?a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):Ne.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin lotes"})}):Ne.map(ie=>a.jsxs("tr",{className:"text-center whitespace-nowrap",children:[a.jsxs("td",{className:"p-2 border",children:[a.jsx("button",{className:"underline text-blue-700 hover:text-blue-900",onClick:()=>vt(ie),title:ie.orderName,children:ie.date}),a.jsx("div",{className:"text-[11px] text-gray-500",children:ie.orderName})]}),a.jsx("td",{className:"p-2 border",children:ie.typeLabel}),a.jsx("td",{className:"p-2 border",children:ie.lbsIn.toFixed(3)}),a.jsx("td",{className:"p-2 border",children:ie.lbsRem.toFixed(3)}),a.jsx("td",{className:"p-2 border",children:ba(ie.totalFacturado)}),a.jsx("td",{className:"p-2 border",children:ba(ie.totalEsperado)}),a.jsx("td",{className:"p-2 border",children:ba(ie.utilidadBruta)}),a.jsx("td",{className:"p-2 border",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ie.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ie.status})}),a.jsx("td",{className:"p-2 border",children:h?a.jsxs("div",{className:"flex gap-2 justify-center",children:[ie.status==="PENDIENTE"&&a.jsx("button",{onClick:()=>Xe(ie),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Pagar"}),a.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>lt(ie),children:"Editar"}),a.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Ue(ie),children:"Borrar"})]}):a.jsx("span",{className:"text-xs text-gray-500",children:"Solo vista"})})]},ie.groupId))})]})}),d&&a.jsx("p",{className:"mt-2 text-sm",children:d}),k&&$A.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>O(!1)}),a.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-lg font-bold",children:I?"Editar pedido":"Crear pedido"}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>O(!1),type:"button",children:"Cerrar"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de pedido"}),a.jsx("input",{className:"w-full border p-2 rounded",value:L,onChange:ie=>E(ie.target.value),placeholder:"Ej: Pedido Pollo - Semana 1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),a.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:B,onChange:ie=>S(ie.target.value)})]})]}),a.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Unidad"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:U,onChange:ie=>{_(ie.target.value),D(""),ge(0),fe(0),Z(0)},children:[a.jsx("option",{value:"lb",children:"lb"}),a.jsx("option",{value:"unidad",children:"unidad"}),a.jsx("option",{value:"kg",children:"kg"})]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Producto (solo activos)"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:F,onChange:ie=>D(ie.target.value),children:[a.jsx("option",{value:"",children:"Selecciona un producto"}),Y.map(ie=>a.jsxs("option",{value:ie.id,children:[ie.name,"  ",ie.category,"  ",ie.measurement]},ie.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Libras a ingresar"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:X===0?"":X,onChange:ie=>{const ze=ie.target.value.replace(",","."),rt=parseFloat(ze),At=Number.isFinite(rt)?parseFloat(rt.toFixed(3)):0;ge(Math.max(0,At))},disabled:!F})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ae===0?"":ae,onChange:ie=>{const ze=ie.target.value.replace(",","."),rt=parseFloat(ze),At=Number.isFinite(rt)?parseFloat(rt.toFixed(2)):0;fe(Math.max(0,At))},disabled:!F})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Precio venta (editable)"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:me===0?"":me,onChange:ie=>{const ze=ie.target.value.replace(",","."),rt=parseFloat(ze),At=Number.isFinite(rt)?parseFloat(rt.toFixed(2)):0;Z(Math.max(0,At))},disabled:!F})]})]}),a.jsx("div",{className:"flex justify-end mt-3",children:a.jsx("button",{type:"button",onClick:we,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto al pedido"})})]}),a.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:a.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{className:"whitespace-nowrap",children:[a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"Libras ingresadas"}),a.jsx("th",{className:"p-2 border",children:"Libras restantes"}),a.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),a.jsx("th",{className:"p-2 border",children:"Precio venta"}),a.jsx("th",{className:"p-2 border",children:"Total facturado"}),a.jsx("th",{className:"p-2 border",children:"Total esperado"}),a.jsx("th",{className:"p-2 border",children:"Utilidad bruta"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:ye.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"p-4 text-center text-gray-500",children:"No hay productos agregados."})}):ye.map(ie=>a.jsxs("tr",{className:"text-center whitespace-nowrap",children:[a.jsxs("td",{className:"p-2 border text-left",children:[ie.productName,a.jsxs("div",{className:"text-[11px] text-gray-500",children:[ie.category,"  ",ie.unit]})]}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:ie.quantity,onChange:ze=>{const rt=ze.target.value.replace(",","."),At=parseFloat(rt),Oe=Number.isFinite(At)?parseFloat(At.toFixed(3)):0;Qe(ie.tempId,"quantity",Oe)}})}),a.jsx("td",{className:"p-2 border",children:Number(ie.remaining||0).toFixed(3)}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:ie.purchasePrice,onChange:ze=>{const rt=ze.target.value.replace(",","."),At=parseFloat(rt),Oe=Number.isFinite(At)?parseFloat(At.toFixed(2)):0;Qe(ie.tempId,"purchasePrice",Oe)}})}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border p-1 rounded text-right",value:ie.salePrice,onChange:ze=>{const rt=ze.target.value.replace(",","."),At=parseFloat(rt),Oe=Number.isFinite(At)?parseFloat(At.toFixed(2)):0;Qe(ie.tempId,"salePrice",Oe)}})}),a.jsx("td",{className:"p-2 border",children:ba(ie.invoiceTotal)}),a.jsx("td",{className:"p-2 border",children:ba(ie.expectedTotal)}),a.jsx("td",{className:"p-2 border",children:ba(ie.utilidadBruta)}),a.jsx("td",{className:"p-2 border",children:a.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Pe(ie.tempId),children:"Quitar"})})]},ie.tempId))})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),a.jsx("div",{className:"text-lg font-semibold",children:tt.lbsIn.toFixed(3)}),a.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Libras restantes"}),a.jsx("div",{className:"text-lg font-semibold",children:tt.lbsRem.toFixed(3)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado"}),a.jsx("div",{className:"text-lg font-semibold",children:ba(tt.totalFacturado)}),a.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Total esperado"}),a.jsx("div",{className:"text-lg font-semibold",children:ba(tt.totalEsperado)}),a.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Utilidad bruta"}),a.jsx("div",{className:"text-lg font-semibold",children:ba(tt.utilidadBruta)})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[a.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>O(!1),children:"Cancelar"}),a.jsx("button",{type:"button",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:dt,disabled:ye.length===0,children:I?"Editar pedido":"Crear pedido"})]})]})]}),document.body),R&&M&&$A.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[75] flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{K(!1),re(null)}}),a.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-6xl max-h-[92vh] overflow-auto p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Detalle del pedido"}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsx("strong",{children:M.orderName})," "," ",M.date]})]}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{K(!1),re(null)},type:"button",children:"Cerrar"})]}),a.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:a.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{className:"whitespace-nowrap",children:[a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"Unidad"}),a.jsx("th",{className:"p-2 border",children:"Ingresado"}),a.jsx("th",{className:"p-2 border",children:"Restantes"}),a.jsx("th",{className:"p-2 border",children:"Precio Compra"}),a.jsx("th",{className:"p-2 border",children:"Precio Venta"}),a.jsx("th",{className:"p-2 border",children:"Total factura"}),a.jsx("th",{className:"p-2 border",children:"Total esperado"}),a.jsx("th",{className:"p-2 border",children:"Utilidad"}),a.jsx("th",{className:"p-2 border",children:"Estado"})]})}),a.jsx("tbody",{children:M.items.map(ie=>{const ze=Number(ie.invoiceTotal||0),rt=Number(ie.expectedTotal||0);return a.jsxs("tr",{className:"text-center whitespace-nowrap",children:[a.jsx("td",{className:"p-2 border text-left",children:ie.productName}),a.jsx("td",{className:"p-2 border",children:(ie.unit||"").toUpperCase()}),a.jsx("td",{className:"p-2 border",children:ie.quantity.toFixed(3)}),a.jsx("td",{className:"p-2 border",children:ie.remaining.toFixed(3)}),a.jsx("td",{className:"p-2 border",children:ba(ie.purchasePrice)}),a.jsx("td",{className:"p-2 border",children:ba(ie.salePrice)}),a.jsx("td",{className:"p-2 border",children:ba(ze)}),a.jsx("td",{className:"p-2 border",children:ba(rt)}),a.jsx("td",{className:"p-2 border",children:ba(rt-ze)}),a.jsx("td",{className:"p-2 border",children:ie.status})]},ie.id)})})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-4",children:[a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Libras ingresadas"}),a.jsx("div",{className:"text-lg font-semibold",children:M.lbsIn.toFixed(3)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Libras restantes"}),a.jsx("div",{className:"text-lg font-semibold",children:M.lbsRem.toFixed(3)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad bruta"}),a.jsx("div",{className:"text-lg font-semibold",children:ba(M.utilidadBruta)})]})]})]})]}),document.body),de&&q&&$A.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:ve}),a.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl border w-[90%] max-w-md p-6",children:[a.jsx("h3",{className:"text-lg font-bold mb-3 text-center",children:"Confirmar pago de inventario"}),a.jsxs("p",{className:"text-sm text-gray-700 mb-5 text-center",children:["Seguro que quieres pagar este pedido?",a.jsx("br",{}),a.jsx("strong",{children:q.orderName})," "," ",q.date,a.jsx("br",{}),"Ya no habrn libras disponibles al pagar este inventario."]}),a.jsxs("div",{className:"flex justify-center gap-4",children:[a.jsx("button",{onClick:xe,className:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700",children:"Confirmar"}),a.jsx("button",{onClick:ve,className:"px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400",children:"Cancelar"})]})]})]}),document.body)]})}const Xc=t=>`C$${(Number(t)||0).toFixed(2)}`;function ele(){const t=hZ(new Date),[e,r]=N.useState(or(t,"yyyy-MM")),[n,s]=N.useState([]),[i,o]=N.useState(!1),[l,c]=N.useState(""),d=N.useRef(null),A=N.useMemo(()=>{const[g,x]=e.split("-").map(k=>parseInt(k,10)),b=or(jc(new Date(g,x-1,1)),"yyyy-MM-dd"),w=or(Ic(new Date(g,x-1,1)),"yyyy-MM-dd");return{from:b,to:w}},[e]),u=async()=>{o(!0);try{const g=await Ioe(A.from,A.to),x=[];for(const b of g){const w=kt(Te,"inventory_batches",b.batchId),k=await Ya(w);if(!k.exists())continue;const O=k.data();x.push({batchId:b.batchId,batchDate:b.batchDate,productName:b.productName,soldQty:Number(b.quantity||0),soldAmount:Number(b.amountCharged||0),status:O.status??"PENDIENTE",purchasePrice:Number(O.purchasePrice||0),salePrice:Number(O.salePrice||0),supplier:O.supplier})}s(x)}catch(g){console.error(g),c(" Error al cargar liquidaciones")}finally{o(!1)}};N.useEffect(()=>{u()},[e]);const f=async g=>{confirm("Marcar este lote como PAGADO?")&&(await e8(g),s(b=>b.map(w=>w.batchId===g?{...w,status:"PAGADO"}:w)))},h=N.useMemo(()=>{const g=n.reduce((k,O)=>k+O.soldQty,0),x=n.reduce((k,O)=>k+O.soldAmount,0),b=n.reduce((k,O)=>k+O.soldQty*O.purchasePrice,0),w=x-b;return{q:g,amt:x,cogs:b,profit:w}},[n]),m=N.useMemo(()=>{const g=new Map;for(const x of n){const b=x.productName||"(sin nombre)";g.has(b)||g.set(b,{productName:b,qty:0,revenue:0,cogs:0,profit:0});const w=g.get(b);w.qty+=x.soldQty,w.revenue+=x.soldAmount;const k=x.soldQty*x.purchasePrice;w.cogs+=k,w.profit=w.revenue-w.cogs}return Array.from(g.values()).sort((x,b)=>x.productName.localeCompare(b.productName))},[n]),p=async()=>{if(!d.current)return;const g=d.current;g.classList.add("force-pdf-colors");try{const[{default:x},{jsPDF:b}]=await Promise.all([xd(()=>Promise.resolve().then(()=>ZS),void 0),xd(()=>Promise.resolve().then(()=>SE),void 0)]),k=(await x(g,{backgroundColor:"#ffffff",scale:2})).toDataURL("image/png"),O=new b("p","mm","a4"),L=190,E=O.getImageProperties(k),B=L,S=E.height*B/E.width;O.addImage(k,"PNG",10,10,B,S),O.save(`liquidaciones_${e}.pdf`)}catch(x){console.error(x),alert("No se pudo generar el PDF")}finally{g.classList.remove("force-pdf-colors")}};return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Liquidaciones por lote"}),a.jsx("button",{onClick:p,className:"bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"Descargar PDF"})]}),a.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-center gap-3",children:[a.jsx("label",{className:"text-sm font-semibold",children:"Mes:"}),a.jsx("input",{type:"month",className:"border rounded px-2 py-1",value:e,onChange:g=>r(g.target.value)}),a.jsx("button",{onClick:u,className:"bg-gray-800 text-white px-3 py-1 rounded",children:"Aplicar"})]}),a.jsxs("div",{ref:d,children:[a.jsx("div",{className:"bg-white p-3 rounded shadow border mb-3 text-sm",children:a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total vendido (cantidad):"})," ",h.q]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Monto vendido:"})," ",Xc(h.amt)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Costo (COGS):"})," ",Xc(h.cogs)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Utilidad:"})," ",Xc(h.profit)]})]})}),a.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto mb-6",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Lote (fecha)"}),a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"Proveedor"}),a.jsx("th",{className:"p-2 border",children:"Vendido"}),a.jsx("th",{className:"p-2 border",children:"Monto vendido"}),a.jsx("th",{className:"p-2 border",children:"COGS"}),a.jsx("th",{className:"p-2 border",children:"Utilidad"}),a.jsx("th",{className:"p-2 border",children:"Estado"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:i?a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):n.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin datos"})}):n.map(g=>{const x=g.soldQty*g.purchasePrice,b=g.soldAmount-x;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:g.batchDate}),a.jsx("td",{className:"p-2 border",children:g.productName}),a.jsx("td",{className:"p-2 border",children:g.supplier||"-"}),a.jsx("td",{className:"p-2 border",children:g.soldQty}),a.jsx("td",{className:"p-2 border",children:Xc(g.soldAmount)}),a.jsx("td",{className:"p-2 border",children:Xc(x)}),a.jsx("td",{className:`p-2 border ${b>=0?"text-green-700":"text-red-700"}`,children:Xc(b)}),a.jsx("td",{className:"p-2 border",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${g.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:g.status})}),a.jsx("td",{className:"p-2 border",children:g.status==="PENDIENTE"&&a.jsx("button",{onClick:()=>f(g.batchId),className:"px-2 py-1 rounded text-white bg-green-600 hover:bg-green-700",children:"Marcar pagado"})})]},g.batchId)})})]})}),a.jsx("h3",{className:"font-semibold mb-2",children:"Utilidad por producto"}),a.jsx("div",{className:"bg-white p-2 rounded shadow border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"Cantidad vendida"}),a.jsx("th",{className:"p-2 border",children:"Ingreso"}),a.jsx("th",{className:"p-2 border",children:"COGS"}),a.jsx("th",{className:"p-2 border",children:"Utilidad"})]})}),a.jsx("tbody",{children:m.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin datos"})}):m.map(g=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:g.productName}),a.jsx("td",{className:"p-2 border",children:g.qty}),a.jsx("td",{className:"p-2 border",children:Xc(g.revenue)}),a.jsx("td",{className:"p-2 border",children:Xc(g.cogs)}),a.jsx("td",{className:`p-2 border ${g.profit>=0?"text-green-700":"text-red-700"}`,children:Xc(g.profit)})]},g.productName))})]})})]}),l&&a.jsx("p",{className:"mt-2 text-sm",children:l})]})}const Si=t=>`C$${Number(t??0).toFixed(2)}`,tle=()=>or(new Date,"yyyy-MM-dd"),Tf=t=>Number(t||0).toFixed(3);function rle(){const[t,e]=N.useState(()=>{const _=new Date,F=new Date(_.getFullYear(),_.getMonth(),1);return or(F,"yyyy-MM-dd")}),[r,n]=N.useState(tle()),[s,i]=N.useState(!0),[o,l]=N.useState([]),[c,d]=N.useState([]),{refreshKey:A,refresh:u}=vl(),[f,h]=N.useState({}),[m,p]=N.useState({});N.useEffect(()=>{(async()=>{i(!0);const F=Dt(ht(Te,"salesV2"),Gt("date",">=",t),Gt("date","<=",r)),D=await Nt(F),X=[];D.forEach(me=>{const Z=me.data(),ye=Z.date??"";if(Array.isArray(Z.items)&&Z.items.length>0){Z.items.forEach((Ie,I)=>{const j=String(Ie.productName??"(sin nombre)"),Q=Number(Ie.qty??0),T=Number(Ie.lineFinal??0)||Math.max(0,Number(Ie.unitPrice||0)*Q-Number(Ie.discount||0));X.push({id:`${me.id}#${I}`,date:ye,productName:j,quantity:Q,amount:T,allocations:Array.isArray(Ie.allocations)?Ie.allocations:Z.allocations,avgUnitCost:Number(Ie.avgUnitCost??Z.avgUnitCost??0),measurement:Ie.measurement??Z.measurement??""})});return}X.push({id:me.id,date:ye,productName:Z.productName??"(sin nombre)",quantity:Number(Z.quantity??0),amount:Number(Z.amount??Z.amountCharged??0),allocations:Array.isArray(Z.allocations)?Z.allocations:[],avgUnitCost:Number(Z.avgUnitCost??0),measurement:Z.measurement??""})}),l(X);const ge=Dt(ht(Te,"expenses"),Gt("date",">=",t),Gt("date","<=",r)),ae=await Nt(ge),fe=[];ae.forEach(me=>{const Z=me.data();fe.push({id:me.id,date:Z.date??"",category:Z.category??"(sin categora)",description:Z.description??"",amount:Number(Z.amount??0),status:Z.status??"PAGADO",createdAt:Z.createdAt})}),d(fe),i(!1)})()},[t,r,A]);const g=N.useMemo(()=>{const _=o.reduce((ae,fe)=>ae+(fe.amount||0),0);let F=0;o.forEach(ae=>{var fe;(fe=ae.allocations)!=null&&fe.length?F+=ae.allocations.reduce((me,Z)=>me+Number(Z.lineCost||0),0):ae.avgUnitCost&&ae.quantity&&(F+=Number(ae.avgUnitCost)*Number(ae.quantity))});const D=_-F,X=c.reduce((ae,fe)=>ae+(fe.amount||0),0),ge=D-X;return{revenue:_,cogsReal:F,grossProfit:D,expensesSum:X,netProfit:ge}},[o,c]),x=_=>String(_??"").toLowerCase().trim(),b=_=>Number(_.qty??_.quantity??0),w=_=>["lb","lbs","libra","libras"].includes(x(_)),k=_=>["unidad","unidades","ud","uds","pieza","piezas"].includes(x(_)),O=N.useMemo(()=>o.reduce((_,F)=>w(F.measurement)?_+b(F):_,0),[o]),L=N.useMemo(()=>o.reduce((_,F)=>k(F.measurement)?_+b(F):_,0),[o]),E=N.useMemo(()=>{var F;const _=new Map;for(const D of o){const X=D.productName||"(sin nombre)";_.has(X)||_.set(X,{productName:X,units:0,revenue:0,cogs:0,profit:0,firstDate:D.date||"",lastDate:D.date||""});const ge=_.get(X);ge.units+=Number(D.quantity||0),ge.revenue+=Number(D.amount||0),(!ge.firstDate||D.date<(ge.firstDate||D.date))&&(ge.firstDate=D.date),(!ge.lastDate||D.date>(ge.lastDate||D.date))&&(ge.lastDate=D.date);let ae=0;(F=D.allocations)!=null&&F.length?ae=D.allocations.reduce((fe,me)=>fe+Number(me.lineCost||0),0):D.avgUnitCost&&(ae=Number(D.avgUnitCost)*Number(D.quantity||0)),ge.cogs+=ae,ge.profit=ge.revenue-ge.cogs}return Array.from(_.values()).sort((D,X)=>D.productName.localeCompare(X.productName))},[o]),B=N.useMemo(()=>[...E].sort((_,F)=>F.units-_.units).slice(0,3).map((_,F)=>({idx:F+1,name:_.productName,units:_.units})),[E]),S=_=>h(F=>({...F,[_]:!F[_]})),U=_=>p(F=>({...F,[_]:!F[_]}));return a.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-4 sm:p-6 rounded-2xl shadow-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[a.jsx("h2",{className:"text-xl sm:text-2xl font-bold",children:"Dashboard Financiero"}),a.jsx(Zl,{onClick:u,loading:s})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:t,onChange:_=>e(_.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-3 py-2 w-full",value:r,onChange:_=>n(_.target.value)})]})]}),s?a.jsx("p",{children:"Cargando"}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 mb-3 rounded-2xl shadow-lg p-3 sm:p-4 bg-gray-50",children:[a.jsx(sp,{title:"Ventas",value:Si(g.revenue)}),a.jsx(sp,{title:"Costo",value:Si(g.cogsReal)}),a.jsx(sp,{title:"Ganancia Bruta",value:Si(g.grossProfit),positive:!0}),a.jsx(sp,{title:"Gastos",value:Si(g.expensesSum)}),a.jsx(sp,{title:"Ganancia Neta",value:Si(g.netProfit),positive:!0})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6 rounded-lg shadow-2xl p-3 sm:p-4 bg-gray-50",children:[a.jsx(rP,{title:"Libras Vendidas",value:Tf(O)}),a.jsx(rP,{title:"Unidades Vendidas",value:Tf(L)}),a.jsx(nle,{title:"Productos ms vendidos",items:B.map(_=>({key:`${_.idx}`,label:`${_.idx}. ${_.name}`,value:`(${Tf(_.units)})`}))})]}),a.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),a.jsx("div",{className:"hidden md:block",children:a.jsxs("table",{className:"min-w-full border text-sm mb-6",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Fechas"}),a.jsx("th",{className:"border p-2",children:"Total libras/unidades"}),a.jsx("th",{className:"border p-2",children:"Ingreso"}),a.jsx("th",{className:"border p-2",children:"Costo"}),a.jsx("th",{className:"border p-2",children:"Utilidad"})]})}),a.jsxs("tbody",{children:[E.map(_=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:_.productName}),a.jsx("td",{className:"border p-1",children:_.firstDate&&_.lastDate?_.firstDate===_.lastDate?_.firstDate:`${_.firstDate}  ${_.lastDate}`:""}),a.jsx("td",{className:"border p-1",children:Tf(_.units)}),a.jsx("td",{className:"border p-1",children:Si(_.revenue)}),a.jsx("td",{className:"border p-1",children:Si(_.cogs)}),a.jsx("td",{className:`border p-1 ${_.profit>=0?"text-green-700":"text-red-700"}`,children:Si(_.profit)})]},_.productName)),E.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin datos en el rango seleccionado."})})]})]})}),a.jsx("div",{className:"md:hidden space-y-2 mb-6",children:E.length===0?a.jsx("div",{className:"border rounded-xl p-3 text-sm text-gray-500 bg-gray-50",children:"Sin datos en el rango seleccionado."}):E.map(_=>{const F=!!f[_.productName],D=_.firstDate&&_.lastDate?_.firstDate===_.lastDate?_.firstDate:`${_.firstDate}  ${_.lastDate}`:"";return a.jsxs("div",{className:"border rounded-2xl bg-white shadow-sm overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>S(_.productName),className:"w-full text-left px-3 py-3 flex items-start gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-semibold truncate",children:_.productName}),a.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Total: ",a.jsx("b",{children:Tf(_.units)}),"  Utilidad:"," ",a.jsx("b",{className:_.profit>=0?"text-green-700":"text-red-700",children:Si(_.profit)})]})]}),a.jsx("div",{className:"text-gray-500 text-sm pt-0.5",children:F?"":""})]}),F&&a.jsx("div",{className:"px-3 pb-3 text-sm",children:a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx(Ac,{label:"Fechas",value:D}),a.jsx(Ac,{label:"Total",value:Tf(_.units)}),a.jsx(Ac,{label:"Ingreso",value:Si(_.revenue)}),a.jsx(Ac,{label:"Costo",value:Si(_.cogs)}),a.jsx(Ac,{label:"Utilidad",value:Si(_.profit),valueClass:_.profit>=0?"text-green-700 font-semibold":"text-red-700 font-semibold"})]})})]},_.productName)})}),a.jsx("h3",{className:"font-semibold mb-2",children:"Gastos del periodo"}),a.jsx("div",{className:"hidden md:block",children:a.jsxs("table",{className:"min-w-full border text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Fecha"}),a.jsx("th",{className:"border p-2",children:"Categora"}),a.jsx("th",{className:"border p-2",children:"Descripcin"}),a.jsx("th",{className:"border p-2",children:"Monto"}),a.jsx("th",{className:"border p-2",children:"Estado"})]})}),a.jsxs("tbody",{children:[c.map(_=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:_.date}),a.jsx("td",{className:"border p-1",children:_.category}),a.jsx("td",{className:"border p-1",children:_.description}),a.jsx("td",{className:"border p-1",children:Si(_.amount)}),a.jsx("td",{className:"border p-1",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${_.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:_.status})})]},_.id)),c.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"p-3 text-center text-gray-500",children:"Sin gastos en el rango seleccionado."})})]})]})}),a.jsx("div",{className:"md:hidden space-y-2",children:c.length===0?a.jsx("div",{className:"border rounded-xl p-3 text-sm text-gray-500 bg-gray-50",children:"Sin gastos en el rango seleccionado."}):c.map(_=>{const F=!!m[_.id],D=_.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700";return a.jsxs("div",{className:"border rounded-2xl bg-white shadow-sm overflow-hidden",children:[a.jsxs("button",{type:"button",onClick:()=>U(_.id),className:"w-full text-left px-3 py-3 flex items-start gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"font-semibold truncate",children:_.category}),a.jsx("span",{className:`px-2 py-0.5 rounded text-[11px] ${D}`,children:_.status})]}),a.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[_.date,"  ",a.jsx("b",{children:Si(_.amount)})]})]}),a.jsx("div",{className:"text-gray-500 text-sm pt-0.5",children:F?"":""})]}),F&&a.jsx("div",{className:"px-3 pb-3 text-sm",children:a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsx(Ac,{label:"Fecha",value:_.date}),a.jsx(Ac,{label:"Categora",value:_.category}),a.jsx(Ac,{label:"Descripcin",value:_.description||""}),a.jsx(Ac,{label:"Monto",value:Si(_.amount)}),a.jsx(Ac,{label:"Estado",value:_.status||""})]})})]},_.id)})})]})]})}function sp({title:t,value:e,positive:r}){return a.jsxs("div",{className:"border rounded-2xl p-3 bg-white",children:[a.jsx("div",{className:"text-[13px] sm:text-[17px] text-gray-500",children:t}),a.jsx("div",{className:`text-[26px] sm:text-[30px] font-bold ${r?"text-green-700":""}`,children:e})]})}function rP({title:t,value:e}){return a.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[a.jsx("div",{className:"text-[13px] sm:text-[17px] text-gray-500",children:t}),a.jsx("div",{className:"text-[18px] sm:text-[20px] font-semibold",children:e})]})}function nle({title:t,items:e}){return a.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[a.jsx("div",{className:"text-[11px] text-gray-500 mb-1",children:t}),a.jsx("ul",{className:"text-sm leading-snug list-none pl-0 m-0 space-y-0.5",children:e.length===0?a.jsx("li",{className:"text-gray-500",children:""}):e.map(r=>a.jsxs("li",{children:[r.label," ",r.value??""]},r.key))})]})}function Ac({label:t,value:e,valueClass:r}){return a.jsxs("div",{className:"border rounded-xl p-2 bg-gray-50",children:[a.jsx("div",{className:"text-[11px] text-gray-600",children:t}),a.jsx("div",{className:`text-sm mt-0.5 ${r||""}`,children:e})]})}const XN=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal","Varios"],ap=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function sle(){const{refreshKey:t,refresh:e}=vl(),[r,n]=N.useState(or(jc(new Date),"yyyy-MM-dd")),[s,i]=N.useState(or(Ic(new Date),"yyyy-MM-dd")),[o,l]=N.useState(or(new Date,"yyyy-MM-dd")),[c,d]=N.useState(""),[A,u]=N.useState(""),[f,h]=N.useState(0),[m,p]=N.useState("PENDIENTE"),[g,x]=N.useState(""),[b,w]=N.useState([]),[k,O]=N.useState(!0),[L,E]=N.useState(""),[B,S]=N.useState(null),[U,_]=N.useState(""),[F,D]=N.useState(""),[X,ge]=N.useState(""),[ae,fe]=N.useState(0),[me,Z]=N.useState("PENDIENTE"),[ye,Ie]=N.useState("");N.useEffect(()=>{(async()=>{O(!0),E("");try{const le=Dt(ht(Te,"expenses"),Ur("date","desc")),q=await Nt(le),Se=[];q.forEach(ee=>{const z=ee.data();Se.push({id:ee.id,date:z.date||or(new Date,"yyyy-MM-dd"),category:z.category||"",description:z.description||"",amount:Number(z.amount||0),status:z.status||"PENDIENTE",notes:z.notes||"",createdAt:z.createdAt??$t.now()})}),w(Se)}catch(le){console.error(le),E(" Error al cargar gastos")}finally{O(!1)}})()},[t]);const I=N.useMemo(()=>b.filter(le=>!(r&&le.date<r||s&&le.date>s)),[b,r,s]),j=N.useMemo(()=>{const le=I.reduce((ee,z)=>ee+(z.amount||0),0),q=I.filter(ee=>ee.status==="PAGADO").reduce((ee,z)=>ee+(z.amount||0),0),Se=le-q;return{total:le,pagado:q,pendiente:Se}},[I]),Q=()=>{l(or(new Date,"yyyy-MM-dd")),d(""),u(""),h(0),p("PENDIENTE"),x("")},T=async le=>{if(le.preventDefault(),E(""),!c)return E("Selecciona una categora.");if(!A.trim())return E("Ingresa una descripcin.");if(!f||f<=0)return E("Ingresa un monto vlido.");try{const q={date:o,category:c,description:A.trim(),amount:Number(Number(f||0).toFixed(2)),status:m,notes:g||"",createdAt:$t.now()},Se=await Jr(ht(Te,"expenses"),q);w(ee=>[{id:Se.id,...q},...ee]),Q(),E(" Gasto registrado")}catch(q){console.error(q),E(" Error al guardar gasto")}},R=le=>{E(""),S(le.id),_(le.date),D(le.category||""),ge(le.description||""),fe(Number(le.amount||0)),Z(le.status||"PENDIENTE"),Ie(le.notes||"")},K=()=>{S(null),_(""),D(""),ge(""),fe(0),Z("PENDIENTE"),Ie("")},M=async()=>{if(B){if(!F)return E("Selecciona una categora.");if(!X.trim())return E("Ingresa una descripcin.");if(!ae||ae<=0)return E("Ingresa un monto vlido.");try{const le={date:U,category:F,description:X.trim(),amount:Number(Number(ae||0).toFixed(2)),status:me,notes:ye||""};await Pr(kt(Te,"expenses",B),le),w(q=>q.map(Se=>Se.id===B?{...Se,...le}:Se)),K(),E(" Gasto actualizado")}catch(le){console.error(le),E(" Error al actualizar gasto")}}},re=async le=>{if(confirm(`Eliminar el gasto "${le.description}"?`))try{await un(kt(Te,"expenses",le.id)),w(Se=>Se.filter(ee=>ee.id!==le.id)),E(" Gasto borrado")}catch(Se){console.error(Se),E(" Error al borrar gasto")}},de=le=>le==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700";return a.jsxs("div",{className:"max-w-6xl mx-auto px-3 sm:px-0",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Gastos (Pollo)"}),a.jsx(Zl,{onClick:e,loading:k})]}),a.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-2xl border mb-4 flex flex-col sm:flex-row sm:items-end gap-3 text-sm",children:[a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:le=>n(le.target.value)})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s,onChange:le=>i(le.target.value)})]})]}),a.jsxs("div",{className:"sm:ml-auto text-sm bg-gray-50 border rounded-xl p-3",children:[a.jsx("div",{className:"font-semibold",children:"Totales del rango"}),a.jsxs("div",{children:["Total: ",ap(j.total)]}),a.jsxs("div",{children:["Pagado: ",ap(j.pagado)]}),a.jsxs("div",{children:["Pendiente: ",ap(j.pendiente)]})]})]}),a.jsxs("form",{onSubmit:T,className:"bg-white p-4 rounded-2xl shadow-2xl border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),a.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:o,onChange:le=>l(le.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:c,onChange:le=>d(le.target.value),children:[a.jsx("option",{value:"",children:"Selecciona"}),XN.map(le=>a.jsx("option",{value:le,children:le},le))]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),a.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:A,onChange:le=>u(le.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:f===0?"":f,onChange:le=>{const q=String(le.target.value||"").replace(",","."),Se=parseFloat(q);h(Number.isFinite(Se)?Math.max(0,Se):0)},placeholder:"0.00"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:le=>p(le.target.value),children:[a.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),a.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),a.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:g,onChange:le=>x(le.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),a.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[g.length,"/500"]})]}),a.jsxs("div",{className:"md:col-span-2 flex gap-2",children:[a.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"}),a.jsx("button",{type:"button",className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",onClick:Q,children:"Limpiar"})]})]}),a.jsx("div",{className:"block md:hidden space-y-3",children:k?a.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):I.length===0?a.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Sin gastos en el rango seleccionado."}):I.map(le=>{const q=B===le.id;return a.jsxs("div",{className:"bg-white border rounded-2xl shadow p-3",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{className:"text-sm",children:[a.jsx("div",{className:"font-semibold",children:le.description}),a.jsxs("div",{className:"text-xs text-gray-500",children:[le.category||"","  ",le.date]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"font-bold",children:ap(le.amount)}),a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${de(le.status)}`,children:le.status})]})]}),a.jsx("div",{className:"mt-2 text-xs text-gray-600",children:le.notes?le.notes:""}),q?a.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-2 text-sm",children:[a.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:U,onChange:Se=>_(Se.target.value)}),a.jsxs("select",{className:"w-full border p-2 rounded",value:F,onChange:Se=>D(Se.target.value),children:[a.jsx("option",{value:"",children:"Selecciona"}),XN.map(Se=>a.jsx("option",{value:Se,children:Se},Se))]}),a.jsx("input",{className:"w-full border p-2 rounded",value:X,onChange:Se=>ge(Se.target.value)}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:Number.isNaN(ae)?"":ae,onChange:Se=>{const ee=String(Se.target.value||"").replace(",","."),z=parseFloat(ee);fe(Number.isFinite(z)?Math.max(0,z):0)}}),a.jsxs("select",{className:"w-full border p-2 rounded",value:me,onChange:Se=>Z(Se.target.value),children:[a.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),a.jsx("option",{value:"PAGADO",children:"Pagado"})]}),a.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:ye,onChange:Se=>Ie(Se.target.value),maxLength:500}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:M,children:"Guardar"}),a.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:K,children:"Cancelar"})]})]}):a.jsxs("div",{className:"mt-3 flex gap-2",children:[a.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>R(le),children:"Editar"}),a.jsx("button",{type:"button",className:"flex-1 px-3 py-2 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>re(le),children:"Borrar"})]})]},le.id)})}),a.jsx("div",{className:"hidden md:block bg-white p-2 rounded-2xl shadow-2xl border w-full",children:a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Categora"}),a.jsx("th",{className:"p-2 border",children:"Descripcin"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Estado"}),a.jsx("th",{className:"p-2 border",children:"Comentario"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:k?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):I.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):I.map(le=>{const q=B===le.id;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:q?a.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:U,onChange:Se=>_(Se.target.value)}):le.date}),a.jsx("td",{className:"p-2 border",children:q?a.jsxs("select",{className:"w-full border p-1 rounded",value:F,onChange:Se=>D(Se.target.value),children:[a.jsx("option",{value:"",children:"Selecciona"}),XN.map(Se=>a.jsx("option",{value:Se,children:Se},Se))]}):le.category||""}),a.jsx("td",{className:"p-2 border",children:q?a.jsx("input",{className:"w-full border p-1 rounded",value:X,onChange:Se=>ge(Se.target.value)}):a.jsx("span",{title:le.description,children:le.description.length>45?le.description.slice(0,45)+"":le.description})}),a.jsx("td",{className:"p-2 border",children:q?a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(ae)?"":ae,onChange:Se=>{const ee=String(Se.target.value||"").replace(",","."),z=parseFloat(ee);fe(Number.isFinite(z)?Math.max(0,z):0)}}):ap(le.amount)}),a.jsx("td",{className:"p-2 border",children:q?a.jsxs("select",{className:"w-full border p-1 rounded",value:me,onChange:Se=>Z(Se.target.value),children:[a.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),a.jsx("option",{value:"PAGADO",children:"Pagado"})]}):a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${de(le.status)}`,children:le.status})}),a.jsx("td",{className:"p-2 border",children:q?a.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:ye,onChange:Se=>Ie(Se.target.value),maxLength:500}):a.jsx("span",{title:le.notes||"",children:(le.notes||"").length>45?(le.notes||"").slice(0,45)+"":le.notes||""})}),a.jsx("td",{className:"p-2 border",children:a.jsx("div",{className:"flex gap-2 justify-center",children:q?a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:M,children:"Guardar"}),a.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:K,children:"Cancelar"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>R(le),children:"Editar"}),a.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>re(le),children:"Borrar"})]})})})]},le.id)})})]})}),L&&a.jsx("p",{className:"mt-2 text-sm",children:L})]})}function Eb(t){return(t||"").trim().toLowerCase()}async function s8(){const t=await Nt(ht(Te,"products")),e=new Map;return t.forEach(r=>{const n=r.data(),s=Eb(n.name??n.productName);s&&e.set(s,r.id)}),e}async function ale(t=!1){const e=await s8(),r=await Nt(ht(Te,"inventory_batches")),n={checked:0,fixed:0,alreadyOk:0,missingName:0,withoutMatch:0,details:[]};for(const s of r.docs){n.checked++;const i=s.data(),o=Eb(i.productName);if(!o){n.missingName++,n.details.push({batchId:s.id,productName:i.productName??"",oldProductId:i.productId,status:"missingName"});continue}const l=e.get(o);if(!l){n.withoutMatch++,n.details.push({batchId:s.id,productName:i.productName??"",oldProductId:i.productId,status:"withoutMatch"});continue}if(i.productId===l){n.alreadyOk++,n.details.push({batchId:s.id,productName:i.productName??"",oldProductId:i.productId,newProductId:l,status:"alreadyOk"});continue}t||await Pr(kt(Te,"inventory_batches",s.id),{productId:l}),n.fixed++,n.details.push({batchId:s.id,productName:i.productName??"",oldProductId:i.productId,newProductId:l,status:"fixed"})}return console.group("[fixAllBatchProductIds] Resultado"),console.log("checked:",n.checked),console.log("fixed:",n.fixed),console.log("alreadyOk:",n.alreadyOk),console.log("missingName:",n.missingName),console.log("withoutMatch:",n.withoutMatch),console.groupEnd(),n}async function ile(t,e=!1){const r=Eb(t),s=(await s8()).get(r);if(!s)throw new Error(`No existe un producto activo con nombre "${t}".`);const i=await Nt(ht(Te,"inventory_batches"));let o=0;for(const l of i.docs){const c=l.data();Eb(c.productName)===r&&c.productId!==s&&(e||await Pr(kt(Te,"inventory_batches",l.id),{productId:s}),o++)}return console.log(`[fixBatchesByProductName] "${t}" fixed: ${o} lote(s)`),o}function ole(){const[t,e]=N.useState(!1),[r,n]=N.useState(""),s=async()=>{try{e(!0),n("");const c=await ale(!1);n(` Hecho. Revisados: ${c.checked}, Corregidos: ${c.fixed}, Ok: ${c.alreadyOk}, Sin nombre: ${c.missingName}, Sin match: ${c.withoutMatch}. (Mira consola para detalles)`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}},[i,o]=N.useState(""),l=async()=>{if(!i.trim()){n(" Escribe el nombre del producto.");return}try{e(!0),n("");const c=await ile(i.trim(),!1);n(` Hecho. Corregidos ${c} lote(s) para "${i}".`)}catch(c){n(" Error: "+((c==null?void 0:c.message)||c))}finally{e(!1)}};return a.jsxs("div",{className:"max-w-xl mx-auto bg-white p-6 rounded shadow border space-y-4",children:[a.jsx("h1",{className:"text-xl font-bold",children:"Herramienta de Migracin de Lotes"}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Corrige los ",a.jsx("code",{children:"inventory_batches.productId"})," basndose en el nombre del producto. salo una sola vez para limpiar datos viejos. Revisa la consola para un log detallado."]}),a.jsx("div",{className:"space-y-2",children:a.jsx("button",{onClick:s,disabled:t,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir TODOS los lotes"})}),a.jsx("hr",{}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Corregir por nombre:"}),a.jsx("input",{className:"border p-2 rounded w-full",placeholder:'Ej: "Pierna Entera"',value:i,onChange:c=>o(c.target.value)}),a.jsx("button",{onClick:l,disabled:t,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-60",children:t?"Corriendo":"Corregir lotes de ese producto"})]}),r&&a.jsx("p",{className:"text-sm",children:r})]})}const Yn=t=>`C$ ${Number(t??0).toFixed(2)}`,Uu=t=>Number(t??0).toFixed(3);async function lle(t){const e=new Set;for(const n of t)for(const s of n.batches||[]){const i=(s.batchId||s.id||"").trim();if(!i)continue;(s.purchasePrice===void 0||s.purchasePrice===null)&&(s.invoiceTotal===void 0||s.invoiceTotal===null)&&e.add(i)}if(e.size===0)return t;const r=new Map;return await Promise.all(Array.from(e).map(async n=>{try{const s=await Ya(kt(Te,"inventory_batches",n));if(s.exists()){const i=s.data();r.set(n,Number(i.purchasePrice||0))}}catch{}})),t.map(n=>({...n,batches:(n.batches||[]).map(s=>{if((s.purchasePrice===void 0||s.purchasePrice===null)&&(s.invoiceTotal===void 0||s.invoiceTotal===null)){const i=(s.batchId||s.id||"").trim(),o=i?r.get(i):void 0;if(o!==void 0)return{...s,purchasePrice:o}}return s})}))}function YN(t){var p,g;const e=t.batches||[],r=t.expenses||[],n=t.adjustments||[],s=Number(((p=t.totals)==null?void 0:p.lbs)??t.totalLbs??0),i=Number(((g=t.totals)==null?void 0:g.units)??t.totalUnits??0);let o=0,l=0;for(const x of e){const b=Number(x.quantity??0);let w=x.expectedTotal!==void 0&&x.expectedTotal!==null?Number(x.expectedTotal):b*Number(x.salePrice??0);isFinite(w)||(w=0);let k=b*Number(x.purchasePrice??Number.NaN);isFinite(k)||(k=x.invoiceTotal!==void 0&&x.invoiceTotal!==null?Number(x.invoiceTotal):0),o+=w,l+=k}const c=r.reduce((x,b)=>x+Number(b.amount||0),0),d=n.filter(x=>x.type==="DEBITO").reduce((x,b)=>x+Number(b.amount||0),0),A=n.filter(x=>x.type==="CREDITO").reduce((x,b)=>x+Number(b.amount||0),0),u=t.totalDebits!==void 0?Number(t.totalDebits):d,f=t.totalCredits!==void 0?Number(t.totalCredits):A,h=o-l,m=o-c-u+f;return{lbs:s,units:i,expectedSum:o,invoicedSum:l,expenses:c,debits:u,credits:f,grossProfit:h,finalAmount:m}}function cle(){const[t,e]=N.useState([]),[r,n]=N.useState(!0),[s,i]=N.useState(null),o=N.useRef(null);N.useEffect(()=>{(async()=>{n(!0);const A=Dt(ht(Te,"invoices"),Ur("date","desc")),u=await Nt(A),f=[];u.forEach(m=>{const p=m.data();f.push({id:m.id,...p,batches:p.batches||[],expenses:p.expenses||[],adjustments:p.adjustments||[],totals:p.totals||{lbs:p.totalLbs||0,units:p.totalUnits||0,amount:p.totalAmount||0,expenses:p.totalExpenses||0,finalAmount:p.finalAmount||0,invoiceTotal:p.invoiceTotal||0},totalDebits:p.totalDebits||0,totalCredits:p.totalCredits||0})});const h=await lle(f);e(h),n(!1)})()},[]);const l=async A=>{const u=A.status==="PAGADA"?"PENDIENTE":"PAGADA";await Pr(kt(Te,"invoices",A.id),{status:u}),e(f=>f.map(h=>h.id===A.id?{...h,status:u}:h)),(s==null?void 0:s.id)===A.id&&i({...A,status:u})},c=async A=>{if(window.confirm(`Eliminar factura del ${A.date}?`))try{const u=kt(Te,"invoices",A.id),f=await Ya(u),h=f.exists()?f.data():null,m=Xh(Te),p=(h==null?void 0:h.batches)||[];for(const g of p){const x=g.batchId||g.id;if(!x)continue;const b=kt(Te,"inventory_batches",x);m.update(b,{invoiceId:null,invoiceNumber:null,invoiceTotal:null})}m.delete(u),await m.commit(),e(g=>g.filter(x=>x.id!==A.id)),(s==null?void 0:s.id)===A.id&&i(null)}catch(u){console.error(u),alert("No se pudo eliminar la factura por completo.")}},d=async()=>{if(!o.current||!s)return;const A=o.current,u=await Yh(A,{backgroundColor:"#ffffff",onclone:g=>{const x=g.body;x.style.background="#ffffff",x.querySelectorAll("*").forEach(b=>{const w=g.defaultView.getComputedStyle(b);w.boxShadow&&w.boxShadow!=="none"&&(b.style.boxShadow="none")})},scale:2}),f=u.toDataURL("image/png"),h=new cr("p","mm","a4"),m=h.internal.pageSize.getWidth(),p=u.height*m/u.width;h.addImage(f,"PNG",0,0,m,p),h.save(`factura_${s.number||s.date}.pdf`)};return a.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Facturacin"}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4",children:a.jsxs("table",{className:"min-w-full w-full- text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"N factura"}),a.jsx("th",{className:"p-2 border",children:"Descripcin"}),a.jsx("th",{className:"p-2 border",children:"Libras"}),a.jsx("th",{className:"p-2 border",children:"Unidades"}),a.jsx("th",{className:"p-2 border",children:"Facturado"}),a.jsx("th",{className:"p-2 border",children:"Ventas"}),a.jsx("th",{className:"p-2 border",children:"Gastos"}),a.jsx("th",{className:"p-2 border",children:"Dbitos"}),a.jsx("th",{className:"p-2 border",children:"Crditos"}),a.jsx("th",{className:"p-2 border",children:"Monto final"}),a.jsx("th",{className:"p-2 border",children:"Estado"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{colSpan:13,className:"p-4 text-center",children:"Cargando"})}):t.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:13,className:"p-4 text-center",children:"Sin facturas"})}):t.map(A=>{const u=YN(A);return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:A.date}),a.jsx("td",{className:"p-2 border",children:A.number||""}),a.jsx("td",{className:"p-2 border",children:A.description||""}),a.jsx("td",{className:"p-2 border",children:Uu(u.lbs)}),a.jsx("td",{className:"p-2 border",children:Uu(u.units)}),a.jsx("td",{className:"p-2 border",children:Yn(u.invoicedSum)}),a.jsx("td",{className:"p-2 border",children:Yn(u.expectedSum)}),a.jsx("td",{className:"p-2 border",children:Yn(u.expenses)}),a.jsx("td",{className:"p-2 border",children:Yn(u.debits)}),a.jsx("td",{className:"p-2 border",children:Yn(u.credits)}),a.jsx("td",{className:"p-2 border",children:Yn(u.finalAmount)}),a.jsx("td",{className:"p-2 border",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${A.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:A.status})}),a.jsx("td",{className:"p-2 border",children:a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>i(A),children:"Ver"}),a.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>l(A),children:A.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),a.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>c(A),children:"Eliminar"})]})})]},A.id)})})]})}),s&&a.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",s.date," ",s.number?` ${s.number}`:""]}),a.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>i(null),children:"Cerrar"}),a.jsx("button",{onClick:d,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const A=YN(s);return a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Estado:"})," ",s.status]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Libras:"})," ",Uu(A.lbs)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Unidades:"})," ",Uu(A.units)]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Monto Facturado:"})," ",Yn(A.invoicedSum)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Monto Ventas (Esperado):"})," ",Yn(A.expectedSum)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Ganancia Bruta:"})," ",Yn(A.grossProfit)]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",Yn(A.expenses)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",Yn(A.debits)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",Yn(A.credits)]})]})]})})(),a.jsx("h4",{className:"font-semibold mb-1",children:"Lotes"}),a.jsxs("table",{className:"min-w-full text-sm mb-4 shadow-2xl",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"Unidad"}),a.jsx("th",{className:"p-2 border",children:"Cantidad"}),a.jsx("th",{className:"p-2 border",children:"Precio venta"}),a.jsx("th",{className:"p-2 border",children:"Total facturado"}),a.jsx("th",{className:"p-2 border",children:"Total esperado"}),a.jsx("th",{className:"p-2 border",children:"Ganancia bruta"})]})}),a.jsx("tbody",{children:(s.batches||[]).map((A,u)=>{const f=Number(A.quantity??0),h=A.expectedTotal!==void 0&&A.expectedTotal!==null?Number(A.expectedTotal):f*Number(A.salePrice??0);let m=f*Number(A.purchasePrice??Number.NaN);isFinite(m)||(m=A.invoiceTotal!==void 0&&A.invoiceTotal!==null?Number(A.invoiceTotal):0);const p=h-m;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:A.productName||"(sin nombre)"}),a.jsx("td",{className:"p-2 border",children:(A.unit||"").toUpperCase()}),a.jsx("td",{className:"p-2 border",children:Uu(A.quantity)}),a.jsx("td",{className:"p-2 border",children:Yn(A.salePrice)}),a.jsx("td",{className:"p-2 border",children:Yn(m)}),a.jsx("td",{className:"p-2 border",children:Yn(h)}),a.jsx("td",{className:"p-2 border",children:Yn(p)})]},u)})})]}),a.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),a.jsxs("table",{className:"min-w-full text-sm shadow-xl mb-4",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Descripcin"}),a.jsx("th",{className:"p-2 border",children:"Monto"})]})}),a.jsx("tbody",{children:(s.expenses||[]).length>0?(s.expenses||[]).map((A,u)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:A.date}),a.jsx("td",{className:"p-2 border",children:A.description}),a.jsx("td",{className:"p-2 border",children:Yn(A.amount)})]},u)):a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500",children:"Sin gastos"})})})]}),a.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),a.jsxs("table",{className:"min-w-full text-sm shadow-xl mb-4",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Descripcin"}),a.jsx("th",{className:"p-2 border",children:"Tipo de cargo"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Fecha"})]})}),a.jsx("tbody",{children:(s.adjustments||[]).length>0?(s.adjustments||[]).map((A,u)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:A.description}),a.jsx("td",{className:"p-2 border",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${A.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:A.type})}),a.jsx("td",{className:"p-2 border",children:Yn(A.amount)}),a.jsx("td",{className:"p-2 border",children:s.date})]},u)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin cargos extras"})})})]}),(()=>{const A=YN(s);return a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:["Total libras: ",a.jsx("strong",{children:Uu(A.lbs)})]}),a.jsxs("div",{children:["Total unidades: ",a.jsx("strong",{children:Uu(A.units)})]})]}),a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsxs("div",{children:["Total facturado (costo):"," ",a.jsx("strong",{children:Yn(A.invoicedSum)})]}),a.jsxs("div",{children:["Total esperado (ventas):"," ",a.jsx("strong",{children:Yn(A.expectedSum)})]}),a.jsxs("div",{children:["Ganancia bruta (esperado  facturado):"," ",a.jsx("strong",{children:Yn(A.grossProfit)})]})]}),a.jsxs("div",{className:"space-y-1 text-right",children:[a.jsxs("div",{children:["Gastos: ",a.jsx("strong",{children:Yn(A.expenses)})]}),a.jsxs("div",{children:["Dbitos: ",a.jsx("strong",{children:Yn(A.debits)})]}),a.jsxs("div",{children:["Crditos: ",a.jsx("strong",{children:Yn(A.credits)})]})]}),a.jsx("div",{className:"md:col-span-3 mt-3",children:a.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[a.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Monto final (esperado  gastos  dbitos + crditos):"}),a.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:Yn(A.finalAmount)})]})})]})})()]})]})}const vo=t=>`C$${Number(t||0).toFixed(2)}`,Pf=t=>Number(t||0).toFixed(3),dle=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase()),ZN=()=>{const t=new Date;return or(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},y1=()=>or(new Date,"yyyy-MM-dd");function Ale({paidBatches:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[s,i]=N.useState(ZN()),[o,l]=N.useState(y1()),[c,d]=N.useState(""),A=N.useMemo(()=>{const ve=new Map;return n.forEach(ie=>ve.set(ie.productId,{id:ie.productId,name:ie.productName})),Array.from(ve.values()).sort((ie,ze)=>ie.name.localeCompare(ze.name))},[n]),u=N.useMemo(()=>n.filter(ve=>!(s&&ve.date<s||o&&ve.date>o||c&&ve.productId!==c)),[n,s,o,c]),[f,h]=N.useState(y1()),[m,p]=N.useState(()=>`FAC-${Date.now().toString().slice(-6)}`),[g,x]=N.useState(""),[b,w]=N.useState([]);N.useEffect(()=>{w(ve=>{const ie=ve.filter(ze=>u.some(rt=>rt.id===ze));return ie.length===0&&u.length>0?u.map(ze=>ze.id):ie})},[u]);const[k,O]=N.useState([]),[L,E]=N.useState([]),[B,S]=N.useState(!1),[U,_]=N.useState(ZN()),[F,D]=N.useState(y1());N.useEffect(()=>{(async()=>{try{S(!0);const ve=Dt(ht(Te,"expenses"),Ur("date","desc")),ie=await Nt(ve),ze=[];ie.forEach(rt=>{const At=rt.data();ze.push({id:rt.id,date:At.date,description:At.description,amount:Number(At.amount||0)})}),O(ze)}catch(ve){console.error(ve)}finally{S(!1)}})()},[]);const X=N.useMemo(()=>k.filter(ve=>!(!ve.date||U&&ve.date<U||F&&ve.date>F)),[k,U,F]),[ge,ae]=N.useState([]),[fe,me]=N.useState(!1),[Z,ye]=N.useState(""),[Ie,I]=N.useState("DEBITO"),[j,Q]=N.useState(""),T=()=>{const ve=Number(j);!Z.trim()||!isFinite(ve)||ve<=0||(ae(ie=>[...ie,{id:`${Date.now()}_${ie.length+1}`,description:Z.trim(),type:Ie,amount:Number(ve.toFixed(2))}]),ye(""),Q(""))},[R,K]=N.useState(null),[M,re]=N.useState(""),[de,le]=N.useState("DEBITO"),[q,Se]=N.useState(""),ee=ve=>{K(ve.id),re(ve.description),le(ve.type),Se(ve.amount.toFixed(2))},z=()=>{K(null),re(""),le("DEBITO"),Se("")},te=()=>{if(!R)return;const ve=Number(q);!isFinite(ve)||ve<=0||(ae(ie=>ie.map(ze=>ze.id===R?{...ze,description:M.trim(),type:de,amount:Number(ve.toFixed(2))}:ze)),z())},Ne=ve=>{ae(ie=>ie.filter(ze=>ze.id!==ve)),R===ve&&z()},Y=(ve,ie)=>{w(ze=>ie?[...new Set([...ze,ve])]:ze.filter(rt=>rt!==ve))},we=ve=>{w(ve?u.map(ie=>ie.id):[])},Pe=(ve,ie)=>{E(ze=>ie?[...new Set([...ze,ve])]:ze.filter(rt=>rt!==ve))},Qe=N.useMemo(()=>u.filter(ve=>b.includes(ve.id)),[u,b]),tt=N.useMemo(()=>ge.filter(ve=>ve.type==="DEBITO").reduce((ve,ie)=>ve+ie.amount,0),[ge]),ot=N.useMemo(()=>ge.filter(ve=>ve.type==="CREDITO").reduce((ve,ie)=>ve+ie.amount,0),[ge]),dt=N.useMemo(()=>{let ve=0,ie=0,ze=0,rt=0;for(const at of Qe){dle(at.unit)?ve+=Number(at.quantity||0):ie+=Number(at.quantity||0);const Ve=at.expectedTotal??Number((Number(at.quantity||0)*Number(at.salePrice||0)).toFixed(2)),G=at.invoiceTotal!==void 0&&at.invoiceTotal!==null?Number(at.invoiceTotal):Number((Number(at.quantity||0)*Number(at.purchasePrice||0)).toFixed(2));ze+=Number(Ve||0),rt+=Number(G||0)}const At=X.filter(at=>L.includes(at.id)).reduce((at,Ve)=>at+Number(Ve.amount||0),0),Oe=ze-At-tt+ot;return{totalLbs:ve,totalUnits:ie,totalExpected:Number(ze.toFixed(2)),totalInvoiced:Number(rt.toFixed(2)),totalGastos:Number(At.toFixed(2)),debits:Number(tt.toFixed(2)),credits:Number(ot.toFixed(2)),finalAmount:Number(Oe.toFixed(2)),grossProfit:Number((ze-rt).toFixed(2))}},[Qe,X,L,tt,ot]),[vt,lt]=N.useState(!1),[Ue,Xe]=N.useState(""),xe=async()=>{if(Xe(""),Qe.length===0){Xe("Selecciona al menos 1 lote pagado.");return}try{lt(!0);const ve={number:m.trim(),date:f,description:g.trim(),status:"PENDIENTE",createdAt:$t.now(),totalLbs:Number(Pf(dt.totalLbs)),totalUnits:Number(Pf(dt.totalUnits)),totalAmount:dt.totalExpected,invoiceTotal:dt.totalInvoiced,totalExpenses:dt.totalGastos,totalDebits:dt.debits,totalCredits:dt.credits,finalAmount:dt.finalAmount,batches:Qe.map(ie=>{var ze;return{id:ie.id,productId:ie.productId,productName:ie.productName,unit:ie.unit,quantity:Number(Pf(ie.quantity)),salePrice:Number(Number(ie.salePrice||0).toFixed(2)),purchasePrice:Number(Number(ie.purchasePrice||0).toFixed(2)),expectedTotal:Number((Number(ie.quantity||0)*Number(ie.salePrice||0)).toFixed(2)),invoiceTotal:ie.invoiceTotal!==void 0&&ie.invoiceTotal!==null?Number(ie.invoiceTotal):Number((Number(ie.quantity||0)*Number(ie.purchasePrice||0)).toFixed(2)),batchDate:ie.date,paidAt:(ze=ie.paidAt)!=null&&ze.toDate?or(ie.paidAt.toDate(),"yyyy-MM-dd"):null}}),expenses:X.filter(ie=>L.includes(ie.id)).map(ie=>({id:ie.id,date:ie.date||null,description:ie.description||"",amount:Number(Number(ie.amount||0).toFixed(2))})),adjustments:ge.map(ie=>({id:ie.id,description:ie.description,type:ie.type,amount:Number(ie.amount.toFixed(2))}))};await Jr(ht(Te,"invoices"),ve),Xe(" Factura creada."),r()}catch(ve){console.error(ve),Xe(` Error al crear factura: ${(ve==null?void 0:ve.message)||"desconocido"}`)}finally{lt(!1)}};return a.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[a.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura"}),a.jsx("button",{type:"button",onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),a.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:f,onChange:ve=>h(ve.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),a.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:m,onChange:ve=>p(ve.target.value),placeholder:"FAC-001"})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),a.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:g,onChange:ve=>x(ve.target.value),placeholder:"Comentarios de la factura"})]})]}),a.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:a.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Desde (lote)"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s,onChange:ve=>i(ve.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Hasta (lote)"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:o,onChange:ve=>l(ve.target.value)})]}),a.jsxs("div",{className:"min-w-[220px]",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),a.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:c,onChange:ve=>d(ve.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),A.map(ve=>a.jsx("option",{value:ve.id,children:ve.name},ve.id))]})]}),a.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{i(ZN()),l(y1()),d("")},children:"Quitar filtro"})]})}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("h4",{className:"font-semibold",children:"Lotes pagados"}),a.jsxs("label",{className:"text-sm flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:u.length>0&&b.length===u.length,onChange:ve=>we(ve.target.checked)}),"Seleccionar todos (sobre el filtro)"]})]}),u.length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"No hay lotes pagados disponibles en el filtro actual."}):a.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Sel"}),a.jsx("th",{className:"p-2 border",children:"Fecha lote"}),a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"Unidad"}),a.jsx("th",{className:"p-2 border",children:"Cantidad"}),a.jsx("th",{className:"p-2 border",children:"Precio venta"}),a.jsx("th",{className:"p-2 border",children:"Total facturado"}),a.jsx("th",{className:"p-2 border",children:"Total esperado"}),a.jsx("th",{className:"p-2 border",children:"Ganancia bruta"}),a.jsx("th",{className:"p-2 border",children:"Fecha pago"})]})}),a.jsx("tbody",{children:u.map(ve=>{var Oe;const ie=b.includes(ve.id),ze=ve.expectedTotal??Number((Number(ve.quantity||0)*Number(ve.salePrice||0)).toFixed(2)),rt=ve.invoiceTotal!==void 0&&ve.invoiceTotal!==null?Number(ve.invoiceTotal):Number((Number(ve.quantity||0)*Number(ve.purchasePrice||0)).toFixed(2)),At=ze-rt;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"checkbox",checked:ie,onChange:at=>Y(ve.id,at.target.checked)})}),a.jsx("td",{className:"p-2 border",children:ve.date}),a.jsx("td",{className:"p-2 border",children:ve.productName}),a.jsx("td",{className:"p-2 border",children:(ve.unit||"").toUpperCase()}),a.jsx("td",{className:"p-2 border",children:Pf(ve.quantity)}),a.jsx("td",{className:"p-2 border",children:vo(ve.salePrice)}),a.jsx("td",{className:"p-2 border",children:vo(rt)}),a.jsx("td",{className:"p-2 border",children:vo(ze)}),a.jsx("td",{className:"p-2 border",children:vo(At)}),a.jsx("td",{className:"p-2 border",children:(Oe=ve.paidAt)!=null&&Oe.toDate?or(ve.paidAt.toDate(),"yyyy-MM-dd"):""})]},ve.id)})})]})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),B&&a.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),a.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:U,onChange:ve=>_(ve.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:F,onChange:ve=>D(ve.target.value)})]})]})]}),X.length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):a.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Sel"}),a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Descripcin"}),a.jsx("th",{className:"p-2 border",children:"Monto"})]})}),a.jsx("tbody",{children:X.map(ve=>{const ie=L.includes(ve.id);return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"checkbox",checked:ie,onChange:ze=>Pe(ve.id,ze.target.checked)})}),a.jsx("td",{className:"p-2 border",children:ve.date||""}),a.jsx("td",{className:"p-2 border",children:ve.description||""}),a.jsx("td",{className:"p-2 border",children:vo(Number(ve.amount||0))})]},ve.id)})})]})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),a.jsx("button",{type:"button",className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>me(!0),children:"Crear Cargo"})]}),ge.length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):a.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Descripcin"}),a.jsx("th",{className:"p-2 border",children:"Tipo"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:ge.map(ve=>{const ie=R===ve.id;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:ie?a.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:M,onChange:ze=>re(ze.target.value)}):a.jsx("span",{title:ve.description,children:ve.description.length>60?`${ve.description.slice(0,60)}`:ve.description})}),a.jsx("td",{className:"p-2 border",children:ie?a.jsxs("select",{className:"w-full border rounded px-2 py-1",value:de,onChange:ze=>le(ze.target.value),children:[a.jsx("option",{value:"DEBITO",children:"Dbito"}),a.jsx("option",{value:"CREDITO",children:"Crdito"})]}):a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${ve.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:ve.type})}),a.jsx("td",{className:"p-2 border",children:ie?a.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:q,onChange:ze=>Se(ze.target.value)}):vo(ve.amount)}),a.jsx("td",{className:"p-2 border",children:ie?a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:te,children:"Guardar"}),a.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:z,children:"Cancelar"}),a.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Ne(ve.id),children:"Eliminar"})]}):a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>ee(ve),children:"Editar"}),a.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Ne(ve.id),children:"Eliminar"})]})})]},ve.id)})})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:["Total libras: ",a.jsx("strong",{children:Pf(dt.totalLbs)})]}),a.jsxs("div",{children:["Total unidades: ",a.jsx("strong",{children:Pf(dt.totalUnits)})]})]}),a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsxs("div",{children:["Total facturado (costo):"," ",a.jsx("strong",{children:vo(dt.totalInvoiced)})]}),a.jsxs("div",{children:["Total esperado (ventas):"," ",a.jsx("strong",{children:vo(dt.totalExpected)})]}),a.jsxs("div",{children:["Ganancia bruta (esperado  facturado):"," ",a.jsx("strong",{children:vo(dt.grossProfit)})]})]}),a.jsxs("div",{className:"space-y-1 text-right",children:[a.jsxs("div",{children:["Gastos: ",a.jsx("strong",{children:vo(dt.totalGastos)})]}),a.jsxs("div",{children:["Dbitos: ",a.jsx("strong",{children:vo(dt.debits)})]}),a.jsxs("div",{children:["Crditos: ",a.jsx("strong",{children:vo(dt.credits)})]})]}),a.jsx("div",{className:"md:col-span-3 mt-3",children:a.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (esperado  gastos  dbitos + crditos):"," ",a.jsx("span",{className:"text-blue-700",children:vo(dt.finalAmount)})]})})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",disabled:vt,onClick:xe,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:vt?"Creando":"Crear factura"}),a.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),Ue&&a.jsx("span",{className:"text-sm ml-2",children:Ue})]}),vt&&a.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[a.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),a.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),fe&&a.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:a.jsxs("div",{className:"bg-white w-full max-w-lg rounded-xl shadow-xl p-4",children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),a.jsx("button",{type:"button",className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>me(!1),children:"Cerrar"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),a.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:Z,onChange:ve=>ye(ve.target.value),placeholder:"Detalle del cargo"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),a.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Ie,onChange:ve=>I(ve.target.value),children:[a.jsx("option",{value:"DEBITO",children:"Dbito"}),a.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),a.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:j,onChange:ve=>Q(ve.target.value),placeholder:"0.00"})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:T,children:"Agregar"})})]})]})})]})}const Yc=t=>`C$ ${Number(t||0).toFixed(2)}`,AA=t=>Number(t||0).toFixed(3),ule=t=>(t||"").toLowerCase()==="lb"||/libra/.test((t||"").toLowerCase());function hle(){const[t,e]=N.useState([]),[r,n]=N.useState(!0),[s,i]=N.useState(!1),[o,l]=N.useState(null),[c,d]=N.useState(or(new Date(new Date().getFullYear(),new Date().getMonth(),1),"yyyy-MM-dd")),[A,u]=N.useState(or(new Date,"yyyy-MM-dd")),[f,h]=N.useState(""),[m,p]=N.useState(!1),{refreshKey:g,refresh:x}=vl();N.useEffect(()=>{(async()=>{n(!0);const E=Dt(ht(Te,"inventory_batches"),Gt("status","==","PAGADO"),Ur("date","desc")),B=await Nt(E),S=[];B.forEach(U=>{const _=U.data(),F=Number(_.quantity||0),D=Number(_.remaining||0),X=Number(_.purchasePrice||0),ge=Number(_.salePrice||0),ae=Number((F*X).toFixed(2)),fe=Number((F*ge).toFixed(2));S.push({id:U.id,productId:_.productId,productName:_.productName,category:_.category,unit:_.unit,quantity:F,remaining:D,purchasePrice:X,salePrice:ge,invoiceTotal:_.invoiceTotal!=null?Number(_.invoiceTotal):ae,expectedTotal:_.expectedTotal!=null?Number(_.expectedTotal):fe,date:_.date,status:_.status,paidAt:_.paidAt})}),e(S),n(!1)})()},[g]);const b=N.useMemo(()=>t.filter(E=>!(c&&E.date<c||A&&E.date>A||f&&E.productId!==f)),[t,c,A,f]),w=N.useMemo(()=>{let E=0,B=0,S=0,U=0,_=0,F=0;for(const D of b)ule(D.unit)?(E+=D.quantity,B+=D.remaining):(S+=D.quantity,U+=D.remaining),_+=Number(D.expectedTotal||0),F+=Number(D.invoiceTotal||0);return{lbsIng:E,lbsRem:B,udsIng:S,udsRem:U,totalEsperado:_,totalFact:F,gross:_-F}},[b]),k=E=>{l(E),i(!0)},O=async()=>{if(o)try{const E=kt(Te,"inventory_batches",o.id);await Pr(E,{status:"PENDIENTE",remaining:o.quantity});const B=ht(Te,"salesV2"),S=await Nt(Dt(B,Gt("batchId","==",o.id))),U=await Nt(Dt(B,Gt("productName","==",o.productName),Gt("date","==",o.date))),_=[...S.docs,...U.docs];for(const F of _)await un(kt(Te,"salesV2",F.id));i(!1),l(null),x()}catch(E){console.error("Error al marcar pendiente:",E)}},L=N.useMemo(()=>{const E=new Map;return t.forEach(B=>E.set(B.productId,{id:B.productId,name:B.productName})),Array.from(E.values()).sort((B,S)=>B.name.localeCompare(S.name))},[t]);return a.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-0",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Pagados"}),a.jsx(Zl,{onClick:x,loading:r})]}),a.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-2xl border mb-4 flex flex-col sm:flex-row sm:items-end gap-3 text-sm",children:[a.jsxs("div",{className:"flex flex-wrap gap-3",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:E=>d(E.target.value)})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:A,onChange:E=>u(E.target.value)})]}),a.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[a.jsx("label",{className:"font-semibold",children:"Producto"}),a.jsxs("select",{className:"border rounded px-2 py-1",value:f,onChange:E=>h(E.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),L.map(E=>a.jsx("option",{value:E.id,children:E.name},E.id))]})]}),a.jsx("button",{type:"button",className:"px-3 py-1 rounded-2xl bg-gray-200 hover:bg-gray-300",onClick:()=>{d(""),u(""),h("")},children:"Quitar filtro"})]}),a.jsx("button",{type:"button",className:"sm:ml-auto px-3 py-2 rounded-2xl bg-blue-600 text-white hover:bg-blue-700",onClick:()=>p(!0),children:"Crear factura"})]}),a.jsx("div",{className:"bg-gray-50 p-3 rounded-2xl shadow-2xl border mb-3 text-base",children:a.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-8",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Libras ingresadas:"})," ",AA(w.lbsIng)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",AA(w.udsIng)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",Yc(w.totalEsperado)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Libras restantes:"})," ",AA(w.lbsRem)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",AA(w.udsRem)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",Yc(w.totalFact)]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",Yc(w.gross)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Cantidad de Lotes:"})," ",b.length.toLocaleString()]})]})}),a.jsx("div",{className:"block md:hidden space-y-3",children:r?a.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Cargando"}):b.length===0?a.jsx("div",{className:"p-4 text-center bg-white rounded-xl border shadow",children:"Sin lotes pagados"}):b.map(E=>{var B;return a.jsxs("div",{className:"bg-white border rounded-2xl shadow p-3",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold",children:E.productName}),a.jsxs("div",{className:"text-xs text-gray-500",children:[(E.category||"").toUpperCase(),"  ",E.date," "," ",(E.unit||"").toUpperCase()]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-sm font-bold",children:Yc(E.expectedTotal||0)}),a.jsx("div",{className:"text-[11px] text-gray-500",children:"Esperado"})]})]}),a.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Ingresado"}),a.jsx("div",{className:"font-semibold",children:AA(E.quantity)})]}),a.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Restantes"}),a.jsx("div",{className:"font-semibold",children:AA(E.remaining)})]}),a.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Costo"}),a.jsx("div",{className:"font-semibold",children:Yc(E.invoiceTotal||0)})]}),a.jsxs("div",{className:"bg-gray-50 border rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Fecha pago"}),a.jsx("div",{className:"font-semibold",children:(B=E.paidAt)!=null&&B.toDate?or(E.paidAt.toDate(),"yyyy-MM-dd"):""})]})]}),a.jsx("div",{className:"mt-3",children:a.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>k(E),children:"Marcar PENDIENTE"})})]},E.id)})}),a.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow-2xl border w-full",children:a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Tipo"}),a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"Unidad"}),a.jsx("th",{className:"p-2 border",children:"Ingresado"}),a.jsx("th",{className:"p-2 border",children:"Restantes"}),a.jsx("th",{className:"p-2 border",children:"Precio Compra"}),a.jsx("th",{className:"p-2 border",children:"Precio Venta"}),a.jsx("th",{className:"p-2 border",children:"Total factura"}),a.jsx("th",{className:"p-2 border",children:"Total esperado"}),a.jsx("th",{className:"p-2 border",children:"Fecha pago"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):b.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin lotes pagados"})}):b.map(E=>{var B;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:E.date}),a.jsx("td",{className:"p-2 border",children:(E.category||"").toUpperCase()}),a.jsx("td",{className:"p-2 border",children:E.productName}),a.jsx("td",{className:"p-2 border",children:(E.unit||"").toUpperCase()}),a.jsx("td",{className:"p-2 border",children:AA(E.quantity)}),a.jsx("td",{className:"p-2 border",children:AA(E.remaining)}),a.jsx("td",{className:"p-2 border",children:Yc(E.purchasePrice)}),a.jsx("td",{className:"p-2 border",children:Yc(E.salePrice)}),a.jsx("td",{className:"p-2 border",children:Yc(E.invoiceTotal||0)}),a.jsx("td",{className:"p-2 border",children:Yc(E.expectedTotal||0)}),a.jsx("td",{className:"p-2 border",children:(B=E.paidAt)!=null&&B.toDate?or(E.paidAt.toDate(),"yyyy-MM-dd"):""}),a.jsx("td",{className:"p-2 border",children:a.jsx("button",{type:"button",className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>k(E),children:"Marcar PENDIENTE"})})]},E.id)})})]})}),m&&a.jsx(Ale,{paidBatches:t,onClose:()=>p(!1),onCreated:()=>p(!1)}),s&&o&&a.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-3",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md",children:[a.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Confirmar accin"}),a.jsxs("p",{className:"text-gray-700 mb-4",children:["Seguro que quieres marcar pendiente este inventario?",a.jsx("br",{}),"Al hacerlo, las libras se restaurarn y se eliminarn las ventas generadas."]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-xl",children:"Cancelar"}),a.jsx("button",{type:"button",onClick:O,className:"px-4 py-2 bg-yellow-600 text-white hover:bg-yellow-700 rounded-xl",children:"Confirmar"})]})]})})]})}const wa=t=>`C$ ${(Number(t)||0).toFixed(2)}`,fle=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function b1(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function mle(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function ple(t){const e="ROP",r=b1(t.subcat).slice(0,3)||"GEN",n=mle(t.gender),s=b1(t.color).slice(0,3)||"COL",i=b1(t.size)||"TLL",o=b1(t.brand).slice(0,4)||"BRD",l=Date.now().toString(36).toUpperCase().slice(-4);return`${e}-${r}-${n}-${s}-${i}-${o}-${l}`}const ip=/^[A-Za-z0-9._-]{0,32}$/;function gle(){const[t,e]=N.useState([]),[r,n]=N.useState([]),[s,i]=N.useState(!0),[o,l]=N.useState(""),[c,d]=N.useState(or(jc(new Date),"yyyy-MM-dd")),[A,u]=N.useState(or(Ic(new Date),"yyyy-MM-dd")),[f,h]=N.useState(""),[m,p]=N.useState(""),[g,x]=N.useState(or(new Date,"yyyy-MM-dd")),[b,w]=N.useState(0),[k,O]=N.useState(0),[L,E]=N.useState(0),[B,S]=N.useState(0),[U,_]=N.useState(0),[F,D]=N.useState(""),[X,ge]=N.useState(""),[ae,fe]=N.useState(""),[me,Z]=N.useState(""),[ye,Ie]=N.useState(""),[I,j]=N.useState(""),[Q,T]=N.useState(""),[R,K]=N.useState(!1),[M,re]=N.useState(""),[de,le]=N.useState("Camisa"),[q,Se]=N.useState(null),[ee,z]=N.useState(""),[te,Ne]=N.useState(0),[Y,we]=N.useState(0),[Pe,Qe]=N.useState(0),[tt,ot]=N.useState(0),[dt,vt]=N.useState(0),[lt,Ue]=N.useState(""),[Xe,xe]=N.useState(""),[ve,ie]=N.useState(""),[ze,rt]=N.useState(""),[At,Oe]=N.useState(""),[at,Ve]=N.useState(""),[G,_e]=N.useState(""),[Me,We]=N.useState(null),[He,st]=N.useState({x:0,y:0}),[Ct,Xt]=N.useState(!1);N.useEffect(()=>{const J=()=>We(null),ce=pe=>pe.key==="Escape"&&We(null);return document.addEventListener("click",J),document.addEventListener("keydown",ce),()=>{document.removeEventListener("click",J),document.removeEventListener("keydown",ce)}},[]);const Ot=(J,ce,pe=192,Be=160)=>{let se=J;J+pe+8>window.innerWidth&&(se=J-pe),se=Math.max(8,Math.min(se,window.innerWidth-pe-8));let Fe=ce;return ce+Be+8>window.innerHeight&&(Fe=window.innerHeight-Be-8),Fe=Math.max(8,Math.min(Fe,window.innerHeight-Be-8)),{x:se,y:Fe}},tr=(J,ce)=>{J.stopPropagation();const pe=J.currentTarget.getBoundingClientRect(),Be=pe.right,De=pe.bottom,se=Ot(Be,De);st(se),We(Fe=>Fe===ce?null:ce)};N.useEffect(()=>{const J=()=>We(null),ce=pe=>{pe.key==="Escape"&&We(null)};return document.addEventListener("click",J),document.addEventListener("keydown",ce),()=>{document.removeEventListener("click",J),document.removeEventListener("keydown",ce)}},[]),N.useEffect(()=>{if(!Me)return;const J=()=>We(null);return window.addEventListener("scroll",J,!0),window.addEventListener("resize",J),()=>{window.removeEventListener("scroll",J,!0),window.removeEventListener("resize",J)}},[Me]),N.useEffect(()=>{(async()=>{const J=await Nt(ht(Te,"products_clothes")),ce=[];J.forEach(se=>{const Fe=se.data();ce.push({id:se.id,name:Fe.name??"(sin nombre)",category:Fe.category??"(sin categora)",measurement:Fe.measurement??"unidad",price:Number(Fe.price??0),sku:Fe.sku||"",size:Fe.size||"",color:Fe.color||"",gender:Fe.gender||"",brand:Fe.brand||""})}),e(ce);const pe=Dt(ht(Te,"inventory_clothes_batches"),Ur("date","desc")),Be=await Nt(pe),De=[];Be.forEach(se=>{const Fe=se.data();De.push({id:se.id,productId:Fe.productId,productName:Fe.productName,category:Fe.category,unit:Fe.unit,quantity:Number(Fe.quantity||0),remaining:Number(Fe.remaining??Fe.quantity??0),purchasePrice:Number(Fe.purchasePrice||0),salePrice:Number(Fe.salePrice||0),invoiceTotal:Number(Fe.invoiceTotal??Number(Fe.quantity||0)*Number(Fe.purchasePrice||0)),expectedTotal:Number(Fe.expectedTotal??Number(Fe.quantity||0)*Number(Fe.salePrice||0)),date:Fe.date,createdAt:Fe.createdAt,status:Fe.status,notes:Fe.notes||"",sku:Fe.sku||"",size:Fe.size||"",color:Fe.color||"",gender:Fe.gender||"",brand:Fe.brand||"",clientCode:Fe.clientCode||""})}),n(De),i(!1)})()},[]),N.useEffect(()=>{const J=t.find(ce=>ce.id===m);J&&(E(Number(J.price||0)),J.sku&&ge(J.sku),J.size&&fe(ce=>ce||J.size),J.color&&Z(ce=>ce||J.color),J.gender&&Ie(ce=>ce||J.gender),J.brand&&j(ce=>ce||J.brand))},[m,t]),N.useEffect(()=>{S(Math.floor(b*k*100)/100)},[b,k]),N.useEffect(()=>{_(Math.floor(b*L*100)/100)},[b,L]),N.useEffect(()=>{const J=t.find(Be=>Be.id===m);if(J!=null&&J.sku){ge(J.sku);return}const ce=R&&de?de:(J==null?void 0:J.category)||"";if(!ce&&!ye&&!me&&!ae&&!I){ge("");return}const pe=ple({subcat:ce,gender:ye||"",color:me||"",size:ae||"",brand:I||""});ge(pe)},[R,de,m,ye,me,ae,I,t]);const Zt=N.useMemo(()=>r.filter(J=>!(c&&J.date<c||A&&J.date>A||f&&J.productId!==f)),[r,c,A,f]),et=N.useMemo(()=>{const J=Zt.reduce((De,se)=>De+(se.invoiceTotal||0),0),ce=Zt.reduce((De,se)=>De+(se.expectedTotal||0),0),pe=Zt.reduce((De,se)=>De+se.quantity,0),Be=Zt.reduce((De,se)=>De+se.remaining,0);return{udsIng:pe,udsRem:Be,totalFacturado:J,totalEsperado:ce}},[Zt]),Rt=async J=>{J.preventDefault(),l("");const ce=!!m&&!R,pe=t.find(Fe=>Fe.id===m),Be=ce?(pe==null?void 0:pe.name)||"":M||"",De=ce?(pe==null?void 0:pe.category)||"":de||"General",se=ce&&(pe==null?void 0:pe.measurement)||"unidad";if(!Be||b<=0||k<=0){l("Completa nombre/cantidad/costo.");return}if(Q&&!ip.test(Q)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}try{const Fe=await Jr(ht(Te,"inventory_clothes_batches"),{productId:ce?pe.id:"",productName:Be,category:De,unit:se,quantity:b,remaining:b,purchasePrice:k,salePrice:L,invoiceTotal:B,expectedTotal:U,date:g,createdAt:$t.now(),status:"PENDIENTE",notes:F||"",sku:X||"",size:ae||"",color:me||"",gender:ye||"",brand:I||"",clientCode:Q||""});n(he=>[{id:Fe.id,productId:ce?pe.id:"",productName:Be,category:De,unit:se,quantity:b,remaining:b,purchasePrice:k,salePrice:L,invoiceTotal:B,expectedTotal:U,date:g,createdAt:$t.now(),status:"PENDIENTE",notes:F||"",sku:X||"",size:ae||"",color:me||"",gender:ye||"",brand:I||"",clientCode:Q||""},...he]),l(" Lote de ropa creado"),p(""),x(or(new Date,"yyyy-MM-dd")),w(0),O(0),E(0),S(0),_(0),D(""),ge(""),fe(""),Z(""),Ie(""),j(""),T(""),K(!1),re(""),le("Camisa")}catch(Fe){console.error(Fe),l(" Error al crear lote")}},er=async J=>{confirm(`Marcar PAGADO el lote del ${J.date} (${J.productName})?`)&&(await Pr(kt(Te,"inventory_clothes_batches",J.id),{status:"PAGADO"}),n(pe=>pe.map(Be=>Be.id===J.id?{...Be,status:"PAGADO"}:Be)))},Lt=J=>{Se(J.id),z(J.date),Ne(J.quantity),we(J.purchasePrice),Qe(J.salePrice),ot(Number((J.quantity*J.purchasePrice).toFixed(2))),vt(Number((J.quantity*J.salePrice).toFixed(2))),Ue(J.notes||""),xe(J.sku||""),ie(J.size||""),rt(J.color||""),Oe(J.gender||""),Ve(J.brand||""),_e(J.clientCode||"")},Vt=()=>{Se(null),z(""),Ne(0),we(0),Qe(0),ot(0),vt(0),Ue(""),xe(""),ie(""),rt(""),Oe(""),Ve(""),_e("")};N.useEffect(()=>{q&&ot(Math.floor(te*Y*100)/100)},[q,te,Y]),N.useEffect(()=>{q&&vt(Math.floor(te*Pe*100)/100)},[q,te,Pe]);const nr=async()=>{if(!q)return;const J=r.find(De=>De.id===q);if(!J)return;const ce=Math.max(0,J.quantity-J.remaining),pe=Math.max(0,te-ce);if(G&&!ip.test(G)){l("Cdigo del cliente invlido (solo A-Z, 0-9, . _ - , mx 32).");return}const Be=kt(Te,"inventory_clothes_batches",q);await Pr(Be,{date:ee,quantity:te,purchasePrice:Y,salePrice:Pe,invoiceTotal:tt,expectedTotal:dt,notes:lt,remaining:pe,sku:Xe,size:ve,color:ze,gender:At||"",brand:at||"",clientCode:G||""}),n(De=>De.map(se=>se.id===q?{...se,date:ee,quantity:te,purchasePrice:Y,salePrice:Pe,invoiceTotal:tt,expectedTotal:dt,notes:lt,remaining:pe,sku:Xe,size:ve,color:ze,gender:At||"",brand:at||"",clientCode:G||""}:se)),Vt(),l(" Lote actualizado")},Mt=async J=>{confirm(`Eliminar el lote del ${J.date} (${J.productName})?`)&&(await un(kt(Te,"inventory_clothes_batches",J.id)),n(pe=>pe.filter(Be=>Be.id!==J.id)),l(" Lote eliminado"))},oe=()=>{const J=(c?`Desde ${c}`:"Desde inicio")+"  "+(A?`Hasta ${A}`:"Hasta hoy"),ce=se=>(se||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),pe=Zt.map(se=>`
      <tr>
        <td>${se.date}</td>
        <td>${(se.category||"").toUpperCase()}</td>
        <td>${ce(se.productName)}</td>
        <td>${ce(se.sku||"")}</td>
        <td>${ce(se.size||"")}</td>
        <td>${ce(se.color||"")}</td>
        <td>${ce(se.clientCode||"")}</td>
        <td>${ce(se.gender||"")}</td>
        <td>${(se.unit||"").toUpperCase()}</td>
        <td style="text-align:right">${se.quantity.toFixed(0)}</td>
        <td style="text-align:right">${se.remaining.toFixed(0)}</td>
        <td style="text-align:right">${wa(se.purchasePrice)}</td>
        <td style="text-align:right">${wa(se.salePrice)}</td>
        <td style="text-align:right">${wa(se.invoiceTotal||0)}</td>
        <td style="text-align:right">${wa(se.expectedTotal||0)}</td>
        <td>${ce((se.notes||"").slice(0,120))}</td>
        <td>${se.status}</td>
      </tr>`).join(""),Be=`
<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Inventario de Ropa por Lotes</title>
  <style>
    * { font-family: Arial, sans-serif; }
    h1 { margin: 0 0 4px; }
    .muted { color: #555; font-size: 12px; margin-bottom: 12px; }
    table { width: 100%; border-collapse: collapse; font-size: 11px; }
    th, td { border: 1px solid #ddd; padding: 6px; }
    th { background: #f5f5f5; text-align: left; }
    .totals { margin: 10px 0 16px; font-size: 12px; display: grid; grid-template-columns: repeat(2, max-content); column-gap: 32px; row-gap: 6px; align-items: center; }
    @media print { @page { size: A4 landscape; margin: 12mm; } button { display: none; } }
  </style>
</head>
<body>
  <button onclick="window.print()">Imprimir</button>
  <h1>Inventario de Ropa por Lotes</h1>
  <div class="muted">${J}</div>
  <div class="totals">
    <span><strong>Unidades ingresadas:</strong> ${et.udsIng.toFixed(0)}</span>
    <span><strong>Unidades restantes:</strong> ${et.udsRem.toFixed(0)}</span>
    <span><strong>Total esperado a ganar:</strong> ${wa(et.totalEsperado)}</span>
    <span><strong>Total facturado:</strong> ${wa(et.totalFacturado)}</span>
    <span><strong>Ganancia sin gastos:</strong> ${wa(Number((et.totalEsperado-et.totalFacturado).toFixed(2)))}</span>
  </div>
  <table>
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Subcat.</th>
        <th>Producto</th>
        <th>SKU</th>
        <th>Talla</th>
        <th>Color</th>
        <th>Cdigo Cliente</th>
        <th>Gnero</th>
        <th>Unidad</th>
        <th>Ingresado</th>
        <th>Restantes</th>
        <th>Precio Compra</th>
        <th>Precio Venta</th>
        <th>Total factura</th>
        <th>Total esperado</th>
        <th>Comentario</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>${pe||'<tr><td colspan="17" style="text-align:center">Sin lotes</td></tr>'}</tbody>
  </table>
</body>
</html>`,De=window.open("","_blank");De&&(De.document.open(),De.document.write(Be),De.document.close())};return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Inventario de Ropa"}),a.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>Xt(!0),type:"button",children:"Crear Inventario"})]}),a.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:J=>d(J.target.value)})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:A,onChange:J=>u(J.target.value)})]}),a.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[a.jsx("label",{className:"font-semibold",children:"Producto"}),a.jsxs("select",{className:"border rounded px-2 py-1",value:f,onChange:J=>h(J.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),t.map(J=>a.jsxs("option",{value:J.id,children:[J.name,"  ",J.category]},J.id))]})]}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{d(""),u(""),h("")},children:"Quitar filtro"}),a.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:oe,children:"Imprimir PDF"})]}),a.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-base",children:a.jsxs("div",{className:"grid grid-cols-3 gap-y-2 gap-x-8",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Unidades ingresadas:"})," ",et.udsIng.toFixed(0)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Unidades restantes:"})," ",et.udsRem.toFixed(0)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total esperado en ventas:"})," ",wa(et.totalEsperado)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total facturado:"})," ",wa(et.totalFacturado)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Ganancia sin gastos:"})," ",wa(Number((et.totalEsperado-et.totalFacturado).toFixed(2)))]})]})}),a.jsx("div",{className:"bg-white rounded shadow border",children:a.jsx("div",{className:"w-full overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-xs md:text-sm",children:[a.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Fecha"}),a.jsx("th",{className:"p-2 md:p-3 border text-left hidden sm:table-cell",children:"Subcat."}),a.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Producto"}),a.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"SKU"}),a.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Talla"}),a.jsx("th",{className:"p-2 md:p-3 border text-left hidden md:table-cell",children:"Color"}),a.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Cdigo Cliente"}),a.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Gnero"}),a.jsx("th",{className:"p-2 md:p-3 border text-left hidden lg:table-cell",children:"Unidad"}),a.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Ingresado"}),a.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums",children:"Restantes"}),a.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Compra"}),a.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden md:table-cell",children:"Precio Venta"}),a.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total factura"}),a.jsx("th",{className:"p-2 md:p-3 border text-right tabular-nums hidden lg:table-cell",children:"Total esperado"}),a.jsx("th",{className:"p-2 md:p-3 border text-left hidden xl:table-cell",children:"Comentario"}),a.jsx("th",{className:"p-2 md:p-3 border text-left",children:"Estado"}),a.jsx("th",{className:"p-2 md:p-3 border text-center",children:"Acciones"})]})}),a.jsx("tbody",{className:"whitespace-nowrap",children:s?a.jsx("tr",{children:a.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Cargando"})}):Zt.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:17,className:"p-4 text-center",children:"Sin lotes"})}):Zt.map(J=>{const ce=q===J.id;return a.jsxs("tr",{className:"text-left",children:[a.jsx("td",{className:"p-2 md:p-3 border align-top",children:ce?a.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:ee,onChange:pe=>z(pe.target.value)}):J.date}),a.jsx("td",{className:"p-2 md:p-3 border align-top hidden sm:table-cell",children:(J.category||"").toUpperCase()}),a.jsx("td",{className:"p-2 md:p-3 border align-top max-w-[220px] md:max-w-[320px]",children:a.jsx("span",{className:"block truncate",title:J.productName,children:J.productName})}),a.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell max-w-[220px]",children:ce?a.jsx("input",{className:"w-full border p-1 rounded",value:Xe,onChange:pe=>xe(pe.target.value)}):a.jsx("span",{className:"block truncate",title:J.sku||"",children:J.sku||""})}),a.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:ce?a.jsx("input",{className:"w-full border p-1 rounded",value:ve,onChange:pe=>ie(pe.target.value)}):J.size||""}),a.jsx("td",{className:"p-2 md:p-3 border align-top hidden md:table-cell",children:ce?a.jsx("input",{className:"w-full border p-1 rounded",value:ze,onChange:pe=>rt(pe.target.value)}):J.color||""}),a.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[200px]",children:ce?a.jsx("input",{className:"w-full border p-1 rounded",value:G,onChange:pe=>{const Be=pe.target.value;ip.test(Be)&&_e(Be)},placeholder:"Ej: LOTE-SHEIN-SEP-01",title:"AZ 09 . _ - (mx 32)"}):a.jsx("span",{className:"block truncate",title:J.clientCode||"",children:J.clientCode||""})}),a.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:ce?a.jsx("select",{className:"w-full border p-1 rounded",value:At,onChange:pe=>Oe(pe.target.value),children:fle.map(pe=>a.jsx("option",{value:pe,children:pe||""},pe))}):J.gender||""}),a.jsx("td",{className:"p-2 md:p-3 border align-top hidden lg:table-cell",children:(J.unit||"").toUpperCase()}),a.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:ce?a.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-20 border p-1 rounded text-right",value:Number.isNaN(te)?"":te,onChange:pe=>Ne(Math.max(0,parseInt(pe.target.value||"0",10)))}):J.quantity.toFixed(0)}),a.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums",children:ce?J.remaining:J.remaining.toFixed(0)}),a.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:ce?a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(Y)?"":Y,onChange:pe=>we(Math.max(0,parseFloat(pe.target.value||"0")))}):wa(J.purchasePrice)}),a.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden md:table-cell",children:ce?a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(Pe)?"":Pe,onChange:pe=>Qe(Math.max(0,parseFloat(pe.target.value||"0")))}):wa(J.salePrice)}),a.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:wa(ce?tt:J.invoiceTotal||0)}),a.jsx("td",{className:"p-2 md:p-3 border align-top text-right tabular-nums hidden lg:table-cell",children:wa(ce?dt:J.expectedTotal||0)}),a.jsx("td",{className:"p-2 md:p-3 border align-top hidden xl:table-cell max-w-[280px]",children:ce?a.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:lt,onChange:pe=>Ue(pe.target.value),maxLength:500}):a.jsx("span",{className:"block truncate",title:J.notes||"",children:J.notes||""})}),a.jsx("td",{className:"p-2 md:p-3 border align-top",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${J.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:J.status})}),a.jsx("td",{className:"p-2 md:p-3 border align-top",children:ce?a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:nr,children:"Guardar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Vt,children:"Cancelar"})]}):a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-8 h-8 rounded border border-gray-200 hover:bg-gray-100",title:"Acciones",onClick:pe=>tr(pe,J.id),children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.6"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.6"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.6"})]})})})]},J.id)})})]})})}),Me&&$A.createPortal(a.jsxs(a.Fragment,{children:[a.jsx("div",{onClick:()=>We(null),className:"fixed inset-0 z-[60]"}),a.jsx("div",{className:"fixed z-[61] w-44 rounded-md border border-gray-200 bg-white shadow-xl",style:{left:He.x,top:He.y},onClick:J=>J.stopPropagation(),role:"menu","aria-orientation":"vertical",children:a.jsxs("div",{className:"py-1 text-sm",children:[(()=>{const J=Zt.find(ce=>ce.id===Me);return(J==null?void 0:J.status)==="PENDIENTE"?a.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-green-50",onClick:()=>{We(null),er(J)},children:" Pagar"}):null})(),a.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-yellow-50",onClick:()=>{const J=Zt.find(ce=>ce.id===Me);J&&(We(null),Lt(J))},children:" Editar"}),a.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-red-50 text-red-600",onClick:()=>{const J=Zt.find(ce=>ce.id===Me);J&&(We(null),Mt(J))},children:" Borrar"})]})})]}),document.body),Ct&&$A.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Xt(!1)}),a.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-4xl max-h-[92vh] overflow-auto p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-lg font-bold",children:"Crear Inventario (Lote)"}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Xt(!1),type:"button",children:"Cerrar"})]}),a.jsxs("form",{onSubmit:Rt,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Producto de ropa"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:J=>p(J.target.value),children:[a.jsx("option",{value:"",children:"(Opcional) Selecciona un producto"}),t.map(J=>a.jsxs("option",{value:J.id,children:[J.name,"  ",J.category,"  ",J.sku?`SKU: ${J.sku}`:""]},J.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del lote"}),a.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:g,onChange:J=>x(J.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (pzas)"}),a.jsx("input",{type:"number",step:"1",inputMode:"numeric",className:"w-full border p-2 rounded",value:b===0?"":b,onChange:J=>w(Math.max(0,parseInt(J.target.value||"0",10))),placeholder:""})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Precio de compra (pza)"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:k===0?"":k,onChange:J=>O(Math.max(0,parseFloat(J.target.value||"0")))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:L===0?"":L,onChange:J=>E(Math.max(0,parseFloat(J.target.value||"0")))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),a.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:X,readOnly:!0,placeholder:"Se genera automticamente o se carga del producto",title:"Si el producto tiene SKU, se usa tal cual; si no, se genera por subcat/gnero/talla/color/marca."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),a.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:ae,readOnly:!0,onChange:J=>fe(J.target.value),placeholder:"XS/S/M/L/XL/10/12"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),a.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:me,readOnly:!0,onChange:J=>Z(J.target.value),placeholder:"Negro, Azul, Rojo"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),a.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:ye,readOnly:!0,onChange:J=>Ie(J.target.value),placeholder:"Masculino, Femenino, Otro"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Marca / Origen (opcional)"}),a.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:I,onChange:J=>j(J.target.value),placeholder:"Shein, Usado, Otro"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo del cliente (opcional)"}),a.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: LOTE-SHEIN-SEP-01",value:Q,onChange:J=>{const ce=J.target.value;ip.test(ce)&&T(ce)},title:"Solo letras, nmeros, punto, guion y guion_bajo (mx 32)"}),!ip.test(Q)&&Q.length>0&&a.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Formato invlido"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),a.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:F,onChange:J=>D(J.target.value),maxLength:500,placeholder:"Ej: Camisita veranera, tela delgada, tirantes"}),a.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[F.length,"/500"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Total factura (auto)"}),a.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:wa(B),readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Total esperado (auto)"}),a.jsx("input",{type:"text",className:"w-full border p-2 rounded bg-gray-100",value:wa(U),readOnly:!0})]}),a.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[a.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Xt(!1),children:"Cancelar"}),a.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar lote"})]})]})]})]}),document.body),o&&a.jsx("p",{className:"mt-2 text-sm",children:o})]})}const xle=["Camisa","Blusa","Vestido","Jean","Pantaln","Short","Falda","Conjunto","Abrigo","Suter","Accesorio"],vle=["Negro","Blanco","Azul","Rojo","Verde","Gris","Beige","Rosa","Amarillo","Marrn","Morado","Naranja"],yle=["XS","S","M","L","XL","2XL"],ble=["2","4","6","8","10","12","14"],wle=["26","28","30","32","34","36","38"],Nle=["Shein","Usado","Otro"],Cle=["","HOMBRE","MUJER","NINO","NINA","UNISEX"];function w1(t){return(t||"").trim().toUpperCase().replace(/\s+/g,"-").replace(/[^A-Z0-9-]/g,"")}function _le(t){switch((t||"").toUpperCase()){case"HOMBRE":return"HOM";case"MUJER":return"MUJ";case"NINO":return"NIN";case"NINA":return"NIA";case"UNISEX":return"UNI";default:return"GEN"}}function Ele(t){const e="ROP",r=w1(t.subcat).slice(0,3)||"GEN",n=_le(t.gender),s=w1(t.color).slice(0,3)||"COL",i=w1(t.size)||"TLL",o=w1(t.brand).slice(0,4)||"BRD";return`${e}-${r}-${n}-${s}-${i}-${o}`}const Ble=/^[A-Za-z0-9._-]{0,32}$/;function Sle(){const[t,e]=N.useState(""),[r,n]=N.useState("Camisa"),[s,i]=N.useState(""),[o,l]=N.useState(""),[c,d]=N.useState("Shein"),[A,u]=N.useState(""),[f,h]=N.useState(""),[m,p]=N.useState(""),[g,x]=N.useState(""),[b,w]=N.useState(""),[k,O]=N.useState("0"),[L,E]=N.useState(""),[B,S]=N.useState(""),U=N.useMemo(()=>{const T=Number(k||0),R=Number(b||0);return Math.floor(T*R*100)/100},[k,b]),[_,F]=N.useState([]),[D,X]=N.useState(!0),[ge,ae]=N.useState(""),{refreshKey:fe,refresh:me}=vl(),[Z,ye]=N.useState(!1),Ie=N.useMemo(()=>r.toLowerCase()==="jean"?wle:A==="NINO"||A==="NINA"?ble:yle,[r,A]);N.useEffect(()=>{p(Ele({subcat:r,gender:A,color:o,size:s,brand:c}))},[r,A,o,s,c]),N.useEffect(()=>{(async()=>{X(!0);const T=Dt(ht(Te,"products_clothes"),Ur("createdAt","desc")),R=await Nt(T),K=[];R.forEach(M=>{const re=M.data();K.push({id:M.id,name:re.name??"(sin nombre)",category:re.category??"",measurement:re.measurement??"unidad",sku:re.sku??"",size:re.size||"",color:re.color||"",brand:re.brand||"",gender:re.gender||"",clientCode:re.clientCode||"",notes:re.notes||"",createdAt:re.createdAt??$t.now()})}),F(K),X(!1)})()},[fe]);const I=()=>{e(""),n("Camisa"),i(""),l(""),d("Shein"),u(""),h(""),x(""),w(""),O("0"),E(""),S("")},j=async T=>{if(T.preventDefault(),ae(""),!t.trim()){ae("Ingresa el nombre del producto.");return}if(f&&!Ble.test(f)){ae("Cdigo del cliente invlido");return}const R=Number(k||0),K=Number(b||0);if(R<0){ae("La cantidad de piezas debe ser 0 o mayor.");return}if(K<0){ae("El precio de venta no puede ser negativo.");return}try{const M=await Jr(ht(Te,"products_clothes"),{name:t.trim(),category:r,measurement:"unidad",sku:m,size:s||"",color:o||"",brand:c||"",gender:A||"",clientCode:f||"",notes:g||"",createdAt:$t.now(),price:K||0});if(F(re=>[{id:M.id,name:t.trim(),category:r,measurement:"unidad",sku:m,size:s||"",color:o||"",brand:c||"",gender:A||"",clientCode:f||"",notes:g||"",createdAt:$t.now()},...re]),R>0){const re=new Date().toISOString().slice(0,10),de=L||re;await Jr(ht(Te,"inventory_clothes_batches"),{productId:M.id,productName:t.trim(),category:r,unit:"unidad",quantity:R,remaining:R,purchasePrice:0,salePrice:K||0,invoiceTotal:0,expectedTotal:U||0,date:de,createdAt:$t.now(),status:"PENDIENTE",notes:B||"",sku:m||"",size:s||"",color:o||"",gender:A||"",brand:c||"",clientCode:f||""})}ae(R>0?" Producto creado y lote de inventario registrado":" Producto de ropa creado"),I()}catch(M){console.error(M),ae(" Error al crear producto")}},Q=async T=>{confirm(`Eliminar el producto "${T.name}"?`)&&(await un(kt(Te,"products_clothes",T.id)),F(K=>K.filter(M=>M.id!==T.id)))};return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Productos de Ropa"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Zl,{onClick:me,loading:D}),a.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{ye(!0)},children:[a.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo producto"]})]})]}),Z&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo producto de ropa"}),a.jsxs("form",{onSubmit:j,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),a.jsx("input",{className:"w-full border p-2 rounded",value:t,onChange:T=>e(T.target.value),placeholder:"Ej: Blusa floral"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Subcategora"}),a.jsx("select",{className:"w-full border p-2 rounded",value:r,onChange:T=>n(T.target.value),children:xle.map(T=>a.jsx("option",{value:T,children:T},T))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Gnero"}),a.jsx("select",{className:"w-full border p-2 rounded",value:A,onChange:T=>u(T.target.value),children:Cle.map(T=>a.jsx("option",{value:T,children:T||""},T))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Talla"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:s,onChange:T=>i(T.target.value),children:[a.jsx("option",{value:"",children:""}),Ie.map(T=>a.jsx("option",{value:T,children:T},T))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Color"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:T=>l(T.target.value),children:[a.jsx("option",{value:"",children:""}),vle.map(T=>a.jsx("option",{value:T,children:T},T))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Marca"}),a.jsx("select",{className:"w-full border p-2 rounded",value:c,onChange:T=>d(T.target.value),children:Nle.map(T=>a.jsx("option",{value:T,children:T},T))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"SKU (auto)"}),a.jsx("input",{className:"w-full border p-2 rounded bg-gray-100",value:m,readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Cdigo cliente"}),a.jsx("input",{className:"w-full border p-2 rounded",value:f,onChange:T=>h(T.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Precio de venta (pza)"}),a.jsx("input",{className:"w-full border p-2 rounded",type:"number",step:"0.01",min:0,value:b,onChange:T=>w(T.target.value),placeholder:"0.00"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad de piezas (crea lote si > 0)"}),a.jsx("input",{className:"w-full border p-2 rounded",type:"number",min:0,value:k,onChange:T=>O(T.target.value),placeholder:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de lote"}),a.jsx("input",{className:"w-full border p-2 rounded",type:"date",value:L,onChange:T=>E(T.target.value)})]}),a.jsxs("div",{className:"md:col-span-2 flex items-center justify-between border-t pt-3 mt-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Medicin:"})," unidad"]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total esperado (auto): "}),isNaN(U)?"":U.toFixed(2)]})]}),a.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2 mt-2",children:[a.jsx("button",{type:"button",onClick:I,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar"}),a.jsx("button",{type:"button",onClick:()=>ye(!1),className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar"})]})]})]})}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Subcat."}),a.jsx("th",{className:"p-2 border",children:"Nombre"}),a.jsx("th",{className:"p-2 border",children:"SKU"}),a.jsx("th",{className:"p-2 border",children:"Talla"}),a.jsx("th",{className:"p-2 border",children:"Color"}),a.jsx("th",{className:"p-2 border",children:"Marca"}),a.jsx("th",{className:"p-2 border",children:"Gnero"}),a.jsx("th",{className:"p-2 border",children:"Cdigo Cliente"}),a.jsx("th",{className:"p-2 border",children:"Comentario"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:D?a.jsx("tr",{children:a.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Cargando"})}):_.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:11,className:"p-4 text-center",children:"Sin productos"})}):_.map(T=>{var R;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:(R=T.createdAt)!=null&&R.toDate?T.createdAt.toDate().toISOString().slice(0,10):""}),a.jsx("td",{className:"p-2 border",children:T.category}),a.jsx("td",{className:"p-2 border",children:T.name}),a.jsx("td",{className:"p-2 border",children:T.sku}),a.jsx("td",{className:"p-2 border",children:T.size||""}),a.jsx("td",{className:"p-2 border",children:T.color||""}),a.jsx("td",{className:"p-2 border",children:T.brand||""}),a.jsx("td",{className:"p-2 border",children:T.gender||""}),a.jsx("td",{className:"p-2 border",children:T.clientCode||""}),a.jsx("td",{className:"p-2 border",children:T.notes||""}),a.jsx("td",{className:"p-2 border",children:a.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>Q(T),children:"Borrar"})})]},T.id)})})]})}),ge&&a.jsx("p",{className:"mt-2 text-sm",children:ge})]})}async function Ile(t){const{productId:e,quantity:r,saleDate:n,saleId:s}=t,i=Math.max(0,Math.floor(Number(r||0)));if(!e||i<=0)throw new Error("Parmetros invlidos para allocateSaleFIFOClothes");const o=Dt(ht(Te,"inventory_clothes_batches"),Gt("productId","==",e)),d=(await Nt(o)).docs.map(u=>({id:u.id,data:u.data()})).sort((u,f)=>{var x,b;const h=String(u.data.date||""),m=String(f.data.date||"");if(h!==m)return h<m?-1:1;const p=((x=u.data.createdAt)==null?void 0:x.seconds)??0,g=((b=f.data.createdAt)==null?void 0:b.seconds)??0;return p-g}).map(u=>kt(Te,"inventory_clothes_batches",u.id)),A=[];return await pa(Te,async u=>{const f=await Promise.all(d.map(m=>u.get(m)));let h=i;for(let m=0;m<d.length&&h>0;m++){const p=d[m],g=f[m];if(!g.exists())continue;const x=g.data(),b=Math.max(0,Math.floor(Number(x.quantity||0))),w=Number.isFinite(Number(x.remaining))?Math.max(0,Math.floor(Number(x.remaining||0))):b;if(w<=0)continue;const k=Math.min(w,h),O=Math.max(0,w-k);u.update(p,{remaining:O}),A.push({batchId:p.id,qty:k,batchDate:String(x.date||""),productName:String(x.productName||"")}),h-=k}if(h>0)throw new Error(`Inventario insuficiente. Faltan ${h} unidades.`);if(s)for(const m of A)await Jr(ht(Te,"batch_clothes_allocations"),{saleId:s,saleDate:n,productId:e,productName:m.productName??"",batchId:m.batchId,batchDate:m.batchDate??"",quantity:m.qty,createdAt:$t.now()})}),{allocations:A}}async function IE(t){const e=kt(Te,"sales_clothes",t),r=await Ya(e);if(!r.exists())throw new Error("La venta no existe.");const n=r.data(),s=[];if(Array.isArray(n.items)&&n.items.length>0){const l={};if(n.allocationsByItem&&typeof n.allocationsByItem=="object")for(const c of Object.keys(n.allocationsByItem)){const d=n.allocationsByItem[c],A=String((d==null?void 0:d.productId)||c||"");if(!A)continue;const u=Array.isArray(d==null?void 0:d.allocations)?d.allocations:[];l[A]=u.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))}))}if(Array.isArray(n.allocationsByItem))for(const c of n.allocationsByItem){const d=String((c==null?void 0:c.productId)||"");if(!d)continue;const A=Array.isArray(c==null?void 0:c.allocations)?c.allocations:[];l[d]=A.map(u=>({batchId:String(u.batchId),qty:Math.max(0,Math.floor(Number(u.qty||u.quantity||0)))}))}for(const c of n.items){const d=String((c==null?void 0:c.productId)||"");if(!d)continue;const A=Math.max(0,Math.floor(Number((c==null?void 0:c.qty)||(c==null?void 0:c.quantity)||0))),u=Array.isArray(c==null?void 0:c.allocations)?c.allocations.map(f=>({batchId:String(f.batchId),qty:Math.max(0,Math.floor(Number(f.qty||f.quantity||0)))})):l[d]||[];s.push({productId:d,productName:String((c==null?void 0:c.productName)||""),qty:A,allocations:u.length?u:void 0})}}else{const l=n.item||{},c=String(l.productId||n.productId||""),d=Math.max(0,Math.floor(Number(l.qty??n.quantity??0))),A=Array.isArray(n.allocations)?n.allocations.map(u=>({batchId:String(u.batchId),qty:Math.max(0,Math.floor(Number(u.qty||u.quantity||0)))})):[];c&&d>0&&s.push({productId:c,productName:String(l.productName||n.productName||""),qty:d,allocations:A.length?A:void 0})}return s.length===0?(await pa(Te,async l=>{l.delete(e)}),{restored:0}):s.every(l=>Array.isArray(l.allocations)&&l.allocations.length>0)?(await pa(Te,async c=>{const d=[];for(const u of s)for(const f of u.allocations||[])d.push({ref:kt(Te,"inventory_clothes_batches",f.batchId),addBack:Math.max(0,Math.floor(Number(f.qty||0)))});const A=await Promise.all(d.map(u=>c.get(u.ref)));for(let u=0;u<d.length;u++){const f=A[u];if(!f.exists())continue;const h=f.data(),m=Math.max(0,Math.floor(Number(h.remaining||0)));c.update(d[u].ref,{remaining:m+d[u].addBack})}c.delete(e)}),{restored:s.reduce((c,d)=>c+(d.allocations||[]).reduce((A,u)=>A+u.qty,0),0)}):(await pa(Te,async l=>{const c={};for(const h of s){if(!h.productId||h.qty<=0)continue;const m=Dt(ht(Te,"inventory_clothes_batches"),Gt("productId","==",h.productId)),g=(await Nt(m)).docs.map(x=>{const b=x.data(),w=Math.max(0,Math.floor(Number(b.quantity||0))),k=Number.isFinite(Number(b.remaining))?Math.max(0,Math.floor(Number(b.remaining||0))):w;return{id:x.id,date:String(b.date||""),quantity:w,remaining:k}}).sort((x,b)=>x.date.localeCompare(b.date));c[h.productId]=g}const d=[];for(const h of s){if(!h.productId||h.qty<=0)continue;if(Array.isArray(h.allocations)&&h.allocations.length>0){for(const g of h.allocations)d.push({id:g.batchId,addBack:Math.max(0,Math.floor(Number(g.qty||0)))});continue}const m=c[h.productId]||[];let p=h.qty;for(const g of m){if(p<=0)break;const x=Math.max(0,g.quantity-g.remaining);if(x<=0)continue;const b=Math.min(x,p);d.push({id:g.id,addBack:b}),p-=b}for(const g of m){if(p<=0)break;const x=Math.min(p,h.qty);d.push({id:g.id,addBack:x}),p-=x}}const A={};for(const h of d)A[h.id]=(A[h.id]||0)+Math.max(0,Math.floor(Number(h.addBack||0)));const u=Object.keys(A).map(h=>kt(Te,"inventory_clothes_batches",h)),f=await Promise.all(u.map(h=>l.get(h)));for(let h=0;h<u.length;h++){const m=f[h];if(!m.exists())continue;const p=m.data(),g=Math.max(0,Math.floor(Number(p.remaining||0))),x=Math.max(0,Math.floor(Number(A[u[h].id]||0)));l.update(u[h],{remaining:g+x})}l.delete(e)}),{restored:s.reduce((l,c)=>l+c.qty,0)})}const nP=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Zc=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function N1(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function sP(t){const e=Dt(ht(Te,"ar_movements"),Gt("ref.saleId","==",t)),r=await Nt(e);await Promise.all(r.docs.map(n=>un(kt(Te,"ar_movements",n.id))))}function jle(){const[t,e]=N.useState(!1),[r,n]=N.useState(!1),[s,i]=N.useState(null),[o,l]=N.useState([]),c=async et=>{e(!0),n(!0),i(et),l([]);try{const er=(await Nt(Dt(ht(Te,"sales_clothes"),Gt("__name__","==",et)))).docs[0],Lt=er==null?void 0:er.data(),nr=(Array.isArray(Lt==null?void 0:Lt.items)?Lt.items:Lt!=null&&Lt.item?[Lt.item]:[]).map(Mt=>({productName:String(Mt.productName||""),qty:Number(Mt.qty||0),unitPrice:Number(Mt.unitPrice||0),discount:Number(Mt.discount||0),total:Number(Mt.total||0)}));l(nr)}catch(Rt){console.error(Rt)}finally{n(!1)}},[d,A]=N.useState(""),[u,f]=N.useState("+505 "),[h,m]=N.useState(""),[p,g]=N.useState(""),[x,b]=N.useState("ACTIVO"),[w,k]=N.useState(0),[O,L]=N.useState([]),[E,B]=N.useState(!0),[S,U]=N.useState(""),[_,F]=N.useState(null),[D,X]=N.useState(""),[ge,ae]=N.useState("+505 "),[fe,me]=N.useState(""),[Z,ye]=N.useState(""),[Ie,I]=N.useState("ACTIVO"),[j,Q]=N.useState(0),[T,R]=N.useState(!1),[K,M]=N.useState(null),[re,de]=N.useState(!1),[le,q]=N.useState([]),[Se,ee]=N.useState({saldoActual:0,totalAbonado:0,totalCargos:0}),[z,te]=N.useState(!1),[Ne,Y]=N.useState(0),[we,Pe]=N.useState(new Date().toISOString().slice(0,10)),[Qe,tt]=N.useState(""),[ot,dt]=N.useState(!1),[vt,lt]=N.useState(null),[Ue,Xe]=N.useState(""),[xe,ve]=N.useState(0),[ie,ze]=N.useState(""),[rt,At]=N.useState(!1);N.useEffect(()=>{(async()=>{const et=Dt(ht(Te,"customers_clothes"),Ur("createdAt","desc")),Rt=await Nt(et),er=[];Rt.forEach(Lt=>{const Vt=Lt.data();er.push({id:Lt.id,name:Vt.name??"",phone:Vt.phone??"+505 ",place:Vt.place??"",notes:Vt.notes??"",status:Vt.status??"ACTIVO",creditLimit:Number(Vt.creditLimit??0),createdAt:Vt.createdAt??$t.now(),balance:0})});for(const Lt of er)try{const Vt=Dt(ht(Te,"ar_movements"),Gt("customerId","==",Lt.id)),nr=await Nt(Vt);let Mt=0;nr.forEach(oe=>Mt+=Number(oe.data().amount||0)),Lt.balance=Mt}catch{Lt.balance=0}L(er),B(!1)})()},[]);const Oe=()=>{A(""),f("+505 "),m(""),g(""),b("ACTIVO"),k(0)},at=async et=>{if(et.preventDefault(),U(""),!d.trim()){U("Ingresa el nombre.");return}const Rt=N1(u);if(Rt.length<6){U("Telfono incompleto.");return}try{const er=await Jr(ht(Te,"customers_clothes"),{name:d.trim(),phone:Rt,place:h||"",notes:p||"",status:x,creditLimit:Number(w||0),createdAt:$t.now()});L(Lt=>[{id:er.id,name:d.trim(),phone:Rt,place:h||"",notes:p||"",status:x,creditLimit:Number(w||0),createdAt:$t.now(),balance:0},...Lt]),Oe(),At(!1),U(" Cliente creado")}catch(er){console.error(er),U(" Error al crear cliente")}},Ve=et=>{F(et.id),X(et.name),ae(et.phone||"+505 "),me(et.place||""),ye(et.notes||""),I(et.status||"ACTIVO"),Q(Number(et.creditLimit||0))},G=()=>{F(null),X(""),ae("+505 "),me(""),ye(""),I("ACTIVO"),Q(0)},_e=async()=>{if(!_)return;const et=N1(ge);if(!D.trim()){U("Ingresa el nombre.");return}try{await Pr(kt(Te,"customers_clothes",_),{name:D.trim(),phone:et,place:fe||"",notes:Z||"",status:Ie,creditLimit:Number(j||0)}),L(Rt=>Rt.map(er=>er.id===_?{...er,name:D.trim(),phone:et,place:fe||"",notes:Z||"",status:Ie,creditLimit:Number(j||0)}:er)),G(),U(" Cliente actualizado")}catch(Rt){console.error(Rt),U(" Error al actualizar")}},Me=async et=>{if(confirm(`Eliminar al cliente "${et.name}"?
Se devolvern al inventario todas las prendas de sus compras y se borrarn sus movimientos.`))try{B(!0);const er=Dt(ht(Te,"sales_clothes"),Gt("customerId","==",et.id)),Lt=await Nt(er);for(const Mt of Lt.docs){const oe=Mt.id;try{await IE(oe)}catch(J){console.warn("restoreSaleAndDeleteClothes error",J);try{await un(kt(Te,"sales_clothes",oe))}catch{}}await sP(oe)}const Vt=Dt(ht(Te,"ar_movements"),Gt("customerId","==",et.id)),nr=await Nt(Vt);await Promise.all(nr.docs.map(Mt=>un(kt(Te,"ar_movements",Mt.id)))),await un(kt(Te,"customers_clothes",et.id)),L(Mt=>Mt.filter(oe=>oe.id!==et.id)),U(" Cliente eliminado y prendas devueltas al inventario")}catch(er){console.error(er),U(" No se pudo eliminar el cliente.")}finally{B(!1)}},We=async et=>{M(et),q([]),ee({saldoActual:0,totalAbonado:0,totalCargos:0}),R(!0),te(!1),Y(0),Pe(new Date().toISOString().slice(0,10)),tt(""),lt(null),de(!0);try{const Rt=Dt(ht(Te,"ar_movements"),Gt("customerId","==",et.id)),er=await Nt(Rt),Lt=[];er.forEach(Vt=>{var Mt,oe;const nr=Vt.data();Lt.push({id:Vt.id,date:nr.date??((oe=(Mt=nr.createdAt)==null?void 0:Mt.toDate)!=null&&oe.call(Mt)?nr.createdAt.toDate().toISOString().slice(0,10):""),type:nr.type??"CARGO",amount:Number(nr.amount||0),ref:nr.ref||{},comment:nr.comment||"",createdAt:nr.createdAt})}),Lt.sort((Vt,nr)=>{var J,ce;if(Vt.date!==nr.date)return Vt.date.localeCompare(nr.date);const Mt=((J=Vt.createdAt)==null?void 0:J.seconds)||0,oe=((ce=nr.createdAt)==null?void 0:ce.seconds)||0;return Mt-oe}),q(Lt),He(Lt)}catch(Rt){console.error(Rt),U(" No se pudo cargar el estado de cuenta")}finally{de(!1)}},He=et=>{const Rt=et.reduce((Vt,nr)=>Vt+(Number(nr.amount)||0),0),er=et.filter(Vt=>Number(Vt.amount)<0).reduce((Vt,nr)=>Vt+Math.abs(Number(nr.amount)||0),0),Lt=et.filter(Vt=>Number(Vt.amount)>0).reduce((Vt,nr)=>Vt+Number(nr.amount)||0,0);ee({saldoActual:Rt,totalAbonado:er,totalCargos:Lt})},st=async()=>{if(!K)return;U("");const et=Number(Ne||0);if(!(et>0)){U("Ingresa un monto de abono mayor a 0.");return}const Rt=parseFloat(et.toFixed(2));if(!we){U("Selecciona la fecha del abono.");return}try{dt(!0);const er={customerId:K.id,type:"ABONO",amount:-Rt,date:we,comment:Qe||"",createdAt:$t.now()},Vt={id:(await Jr(ht(Te,"ar_movements"),er)).id,date:we,type:"ABONO",amount:-Rt,comment:Qe||"",createdAt:$t.now()},nr=[...le,Vt].sort((Mt,oe)=>{var pe,Be;if(Mt.date!==oe.date)return Mt.date.localeCompare(oe.date);const J=((pe=Mt.createdAt)==null?void 0:pe.seconds)||0,ce=((Be=oe.createdAt)==null?void 0:Be.seconds)||0;return J-ce});q(nr),He(nr),L(Mt=>Mt.map(oe=>oe.id===K.id?{...oe,balance:(oe.balance||0)-Rt}:oe)),M(Mt=>Mt&&{...Mt,balance:(Mt.balance||0)-Rt}),Y(0),tt(""),Pe(new Date().toISOString().slice(0,10)),te(!1),U(" Abono registrado")}catch(er){console.error(er),U(" Error al registrar el abono")}finally{dt(!1)}},Ct=et=>{lt(et.id),Xe(et.date||new Date().toISOString().slice(0,10)),ve(Math.abs(Number(et.amount||0))),ze(et.comment||"")},Xt=()=>{lt(null),Xe(""),ve(0),ze("")},Ot=async()=>{if(!vt)return;const et=le.findIndex(Vt=>Vt.id===vt);if(et===-1)return;const Rt=le[et],er=Number(xe||0);if(!(er>0)){U("El monto debe ser mayor a 0.");return}const Lt=Rt.type==="ABONO"?-parseFloat(er.toFixed(2)):+parseFloat(er.toFixed(2));try{await Pr(kt(Te,"ar_movements",vt),{date:Ue,amount:Lt,comment:ie||""});const Vt=[...le];Vt[et]={...Rt,date:Ue,amount:Lt,comment:ie||""},Vt.sort((Mt,oe)=>{var pe,Be;if(Mt.date!==oe.date)return Mt.date.localeCompare(oe.date);const J=((pe=Mt.createdAt)==null?void 0:pe.seconds)||0,ce=((Be=oe.createdAt)==null?void 0:Be.seconds)||0;return J-ce}),q(Vt),He(Vt);const nr=Vt.reduce((Mt,oe)=>Mt+(Number(oe.amount)||0),0);L(Mt=>Mt.map(oe=>oe.id===(K==null?void 0:K.id)?{...oe,balance:nr}:oe)),M(Mt=>Mt&&{...Mt,balance:nr}),Xt(),U(" Movimiento actualizado")}catch(Vt){console.error(Vt),U(" Error al actualizar movimiento")}},tr=async et=>{var er,Lt;if(confirm(`Eliminar este movimiento (${et.type==="ABONO"?"Abono":"Compra"}) del ${et.date}?${et.type==="CARGO"&&((er=et.ref)!=null&&er.saleId)?`
Se devolvern al inventario las prendas de esa venta.`:""}`))try{if(B(!0),et.type==="CARGO"&&((Lt=et.ref)!=null&&Lt.saleId)){try{await IE(et.ref.saleId)}catch(Mt){console.warn("restoreSaleAndDeleteClothes error",Mt),B(!1),U(" No se pudo devolver inventario de la venta.");return}await sP(et.ref.saleId)}else await un(kt(Te,"ar_movements",et.id));const Vt=le.filter(Mt=>{var oe,J;return et.type==="CARGO"&&((oe=et.ref)!=null&&oe.saleId)?((J=Mt.ref)==null?void 0:J.saleId)!==et.ref.saleId:Mt.id!==et.id});q(Vt),He(Vt);const nr=Vt.reduce((Mt,oe)=>Mt+(Number(oe.amount)||0),0);L(Mt=>Mt.map(oe=>oe.id===(K==null?void 0:K.id)?{...oe,balance:nr}:oe)),M(Mt=>Mt&&{...Mt,balance:nr}),U(" Movimiento eliminado")}catch(Vt){console.error(Vt),U(" Error al eliminar movimiento")}finally{B(!1)}},Zt=N.useMemo(()=>[...O].sort((et,Rt)=>{var er,Lt;return et.status!==Rt.status?et.status==="BLOQUEADO"?1:-1:(((er=Rt.createdAt)==null?void 0:er.seconds)||0)-(((Lt=et.createdAt)==null?void 0:Lt.seconds)||0)}),[O]);return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Ropa)"}),a.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>At(!0),type:"button",children:"Crear Cliente"})]}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Nombre"}),a.jsx("th",{className:"p-2 border",children:"Telfono"}),a.jsx("th",{className:"p-2 border",children:"Lugar"}),a.jsx("th",{className:"p-2 border",children:"Estado"}),a.jsx("th",{className:"p-2 border",children:"Lmite"}),a.jsx("th",{className:"p-2 border",children:"Saldo"}),a.jsx("th",{className:"p-2 border",children:"Comentario"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:E?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):Zt.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin clientes"})}):Zt.map(et=>{var er;const Rt=_===et.id;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:(er=et.createdAt)!=null&&er.toDate?et.createdAt.toDate().toISOString().slice(0,10):""}),a.jsx("td",{className:"p-2 border",children:Rt?a.jsx("input",{className:"w-full border p-1 rounded",value:D,onChange:Lt=>X(Lt.target.value)}):et.name}),a.jsx("td",{className:"p-2 border",children:Rt?a.jsx("input",{className:"w-full border p-1 rounded",value:ge,onChange:Lt=>ae(N1(Lt.target.value))}):et.phone}),a.jsx("td",{className:"p-2 border",children:Rt?a.jsxs("select",{className:"w-full border p-1 rounded",value:fe,onChange:Lt=>me(Lt.target.value),children:[a.jsx("option",{value:"",children:""}),nP.map(Lt=>a.jsx("option",{value:Lt,children:Lt},Lt))]}):et.place||""}),a.jsx("td",{className:"p-2 border",children:Rt?a.jsxs("select",{className:"w-full border p-1 rounded",value:Ie,onChange:Lt=>I(Lt.target.value),children:[a.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),a.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${et.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:et.status})}),a.jsx("td",{className:"p-2 border",children:Rt?a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(j)?"":j,onChange:Lt=>Q(Math.max(0,Number(Lt.target.value||0)))}):Zc(et.creditLimit||0)}),a.jsx("td",{className:"p-2 border font-semibold",children:Zc(et.balance||0)}),a.jsx("td",{className:"p-2 border",children:Rt?a.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:Z,onChange:Lt=>ye(Lt.target.value),maxLength:500}):a.jsx("span",{title:et.notes||"",children:(et.notes||"").length>40?(et.notes||"").slice(0,40)+"":et.notes||""})}),a.jsx("td",{className:"p-2 border",children:a.jsx("div",{className:"flex gap-2 justify-center",children:Rt?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:_e,children:"Guardar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:G,children:"Cancelar"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Ve(et),children:"Editar"}),a.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>Me(et),children:"Borrar"}),a.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>We(et),title:"Ver compras y abonos",children:"Estado de cuenta"})]})})})]},et.id)})})]})}),S&&a.jsx("p",{className:"mt-2 text-sm",children:S}),rt&&$A.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>At(!1)}),a.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>At(!1),type:"button",children:"Cerrar"})]}),a.jsxs("form",{onSubmit:at,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),a.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:d,onChange:et=>A(et.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),a.jsx("input",{className:"w-full border p-2 rounded",value:u,onChange:et=>f(N1(et.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:h,onChange:et=>m(et.target.value),children:[a.jsx("option",{value:"",children:""}),nP.map(et=>a.jsx("option",{value:et,children:et},et))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:x,onChange:et=>b(et.target.value),children:[a.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),a.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:w===0?"":w,onChange:et=>k(Math.max(0,Number(et.target.value||0))),placeholder:"Ej: 2000"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),a.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:p,onChange:et=>g(et.target.value),maxLength:500,placeholder:"Notas del cliente"}),a.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[p.length,"/500"]})]}),a.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[a.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>At(!1),children:"Cancelar"}),a.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),T&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(K==null?void 0:K.name)||""]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{Y(0),Pe(new Date().toISOString().slice(0,10)),tt(""),te(!0)},children:"Abonar"}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>R(!1),children:"Cerrar"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-3",children:[a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),a.jsx("div",{className:"text-xl font-semibold",children:Zc(Se.saldoActual)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),a.jsx("div",{className:"text-xl font-semibold",children:Zc(Se.totalAbonado)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),a.jsx("div",{className:"text-xl font-semibold",children:Zc(Se.saldoActual)})]})]}),a.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Tipo"}),a.jsx("th",{className:"p-2 border",children:"Referencia"}),a.jsx("th",{className:"p-2 border",children:"Comentario"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:re?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):le.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):le.map(et=>{var er,Lt;const Rt=vt===et.id;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:Rt?a.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:Ue,onChange:Vt=>Xe(Vt.target.value)}):et.date||""}),a.jsx("td",{className:"p-2 border",children:et.amount>=0?(er=et.ref)!=null&&er.saleId?a.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver piezas de esta compra",onClick:()=>c(et.ref.saleId),children:"COMPRA (CARGO)"}):a.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):a.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),a.jsx("td",{className:"p-2 border",children:(Lt=et.ref)!=null&&Lt.saleId?`Venta #${et.ref.saleId}`:""}),a.jsx("td",{className:"p-2 border",children:Rt?a.jsx("input",{className:"w-full border p-1 rounded",value:ie,onChange:Vt=>ze(Vt.target.value),placeholder:"Comentario"}):a.jsx("span",{title:et.comment||"",children:(et.comment||"").length>40?(et.comment||"").slice(0,40)+"":et.comment||""})}),a.jsx("td",{className:"p-2 border font-semibold",children:Rt?a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(xe)?"":xe,onChange:Vt=>{const nr=Number(Vt.target.value||0),Mt=Number.isFinite(nr)?Math.max(0,parseFloat(nr.toFixed(2))):0;ve(Mt)},placeholder:"0.00",title:et.type==="ABONO"?"Se guardar como negativo":"Se guardar como positivo"}):Zc(et.amount)}),a.jsx("td",{className:"p-2 border",children:Rt?a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Ot,children:"Guardar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Xt,children:"Cancelar"})]}):a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Ct(et),children:"Editar"}),a.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>tr(et),children:"Borrar"})]})})]},et.id)})})]})})]})}),z&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[a.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(K==null?void 0:K.name)||""]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),a.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:we,onChange:et=>Pe(et.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Monto del abono"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:Ne===0?"":Ne,onChange:et=>{const Rt=Number(et.target.value||0),er=Number.isFinite(Rt)?Math.max(0,parseFloat(Rt.toFixed(2))):0;Y(er)},placeholder:"0.00"}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se guarda con 2 decimales (se registrar como ABONO negativo)."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),a.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Qe,onChange:et=>tt(et.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),a.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[Qe.length,"/250"]})]})]}),a.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[a.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>te(!1),disabled:ot,children:"Cancelar"}),a.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:st,disabled:ot,children:ot?"Guardando...":"Guardar abono"})]})]})}),t&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",s?` #${s}`:""]}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),a.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),a.jsx("th",{className:"p-2 border text-right",children:"Precio"}),a.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),a.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((et,Rt)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border text-left",children:et.productName}),a.jsx("td",{className:"p-2 border text-right",children:et.qty}),a.jsx("td",{className:"p-2 border text-right",children:Zc(et.unitPrice)}),a.jsx("td",{className:"p-2 border text-right",children:Zc(et.discount||0)}),a.jsx("td",{className:"p-2 border text-right",children:Zc(et.total)})]},Rt))})]})})]})})]})}const Rf=t=>`C$ ${(Number(t)||0).toFixed(2)}`,kle=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"];async function Fle(t){if(!t)return 0;const e=Dt(ht(Te,"inventory_clothes_batches"),Gt("productId","==",t)),r=await Nt(e);let n="0000-00-00",s=-1,i=0;return r.forEach(o=>{const l=o.data(),c=String(l.date||"0000-00-00"),d=Number(l.salePrice||0),A=l.createdAt,u=((A==null?void 0:A.seconds)??0)*1e3+((A==null?void 0:A.nanoseconds)??0)/1e6;c>n?(n=c,s=u,i=d):c===n&&u>s&&(s=u,i=d)}),Number(i||0)}async function aP(t){if(!t)return 0;const e=Dt(ht(Te,"inventory_clothes_batches"),Gt("productId","==",t)),r=await Nt(e);let n=0;return r.forEach(s=>n+=Number(s.data().remaining||0)),n}function iP(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function Tle(){const[t,e]=N.useState([]),[r,n]=N.useState([]),[s,i]=N.useState({}),[o,l]=N.useState("CONTADO"),[c,d]=N.useState(""),[A,u]=N.useState(""),[f,h]=N.useState(new Date().toISOString().slice(0,10)),[m,p]=N.useState(""),[g,x]=N.useState([]),b=N.useMemo(()=>g.reduce((ee,z)=>ee+(z.qty||0),0),[g]),w=N.useMemo(()=>{const ee=g.reduce((z,te)=>{const Ne=Math.max(0,(Number(te.unitPrice)||0)*(te.qty||0)-(Number(te.discount)||0));return z+Ne},0);return Math.floor(ee*100)/100},[g]),[k,O]=N.useState(0),[L,E]=N.useState(""),[B,S]=N.useState(!1),[U,_]=N.useState(!1),[F,D]=N.useState(""),[X,ge]=N.useState("+505 "),[ae,fe]=N.useState(""),[me,Z]=N.useState(""),[ye,Ie]=N.useState("ACTIVO"),[I,j]=N.useState(0),Q=()=>{D(""),ge("+505 "),fe(""),Z(""),Ie("ACTIVO"),j(0)};N.useEffect(()=>{(async()=>{const ee=Dt(ht(Te,"customers_clothes"),Ur("createdAt","desc")),z=await Nt(ee),te=[];z.forEach(ot=>{const dt=ot.data();te.push({id:ot.id,name:dt.name??"",phone:dt.phone??"+505 ",place:dt.place??"",status:dt.status??"ACTIVO",creditLimit:Number(dt.creditLimit??0),balance:0})});for(const ot of te)try{const dt=Dt(ht(Te,"ar_movements"),Gt("customerId","==",ot.id)),vt=await Nt(dt);let lt=0;vt.forEach(Ue=>lt+=Number(Ue.data().amount||0)),ot.balance=lt}catch{ot.balance=0}e(te);const Ne=Dt(ht(Te,"products_clothes"),Ur("createdAt","desc")),Y=await Nt(Ne),we=[];Y.forEach(ot=>{const dt=ot.data();we.push({id:ot.id,name:dt.name??"(sin nombre)",sku:dt.sku??""})}),n(we);const Pe=Dt(ht(Te,"inventory_clothes_batches"),Gt("remaining",">",0)),Qe=await Nt(Pe),tt={};Qe.forEach(ot=>{const dt=ot.data(),vt=dt.productId||"",lt=Number(dt.remaining||0);vt&&(tt[vt]=(tt[vt]||0)+lt)}),i(tt)})()},[]);const T=N.useMemo(()=>t.find(ee=>ee.id===c),[t,c]),R=(T==null?void 0:T.balance)||0,K=o==="CREDITO"?R+Math.max(0,Number(w||0))-Math.max(0,Number(k||0)):0,M=async ee=>{if(!ee)return;if(g.some(we=>we.productId===ee)){p("");return}const z=r.find(we=>we.id===ee);if(!z){p("");return}let te=await Fle(ee);te||(te=Number((z==null?void 0:z.price)||0));const Ne=await aP(ee),Y={productId:ee,productName:z.name||"",sku:z.sku||"",unitPrice:Number(te)||0,available:Number(Ne)||0,qty:0,discount:0};x(we=>[...we,Y]),p("")},re=(ee,z)=>{x(te=>te.map(Ne=>{if(Ne.productId!==ee)return Ne;if(z==="")return{...Ne,qty:0};const Y=Math.max(0,Math.floor(Number(z)));return{...Ne,qty:Y}}))},de=(ee,z)=>{x(te=>te.map(Ne=>{if(Ne.productId!==ee)return Ne;if(z==="")return{...Ne,discount:0};const Y=Math.max(0,Math.floor(Number(z)));return{...Ne,discount:Y}}))},le=ee=>x(z=>z.filter(te=>te.productId!==ee)),q=async()=>{if(!f)return"Selecciona la fecha.";if(g.length===0)return"Agrega al menos un producto.";const ee=g.filter(z=>(z.qty||0)>0);if(ee.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(w>0))return"El total debe ser mayor a cero.";if(o==="CONTADO"){if(!A.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!c)return"Selecciona un cliente (crdito).";if(k<0)return"El pago inicial no puede ser negativo.";if(k>w)return"El pago inicial no puede superar el total.";if((T==null?void 0:T.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const z of ee){const te=await aP(z.productId);if(z.qty>te)return`Inventario insuficiente para "${z.productName}". Disponible: ${te} unidades.`;const Ne=(Number(z.unitPrice)||0)*(z.qty||0),Y=Number(z.discount)||0;if(!Number.isInteger(Y)||Y<0)return`El descuento en "${z.productName}" debe ser entero y  0.`;if(Y>Ne)return`El descuento en "${z.productName}" no puede exceder C$ ${Ne.toFixed(2)}.`}return null},Se=async ee=>{ee.preventDefault(),E("");const z=await q();if(z){E(" "+z);return}try{S(!0);const te=g.filter(Pe=>(Pe.qty||0)>0).map(Pe=>{const Qe=(Number(Pe.unitPrice)||0)*(Pe.qty||0),tt=Math.max(0,Math.floor(Number(Pe.discount)||0)),ot=Math.max(0,Qe-tt);return{productId:Pe.productId,productName:Pe.productName,sku:Pe.sku||"",qty:Pe.qty,unitPrice:Number(Pe.unitPrice)||0,discount:tt,total:Math.floor(ot*100)/100}}),Ne={type:o,date:f,createdAt:$t.now(),itemsTotal:Number(w)||0,total:Number(w)||0,quantity:Number(b)||0,items:te};o==="CONTADO"?Ne.customerName=A.trim():(Ne.customerId=c,Ne.downPayment=Number(k)||0);const Y=await Jr(ht(Te,"sales_clothes"),Ne);if(o==="CREDITO"&&c){const Pe={customerId:c,date:f,createdAt:$t.now(),ref:{saleId:Y.id}};await Jr(ht(Te,"ar_movements"),{...Pe,type:"CARGO",amount:Number(w)||0}),Number(k)>0&&await Jr(ht(Te,"ar_movements"),{...Pe,type:"ABONO",amount:-Number(k)})}const we={};for(const Pe of te)if(Pe.qty>0){const{allocations:Qe}=await Ile({productId:Pe.productId,quantity:Pe.qty,saleDate:f,saleId:Y.id});we[Pe.productId]={productId:Pe.productId,allocations:Qe}}await Pr(kt(Te,"sales_clothes",Y.id),{allocationsByItem:we}),l("CONTADO"),d(""),u(""),h(new Date().toISOString().slice(0,10)),x([]),O(0),o==="CREDITO"&&c&&e(Pe=>Pe.map(Qe=>Qe.id===c?{...Qe,balance:(Qe.balance||0)+(Number(w)||0)-(Number(k)||0)}:Qe)),E(" Venta registrada"),(async()=>{const Pe=Dt(ht(Te,"inventory_clothes_batches"),Gt("remaining",">",0)),Qe=await Nt(Pe),tt={};Qe.forEach(ot=>{const dt=ot.data(),vt=dt.productId||"",lt=Number(dt.remaining||0);vt&&(tt[vt]=(tt[vt]||0)+lt)}),i(tt)})()}catch(te){console.error(te),E(" Error al guardar la venta")}finally{S(!1)}};return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas (Ropa)"}),a.jsxs("form",{onSubmit:Se,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:ee=>l(ee.target.value),children:[a.jsx("option",{value:"CONTADO",children:"Contado"}),a.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),o==="CONTADO"?a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),a.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:A,onChange:ee=>u(ee.target.value)})]}):a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("select",{className:"flex-1 border p-2 rounded",value:c,onChange:ee=>d(ee.target.value),children:[a.jsx("option",{value:"",children:"Selecciona un cliente"}),t.map(ee=>a.jsxs("option",{value:ee.status==="ACTIVO"?ee.id:"",disabled:ee.status==="BLOQUEADO",children:[ee.name," | ",ee.phone," | Saldo: ",Rf(ee.balance||0)]},ee.id))]}),a.jsx("button",{type:"button",className:"px-20 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>_(!0),children:"Crear Cliente"})]}),a.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),a.jsx("div",{className:"text-lg font-semibold",children:Rf(R)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:k===0?"":k,onChange:ee=>O(Math.max(0,Number(ee.target.value||0))),placeholder:"0.00"})]}),a.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),a.jsx("div",{className:"text-lg font-semibold",children:Rf(K)})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),a.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:f,onChange:ee=>h(ee.target.value)})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:m,onChange:async ee=>{const z=ee.target.value;p(z),await M(z)},children:[a.jsx("option",{value:"",children:"Selecciona un producto"}),r.map(ee=>{const z=g.some(Y=>Y.productId===ee.id),te=s[ee.id]||0,Ne=z||te<=0;return a.jsxs("option",{value:Ne?"":ee.id,disabled:Ne,children:[ee.name," ",ee.sku?` ${ee.sku}`:""," ",te>0?`(disp: ${te})`:"(sin stock)",z?" (seleccionado)":""]},ee.id)})]}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Productos sin existencias se muestran en gris y no se pueden seleccionar."})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsxs("div",{className:"border rounded overflow-hidden",children:[a.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[a.jsx("div",{className:"col-span-4",children:"Producto"}),a.jsx("div",{className:"col-span-2 text-right",children:"Precio"}),a.jsx("div",{className:"col-span-2 text-right",children:"Existencias"}),a.jsx("div",{className:"col-span-1 text-right",children:"Cantidad"}),a.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),a.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),a.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),g.length===0?a.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):g.map(ee=>{const z=Math.max(0,(ee.available||0)-(ee.qty||0)),te=(Number(ee.unitPrice)||0)*(ee.qty||0),Ne=Math.max(0,te-(Number(ee.discount)||0));return a.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[a.jsx("div",{className:"col-span-4",children:a.jsxs("div",{className:"font-medium",children:[ee.productName,ee.sku?`  ${ee.sku}`:""]})}),a.jsx("div",{className:"col-span-2 text-right",children:Rf(ee.unitPrice)}),a.jsx("div",{className:"col-span-2 text-right",children:z}),a.jsx("div",{className:"col-span-1",children:a.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(ee.qty)||ee.qty===0?"":ee.qty,onChange:Y=>re(ee.productId,Y.target.value),inputMode:"numeric",placeholder:"0",title:"Cantidad de piezas"})}),a.jsx("div",{className:"col-span-1",children:a.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(ee.discount)||ee.discount===0?"":ee.discount,onChange:Y=>de(ee.productId,Y.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento entero (C$)"})}),a.jsx("div",{className:"col-span-1 text-right",children:Rf(Ne)}),a.jsx("div",{className:"col-span-1 text-center",children:a.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>le(ee.productId),title:"Quitar producto",children:""})})]},ee.productId)})]}),g.length>0&&a.jsxs("div",{className:"flex justify-end gap-6 mt-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Piezas totales: "}),a.jsx("span",{className:"font-semibold",children:b})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Total: "}),a.jsx("span",{className:"font-semibold",children:Rf(w)})]})]})]}),a.jsx("div",{className:"md:col-span-2",children:a.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:B,children:B?"Guardando...":"Registrar venta"})})]}),L&&a.jsx("p",{className:"mt-2 text-sm",children:L}),U&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-xl p-4",children:[a.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),a.jsx("input",{className:"w-full border p-2 rounded",value:F,onChange:ee=>D(ee.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),a.jsx("input",{className:"w-full border p-2 rounded",value:X,onChange:ee=>ge(iP(ee.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:ae,onChange:ee=>fe(ee.target.value),children:[a.jsx("option",{value:"",children:""}),kle.map(ee=>a.jsx("option",{value:ee,children:ee},ee))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:ye,onChange:ee=>Ie(ee.target.value),children:[a.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),a.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:I===0?"":I,onChange:ee=>j(Math.max(0,Number(ee.target.value||0))),placeholder:"Ej: 2000"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),a.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:me,onChange:ee=>Z(ee.target.value),maxLength:500})]})]}),a.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[a.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Q(),_(!1)},children:"Cancelar"}),a.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{if(E(""),!F.trim()){E("Ingresa el nombre del nuevo cliente.");return}const ee=iP(X);try{const z=await Jr(ht(Te,"customers_clothes"),{name:F.trim(),phone:ee,place:ae||"",notes:me||"",status:ye,creditLimit:Number(I||0),createdAt:$t.now()}),te={id:z.id,name:F.trim(),phone:ee,place:ae||"",status:ye,creditLimit:Number(I||0),balance:0};e(Ne=>[te,...Ne]),d(z.id),Q(),_(!1),E(" Cliente creado")}catch(z){console.error(z),E(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),B&&a.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[a.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),a.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const la=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function vy(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?or(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function Ple(t,e){const r=vy(t);if(!r)return null;if(Array.isArray(t.items))return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??0),items:t.items.map(o=>({productId:String(o.productId||""),productName:String(o.productName||""),sku:o.sku||"",qty:Number(o.qty||0),unitPrice:Number(o.unitPrice??(Number(o.total||0)/Math.max(1,Number(o.qty||0))||0)),discount:Number(o.discount||0)})),customerId:t.customerId||void 0,customerName:t.customerName||void 0};const n=t.item||{},s=Number(t.quantity??n.qty??0),i=Number(t.total??t.itemsTotal??n.total??0);return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total??t.itemsTotal??i??0),items:[{productId:String(n.productId||t.productId||""),productName:String(n.productName||t.productName||""),sku:n.sku||t.sku||"",qty:s,unitPrice:Number(n.unitPrice??(i&&s?i/s:0)),discount:Number(n.discount||0)}],customerId:t.customerId||void 0,customerName:t.customerName||void 0}}function Rle(t,e,r,n){const s={};for(const l of t)s[l.productId]||(s[l.productId]={productName:l.productName,lots:[]}),s[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(s))s[l].lots.sort((c,d)=>c.date.localeCompare(d.date));const i=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of i)for(const c of l.items||[]){const d=s[c.productId];if(!d)continue;let A=Number(c.qty||0);if(!(A<=0))for(const u of d.lots){if(A<=0)break;if(u.qtyLeft<=0)continue;const f=Math.min(u.qtyLeft,A);l.date>=r&&l.date<=n&&(o+=f*u.cost),u.qtyLeft-=f,A-=f}}return o}function Dle(){const{refreshKey:t,refresh:e}=vl(),[r,n]=N.useState(or(jc(new Date),"yyyy-MM-dd")),[s,i]=N.useState(or(Ic(new Date),"yyyy-MM-dd")),[o,l]=N.useState([]),[c,d]=N.useState([]),[A,u]=N.useState([]),[f,h]=N.useState([]),[m,p]=N.useState([]),[g,x]=N.useState([]),[b,w]=N.useState(!0),[k,O]=N.useState(""),[L,E]=N.useState(!1),[B,S]=N.useState(null),[U,_]=N.useState([]),[F,D]=N.useState(!1),[X,ge]=N.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});N.useEffect(()=>{(async()=>{w(!0),O("");try{const I=await Nt(ht(Te,"sales_clothes")),j=[],Q=[];I.forEach(ee=>{const z=ee.data(),te=Ple(z,ee.id);te&&(te.date<=s&&j.push(te),te.date>=r&&te.date<=s&&Q.push(te))}),d(j),l(Q);const T=await Nt(ht(Te,"inventory_clothes_batches")),R=[];T.forEach(ee=>{const z=ee.data(),te=vy(z);!te||te>s||R.push({id:ee.id,productId:z.productId,productName:z.productName||"",date:te,quantity:Number(z.quantity||0),remaining:Number(z.remaining||0),purchasePrice:Number(z.purchasePrice||0)})}),u(R);const K=await Nt(ht(Te,"expenses_clothes")),M=[];K.forEach(ee=>{const z=ee.data(),te=vy(z);te&&te>=r&&te<=s&&M.push({id:ee.id,date:te,category:z.category||"",description:z.description||"",amount:Number(z.amount||0),status:z.status||""})}),h(M);const re=await Nt(ht(Te,"ar_movements")),de=[],le={};re.forEach(ee=>{const z=ee.data(),te=vy(z);if(!te)return;const Ne=z.customerId,Y=Number(z.amount||0);Ne&&(le[Ne]=(le[Ne]||0)+Y),z.type==="ABONO"&&te>=r&&te<=s&&de.push({id:ee.id,customerId:Ne,type:"ABONO",amount:Y,date:te})}),p(de);const q=await Nt(ht(Te,"customers_clothes")),Se=[];q.forEach(ee=>{const z=ee.data();Se.push({id:ee.id,name:z.name||"",balance:le[ee.id]||0})}),x(Se)}catch(I){console.error(I),O(" Error cargando datos del dashboard.")}finally{w(!1)}})()},[r,s,t]);const ae=N.useMemo(()=>{try{return Rle(A,c,r,s)}catch(I){return console.error(I),0}},[A,c,r,s]),fe=N.useMemo(()=>{const I=o.reduce((le,q)=>le+(q.total||0),0),j=f.reduce((le,q)=>le+(q.amount||0),0),Q=I-ae,T=Q-j,R=m.reduce((le,q)=>le+Math.abs(q.amount||0),0),K=g.filter(le=>(le.balance||0)>0),M=K.reduce((le,q)=>le+(q.balance||0),0);let re=0,de=0;for(const le of o){const q=(le.items||[]).reduce((Se,ee)=>Se+(Number(ee.qty)||0),0);le.type==="CONTADO"?re+=q:de+=q}return{ventasTotales:I,costoMercaderia:ae,gastosPeriodo:j,gananciaAntes:Q,gananciaDespues:T,abonosRecibidos:R,saldosPendientes:M,clientesConSaldo:K.length,prendasCash:re,prendasCredito:de}},[o,f,m,g,ae]),me=N.useMemo(()=>{const I={};for(const j of o){if(j.type!=="CREDITO"||!j.customerId)continue;const Q=(j.items||[]).reduce((T,R)=>T+(Number(R.qty)||0),0);I[j.customerId]=(I[j.customerId]||0)+Q}return g.filter(j=>(j.balance||0)>0).map(j=>({customerId:j.id,name:j.name,prendasCredito:I[j.id]||0,saldo:j.balance||0})).sort((j,Q)=>Q.saldo-j.saldo)},[g,o]),Z=N.useMemo(()=>{const I={};return g.forEach(j=>I[j.id]=j.name),I},[g]),ye=N.useMemo(()=>[...o].sort((I,j)=>j.date.localeCompare(I.date)).map(I=>{var T;const j=(I.items||[]).reduce((R,K)=>R+(Number(K.qty)||0),0);let Q="Cash";return I.type==="CREDITO"&&I.customerId?Q=Z[I.customerId]||"":I.type==="CONTADO"&&(Q=((T=I.customerName)==null?void 0:T.trim())||"Cash"),{id:I.id,date:I.date,type:I.type==="CREDITO"?"Crdito":"Cash",customer:Q,piezas:j,total:Number(I.total||0)}}),[o,Z]),Ie=async I=>{E(!0),S({id:I.customerId,name:I.name}),_([]),D(!0),ge({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const j=[];let Q=0,T=0,R=0;for(const de of o)if(!(de.type!=="CREDITO"||de.customerId!==I.customerId))for(const le of de.items||[]){const q=Number(le.qty||0),Se=Number(le.unitPrice||0),ee=q*Se,z=Math.max(0,Number(le.discount||0)),te=Math.max(0,ee-z);j.push({saleId:de.id,date:de.date,productName:le.productName,sku:le.sku||"",qty:q,unitPrice:Se,lineTotal:ee,discount:z,lineFinal:te}),Q+=ee,T+=z,R+=te}let K=0;for(const de of m)de.customerId===I.customerId&&(K+=Math.abs(de.amount||0));const M=g.find(de=>de.id===I.customerId),re=(M==null?void 0:M.balance)||0;_(j),ge({totalBruto:Q,totalDescuento:T,totalFiado:R,saldoActual:re,abonadoPeriodo:K})}catch(j){console.error(j),O(" No se pudo cargar el detalle del cliente.")}finally{D(!1)}};return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Ropa)"}),a.jsx(Zl,{onClick:e,loading:b})]}),a.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:I=>n(I.target.value)})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s,onChange:I=>i(I.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-4 gap-3 mb-4",children:[a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),a.jsx("div",{className:"text-xl font-semibold",children:la(fe.ventasTotales)}),a.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Cash + Crdito del periodo."})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),a.jsx("div",{className:"text-xl font-semibold",children:la(fe.costoMercaderia)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia antes de Gastos"}),a.jsx("div",{className:"text-xl font-semibold text-green-600",children:la(fe.gananciaAntes)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Gastos del Negocio"}),a.jsx("div",{className:"text-xl font-semibold",children:la(fe.gastosPeriodo)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia despus de Gastos"}),a.jsx("div",{className:"text-xl font-semibold text-green-600",children:la(fe.gananciaDespues)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),a.jsx("div",{className:"text-xl font-semibold",children:la(fe.abonosRecibidos)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),a.jsx("div",{className:"text-xl font-semibold",children:la(fe.saldosPendientes)}),a.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),a.jsx("div",{className:"text-xl font-semibold",children:fe.clientesConSaldo})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Cash"}),a.jsx("div",{className:"text-xl font-semibold",children:fe.prendasCash})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Prendas Crdito (vendidas)"}),a.jsx("div",{className:"text-xl font-semibold",children:fe.prendasCredito})]})]}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado por cliente"}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Cliente"}),a.jsx("th",{className:"p-2 border",children:"Prendas Crdito (periodo)"}),a.jsx("th",{className:"p-2 border",children:"Saldo actual"})]})}),a.jsx("tbody",{children:b?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Cargando"})}):me.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:3,children:"Sin clientes con saldo"})}):me.map(I=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:I.name}),a.jsx("td",{className:"p-2 border",children:a.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>Ie({customerId:I.customerId,name:I.name}),title:"Ver piezas fiadas del periodo",children:I.prendasCredito})}),a.jsx("td",{className:"p-2 border font-semibold",children:la(I.saldo)})]},I.customerId))})]})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Transacciones del periodo"}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Cliente"}),a.jsx("th",{className:"p-2 border",children:"Tipo"}),a.jsx("th",{className:"p-2 border",children:"Piezas"}),a.jsx("th",{className:"p-2 border",children:"Monto"})]})}),a.jsx("tbody",{children:b?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):ye.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin transacciones en el rango seleccionado."})}):ye.map(I=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:I.date}),a.jsx("td",{className:"p-2 border",children:I.customer}),a.jsx("td",{className:"p-2 border",children:I.type}),a.jsx("td",{className:"p-2 border",children:I.piezas}),a.jsx("td",{className:"p-2 border",children:la(I.total)})]},I.id))})]})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gastos del periodo"}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Categora"}),a.jsx("th",{className:"p-2 border",children:"Descripcin"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Estado"})]})}),a.jsx("tbody",{children:b?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):f.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):f.sort((I,j)=>I.date.localeCompare(j.date)).map(I=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:I.date}),a.jsx("td",{className:"p-2 border",children:I.category||""}),a.jsx("td",{className:"p-2 border",children:I.description?a.jsx("span",{title:I.description,children:I.description.length>40?I.description.slice(0,40)+"":I.description}):""}),a.jsx("td",{className:"p-2 border",children:la(I.amount)}),a.jsx("td",{className:"p-2 border",children:I.status||""})]},I.id))})]})}),k&&a.jsx("p",{className:"mt-2 text-sm",children:k}),L&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h3",{className:"text-lg font-bold",children:["Detalle del cliente  ",(B==null?void 0:B.name)||""]}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>E(!1),children:"Cerrar"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Total Bruto (periodo)"}),a.jsx("div",{className:"text-xl font-semibold",children:la(X.totalBruto)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),a.jsx("div",{className:"text-xl font-semibold",children:la(X.totalDescuento)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Monto Total Fiado (periodo)"}),a.jsx("div",{className:"text-xl font-semibold",children:la(X.totalFiado)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),a.jsx("div",{className:"text-xl font-semibold",children:la(X.saldoActual)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),a.jsx("div",{className:"text-xl font-semibold",children:la(X.abonadoPeriodo)})]})]}),a.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha compra"}),a.jsx("th",{className:"p-2 border",children:"Pieza"}),a.jsx("th",{className:"p-2 border",children:"SKU"}),a.jsx("th",{className:"p-2 border",children:"Cant."}),a.jsx("th",{className:"p-2 border",children:"P. Unit"}),a.jsx("th",{className:"p-2 border",children:"Monto"})," ",a.jsx("th",{className:"p-2 border",children:"Descuento"})," ",a.jsx("th",{className:"p-2 border",children:"Monto final"})," "]})}),a.jsx("tbody",{children:F?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):U.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin piezas fiadas en el periodo."})}):U.sort((I,j)=>I.date.localeCompare(j.date)).map((I,j)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:I.date}),a.jsx("td",{className:"p-2 border",children:I.productName}),a.jsx("td",{className:"p-2 border",children:I.sku||""}),a.jsx("td",{className:"p-2 border",children:I.qty}),a.jsx("td",{className:"p-2 border",children:la(I.unitPrice)}),a.jsx("td",{className:"p-2 border",children:la(I.lineTotal)}),a.jsx("td",{className:"p-2 border",children:la(I.discount)}),a.jsx("td",{className:"p-2 border",children:la(I.lineFinal)})]},`${I.saleId}-${j}`))})]})})]})})]})}const oP=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],C1=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Lle(){const[t,e]=N.useState(or(jc(new Date),"yyyy-MM-dd")),[r,n]=N.useState(or(Ic(new Date),"yyyy-MM-dd")),[s,i]=N.useState(or(new Date,"yyyy-MM-dd")),[o,l]=N.useState(""),[c,d]=N.useState(""),[A,u]=N.useState(0),[f,h]=N.useState("PENDIENTE"),[m,p]=N.useState(""),[g,x]=N.useState([]),[b,w]=N.useState(!0),[k,O]=N.useState(""),[L,E]=N.useState(null),[B,S]=N.useState(""),[U,_]=N.useState(""),[F,D]=N.useState(""),[X,ge]=N.useState(0),[ae,fe]=N.useState("PENDIENTE"),[me,Z]=N.useState("");N.useEffect(()=>{(async()=>{w(!0);try{const M=Dt(ht(Te,"expenses_clothes"),Ur("date","desc")),re=await Nt(M),de=[];re.forEach(le=>{const q=le.data();de.push({id:le.id,date:q.date||or(new Date,"yyyy-MM-dd"),category:q.category||"",description:q.description||"",amount:Number(q.amount||0),status:q.status||"PENDIENTE",notes:q.notes||"",createdAt:q.createdAt??$t.now()})}),x(de)}catch(M){console.error(M),O(" Error al cargar gastos")}finally{w(!1)}})()},[]);const ye=N.useMemo(()=>g.filter(M=>!(t&&M.date<t||r&&M.date>r)),[g,t,r]),Ie=N.useMemo(()=>{const M=ye.reduce((le,q)=>le+(q.amount||0),0),re=ye.filter(le=>le.status==="PAGADO").reduce((le,q)=>le+(q.amount||0),0),de=M-re;return{total:M,pagado:re,pendiente:de}},[ye]),I=()=>{i(or(new Date,"yyyy-MM-dd")),l(""),d(""),u(0),h("PENDIENTE"),p("")},j=async M=>{if(M.preventDefault(),O(""),!o){O("Selecciona una categora.");return}if(!c.trim()){O("Ingresa una descripcin.");return}if(!A||A<=0){O("Ingresa un monto vlido.");return}try{const re=await Jr(ht(Te,"expenses_clothes"),{date:s,category:o,description:c.trim(),amount:Number(A.toFixed(2)),status:f,notes:m||"",createdAt:$t.now()});x(de=>[{id:re.id,date:s,category:o,description:c.trim(),amount:Number(A.toFixed(2)),status:f,notes:m||"",createdAt:$t.now()},...de]),I(),O(" Gasto registrado")}catch(re){console.error(re),O(" Error al guardar gasto")}},Q=M=>{E(M.id),S(M.date),_(M.category||""),D(M.description||""),ge(Number(M.amount||0)),fe(M.status||"PENDIENTE"),Z(M.notes||"")},T=()=>{E(null),S(""),_(""),D(""),ge(0),fe("PENDIENTE"),Z("")},R=async()=>{if(L){if(!U){O("Selecciona una categora.");return}if(!F.trim()){O("Ingresa una descripcin.");return}if(!X||X<=0){O("Ingresa un monto vlido.");return}try{await Pr(kt(Te,"expenses_clothes",L),{date:B,category:U,description:F.trim(),amount:Number(X.toFixed(2)),status:ae,notes:me||""}),x(M=>M.map(re=>re.id===L?{...re,date:B,category:U,description:F.trim(),amount:Number(X.toFixed(2)),status:ae,notes:me||""}:re)),T(),O(" Gasto actualizado")}catch(M){console.error(M),O(" Error al actualizar gasto")}}},K=async M=>{confirm(`Eliminar el gasto "${M.description}"?`)&&(await un(kt(Te,"expenses_clothes",M.id)),x(de=>de.filter(le=>le.id!==M.id)),O(" Gasto borrado"))};return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Ropa)"}),a.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:M=>e(M.target.value)})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:M=>n(M.target.value)})]}),a.jsxs("div",{className:"ml-auto text-sm",children:[a.jsx("div",{className:"font-semibold",children:"Totales del rango"}),a.jsxs("div",{children:["Total: ",C1(Ie.total)]}),a.jsxs("div",{children:["Pagado: ",C1(Ie.pagado)]}),a.jsxs("div",{children:["Pendiente: ",C1(Ie.pendiente)]})]})]}),a.jsxs("form",{onSubmit:j,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),a.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:s,onChange:M=>i(M.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:M=>l(M.target.value),children:[a.jsx("option",{value:"",children:"Selecciona"}),oP.map(M=>a.jsx("option",{value:M,children:M},M))]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),a.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:M=>d(M.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:A===0?"":A,onChange:M=>u(Math.max(0,Number(M.target.value||0))),placeholder:"0.00"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:f,onChange:M=>h(M.target.value),children:[a.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),a.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),a.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:M=>p(M.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),a.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),a.jsx("div",{className:"md:col-span-2",children:a.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Categora"}),a.jsx("th",{className:"p-2 border",children:"Descripcin"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Estado"}),a.jsx("th",{className:"p-2 border",children:"Comentario"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:b?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):ye.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):ye.slice().sort((M,re)=>M.date.localeCompare(re.date)).map(M=>{const re=L===M.id;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:re?a.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:B,onChange:de=>S(de.target.value)}):M.date}),a.jsx("td",{className:"p-2 border",children:re?a.jsxs("select",{className:"w-full border p-1 rounded",value:U,onChange:de=>_(de.target.value),children:[a.jsx("option",{value:"",children:"Selecciona"}),oP.map(de=>a.jsx("option",{value:de,children:de},de))]}):M.category||""}),a.jsx("td",{className:"p-2 border",children:re?a.jsx("input",{className:"w-full border p-1 rounded",value:F,onChange:de=>D(de.target.value)}):a.jsx("span",{title:M.description,children:M.description.length>40?M.description.slice(0,40)+"":M.description})}),a.jsx("td",{className:"p-2 border",children:re?a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(X)?"":X,onChange:de=>ge(Math.max(0,Number(de.target.value||0)))}):C1(M.amount)}),a.jsx("td",{className:"p-2 border",children:re?a.jsxs("select",{className:"w-full border p-1 rounded",value:ae,onChange:de=>fe(de.target.value),children:[a.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),a.jsx("option",{value:"PAGADO",children:"Pagado"})]}):a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${M.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:M.status})}),a.jsx("td",{className:"p-2 border",children:re?a.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:me,onChange:de=>Z(de.target.value),maxLength:500}):a.jsx("span",{title:M.notes||"",children:(M.notes||"").length>40?(M.notes||"").slice(0,40)+"":M.notes||""})}),a.jsx("td",{className:"p-2 border",children:a.jsx("div",{className:"flex gap-2 justify-center",children:re?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:R,children:"Guardar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:T,children:"Cancelar"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Q(M),children:"Editar"}),a.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>K(M),children:"Borrar"})]})})})]},M.id)})})]})}),k&&a.jsx("p",{className:"mt-2 text-sm",children:k})]})}const Il=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function Ule(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?or(t.createdAt.toDate(),"yyyy-MM-dd"):""}function Ole(t,e){const r=Ule(t);if(!r)return null;const n=t.item||{},s=Number((n==null?void 0:n.qty)??t.quantity??0)||0,i=Number((n==null?void 0:n.total)??t.total??0)||0,o=Number((n==null?void 0:n.unitPrice)??(s>0?i/s:0))||0;return{id:e,date:r,type:t.type||"CONTADO",total:Number(t.total||0),quantity:Number(t.quantity||s||0),customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),item:{productId:String((n==null?void 0:n.productId)||t.productId||""),productName:String((n==null?void 0:n.productName)||t.productName||""),sku:(n==null?void 0:n.sku)||t.sku||"",qty:s,unitPrice:o,total:s*o}}}async function Mle(t,e){if(e<=0)return;const r=Dt(ht(Te,"inventory_clothes_batches"),Gt("productId","==",t)),n=await Nt(r),s=[];n.forEach(o=>{const l=o.data();s.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),s.sort((o,l)=>o.date.localeCompare(l.date));let i=e;for(const o of s){if(i<=0)break;if(o.remaining<=0)continue;const l=Math.min(o.remaining,i);i-=l,await Pr(kt(Te,"inventory_clothes_batches",o.id),{remaining:Math.max(0,Number((o.remaining-l).toFixed(0)))})}i>0&&console.warn("consumeFIFO: falt inventario",i)}async function Qle(t,e){if(e<=0)return;const r=Dt(ht(Te,"inventory_clothes_batches"),Gt("productId","==",t)),n=await Nt(r),s=[];n.forEach(o=>{const l=o.data();s.push({id:o.id,productId:l.productId,date:l.date||"",quantity:Number(l.quantity||0),remaining:Number(l.remaining||0)})}),s.sort((o,l)=>o.date.localeCompare(l.date));let i=e;for(const o of s){if(i<=0)break;const l=Math.max(0,o.quantity-o.remaining);if(l<=0)continue;const c=Math.min(l,i);i-=c,await Pr(kt(Te,"inventory_clothes_batches",o.id),{remaining:Number((o.remaining+c).toFixed(0))})}i>0&&console.warn("restoreFIFO: no se devolvi todo",i)}async function a8(t){const e=Dt(ht(Te,"ar_movements"),Gt("ref.saleId","==",t)),r=await Nt(e);await Promise.all(r.docs.map(n=>un(kt(Te,"ar_movements",n.id))))}async function Vle(t,e,r){if(await a8(t.id),t.type!=="CREDITO"||!t.customerId)return;const n={customerId:t.customerId,date:t.date,createdAt:$t.now(),ref:{saleId:t.id}},{addDoc:s}=await xd(async()=>{const{addDoc:o}=await Promise.resolve().then(()=>eY);return{addDoc:o}},void 0);await s(ht(Te,"ar_movements"),{...n,type:"CARGO",amount:Number(e)||0});const i=Math.max(0,Number(r??t.downPayment??0));i>0&&await s(ht(Te,"ar_movements"),{...n,type:"ABONO",amount:-i})}function Hle(){const[t,e]=N.useState(!1),[r,n]=N.useState(!1),[s,i]=N.useState(null),[o,l]=N.useState([]),c=async ee=>{e(!0),n(!0),i(ee),l([]);try{const te=(await Nt(Dt(ht(Te,"sales_clothes"),Gt("__name__","==",ee)))).docs[0],Ne=te==null?void 0:te.data(),we=(Array.isArray(Ne==null?void 0:Ne.items)?Ne.items:Ne!=null&&Ne.item?[Ne.item]:[]).map(Pe=>({productName:String(Pe.productName||""),qty:Number(Pe.qty||0),unitPrice:Number(Pe.unitPrice||0),discount:Number(Pe.discount||0),total:Number(Pe.total||0)}));l(we)}catch(z){console.error(z)}finally{n(!1)}},[d,A]=N.useState(or(new Date,"yyyy-MM-01")),[u,f]=N.useState(or(new Date,"yyyy-MM-dd")),[h,m]=N.useState([]),[p,g]=N.useState([]),[x,b]=N.useState(!0),[w,k]=N.useState(""),[O,L]=N.useState(""),[E,B]=N.useState(""),[S,U]=N.useState(null),[_,F]=N.useState(!1),[D,X]=N.useState(null),[ge,ae]=N.useState(0),fe=15,[me,Z]=N.useState(1),ye=N.useMemo(()=>{const ee={};return h.forEach(z=>ee[z.id]=z.name),ee},[h]);N.useEffect(()=>{(async()=>{b(!0),k("");try{const ee=await Nt(ht(Te,"customers_clothes")),z=[];ee.forEach(Y=>z.push({id:Y.id,name:Y.data().name||""})),m(z);const te=await Nt(Dt(ht(Te,"sales_clothes"),Ur("createdAt","desc"))),Ne=[];te.forEach(Y=>{const we=Ole(Y.data(),Y.id);we&&we.date>=d&&we.date<=u&&Ne.push(we)}),g(Ne.sort((Y,we)=>we.date.localeCompare(Y.date))),Z(1)}catch(ee){console.error(ee),k(" Error cargando transacciones.")}finally{b(!1)}})()},[d,u]);const Ie=N.useMemo(()=>p.filter(ee=>!(O&&ee.customerId!==O||E&&ee.type!==E)),[p,O,E]),I=N.useMemo(()=>{let ee=0,z=0,te=0,Ne=0;for(const Y of Ie)Y.type==="CONTADO"?(ee+=Y.item.qty,te+=Y.total):(z+=Y.item.qty,Ne+=Y.total);return{piezasCash:ee,piezasCredito:z,montoCash:te,montoCredito:Ne}},[Ie]),j=Math.max(1,Math.ceil(Ie.length/fe)),Q=N.useMemo(()=>{const ee=(me-1)*fe;return Ie.slice(ee,ee+fe)},[Ie,me]),T=ee=>{U(null),X(ee),ae(ee.item.qty||0),F(!0)},R=async ee=>{if(U(null),!!window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{b(!0),await IE(ee.id),await a8(ee.id),g(z=>z.filter(te=>te.id!==ee.id)),k(" Venta eliminada")}catch(z){console.error(z),k(" No se pudo eliminar la venta.")}finally{b(!1)}},K=async()=>{if(!D)return;const ee=Number(D.item.qty||0),z=Math.max(1,Math.floor(Number(ge)||0));if(z===ee){F(!1);return}const te=Number(D.item.unitPrice||0),Ne=Number((te*z).toFixed(2));try{b(!0);const Y=z-ee;Y>0?await Mle(D.item.productId,Y):Y<0&&await Qle(D.item.productId,-Y);const we=kt(Te,"sales_clothes",D.id);await Pr(we,{quantity:z,total:Ne,itemsTotal:Ne,"item.qty":z,"item.total":Ne,updatedAt:$t.now()});const Pe=Math.min(Number(D.downPayment||0),Ne);await Vle(D,Ne,Pe),g(Qe=>Qe.map(tt=>tt.id===D.id?{...tt,quantity:z,total:Ne,item:{...tt.item,qty:z,total:Ne},downPayment:Pe}:tt)),k(" Venta actualizada"),F(!1)}catch(Y){console.error(Y),k(" No se pudo actualizar la venta.")}finally{b(!1)}},M=()=>{const ee=`Reporte de transacciones (Ropa)  ${d} a ${u}`,z=we=>(we||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),te=Ie.map(we=>{const Pe=we.customerName||(we.customerId?ye[we.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${we.date}</td>
          <td>${z(Pe)}</td>
          <td>${we.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${we.item.qty}</td>
          <td style="text-align:right">${Il(we.total)}</td>
        </tr>`}).join(""),Ne=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${z(ee)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${z(ee)}</h1>
      <div class="kpis">
        <div><b>Piezas Cash:</b> ${I.piezasCash}</div>
        <div><b>Piezas Crdito:</b> ${I.piezasCredito}</div>
        <div><b>Monto Cash:</b> ${Il(I.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${Il(I.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Piezas</th><th>Monto</th>
      </tr></thead><tbody>
      ${te||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,Y=window.open("","_blank");Y&&(Y.document.open(),Y.document.write(Ne),Y.document.close())},re=()=>Z(1),de=()=>Z(ee=>Math.max(1,ee-1)),le=()=>Z(ee=>Math.min(j,ee+1)),q=()=>Z(j),Se=()=>{const ee=[];if(j<=7)for(let te=1;te<=j;te++)ee.push(te);else{const te=Math.max(1,me-2),Ne=Math.min(j,me+2);ee.push(1),te>2&&ee.push(-1);for(let Y=te;Y<=Ne;Y++)Y!==1&&Y!==j&&ee.push(Y);Ne<j-1&&ee.push(-2),ee.push(j)}return a.jsxs("div",{className:"flex items-center gap-1 justify-between mt-3",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:re,disabled:me===1,children:" Primero"}),a.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:de,disabled:me===1,children:" Anterior"}),ee.map((te,Ne)=>typeof te=="number"?a.jsx("button",{className:`px-3 py-1 border rounded ${te===me?"bg-blue-600 text-white":""}`,onClick:()=>Z(te),children:te},Ne):a.jsx("span",{className:"px-2",children:""},Ne)),a.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:le,disabled:me===j,children:"Siguiente "}),a.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:q,disabled:me===j,children:"ltimo "})]}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",me," de ",j,"  ",Ie.length," transaccin(es)"]})]})};return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Reporte de transacciones (Ropa)"}),a.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap gap-3 items-end text-sm",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block font-semibold",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:ee=>{A(ee.target.value),Z(1)}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block font-semibold",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:u,onChange:ee=>{f(ee.target.value),Z(1)}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),a.jsxs("select",{className:"border rounded px-2 py-1 min-w-[220px]",value:O,onChange:ee=>{L(ee.target.value),Z(1)},children:[a.jsx("option",{value:"",children:"Todos"}),h.map(ee=>a.jsx("option",{value:ee.id,children:ee.name},ee.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block font-semibold",children:"Tipo"}),a.jsxs("select",{className:"border rounded px-2 py-1",value:E,onChange:ee=>{B(ee.target.value),Z(1)},children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"CONTADO",children:"Cash"}),a.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),a.jsx("button",{className:"ml-auto px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:M,children:"Exportar PDF"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Cash"}),a.jsx("div",{className:"text-xl font-semibold",children:I.piezasCash})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Piezas Crdito"}),a.jsx("div",{className:"text-xl font-semibold",children:I.piezasCredito})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),a.jsx("div",{className:"text-xl font-semibold",children:Il(I.montoCash)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),a.jsx("div",{className:"text-xl font-semibold",children:Il(I.montoCredito)})]})]}),a.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Cliente"}),a.jsx("th",{className:"p-2 border",children:"Tipo"}),a.jsx("th",{className:"p-2 border",children:"Piezas"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:x?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Cargando"})}):Q.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:6,children:"Sin transacciones en el rango."})}):Q.map(ee=>{const z=ee.customerName||(ee.customerId?ye[ee.customerId]:"")||"Nombre cliente";return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:ee.date}),a.jsx("td",{className:"p-2 border",children:z}),a.jsx("td",{className:"p-2 border",children:ee.type==="CREDITO"?"Crdito":"Cash"}),a.jsx("td",{className:"p-2 border",children:a.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver piezas de esta transaccin",onClick:()=>c(ee.id),children:ee.item.qty})}),a.jsx("td",{className:"p-2 border",children:Il(ee.total)}),a.jsxs("td",{className:"p-2 border relative",children:[a.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>U(te=>te===ee.id?null:ee.id),title:"Acciones",children:""}),S===ee.id&&a.jsxs("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:[a.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100",onClick:()=>T(ee),children:"Editar"}),a.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>R(ee),children:"Eliminar"})]})]})]},ee.id)})})]}),Se()]}),w&&a.jsx("p",{className:"mt-2 text-sm",children:w}),_&&D&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-md p-4",children:[a.jsx("h3",{className:"text-lg font-bold mb-2",children:"Editar venta"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Producto"}),a.jsxs("div",{className:"font-semibold",children:[D.item.productName," ",D.item.sku?` ${D.item.sku}`:""]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad (piezas)"}),a.jsx("input",{type:"number",step:"1",min:1,className:"w-full border p-2 rounded",value:ge,onChange:ee=>ae(Math.max(1,Math.floor(Number(ee.target.value||0))))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"P. Unit"}),a.jsx("div",{className:"text-lg font-semibold",children:Il(D.item.unitPrice)})]}),a.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Nuevo total"}),a.jsx("div",{className:"text-lg font-semibold",children:Il(Number(D.item.unitPrice)*Number(ge||0))})]})]})]}),a.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[a.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{F(!1),X(null)},children:"Cancelar"}),a.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:K,children:"Guardar cambios"})]})]})}),t&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h3",{className:"text-lg font-bold",children:["Piezas vendidas"," ",s?` #${s}`:""]}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>e(!1),children:"Cerrar"})]}),a.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),a.jsx("th",{className:"p-2 border text-right",children:"Precio"}),a.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),a.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):o.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):o.map((ee,z)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border text-left",children:ee.productName}),a.jsx("td",{className:"p-2 border text-right",children:ee.qty}),a.jsx("td",{className:"p-2 border text-right",children:Il(ee.unitPrice)}),a.jsx("td",{className:"p-2 border text-right",children:Il(ee.discount||0)}),a.jsx("td",{className:"p-2 border text-right",children:Il(ee.total)})]},z))})]})})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Bb={};Bb.version="0.18.5";var i8=1252,Kle=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],aI={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},iI=function(t){Kle.indexOf(t)!=-1&&(i8=aI[0]=t)};function qle(){iI(1252)}var Dl=function(t){iI(t)};function oI(){Dl(1200),qle()}function lP(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function Gle(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function o8(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Bp=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Gle(t.slice(2)):e==254&&r==255?o8(t.slice(2)):e==65279?t.slice(1):t},_1=function(e){return String.fromCharCode(e)},cP=function(e){return String.fromCharCode(e)},ex,LA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function tx(t){for(var e="",r=0,n=0,s=0,i=0,o=0,l=0,c=0,d=0;d<t.length;)r=t.charCodeAt(d++),i=r>>2,n=t.charCodeAt(d++),o=(r&3)<<4|n>>4,s=t.charCodeAt(d++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),e+=LA.charAt(i)+LA.charAt(o)+LA.charAt(l)+LA.charAt(c);return e}function Po(t){var e="",r=0,n=0,s=0,i=0,o=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)i=LA.indexOf(t.charAt(d++)),o=LA.indexOf(t.charAt(d++)),r=i<<2|o>>4,e+=String.fromCharCode(r),l=LA.indexOf(t.charAt(d++)),n=(o&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(n)),c=LA.indexOf(t.charAt(d++)),s=(l&3)<<6|c,c!==64&&(e+=String.fromCharCode(s));return e}var Kr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Rd=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Au(t){return Kr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function dP(t){return Kr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var _o=function(e){return Kr?Rd(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function $2(t){if(typeof ArrayBuffer>"u")return _o(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Nu(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function $le(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function lI(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return lI(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Ba=Kr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Rd(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function zle(t){for(var e=[],r=0,n=t.length+250,s=Au(t.length+255),i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++i)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(e.push(s.slice(0,r)),r=0,s=Au(65535),n=65530)}return e.push(s.slice(0,r)),Ba(e)}var Li=/\u0000/g,Sp=/[\u0001-\u0006]/g;function w0(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Ll(t,e){var r=""+t;return r.length>=e?r:Fs("0",e-r.length)+r}function cI(t,e){var r=""+t;return r.length>=e?r:Fs(" ",e-r.length)+r}function Sb(t,e){var r=""+t;return r.length>=e?r:r+Fs(" ",e-r.length)}function Wle(t,e){var r=""+Math.round(t);return r.length>=e?r:Fs("0",e-r.length)+r}function Jle(t,e){var r=""+t;return r.length>=e?r:Fs("0",e-r.length)+r}var AP=Math.pow(2,32);function Df(t,e){if(t>AP||t<-AP)return Wle(t,e);var r=Math.round(t);return Jle(r,e)}function Ib(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var uP=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],eC=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Xle(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var _r={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},hP={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Yle={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function jb(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,o=1,l=0,c=1,d=0,A=0,u=Math.floor(s);d<e&&(u=Math.floor(s),l=u*o+i,A=u*d+c,!(s-u<5e-8));)s=1/(s-u),i=o,o=l,c=d,d=A;if(A>e&&(d>e?(A=c,l=i):(A=d,l=o)),!r)return[0,n*l,A];var f=Math.floor(n*l/A);return[f,n*l-f*A,A]}function oh(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,o=[],l={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=sce(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=i,l}var l8=new Date(1899,11,31,0,0,0),Zle=l8.getTime(),ece=new Date(1900,2,1,0,0,0);function c8(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=ece&&(r+=24*60*60*1e3),(r-(Zle+(t.getTimezoneOffset()-l8.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function dI(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function tce(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function rce(t){var e=t<0?12:11,r=dI(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function nce(t){var e=dI(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function rx(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=rce(t):e===10?r=t.toFixed(10).substr(0,12):r=nce(t),dI(tce(r.toUpperCase()))}function Lh(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):rx(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return xl(14,c8(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function sce(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function ace(t,e,r,n){var s="",i=0,o=0,l=r.y,c,d=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,d=e.length;break;case 3:return eC[r.m-1][1];case 5:return eC[r.m-1][0];default:return eC[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,d=e.length;break;case 3:return uP[r.q][0];default:return uP[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Ll(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),e==="s"?i===0?"0":""+i/o:(s=Ll(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:c=l,d=1;break}var A=d>0?Ll(c,d):"";return A}function UA(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var d8=/%/g;function ice(t,e,r){var n=e.replace(d8,""),s=e.length-n.length;return vd(t,n,r*Math.pow(10,2*s))+Fs("%",s)}function oce(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return vd(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function A8(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+A8(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,A){return c+d+A.substr(0,(s+i)%s)+"."+A.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var u8=/# (\?+)( ?)\/( ?)(\d+)/;function lce(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),o=s-i*n,l=n;return r+(i===0?"":""+i)+" "+(o===0?Fs(" ",t[1].length+1+t[4].length):cI(o,t[1].length)+t[2]+"/"+t[3]+Ll(l,t[4].length))}function cce(t,e,r){return r+(e===0?"":""+e)+Fs(" ",t[1].length+2+t[4].length)}var h8=/^#*0*\.([0#]+)/,f8=/\).*[0#]/,m8=/\(###\) ###\\?-####/;function Fi(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function fP(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function mP(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function dce(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Ace(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Zo(t,e,r){if(t.charCodeAt(0)===40&&!e.match(f8)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Zo("n",n,r):"("+Zo("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return oce(t,e,r);if(e.indexOf("%")!==-1)return ice(t,e,r);if(e.indexOf("E")!==-1)return A8(e,r);if(e.charCodeAt(0)===36)return"$"+Zo(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Df(c,e.length);if(e.match(/^[#?]+$/))return s=Df(r,0),s==="0"&&(s=""),s.length>e.length?s:Fi(e.substr(0,e.length-s.length))+s;if(i=e.match(u8))return lce(i,c,d);if(e.match(/^#+0+$/))return d+Df(c,e.length-e.indexOf("0"));if(i=e.match(h8))return s=fP(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Fi(i[1])).replace(/\.$/,"."+Fi(i[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+Fs("0",Fi(i[1]).length-p.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return d+fP(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return d+UA(Df(c,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Zo(t,e,-r):UA(""+(Math.floor(r)+dce(r,i[1].length)))+"."+Ll(mP(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Zo(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=w0(Zo(t,e.replace(/[\\-]/g,""),r)),o=0,w0(w0(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<s.length?s.charAt(o++):m==="0"?"0":""}));if(e.match(m8))return s=Zo(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var A="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=jb(c,Math.pow(10,o)-1,!1),s=""+d,A=vd("n",i[1],l[1]),A.charAt(A.length-1)==" "&&(A=A.substr(0,A.length-1)+"0"),s+=A+i[2]+"/"+i[3],A=Sb(l[2],o),A.length<i[4].length&&(A=Fi(i[4].substr(i[4].length-A.length))+A),s+=A,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=jb(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?cI(l[1],o)+i[2]+"/"+i[3]+Sb(l[2],o):Fs(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=Df(r,0),e.length<=s.length?s:Fi(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var u=e.indexOf(".")-o,f=e.length-s.length-u;return Fi(e.substr(0,u)+s+e.substr(e.length-f))}if(i=e.match(/^00,000\.([#0]*0)$/))return o=mP(r,i[1].length),r<0?"-"+Zo(t,e,-r):UA(Ace(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Ll(0,3-m.length):"")+m})+"."+Ll(o,i[1].length);switch(e){case"###,##0.00":return Zo(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=UA(Df(c,0));return h!=="0"?d+h:"";case"###,###.00":return Zo(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Zo(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function uce(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return vd(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function hce(t,e,r){var n=e.replace(d8,""),s=e.length-n.length;return vd(t,n,r*Math.pow(10,2*s))+Fs("%",s)}function p8(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+p8(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,A){return c+d+A.substr(0,(s+i)%s)+"."+A.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function fc(t,e,r){if(t.charCodeAt(0)===40&&!e.match(f8)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fc("n",n,r):"("+fc("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return uce(t,e,r);if(e.indexOf("%")!==-1)return hce(t,e,r);if(e.indexOf("E")!==-1)return p8(e,r);if(e.charCodeAt(0)===36)return"$"+fc(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Ll(c,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Fi(e.substr(0,e.length-s.length))+s;if(i=e.match(u8))return cce(i,c,d);if(e.match(/^#+0+$/))return d+Ll(c,e.length-e.indexOf("0"));if(i=e.match(h8))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Fi(i[1])).replace(/\.$/,"."+Fi(i[1])),s=s.replace(/\.(\d*)$/,function(m,p){return"."+p+Fs("0",Fi(i[1]).length-p.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return d+UA(""+c);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fc(t,e,-r):UA(""+r)+"."+Fs("0",i[1].length);if(i=e.match(/^#,#*,#0/))return fc(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=w0(fc(t,e.replace(/[\\-]/g,""),r)),o=0,w0(w0(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<s.length?s.charAt(o++):m==="0"?"0":""}));if(e.match(m8))return s=fc(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var A="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=jb(c,Math.pow(10,o)-1,!1),s=""+d,A=vd("n",i[1],l[1]),A.charAt(A.length-1)==" "&&(A=A.substr(0,A.length-1)+"0"),s+=A+i[2]+"/"+i[3],A=Sb(l[2],o),A.length<i[4].length&&(A=Fi(i[4].substr(i[4].length-A.length))+A),s+=A,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=jb(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?cI(l[1],o)+i[2]+"/"+i[3]+Sb(l[2],o):Fs(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Fi(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var u=e.indexOf(".")-o,f=e.length-s.length-u;return Fi(e.substr(0,u)+s+e.substr(e.length-f))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+fc(t,e,-r):UA(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Ll(0,3-m.length):"")+m})+"."+Ll(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var h=UA(""+c);return h!=="0"?d+h:"";default:if(e.match(/\.[0#?]*$/))return fc(t,e.slice(0,e.lastIndexOf(".")),r)+Fi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function vd(t,e,r){return(r|0)===r?fc(t,e,r):Zo(t,e,r)}function fce(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var g8=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Am(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Ib(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(g8))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function mce(t,e,r,n){for(var s=[],i="",o=0,l="",c="t",d,A,u,f="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!Ib(t,o))throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(u=t.charCodeAt(++o))!==34&&o<t.length;)i+=String.fromCharCode(u);s[s.length]={t:"t",v:i},++o;break;case"\\":var h=t.charAt(++o),m=h==="("||h===")"?h:"t";s[s.length]={t:m,v:h},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(d==null&&(d=oh(e,r,t.charAt(o+1)==="2"),d==null))return"";s[s.length]={t:"X",v:t.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=oh(e,r),d==null))return"";for(i=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),s[s.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(d==null&&(d=oh(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(p.v=d.H>=12?"P":"A"),p.t="T",f="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(p.v=d.H>=12?"PM":"AM"),p.t="T",o+=5,f="h"):t.substr(o,5).toUpperCase()==="/"?(d!=null&&(p.v=d.H>=12?"":""),p.t="T",o+=5,f="h"):(p.t="t",++o),d==null&&p.t==="T")return"";s[s.length]=p,c=l;break;case"[":for(i=l;t.charAt(o++)!=="]"&&o<t.length;)i+=t.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(g8)){if(d==null&&(d=oh(e,r),d==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Am(t)||(s[s.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++o<t.length&&(l=t.charAt(o))==="0";)i+=l;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)i+=l;s[s.length]={t:"n",v:i};break;case"?":for(i=l;t.charAt(++o)===l;)i+=l;s[s.length]={t:l,v:i},c=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)i+=t.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"t",v:l},++o;break}var g=0,x=0,b;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=f,c="h",g<1&&(g=1);break;case"s":(b=s[o].v.match(/\.0+$/))&&(x=Math.max(x,b[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[o].v.match(/[Hh]/)&&(g=1),g<2&&s[o].v.match(/[Mm]/)&&(g=2),g<3&&s[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var w="",k;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=ace(s[o].t.charCodeAt(0),s[o].v,d,x),s[o].t="t";break;case"n":case"?":for(k=o+1;s[k]!=null&&((l=s[k].t)==="?"||l==="D"||(l===" "||l==="t")&&s[k+1]!=null&&(s[k+1].t==="?"||s[k+1].t==="t"&&s[k+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[k].v==="/"||s[k].v===" "&&s[k+1]!=null&&s[k+1].t=="?"));)s[o].v+=s[k].v,s[k]={v:"",t:";"},++k;w+=s[o].v,o=k-1;break;case"G":s[o].t="t",s[o].v=Lh(e,r);break}var O="",L,E;if(w.length>0){w.charCodeAt(0)==40?(L=e<0&&w.charCodeAt(0)===45?-e:e,E=vd("n",w,L)):(L=e<0&&n>1?-e:e,E=vd("n",w,L),L<0&&s[0]&&s[0].t=="t"&&(E=E.substr(1),s[0].v="-"+s[0].v)),k=E.length-1;var B=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){B=o;break}var S=s.length;if(B===s.length&&E.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(k>=s[o].v.length-1?(k-=s[o].v.length,s[o].v=E.substr(k+1,s[o].v.length)):k<0?s[o].v="":(s[o].v=E.substr(0,k+1),k=-1),s[o].t="t",S=o);k>=0&&S<s.length&&(s[S].v=E.substr(0,k+1)+s[S].v)}else if(B!==s.length&&E.indexOf("E")===-1){for(k=E.indexOf(".")-1,o=B;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(A=s[o].v.indexOf(".")>-1&&o===B?s[o].v.indexOf(".")-1:s[o].v.length-1,O=s[o].v.substr(A+1);A>=0;--A)k>=0&&(s[o].v.charAt(A)==="0"||s[o].v.charAt(A)==="#")&&(O=E.charAt(k--)+O);s[o].v=O,s[o].t="t",S=o}for(k>=0&&S<s.length&&(s[S].v=E.substr(0,k+1)+s[S].v),k=E.indexOf(".")+1,o=B;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==B)){for(A=s[o].v.indexOf(".")>-1&&o===B?s[o].v.indexOf(".")+1:0,O=s[o].v.substr(0,A);A<s[o].v.length;++A)k<E.length&&(O+=E.charAt(k++));s[o].v=O,s[o].t="t",S=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(L=n>1&&e<0&&o>0&&s[o-1].v==="-"?-e:e,s[o].v=vd(s[o].t,s[o].v,L),s[o].t="t");var U="";for(o=0;o!==s.length;++o)s[o]!=null&&(U+=s[o].v);return U}var pP=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function gP(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function pce(t,e){var r=fce(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(pP),l=r[1].match(pP);return gP(e,o)?[n,r[0]]:gP(e,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,i]}function xl(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:_r)[t],n==null&&(n=r.table&&r.table[hP[t]]||_r[hP[t]]),n==null&&(n=Yle[t]||"General");break}if(Ib(n,0))return Lh(e,r);e instanceof Date&&(e=c8(e,r.date1904));var s=pce(n,e);if(Ib(s[1]))return Lh(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return mce(s[1],e,r,s[0])}function yd(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(_r[r]==null){e<0&&(e=r);continue}if(_r[r]==t){e=r;break}}e<0&&(e=391)}return _r[e]=t,e}function z2(t){for(var e=0;e!=392;++e)t[e]!==void 0&&yd(t[e],e)}function um(){_r=Xle()}var gce={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},x8=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function xce(t){var e=typeof t=="number"?_r[t]:t;return e=e.replace(x8,"(\\d+)"),new RegExp("^"+e+"$")}function vce(t,e,r){var n=-1,s=-1,i=-1,o=-1,l=-1,c=-1;(e.match(x8)||[]).forEach(function(u,f){var h=parseInt(r[f+1],10);switch(u.toLowerCase().charAt(0)){case"y":n=h;break;case"d":i=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:s=h;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var A=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?d:n==-1&&s==-1&&i==-1?A:d+"T"+A}var yce=function(){var t={};t.version="1.2.0";function e(){for(var E=0,B=new Array(256),S=0;S!=256;++S)E=S,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,B[S]=E;return typeof Int32Array<"u"?new Int32Array(B):B}var r=e();function n(E){var B=0,S=0,U=0,_=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)_[U]=E[U];for(U=0;U!=256;++U)for(S=E[U],B=256+U;B<4096;B+=256)S=_[B]=S>>>8^E[S&255];var F=[];for(U=1;U!=16;++U)F[U-1]=typeof Int32Array<"u"?_.subarray(U*256,U*256+256):_.slice(U*256,U*256+256);return F}var s=n(r),i=s[0],o=s[1],l=s[2],c=s[3],d=s[4],A=s[5],u=s[6],f=s[7],h=s[8],m=s[9],p=s[10],g=s[11],x=s[12],b=s[13],w=s[14];function k(E,B){for(var S=B^-1,U=0,_=E.length;U<_;)S=S>>>8^r[(S^E.charCodeAt(U++))&255];return~S}function O(E,B){for(var S=B^-1,U=E.length-15,_=0;_<U;)S=w[E[_++]^S&255]^b[E[_++]^S>>8&255]^x[E[_++]^S>>16&255]^g[E[_++]^S>>>24]^p[E[_++]]^m[E[_++]]^h[E[_++]]^f[E[_++]]^u[E[_++]]^A[E[_++]]^d[E[_++]]^c[E[_++]]^l[E[_++]]^o[E[_++]]^i[E[_++]]^r[E[_++]];for(U+=15;_<U;)S=S>>>8^r[(S^E[_++])&255];return~S}function L(E,B){for(var S=B^-1,U=0,_=E.length,F=0,D=0;U<_;)F=E.charCodeAt(U++),F<128?S=S>>>8^r[(S^F)&255]:F<2048?(S=S>>>8^r[(S^(192|F>>6&31))&255],S=S>>>8^r[(S^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,D=E.charCodeAt(U++)&1023,S=S>>>8^r[(S^(240|F>>8&7))&255],S=S>>>8^r[(S^(128|F>>2&63))&255],S=S>>>8^r[(S^(128|D>>6&15|(F&3)<<4))&255],S=S>>>8^r[(S^(128|D&63))&255]):(S=S>>>8^r[(S^(224|F>>12&15))&255],S=S>>>8^r[(S^(128|F>>6&63))&255],S=S>>>8^r[(S^(128|F&63))&255]);return~S}return t.table=r,t.bstr=k,t.buf=O,t.str=L,t}(),wr=function(){var e={};e.version="1.2.1";function r(oe,J){for(var ce=oe.split("/"),pe=J.split("/"),Be=0,De=0,se=Math.min(ce.length,pe.length);Be<se;++Be){if(De=ce[Be].length-pe[Be].length)return De;if(ce[Be]!=pe[Be])return ce[Be]<pe[Be]?-1:1}return ce.length-pe.length}function n(oe){if(oe.charAt(oe.length-1)=="/")return oe.slice(0,-1).indexOf("/")===-1?oe:n(oe.slice(0,-1));var J=oe.lastIndexOf("/");return J===-1?oe:oe.slice(0,J+1)}function s(oe){if(oe.charAt(oe.length-1)=="/")return s(oe.slice(0,-1));var J=oe.lastIndexOf("/");return J===-1?oe:oe.slice(J+1)}function i(oe,J){typeof J=="string"&&(J=new Date(J));var ce=J.getHours();ce=ce<<6|J.getMinutes(),ce=ce<<5|J.getSeconds()>>>1,oe.write_shift(2,ce);var pe=J.getFullYear()-1980;pe=pe<<4|J.getMonth()+1,pe=pe<<5|J.getDate(),oe.write_shift(2,pe)}function o(oe){var J=oe.read_shift(2)&65535,ce=oe.read_shift(2)&65535,pe=new Date,Be=ce&31;ce>>>=5;var De=ce&15;ce>>>=4,pe.setMilliseconds(0),pe.setFullYear(ce+1980),pe.setMonth(De-1),pe.setDate(Be);var se=J&31;J>>>=5;var Fe=J&63;return J>>>=6,pe.setHours(J),pe.setMinutes(Fe),pe.setSeconds(se<<1),pe}function l(oe){Ga(oe,0);for(var J={},ce=0;oe.l<=oe.length-4;){var pe=oe.read_shift(2),Be=oe.read_shift(2),De=oe.l+Be,se={};switch(pe){case 21589:ce=oe.read_shift(1),ce&1&&(se.mtime=oe.read_shift(4)),Be>5&&(ce&2&&(se.atime=oe.read_shift(4)),ce&4&&(se.ctime=oe.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}oe.l=De,J[pe]=se}return J}var c;function d(){return c||(c={})}function A(oe,J){if(oe[0]==80&&oe[1]==75)return Me(oe,J);if((oe[0]|32)==109&&(oe[1]|32)==105)return et(oe,J);if(oe.length<512)throw new Error("CFB file size "+oe.length+" < 512");var ce=3,pe=512,Be=0,De=0,se=0,Fe=0,he=0,Re=[],Ee=oe.slice(0,512);Ga(Ee,0);var Ze=u(Ee);switch(ce=Ze[0],ce){case 3:pe=512;break;case 4:pe=4096;break;case 0:if(Ze[1]==0)return Me(oe,J);default:throw new Error("Major Version: Expected 3 or 4 saw "+ce)}pe!==512&&(Ee=oe.slice(0,pe),Ga(Ee,28));var Je=oe.slice(0,pe);f(Ee,ce);var Ye=Ee.read_shift(4,"i");if(ce===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);Ee.l+=4,se=Ee.read_shift(4,"i"),Ee.l+=4,Ee.chk("00100000","Mini Stream Cutoff Size: "),Fe=Ee.read_shift(4,"i"),Be=Ee.read_shift(4,"i"),he=Ee.read_shift(4,"i"),De=Ee.read_shift(4,"i");for(var $e=-1,it=0;it<109&&($e=Ee.read_shift(4,"i"),!($e<0));++it)Re[it]=$e;var ft=h(oe,pe);g(he,De,ft,pe,Re);var Ut=b(ft,se,Re,pe);Ut[se].name="!Directory",Be>0&&Fe!==D&&(Ut[Fe].name="!MiniFAT"),Ut[Re[0]].name="!FAT",Ut.fat_addrs=Re,Ut.ssz=pe;var Kt={},yr=[],Hn=[],Fn=[];w(se,Ut,ft,yr,Be,Kt,Hn,Fe),m(Hn,Fn,yr),yr.shift();var wi={FileIndex:Hn,FullPaths:Fn};return J&&J.raw&&(wi.raw={header:Je,sectors:ft}),wi}function u(oe){if(oe[oe.l]==80&&oe[oe.l+1]==75)return[0,0];oe.chk(X,"Header Signature: "),oe.l+=16;var J=oe.read_shift(2,"u");return[oe.read_shift(2,"u"),J]}function f(oe,J){var ce=9;switch(oe.l+=2,ce=oe.read_shift(2)){case 9:if(J!=3)throw new Error("Sector Shift: Expected 9 saw "+ce);break;case 12:if(J!=4)throw new Error("Sector Shift: Expected 12 saw "+ce);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ce)}oe.chk("0600","Mini Sector Shift: "),oe.chk("000000000000","Reserved: ")}function h(oe,J){for(var ce=Math.ceil(oe.length/J)-1,pe=[],Be=1;Be<ce;++Be)pe[Be-1]=oe.slice(Be*J,(Be+1)*J);return pe[ce-1]=oe.slice(ce*J),pe}function m(oe,J,ce){for(var pe=0,Be=0,De=0,se=0,Fe=0,he=ce.length,Re=[],Ee=[];pe<he;++pe)Re[pe]=Ee[pe]=pe,J[pe]=ce[pe];for(;Fe<Ee.length;++Fe)pe=Ee[Fe],Be=oe[pe].L,De=oe[pe].R,se=oe[pe].C,Re[pe]===pe&&(Be!==-1&&Re[Be]!==Be&&(Re[pe]=Re[Be]),De!==-1&&Re[De]!==De&&(Re[pe]=Re[De])),se!==-1&&(Re[se]=pe),Be!==-1&&pe!=Re[pe]&&(Re[Be]=Re[pe],Ee.lastIndexOf(Be)<Fe&&Ee.push(Be)),De!==-1&&pe!=Re[pe]&&(Re[De]=Re[pe],Ee.lastIndexOf(De)<Fe&&Ee.push(De));for(pe=1;pe<he;++pe)Re[pe]===pe&&(De!==-1&&Re[De]!==De?Re[pe]=Re[De]:Be!==-1&&Re[Be]!==Be&&(Re[pe]=Re[Be]));for(pe=1;pe<he;++pe)if(oe[pe].type!==0){if(Fe=pe,Fe!=Re[Fe])do Fe=Re[Fe],J[pe]=J[Fe]+"/"+J[pe];while(Fe!==0&&Re[Fe]!==-1&&Fe!=Re[Fe]);Re[pe]=-1}for(J[0]+="/",pe=1;pe<he;++pe)oe[pe].type!==2&&(J[pe]+="/")}function p(oe,J,ce){for(var pe=oe.start,Be=oe.size,De=[],se=pe;ce&&Be>0&&se>=0;)De.push(J.slice(se*F,se*F+F)),Be-=F,se=eh(ce,se*4);return De.length===0?_t(0):Ba(De).slice(0,oe.size)}function g(oe,J,ce,pe,Be){var De=D;if(oe===D){if(J!==0)throw new Error("DIFAT chain shorter than expected")}else if(oe!==-1){var se=ce[oe],Fe=(pe>>>2)-1;if(!se)return;for(var he=0;he<Fe&&(De=eh(se,he*4))!==D;++he)Be.push(De);g(eh(se,pe-4),J-1,ce,pe,Be)}}function x(oe,J,ce,pe,Be){var De=[],se=[];Be||(Be=[]);var Fe=pe-1,he=0,Re=0;for(he=J;he>=0;){Be[he]=!0,De[De.length]=he,se.push(oe[he]);var Ee=ce[Math.floor(he*4/pe)];if(Re=he*4&Fe,pe<4+Re)throw new Error("FAT boundary crossed: "+he+" 4 "+pe);if(!oe[Ee])break;he=eh(oe[Ee],Re)}return{nodes:De,data:IP([se])}}function b(oe,J,ce,pe){var Be=oe.length,De=[],se=[],Fe=[],he=[],Re=pe-1,Ee=0,Ze=0,Je=0,Ye=0;for(Ee=0;Ee<Be;++Ee)if(Fe=[],Je=Ee+J,Je>=Be&&(Je-=Be),!se[Je]){he=[];var $e=[];for(Ze=Je;Ze>=0;){$e[Ze]=!0,se[Ze]=!0,Fe[Fe.length]=Ze,he.push(oe[Ze]);var it=ce[Math.floor(Ze*4/pe)];if(Ye=Ze*4&Re,pe<4+Ye)throw new Error("FAT boundary crossed: "+Ze+" 4 "+pe);if(!oe[it]||(Ze=eh(oe[it],Ye),$e[Ze]))break}De[Je]={nodes:Fe,data:IP([he])}}return De}function w(oe,J,ce,pe,Be,De,se,Fe){for(var he=0,Re=pe.length?2:0,Ee=J[oe].data,Ze=0,Je=0,Ye;Ze<Ee.length;Ze+=128){var $e=Ee.slice(Ze,Ze+128);Ga($e,64),Je=$e.read_shift(2),Ye=gI($e,0,Je-Re),pe.push(Ye);var it={name:Ye,type:$e.read_shift(1),color:$e.read_shift(1),L:$e.read_shift(4,"i"),R:$e.read_shift(4,"i"),C:$e.read_shift(4,"i"),clsid:$e.read_shift(16),state:$e.read_shift(4,"i"),start:0,size:0},ft=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);ft!==0&&(it.ct=k($e,$e.l-8));var Ut=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);Ut!==0&&(it.mt=k($e,$e.l-8)),it.start=$e.read_shift(4,"i"),it.size=$e.read_shift(4,"i"),it.size<0&&it.start<0&&(it.size=it.type=0,it.start=D,it.name=""),it.type===5?(he=it.start,Be>0&&he!==D&&(J[he].name="!StreamData")):it.size>=4096?(it.storage="fat",J[it.start]===void 0&&(J[it.start]=x(ce,it.start,J.fat_addrs,J.ssz)),J[it.start].name=it.name,it.content=J[it.start].data.slice(0,it.size)):(it.storage="minifat",it.size<0?it.size=0:he!==D&&it.start!==D&&J[he]&&(it.content=p(it,J[he].data,(J[Fe]||{}).data))),it.content&&Ga(it.content,0),De[Ye]=it,se.push(it)}}function k(oe,J){return new Date((Co(oe,J+4)/1e7*Math.pow(2,32)+Co(oe,J)/1e7-11644473600)*1e3)}function O(oe,J){return d(),A(c.readFileSync(oe),J)}function L(oe,J){var ce=J&&J.type;switch(ce||Kr&&Buffer.isBuffer(oe)&&(ce="buffer"),ce||"base64"){case"file":return O(oe,J);case"base64":return A(_o(Po(oe)),J);case"binary":return A(_o(oe),J)}return A(oe,J)}function E(oe,J){var ce=J||{},pe=ce.root||"Root Entry";if(oe.FullPaths||(oe.FullPaths=[]),oe.FileIndex||(oe.FileIndex=[]),oe.FullPaths.length!==oe.FileIndex.length)throw new Error("inconsistent CFB structure");oe.FullPaths.length===0&&(oe.FullPaths[0]=pe+"/",oe.FileIndex[0]={name:pe,type:5}),ce.CLSID&&(oe.FileIndex[0].clsid=ce.CLSID),B(oe)}function B(oe){var J="Sh33tJ5";if(!wr.find(oe,"/"+J)){var ce=_t(4);ce[0]=55,ce[1]=ce[3]=50,ce[2]=54,oe.FileIndex.push({name:J,type:2,content:ce,size:4,L:69,R:69,C:69}),oe.FullPaths.push(oe.FullPaths[0]+J),S(oe)}}function S(oe,J){E(oe);for(var ce=!1,pe=!1,Be=oe.FullPaths.length-1;Be>=0;--Be){var De=oe.FileIndex[Be];switch(De.type){case 0:pe?ce=!0:(oe.FileIndex.pop(),oe.FullPaths.pop());break;case 1:case 2:case 5:pe=!0,isNaN(De.R*De.L*De.C)&&(ce=!0),De.R>-1&&De.L>-1&&De.R==De.L&&(ce=!0);break;default:ce=!0;break}}if(!(!ce&&!J)){var se=new Date(1987,1,19),Fe=0,he=Object.create?Object.create(null):{},Re=[];for(Be=0;Be<oe.FullPaths.length;++Be)he[oe.FullPaths[Be]]=!0,oe.FileIndex[Be].type!==0&&Re.push([oe.FullPaths[Be],oe.FileIndex[Be]]);for(Be=0;Be<Re.length;++Be){var Ee=n(Re[Be][0]);pe=he[Ee],pe||(Re.push([Ee,{name:s(Ee).replace("/",""),type:1,clsid:ae,ct:se,mt:se,content:null}]),he[Ee]=!0)}for(Re.sort(function(Ye,$e){return r(Ye[0],$e[0])}),oe.FullPaths=[],oe.FileIndex=[],Be=0;Be<Re.length;++Be)oe.FullPaths[Be]=Re[Be][0],oe.FileIndex[Be]=Re[Be][1];for(Be=0;Be<Re.length;++Be){var Ze=oe.FileIndex[Be],Je=oe.FullPaths[Be];if(Ze.name=s(Je).replace("/",""),Ze.L=Ze.R=Ze.C=-(Ze.color=1),Ze.size=Ze.content?Ze.content.length:0,Ze.start=0,Ze.clsid=Ze.clsid||ae,Be===0)Ze.C=Re.length>1?1:-1,Ze.size=0,Ze.type=5;else if(Je.slice(-1)=="/"){for(Fe=Be+1;Fe<Re.length&&n(oe.FullPaths[Fe])!=Je;++Fe);for(Ze.C=Fe>=Re.length?-1:Fe,Fe=Be+1;Fe<Re.length&&n(oe.FullPaths[Fe])!=n(Je);++Fe);Ze.R=Fe>=Re.length?-1:Fe,Ze.type=1}else n(oe.FullPaths[Be+1]||"")==n(Je)&&(Ze.R=Be+1),Ze.type=2}}}function U(oe,J){var ce=J||{};if(ce.fileType=="mad")return Rt(oe,ce);switch(S(oe),ce.fileType){case"zip":return He(oe,ce)}var pe=function(Ye){for(var $e=0,it=0,ft=0;ft<Ye.FileIndex.length;++ft){var Ut=Ye.FileIndex[ft];if(Ut.content){var Kt=Ut.content.length;Kt>0&&(Kt<4096?$e+=Kt+63>>6:it+=Kt+511>>9)}}for(var yr=Ye.FullPaths.length+3>>2,Hn=$e+7>>3,Fn=$e+127>>7,wi=Hn+it+yr+Fn,Ds=wi+127>>7,ao=Ds<=109?0:Math.ceil((Ds-109)/127);wi+Ds+ao+127>>7>Ds;)ao=++Ds<=109?0:Math.ceil((Ds-109)/127);var Jn=[1,ao,Ds,Fn,yr,it,$e,0];return Ye.FileIndex[0].size=$e<<6,Jn[7]=(Ye.FileIndex[0].start=Jn[0]+Jn[1]+Jn[2]+Jn[3]+Jn[4]+Jn[5])+(Jn[6]+7>>3),Jn}(oe),Be=_t(pe[7]<<9),De=0,se=0;{for(De=0;De<8;++De)Be.write_shift(1,ge[De]);for(De=0;De<8;++De)Be.write_shift(2,0);for(Be.write_shift(2,62),Be.write_shift(2,3),Be.write_shift(2,65534),Be.write_shift(2,9),Be.write_shift(2,6),De=0;De<3;++De)Be.write_shift(2,0);for(Be.write_shift(4,0),Be.write_shift(4,pe[2]),Be.write_shift(4,pe[0]+pe[1]+pe[2]+pe[3]-1),Be.write_shift(4,0),Be.write_shift(4,4096),Be.write_shift(4,pe[3]?pe[0]+pe[1]+pe[2]-1:D),Be.write_shift(4,pe[3]),Be.write_shift(-4,pe[1]?pe[0]-1:D),Be.write_shift(4,pe[1]),De=0;De<109;++De)Be.write_shift(-4,De<pe[2]?pe[1]+De:-1)}if(pe[1])for(se=0;se<pe[1];++se){for(;De<236+se*127;++De)Be.write_shift(-4,De<pe[2]?pe[1]+De:-1);Be.write_shift(-4,se===pe[1]-1?D:se+1)}var Fe=function(Ye){for(se+=Ye;De<se-1;++De)Be.write_shift(-4,De+1);Ye&&(++De,Be.write_shift(-4,D))};for(se=De=0,se+=pe[1];De<se;++De)Be.write_shift(-4,fe.DIFSECT);for(se+=pe[2];De<se;++De)Be.write_shift(-4,fe.FATSECT);Fe(pe[3]),Fe(pe[4]);for(var he=0,Re=0,Ee=oe.FileIndex[0];he<oe.FileIndex.length;++he)Ee=oe.FileIndex[he],Ee.content&&(Re=Ee.content.length,!(Re<4096)&&(Ee.start=se,Fe(Re+511>>9)));for(Fe(pe[6]+7>>3);Be.l&511;)Be.write_shift(-4,fe.ENDOFCHAIN);for(se=De=0,he=0;he<oe.FileIndex.length;++he)Ee=oe.FileIndex[he],Ee.content&&(Re=Ee.content.length,!(!Re||Re>=4096)&&(Ee.start=se,Fe(Re+63>>6)));for(;Be.l&511;)Be.write_shift(-4,fe.ENDOFCHAIN);for(De=0;De<pe[4]<<2;++De){var Ze=oe.FullPaths[De];if(!Ze||Ze.length===0){for(he=0;he<17;++he)Be.write_shift(4,0);for(he=0;he<3;++he)Be.write_shift(4,-1);for(he=0;he<12;++he)Be.write_shift(4,0);continue}Ee=oe.FileIndex[De],De===0&&(Ee.start=Ee.size?Ee.start-1:D);var Je=De===0&&ce.root||Ee.name;if(Re=2*(Je.length+1),Be.write_shift(64,Je,"utf16le"),Be.write_shift(2,Re),Be.write_shift(1,Ee.type),Be.write_shift(1,Ee.color),Be.write_shift(-4,Ee.L),Be.write_shift(-4,Ee.R),Be.write_shift(-4,Ee.C),Ee.clsid)Be.write_shift(16,Ee.clsid,"hex");else for(he=0;he<4;++he)Be.write_shift(4,0);Be.write_shift(4,Ee.state||0),Be.write_shift(4,0),Be.write_shift(4,0),Be.write_shift(4,0),Be.write_shift(4,0),Be.write_shift(4,Ee.start),Be.write_shift(4,Ee.size),Be.write_shift(4,0)}for(De=1;De<oe.FileIndex.length;++De)if(Ee=oe.FileIndex[De],Ee.size>=4096)if(Be.l=Ee.start+1<<9,Kr&&Buffer.isBuffer(Ee.content))Ee.content.copy(Be,Be.l,0,Ee.size),Be.l+=Ee.size+511&-512;else{for(he=0;he<Ee.size;++he)Be.write_shift(1,Ee.content[he]);for(;he&511;++he)Be.write_shift(1,0)}for(De=1;De<oe.FileIndex.length;++De)if(Ee=oe.FileIndex[De],Ee.size>0&&Ee.size<4096)if(Kr&&Buffer.isBuffer(Ee.content))Ee.content.copy(Be,Be.l,0,Ee.size),Be.l+=Ee.size+63&-64;else{for(he=0;he<Ee.size;++he)Be.write_shift(1,Ee.content[he]);for(;he&63;++he)Be.write_shift(1,0)}if(Kr)Be.l=Be.length;else for(;Be.l<Be.length;)Be.write_shift(1,0);return Be}function _(oe,J){var ce=oe.FullPaths.map(function(he){return he.toUpperCase()}),pe=ce.map(function(he){var Re=he.split("/");return Re[Re.length-(he.slice(-1)=="/"?2:1)]}),Be=!1;J.charCodeAt(0)===47?(Be=!0,J=ce[0].slice(0,-1)+J):Be=J.indexOf("/")!==-1;var De=J.toUpperCase(),se=Be===!0?ce.indexOf(De):pe.indexOf(De);if(se!==-1)return oe.FileIndex[se];var Fe=!De.match(Sp);for(De=De.replace(Li,""),Fe&&(De=De.replace(Sp,"!")),se=0;se<ce.length;++se)if((Fe?ce[se].replace(Sp,"!"):ce[se]).replace(Li,"")==De||(Fe?pe[se].replace(Sp,"!"):pe[se]).replace(Li,"")==De)return oe.FileIndex[se];return null}var F=64,D=-2,X="d0cf11e0a1b11ae1",ge=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",fe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:X,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function me(oe,J,ce){d();var pe=U(oe,ce);c.writeFileSync(J,pe)}function Z(oe){for(var J=new Array(oe.length),ce=0;ce<oe.length;++ce)J[ce]=String.fromCharCode(oe[ce]);return J.join("")}function ye(oe,J){var ce=U(oe,J);switch(J&&J.type||"buffer"){case"file":return d(),c.writeFileSync(J.filename,ce),ce;case"binary":return typeof ce=="string"?ce:Z(ce);case"base64":return tx(typeof ce=="string"?ce:Z(ce));case"buffer":if(Kr)return Buffer.isBuffer(ce)?ce:Rd(ce);case"array":return typeof ce=="string"?_o(ce):ce}return ce}var Ie;function I(oe){try{var J=oe.InflateRaw,ce=new J;if(ce._processChunk(new Uint8Array([3,0]),ce._finishFlushFlag),ce.bytesRead)Ie=oe;else throw new Error("zlib does not expose bytesRead")}catch(pe){console.error("cannot use native zlib: "+(pe.message||pe))}}function j(oe,J){if(!Ie)return G(oe,J);var ce=Ie.InflateRaw,pe=new ce,Be=pe._processChunk(oe.slice(oe.l),pe._finishFlushFlag);return oe.l+=pe.bytesRead,Be}function Q(oe){return Ie?Ie.deflateRawSync(oe):ve(oe)}var T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],K=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function M(oe){var J=(oe<<1|oe<<11)&139536|(oe<<5|oe<<15)&558144;return(J>>16|J>>8|J)&255}for(var re=typeof Uint8Array<"u",de=re?new Uint8Array(256):[],le=0;le<256;++le)de[le]=M(le);function q(oe,J){var ce=de[oe&255];return J<=8?ce>>>8-J:(ce=ce<<8|de[oe>>8&255],J<=16?ce>>>16-J:(ce=ce<<8|de[oe>>16&255],ce>>>24-J))}function Se(oe,J){var ce=J&7,pe=J>>>3;return(oe[pe]|(ce<=6?0:oe[pe+1]<<8))>>>ce&3}function ee(oe,J){var ce=J&7,pe=J>>>3;return(oe[pe]|(ce<=5?0:oe[pe+1]<<8))>>>ce&7}function z(oe,J){var ce=J&7,pe=J>>>3;return(oe[pe]|(ce<=4?0:oe[pe+1]<<8))>>>ce&15}function te(oe,J){var ce=J&7,pe=J>>>3;return(oe[pe]|(ce<=3?0:oe[pe+1]<<8))>>>ce&31}function Ne(oe,J){var ce=J&7,pe=J>>>3;return(oe[pe]|(ce<=1?0:oe[pe+1]<<8))>>>ce&127}function Y(oe,J,ce){var pe=J&7,Be=J>>>3,De=(1<<ce)-1,se=oe[Be]>>>pe;return ce<8-pe||(se|=oe[Be+1]<<8-pe,ce<16-pe)||(se|=oe[Be+2]<<16-pe,ce<24-pe)||(se|=oe[Be+3]<<24-pe),se&De}function we(oe,J,ce){var pe=J&7,Be=J>>>3;return pe<=5?oe[Be]|=(ce&7)<<pe:(oe[Be]|=ce<<pe&255,oe[Be+1]=(ce&7)>>8-pe),J+3}function Pe(oe,J,ce){var pe=J&7,Be=J>>>3;return ce=(ce&1)<<pe,oe[Be]|=ce,J+1}function Qe(oe,J,ce){var pe=J&7,Be=J>>>3;return ce<<=pe,oe[Be]|=ce&255,ce>>>=8,oe[Be+1]=ce,J+8}function tt(oe,J,ce){var pe=J&7,Be=J>>>3;return ce<<=pe,oe[Be]|=ce&255,ce>>>=8,oe[Be+1]=ce&255,oe[Be+2]=ce>>>8,J+16}function ot(oe,J){var ce=oe.length,pe=2*ce>J?2*ce:J+5,Be=0;if(ce>=J)return oe;if(Kr){var De=dP(pe);if(oe.copy)oe.copy(De);else for(;Be<oe.length;++Be)De[Be]=oe[Be];return De}else if(re){var se=new Uint8Array(pe);if(se.set)se.set(oe);else for(;Be<ce;++Be)se[Be]=oe[Be];return se}return oe.length=pe,oe}function dt(oe){for(var J=new Array(oe),ce=0;ce<oe;++ce)J[ce]=0;return J}function vt(oe,J,ce){var pe=1,Be=0,De=0,se=0,Fe=0,he=oe.length,Re=re?new Uint16Array(32):dt(32);for(De=0;De<32;++De)Re[De]=0;for(De=he;De<ce;++De)oe[De]=0;he=oe.length;var Ee=re?new Uint16Array(he):dt(he);for(De=0;De<he;++De)Re[Be=oe[De]]++,pe<Be&&(pe=Be),Ee[De]=0;for(Re[0]=0,De=1;De<=pe;++De)Re[De+16]=Fe=Fe+Re[De-1]<<1;for(De=0;De<he;++De)Fe=oe[De],Fe!=0&&(Ee[De]=Re[Fe+16]++);var Ze=0;for(De=0;De<he;++De)if(Ze=oe[De],Ze!=0)for(Fe=q(Ee[De],pe)>>pe-Ze,se=(1<<pe+4-Ze)-1;se>=0;--se)J[Fe|se<<Ze]=Ze&15|De<<4;return pe}var lt=re?new Uint16Array(512):dt(512),Ue=re?new Uint16Array(32):dt(32);if(!re){for(var Xe=0;Xe<512;++Xe)lt[Xe]=0;for(Xe=0;Xe<32;++Xe)Ue[Xe]=0}(function(){for(var oe=[],J=0;J<32;J++)oe.push(5);vt(oe,Ue,32);var ce=[];for(J=0;J<=143;J++)ce.push(8);for(;J<=255;J++)ce.push(9);for(;J<=279;J++)ce.push(7);for(;J<=287;J++)ce.push(8);vt(ce,lt,288)})();var xe=function(){for(var J=re?new Uint8Array(32768):[],ce=0,pe=0;ce<K.length-1;++ce)for(;pe<K[ce+1];++pe)J[pe]=ce;for(;pe<32768;++pe)J[pe]=29;var Be=re?new Uint8Array(259):[];for(ce=0,pe=0;ce<R.length-1;++ce)for(;pe<R[ce+1];++pe)Be[pe]=ce;function De(Fe,he){for(var Re=0;Re<Fe.length;){var Ee=Math.min(65535,Fe.length-Re),Ze=Re+Ee==Fe.length;for(he.write_shift(1,+Ze),he.write_shift(2,Ee),he.write_shift(2,~Ee&65535);Ee-- >0;)he[he.l++]=Fe[Re++]}return he.l}function se(Fe,he){for(var Re=0,Ee=0,Ze=re?new Uint16Array(32768):[];Ee<Fe.length;){var Je=Math.min(65535,Fe.length-Ee);if(Je<10){for(Re=we(he,Re,+(Ee+Je==Fe.length)),Re&7&&(Re+=8-(Re&7)),he.l=Re/8|0,he.write_shift(2,Je),he.write_shift(2,~Je&65535);Je-- >0;)he[he.l++]=Fe[Ee++];Re=he.l*8;continue}Re=we(he,Re,+(Ee+Je==Fe.length)+2);for(var Ye=0;Je-- >0;){var $e=Fe[Ee];Ye=(Ye<<5^$e)&32767;var it=-1,ft=0;if((it=Ze[Ye])&&(it|=Ee&-32768,it>Ee&&(it-=32768),it<Ee))for(;Fe[it+ft]==Fe[Ee+ft]&&ft<250;)++ft;if(ft>2){$e=Be[ft],$e<=22?Re=Qe(he,Re,de[$e+1]>>1)-1:(Qe(he,Re,3),Re+=5,Qe(he,Re,de[$e-23]>>5),Re+=3);var Ut=$e<8?0:$e-4>>2;Ut>0&&(tt(he,Re,ft-R[$e]),Re+=Ut),$e=J[Ee-it],Re=Qe(he,Re,de[$e]>>3),Re-=3;var Kt=$e<4?0:$e-2>>1;Kt>0&&(tt(he,Re,Ee-it-K[$e]),Re+=Kt);for(var yr=0;yr<ft;++yr)Ze[Ye]=Ee&32767,Ye=(Ye<<5^Fe[Ee])&32767,++Ee;Je-=ft-1}else $e<=143?$e=$e+48:Re=Pe(he,Re,1),Re=Qe(he,Re,de[$e]),Ze[Ye]=Ee&32767,++Ee}Re=Qe(he,Re,0)-1}return he.l=(Re+7)/8|0,he.l}return function(he,Re){return he.length<8?De(he,Re):se(he,Re)}}();function ve(oe){var J=_t(50+Math.floor(oe.length*1.1)),ce=xe(oe,J);return J.slice(0,ce)}var ie=re?new Uint16Array(32768):dt(32768),ze=re?new Uint16Array(32768):dt(32768),rt=re?new Uint16Array(128):dt(128),At=1,Oe=1;function at(oe,J){var ce=te(oe,J)+257;J+=5;var pe=te(oe,J)+1;J+=5;var Be=z(oe,J)+4;J+=4;for(var De=0,se=re?new Uint8Array(19):dt(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],he=1,Re=re?new Uint8Array(8):dt(8),Ee=re?new Uint8Array(8):dt(8),Ze=se.length,Je=0;Je<Be;++Je)se[T[Je]]=De=ee(oe,J),he<De&&(he=De),Re[De]++,J+=3;var Ye=0;for(Re[0]=0,Je=1;Je<=he;++Je)Ee[Je]=Ye=Ye+Re[Je-1]<<1;for(Je=0;Je<Ze;++Je)(Ye=se[Je])!=0&&(Fe[Je]=Ee[Ye]++);var $e=0;for(Je=0;Je<Ze;++Je)if($e=se[Je],$e!=0){Ye=de[Fe[Je]]>>8-$e;for(var it=(1<<7-$e)-1;it>=0;--it)rt[Ye|it<<$e]=$e&7|Je<<3}var ft=[];for(he=1;ft.length<ce+pe;)switch(Ye=rt[Ne(oe,J)],J+=Ye&7,Ye>>>=3){case 16:for(De=3+Se(oe,J),J+=2,Ye=ft[ft.length-1];De-- >0;)ft.push(Ye);break;case 17:for(De=3+ee(oe,J),J+=3;De-- >0;)ft.push(0);break;case 18:for(De=11+Ne(oe,J),J+=7;De-- >0;)ft.push(0);break;default:ft.push(Ye),he<Ye&&(he=Ye);break}var Ut=ft.slice(0,ce),Kt=ft.slice(ce);for(Je=ce;Je<286;++Je)Ut[Je]=0;for(Je=pe;Je<30;++Je)Kt[Je]=0;return At=vt(Ut,ie,286),Oe=vt(Kt,ze,30),J}function Ve(oe,J){if(oe[0]==3&&!(oe[1]&3))return[Au(J),2];for(var ce=0,pe=0,Be=dP(J||1<<18),De=0,se=Be.length>>>0,Fe=0,he=0;!(pe&1);){if(pe=ee(oe,ce),ce+=3,pe>>>1)pe>>1==1?(Fe=9,he=5):(ce=at(oe,ce),Fe=At,he=Oe);else{ce&7&&(ce+=8-(ce&7));var Re=oe[ce>>>3]|oe[(ce>>>3)+1]<<8;if(ce+=32,Re>0)for(!J&&se<De+Re&&(Be=ot(Be,De+Re),se=Be.length);Re-- >0;)Be[De++]=oe[ce>>>3],ce+=8;continue}for(;;){!J&&se<De+32767&&(Be=ot(Be,De+32767),se=Be.length);var Ee=Y(oe,ce,Fe),Ze=pe>>>1==1?lt[Ee]:ie[Ee];if(ce+=Ze&15,Ze>>>=4,!(Ze>>>8&255))Be[De++]=Ze;else{if(Ze==256)break;Ze-=257;var Je=Ze<8?0:Ze-4>>2;Je>5&&(Je=0);var Ye=De+R[Ze];Je>0&&(Ye+=Y(oe,ce,Je),ce+=Je),Ee=Y(oe,ce,he),Ze=pe>>>1==1?Ue[Ee]:ze[Ee],ce+=Ze&15,Ze>>>=4;var $e=Ze<4?0:Ze-2>>1,it=K[Ze];for($e>0&&(it+=Y(oe,ce,$e),ce+=$e),!J&&se<Ye&&(Be=ot(Be,Ye+100),se=Be.length);De<Ye;)Be[De]=Be[De-it],++De}}}return J?[Be,ce+7>>>3]:[Be.slice(0,De),ce+7>>>3]}function G(oe,J){var ce=oe.slice(oe.l||0),pe=Ve(ce,J);return oe.l+=pe[1],pe[0]}function _e(oe,J){if(oe)typeof console<"u"&&console.error(J);else throw new Error(J)}function Me(oe,J){var ce=oe;Ga(ce,0);var pe=[],Be=[],De={FileIndex:pe,FullPaths:Be};E(De,{root:J.root});for(var se=ce.length-4;(ce[se]!=80||ce[se+1]!=75||ce[se+2]!=5||ce[se+3]!=6)&&se>=0;)--se;ce.l=se+4,ce.l+=4;var Fe=ce.read_shift(2);ce.l+=6;var he=ce.read_shift(4);for(ce.l=he,se=0;se<Fe;++se){ce.l+=20;var Re=ce.read_shift(4),Ee=ce.read_shift(4),Ze=ce.read_shift(2),Je=ce.read_shift(2),Ye=ce.read_shift(2);ce.l+=8;var $e=ce.read_shift(4),it=l(ce.slice(ce.l+Ze,ce.l+Ze+Je));ce.l+=Ze+Je+Ye;var ft=ce.l;ce.l=$e+4,We(ce,Re,Ee,De,it),ce.l=ft}return De}function We(oe,J,ce,pe,Be){oe.l+=2;var De=oe.read_shift(2),se=oe.read_shift(2),Fe=o(oe);if(De&8257)throw new Error("Unsupported ZIP encryption");for(var he=oe.read_shift(4),Re=oe.read_shift(4),Ee=oe.read_shift(4),Ze=oe.read_shift(2),Je=oe.read_shift(2),Ye="",$e=0;$e<Ze;++$e)Ye+=String.fromCharCode(oe[oe.l++]);if(Je){var it=l(oe.slice(oe.l,oe.l+Je));(it[21589]||{}).mt&&(Fe=it[21589].mt),((Be||{})[21589]||{}).mt&&(Fe=Be[21589].mt)}oe.l+=Je;var ft=oe.slice(oe.l,oe.l+Re);switch(se){case 8:ft=j(oe,Ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var Ut=!1;De&8&&(he=oe.read_shift(4),he==134695760&&(he=oe.read_shift(4),Ut=!0),Re=oe.read_shift(4),Ee=oe.read_shift(4)),Re!=J&&_e(Ut,"Bad compressed size: "+J+" != "+Re),Ee!=ce&&_e(Ut,"Bad uncompressed size: "+ce+" != "+Ee),Lt(pe,Ye,ft,{unsafe:!0,mt:Fe})}function He(oe,J){var ce=J||{},pe=[],Be=[],De=_t(1),se=ce.compression?8:0,Fe=0,he=0,Re=0,Ee=0,Ze=0,Je=oe.FullPaths[0],Ye=Je,$e=oe.FileIndex[0],it=[],ft=0;for(he=1;he<oe.FullPaths.length;++he)if(Ye=oe.FullPaths[he].slice(Je.length),$e=oe.FileIndex[he],!(!$e.size||!$e.content||Ye=="Sh33tJ5")){var Ut=Ee,Kt=_t(Ye.length);for(Re=0;Re<Ye.length;++Re)Kt.write_shift(1,Ye.charCodeAt(Re)&127);Kt=Kt.slice(0,Kt.l),it[Ze]=yce.buf($e.content,0);var yr=$e.content;se==8&&(yr=Q(yr)),De=_t(30),De.write_shift(4,67324752),De.write_shift(2,20),De.write_shift(2,Fe),De.write_shift(2,se),$e.mt?i(De,$e.mt):De.write_shift(4,0),De.write_shift(-4,it[Ze]),De.write_shift(4,yr.length),De.write_shift(4,$e.content.length),De.write_shift(2,Kt.length),De.write_shift(2,0),Ee+=De.length,pe.push(De),Ee+=Kt.length,pe.push(Kt),Ee+=yr.length,pe.push(yr),De=_t(46),De.write_shift(4,33639248),De.write_shift(2,0),De.write_shift(2,20),De.write_shift(2,Fe),De.write_shift(2,se),De.write_shift(4,0),De.write_shift(-4,it[Ze]),De.write_shift(4,yr.length),De.write_shift(4,$e.content.length),De.write_shift(2,Kt.length),De.write_shift(2,0),De.write_shift(2,0),De.write_shift(2,0),De.write_shift(2,0),De.write_shift(4,0),De.write_shift(4,Ut),ft+=De.l,Be.push(De),ft+=Kt.length,Be.push(Kt),++Ze}return De=_t(22),De.write_shift(4,101010256),De.write_shift(2,0),De.write_shift(2,0),De.write_shift(2,Ze),De.write_shift(2,Ze),De.write_shift(4,ft),De.write_shift(4,Ee),De.write_shift(2,0),Ba([Ba(pe),Ba(Be),De])}var st={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ct(oe,J){if(oe.ctype)return oe.ctype;var ce=oe.name||"",pe=ce.match(/\.([^\.]+)$/);return pe&&st[pe[1]]||J&&(pe=(ce=J).match(/[\.\\]([^\.\\])+$/),pe&&st[pe[1]])?st[pe[1]]:"application/octet-stream"}function Xt(oe){for(var J=tx(oe),ce=[],pe=0;pe<J.length;pe+=76)ce.push(J.slice(pe,pe+76));return ce.join(`\r
`)+`\r
`}function Ot(oe){var J=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Re){var Ee=Re.charCodeAt(0).toString(16).toUpperCase();return"="+(Ee.length==1?"0"+Ee:Ee)});J=J.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),J.charAt(0)==`
`&&(J="=0D"+J.slice(1)),J=J.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ce=[],pe=J.split(`\r
`),Be=0;Be<pe.length;++Be){var De=pe[Be];if(De.length==0){ce.push("");continue}for(var se=0;se<De.length;){var Fe=76,he=De.slice(se,se+Fe);he.charAt(Fe-1)=="="?Fe--:he.charAt(Fe-2)=="="?Fe-=2:he.charAt(Fe-3)=="="&&(Fe-=3),he=De.slice(se,se+Fe),se+=Fe,se<De.length&&(he+="="),ce.push(he)}}return ce.join(`\r
`)}function tr(oe){for(var J=[],ce=0;ce<oe.length;++ce){for(var pe=oe[ce];ce<=oe.length&&pe.charAt(pe.length-1)=="=";)pe=pe.slice(0,pe.length-1)+oe[++ce];J.push(pe)}for(var Be=0;Be<J.length;++Be)J[Be]=J[Be].replace(/[=][0-9A-Fa-f]{2}/g,function(De){return String.fromCharCode(parseInt(De.slice(1),16))});return _o(J.join(`\r
`))}function Zt(oe,J,ce){for(var pe="",Be="",De="",se,Fe=0;Fe<10;++Fe){var he=J[Fe];if(!he||he.match(/^\s*$/))break;var Re=he.match(/^(.*?):\s*([^\s].*)$/);if(Re)switch(Re[1].toLowerCase()){case"content-location":pe=Re[2].trim();break;case"content-type":De=Re[2].trim();break;case"content-transfer-encoding":Be=Re[2].trim();break}}switch(++Fe,Be.toLowerCase()){case"base64":se=_o(Po(J.slice(Fe).join("")));break;case"quoted-printable":se=tr(J.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Be)}var Ee=Lt(oe,pe.slice(ce.length),se,{unsafe:!0});De&&(Ee.ctype=De)}function et(oe,J){if(Z(oe.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ce=J&&J.root||"",pe=(Kr&&Buffer.isBuffer(oe)?oe.toString("binary"):Z(oe)).split(`\r
`),Be=0,De="";for(Be=0;Be<pe.length;++Be)if(De=pe[Be],!!/^Content-Location:/i.test(De)&&(De=De.slice(De.indexOf("file")),ce||(ce=De.slice(0,De.lastIndexOf("/")+1)),De.slice(0,ce.length)!=ce))for(;ce.length>0&&(ce=ce.slice(0,ce.length-1),ce=ce.slice(0,ce.lastIndexOf("/")+1),De.slice(0,ce.length)!=ce););var se=(pe[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var Fe="--"+(se[1]||""),he=[],Re=[],Ee={FileIndex:he,FullPaths:Re};E(Ee);var Ze,Je=0;for(Be=0;Be<pe.length;++Be){var Ye=pe[Be];Ye!==Fe&&Ye!==Fe+"--"||(Je++&&Zt(Ee,pe.slice(Ze,Be),ce),Ze=Be)}return Ee}function Rt(oe,J){var ce=J||{},pe=ce.boundary||"SheetJS";pe="------="+pe;for(var Be=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+pe.slice(2)+'"',"","",""],De=oe.FullPaths[0],se=De,Fe=oe.FileIndex[0],he=1;he<oe.FullPaths.length;++he)if(se=oe.FullPaths[he].slice(De.length),Fe=oe.FileIndex[he],!(!Fe.size||!Fe.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ft){return"_x"+ft.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ft){return"_u"+ft.charCodeAt(0).toString(16)+"_"});for(var Re=Fe.content,Ee=Kr&&Buffer.isBuffer(Re)?Re.toString("binary"):Z(Re),Ze=0,Je=Math.min(1024,Ee.length),Ye=0,$e=0;$e<=Je;++$e)(Ye=Ee.charCodeAt($e))>=32&&Ye<128&&++Ze;var it=Ze>=Je*4/5;Be.push(pe),Be.push("Content-Location: "+(ce.root||"file:///C:/SheetJS/")+se),Be.push("Content-Transfer-Encoding: "+(it?"quoted-printable":"base64")),Be.push("Content-Type: "+Ct(Fe,se)),Be.push(""),Be.push(it?Ot(Ee):Xt(Ee))}return Be.push(pe+`--\r
`),Be.join(`\r
`)}function er(oe){var J={};return E(J,oe),J}function Lt(oe,J,ce,pe){var Be=pe&&pe.unsafe;Be||E(oe);var De=!Be&&wr.find(oe,J);if(!De){var se=oe.FullPaths[0];J.slice(0,se.length)==se?se=J:(se.slice(-1)!="/"&&(se+="/"),se=(se+J).replace("//","/")),De={name:s(J),type:2},oe.FileIndex.push(De),oe.FullPaths.push(se),Be||wr.utils.cfb_gc(oe)}return De.content=ce,De.size=ce?ce.length:0,pe&&(pe.CLSID&&(De.clsid=pe.CLSID),pe.mt&&(De.mt=pe.mt),pe.ct&&(De.ct=pe.ct)),De}function Vt(oe,J){E(oe);var ce=wr.find(oe,J);if(ce){for(var pe=0;pe<oe.FileIndex.length;++pe)if(oe.FileIndex[pe]==ce)return oe.FileIndex.splice(pe,1),oe.FullPaths.splice(pe,1),!0}return!1}function nr(oe,J,ce){E(oe);var pe=wr.find(oe,J);if(pe){for(var Be=0;Be<oe.FileIndex.length;++Be)if(oe.FileIndex[Be]==pe)return oe.FileIndex[Be].name=s(ce),oe.FullPaths[Be]=ce,!0}return!1}function Mt(oe){S(oe,!0)}return e.find=_,e.read=L,e.parse=A,e.write=ye,e.writeFile=me,e.utils={cfb_new:er,cfb_add:Lt,cfb_del:Vt,cfb_mov:nr,cfb_gc:Mt,ReadShift:sg,CheckField:M8,prep_blob:Ga,bconcat:Ba,use_zlib:I,_deflateRaw:ve,_inflateRaw:G,consts:fe},e}();function bce(t){return typeof t=="string"?$2(t):Array.isArray(t)?$le(t):t}function Hx(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=$2(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?wc(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([bce(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=Nu(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function wce(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Rs(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function xP(t,e){for(var r=[],n=Rs(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function W2(t){for(var e=[],r=Rs(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function J2(t){for(var e=[],r=Rs(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function Nce(t){for(var e=[],r=Rs(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var kb=new Date(1899,11,30,0,0,0);function xa(t,e){var r=t.getTime(),n=kb.getTime()+(t.getTimezoneOffset()-kb.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var v8=new Date,Cce=kb.getTime()+(v8.getTimezoneOffset()-kb.getTimezoneOffset())*6e4,vP=v8.getTimezoneOffset();function X2(t){var e=new Date;return e.setTime(t*24*60*60*1e3+Cce),e.getTimezoneOffset()!==vP&&e.setTime(e.getTime()+(e.getTimezoneOffset()-vP)*6e4),e}function _ce(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var yP=new Date("2017-02-19T19:06:09.000Z"),y8=isNaN(yP.getFullYear())?new Date("2/19/17"):yP,Ece=y8.getFullYear()==2017;function ns(t,e){var r=new Date(t);if(Ece)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(y8.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Uh(t,e){if(Kr&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return wc(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return wc(o8(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return wc(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return wc(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function ss(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=ss(t[r]));return e}function Fs(t,e){for(var r="";r.length<e;)r+=t;return r}function Ql(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var Bce=["january","february","march","april","may","june","july","august","september","october","november","december"];function q0(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Bce.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var Sce=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],l=1;l<i.length;++l)o.push(s),o.push(i[l]);return o}}();function b8(t){return t?t.content&&t.type?Uh(t.content,!0):t.data?Bp(t.data):t.asNodeBuffer&&Kr?Bp(t.asNodeBuffer().toString("binary")):t.asBinary?Bp(t.asBinary()):t._data&&t._data.getContent?Bp(Uh(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function w8(t){if(!t)return null;if(t.data)return lP(t.data);if(t.asNodeBuffer&&Kr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?lP(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function Ice(t){return t&&t.name.slice(-4)===".bin"?w8(t):b8(t)}function nl(t,e){for(var r=t.FullPaths||Rs(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function AI(t,e){var r=nl(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Zs(t,e,r){if(!r)return Ice(AI(t,e));if(!e)return null;try{return Zs(t,e)}catch{return null}}function Eo(t,e,r){if(!r)return b8(AI(t,e));if(!e)return null;try{return Eo(t,e)}catch{return null}}function jce(t,e,r){return w8(AI(t,e))}function bP(t){for(var e=t.FullPaths||Rs(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Hr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Kr?n=Rd(r):n=zle(r),wr.utils.cfb_add(t,e,n)}wr.utils.cfb_add(t,e,r)}else t.file(e,r)}function uI(){return wr.utils.cfb_new()}function N8(t,e){switch(e.type){case"base64":return wr.read(t,{type:"base64"});case"binary":return wr.read(t,{type:"binary"});case"buffer":case"array":return wr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Ip(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Js=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,kce=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,wP=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Fce=/<[^>]*>/g,bi=Js.match(wP)?wP:Fce,Tce=/<\w*:/,Pce=/<(\/?)\w+:/;function Ir(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var o=t.match(kce),l=0,c="",d=0,A="",u="",f=1;if(o)for(d=0;d!=o.length;++d){for(u=o[d],i=0;i!=u.length&&u.charCodeAt(i)!==61;++i);for(A=u.slice(0,i).trim();u.charCodeAt(i+1)==32;)++i;for(f=(s=u.charCodeAt(i+1))==34||s==39?1:0,c=u.slice(i+1+f,u.length-f),l=0;l!=A.length&&A.charCodeAt(l)!==58;++l);if(l===A.length)A.indexOf("_")>0&&(A=A.slice(0,A.indexOf("_"))),n[A]=c,n[A.toLowerCase()]=c;else{var h=(l===5&&A.slice(0,5)==="xmlns"?"xmlns":"")+A.slice(l+1);if(n[h]&&A.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function Pc(t){return t.replace(Pce,"<$1")}var C8={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},hI=W2(C8),An=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(l,c){return C8[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(e,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,o)+r(s.slice(o+3))}}(),fI=/[&<>'"]/g,Rce=/[\u0000-\u0008\u000b-\u001f]/g;function jn(t){var e=t+"";return e.replace(fI,function(r){return hI[r]}).replace(Rce,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function NP(t){return jn(t).replace(/ /g,"_x0020_")}var _8=/[\u0000-\u001f]/g;function mI(t){var e=t+"";return e.replace(fI,function(r){return hI[r]}).replace(/\n/g,"<br/>").replace(_8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Dce(t){var e=t+"";return e.replace(fI,function(r){return hI[r]}).replace(_8,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var CP=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Lce(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function es(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function tC(t){for(var e="",r=0,n=0,s=0,i=0,o=0,l=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,e+=String.fromCharCode(o);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}o=t.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function _P(t){var e=Au(2*t.length),r,n,s=1,i=0,o=0,l;for(n=0;n<t.length;n+=s)s=1,(l=t.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[i++]=o&255,e[i++]=o>>>8,o=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function EP(t){return Rd(t,"binary").toString("utf8")}var E1="foo bar baz",Rn=Kr&&(EP(E1)==tC(E1)&&EP||_P(E1)==tC(E1)&&_P)||tC,wc=Kr?function(t){return Rd(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},nx=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),E8=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),Uce=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Oce=/<\/?(?:vt:)?variant>/g,Mce=/<(?:vt:)([^>]*)>([\s\S]*)</;function BP(t,e){var r=Ir(t),n=t.match(Uce(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var o=i.replace(Oce,"").match(Mce);o&&s.push({v:Rn(o[2]),t:o[1]})}),s}var B8=/(^\s|\s$|\n)/;function za(t,e){return"<"+t+(e.match(B8)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function sx(t){return Rs(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Jt(t,e,r){return"<"+t+(r!=null?sx(r):"")+(e!=null?(e.match(B8)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function jE(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function Qce(t,e){switch(typeof t){case"string":var r=Jt("vt:lpwstr",jn(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Jt((t|0)==t?"vt:i4":"vt:r8",jn(String(t)));case"boolean":return Jt("vt:bool",t?"true":"false")}if(t instanceof Date)return Jt("vt:filetime",jE(t));throw new Error("Unable to serialize "+t)}function pI(t){if(Kr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Rn(Nu(lI(t)));throw new Error("Bad input format: expected Buffer or string")}var ax=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,fa={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},tf=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],No={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Vce(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function Hce(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,o=n?-e:e;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var l=0;l<=5;++l,i/=256)t[r+l]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var SP=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},IP=Kr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Rd(e)})):SP(t)}:SP,jP=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(Ad(t,s)));return n.join("").replace(Li,"")},gI=Kr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Li,""):jP(t,e,r)}:jP,kP=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},S8=Kr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):kP(t,e,r)}:kP,FP=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Wf(t,s)));return n.join("")},Kx=Kr?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):FP(e,r,n)}:FP,I8=function(t,e){var r=Co(t,e);return r>0?Kx(t,e+4,e+4+r-1):""},j8=I8,k8=function(t,e){var r=Co(t,e);return r>0?Kx(t,e+4,e+4+r-1):""},F8=k8,T8=function(t,e){var r=2*Co(t,e);return r>0?Kx(t,e+4,e+4+r-1):""},P8=T8,R8=function(e,r){var n=Co(e,r);return n>0?gI(e,r+4,r+4+n):""},D8=R8,L8=function(t,e){var r=Co(t,e);return r>0?Kx(t,e+4,e+4+r):""},U8=L8,O8=function(t,e){return Vce(t,e)},Fb=O8,xI=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Kr&&(j8=function(e,r){if(!Buffer.isBuffer(e))return I8(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},F8=function(e,r){if(!Buffer.isBuffer(e))return k8(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},P8=function(e,r){if(!Buffer.isBuffer(e))return T8(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},D8=function(e,r){if(!Buffer.isBuffer(e))return R8(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},U8=function(e,r){if(!Buffer.isBuffer(e))return L8(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Fb=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):O8(e,r)},xI=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Wf=function(t,e){return t[e]},Ad=function(t,e){return t[e+1]*256+t[e]},Kce=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Co=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},eh=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},qce=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function sg(t,e){var r="",n,s,i=[],o,l,c,d;switch(e){case"dbcs":if(d=this.l,Kr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Ad(this,d)),d+=2;t*=2;break;case"utf8":r=Kx(this,this.l,this.l+t);break;case"utf16le":t*=2,r=gI(this,this.l,this.l+t);break;case"wstr":return sg.call(this,t,"dbcs");case"lpstr-ansi":r=j8(this,this.l),t=4+Co(this,this.l);break;case"lpstr-cp":r=F8(this,this.l),t=4+Co(this,this.l);break;case"lpwstr":r=P8(this,this.l),t=4+2*Co(this,this.l);break;case"lpp4":t=4+Co(this,this.l),r=D8(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Co(this,this.l),r=U8(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Wf(this,this.l+t++))!==0;)i.push(_1(o));r=i.join("");break;case"_wstr":for(t=0,r="";(o=Ad(this,this.l+t))!==0;)i.push(_1(o)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Wf(this,d),this.l=d+1,l=sg.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(_1(Ad(this,d))),d+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Wf(this,d),this.l=d+1,l=sg.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(_1(Wf(this,d))),d+=1}r=i.join("");break;default:switch(t){case 1:return n=Wf(this,this.l),this.l++,n;case 2:return n=(e==="i"?Kce:Ad)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?eh:qce)(this,this.l),this.l+=4,n):(s=Co(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=Fb(this,this.l):s=Fb([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=S8(this,this.l,t);break}}return this.l+=t,r}var Gce=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},$ce=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},zce=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function Wce(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)zce(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var o=e.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Gce(this,e,this.l);break;case 8:if(n=8,r==="f"){Hce(this,e,this.l);break}case 16:break;case-4:n=4,$ce(this,e,this.l);break}return this.l+=n,this}function M8(t,e){var r=S8(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Ga(t,e){t.l=e,t.read_shift=sg,t.chk=M8,t.write_shift=Wce}function yi(t,e){t.l+=e}function _t(t){var e=Au(t);return Ga(e,0),e}function Dd(t,e,r){if(t){var n,s,i;Ga(t,t.l||0);for(var o=t.length,l=0,c=0;t.l<o;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var d=Ax[l]||Ax[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;c=t.l+i;var A=d.f&&d.f(t,i,r);if(t.l=c,e(A,d,l))return}}}function ro(){var t=[],e=Kr?256:2048,r=function(d){var A=_t(d);return Ga(A,0),A},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(s(),n=r(Math.max(d+1,e)))},o=function(){return s(),Ba(t)},l=function(d){s(),n=d,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:l,end:o,_bufs:t}}function Tt(t,e,r,n){var s=+e,i;if(!isNaN(s)){n||(n=Ax[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=t.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&xI(r)&&t.push(r)}}function ag(t,e,r){var n=ss(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function TP(t,e,r){var n=ss(t);return n.s=ag(n.s,e.s,r),n.e=ag(n.e,e.s,r),n}function ig(t,e){if(t.cRel&&t.c<0)for(t=ss(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=ss(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Er(t);return!t.cRel&&t.cRel!=null&&(r=Yce(r)),!t.rRel&&t.rRel!=null&&(r=Jce(r)),r}function rC(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+ws(t.s.c)+":"+(t.e.cRel?"":"$")+ws(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+zs(t.s.r)+":"+(t.e.rRel?"":"$")+zs(t.e.r):ig(t.s,e.biff)+":"+ig(t.e,e.biff)}function vI(t){return parseInt(Xce(t),10)-1}function zs(t){return""+(t+1)}function Jce(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Xce(t){return t.replace(/\$(\d+)$/,"$1")}function yI(t){for(var e=Zce(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function ws(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Yce(t){return t.replace(/^([A-Z])/,"$$$1")}function Zce(t){return t.replace(/^\$([A-Z])/,"$1")}function ede(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ns(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Er(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function no(t){var e=t.indexOf(":");return e==-1?{s:Ns(t),e:Ns(t)}:{s:Ns(t.slice(0,e)),e:Ns(t.slice(e+1))}}function Or(t,e){return typeof e>"u"||typeof e=="number"?Or(t.s,t.e):(typeof t!="string"&&(t=Er(t)),typeof e!="string"&&(e=Er(e)),t==e?t:t+":"+e)}function hn(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function PP(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=xl(t.z,r?xa(e):e)}catch{}try{return t.w=xl((t.XF||{}).numFmtId||(r?14:0),r?xa(e):e)}catch{return""+e}}function kd(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Ld[t.v]||t.v:e==null?PP(t,t.v):PP(t,e))}function Cu(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Q8(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),o=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Ns(n.origin):n.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var A=hn(i["!ref"]);d.s.c=A.s.c,d.s.r=A.s.r,d.e.c=Math.max(d.e.c,A.e.c),d.e.r=Math.max(d.e.r,A.e.r),o==-1&&(d.e.r=o=A.e.r+1)}for(var u=0;u!=e.length;++u)if(e[u]){if(!Array.isArray(e[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=e[u].length;++f)if(!(typeof e[u][f]>"u")){var h={v:e[u][f]},m=o+u,p=l+f;if(d.s.r>m&&(d.s.r=m),d.s.c>p&&(d.s.c=p),d.e.r<m&&(d.e.r=m),d.e.c<p&&(d.e.c=p),e[u][f]&&typeof e[u][f]=="object"&&!Array.isArray(e[u][f])&&!(e[u][f]instanceof Date))h=e[u][f];else if(Array.isArray(h.v)&&(h.f=e[u][f][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||_r[14],n.cellDates?(h.t="d",h.w=xl(h.z,xa(h.v))):(h.t="n",h.v=xa(h.v),h.w=xl(h.z,h.v))):h.t="s";if(s)i[m]||(i[m]=[]),i[m][p]&&i[m][p].z&&(h.z=i[m][p].z),i[m][p]=h;else{var g=Er({c:p,r:m});i[g]&&i[g].z&&(h.z=i[g].z),i[g]=h}}}return d.s.c<1e7&&(i["!ref"]=Or(d)),i}function hm(t,e){return Q8(null,t,e)}function tde(t){return t.read_shift(4,"i")}function Vl(t,e){return e||(e=_t(4)),e.write_shift(4,t),e}function xi(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Sa(t,e){var r=!1;return e==null&&(r=!0,e=_t(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function rde(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function nde(t,e){return e||(e=_t(4)),e.write_shift(2,0),e.write_shift(2,0),e}function bI(t,e){var r=t.l,n=t.read_shift(1),s=xi(t),i=[],o={t:s,h:s};if(n&1){for(var l=t.read_shift(4),c=0;c!=l;++c)i.push(rde(t));o.r=i}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function sde(t,e){var r=!1;return e==null&&(r=!0,e=_t(15+4*t.t.length)),e.write_shift(1,0),Sa(t.t,e),r?e.slice(0,e.l):e}var ade=bI;function ide(t,e){var r=!1;return e==null&&(r=!0,e=_t(23+4*t.t.length)),e.write_shift(1,1),Sa(t.t,e),e.write_shift(4,1),nde({},e),r?e.slice(0,e.l):e}function yl(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function rf(t,e){return e==null&&(e=_t(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function nf(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function sf(t,e){return e==null&&(e=_t(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var ode=xi,V8=Sa;function wI(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Tb(t,e){var r=!1;return e==null&&(r=!0,e=_t(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var lde=xi,kE=wI,NI=Tb;function CI(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?Fb([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):eh(e,0)>>2;return r?s/100:s}function H8(t,e){e==null&&(e=_t(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function K8(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function cde(t,e){return e||(e=_t(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var af=K8,fm=cde;function gi(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Oh(t,e){return(e||_t(8)).write_shift(8,t,"f")}function dde(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var d=gh[s];d&&(e.rgb=ox(d));break;case 2:e.rgb=ox([o,l,c]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function Pb(t,e){if(e||(e=_t(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Ade(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function ude(t,e){e||(e=_t(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function q8(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function hde(t){return q8(t,1)}function fde(t){return q8(t,2)}var _I=2,$i=3,B1=11,RP=12,Rb=19,S1=64,mde=65,pde=71,gde=4108,xde=4126,_a=80,G8=81,vde=[_a,G8],FE={1:{n:"CodePage",t:_I},2:{n:"Category",t:_a},3:{n:"PresentationFormat",t:_a},4:{n:"ByteCount",t:$i},5:{n:"LineCount",t:$i},6:{n:"ParagraphCount",t:$i},7:{n:"SlideCount",t:$i},8:{n:"NoteCount",t:$i},9:{n:"HiddenCount",t:$i},10:{n:"MultimediaClipCount",t:$i},11:{n:"ScaleCrop",t:B1},12:{n:"HeadingPairs",t:gde},13:{n:"TitlesOfParts",t:xde},14:{n:"Manager",t:_a},15:{n:"Company",t:_a},16:{n:"LinksUpToDate",t:B1},17:{n:"CharacterCount",t:$i},19:{n:"SharedDoc",t:B1},22:{n:"HyperlinksChanged",t:B1},23:{n:"AppVersion",t:$i,p:"version"},24:{n:"DigSig",t:mde},26:{n:"ContentType",t:_a},27:{n:"ContentStatus",t:_a},28:{n:"Language",t:_a},29:{n:"Version",t:_a},255:{},2147483648:{n:"Locale",t:Rb},2147483651:{n:"Behavior",t:Rb},1919054434:{}},TE={1:{n:"CodePage",t:_I},2:{n:"Title",t:_a},3:{n:"Subject",t:_a},4:{n:"Author",t:_a},5:{n:"Keywords",t:_a},6:{n:"Comments",t:_a},7:{n:"Template",t:_a},8:{n:"LastAuthor",t:_a},9:{n:"RevNumber",t:_a},10:{n:"EditTime",t:S1},11:{n:"LastPrinted",t:S1},12:{n:"CreatedDate",t:S1},13:{n:"ModifiedDate",t:S1},14:{n:"PageCount",t:$i},15:{n:"WordCount",t:$i},16:{n:"CharCount",t:$i},17:{n:"Thumbnail",t:pde},18:{n:"Application",t:_a},19:{n:"DocSecurity",t:$i},255:{},2147483648:{n:"Locale",t:Rb},2147483651:{n:"Behavior",t:Rb},1919054434:{}},DP={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},yde=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function bde(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var wde=bde([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),gh=ss(wde),Ld={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},$8={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},PE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},I1={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function EI(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Nde(t){var e=EI();if(!t||!t.match)return e;var r={};if((t.match(bi)||[]).forEach(function(n){var s=Ir(n);switch(s[0].replace(Tce,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[PE[s.ContentType]]!==void 0&&e[PE[s.ContentType]].push(s.PartName);break}}),e.xmlns!==fa.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function z8(t,e){var r=Nce(PE),n=[],s;n[n.length]=Js,n[n.length]=Jt("Types",null,{xmlns:fa.CT,"xmlns:xsd":fa.xsd,"xmlns:xsi":fa.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Jt("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){t[c]&&t[c].length>0&&(s=t[c][0],n[n.length]=Jt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:I1[c][e.bookType]||I1[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(d){n[n.length]=Jt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:I1[c][e.bookType]||I1[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(d){n[n.length]=Jt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var $r={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ix(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function og(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(bi)||[]).forEach(function(s){var i=Ir(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:Ip(i.Target,e);r[l]=o,n[i.Id]=o}}),r["!id"]=n,r}function N0(t){var e=[Js,Jt("Relationships",null,{xmlns:fa.RELS})];return Rs(t["!id"]).forEach(function(r){e[e.length]=Jt("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Bn(t,e,r,n,s,i){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[$r.HLINK,$r.XPATH,$r.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var Cde="application/vnd.oasis.opendocument.spreadsheet";function _de(t,e){for(var r=pI(t),n,s;n=ax.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Ir(n[0],!1),s.path=="/"&&s.type!==Cde)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function Ede(t){var e=[Js];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function LP(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function Bde(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function Sde(t){var e=[Js];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(LP(t[r][0],t[r][1])),e.push(Bde("",t[r][0]));return e.push(LP("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function W8(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Bb.version+"</meta:generator></office:meta></office:document-meta>"}var fl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Ide=function(){for(var t=new Array(fl.length),e=0;e<fl.length;++e){var r=fl[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function J8(t){var e={};t=Rn(t);for(var r=0;r<fl.length;++r){var n=fl[r],s=t.match(Ide[r]);s!=null&&s.length>0&&(e[n[1]]=An(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=ns(e[n[1]]))}return e}function nC(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=jn(e),n[n.length]=r?Jt(t,e,r):za(t,e))}function X8(t,e){var r=e||{},n=[Js,Jt("cp:coreProperties",null,{"xmlns:cp":fa.CORE_PROPS,"xmlns:dc":fa.dc,"xmlns:dcterms":fa.dcterms,"xmlns:dcmitype":fa.dcmitype,"xmlns:xsi":fa.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&nC("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:jE(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&nC("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:jE(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=fl.length;++i){var o=fl[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&nC(o[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var xh=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Y8=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Z8(t,e,r,n){var s=[];if(typeof t=="string")s=BP(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(A){return{v:A}}));var o=typeof e=="string"?BP(e,n).map(function(A){return A.v}):e,l=0,c=0;if(o.length>0)for(var d=0;d!==s.length;d+=2){switch(c=+s[d+1].v,s[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function jde(t,e,r){var n={};return e||(e={}),t=Rn(t),xh.forEach(function(s){var i=(t.match(nx(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=An(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var o=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Z8(n.HeadingPairs,n.TitlesOfParts,e,r),e}function eQ(t){var e=[],r=Jt;return t||(t={}),t.Application="SheetJS",e[e.length]=Js,e[e.length]=Jt("Properties",null,{xmlns:fa.EXT_PROPS,"xmlns:vt":fa.vt}),xh.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=jn(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+jn(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var kde=/<[^>]+>[^<]*/g;function Fde(t,e){var r={},n="",s=t.match(kde);if(s)for(var i=0;i!=s.length;++i){var o=s[i],l=Ir(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=An(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),d=c[0].slice(4),A=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=An(A);break;case"bool":r[n]=es(A);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(A,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(A);break;case"filetime":case"date":r[n]=ns(A);break;case"cy":case"error":r[n]=An(A);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,c)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function tQ(t){var e=[Js,Jt("Properties",null,{xmlns:fa.CUST_PROPS,"xmlns:vt":fa.vt})];if(!t)return e.join("");var r=1;return Rs(t).forEach(function(s){++r,e[e.length]=Jt("property",Qce(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:jn(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var RE={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},sC;function Tde(t,e,r){sC||(sC=W2(RE)),e=sC[e]||e,t[e]=r}function Pde(t,e){var r=[];return Rs(RE).map(function(n){for(var s=0;s<fl.length;++s)if(fl[s][1]==n)return fl[s];for(s=0;s<xh.length;++s)if(xh[s][1]==n)return xh[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(za(RE[n[1]]||n[1],s))}}),Jt("DocumentProperties",r.join(""),{xmlns:No.o})}function Rde(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&Rs(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var o=0;o<fl.length;++o)if(i==fl[o][1])return;for(o=0;o<xh.length;++o)if(i==xh[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=t[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(Jt(NP(i),l,{"dt:dt":c}))}}),e&&Rs(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var o=e[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Jt(NP(i),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+No.o+'">'+s.join("")+"</"+n+">"}function BI(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Dde(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var o=_t(8);return o.write_shift(4,n),o.write_shift(4,s),o}function rQ(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function nQ(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function sQ(t,e,r){return e===31?nQ(t):rQ(t,e,r)}function DE(t,e,r){return sQ(t,e,r===!1?0:4)}function Lde(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return sQ(t,e,0)}function Ude(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Li,""),t.l-s&2&&(t.l+=2)}return r}function Ode(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Li,"");return r}function Mde(t){var e=t.l,r=Db(t,G8);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Db(t,$i);return[r,n]}function Qde(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(Mde(t));return r}function UP(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),o=t.read_shift(4);n[i]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Li,"").replace(Sp,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function aQ(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function Vde(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Db(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==RP&&n!==e&&vde.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===RP?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return rQ(t,n,4).replace(Li,"");case 31:return nQ(t);case 64:return BI(t);case 65:return aQ(t);case 71:return Vde(t);case 80:return DE(t,n,!i.raw).replace(Li,"");case 81:return Lde(t,n).replace(Li,"");case 4108:return Qde(t);case 4126:case 4127:return n==4127?Ude(t):Ode(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function OP(t,e){var r=_t(4),n=_t(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=_t(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=Dde(e);break;case 31:case 80:for(n=_t(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Ba([r,n])}function MP(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],o=0,l=0,c=-1,d={};for(o=0;o!=s;++o){var A=t.read_shift(4),u=t.read_shift(4);i[o]=[A,u+r]}i.sort(function(b,w){return b[1]-w[1]});var f={};for(o=0;o!=s;++o){if(t.l!==i[o][1]){var h=!0;if(o>0&&e)switch(e[i[o-1][0]].t){case 2:t.l+2===i[o][1]&&(t.l+=2,h=!1);break;case 80:t.l<=i[o][1]&&(t.l=i[o][1],h=!1);break;case 4108:t.l<=i[o][1]&&(t.l=i[o][1],h=!1);break}if((!e||o==0)&&t.l<=i[o][1]&&(h=!1,t.l=i[o][1]),h)throw new Error("Read Error: Expected address "+i[o][1]+" at "+t.l+" :"+o)}if(e){var m=e[i[o][0]];if(f[m.n]=Db(t,m.t,{raw:!0}),m.p==="version"&&(f[m.n]=String(f[m.n]>>16)+"."+("0000"+String(f[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(f[m.n]){case 0:f[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Dl(l=f[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[m.n])}}else if(i[o][0]===1){if(l=f.CodePage=Db(t,_I),Dl(l),c!==-1){var p=t.l;t.l=i[c][1],d=UP(t,l),t.l=p}}else if(i[o][0]===0){if(l===0){c=o,t.l=i[o+1][1];continue}d=UP(t,l)}else{var g=d[i[o][0]],x;switch(t[t.l]){case 65:t.l+=4,x=aQ(t);break;case 30:t.l+=4,x=DE(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,x=DE(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,x=t.read_shift(4,"i");break;case 19:t.l+=4,x=t.read_shift(4);break;case 5:t.l+=4,x=t.read_shift(8,"f");break;case 11:t.l+=4,x=Vs(t,4);break;case 64:t.l+=4,x=ns(BI(t));break;default:throw new Error("unparsed value: "+t[t.l])}f[g]=x}}return t.l=r+n,f}var iQ=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Hde(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function QP(t,e,r){var n=_t(8),s=[],i=[],o=8,l=0,c=_t(8),d=_t(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),s.push(d),o+=8+c.length,!e){d=_t(8),d.write_shift(4,0),s.unshift(d);var A=[_t(4)];for(A[0].write_shift(4,t.length),l=0;l<t.length;++l){var u=t[l][0];for(c=_t(8+2*(u.length+1)+(u.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,u.length+1),c.write_shift(0,u,"dbcs");c.l!=c.length;)c.write_shift(1,0);A.push(c)}c=Ba(A),i.unshift(c),o+=8+c.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(iQ.indexOf(t[l][0])>-1||Y8.indexOf(t[l][0])>-1)&&t[l][1]!=null){var f=t[l][1],h=0;if(e){h=+e[t[l][0]];var m=r[h];if(m.p=="version"&&typeof f=="string"){var p=f.split(".");f=(+p[0]<<16)+(+p[1]||0)}c=OP(m.t,f)}else{var g=Hde(f);g==-1&&(g=31,f=String(f)),c=OP(g,f)}i.push(c),d=_t(8),d.write_shift(4,e?h:2+l),s.push(d),o+=8+c.length}var x=8*(i.length+1);for(l=0;l<i.length;++l)s[l].write_shift(4,x),x+=i[l].length;return n.write_shift(4,o),n.write_shift(4,i.length),Ba([n].concat(s).concat(i))}function VP(t,e,r){var n=t.content;if(!n)return{};Ga(n,0);var s,i,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),A=n.read_shift(16);if(A!==wr.utils.consts.HEADER_CLSID&&A!==r)throw new Error("Bad PropertySet CLSID "+A);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),l=n.read_shift(4),s===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);s===2&&(o=n.read_shift(16),c=n.read_shift(4));var u=MP(n,e),f={SystemIdentifier:d};for(var h in u)f[h]=u[h];if(f.FMTID=i,s===1)return f;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=MP(n,null)}catch{}for(h in m)f[h]=m[h];return f.FMTID=[i,o],f}function HP(t,e,r,n,s,i){var o=_t(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,wr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,s?68:48);var c=QP(t,r,n);if(l.push(c),s){var d=QP(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(d)}return Ba(l)}function uA(t,e){return t.read_shift(e),null}function Kde(t,e){e||(e=_t(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function qde(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Vs(t,e){return t.read_shift(e)===1}function Ti(t,e){return e||(e=_t(2)),e.write_shift(2,+!!t),e}function ea(t){return t.read_shift(2,"u")}function sl(t,e){return e||(e=_t(2)),e.write_shift(2,t),e}function oQ(t,e){return qde(t,e,ea)}function Gde(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function lQ(t,e,r){return r||(r=_t(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function qx(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?t.read_shift(n,s):"";return o}function $de(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),o=0,l,c={};s&&(o=t.read_shift(2)),n&&(l=t.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",A=e===0?"":t.read_shift(e,d);return s&&(t.l+=4*o),n&&(t.l+=l),c.t=A,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function zde(t){var e=t.t||"",r=_t(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=_t(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return Ba(s)}function Mh(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Gx(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Mh(t,n,r)}function of(t,e,r){if(r.biff>5)return Gx(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function cQ(t,e,r){return r||(r=_t(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function Wde(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function Jde(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Li,"");return n&&(t.l+=24),s}function Xde(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(i>>1,"utf16le").replace(Li,"");return r+o}function Yde(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Jde(t);case"0303000000000000c000000000000046":return Xde(t);default:throw new Error("Unsupported Moniker "+r)}}function j1(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Li,""):"";return r}function KP(t,e){e||(e=_t(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function Zde(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,o,l,c,d="",A,u;s&16&&(i=j1(t,r-t.l)),s&128&&(o=j1(t,r-t.l)),(s&257)===257&&(l=j1(t,r-t.l)),(s&257)===1&&(c=Yde(t,r-t.l)),s&8&&(d=j1(t,r-t.l)),s&32&&(A=t.read_shift(16)),s&64&&(u=BI(t)),t.l=r;var f=o||l||c||"";f&&d&&(f+="#"+d),f||(f="#"+d),s&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var h={Target:f};return A&&(h.guid=A),u&&(h.time=u),i&&(h.Tooltip=i),h}function eAe(t){var e=_t(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(i==28)n=n.slice(1),KP(n,e);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var l=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),i&8&&KP(s>-1?n.slice(s+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function dQ(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function AQ(t,e){var r=dQ(t);return r[3]=0,r}function Rc(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Qh(t,e,r,n){return n||(n=_t(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function tAe(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function rAe(t,e,r){return e===0?"":of(t,e,r)}function nAe(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[s,i,o]}function uQ(t){var e=t.read_shift(2),r=CI(t);return[e,r]}function sAe(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=qx(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function Y2(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function hQ(t,e){return e||(e=_t(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function fQ(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var aAe=fQ;function mQ(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function iAe(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function oAe(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function li(t){t.l+=2,t.l+=t.read_shift(2)}var lAe={0:li,4:li,5:li,6:li,7:oAe,8:li,9:li,10:li,11:li,12:li,13:iAe,14:li,15:li,16:li,17:li,18:li,19:li,20:li,21:mQ};function cAe(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(lAe[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function k1(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function SI(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=_t(s);return i.write_shift(2,n),i.write_shift(2,e),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function dAe(t,e){return e===0||t.read_shift(2),1200}function AAe(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=of(t,0,r);return t.read_shift(e+n-t.l),s}function uAe(t,e){var r=!e||e.biff==8,n=_t(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function hAe(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function fAe(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=qx(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:i,name:o}}function mAe(t,e){var r=!e||e.biff>=8?2:1,n=_t(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function pAe(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],o=0;o!=s&&t.l<r;++o)i.push($de(t));return i.Count=n,i.Unique=s,i}function gAe(t,e){var r=_t(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=zde(t[s]);var i=Ba([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function xAe(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function vAe(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function yAe(t){var e=tAe(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function bAe(t){return t.read_shift(2),t.read_shift(4)}function qP(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function wAe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:d}}function NAe(){var t=_t(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function CAe(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function _Ae(t){var e=_t(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function EAe(){}function BAe(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=qx(t,0,r),n}function SAe(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,i=_t(s);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function IAe(t){var e=Rc(t);return e.isst=t.read_shift(4),e}function jAe(t,e,r,n){var s=_t(10);return Qh(t,e,n,s),s.write_shift(4,r),s}function kAe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Rc(t);r.biff==2&&t.l++;var i=Gx(t,n-t.l,r);return s.val=i,s}function FAe(t,e,r,n,s){var i=!s||s.biff==8,o=_t(8+ +i+(1+i)*r.length);return Qh(t,e,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function TAe(t,e,r){var n=t.read_shift(2),s=of(t,0,r);return[n,s]}function PAe(t,e,r,n){var s=r&&r.biff==5;n||(n=_t(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var RAe=of;function GP(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),o=t.read_shift(s),l=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:i,c:l},e:{r:o,c}}}function DAe(t,e){var r=e.biff==8||!e.biff?4:2,n=_t(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function LAe(t){var e=t.read_shift(2),r=t.read_shift(2),n=uQ(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function UAe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(uQ(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:i}}function OAe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:i}}function MAe(t,e,r,n){var s={},i=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return s.patternType=yde[l>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function QAe(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=MAe(t,e,n.fStyle,r),n}function $P(t,e,r,n){var s=r&&r.biff==5;n||(n=_t(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function VAe(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function HAe(t){var e=_t(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function zP(t,e,r){var n=Rc(t);(r.biff==2||e==9)&&++t.l;var s=Gde(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function KAe(t,e,r,n,s,i){var o=_t(8);return Qh(t,e,n,o),lQ(r,i,o),o}function qAe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Rc(t),s=gi(t);return n.val=s,n}function GAe(t,e,r,n){var s=_t(14);return Qh(t,e,n,s),Oh(r,s),s}var WP=rAe;function $Ae(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=Mh(t,i),l=[];n>t.l;)l.push(Gx(t));return[i,s,o,l]}function JP(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=sAe(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var zAe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function XP(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=Mh(t,o,r);s&32&&(d=zAe[d.charCodeAt(0)]);var A=n-t.l;r&&r.biff==2&&--A;var u=n==t.l||l===0||!(A>0)?[]:cme(t,A,r,l);return{chKey:i,Name:d,itab:c,rgce:u}}function pQ(t,e,r){if(r.biff<8)return WAe(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(nAe(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function WAe(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=qx(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function JAe(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=Mh(t,n,r),o=Mh(t,s,r);return[i,o]}function XAe(t,e,r){var n=fQ(t);t.l++;var s=t.read_shift(1);return e-=8,[dme(t,e,r),s,n]}function YP(t,e,r){var n=aAe(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,ome(t,e,r)]}function YAe(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function ZAe(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),l=of(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},l,o,i]}}function eue(t,e,r){return ZAe(t,e,r)}function tue(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Y2(t));return r}function rue(t){var e=_t(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)hQ(t[r],e);return e}function nue(t,e,r){if(r&&r.biff<8)return aue(t,e,r);var n=mQ(t),s=cAe(t,e-22,n[1]);return{cmo:n,ft:s}}var sue={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function aue(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((sue[n]||yi)(t,e,r)),{cmo:[s,n,i],ft:o}}function iue(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:o=Wde(t,6,r);var l=t.read_shift(2);t.read_shift(2),ea(t,2);var c=t.read_shift(2);t.l+=c;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var A=t[t.l],u=Mh(t,t.lens[d+1]-t.lens[d]-1);if(s+=u,s.length>=(A?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function oue(t,e){var r=Y2(t);t.l+=16;var n=Zde(t,e-24);return[r,n]}function lue(t){var e=_t(24),r=Ns(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return Ba([e,eAe(t[1])])}function cue(t,e){t.read_shift(2);var r=Y2(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Li,""),[r,n]}function due(t){var e=t[1].Tooltip,r=_t(10+2*(e.length+1));r.write_shift(2,2048);var n=Ns(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function Aue(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=DP[r]||r,r=t.read_shift(2),e[1]=DP[r]||r,e}function uue(t){return t||(t=_t(4)),t.write_shift(2,1),t.write_shift(2,1),t}function hue(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(AQ(t));return r}function fue(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(AQ(t));return r}function mue(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function gQ(t,e,r){if(!r.cellStyles)return yi(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var d={s,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function pue(t,e){var r=_t(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function gue(t,e){var r={};return e<32||(t.l+=16,r.header=gi(t),r.footer=gi(t),t.l+=2),r}function xue(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function vue(t){for(var e=_t(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var yue=Rc,bue=oQ,wue=Gx;function Nue(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function Cue(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Rc(t);++t.l;var s=of(t,e-7,r);return n.t="str",n.val=s,n}function _ue(t){var e=Rc(t);++t.l;var r=gi(t);return e.t="n",e.val=r,e}function Eue(t,e,r){var n=_t(15);return Jx(n,t,e),n.write_shift(8,r,"f"),n}function Bue(t){var e=Rc(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function Sue(t,e,r){var n=_t(9);return Jx(n,t,e),n.write_shift(2,r),n}function Iue(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function jue(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function kue(t,e,r){var n=t.l+e,s=Rc(t),i=t.read_shift(2),o=Mh(t,i,r);return t.l=n,s.t="str",s.val=o,s}var Fue=[2,3,48,49,131,139,140,245],LE=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=W2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],A=Au(1);switch(c.type){case"base64":A=_o(Po(l));break;case"binary":A=_o(l);break;case"buffer":case"array":A=l;break}Ga(A,0);var u=A.read_shift(1),f=!!(u&136),h=!1,m=!1;switch(u){case 2:break;case 3:break;case 48:h=!0,f=!0;break;case 49:h=!0,f=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var p=0,g=521;u==2&&(p=A.read_shift(2)),A.l+=3,u!=2&&(p=A.read_shift(4)),p>1048576&&(p=1e6),u!=2&&(g=A.read_shift(2));var x=A.read_shift(2),b=c.codepage||1252;u!=2&&(A.l+=16,A.read_shift(1),A[A.l]!==0&&(b=t[A[A.l]]),A.l+=1,A.l+=2),m&&(A.l+=36);for(var w=[],k={},O=Math.min(A.length,u==2?521:g-10-(h?264:0)),L=m?32:11;A.l<O&&A[A.l]!=13;)switch(k={},k.name=ex.utils.decode(b,A.slice(A.l,A.l+L)).replace(/[\u0000\r\n].*$/g,""),A.l+=L,k.type=String.fromCharCode(A.read_shift(1)),u!=2&&!m&&(k.offset=A.read_shift(4)),k.len=A.read_shift(1),u==2&&(k.offset=A.read_shift(2)),k.dec=A.read_shift(1),k.name.length&&w.push(k),u!=2&&(A.l+=m?13:14),k.type){case"B":(!h||k.len!=8)&&c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(A[A.l]!==13&&(A.l=g-1),A.read_shift(1)!==13)throw new Error("DBF Terminator not found "+A.l+" "+A[A.l]);A.l=g;var E=0,B=0;for(d[0]=[],B=0;B!=w.length;++B)d[0][B]=w[B].name;for(;p-- >0;){if(A[A.l]===42){A.l+=x;continue}for(++A.l,d[++E]=[],B=0,B=0;B!=w.length;++B){var S=A.slice(A.l,A.l+w[B].len);A.l+=w[B].len,Ga(S,0);var U=ex.utils.decode(b,S);switch(w[B].type){case"C":U.trim().length&&(d[E][B]=U.replace(/\s+$/,""));break;case"D":U.length===8?d[E][B]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):d[E][B]=U;break;case"F":d[E][B]=parseFloat(U.trim());break;case"+":case"I":d[E][B]=m?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":d[E][B]=!0;break;case"N":case"F":d[E][B]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));d[E][B]="##MEMO##"+(m?parseInt(U.trim(),10):S.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(d[E][B]=+U||0);break;case"@":d[E][B]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":d[E][B]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":d[E][B]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[E][B]=-S.read_shift(-8,"f");break;case"B":if(h&&w[B].len==8){d[E][B]=S.read_shift(8,"f");break}case"G":case"P":S.l+=w[B].len;break;case"0":if(w[B].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[B].type)}}}if(u!=2&&A.l<A.length&&A[A.l++]!=26)throw new Error("DBF EOF Marker missing "+(A.l-1)+" of "+A.length+" "+A[A.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=w,d}function n(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var A=hm(r(l,d),d);return A["!cols"]=d.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete d.DBF,A}function s(l,c){try{return Cu(n(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var d=c||{};if(+d.codepage>=0&&Dl(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var A=ro(),u=Ob(l,{header:1,raw:!0,cellDates:!0}),f=u[0],h=u.slice(1),m=l["!cols"]||[],p=0,g=0,x=0,b=1;for(p=0;p<f.length;++p){if(((m[p]||{}).DBF||{}).name){f[p]=m[p].DBF.name,++x;continue}if(f[p]!=null){if(++x,typeof f[p]=="number"&&(f[p]=f[p].toString(10)),typeof f[p]!="string")throw new Error("DBF Invalid column name "+f[p]+" |"+typeof f[p]+"|");if(f.indexOf(f[p])!==p){for(g=0;g<1024;++g)if(f.indexOf(f[p]+"_"+g)==-1){f[p]+="_"+g;break}}}}var w=hn(l["!ref"]),k=[],O=[],L=[];for(p=0;p<=w.e.c-w.s.c;++p){var E="",B="",S=0,U=[];for(g=0;g<h.length;++g)h[g][p]!=null&&U.push(h[g][p]);if(U.length==0||f[p]==null){k[p]="?";continue}for(g=0;g<U.length;++g){switch(typeof U[g]){case"number":B="B";break;case"string":B="C";break;case"boolean":B="L";break;case"object":B=U[g]instanceof Date?"D":"C";break;default:B="C"}S=Math.max(S,String(U[g]).length),E=E&&E!=B?"C":B}S>250&&(S=250),B=((m[p]||{}).DBF||{}).type,B=="C"&&m[p].DBF.len>S&&(S=m[p].DBF.len),E=="B"&&B=="N"&&(E="N",L[p]=m[p].DBF.dec,S=m[p].DBF.len),O[p]=E=="C"||B=="N"?S:i[E]||0,b+=O[p],k[p]=E}var _=A.next(32);for(_.write_shift(4,318902576),_.write_shift(4,h.length),_.write_shift(2,296+32*x),_.write_shift(2,b),p=0;p<4;++p)_.write_shift(4,0);for(_.write_shift(4,0|(+e[i8]||3)<<8),p=0,g=0;p<f.length;++p)if(f[p]!=null){var F=A.next(32),D=(f[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,D,"sbcs"),F.write_shift(1,k[p]=="?"?"C":k[p],"sbcs"),F.write_shift(4,g),F.write_shift(1,O[p]||i[k[p]]||0),F.write_shift(1,L[p]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),g+=O[p]||i[k[p]]||0}var X=A.next(264);for(X.write_shift(4,13),p=0;p<65;++p)X.write_shift(4,0);for(p=0;p<h.length;++p){var ge=A.next(b);for(ge.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(k[g]){case"L":ge.write_shift(1,h[p][g]==null?63:h[p][g]?84:70);break;case"B":ge.write_shift(8,h[p][g]||0,"f");break;case"N":var ae="0";for(typeof h[p][g]=="number"&&(ae=h[p][g].toFixed(L[g]||0)),x=0;x<O[g]-ae.length;++x)ge.write_shift(1,32);ge.write_shift(1,ae,"sbcs");break;case"D":h[p][g]?(ge.write_shift(4,("0000"+h[p][g].getFullYear()).slice(-4),"sbcs"),ge.write_shift(2,("00"+(h[p][g].getMonth()+1)).slice(-2),"sbcs"),ge.write_shift(2,("00"+h[p][g].getDate()).slice(-2),"sbcs")):ge.write_shift(8,"00000000","sbcs");break;case"C":var fe=String(h[p][g]!=null?h[p][g]:"").slice(0,O[g]);for(ge.write_shift(1,fe,"sbcs"),x=0;x<O[g]-fe.length;++x)ge.write_shift(1,32);break}}return A.next(1).write_shift(1,26),A.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),xQ=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Rs(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,h){var m=t[h];return typeof m=="number"?cP(m):m},n=function(f,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?f:cP(p)};t["|"]=254;function s(f,h){switch(h.type){case"base64":return i(Po(f),h);case"binary":return i(f,h);case"buffer":return i(Kr&&Buffer.isBuffer(f)?f.toString("binary"):Nu(f),h);case"array":return i(Uh(f),h)}throw new Error("Unrecognized type "+h.type)}function i(f,h){var m=f.split(/[\n\r]+/),p=-1,g=-1,x=0,b=0,w=[],k=[],O=null,L={},E=[],B=[],S=[],U=0,_;for(+h.codepage>=0&&Dl(+h.codepage);x!==m.length;++x){U=0;var F=m[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),D=F.replace(/;;/g,"\0").split(";").map(function(T){return T.replace(/\u0000/g,";")}),X=D[0],ge;if(F.length>0)switch(X){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&k.push(F.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,fe=!1,me=!1,Z=!1,ye=-1,Ie=-1;for(b=1;b<D.length;++b)switch(D[b].charAt(0)){case"A":break;case"X":g=parseInt(D[b].slice(1))-1,fe=!0;break;case"Y":for(p=parseInt(D[b].slice(1))-1,fe||(g=0),_=w.length;_<=p;++_)w[_]=[];break;case"K":ge=D[b].slice(1),ge.charAt(0)==='"'?ge=ge.slice(1,ge.length-1):ge==="TRUE"?ge=!0:ge==="FALSE"?ge=!1:isNaN(Ql(ge))?isNaN(q0(ge).getDate())||(ge=ns(ge)):(ge=Ql(ge),O!==null&&Am(O)&&(ge=X2(ge))),ae=!0;break;case"E":Z=!0;var I=C0(D[b].slice(1),{r:p,c:g});w[p][g]=[w[p][g],I];break;case"S":me=!0,w[p][g]=[w[p][g],"S5S"];break;case"G":break;case"R":ye=parseInt(D[b].slice(1))-1;break;case"C":Ie=parseInt(D[b].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+F)}if(ae&&(w[p][g]&&w[p][g].length==2?w[p][g][0]=ge:w[p][g]=ge,O=null),me){if(Z)throw new Error("SYLK shared formula cannot have own formula");var j=ye>-1&&w[ye][Ie];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");w[p][g][1]=DQ(j[1],{r:p-ye,c:g-Ie})}break;case"F":var Q=0;for(b=1;b<D.length;++b)switch(D[b].charAt(0)){case"X":g=parseInt(D[b].slice(1))-1,++Q;break;case"Y":for(p=parseInt(D[b].slice(1))-1,_=w.length;_<=p;++_)w[_]=[];break;case"M":U=parseInt(D[b].slice(1))/20;break;case"F":break;case"G":break;case"P":O=k[parseInt(D[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=D[b].slice(1).split(" "),_=parseInt(S[0],10);_<=parseInt(S[1],10);++_)U=parseInt(S[2],10),B[_-1]=U===0?{hidden:!0}:{wch:U},uu(B[_-1]);break;case"C":g=parseInt(D[b].slice(1))-1,B[g]||(B[g]={});break;case"R":p=parseInt(D[b].slice(1))-1,E[p]||(E[p]={}),U>0?(E[p].hpt=U,E[p].hpx=$0(U)):U===0&&(E[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+F)}Q<1&&(O=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+F)}}return E.length>0&&(L["!rows"]=E),B.length>0&&(L["!cols"]=B),h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),[w,L]}function o(f,h){var m=s(f,h),p=m[0],g=m[1],x=hm(p,h);return Rs(g).forEach(function(b){x[b]=g[b]}),x}function l(f,h){return Cu(o(f,h),h)}function c(f,h,m,p){var g="C;Y"+(m+1)+";X"+(p+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+PI(f.f,{r:m,c:p}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function d(f,h){h.forEach(function(m,p){var g="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=lx(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=cx(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function A(f,h){h.forEach(function(m,p){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*dx(m.hpx)+";"),g.length>2&&f.push(g+"R"+(p+1))})}function u(f,h){var m=["ID;PWXL;N;E"],p=[],g=hn(f["!ref"]),x,b=Array.isArray(f),w=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),f["!cols"]&&d(m,f["!cols"]),f["!rows"]&&A(m,f["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var k=g.s.r;k<=g.e.r;++k)for(var O=g.s.c;O<=g.e.c;++O){var L=Er({r:k,c:O});x=b?(f[k]||[])[O]:f[L],!(!x||x.v==null&&(!x.f||x.F))&&p.push(c(x,f,k,O))}return m.join(w)+w+p.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:u}}(),vQ=function(){function t(i,o){switch(o.type){case"base64":return e(Po(i),o);case"binary":return e(i,o);case"buffer":return e(Kr&&Buffer.isBuffer(i)?i.toString("binary"):Nu(i),o);case"array":return e(Uh(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){for(var l=i.split(`
`),c=-1,d=-1,A=0,u=[];A!==l.length;++A){if(l[A].trim()==="BOT"){u[++c]=[],d=0;continue}if(!(c<0)){var f=l[A].trim().split(","),h=f[0],m=f[1];++A;for(var p=l[A]||"";(p.match(/["]/g)||[]).length&1&&A<l.length-1;)p+=`
`+l[++A];switch(p=p.trim(),+h){case-1:if(p==="BOT"){u[++c]=[],d=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?u[c][d]=!0:p==="FALSE"?u[c][d]=!1:isNaN(Ql(m))?isNaN(q0(m).getDate())?u[c][d]=m:u[c][d]=ns(m):u[c][d]=Ql(m),++d;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),u[c][d++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(u=u.slice(0,o.sheetRows)),u}function r(i,o){return hm(t(i,o),o)}function n(i,o){return Cu(r(i,o),o)}var s=function(){var i=function(c,d,A,u,f){c.push(d),c.push(A+","+u),c.push('"'+f.replace(/"/g,'""')+'"')},o=function(c,d,A,u){c.push(d+","+A),c.push(d==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(c){var d=[],A=hn(c["!ref"]),u,f=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,A.e.r-A.s.r+1,""),i(d,"TUPLES",0,A.e.c-A.s.c+1,""),i(d,"DATA",0,0,"");for(var h=A.s.r;h<=A.e.r;++h){o(d,-1,0,"BOT");for(var m=A.s.c;m<=A.e.c;++m){var p=Er({r:h,c:m});if(u=f?(c[h]||[])[m]:c[p],!u){o(d,1,0,"");continue}switch(u.t){case"n":var g=u.w;!g&&u.v!=null&&(g=u.v),g==null?u.f&&!u.F?o(d,1,0,"="+u.f):o(d,1,0,""):o(d,0,g,"V");break;case"b":o(d,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=xl(u.z||_r[14],xa(ns(u.v)))),o(d,0,u.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var x=`\r
`,b=d.join(x);return b}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),yQ=function(){function t(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(u,f){for(var h=u.split(`
`),m=-1,p=-1,g=0,x=[];g!==h.length;++g){var b=h[g].trim().split(":");if(b[0]==="cell"){var w=Ns(b[1]);if(x.length<=w.r)for(m=x.length;m<=w.r;++m)x[m]||(x[m]=[]);switch(m=w.r,p=w.c,b[2]){case"t":x[m][p]=t(b[3]);break;case"v":x[m][p]=+b[3];break;case"vtf":var k=b[b.length-1];case"vtc":switch(b[3]){case"nl":x[m][p]=!!+b[4];break;default:x[m][p]=+b[4];break}b[2]=="vtf"&&(x[m][p]=[x[m][p],k])}}}return f&&f.sheetRows&&(x=x.slice(0,f.sheetRows)),x}function n(u,f){return hm(r(u,f),f)}function s(u,f){return Cu(n(u,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(u){if(!u||!u["!ref"])return"";for(var f=[],h=[],m,p="",g=no(u["!ref"]),x=Array.isArray(u),b=g.s.r;b<=g.e.r;++b)for(var w=g.s.c;w<=g.e.c;++w)if(p=Er({r:b,c:w}),m=x?(u[b]||[])[w]:u[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(e(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=e(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var k=xa(ns(m.v));h[2]="vtc",h[3]="nd",h[4]=""+k,h[5]=m.w||xl(m.z||_r[14],k);break;case"e":continue}f.push(h.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function A(u){return[i,o,l,o,d(u),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:A}}(),G0=function(){function t(A,u,f,h,m){m.raw?u[f][h]=A:A===""||(A==="TRUE"?u[f][h]=!0:A==="FALSE"?u[f][h]=!1:isNaN(Ql(A))?isNaN(q0(A).getDate())?u[f][h]=A:u[f][h]=ns(A):u[f][h]=Ql(A))}function e(A,u){var f=u||{},h=[];if(!A||A.length===0)return h;for(var m=A.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var g=10,x=0,b=0;b<=p;++b)x=m[b].indexOf(" "),x==-1?x=m[b].length:x++,g=Math.max(g,x);for(b=0;b<=p;++b){h[b]=[];var w=0;for(t(m[b].slice(0,g).trim(),h,b,w,f),w=1;w<=(m[b].length-g)/10+1;++w)t(m[b].slice(g+(w-1)*10,g+w*10).trim(),h,b,w,f)}return f.sheetRows&&(h=h.slice(0,f.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(A){for(var u={},f=!1,h=0,m=0;h<A.length;++h)(m=A.charCodeAt(h))==34?f=!f:!f&&m in r&&(u[m]=(u[m]||0)+1);m=[];for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&m.push([u[h],h]);if(!m.length){u=n;for(h in u)Object.prototype.hasOwnProperty.call(u,h)&&m.push([u[h],h])}return m.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),r[m.pop()[1]]||44}function i(A,u){var f=u||{},h="",m=f.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};A.slice(0,4)=="sep="?A.charCodeAt(5)==13&&A.charCodeAt(6)==10?(h=A.charAt(4),A=A.slice(7)):A.charCodeAt(5)==13||A.charCodeAt(5)==10?(h=A.charAt(4),A=A.slice(6)):h=s(A.slice(0,1024)):f&&f.FS?h=f.FS:h=s(A.slice(0,1024));var g=0,x=0,b=0,w=0,k=0,O=h.charCodeAt(0),L=!1,E=0,B=A.charCodeAt(0);A=A.replace(/\r\n/mg,`
`);var S=f.dateNF!=null?xce(f.dateNF):null;function U(){var _=A.slice(w,k),F={};if(_.charAt(0)=='"'&&_.charAt(_.length-1)=='"'&&(_=_.slice(1,-1).replace(/""/g,'"')),_.length===0)F.t="z";else if(f.raw)F.t="s",F.v=_;else if(_.trim().length===0)F.t="s",F.v=_;else if(_.charCodeAt(0)==61)_.charCodeAt(1)==34&&_.charCodeAt(_.length-1)==34?(F.t="s",F.v=_.slice(2,-1).replace(/""/g,'"')):$fe(_)?(F.t="n",F.f=_.slice(1)):(F.t="s",F.v=_);else if(_=="TRUE")F.t="b",F.v=!0;else if(_=="FALSE")F.t="b",F.v=!1;else if(!isNaN(b=Ql(_)))F.t="n",f.cellText!==!1&&(F.w=_),F.v=b;else if(!isNaN(q0(_).getDate())||S&&_.match(S)){F.z=f.dateNF||_r[14];var D=0;S&&_.match(S)&&(_=vce(_,f.dateNF,_.match(S)||[]),D=1),f.cellDates?(F.t="d",F.v=ns(_,D)):(F.t="n",F.v=xa(ns(_,D))),f.cellText!==!1&&(F.w=xl(F.z,F.v instanceof Date?xa(F.v):F.v)),f.cellNF||delete F.z}else F.t="s",F.v=_;if(F.t=="z"||(f.dense?(m[g]||(m[g]=[]),m[g][x]=F):m[Er({c:x,r:g})]=F),w=k+1,B=A.charCodeAt(w),p.e.c<x&&(p.e.c=x),p.e.r<g&&(p.e.r=g),E==O)++x;else if(x=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;k<A.length;++k)switch(E=A.charCodeAt(k)){case 34:B===34&&(L=!L);break;case O:case 10:case 13:if(!L&&U())break e;break}return k-w>0&&U(),m["!ref"]=Or(p),m}function o(A,u){return!(u&&u.PRN)||u.FS||A.slice(0,4)=="sep="||A.indexOf("	")>=0||A.indexOf(",")>=0||A.indexOf(";")>=0?i(A,u):hm(e(A,u),u)}function l(A,u){var f="",h=u.type=="string"?[0,0,0,0]:VI(A,u);switch(u.type){case"base64":f=Po(A);break;case"binary":f=A;break;case"buffer":u.codepage==65001?f=A.toString("utf8"):u.codepage&&typeof ex<"u"||(f=Kr&&Buffer.isBuffer(A)?A.toString("binary"):Nu(A));break;case"array":f=Uh(A);break;case"string":f=A;break;default:throw new Error("Unrecognized type "+u.type)}return h[0]==239&&h[1]==187&&h[2]==191?f=Rn(f.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?f=Rn(f):u.type=="binary"&&typeof ex<"u",f.slice(0,19)=="socialcalc:version:"?yQ.to_sheet(u.type=="string"?f:Rn(f),u):o(f,u)}function c(A,u){return Cu(l(A,u),u)}function d(A){for(var u=[],f=hn(A["!ref"]),h,m=Array.isArray(A),p=f.s.r;p<=f.e.r;++p){for(var g=[],x=f.s.c;x<=f.e.c;++x){var b=Er({r:p,c:x});if(h=m?(A[p]||[])[x]:A[b],!h||h.v==null){g.push("          ");continue}for(var w=(h.w||(kd(h),h.w)||"").slice(0,10);w.length<10;)w+=" ";g.push(w+(x===0?" ":""))}u.push(g.join(""))}return u.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}}();function Tue(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=xQ.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return G0.to_workbook(t,e)}}var vh=function(){function t(I,j,Q){if(I){Ga(I,I.l||0);for(var T=Q.Enum||ye;I.l<I.length;){var R=I.read_shift(2),K=T[R]||T[65535],M=I.read_shift(2),re=I.l+M,de=K.f&&K.f(I,M,Q);if(I.l=re,j(de,K,R))return}}}function e(I,j){switch(j.type){case"base64":return r(_o(Po(I)),j);case"binary":return r(_o(I),j);case"buffer":case"array":return r(I,j)}throw"Unsupported type "+j.type}function r(I,j){if(!I)return I;var Q=j||{},T=Q.dense?[]:{},R="Sheet1",K="",M=0,re={},de=[],le=[],q={s:{r:0,c:0},e:{r:0,c:0}},Se=Q.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)Q.Enum=ye,t(I,function(Ne,Y,we){switch(we){case 0:Q.vers=Ne,Ne>=4096&&(Q.qpro=!0);break;case 6:q=Ne;break;case 204:Ne&&(K=Ne);break;case 222:K=Ne;break;case 15:case 51:Q.qpro||(Ne[1].v=Ne[1].v.slice(1));case 13:case 14:case 16:we==14&&(Ne[2]&112)==112&&(Ne[2]&15)>1&&(Ne[2]&15)<15&&(Ne[1].z=Q.dateNF||_r[14],Q.cellDates&&(Ne[1].t="d",Ne[1].v=X2(Ne[1].v))),Q.qpro&&Ne[3]>M&&(T["!ref"]=Or(q),re[R]=T,de.push(R),T=Q.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},M=Ne[3],R=K||"Sheet"+(M+1),K="");var Pe=Q.dense?(T[Ne[0].r]||[])[Ne[0].c]:T[Er(Ne[0])];if(Pe){Pe.t=Ne[1].t,Pe.v=Ne[1].v,Ne[1].z!=null&&(Pe.z=Ne[1].z),Ne[1].f!=null&&(Pe.f=Ne[1].f);break}Q.dense?(T[Ne[0].r]||(T[Ne[0].r]=[]),T[Ne[0].r][Ne[0].c]=Ne[1]):T[Er(Ne[0])]=Ne[1];break}},Q);else if(I[2]==26||I[2]==14)Q.Enum=Ie,I[2]==14&&(Q.qpro=!0,I.l=0),t(I,function(Ne,Y,we){switch(we){case 204:R=Ne;break;case 22:Ne[1].v=Ne[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ne[3]>M&&(T["!ref"]=Or(q),re[R]=T,de.push(R),T=Q.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},M=Ne[3],R="Sheet"+(M+1)),Se>0&&Ne[0].r>=Se)break;Q.dense?(T[Ne[0].r]||(T[Ne[0].r]=[]),T[Ne[0].r][Ne[0].c]=Ne[1]):T[Er(Ne[0])]=Ne[1],q.e.c<Ne[0].c&&(q.e.c=Ne[0].c),q.e.r<Ne[0].r&&(q.e.r=Ne[0].r);break;case 27:Ne[14e3]&&(le[Ne[14e3][0]]=Ne[14e3][1]);break;case 1537:le[Ne[0]]=Ne[1],Ne[0]==M&&(R=Ne[1]);break}},Q);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(T["!ref"]=Or(q),re[K||R]=T,de.push(K||R),!le.length)return{SheetNames:de,Sheets:re};for(var ee={},z=[],te=0;te<le.length;++te)re[de[te]]?(z.push(le[te]||de[te]),ee[le[te]]=re[le[te]]||re[de[te]]):(z.push(le[te]),ee[le[te]]={"!ref":"A1"});return{SheetNames:z,Sheets:ee}}function n(I,j){var Q=j||{};if(+Q.codepage>=0&&Dl(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK1 to JS string");var T=ro(),R=hn(I["!ref"]),K=Array.isArray(I),M=[];Yt(T,0,i(1030)),Yt(T,6,c(R));for(var re=Math.min(R.e.r,8191),de=R.s.r;de<=re;++de)for(var le=zs(de),q=R.s.c;q<=R.e.c;++q){de===R.s.r&&(M[q]=ws(q));var Se=M[q]+le,ee=K?(I[de]||[])[q]:I[Se];if(!(!ee||ee.t=="z"))if(ee.t=="n")(ee.v|0)==ee.v&&ee.v>=-32768&&ee.v<=32767?Yt(T,13,h(de,q,ee.v)):Yt(T,14,p(de,q,ee.v));else{var z=kd(ee);Yt(T,15,u(de,q,z.slice(0,239)))}}return Yt(T,1),T.end()}function s(I,j){var Q=j||{};if(+Q.codepage>=0&&Dl(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK3 to JS string");var T=ro();Yt(T,0,o(I));for(var R=0,K=0;R<I.SheetNames.length;++R)(I.Sheets[I.SheetNames[R]]||{})["!ref"]&&Yt(T,27,Z(I.SheetNames[R],K++));var M=0;for(R=0;R<I.SheetNames.length;++R){var re=I.Sheets[I.SheetNames[R]];if(!(!re||!re["!ref"])){for(var de=hn(re["!ref"]),le=Array.isArray(re),q=[],Se=Math.min(de.e.r,8191),ee=de.s.r;ee<=Se;++ee)for(var z=zs(ee),te=de.s.c;te<=de.e.c;++te){ee===de.s.r&&(q[te]=ws(te));var Ne=q[te]+z,Y=le?(re[ee]||[])[te]:re[Ne];if(!(!Y||Y.t=="z"))if(Y.t=="n")Yt(T,23,U(ee,te,M,Y.v));else{var we=kd(Y);Yt(T,22,E(ee,te,M,we.slice(0,239)))}}++M}}return Yt(T,1),T.end()}function i(I){var j=_t(2);return j.write_shift(2,I),j}function o(I){var j=_t(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var Q=0,T=0,R=0,K=0;K<I.SheetNames.length;++K){var M=I.SheetNames[K],re=I.Sheets[M];if(!(!re||!re["!ref"])){++R;var de=no(re["!ref"]);Q<de.e.r&&(Q=de.e.r),T<de.e.c&&(T=de.e.c)}}return Q>8191&&(Q=8191),j.write_shift(2,Q),j.write_shift(1,R),j.write_shift(1,T),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function l(I,j,Q){var T={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&Q.qpro?(T.s.c=I.read_shift(1),I.l++,T.s.r=I.read_shift(2),T.e.c=I.read_shift(1),I.l++,T.e.r=I.read_shift(2),T):(T.s.c=I.read_shift(2),T.s.r=I.read_shift(2),j==12&&Q.qpro&&(I.l+=2),T.e.c=I.read_shift(2),T.e.r=I.read_shift(2),j==12&&Q.qpro&&(I.l+=2),T.s.c==65535&&(T.s.c=T.e.c=T.s.r=T.e.r=0),T)}function c(I){var j=_t(8);return j.write_shift(2,I.s.c),j.write_shift(2,I.s.r),j.write_shift(2,I.e.c),j.write_shift(2,I.e.r),j}function d(I,j,Q){var T=[{c:0,r:0},{t:"n",v:0},0,0];return Q.qpro&&Q.vers!=20768?(T[0].c=I.read_shift(1),T[3]=I.read_shift(1),T[0].r=I.read_shift(2),I.l+=2):(T[2]=I.read_shift(1),T[0].c=I.read_shift(2),T[0].r=I.read_shift(2)),T}function A(I,j,Q){var T=I.l+j,R=d(I,j,Q);if(R[1].t="s",Q.vers==20768){I.l++;var K=I.read_shift(1);return R[1].v=I.read_shift(K,"utf8"),R}return Q.qpro&&I.l++,R[1].v=I.read_shift(T-I.l,"cstr"),R}function u(I,j,Q){var T=_t(7+Q.length);T.write_shift(1,255),T.write_shift(2,j),T.write_shift(2,I),T.write_shift(1,39);for(var R=0;R<T.length;++R){var K=Q.charCodeAt(R);T.write_shift(1,K>=128?95:K)}return T.write_shift(1,0),T}function f(I,j,Q){var T=d(I,j,Q);return T[1].v=I.read_shift(2,"i"),T}function h(I,j,Q){var T=_t(7);return T.write_shift(1,255),T.write_shift(2,j),T.write_shift(2,I),T.write_shift(2,Q,"i"),T}function m(I,j,Q){var T=d(I,j,Q);return T[1].v=I.read_shift(8,"f"),T}function p(I,j,Q){var T=_t(13);return T.write_shift(1,255),T.write_shift(2,j),T.write_shift(2,I),T.write_shift(8,Q,"f"),T}function g(I,j,Q){var T=I.l+j,R=d(I,j,Q);if(R[1].v=I.read_shift(8,"f"),Q.qpro)I.l=T;else{var K=I.read_shift(2);k(I.slice(I.l,I.l+K),R),I.l+=K}return R}function x(I,j,Q){var T=j&32768;return j&=-32769,j=(T?I:0)+(j>=8192?j-16384:j),(T?"":"$")+(Q?ws(j):zs(j))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(I,j){Ga(I,0);for(var Q=[],T=0,R="",K="",M="",re="";I.l<I.length;){var de=I[I.l++];switch(de){case 0:Q.push(I.read_shift(8,"f"));break;case 1:K=x(j[0].c,I.read_shift(2),!0),R=x(j[0].r,I.read_shift(2),!1),Q.push(K+R);break;case 2:{var le=x(j[0].c,I.read_shift(2),!0),q=x(j[0].r,I.read_shift(2),!1);K=x(j[0].c,I.read_shift(2),!0),R=x(j[0].r,I.read_shift(2),!1),Q.push(le+q+":"+K+R)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:Q.push("("+Q.pop()+")");break;case 5:Q.push(I.read_shift(2));break;case 6:{for(var Se="";de=I[I.l++];)Se+=String.fromCharCode(de);Q.push('"'+Se.replace(/"/g,'""')+'"')}break;case 8:Q.push("-"+Q.pop());break;case 23:Q.push("+"+Q.pop());break;case 22:Q.push("NOT("+Q.pop()+")");break;case 20:case 21:re=Q.pop(),M=Q.pop(),Q.push(["AND","OR"][de-20]+"("+M+","+re+")");break;default:if(de<32&&w[de])re=Q.pop(),M=Q.pop(),Q.push(M+w[de]+re);else if(b[de]){if(T=b[de][1],T==69&&(T=I[I.l++]),T>Q.length){console.error("WK1 bad formula parse 0x"+de.toString(16)+":|"+Q.join("|")+"|");return}var ee=Q.slice(-T);Q.length-=T,Q.push(b[de][0]+"("+ee.join(",")+")")}else return de<=7?console.error("WK1 invalid opcode "+de.toString(16)):de<=24?console.error("WK1 unsupported op "+de.toString(16)):de<=30?console.error("WK1 invalid opcode "+de.toString(16)):de<=115?console.error("WK1 unsupported function opcode "+de.toString(16)):console.error("WK1 unrecognized opcode "+de.toString(16))}}Q.length==1?j[1].f=""+Q[0]:console.error("WK1 bad formula parse |"+Q.join("|")+"|")}function O(I){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=I.read_shift(2),j[3]=I[I.l++],j[0].c=I[I.l++],j}function L(I,j){var Q=O(I);return Q[1].t="s",Q[1].v=I.read_shift(j-4,"cstr"),Q}function E(I,j,Q,T){var R=_t(6+T.length);R.write_shift(2,I),R.write_shift(1,Q),R.write_shift(1,j),R.write_shift(1,39);for(var K=0;K<T.length;++K){var M=T.charCodeAt(K);R.write_shift(1,M>=128?95:M)}return R.write_shift(1,0),R}function B(I,j){var Q=O(I);Q[1].v=I.read_shift(2);var T=Q[1].v>>1;if(Q[1].v&1)switch(T&7){case 0:T=(T>>3)*5e3;break;case 1:T=(T>>3)*500;break;case 2:T=(T>>3)/20;break;case 3:T=(T>>3)/200;break;case 4:T=(T>>3)/2e3;break;case 5:T=(T>>3)/2e4;break;case 6:T=(T>>3)/16;break;case 7:T=(T>>3)/64;break}return Q[1].v=T,Q}function S(I,j){var Q=O(I),T=I.read_shift(4),R=I.read_shift(4),K=I.read_shift(2);if(K==65535)return T===0&&R===3221225472?(Q[1].t="e",Q[1].v=15):T===0&&R===3489660928?(Q[1].t="e",Q[1].v=42):Q[1].v=0,Q;var M=K&32768;return K=(K&32767)-16446,Q[1].v=(1-M*2)*(R*Math.pow(2,K+32)+T*Math.pow(2,K)),Q}function U(I,j,Q,T){var R=_t(14);if(R.write_shift(2,I),R.write_shift(1,Q),R.write_shift(1,j),T==0)return R.write_shift(4,0),R.write_shift(4,0),R.write_shift(2,65535),R;var K=0,M=0,re=0,de=0;return T<0&&(K=1,T=-T),M=Math.log2(T)|0,T/=Math.pow(2,M-31),de=T>>>0,de&2147483648||(T/=2,++M,de=T>>>0),T-=de,de|=2147483648,de>>>=0,T*=Math.pow(2,32),re=T>>>0,R.write_shift(4,re),R.write_shift(4,de),M+=16383+(K?32768:0),R.write_shift(2,M),R}function _(I,j){var Q=S(I);return I.l+=j-14,Q}function F(I,j){var Q=O(I),T=I.read_shift(4);return Q[1].v=T>>6,Q}function D(I,j){var Q=O(I),T=I.read_shift(8,"f");return Q[1].v=T,Q}function X(I,j){var Q=D(I);return I.l+=j-10,Q}function ge(I,j){return I[I.l+j-1]==0?I.read_shift(j,"cstr"):""}function ae(I,j){var Q=I[I.l++];Q>j-1&&(Q=j-1);for(var T="";T.length<Q;)T+=String.fromCharCode(I[I.l++]);return T}function fe(I,j,Q){if(!(!Q.qpro||j<21)){var T=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var R=I.read_shift(j-21,"cstr");return[T,R]}}function me(I,j){for(var Q={},T=I.l+j;I.l<T;){var R=I.read_shift(2);if(R==14e3){for(Q[R]=[0,""],Q[R][0]=I.read_shift(2);I[I.l];)Q[R][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return Q}function Z(I,j){var Q=_t(5+I.length);Q.write_shift(2,14e3),Q.write_shift(2,j);for(var T=0;T<I.length;++T){var R=I.charCodeAt(T);Q[Q.l++]=R>127?95:R}return Q[Q.l++]=0,Q}var ye={0:{n:"BOF",f:ea},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:A},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:A},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ge},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},Ie={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:B},25:{n:"FORMULA19",f:_},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:me},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:X},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ge},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:fe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function Pue(t){var e={},r=t.match(bi),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=Ir(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=aI[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var Rue=function(){var t=nx("t"),e=nx("rPr");function r(i){var o=i.match(t);if(!o)return{t:"s",v:""};var l={t:"s",v:An(o[1])},c=i.match(e);return c&&(l.s=Pue(c[1])),l}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(l){return l.v})}}(),Due=function(){var e=/(\r\n|\n)/g;function r(s,i,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),Lue=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Uue=/<(?:\w+:)?r>/,Oue=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function II(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=An(Rn(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Rn(t),r&&(n.h=mI(n.t))):t.match(Uue)&&(n.r=Rn(t),n.t=An(Rn((t.replace(Oue,"").match(Lue)||[]).join("").replace(bi,""))),r&&(n.h=Due(Rue(n.r)))),n):{t:""}}var Mue=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Que=/<(?:\w+:)?(?:si|sstItem)>/g,Vue=/<\/(?:\w+:)?(?:si|sstItem)>/;function Hue(t,e){var r=[],n="";if(!t)return r;var s=t.match(Mue);if(s){n=s[2].replace(Que,"").split(Vue);for(var i=0;i!=n.length;++i){var o=II(n[i].trim(),e);o!=null&&(r[r.length]=o)}s=Ir(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var Kue=/^\s|\s$|[\t\n\r]/;function bQ(t,e){if(!e.bookSST)return"";var r=[Js];r[r.length]=Jt("sst",null,{xmlns:tf[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(Kue)&&(i+=' xml:space="preserve"'),i+=">"+jn(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function que(t){return[t.read_shift(4),t.read_shift(4)]}function Gue(t,e){var r=[],n=!1;return Dd(t,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function $ue(t,e){return e||(e=_t(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var zue=sde;function Wue(t){var e=ro();Tt(e,159,$ue(t));for(var r=0;r<t.length;++r)Tt(e,19,zue(t[r]));return Tt(e,160),e.end()}function wQ(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function bd(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function Jue(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=bd(t,4),e.U=bd(t,4),e.W=bd(t,4),e}function Xue(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function Yue(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(Xue(t));return e}function Zue(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function ehe(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=bd(t,4),e.U=bd(t,4),e.W=bd(t,4),e}function the(t){var e=ehe(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function NQ(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function CQ(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function rhe(t){var e=bd(t);switch(e.Minor){case 2:return[e.Minor,nhe(t)];case 3:return[e.Minor,she()];case 4:return[e.Minor,ahe(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function nhe(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=NQ(t,r),s=CQ(t,t.length-t.l);return{t:"Std",h:n,v:s}}function she(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ahe(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(bi,function(i){var o=Ir(i);switch(Pc(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function ihe(t,e){var r={},n=r.EncryptionVersionInfo=bd(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=NQ(t,s),e-=s,r.EncryptionVerifier=CQ(t,e),r}function ohe(t){var e={},r=e.EncryptionVersionInfo=bd(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function jI(t){var e=0,r,n=wQ(t),s=n.length+1,i,o,l,c,d;for(r=Au(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)o=r[i],l=e&16384?1:0,c=e<<1&32767,d=l|c,e=d^o;return e^52811}var _Q=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,l){return n(o^l)},i=function(o){for(var l=e[o.length-1],c=104,d=o.length-1;d>=0;--d)for(var A=o[d],u=0;u!=7;++u)A&64&&(l^=r[c]),A*=2,--c;return l};return function(o){for(var l=wQ(o),c=i(l),d=l.length,A=Au(16),u=0;u!=16;++u)A[u]=0;var f,h,m;for((d&1)===1&&(f=c>>8,A[d]=s(t[0],f),--d,f=c&255,h=l[l.length-1],A[d]=s(h,f));d>0;)--d,f=c>>8,A[d]=s(l[d],f),--d,f=c&255,A[d]=s(l[d],f);for(d=15,m=15-l.length;m>0;)f=c>>8,A[d]=s(t[m],f),--d,--m,f=c&255,A[d]=s(l[d],f),--d,--m;return A}}(),lhe=function(t,e,r,n,s){s||(s=e),n||(n=_Q(t));var i,o;for(i=0;i!=e.length;++i)o=e[i],o^=n[r],o=(o>>5|o<<3)&255,s[i]=o,++r;return[s,r,n]},che=function(t){var e=0,r=_Q(t);return function(n){var s=lhe("",n,e,r);return e=s[1],s[0]}};function dhe(t,e,r,n){var s={key:ea(t),verificationBytes:ea(t)};return r.password&&(s.verifier=jI(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=che(r.password)),s}function Ahe(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=ohe(t):n.Data=ihe(t,e),n}function uhe(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Ahe(t,e-2,n):dhe(t,r.biff>=8?e:e-2,r,n),n}var EQ=function(){function t(s,i){switch(i.type){case"base64":return e(Po(s),i);case"binary":return e(s,i);case"buffer":return e(Kr&&Buffer.isBuffer(s)?s.toString("binary"):Nu(s),i);case"array":return e(Uh(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var o=i||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(A,u){Array.isArray(l)&&(l[u]=[]);for(var f=/\\\w+\b/g,h=0,m,p=-1;m=f.exec(A);){switch(m[0]){case"\\cell":var g=A.slice(h,f.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var x={v:g,t:"s"};Array.isArray(l)?l[u][p]=x:l[Er({r:u,c:p})]=x}break}h=f.lastIndex}p>d.e.c&&(d.e.c=p)}),l["!ref"]=Or(d),l}function r(s,i){return Cu(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],o=hn(s["!ref"]),l,c=Array.isArray(s),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var A=o.s.c;A<=o.e.c;++A)i.push("\\cellx"+(A+1));for(i.push("\\pard\\intbl"),A=o.s.c;A<=o.e.c;++A){var u=Er({r:d,c:A});l=c?(s[d]||[])[A]:s[u],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(kd(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function hhe(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function ox(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function fhe(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),o=s-i;if(o===0)return[0,0,e];var l=0,c=0,d=s+i;switch(c=o/(d>1?2-d:d),s){case e:l=((r-n)/o+6)%6;break;case r:l=(n-e)/o+2;break;case n:l=(e-r)/o+4;break}return[l/6,c,d/2]}function mhe(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,o=[i,i,i],l=6*e,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function Lb(t,e){if(e===0)return t;var r=fhe(hhe(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),ox(mhe(r))}var BQ=6,phe=15,ghe=1,pi=BQ;function lx(t){return Math.floor((t+Math.round(128/pi)/256)*pi)}function cx(t){return Math.floor((t-5)/pi*100+.5)/100}function Ub(t){return Math.round((t*pi+5)/pi*256)/256}function aC(t){return Ub(cx(lx(t)))}function kI(t){var e=Math.abs(t-aC(t)),r=pi;if(e>.005)for(pi=ghe;pi<phe;++pi)Math.abs(t-aC(t))<=e&&(e=Math.abs(t-aC(t)),r=pi);pi=r}function uu(t){t.width?(t.wpx=lx(t.width),t.wch=cx(t.wpx),t.MDW=pi):t.wpx?(t.wch=cx(t.wpx),t.width=Ub(t.wch),t.MDW=pi):typeof t.wch=="number"&&(t.width=Ub(t.wch),t.wpx=lx(t.width),t.MDW=pi),t.customWidth&&delete t.customWidth}var xhe=96,SQ=xhe;function dx(t){return t*96/SQ}function $0(t){return t*SQ/96}var vhe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function yhe(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(bi)||[]).forEach(function(o){var l=Ir(o);switch(Pc(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=es(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=es(l.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function bhe(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(bi)||[]).forEach(function(o){var l=Ir(o);switch(Pc(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function whe(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(bi)||[]).forEach(function(o){var l=Ir(o);switch(Pc(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=Rn(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?es(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?es(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?es(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?es(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?es(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?es(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?es(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=aI[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=es(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=gh[s.color.index];s.color.index==81&&(c=gh[1]),c||(c=gh[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Lb(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function Nhe(t,e,r){e.NumberFmt=[];for(var n=Rs(_r),s=0;s<n.length;++s)e.NumberFmt[n[s]]=_r[n[s]];var i=t[0].match(bi);if(i)for(s=0;s<i.length;++s){var o=Ir(i[s]);switch(Pc(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=An(Rn(o.formatCode)),c=parseInt(o.numFmtId,10);if(e.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=l}yd(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Che(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Jt("numFmt",null,{numFmtId:n,formatCode:jn(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Jt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var F1=["numFmtId","fillId","fontId","borderId","xfId"],T1=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function _he(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(bi)||[]).forEach(function(i){var o=Ir(i),l=0;switch(Pc(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<F1.length;++l)n[F1[l]]&&(n[F1[l]]=parseInt(n[F1[l]],10));for(l=0;l<T1.length;++l)n[T1[l]]&&(n[T1[l]]=es(n[T1[l]]));if(e.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[l]){n.numFmtId=l;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=es(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Ehe(t){var e=[];return e[e.length]=Jt("cellXfs",null),t.forEach(function(r){e[e.length]=Jt("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Jt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Bhe=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var A={};if(!l)return A;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=l.match(e))&&Nhe(u,A,d),(u=l.match(s))&&whe(u,A,c,d),(u=l.match(n))&&bhe(u,A,c,d),(u=l.match(i))&&yhe(u,A,c,d),(u=l.match(r))&&_he(u,A,d),A}}();function IQ(t,e){var r=[Js,Jt("styleSheet",null,{xmlns:tf[0],"xmlns:vt":fa.vt})],n;return t.SSF&&(n=Che(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Ehe(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function She(t,e){var r=t.read_shift(2),n=xi(t);return[r,n]}function Ihe(t,e,r){r||(r=_t(6+4*e.length)),r.write_shift(2,t),Sa(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function jhe(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=Ade(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=dde(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=xi(t),n}function khe(t,e){e||(e=_t(25+4*32)),e.write_shift(2,t.sz*20),ude(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Pb(t.color,e);var n=0;return n=2,e.write_shift(1,n),Sa(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Fhe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],iC,The=yi;function ZP(t,e){e||(e=_t(4*3+8*7+16*1)),iC||(iC=W2(Fhe));var r=iC[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Pb({auto:1},e),Pb({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Phe(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function jQ(t,e,r){r||(r=_t(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function op(t,e){return e||(e=_t(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Rhe=yi;function Dhe(t,e){return e||(e=_t(51)),e.write_shift(1,0),op(null,e),op(null,e),op(null,e),op(null,e),op(null,e),e.length>e.l?e.slice(0,e.l):e}function Lhe(t,e){return e||(e=_t(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Tb(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Uhe(t,e,r){var n=_t(2052);return n.write_shift(4,t),Tb(e,n),Tb(r,n),n.length>n.l?n.slice(0,n.l):n}function Ohe(t,e,r){var n={};n.NumberFmt=[];for(var s in _r)n.NumberFmt[s]=_r[s];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return Dd(t,function(c,d,A){switch(A){case 44:n.NumberFmt[c[0]]=c[1],yd(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=Lb(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(A),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(A);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+A.toString(16))}}),n}function Mhe(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(Tt(t,615,Vl(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Tt(t,44,Ihe(s,e[s]))}),Tt(t,616))}}function Qhe(t){var e=1;Tt(t,611,Vl(e)),Tt(t,43,khe({sz:12,color:{theme:1},name:"Calibri",family:2})),Tt(t,612)}function Vhe(t){var e=2;Tt(t,603,Vl(e)),Tt(t,45,ZP({patternType:"none"})),Tt(t,45,ZP({patternType:"gray125"})),Tt(t,604)}function Hhe(t){var e=1;Tt(t,613,Vl(e)),Tt(t,46,Dhe()),Tt(t,614)}function Khe(t){var e=1;Tt(t,626,Vl(e)),Tt(t,47,jQ({numFmtId:0},65535)),Tt(t,627)}function qhe(t,e){Tt(t,617,Vl(e.length)),e.forEach(function(r){Tt(t,47,jQ(r,0))}),Tt(t,618)}function Ghe(t){var e=1;Tt(t,619,Vl(e)),Tt(t,48,Lhe({xfId:0,name:"Normal"})),Tt(t,620)}function $he(t){var e=0;Tt(t,505,Vl(e)),Tt(t,506)}function zhe(t){var e=0;Tt(t,508,Uhe(e,"TableStyleMedium9","PivotStyleMedium4")),Tt(t,509)}function Whe(t,e){var r=ro();return Tt(r,278),Mhe(r,t.SSF),Qhe(r),Vhe(r),Hhe(r),Khe(r),qhe(r,e.cellXfs),Ghe(r),$he(r),zhe(r),Tt(r,279),r.end()}var Jhe=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Xhe(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(bi)||[]).forEach(function(s){var i=Ir(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[Jhe.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Yhe(){}function Zhe(){}var efe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,tfe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,rfe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function nfe(t,e,r){e.themeElements={};var n;[["clrScheme",efe,Xhe],["fontScheme",tfe,Yhe],["fmtScheme",rfe,Zhe]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var sfe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function kQ(t,e){(!t||t.length===0)&&(t=FI());var r,n={};if(!(r=t.match(sfe)))throw new Error("themeElements not found in theme");return nfe(r[0],n,e),n.raw=t,n}function FI(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Js];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function afe(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var o;try{o=N8(i,{type:"array"})}catch{return}var l=Eo(o,"theme/theme/theme1.xml",!0);if(l)return kQ(l,r)}}function ife(t){return t.read_shift(4)}function ofe(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=lfe(t,4);break;case 2:e.xclrValue=dQ(t);break;case 3:e.xclrValue=ife(t);break;case 4:t.l+=4;break}return t.l+=8,e}function lfe(t,e){return yi(t,e)}function cfe(t,e){return yi(t,e)}function dfe(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=ofe(t);break;case 6:n[1]=cfe(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function Afe(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(dfe(t,r-t.l));return{ixfe:n,ext:i}}function ufe(t,e){e.forEach(function(r){switch(r[0]){}})}function hfe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:xi(t)}}function ffe(t){var e=_t(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Sa(t.name,e),e.slice(0,e.l)}function mfe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function pfe(t){var e=_t(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function gfe(t,e){var r=_t(8+2*e.length);return r.write_shift(4,t),Sa(e,r),r.slice(0,r.l)}function xfe(t){return t.l+=4,t.read_shift(4)!=0}function vfe(t,e){var r=_t(8);return r.write_shift(4,t),r.write_shift(4,1),r}function yfe(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],o=!1,l=2;return Dd(t,function(c,d,A){switch(A){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(u){l==1?n.Cell.push({type:n.Types[u[0]-1].name,index:u[1]}):l==0&&n.Value.push({type:n.Types[u[0]-1].name,index:u[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(A),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+A.toString(16))}}}),n}function bfe(){var t=ro();return Tt(t,332),Tt(t,334,Vl(1)),Tt(t,335,ffe({name:"XLDAPR",version:12e4,flags:3496657072})),Tt(t,336),Tt(t,339,gfe(1,"XLDAPR")),Tt(t,52),Tt(t,35,Vl(514)),Tt(t,4096,Vl(0)),Tt(t,4097,sl(1)),Tt(t,36),Tt(t,53),Tt(t,340),Tt(t,337,vfe(1)),Tt(t,51,pfe([[1,0]])),Tt(t,338),Tt(t,333),t.end()}function wfe(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,o;return t.replace(bi,function(l){var c=Ir(l);switch(Pc(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==c.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function FQ(){var t=[Js];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function Nfe(t){var e=[];if(!t)return e;var r=1;return(t.match(bi)||[]).forEach(function(n){var s=Ir(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function Cfe(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Er(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function _fe(t,e,r){var n=[];return Dd(t,function(i,o,l){switch(l){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function Efe(t,e,r,n){if(!t)return t;var s=n||{},i=!1;Dd(t,function(l,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function Bfe(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var d0=1024;function TQ(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Jt("xml",null,{"xmlns:v":No.v,"xmlns:o":No.o,"xmlns:x":No.x,"xmlns:mv":No.mv}).replace(/\/>/,">"),Jt("o:shapelayout",Jt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Jt("v:shapetype",[Jt("v:stroke",null,{joinstyle:"miter"}),Jt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];d0<t*1e3;)d0+=1e3;return e.forEach(function(i){var o=Ns(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Jt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Jt("v:fill",c,l),A={on:"t",obscured:"t"};++d0,s=s.concat(["<v:shape"+sx({id:"_x0000_s"+d0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Jt("v:shadow",null,A),Jt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",za("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),za("x:AutoFill","False"),za("x:Row",String(o.r)),za("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function e3(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(o){var l=Ns(o.ref);if(s?(t[l.r]||(t[l.r]=[]),i=t[l.r][l.c]):i=t[o.ref],!i){i={t:"z"},s?t[l.r][l.c]=i:t[o.ref]=i;var c=hn(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=Or(c);d!==t["!ref"]&&(t["!ref"]=d)}i.c||(i.c=[]);var A={a:o.author,t:o.t,r:o.r,T:r};o.h&&(A.h=o.h);for(var u=i.c.length-1;u>=0;--u){if(!r&&i.c[u].T)return;r&&!i.c[u].T&&i.c.splice(u,1)}if(r&&n){for(u=0;u<n.length;++u)if(A.a==n[u].id){A.a=n[u].name||A.a;break}}i.c.push(A)})}function Sfe(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Ir(l[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},A=Ns(c.ref);if(!(e.sheetRows&&e.sheetRows<=A.r)){var u=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!u&&!!u[1]&&II(u[1])||{r:"",t:"",h:""};d.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),d.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=f.h),n.push(d)}}}}),n}function PQ(t){var e=[Js,Jt("comments",null,{xmlns:tf[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var i=jn(s.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(jn(c.a))),i.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)e.push(za("t",jn(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;e.push(za("t",jn(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Ife(t,e){var r=[],n=!1,s={},i=0;return t.replace(bi,function(l,c){var d=Ir(l);switch(Pc(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":s.t=t.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function jfe(t,e,r){var n=[Js,Jt("ThreadedComments",null,{xmlns:fa.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Jt("threadedComment",za("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function kfe(t,e){var r=[],n=!1;return t.replace(bi,function(i){var o=Ir(i);switch(Pc(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function Ffe(t){var e=[Js,Jt("personList",null,{xmlns:fa.TCMNT,"xmlns:x":tf[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Jt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function Tfe(t){var e={};e.iauthor=t.read_shift(4);var r=af(t);return e.rfx=r.s,e.ref=Er(r.s),t.l+=16,e}function Pfe(t,e){return e==null&&(e=_t(36)),e.write_shift(4,t[1].iauthor),fm(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Rfe=xi;function Dfe(t){return Sa(t.slice(0,54))}function Lfe(t,e){var r=[],n=[],s={},i=!1;return Dd(t,function(l,c,d){switch(d){case 632:n.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function Ufe(t){var e=ro(),r=[];return Tt(e,628),Tt(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Tt(e,632,Dfe(s.a)))})}),Tt(e,631),Tt(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:Ns(n[0]),e:Ns(n[0])};Tt(e,635,Pfe([i,s])),s.t&&s.t.length>0&&Tt(e,637,ide(s)),Tt(e,636),delete s.iauthor})}),Tt(e,634),Tt(e,629),e.end()}var Ofe="application/vnd.ms-office.vbaProject";function Mfe(t){var e=wr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");wr.utils.cfb_add(e,s,t.FileIndex[n].content)}}),wr.write(e)}function Qfe(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&wr.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var RQ=["xlsb","xlsm","xlam","biff8","xla"];function Vfe(){return{"!type":"dialog"}}function Hfe(){return{"!type":"dialog"}}function Kfe(){return{"!type":"macro"}}function qfe(){return{"!type":"macro"}}var C0=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,A=o.length>0?parseInt(o,10)|0:0;return l?A+=e.c:--A,c?d+=e.r:--d,s+(l?"":"$")+ws(A)+(c?"":"$")+zs(d)}return function(s,i){return e=i,s.replace(t,r)}}(),TI=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,PI=function(){return function(e,r){return e.replace(TI,function(n,s,i,o,l,c){var d=yI(o)-(i?0:r.c),A=vI(c)-(l?0:r.r),u=A==0?"":l?A+1:"["+A+"]",f=d==0?"":i?d+1:"["+d+"]";return s+"R"+u+"C"+f})}}();function DQ(t,e){return t.replace(TI,function(r,n,s,i,o,l){return n+(s=="$"?s+i:ws(yI(i)+e.c))+(o=="$"?o+l:zs(vI(l)+e.r))})}function Gfe(t,e,r){var n=no(e),s=n.s,i=Ns(r),o={r:i.r-s.r,c:i.c-s.c};return DQ(t,o)}function $fe(t){return t.length!=1}function t3(t){return t.replace(/_xlfn\./g,"")}function Xs(t){t.l+=1}function hu(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function LQ(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return UQ(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),o=hu(t),l=hu(t);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function UQ(t){var e=hu(t),r=hu(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function zfe(t,e,r){if(r.biff<8)return UQ(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=hu(t),o=hu(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function OQ(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return Wfe(t);var n=t.read_shift(r&&r.biff==12?4:2),s=hu(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function Wfe(t){var e=hu(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function Jfe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Xfe(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Yfe(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:l}}function Yfe(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function Zfe(t,e,r){var n=(t[t.l++]&96)>>5,s=LQ(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function e0e(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var o=LQ(t,i,r);return[n,s,o]}function t0e(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function r0e(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function n0e(t,e,r){var n=(t[t.l++]&96)>>5,s=zfe(t,e-1,r);return[n,s]}function s0e(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function r3(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function a0e(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function i0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function o0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function l0e(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function c0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function MQ(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function d0e(t){return t.read_shift(2),MQ(t)}function A0e(t){return t.read_shift(2),MQ(t)}function u0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=OQ(t,0,r);return[n,s]}function h0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=Xfe(t,0,r);return[n,s]}function f0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=OQ(t,0,r);return[n,s,i]}function m0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[xme[s],HQ[s],n]}function p0e(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:g0e(t);return[s,(i[0]===0?HQ:gme)[i[1]]]}function g0e(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function x0e(t,e,r){t.l+=r&&r.biff==2?3:4}function v0e(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function y0e(t){return t.l++,Ld[t.read_shift(1)]}function b0e(t){return t.l++,t.read_shift(2)}function w0e(t){return t.l++,t.read_shift(1)!==0}function N0e(t){return t.l++,gi(t)}function C0e(t,e,r){return t.l++,qx(t,e-1,r)}function _0e(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Vs(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Ld[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=gi(t);break;case 2:r[1]=of(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function E0e(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?af:Y2)(t));return s}function B0e(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var l=0;l!=s;++l)o[i][l]=_0e(t,r.biff);return o}function S0e(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function I0e(t,e,r){if(r.biff==5)return j0e(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function j0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function k0e(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function F0e(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function T0e(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function P0e(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var R0e=yi,D0e=yi,L0e=yi;function $x(t,e,r){return t.l+=2,[Jfe(t)]}function RI(t){return t.l+=6,[]}var U0e=$x,O0e=RI,M0e=RI,Q0e=$x;function QQ(t){return t.l+=2,[ea(t),t.read_shift(2)&1]}var V0e=$x,H0e=QQ,K0e=RI,q0e=$x,G0e=$x,$0e=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function z0e(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),o=$0e[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:s,C:i}}function W0e(t){return t.l+=2,[t.read_shift(4)]}function J0e(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function X0e(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Y0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Z0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function eme(t){return t.l+=4,[0,0]}var n3={1:{n:"PtgExp",f:v0e},2:{n:"PtgTbl",f:L0e},3:{n:"PtgAdd",f:Xs},4:{n:"PtgSub",f:Xs},5:{n:"PtgMul",f:Xs},6:{n:"PtgDiv",f:Xs},7:{n:"PtgPower",f:Xs},8:{n:"PtgConcat",f:Xs},9:{n:"PtgLt",f:Xs},10:{n:"PtgLe",f:Xs},11:{n:"PtgEq",f:Xs},12:{n:"PtgGe",f:Xs},13:{n:"PtgGt",f:Xs},14:{n:"PtgNe",f:Xs},15:{n:"PtgIsect",f:Xs},16:{n:"PtgUnion",f:Xs},17:{n:"PtgRange",f:Xs},18:{n:"PtgUplus",f:Xs},19:{n:"PtgUminus",f:Xs},20:{n:"PtgPercent",f:Xs},21:{n:"PtgParen",f:Xs},22:{n:"PtgMissArg",f:Xs},23:{n:"PtgStr",f:C0e},26:{n:"PtgSheet",f:J0e},27:{n:"PtgEndSheet",f:X0e},28:{n:"PtgErr",f:y0e},29:{n:"PtgBool",f:w0e},30:{n:"PtgInt",f:b0e},31:{n:"PtgNum",f:N0e},32:{n:"PtgArray",f:s0e},33:{n:"PtgFunc",f:m0e},34:{n:"PtgFuncVar",f:p0e},35:{n:"PtgName",f:S0e},36:{n:"PtgRef",f:u0e},37:{n:"PtgArea",f:Zfe},38:{n:"PtgMemArea",f:k0e},39:{n:"PtgMemErr",f:R0e},40:{n:"PtgMemNoMem",f:D0e},41:{n:"PtgMemFunc",f:F0e},42:{n:"PtgRefErr",f:T0e},43:{n:"PtgAreaErr",f:t0e},44:{n:"PtgRefN",f:h0e},45:{n:"PtgAreaN",f:n0e},46:{n:"PtgMemAreaN",f:Y0e},47:{n:"PtgMemNoMemN",f:Z0e},57:{n:"PtgNameX",f:I0e},58:{n:"PtgRef3d",f:f0e},59:{n:"PtgArea3d",f:e0e},60:{n:"PtgRefErr3d",f:P0e},61:{n:"PtgAreaErr3d",f:r0e},255:{}},tme={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},rme={1:{n:"PtgElfLel",f:QQ},2:{n:"PtgElfRw",f:q0e},3:{n:"PtgElfCol",f:U0e},6:{n:"PtgElfRwV",f:G0e},7:{n:"PtgElfColV",f:Q0e},10:{n:"PtgElfRadical",f:V0e},11:{n:"PtgElfRadicalS",f:K0e},13:{n:"PtgElfColS",f:O0e},15:{n:"PtgElfColSV",f:M0e},16:{n:"PtgElfRadicalLel",f:H0e},25:{n:"PtgList",f:z0e},29:{n:"PtgSxName",f:W0e},255:{}},nme={0:{n:"PtgAttrNoop",f:eme},1:{n:"PtgAttrSemi",f:c0e},2:{n:"PtgAttrIf",f:o0e},4:{n:"PtgAttrChoose",f:a0e},8:{n:"PtgAttrGoto",f:i0e},16:{n:"PtgAttrSum",f:x0e},32:{n:"PtgAttrBaxcel",f:r3},33:{n:"PtgAttrBaxcel",f:r3},64:{n:"PtgAttrSpace",f:d0e},65:{n:"PtgAttrSpaceSemi",f:A0e},128:{n:"PtgAttrIfError",f:l0e},255:{}};function zx(t,e,r,n){if(n.biff<8)return yi(t,e);for(var s=t.l+e,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=B0e(t,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=E0e(t,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=s-t.l,e!==0&&i.push(yi(t,e)),i}function Wx(t,e,r){for(var n=t.l+e,s,i,o=[];n!=t.l;)e=n-t.l,i=t[t.l],s=n3[i]||n3[tme[i]],(i===24||i===25)&&(s=(i===24?rme:nme)[t[t.l+1]]),!s||!s.f?yi(t,e):o.push([s.n,s.f(t,e,r)]);return o}function sme(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var ame={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ime(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function VQ(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function s3(t,e,r){var n=VQ(t,e,r);return n=="#REF"?n:ime(n,r)}function fi(t,e,r,n,s){var i=s&&s.biff||8,o={s:{c:0,r:0}},l=[],c,d,A,u=0,f=0,h,m="";if(!t[0]||!t[0][0])return"";for(var p=-1,g="",x=0,b=t[0].length;x<b;++x){var w=t[0][x];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),p>=0){switch(t[0][p][1][0]){case 0:g=Fs(" ",t[0][p][1][1]);break;case 1:g=Fs("\r",t[0][p][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}d=d+g,p=-1}l.push(d+ame[w[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":A=ag(w[1][1],o,s),l.push(ig(A,i));break;case"PtgRefN":A=r?ag(w[1][1],r,s):w[1][1],l.push(ig(A,i));break;case"PtgRef3d":u=w[1][1],A=ag(w[1][2],o,s),m=s3(n,u,s),l.push(m+"!"+ig(A,i));break;case"PtgFunc":case"PtgFuncVar":var k=w[1][0],O=w[1][1];k||(k=0),k&=127;var L=k==0?[]:l.slice(-k);l.length-=k,O==="User"&&(O=L.shift()),l.push(O+"("+L.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":h=TP(w[1][1],r?{s:r}:o,s),l.push(rC(h,s));break;case"PtgArea":h=TP(w[1][1],o,s),l.push(rC(h,s));break;case"PtgArea3d":u=w[1][1],h=w[1][2],m=s3(n,u,s),l.push(m+"!"+rC(h,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=w[1][2];var E=(n.names||[])[f-1]||(n[0]||[])[f],B=E?E.Name:"SH33TJSNAME"+String(f);B&&B.slice(0,6)=="_xlfn."&&!s.xlfn&&(B=B.slice(6)),l.push(B);break;case"PtgNameX":var S=w[1][1];f=w[1][2];var U;if(s.biff<=5)S<0&&(S=-S),n[S]&&(U=n[S][f]);else{var _="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][f]&&n[S][f].itab>0&&(_=n.SheetNames[n[S][f].itab-1]+"!"):_=n.SheetNames[f-1]+"!"),n[S]&&n[S][f])_+=n[S][f].Name;else if(n[0]&&n[0][f])_+=n[0][f].Name;else{var F=(VQ(n,S,s)||"").split(";;");F[f-1]?_=F[f-1]:_+="SH33TJSERRX"}l.push(_);break}U||(U={Name:"SH33TJSERRY"}),l.push(U.Name);break;case"PtgParen":var D="(",X=")";if(p>=0){switch(g="",t[0][p][1][0]){case 2:D=Fs(" ",t[0][p][1][1])+D;break;case 3:D=Fs("\r",t[0][p][1][1])+D;break;case 4:X=Fs(" ",t[0][p][1][1])+X;break;case 5:X=Fs("\r",t[0][p][1][1])+X;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}l.push(D+l.pop()+X);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":A={c:w[1][1],r:w[1][0]};var ge={c:r.c,r:r.r};if(n.sharedf[Er(A)]){var ae=n.sharedf[Er(A)];l.push(fi(ae,o,ge,n,s))}else{var fe=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(A.c<d[0].s.c||A.c>d[0].e.c)&&!(A.r<d[0].s.r||A.r>d[0].e.r)){l.push(fi(d[1],o,ge,n,s)),fe=!0;break}fe||l.push(w[1])}break;case"PtgArray":l.push("{"+sme(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var me=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&p>=0&&me.indexOf(t[0][x][0])==-1){w=t[0][p];var Z=!0;switch(w[1][0]){case 4:Z=!1;case 0:g=Fs(" ",w[1][1]);break;case 5:Z=!1;case 1:g=Fs("\r",w[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((Z?g:"")+l.pop()+(Z?"":g)),p=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function ome(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,o=t.read_shift(s);if(o==65535)return[[],yi(t,e-2)];var l=Wx(t,o,r);return e!==o+s&&(i=zx(t,e-o-s,l,r)),t.l=n,[l,i]}function lme(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,o=t.read_shift(s);if(o==65535)return[[],yi(t,e-2)];var l=Wx(t,o,r);return e!==o+s&&(i=zx(t,e-o-s,l,r)),t.l=n,[l,i]}function cme(t,e,r,n){var s=t.l+e,i=Wx(t,n,r),o;return s!==t.l&&(o=zx(t,s-t.l,i,r)),[i,o]}function dme(t,e,r){var n=t.l+e,s,i=t.read_shift(2),o=Wx(t,i,r);return i==65535?[[],yi(t,e-2)]:(e!==i+2&&(s=zx(t,n-i-2,o,r)),[o,s])}function Ame(t){var e;if(Ad(t,t.l+6)!==65535)return[gi(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function ume(t){if(t==null){var e=_t(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Oh(t);return Oh(0)}function oC(t,e,r){var n=t.l+e,s=Rc(t);r.biff==2&&++t.l;var i=Ame(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var l=lme(t,n-t.l,r);return{cell:s,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function hme(t,e,r,n,s){var i=Qh(e,r,s),o=ume(t.v),l=_t(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=_t(t.bf.length),A=0;A<t.bf.length;++A)d[A]=t.bf[A];var u=Ba([i,o,l,d]);return u}function Z2(t,e,r){var n=t.read_shift(4),s=Wx(t,n,r),i=t.read_shift(4),o=i>0?zx(t,i,s,r):null;return[s,o]}var fme=Z2,ew=Z2,mme=Z2,pme=Z2,gme={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},HQ={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},xme={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function a3(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function vme(t){var e="of:="+t.replace(TI,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function lC(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function yme(t){return t.replace(/\./,"!")}var lg={},_0={},cg=typeof Map<"u";function DI(t,e,r){var n=0,s=t.length;if(r){if(cg?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=cg?r.get(e):r[e];n<i.length;++n)if(t[i[n]].t===e)return t.Count++,i[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(cg?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function tw(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(pi=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=cx(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Ub(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function yh(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function _u(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,i=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){yd(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=i;++s)if(t[s].numFmtId===n)return s;return t[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function KQ(t,e,r,n,s,i){try{n.cellNF&&(t.z=_r[e])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=ns(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(_r[e]==null&&yd(gce[e]||"General",e),t.t==="e")t.w=t.w||Ld[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=rx(t.v);else if(t.t==="d"){var o=xa(t.v);(o|0)===o?t.w=o.toString(10):t.w=rx(o)}else{if(t.v===void 0)return"";t.w=Lh(t.v,_0)}else t.t==="d"?t.w=xl(e,xa(t.v),_0):t.w=xl(e,t.v,_0)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Lb(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Lb(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&i.Fills)throw l}}}function bme(t,e,r){if(t&&t["!ref"]){var n=hn(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function wme(t,e){var r=hn(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Or(r))}var Nme=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Cme=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,_me=/<(?:\w:)?hyperlink [^>]*>/mg,Eme=/"(\w*:\w*)"/,Bme=/<(?:\w:)?col\b[^>]*[\/]?>/g,Sme=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Ime=/<(?:\w:)?pageMargins[^>]*\/>/g,qQ=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,jme=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,kme=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Fme(t,e,r,n,s,i,o){if(!t)return t;n||(n={"!id":{}});var l=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",A="",u=t.match(Cme);u?(d=t.slice(0,u.index),A=t.slice(u.index+u[0].length)):d=A=t;var f=d.match(qQ);f?LI(f[0],l,s,r):(f=d.match(jme))&&Pme(f[0],f[1]||"",l,s,r);var h=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=d.slice(h,h+50).match(Eme);m&&wme(l,m[1])}var p=d.match(kme);p&&p[1]&&$me(p[1],s);var g=[];if(e.cellStyles){var x=d.match(Bme);x&&Vme(g,x)}u&&Jme(u[1],l,e,c,i,o);var b=A.match(Sme);b&&(l["!autofilter"]=Kme(b[0]));var w=[],k=A.match(Nme);if(k)for(h=0;h!=k.length;++h)w[h]=hn(k[h].slice(k[h].indexOf('"')+1));var O=A.match(_me);O&&Ome(l,O,n);var L=A.match(Ime);if(L&&(l["!margins"]=Mme(Ir(L[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Or(c)),e.sheetRows>0&&l["!ref"]){var E=hn(l["!ref"]);e.sheetRows<=+E.e.r&&(E.e.r=e.sheetRows-1,E.e.r>c.e.r&&(E.e.r=c.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>c.e.c&&(E.e.c=c.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Or(E))}return g.length>0&&(l["!cols"]=g),w.length>0&&(l["!merges"]=w),l}function Tme(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Or(t[r])+'"/>';return e+"</mergeCells>"}function LI(t,e,r,n){var s=Ir(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=An(Rn(s.codeName)))}function Pme(t,e,r,n,s){LI(t.slice(0,t.indexOf(">")),r,n,s)}function Rme(t,e,r,n,s){var i=!1,o={},l=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=wc(jn(c))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),l=(l||"")+Jt("outlinePr",null,d)}!i&&!l||(s[s.length]=Jt("sheetPr",l,o))}var Dme=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Lme=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Ume(t){var e={sheet:1};return Dme.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),Lme.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=jI(t.password).toString(16).toUpperCase()),Jt("sheetProtection",null,e)}function Ome(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=Ir(Rn(e[s]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+An(i.location))):(i.Target="#"+An(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=hn(i.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var A=Er({c:d,r:c});n?(t[c]||(t[c]=[]),t[c][d]||(t[c][d]={t:"z",v:void 0}),t[c][d].l=i):(t[A]||(t[A]={t:"z",v:void 0}),t[A].l=i)}}}function Mme(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function Qme(t){return yh(t),Jt("pageMargins",null,t)}function Vme(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Ir(e[n],!0);s.hidden&&(s.hidden=es(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,kI(s.width)),uu(s);i<=o;)t[i++]=ss(s)}}function Hme(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=Jt("col",null,tw(s,n)));return r[r.length]="</cols>",r.join("")}function Kme(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function qme(t,e,r,n){var s=typeof t.ref=="string"?t.ref:Or(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=no(s);o.s.r==o.e.r&&(o.e.r=no(e["!ref"]).e.r,s=Or(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Jt("autoFilter",null,{ref:s})}var Gme=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function $me(t,e){e.Views||(e.Views=[{}]),(t.match(Gme)||[]).forEach(function(r,n){var s=Ir(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),es(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function zme(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Jt("sheetViews",Jt("sheetView",null,s),{})}function Wme(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",i=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=Ld[t.v];break;case"d":n&&n.cellDates?s=ns(t.v,-1).toISOString():(t=ss(t),t.t="n",s=""+(t.v=xa(ns(t.v)))),typeof t.z>"u"&&(t.z=_r[14]);break;default:s=t.v;break}var l=za("v",jn(s)),c={r:e},d=_u(n.cellXfs,t,n);switch(d!==0&&(c.s=d),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=za("v",""+DI(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=i&&(t.t=i,t.v=o),typeof t.f=="string"&&t.f){var A=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=Jt("f",jn(t.f),A)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),Jt("c",l,c)}var Jme=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=nx("v"),o=nx("f");return function(c,d,A,u,f,h){for(var m=0,p="",g=[],x=[],b=0,w=0,k=0,O="",L,E,B=0,S=0,U,_,F=0,D=0,X=Array.isArray(h.CellXf),ge,ae=[],fe=[],me=Array.isArray(d),Z=[],ye={},Ie=!1,I=!!A.sheetStubs,j=c.split(e),Q=0,T=j.length;Q!=T;++Q){p=j[Q].trim();var R=p.length;if(R!==0){var K=0;e:for(m=0;m<R;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(A&&A.cellStyles){if(E=Ir(p.slice(K,m),!0),B=E.r!=null?parseInt(E.r,10):B+1,S=-1,A.sheetRows&&A.sheetRows<B)continue;ye={},Ie=!1,E.ht&&(Ie=!0,ye.hpt=parseFloat(E.ht),ye.hpx=$0(ye.hpt)),E.hidden=="1"&&(Ie=!0,ye.hidden=!0),E.outlineLevel!=null&&(Ie=!0,ye.level=+E.outlineLevel),Ie&&(Z[B-1]=ye)}break;case"<":K=m;break}if(K>=m)break;if(E=Ir(p.slice(K,m),!0),B=E.r!=null?parseInt(E.r,10):B+1,S=-1,!(A.sheetRows&&A.sheetRows<B)){u.s.r>B-1&&(u.s.r=B-1),u.e.r<B-1&&(u.e.r=B-1),A&&A.cellStyles&&(ye={},Ie=!1,E.ht&&(Ie=!0,ye.hpt=parseFloat(E.ht),ye.hpx=$0(ye.hpt)),E.hidden=="1"&&(Ie=!0,ye.hidden=!0),E.outlineLevel!=null&&(Ie=!0,ye.level=+E.outlineLevel),Ie&&(Z[B-1]=ye)),g=p.slice(m).split(t);for(var M=0;M!=g.length&&g[M].trim().charAt(0)=="<";++M);for(g=g.slice(M),m=0;m!=g.length;++m)if(p=g[m].trim(),p.length!==0){if(x=p.match(r),b=m,w=0,k=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,x!=null&&x.length===2){for(b=0,O=x[1],w=0;w!=O.length&&!((k=O.charCodeAt(w)-64)<1||k>26);++w)b=26*b+k;--b,S=b}else++S;for(w=0;w!=p.length&&p.charCodeAt(w)!==62;++w);if(++w,E=Ir(p.slice(0,w),!0),E.r||(E.r=Er({r:B-1,c:S})),O=p.slice(w),L={t:""},(x=O.match(i))!=null&&x[1]!==""&&(L.v=An(x[1])),A.cellFormula){if((x=O.match(o))!=null&&x[1]!==""){if(L.f=An(Rn(x[1])).replace(/\r\n/g,`
`),A.xlfn||(L.f=t3(L.f)),x[0].indexOf('t="array"')>-1)L.F=(O.match(s)||[])[1],L.F.indexOf(":")>-1&&ae.push([hn(L.F),L.F]);else if(x[0].indexOf('t="shared"')>-1){_=Ir(x[0]);var re=An(Rn(x[1]));A.xlfn||(re=t3(re)),fe[parseInt(_.si,10)]=[_,re,E.r]}}else(x=O.match(/<f[^>]*\/>/))&&(_=Ir(x[0]),fe[_.si]&&(L.f=Gfe(fe[_.si][1],fe[_.si][2],E.r)));var de=Ns(E.r);for(w=0;w<ae.length;++w)de.r>=ae[w][0].s.r&&de.r<=ae[w][0].e.r&&de.c>=ae[w][0].s.c&&de.c<=ae[w][0].e.c&&(L.F=ae[w][1])}if(E.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(I)L.t="z";else continue;else L.t=E.t||"n";switch(u.s.c>S&&(u.s.c=S),u.e.c<S&&(u.e.c=S),L.t){case"n":if(L.v==""||L.v==null){if(!I)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!I)continue;L.t="z"}else U=lg[parseInt(L.v,10)],L.v=U.t,L.r=U.r,A.cellHTML&&(L.h=U.h);break;case"str":L.t="s",L.v=L.v!=null?Rn(L.v):"",A.cellHTML&&(L.h=mI(L.v));break;case"inlineStr":x=O.match(n),L.t="s",x!=null&&(U=II(x[1]))?(L.v=U.t,A.cellHTML&&(L.h=U.h)):L.v="";break;case"b":L.v=es(L.v);break;case"d":A.cellDates?L.v=ns(L.v,1):(L.v=xa(ns(L.v,1)),L.t="n");break;case"e":(!A||A.cellText!==!1)&&(L.w=L.v),L.v=$8[L.v];break}if(F=D=0,ge=null,X&&E.s!==void 0&&(ge=h.CellXf[E.s],ge!=null&&(ge.numFmtId!=null&&(F=ge.numFmtId),A.cellStyles&&ge.fillId!=null&&(D=ge.fillId))),KQ(L,F,D,A,f,h),A.cellDates&&X&&L.t=="n"&&Am(_r[F])&&(L.t="d",L.v=X2(L.v)),E.cm&&A.xlmeta){var le=(A.xlmeta.Cell||[])[+E.cm-1];le&&le.type=="XLDAPR"&&(L.D=!0)}if(me){var q=Ns(E.r);d[q.r]||(d[q.r]=[]),d[q.r][q.c]=L}else d[E.r]=L}}}}Z.length>0&&(d["!rows"]=Z)}}();function Xme(t,e,r,n){var s=[],i=[],o=hn(t["!ref"]),l="",c,d="",A=[],u=0,f=0,h=t["!rows"],m=Array.isArray(t),p={r:d},g,x=-1;for(f=o.s.c;f<=o.e.c;++f)A[f]=ws(f);for(u=o.s.r;u<=o.e.r;++u){for(i=[],d=zs(u),f=o.s.c;f<=o.e.c;++f){c=A[f]+d;var b=m?(t[u]||[])[f]:t[c];b!==void 0&&(l=Wme(b,c,t,e))!=null&&i.push(l)}(i.length>0||h&&h[u])&&(p={r:d},h&&h[u]&&(g=h[u],g.hidden&&(p.hidden=1),x=-1,g.hpx?x=dx(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(p.ht=x,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),s[s.length]=Jt("row",i.join(""),p))}if(h)for(;u<h.length;++u)h&&h[u]&&(p={r:u+1},g=h[u],g.hidden&&(p.hidden=1),x=-1,g.hpx?x=dx(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(p.ht=x,p.customHeight=1),g.level&&(p.outlineLevel=g.level),s[s.length]=Jt("row","",p));return s.join("")}function GQ(t,e,r,n){var s=[Js,Jt("worksheet",null,{xmlns:tf[0],"xmlns:r":fa.r})],i=r.SheetNames[t],o=0,l="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",A=hn(d);if(A.e.c>16383||A.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");A.e.c=Math.min(A.e.c,16383),A.e.r=Math.min(A.e.c,1048575),d=Or(A)}n||(n={}),c["!comments"]=[];var u=[];Rme(c,r,t,e,s),s[s.length]=Jt("dimension",null,{ref:d}),s[s.length]=zme(c,e,t,r),e.sheetFormat&&(s[s.length]=Jt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=Hme(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=Xme(c,e),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=Ume(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=qme(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=Tme(c["!merges"]));var f=-1,h,m=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=Bn(n,-1,jn(p[1].Target).replace(/#.*$/,""),$r.HLINK),h["r:id"]="rId"+m),(f=p[1].Target.indexOf("#"))>-1&&(h.location=jn(p[1].Target.slice(f+1))),p[1].Tooltip&&(h.tooltip=jn(p[1].Tooltip)),s[s.length]=Jt("hyperlink",null,h))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=Qme(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=za("ignoredErrors",Jt("ignoredError",null,{numberStoredAsText:1,sqref:d}))),u.length>0&&(m=Bn(n,-1,"../drawings/drawing"+(t+1)+".xml",$r.DRAW),s[s.length]=Jt("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=u),c["!comments"].length>0&&(m=Bn(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",$r.VML),s[s.length]=Jt("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Yme(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function Zme(t,e,r){var n=_t(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var i=320;s.hpx?i=dx(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var d={r:t,c:0},A=0;A<16;++A)if(!(e.s.c>A+1<<10||e.e.c<A<<10)){for(var u=-1,f=-1,h=A<<10;h<A+1<<10;++h){d.c=h;var m=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Er(d)];m&&(u<0&&(u=h),f=h)}u<0||(++l,n.write_shift(4,u),n.write_shift(4,f))}var p=n.l;return n.l=c,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function epe(t,e,r,n){var s=Zme(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&Tt(t,0,s)}var tpe=af,rpe=fm;function npe(){}function spe(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=ode(t),r}function ape(t,e,r){r==null&&(r=_t(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return Pb({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),V8(t,r),r.slice(0,r.l)}function ipe(t){var e=yl(t);return[e]}function ope(t,e,r){return r==null&&(r=_t(8)),rf(e,r)}function lpe(t){var e=nf(t);return[e]}function cpe(t,e,r){return r==null&&(r=_t(4)),sf(e,r)}function dpe(t){var e=yl(t),r=t.read_shift(1);return[e,r,"b"]}function Ape(t,e,r){return r==null&&(r=_t(9)),rf(e,r),r.write_shift(1,t.v?1:0),r}function upe(t){var e=nf(t),r=t.read_shift(1);return[e,r,"b"]}function hpe(t,e,r){return r==null&&(r=_t(5)),sf(e,r),r.write_shift(1,t.v?1:0),r}function fpe(t){var e=yl(t),r=t.read_shift(1);return[e,r,"e"]}function mpe(t,e,r){return r==null&&(r=_t(9)),rf(e,r),r.write_shift(1,t.v),r}function ppe(t){var e=nf(t),r=t.read_shift(1);return[e,r,"e"]}function gpe(t,e,r){return r==null&&(r=_t(8)),sf(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function xpe(t){var e=yl(t),r=t.read_shift(4);return[e,r,"s"]}function vpe(t,e,r){return r==null&&(r=_t(12)),rf(e,r),r.write_shift(4,e.v),r}function ype(t){var e=nf(t),r=t.read_shift(4);return[e,r,"s"]}function bpe(t,e,r){return r==null&&(r=_t(8)),sf(e,r),r.write_shift(4,e.v),r}function wpe(t){var e=yl(t),r=gi(t);return[e,r,"n"]}function Npe(t,e,r){return r==null&&(r=_t(16)),rf(e,r),Oh(t.v,r),r}function $Q(t){var e=nf(t),r=gi(t);return[e,r,"n"]}function Cpe(t,e,r){return r==null&&(r=_t(12)),sf(e,r),Oh(t.v,r),r}function _pe(t){var e=yl(t),r=CI(t);return[e,r,"n"]}function Epe(t,e,r){return r==null&&(r=_t(12)),rf(e,r),H8(t.v,r),r}function Bpe(t){var e=nf(t),r=CI(t);return[e,r,"n"]}function Spe(t,e,r){return r==null&&(r=_t(8)),sf(e,r),H8(t.v,r),r}function Ipe(t){var e=yl(t),r=bI(t);return[e,r,"is"]}function jpe(t){var e=yl(t),r=xi(t);return[e,r,"str"]}function kpe(t,e,r){return r==null&&(r=_t(12+4*t.v.length)),rf(e,r),Sa(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Fpe(t){var e=nf(t),r=xi(t);return[e,r,"str"]}function Tpe(t,e,r){return r==null&&(r=_t(8+4*t.v.length)),sf(e,r),Sa(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Ppe(t,e,r){var n=t.l+e,s=yl(t);s.r=r["!row"];var i=t.read_shift(1),o=[s,i,"b"];if(r.cellFormula){t.l+=2;var l=ew(t,n-t.l,r);o[3]=fi(l,null,s,r.supbooks,r)}else t.l=n;return o}function Rpe(t,e,r){var n=t.l+e,s=yl(t);s.r=r["!row"];var i=t.read_shift(1),o=[s,i,"e"];if(r.cellFormula){t.l+=2;var l=ew(t,n-t.l,r);o[3]=fi(l,null,s,r.supbooks,r)}else t.l=n;return o}function Dpe(t,e,r){var n=t.l+e,s=yl(t);s.r=r["!row"];var i=gi(t),o=[s,i,"n"];if(r.cellFormula){t.l+=2;var l=ew(t,n-t.l,r);o[3]=fi(l,null,s,r.supbooks,r)}else t.l=n;return o}function Lpe(t,e,r){var n=t.l+e,s=yl(t);s.r=r["!row"];var i=xi(t),o=[s,i,"str"];if(r.cellFormula){t.l+=2;var l=ew(t,n-t.l,r);o[3]=fi(l,null,s,r.supbooks,r)}else t.l=n;return o}var Upe=af,Ope=fm;function Mpe(t,e){return e==null&&(e=_t(4)),e.write_shift(4,t),e}function Qpe(t,e){var r=t.l+e,n=af(t),s=wI(t),i=xi(t),o=xi(t),l=xi(t);t.l=r;var c={rfx:n,relId:s,loc:i,display:l};return o&&(c.Tooltip=o),c}function Vpe(t,e){var r=_t(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));fm({s:Ns(t[0]),e:Ns(t[0])},r),NI("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return Sa(s||"",r),Sa(t[1].Tooltip||"",r),Sa("",r),r.slice(0,r.l)}function Hpe(){}function Kpe(t,e,r){var n=t.l+e,s=K8(t),i=t.read_shift(1),o=[s];if(o[2]=i,r.cellFormula){var l=fme(t,n-t.l,r);o[1]=l}else t.l=n;return o}function qpe(t,e,r){var n=t.l+e,s=af(t),i=[s];if(r.cellFormula){var o=pme(t,n-t.l,r);i[1]=o,t.l=n}else t.l=n;return i}function Gpe(t,e,r){r==null&&(r=_t(18));var n=tw(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var zQ=["left","right","top","bottom","header","footer"];function $pe(t){var e={};return zQ.forEach(function(r){e[r]=gi(t)}),e}function zpe(t,e){return e==null&&(e=_t(6*8)),yh(t),zQ.forEach(function(r){Oh(t[r],e)}),e}function Wpe(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Jpe(t,e,r){r==null&&(r=_t(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Xpe(t){var e=_t(24);return e.write_shift(4,4),e.write_shift(4,1),fm(t,e),e}function Ype(t,e){return e==null&&(e=_t(16*4+2)),e.write_shift(2,t.password?jI(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Zpe(){}function ege(){}function tge(t,e,r,n,s,i,o){if(!t)return t;var l=e||{};n||(n={"!id":{}});var c=l.dense?[]:{},d,A={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=!1,f=!1,h,m,p,g,x,b,w,k,O,L=[];l.biff=12,l["!row"]=0;var E=0,B=!1,S=[],U={},_=l.supbooks||s.supbooks||[[]];if(_.sharedf=U,_.arrayf=S,_.SheetNames=s.SheetNames||s.Sheets.map(function(me){return me.name}),!l.supbooks&&(l.supbooks=_,s.Names))for(var F=0;F<s.Names.length;++F)_[0][F+1]=s.Names[F];var D=[],X=[],ge=!1;Ax[16]={n:"BrtShortReal",f:$Q};var ae;if(Dd(t,function(Z,ye,Ie){if(!f)switch(Ie){case 148:d=Z;break;case 0:h=Z,l.sheetRows&&l.sheetRows<=h.r&&(f=!0),k=zs(g=h.r),l["!row"]=h.r,(Z.hidden||Z.hpt||Z.level!=null)&&(Z.hpt&&(Z.hpx=$0(Z.hpt)),X[Z.r]=Z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:Z[2]},Z[2]){case"n":m.v=Z[1];break;case"s":w=lg[Z[1]],m.v=w.t,m.r=w.r;break;case"b":m.v=!!Z[1];break;case"e":m.v=Z[1],l.cellText!==!1&&(m.w=Ld[m.v]);break;case"str":m.t="s",m.v=Z[1];break;case"is":m.t="s",m.v=Z[1].t;break}if((p=o.CellXf[Z[0].iStyleRef])&&KQ(m,p.numFmtId,null,l,i,o),x=Z[0].c==-1?x+1:Z[0].c,l.dense?(c[g]||(c[g]=[]),c[g][x]=m):c[ws(x)+k]=m,l.cellFormula){for(B=!1,E=0;E<S.length;++E){var I=S[E];h.r>=I[0].s.r&&h.r<=I[0].e.r&&x>=I[0].s.c&&x<=I[0].e.c&&(m.F=Or(I[0]),B=!0)}!B&&Z.length>3&&(m.f=Z[3])}if(A.s.r>h.r&&(A.s.r=h.r),A.s.c>x&&(A.s.c=x),A.e.r<h.r&&(A.e.r=h.r),A.e.c<x&&(A.e.c=x),l.cellDates&&p&&m.t=="n"&&Am(_r[p.numFmtId])){var j=oh(m.v);j&&(m.t="d",m.v=new Date(j.y,j.m-1,j.d,j.H,j.M,j.S,j.u))}ae&&(ae.type=="XLDAPR"&&(m.D=!0),ae=void 0);break;case 1:case 12:if(!l.sheetStubs||u)break;m={t:"z",v:void 0},x=Z[0].c==-1?x+1:Z[0].c,l.dense?(c[g]||(c[g]=[]),c[g][x]=m):c[ws(x)+k]=m,A.s.r>h.r&&(A.s.r=h.r),A.s.c>x&&(A.s.c=x),A.e.r<h.r&&(A.e.r=h.r),A.e.c<x&&(A.e.c=x),ae&&(ae.type=="XLDAPR"&&(m.D=!0),ae=void 0);break;case 176:L.push(Z);break;case 49:ae=((l.xlmeta||{}).Cell||[])[Z-1];break;case 494:var Q=n["!id"][Z.relId];for(Q?(Z.Target=Q.Target,Z.loc&&(Z.Target+="#"+Z.loc),Z.Rel=Q):Z.relId==""&&(Z.Target="#"+Z.loc),g=Z.rfx.s.r;g<=Z.rfx.e.r;++g)for(x=Z.rfx.s.c;x<=Z.rfx.e.c;++x)l.dense?(c[g]||(c[g]=[]),c[g][x]||(c[g][x]={t:"z",v:void 0}),c[g][x].l=Z):(b=Er({c:x,r:g}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=Z);break;case 426:if(!l.cellFormula)break;S.push(Z),O=l.dense?c[g][x]:c[ws(x)+k],O.f=fi(Z[1],A,{r:h.r,c:x},_,l),O.F=Or(Z[0]);break;case 427:if(!l.cellFormula)break;U[Er(Z[0].s)]=Z[1],O=l.dense?c[g][x]:c[ws(x)+k],O.f=fi(Z[1],A,{r:h.r,c:x},_,l);break;case 60:if(!l.cellStyles)break;for(;Z.e>=Z.s;)D[Z.e--]={width:Z.w/256,hidden:!!(Z.flags&1),level:Z.level},ge||(ge=!0,kI(Z.w/256)),uu(D[Z.e+1]);break;case 161:c["!autofilter"]={ref:Or(Z)};break;case 476:c["!margins"]=Z;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),Z.name&&(s.Sheets[r].CodeName=Z.name),(Z.above||Z.left)&&(c["!outline"]={above:Z.above,left:Z.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),Z.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:u=!0;break;case 38:u=!1;break;default:if(!ye.T){if(!u||l.WTF)throw new Error("Unexpected record 0x"+Ie.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(A.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=Or(d||A)),l.sheetRows&&c["!ref"]){var fe=hn(c["!ref"]);l.sheetRows<=+fe.e.r&&(fe.e.r=l.sheetRows-1,fe.e.r>A.e.r&&(fe.e.r=A.e.r),fe.e.r<fe.s.r&&(fe.s.r=fe.e.r),fe.e.c>A.e.c&&(fe.e.c=A.e.c),fe.e.c<fe.s.c&&(fe.s.c=fe.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Or(fe))}return L.length>0&&(c["!merges"]=L),D.length>0&&(c["!cols"]=D),X.length>0&&(c["!rows"]=X),c}function rge(t,e,r,n,s,i,o){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=ss(e),e.z=e.z||_r[14],e.v=xa(ns(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var c={r,c:n};switch(c.s=_u(s.cellXfs,e,s),e.l&&i["!links"].push([Er(c),e.l]),e.c&&i["!comments"].push([Er(c),e.c]),e.t){case"s":case"str":return s.bookSST?(l=DI(s.Strings,e.v,s.revStrings),c.t="s",c.v=l,o?Tt(t,18,bpe(e,c)):Tt(t,7,vpe(e,c))):(c.t="str",o?Tt(t,17,Tpe(e,c)):Tt(t,6,kpe(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Tt(t,13,Spe(e,c)):Tt(t,2,Epe(e,c)):o?Tt(t,16,Cpe(e,c)):Tt(t,5,Npe(e,c)),!0;case"b":return c.t="b",o?Tt(t,15,hpe(e,c)):Tt(t,4,Ape(e,c)),!0;case"e":return c.t="e",o?Tt(t,14,gpe(e,c)):Tt(t,3,mpe(e,c)),!0}return o?Tt(t,12,cpe(e,c)):Tt(t,1,ope(e,c)),!0}function nge(t,e,r,n){var s=hn(e["!ref"]||"A1"),i,o="",l=[];Tt(t,145);var c=Array.isArray(e),d=s.e.r;e["!rows"]&&(d=Math.max(s.e.r,e["!rows"].length-1));for(var A=s.s.r;A<=d;++A){o=zs(A),epe(t,e,s,A);var u=!1;if(A<=s.e.r)for(var f=s.s.c;f<=s.e.c;++f){A===s.s.r&&(l[f]=ws(f)),i=l[f]+o;var h=c?(e[A]||[])[f]:e[i];if(!h){u=!1;continue}u=rge(t,h,A,f,n,e,u)}}Tt(t,146)}function sge(t,e){!e||!e["!merges"]||(Tt(t,177,Mpe(e["!merges"].length)),e["!merges"].forEach(function(r){Tt(t,176,Ope(r))}),Tt(t,178))}function age(t,e){!e||!e["!cols"]||(Tt(t,390),e["!cols"].forEach(function(r,n){r&&Tt(t,60,Gpe(n,r))}),Tt(t,391))}function ige(t,e){!e||!e["!ref"]||(Tt(t,648),Tt(t,649,Xpe(hn(e["!ref"]))),Tt(t,650))}function oge(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=Bn(r,-1,n[1].Target.replace(/#.*$/,""),$r.HLINK);Tt(t,494,Vpe(n,s))}}),delete e["!links"]}function lge(t,e,r,n){if(e["!comments"].length>0){var s=Bn(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",$r.VML);Tt(t,551,NI("rId"+s)),e["!legacy"]=s}}function cge(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],i=typeof s.ref=="string"?s.ref:Or(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=no(i);l.s.r==l.e.r&&(l.e.r=no(e["!ref"]).e.r,i=Or(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Tt(t,161,fm(hn(i))),Tt(t,162)}}function dge(t,e,r){Tt(t,133),Tt(t,137,Jpe(e,r)),Tt(t,138),Tt(t,134)}function Age(t,e){e["!protect"]&&Tt(t,535,Ype(e["!protect"]))}function uge(t,e,r,n){var s=ro(),i=r.SheetNames[t],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var c=hn(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Tt(s,129),(r.vbaraw||o["!outline"])&&Tt(s,147,ape(l,o["!outline"])),Tt(s,148,rpe(c)),dge(s,o,r.Workbook),age(s,o),nge(s,o,t,e),Age(s,o),cge(s,o,r,t),sge(s,o),oge(s,o,n),o["!margins"]&&Tt(s,476,zpe(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&ige(s,o),lge(s,o,t,n),Tt(s,130),s.end()}function hge(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var s=An((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function fge(t,e,r,n,s,i){var o=i||{"!type":"chart"};if(!t)return i;var l=0,c=0,d="A",A={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var f=hge(u);A.s.r=A.s.c=0,A.e.c=l,d=ws(l),f[0].forEach(function(h,m){o[d+zs(m)]={t:"n",v:h,z:f[1]},c=m}),A.e.r<c&&(A.e.r=c),++l}),l>0&&(o["!ref"]=Or(A)),o}function mge(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=t.match(qQ);return l&&LI(l[0],i,s,r),(o=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function pge(t,e){t.l+=10;var r=xi(t);return{name:r}}function gge(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Dd(t,function(c,d,A){switch(A){case 550:i["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var UI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],xge=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],vge=[],yge=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function i3(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=es(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function o3(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=es(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function WQ(t){o3(t.WBProps,UI),o3(t.CalcPr,yge),i3(t.WBView,xge),i3(t.Sheets,vge),_0.date1904=es(t.WBProps.date1904)}function bge(t){return!t.Workbook||!t.Workbook.WBProps?"false":es(t.Workbook.WBProps.date1904)?"true":"false"}var wge="][*?/\\".split("");function JQ(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return wge.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Nge(t,e,r){t.forEach(function(n,s){JQ(n);for(var i=0;i<s;++i)if(n==t[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[s]&&e[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Cge(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];Nge(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)bme(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var _ge=/<\w+:workbook/;function Ege(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},o=0;if(t.replace(bi,function(c,d){var A=Ir(c);switch(Pc(A[0])){case"<?xml":break;case"<workbook":c.match(_ge)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=A[s];break;case"</workbook>":break;case"<fileVersion":delete A[0],r.AppVersion=A;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":UI.forEach(function(u){if(A[u[0]]!=null)switch(u[2]){case"bool":r.WBProps[u[0]]=es(A[u[0]]);break;case"int":r.WBProps[u[0]]=parseInt(A[u[0]],10);break;default:r.WBProps[u[0]]=A[u[0]]}}),A.codeName&&(r.WBProps.CodeName=Rn(A.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete A[0],r.WBView.push(A);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(A.state){case"hidden":A.Hidden=1;break;case"veryHidden":A.Hidden=2;break;default:A.Hidden=0}delete A.state,A.name=An(Rn(A.name)),delete A[0],r.Sheets.push(A);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Rn(A.name),A.comment&&(i.Comment=A.comment),A.localSheetId&&(i.Sheet=+A.localSheetId),es(A.hidden||"0")&&(i.Hidden=!0),o=d+c.length;break;case"</definedName>":i.Ref=An(Rn(t.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete A[0],r.CalcPr=A;break;case"<calcPr/>":delete A[0],r.CalcPr=A;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+A[0]+" in workbook")}return c}),tf.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return WQ(r),r}function XQ(t){var e=[Js];e[e.length]=Jt("workbook",null,{xmlns:tf[0],"xmlns:r":fa.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(UI.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Jt("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var o={name:jn(t.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Jt("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(e[e.length]=Jt("definedName",jn(l.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function Bge(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=kE(t),r.name=xi(t),r}function Sge(t,e){return e||(e=_t(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),NI(t.strRelID,e),Sa(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Ige(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?xi(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function jge(t,e){e||(e=_t(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),V8(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function kge(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function Fge(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=lde(t),o=mme(t,0,r),l=wI(t);t.l=n;var c={Name:i,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function Tge(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],Ax[16]={n:"BrtFRTArchID$",f:kge},Dd(t,function(c,d,A){switch(A){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=fi(c.Ptg,null,null,o,e),delete e.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([A,c]):o[0]=[A,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(A),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(A),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+A.toString(16))}}},e),WQ(r),r.Names=i,r.supbooks=o,r}function Pge(t,e){Tt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Tt(t,156,Sge(s))}Tt(t,144)}function Rge(t,e){e||(e=_t(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Sa("SheetJS",e),Sa(Bb.version,e),Sa(Bb.version,e),Sa("7262",e),e.length>e.l?e.slice(0,e.l):e}function Dge(t,e){e||(e=_t(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function Lge(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(Tt(t,135),Tt(t,158,Dge(s)),Tt(t,136))}}function Uge(t,e){var r=ro();return Tt(r,131),Tt(r,128,Rge()),Tt(r,153,jge(t.Workbook&&t.Workbook.WBProps||null)),Lge(r,t),Pge(r,t),Tt(r,132),r.end()}function Oge(t,e,r){return e.slice(-4)===".bin"?Tge(t,r):Ege(t,r)}function Mge(t,e,r,n,s,i,o,l){return e.slice(-4)===".bin"?tge(t,n,r,s,i,o,l):Fme(t,n,r,s,i,o,l)}function Qge(t,e,r,n,s,i,o,l){return e.slice(-4)===".bin"?gge(t,n,r,s,i):mge(t,n,r,s,i)}function Vge(t,e,r,n,s,i,o,l){return e.slice(-4)===".bin"?Kfe():qfe()}function Hge(t,e,r,n,s,i,o,l){return e.slice(-4)===".bin"?Vfe():Hfe()}function Kge(t,e,r,n){return e.slice(-4)===".bin"?Ohe(t,r,n):Bhe(t,r,n)}function qge(t,e,r){return kQ(t,r)}function Gge(t,e,r){return e.slice(-4)===".bin"?Gue(t,r):Hue(t,r)}function $ge(t,e,r){return e.slice(-4)===".bin"?Lfe(t,r):Sfe(t,r)}function zge(t,e,r){return e.slice(-4)===".bin"?_fe(t):Nfe(t)}function Wge(t,e,r,n){return r.slice(-4)===".bin"?Efe(t,e,r,n):void 0}function Jge(t,e,r){return e.slice(-4)===".bin"?yfe(t,e,r):wfe(t,e,r)}function Xge(t,e,r){return(e.slice(-4)===".bin"?Uge:XQ)(t)}function Yge(t,e,r,n,s){return(e.slice(-4)===".bin"?uge:GQ)(t,r,n,s)}function Zge(t,e,r){return(e.slice(-4)===".bin"?Whe:IQ)(t,r)}function exe(t,e,r){return(e.slice(-4)===".bin"?Wue:bQ)(t,r)}function txe(t,e,r){return(e.slice(-4)===".bin"?Ufe:PQ)(t)}function rxe(t){return(t.slice(-4)===".bin"?bfe:FQ)()}var YQ=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ZQ=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function jl(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(YQ),i,o,l,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match(ZQ),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),n[l]=i[2].slice(1,i[2].length-1));return n}function nxe(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(YQ),s,i,o,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(ZQ),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),r[o]=s[2].slice(1,s[2].length-1));return r}var dg;function sxe(t,e){var r=dg[t]||An(t);return r==="General"?Lh(e):xl(r,e)}function axe(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=es(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=ns(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[An(e)]=s}function ixe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Ld[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=rx(t.v):t.w=Lh(t.v):t.w=sxe(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=dg[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Am(n)){var s=oh(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function oxe(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=vhe[n.Pattern]||n.Pattern)}t[e.ID]=e}function lxe(t,e,r,n,s,i,o,l,c,d){var A="General",u=n.StyleID,f={};d=d||{};var h=[],m=0;for(u===void 0&&l&&(u=l.StyleID),u===void 0&&o&&(u=o.StyleID);i[u]!==void 0&&(i[u].nf&&(A=i[u].nf),i[u].Interior&&h.push(i[u].Interior),!!i[u].Parent);)u=i[u].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=es(t);break;case"String":n.t="s",n.r=CP(An(t)),n.v=t.indexOf("<")>-1?An(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(ns(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=An(t):n.v<60&&(n.v=n.v-1),(!A||A=="General")&&(A="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=$8[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=CP(e||t));break}if(ixe(n,A,d),d.cellFormula!==!1)if(n.Formula){var p=An(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=C0(p,s),delete n.Formula,n.ArrayRange=="RC"?n.F=C0("RC:RC",s):n.ArrayRange&&(n.F=C0(n.ArrayRange,s),c.push([hn(n.F),n.F]))}else for(m=0;m<c.length;++m)s.r>=c[m][0].s.r&&s.r<=c[m][0].e.r&&s.c>=c[m][0].s.c&&s.c<=c[m][0].e.c&&(n.F=c[m][1]);d.cellStyles&&(h.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function cxe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function cC(t,e){var r=e||{};um();var n=Bp(pI(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Rn(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=ss(r);return o.type="string",G0.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Y){s.indexOf("<"+Y)>=0&&(i=!0)}),i)return zxe(n,r);dg={"General Number":"General","General Date":_r[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":_r[15],"Short Date":_r[14],"Long Time":_r[19],"Medium Time":_r[18],"Short Time":_r[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:_r[2],Standard:_r[4],Percent:_r[10],Scientific:_r[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],d,A={},u=[],f=r.dense?[]:{},h="",m={},p={},g=jl('<Data ss:Type="String">'),x=0,b=0,w=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},L={},E="",B=0,S=[],U={},_={},F=0,D=[],X=[],ge={},ae=[],fe,me=!1,Z=[],ye=[],Ie={},I=0,j=0,Q={Sheets:[],WBProps:{date1904:!1}},T={};ax.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var R="";l=ax.exec(n);)switch(l[3]=(R=l[3]).toLowerCase()){case"data":if(R=="data"){if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?lxe(n.slice(x,l.index),E,g,c[c.length-1][0]=="comment"?ge:m,{c:b,r:w},O,ae[b],p,Z,r):(E="",g=jl(l[0]),x=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(X.length>0&&(m.c=X),(!r.sheetRows||r.sheetRows>w)&&m.v!==void 0&&(r.dense?(f[w]||(f[w]=[]),f[w][b]=m):f[ws(b)+zs(w)]=m),m.HRef&&(m.l={Target:An(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(I=b+(parseInt(m.MergeAcross,10)|0),j=w+(parseInt(m.MergeDown,10)|0),S.push({s:{c:b,r:w},e:{c:I,r:j}})),!r.sheetStubs)m.MergeAcross?b=I+1:++b;else if(m.MergeAcross||m.MergeDown){for(var K=b;K<=I;++K)for(var M=w;M<=j;++M)(K>b||M>w)&&(r.dense?(f[M]||(f[M]=[]),f[M][K]={t:"z"}):f[ws(K)+zs(M)]={t:"z"});b=I+1}else++b;else m=nxe(l[0]),m.Index&&(b=+m.Index-1),b<k.s.c&&(k.s.c=b),b>k.e.c&&(k.e.c=b),l[0].slice(-2)==="/>"&&++b,X=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<k.s.r&&(k.s.r=w),w>k.e.r&&(k.e.r=w),l[0].slice(-2)==="/>"&&(p=jl(l[0]),p.Index&&(w=+p.Index-1)),b=0,++w):(p=jl(l[0]),p.Index&&(w=+p.Index-1),Ie={},(p.AutoFitHeight=="0"||p.Height)&&(Ie.hpx=parseInt(p.Height,10),Ie.hpt=dx(Ie.hpx),ye[w]=Ie),p.Hidden=="1"&&(Ie.hidden=!0,ye[w]=Ie));break;case"worksheet":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));u.push(h),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(f["!ref"]=Or(k),r.sheetRows&&r.sheetRows<=k.e.r&&(f["!fullref"]=f["!ref"],k.e.r=r.sheetRows-1,f["!ref"]=Or(k))),S.length&&(f["!merges"]=S),ae.length>0&&(f["!cols"]=ae),ye.length>0&&(f["!rows"]=ye),A[h]=f}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,c.push([l[3],!1]),d=jl(l[0]),h=An(d.Name),f=r.dense?[]:{},S=[],Z=[],ye=[],T={name:h,Hidden:0},Q.Sheets.push(T);break;case"table":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),ae=[],me=!1}break;case"style":l[1]==="/"?oxe(O,L,r):L=jl(l[0]);break;case"numberformat":L.nf=An(jl(l[0]).Format||"General"),dg[L.nf]&&(L.nf=dg[L.nf]);for(var re=0;re!=392&&_r[re]!=L.nf;++re);if(re==392){for(re=57;re!=392;++re)if(_r[re]==null){yd(L.nf,re);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(fe=jl(l[0]),fe.Hidden&&(fe.hidden=!0,delete fe.Hidden),fe.Width&&(fe.wpx=parseInt(fe.Width,10)),!me&&fe.wpx>10){me=!0,pi=BQ;for(var de=0;de<ae.length;++de)ae[de]&&uu(ae[de])}me&&uu(fe),ae[fe.Index-1||ae.length]=fe;for(var le=0;le<+fe.Span;++le)ae[ae.length]=ss(fe);break;case"namedrange":if(l[1]==="/")break;Q.Names||(Q.Names=[]);var q=Ir(l[0]),Se={Name:q.Name,Ref:C0(q.RefersTo.slice(1),{r:0,c:0})};Q.Sheets.length>0&&(Se.Sheet=Q.Sheets.length-1),Q.Names.push(Se);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?E+=n.slice(B,l.index):B=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;L.Interior=jl(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?Tde(U,R,n.slice(F,l.index)):F=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));cxe(ge),X.push(ge)}else c.push([l[3],!1]),d=jl(l[0]),ge={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ee=jl(l[0]);f["!autofilter"]={ref:C0(ee.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return u3(n,r);var z=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:z=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:z=!1}break;case"excelworkbook":switch(l[3]){case"date1904":Q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:z=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:z=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(F,l.index)){case"SheetHidden":T.Hidden=1;break;case"SheetVeryHidden":T.Hidden=2;break}else F=l.index+l[0].length;break;case"header":f["!margins"]||yh(f["!margins"]={},"xlml"),isNaN(+Ir(l[0]).Margin)||(f["!margins"].header=+Ir(l[0]).Margin);break;case"footer":f["!margins"]||yh(f["!margins"]={},"xlml"),isNaN(+Ir(l[0]).Margin)||(f["!margins"].footer=+Ir(l[0]).Margin);break;case"pagemargins":var te=Ir(l[0]);f["!margins"]||yh(f["!margins"]={},"xlml"),isNaN(+te.Top)||(f["!margins"].top=+te.Top),isNaN(+te.Left)||(f["!margins"].left=+te.Left),isNaN(+te.Right)||(f["!margins"].right=+te.Right),isNaN(+te.Bottom)||(f["!margins"].bottom=+te.Bottom);break;case"displayrighttoleft":Q.Views||(Q.Views=[]),Q.Views[0]||(Q.Views[0]={}),Q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:z=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:z=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:z=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:z=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:z=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:z=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:z=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:z=!1}break;case"smarttags":break;default:z=!1;break}if(z||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?axe(_,R,D,n.slice(F,l.index)):(D=l,F=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var Ne={};return!r.bookSheets&&!r.bookProps&&(Ne.Sheets=A),Ne.SheetNames=u,Ne.Workbook=Q,Ne.SSF=ss(_r),Ne.Props=U,Ne.Custprops=_,Ne}function UE(t,e){switch(MI(e=e||{}),e.type||"base64"){case"base64":return cC(Po(t),e);case"binary":case"buffer":case"file":return cC(t,e);case"array":return cC(Nu(t),e)}}function dxe(t,e){var r=[];return t.Props&&r.push(Pde(t.Props,e)),t.Custprops&&r.push(Rde(t.Props,t.Custprops)),r.join("")}function Axe(){return""}function uxe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var i=[];i.push(Jt("NumberFormat",null,{"ss:Format":jn(_r[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(Jt("Style",i.join(""),o))}),Jt("Styles",r.join(""))}function e7(t){return Jt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+PI(t.Ref,{r:0,c:0})})}function hxe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(e7(s)))}return Jt("Names",r.join(""))}function fxe(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(e7(l)))}return i.join("")}function mxe(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(Jt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(Jt("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(Jt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Jt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(za("ProtectContents","True")),t["!protect"].objects&&s.push(za("ProtectObjects","True")),t["!protect"].scenarios&&s.push(za("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(za("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(za("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Jt("WorksheetOptions",s.join(""),{xmlns:No.x})}function pxe(t){return t.map(function(e){var r=Lce(e.t||""),n=Jt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Jt("Comment",n,{"ss:Author":e.a})}).join("")}function gxe(t,e,r,n,s,i,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+jn(PI(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var c=Ns(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=jn(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=jn(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],A=0;A!=d.length;++A)d[A].s.c!=o.c||d[A].s.r!=o.r||(d[A].e.c>d[A].s.c&&(l["ss:MergeAcross"]=d[A].e.c-d[A].s.c),d[A].e.r>d[A].s.r&&(l["ss:MergeDown"]=d[A].e.r-d[A].s.r));var u="",f="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":u="Number",f=String(t.v);break;case"b":u="Boolean",f=t.v?"1":"0";break;case"e":u="Error",f=Ld[t.v];break;case"d":u="DateTime",f=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||_r[14]);break;case"s":u="String",f=Dce(t.v||"");break}var h=_u(n.cellXfs,t,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var m=t.v!=null?f:"",p=t.t=="z"?"":'<Data ss:Type="'+u+'">'+m+"</Data>";return(t.c||[]).length>0&&(p+=pxe(t.c)),Jt("Cell",p,l)}function xxe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=$0(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function vxe(t,e,r,n){if(!t["!ref"])return"";var s=hn(t["!ref"]),i=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(g,x){uu(g);var b=!!g.width,w=tw(x,g),k={"ss:Index":x+1};b&&(k["ss:Width"]=lx(w.width)),g.hidden&&(k["ss:Hidden"]="1"),l.push(Jt("Column",null,k))});for(var c=Array.isArray(t),d=s.s.r;d<=s.e.r;++d){for(var A=[xxe(d,(t["!rows"]||[])[d])],u=s.s.c;u<=s.e.c;++u){var f=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>u)&&!(i[o].s.r>d)&&!(i[o].e.c<u)&&!(i[o].e.r<d)){(i[o].s.c!=u||i[o].s.r!=d)&&(f=!0);break}if(!f){var h={r:d,c:u},m=Er(h),p=c?(t[d]||[])[u]:t[m];A.push(gxe(p,m,t,e,r,n,h))}}A.push("</Row>"),A.length>2&&l.push(A.join(""))}return l.join("")}function yxe(t,e,r){var n=[],s=r.SheetNames[t],i=r.Sheets[s],o=i?fxe(i,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?vxe(i,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(mxe(i,e,t,r)),n.join("")}function bxe(t,e){e||(e={}),t.SSF||(t.SSF=ss(_r)),t.SSF&&(um(),z2(t.SSF),e.revssf=J2(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],_u(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(dxe(t,e)),r.push(Axe()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Jt("Worksheet",yxe(n,e,t),{"ss:Name":jn(t.SheetNames[n])}));return r[2]=uxe(t,e),r[3]=hxe(t),Js+Jt("Workbook",r.join(""),{xmlns:No.ss,"xmlns:o":No.o,"xmlns:x":No.x,"xmlns:ss":No.ss,"xmlns:dt":No.dt,"xmlns:html":No.html})}function wxe(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=hde(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=fde(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var Nxe=[60,1084,2066,2165,2175];function Cxe(t,e,r,n,s){var i=n,o=[],l=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),r.l+=i;for(var c=Ad(r,r.l),d=OE[c],A=0;d!=null&&Nxe.indexOf(c)>-1;)i=Ad(r,r.l+2),A=r.l+4,c==2066?A+=4:(c==2165||c==2175)&&(A+=12),l=r.slice(A,r.l+4+i),o.push(l),r.l+=4+i,d=OE[c=Ad(r,r.l)];var u=Ba(o);Ga(u,0);var f=0;u.lens=[];for(var h=0;h<o.length;++h)u.lens.push(f),f+=o[h].length;if(u.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+u.length+" < "+n;return e.f(u,u.length,s)}function uc(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=_r[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ld[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=rx(t.v):t.w=Lh(t.v):t.w=xl(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&Am(_r[n]||String(n))){var s=oh(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function P1(t,e,r){return{v:t,ixfe:e,t:r}}function _xe(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},o={},l=null,c=[],d="",A={},u,f="",h,m,p,g,x={},b=[],w,k,O=[],L=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},B={},S=function(ve){return ve<8?gh[ve]:ve<64&&L[ve-8]||gh[ve]},U=function(ve,ie,ze){var rt=ie.XF.data;if(!(!rt||!rt.patternType||!ze||!ze.cellStyles)){ie.s={},ie.s.patternType=rt.patternType;var At;(At=ox(S(rt.icvFore)))&&(ie.s.fgColor={rgb:At}),(At=ox(S(rt.icvBack)))&&(ie.s.bgColor={rgb:At})}},_=function(ve,ie,ze){if(!(Ie>1)&&!(ze.sheetRows&&ve.r>=ze.sheetRows)){if(ze.cellStyles&&ie.XF&&ie.XF.data&&U(ve,ie,ze),delete ie.ixfe,delete ie.XF,u=ve,f=Er(ve),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ve.r<o.s.r&&(o.s.r=ve.r),ve.c<o.s.c&&(o.s.c=ve.c),ve.r+1>o.e.r&&(o.e.r=ve.r+1),ve.c+1>o.e.c&&(o.e.c=ve.c+1),ze.cellFormula&&ie.f){for(var rt=0;rt<b.length;++rt)if(!(b[rt][0].s.c>ve.c||b[rt][0].s.r>ve.r)&&!(b[rt][0].e.c<ve.c||b[rt][0].e.r<ve.r)){ie.F=Or(b[rt][0]),(b[rt][0].s.c!=ve.c||b[rt][0].s.r!=ve.r)&&delete ie.f,ie.f&&(ie.f=""+fi(b[rt][1],o,ve,Z,F));break}}ze.dense?(s[ve.r]||(s[ve.r]=[]),s[ve.r][ve.c]=ie):s[f]=ie}},F={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(F.password=e.password);var D,X=[],ge=[],ae=[],fe=[],me=!1,Z=[];Z.SheetNames=F.snames,Z.sharedf=F.sharedf,Z.arrayf=F.arrayf,Z.names=[],Z.XTI=[];var ye=0,Ie=0,I=0,j=[],Q=[],T;F.codepage=1200,Dl(1200);for(var R=!1;t.l<t.length-1;){var K=t.l,M=t.read_shift(2);if(M===0&&ye===10)break;var re=t.l===t.length?0:t.read_shift(2),de=OE[M];if(de&&de.f){if(e.bookSheets&&ye===133&&M!==133)break;if(ye=M,de.r===2||de.r==12){var le=t.read_shift(2);if(re-=2,!F.enc&&le!==M&&((le&255)<<8|le>>8)!==M)throw new Error("rt mismatch: "+le+"!="+M);de.r==12&&(t.l+=10,re-=10)}var q={};if(M===10?q=de.f(t,re,F):q=Cxe(M,de,t,re,F),Ie==0&&[9,521,1033,2057].indexOf(ye)===-1)continue;switch(M){case 34:r.opts.Date1904=E.WBProps.date1904=q;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(F.enc||(t.l=0),F.enc=q,!e.password)throw new Error("File is password-protected");if(q.valid==null)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:F.lastuser=q;break;case 66:var Se=Number(q);switch(Se){case 21010:Se=1200;break;case 32768:Se=1e4;break;case 32769:Se=1252;break}Dl(F.codepage=Se),R=!0;break;case 317:F.rrtabid=q;break;case 25:F.winlocked=q;break;case 439:r.opts.RefreshAll=q;break;case 12:r.opts.CalcCount=q;break;case 16:r.opts.CalcDelta=q;break;case 17:r.opts.CalcIter=q;break;case 13:r.opts.CalcMode=q;break;case 14:r.opts.CalcPrecision=q;break;case 95:r.opts.CalcSaveRecalc=q;break;case 15:F.CalcRefMode=q;break;case 2211:r.opts.FullCalc=q;break;case 129:q.fDialog&&(s["!type"]="dialog"),q.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),q.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:O.push(q);break;case 430:Z.push([q]),Z[Z.length-1].XTI=[];break;case 35:case 547:Z[Z.length-1].push(q);break;case 24:case 536:T={Name:q.Name,Ref:fi(q.rgce,o,null,Z,F)},q.itab>0&&(T.Sheet=q.itab-1),Z.names.push(T),Z[0]||(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].push(q),q.Name=="_xlnm._FilterDatabase"&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&q.rgce[0][0][0]=="PtgArea3d"&&(Q[q.itab-1]={ref:Or(q.rgce[0][0][1][2])});break;case 22:F.ExternCount=q;break;case 23:Z.length==0&&(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].XTI=Z[Z.length-1].XTI.concat(q),Z.XTI=Z.XTI.concat(q);break;case 2196:if(F.biff<8)break;T!=null&&(T.Comment=q[1]);break;case 18:s["!protect"]=q;break;case 19:q!==0&&F.WTF&&console.error("Password verifier: "+q);break;case 133:i[q.pos]=q,F.snames.push(q.name);break;case 10:{if(--Ie)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=Or(o),e.sheetRows&&e.sheetRows<=o.e.r){var ee=o.e.r;o.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Or(o),o.e.r=ee}o.e.r++,o.e.c++}X.length>0&&(s["!merges"]=X),ge.length>0&&(s["!objects"]=ge),ae.length>0&&(s["!cols"]=ae),fe.length>0&&(s["!rows"]=fe),E.Sheets.push(B)}d===""?A=s:n[d]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(F.biff===8&&(F.biff={9:2,521:3,1033:4}[M]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),F.biffguess=q.BIFFVer==0,q.BIFFVer==0&&q.dt==4096&&(F.biff=5,R=!0,Dl(F.codepage=28591)),F.biff==8&&q.BIFFVer==0&&q.dt==16&&(F.biff=2),Ie++)break;if(s=e.dense?[]:{},F.biff<8&&!R&&(R=!0,Dl(F.codepage=e.codepage||1252)),F.biff<5||q.BIFFVer==0&&q.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var z={pos:t.l-re,name:d};i[z.pos]=z,F.snames.push(d)}else d=(i[K]||{name:""}).name;q.dt==32&&(s["!type"]="chart"),q.dt==64&&(s["!type"]="macro"),X=[],ge=[],F.arrayf=b=[],ae=[],fe=[],me=!1,B={Hidden:(i[K]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[q.r]||[])[q.c]:s[Er({c:q.c,r:q.r})])&&++q.c,w={ixfe:q.ixfe,XF:O[q.ixfe]||{},v:q.val,t:"n"},I>0&&(w.z=j[w.ixfe>>8&63]),uc(w,e,r.opts.Date1904),_({c:q.c,r:q.r},w,e);break;case 5:case 517:w={ixfe:q.ixfe,XF:O[q.ixfe],v:q.val,t:q.t},I>0&&(w.z=j[w.ixfe>>8&63]),uc(w,e,r.opts.Date1904),_({c:q.c,r:q.r},w,e);break;case 638:w={ixfe:q.ixfe,XF:O[q.ixfe],v:q.rknum,t:"n"},I>0&&(w.z=j[w.ixfe>>8&63]),uc(w,e,r.opts.Date1904),_({c:q.c,r:q.r},w,e);break;case 189:for(var te=q.c;te<=q.C;++te){var Ne=q.rkrec[te-q.c][0];w={ixfe:Ne,XF:O[Ne],v:q.rkrec[te-q.c][1],t:"n"},I>0&&(w.z=j[w.ixfe>>8&63]),uc(w,e,r.opts.Date1904),_({c:te,r:q.r},w,e)}break;case 6:case 518:case 1030:{if(q.val=="String"){l=q;break}if(w=P1(q.val,q.cell.ixfe,q.tt),w.XF=O[w.ixfe],e.cellFormula){var Y=q.formula;if(Y&&Y[0]&&Y[0][0]&&Y[0][0][0]=="PtgExp"){var we=Y[0][0][1][0],Pe=Y[0][0][1][1],Qe=Er({r:we,c:Pe});x[Qe]?w.f=""+fi(q.formula,o,q.cell,Z,F):w.F=((e.dense?(s[we]||[])[Pe]:s[Qe])||{}).F}else w.f=""+fi(q.formula,o,q.cell,Z,F)}I>0&&(w.z=j[w.ixfe>>8&63]),uc(w,e,r.opts.Date1904),_(q.cell,w,e),l=q}break;case 7:case 519:if(l)l.val=q,w=P1(q,l.cell.ixfe,"s"),w.XF=O[w.ixfe],e.cellFormula&&(w.f=""+fi(l.formula,o,l.cell,Z,F)),I>0&&(w.z=j[w.ixfe>>8&63]),uc(w,e,r.opts.Date1904),_(l.cell,w,e),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(q);var tt=Er(q[0].s);if(h=e.dense?(s[q[0].s.r]||[])[q[0].s.c]:s[tt],e.cellFormula&&h){if(!l||!tt||!h)break;h.f=""+fi(q[1],o,q[0],Z,F),h.F=Or(q[0])}}break;case 1212:{if(!e.cellFormula)break;if(f){if(!l)break;x[Er(l.cell)]=q[0],h=e.dense?(s[l.cell.r]||[])[l.cell.c]:s[Er(l.cell)],(h||{}).f=""+fi(q[0],o,u,Z,F)}}break;case 253:w=P1(c[q.isst].t,q.ixfe,"s"),c[q.isst].h&&(w.h=c[q.isst].h),w.XF=O[w.ixfe],I>0&&(w.z=j[w.ixfe>>8&63]),uc(w,e,r.opts.Date1904),_({c:q.c,r:q.r},w,e);break;case 513:e.sheetStubs&&(w={ixfe:q.ixfe,XF:O[q.ixfe],t:"z"},I>0&&(w.z=j[w.ixfe>>8&63]),uc(w,e,r.opts.Date1904),_({c:q.c,r:q.r},w,e));break;case 190:if(e.sheetStubs)for(var ot=q.c;ot<=q.C;++ot){var dt=q.ixfe[ot-q.c];w={ixfe:dt,XF:O[dt],t:"z"},I>0&&(w.z=j[w.ixfe>>8&63]),uc(w,e,r.opts.Date1904),_({c:ot,r:q.r},w,e)}break;case 214:case 516:case 4:w=P1(q.val,q.ixfe,"s"),w.XF=O[w.ixfe],I>0&&(w.z=j[w.ixfe>>8&63]),uc(w,e,r.opts.Date1904),_({c:q.c,r:q.r},w,e);break;case 0:case 512:Ie===1&&(o=q);break;case 252:c=q;break;case 1054:if(F.biff==4){j[I++]=q[1];for(var vt=0;vt<I+163&&_r[vt]!=q[1];++vt);vt>=163&&yd(q[1],I+163)}else yd(q[1],q[0]);break;case 30:{j[I++]=q;for(var lt=0;lt<I+163&&_r[lt]!=q;++lt);lt>=163&&yd(q,I+163)}break;case 229:X=X.concat(q);break;case 93:ge[q.cmo[0]]=F.lastobj=q;break;case 438:F.lastobj.TxO=q;break;case 127:F.lastobj.ImData=q;break;case 440:for(g=q[0].s.r;g<=q[0].e.r;++g)for(p=q[0].s.c;p<=q[0].e.c;++p)h=e.dense?(s[g]||[])[p]:s[Er({c:p,r:g})],h&&(h.l=q[1]);break;case 2048:for(g=q[0].s.r;g<=q[0].e.r;++g)for(p=q[0].s.c;p<=q[0].e.c;++p)h=e.dense?(s[g]||[])[p]:s[Er({c:p,r:g})],h&&h.l&&(h.l.Tooltip=q[1]);break;case 28:{if(F.biff<=5&&F.biff>=2)break;h=e.dense?(s[q[0].r]||[])[q[0].c]:s[Er(q[0])];var Ue=ge[q[2]];h||(e.dense?(s[q[0].r]||(s[q[0].r]=[]),h=s[q[0].r][q[0].c]={t:"z"}):h=s[Er(q[0])]={t:"z"},o.e.r=Math.max(o.e.r,q[0].r),o.s.r=Math.min(o.s.r,q[0].r),o.e.c=Math.max(o.e.c,q[0].c),o.s.c=Math.min(o.s.c,q[0].c)),h.c||(h.c=[]),m={a:q[1],t:Ue.TxO.t},h.c.push(m)}break;case 2173:ufe(O[q.ixfe],q.ext);break;case 125:{if(!F.cellStyles)break;for(;q.e>=q.s;)ae[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(q.flags&1)},me||(me=!0,kI(q.w/256)),uu(ae[q.e+1])}break;case 520:{var Xe={};q.level!=null&&(fe[q.r]=Xe,Xe.level=q.level),q.hidden&&(fe[q.r]=Xe,Xe.hidden=!0),q.hpt&&(fe[q.r]=Xe,Xe.hpt=q.hpt,Xe.hpx=$0(q.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||yh(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[M]]=q;break;case 161:s["!margins"]||yh(s["!margins"]={}),s["!margins"].header=q.header,s["!margins"].footer=q.footer;break;case 574:q.RTL&&(E.Views[0].RTL=!0);break;case 146:L=q;break;case 2198:D=q;break;case 140:k=q;break;case 442:d?B.CodeName=q||B.name:E.WBProps.CodeName=q||"ThisWorkbook";break}}else de||console.error("Missing Info for XLS Record 0x"+M.toString(16)),t.l+=re}return r.SheetNames=Rs(i).sort(function(xe,ve){return Number(xe)-Number(ve)}).map(function(xe){return i[xe].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&A["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=A)):r.Preamble=A,r.Sheets&&Q.forEach(function(xe,ve){r.Sheets[r.SheetNames[ve]]["!autofilter"]=xe}),r.Strings=c,r.SSF=ss(_r),F.enc&&(r.Encryption=F.enc),D&&(r.Themes=D),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),Z.names.length>0&&(E.Names=Z.names),r.Workbook=E,r}var Ag={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Exe(t,e,r){var n=wr.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=VP(n,FE,Ag.DSI);for(var i in s)e[i]=s[i]}catch(d){if(r.WTF)throw d}var o=wr.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var l=VP(o,TE,Ag.SI);for(var c in l)e[c]==null&&(e[c]=l[c])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(Z8(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function Bxe(t,e){var r=[],n=[],s=[],i=0,o,l=xP(FE,"n"),c=xP(TE,"n");if(t.Props)for(o=Rs(t.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:s).push([o[i],t.Props[o[i]]]);if(t.Custprops)for(o=Rs(t.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:s).push([o[i],t.Custprops[o[i]]]);var d=[];for(i=0;i<s.length;++i)iQ.indexOf(s[i][0])>-1||Y8.indexOf(s[i][0])>-1||s[i][1]!=null&&d.push(s[i]);n.length&&wr.utils.cfb_add(e,"/SummaryInformation",HP(n,Ag.SI,c,TE)),(r.length||d.length)&&wr.utils.cfb_add(e,"/DocumentSummaryInformation",HP(r,Ag.DSI,l,FE,d.length?d:null,Ag.UDI))}function t7(t,e){e||(e={}),MI(e),oI(),e.codepage&&iI(e.codepage);var r,n;if(t.FullPaths){if(wr.find(t,"/encryption"))throw new Error("File is password-protected");r=wr.find(t,"!CompObj"),n=wr.find(t,"/Workbook")||wr.find(t,"/Book")}else{switch(e.type){case"base64":t=_o(Po(t));break;case"binary":t=_o(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Ga(t,0),n={content:t}}var s,i;if(r&&wxe(r),e.bookProps&&!e.bookSheets)s={};else{var o=Kr?"buffer":"array";if(n&&n.content)s=_xe(n.content,e);else if((i=wr.find(t,"PerfectOffice_MAIN"))&&i.content)s=vh.to_workbook(i.content,(e.type=o,e));else if((i=wr.find(t,"NativeContent_MAIN"))&&i.content)s=vh.to_workbook(i.content,(e.type=o,e));else throw(i=wr.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&wr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Mfe(t))}var l={};return t.FullPaths&&Exe(t,l,e),s.Props=s.Custprops=l,e.bookFiles&&(s.cfb=t),s}function Sxe(t,e){var r=e||{},n=wr.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return wr.utils.cfb_add(n,s,r7(t,r)),r.biff==8&&(t.Props||t.Custprops)&&Bxe(t,n),r.biff==8&&t.vbaraw&&Qfe(n,wr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Ax={0:{f:Yme},1:{f:ipe},2:{f:_pe},3:{f:fpe},4:{f:dpe},5:{f:wpe},6:{f:jpe},7:{f:xpe},8:{f:Lpe},9:{f:Dpe},10:{f:Ppe},11:{f:Rpe},12:{f:lpe},13:{f:Bpe},14:{f:ppe},15:{f:upe},16:{f:$Q},17:{f:Fpe},18:{f:ype},19:{f:bI},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Fge},40:{},42:{},43:{f:jhe},44:{f:She},45:{f:The},46:{f:Rhe},47:{f:Phe},48:{},49:{f:tde},50:{},51:{f:mfe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:gQ},62:{f:Ipe},63:{f:Cfe},64:{f:Zpe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:yi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Wpe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:spe},148:{f:tpe,p:16},151:{f:Hpe},152:{},153:{f:Ige},154:{},155:{},156:{f:Bge},157:{},158:{},159:{T:1,f:que},160:{T:-1},161:{T:1,f:af},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Upe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:hfe},336:{T:-1},337:{f:xfe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:kE},357:{},358:{},359:{},360:{T:1},361:{},362:{f:pQ},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Kpe},427:{f:qpe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:$pe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:npe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Qpe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:kE},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Rfe},633:{T:1},634:{T:-1},635:{T:1,f:Tfe},636:{T:-1},637:{f:ade},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:pge},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:ege},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},OE={6:{f:oC},10:{f:uA},12:{f:ea},13:{f:ea},14:{f:Vs},15:{f:Vs},16:{f:gi},17:{f:Vs},18:{f:Vs},19:{f:ea},20:{f:WP},21:{f:WP},23:{f:pQ},24:{f:XP},25:{f:Vs},26:{},27:{},28:{f:eue},29:{},34:{f:Vs},35:{f:JP},38:{f:gi},39:{f:gi},40:{f:gi},41:{f:gi},42:{f:Vs},43:{f:Vs},47:{f:uhe},49:{f:BAe},51:{f:ea},60:{},61:{f:wAe},64:{f:Vs},65:{f:EAe},66:{f:ea},77:{},80:{},81:{},82:{},85:{f:ea},89:{},90:{},91:{},92:{f:AAe},93:{f:nue},94:{},95:{f:Vs},96:{},97:{},99:{f:Vs},125:{f:gQ},128:{f:VAe},129:{f:hAe},130:{f:ea},131:{f:Vs},132:{f:Vs},133:{f:fAe},134:{},140:{f:Aue},141:{f:ea},144:{},146:{f:fue},151:{},152:{},153:{},154:{},155:{},156:{f:ea},157:{},158:{},160:{f:bue},161:{f:gue},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:UAe},190:{f:OAe},193:{f:uA},197:{},198:{},199:{},200:{},201:{},202:{f:Vs},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ea},220:{},221:{f:Vs},222:{},224:{f:QAe},225:{f:dAe},226:{f:uA},227:{},229:{f:tue},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:pAe},253:{f:IAe},255:{f:xAe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:oQ},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Vs},353:{f:uA},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:$Ae},431:{f:Vs},432:{},433:{},434:{},437:{},438:{f:iue},439:{f:Vs},440:{f:oue},441:{},442:{f:Gx},443:{},444:{f:ea},445:{},446:{},448:{f:uA},449:{f:bAe,r:2},450:{f:uA},512:{f:GP},513:{f:yue},515:{f:qAe},516:{f:kAe},517:{f:zP},519:{f:wue},520:{f:vAe},523:{},545:{f:YP},549:{f:qP},566:{},574:{f:CAe},638:{f:LAe},659:{},1048:{},1054:{f:TAe},1084:{},1212:{f:XAe},2048:{f:cue},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:k1},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:uA},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:mue,r:12},2173:{f:Afe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Vs,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:JAe,r:12},2197:{},2198:{f:afe,r:12},2199:{},2200:{},2201:{},2202:{f:YAe,r:12},2203:{f:uA},2204:{},2205:{},2206:{},2207:{},2211:{f:yAe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ea},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:xue},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:hue},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:GP},1:{},2:{f:Bue},3:{f:_ue},4:{f:Cue},5:{f:zP},7:{f:Iue},8:{},9:{f:k1},11:{},22:{f:ea},30:{f:RAe},31:{},32:{},33:{f:YP},36:{},37:{f:qP},50:{f:jue},62:{},52:{},67:{},68:{f:ea},69:{},86:{},126:{},127:{f:Nue},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:kue},223:{},234:{},354:{},421:{},518:{f:oC},521:{f:k1},536:{f:XP},547:{f:JP},561:{},579:{},1030:{f:oC},1033:{f:k1},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Yt(t,e,r,n){var s=e;if(!isNaN(s)){var i=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&xI(r)&&t.push(r)}}function Ixe(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return Yt(t,e,r,s);var i=e;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var A=t.next(4);for(A.write_shift(2,i),A.write_shift(2,d),t.push(r.slice(c,c+d)),c+=d;c<s;){for(A=t.next(4),A.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;A.write_shift(2,d),t.push(r.slice(c,c+d)),c+=d}}}function Jx(t,e,r){return t||(t=_t(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function jxe(t,e,r,n){var s=_t(9);return Jx(s,t,e),lQ(r,n||"b",s),s}function kxe(t,e,r){var n=_t(8+2*r.length);return Jx(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Fxe(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?xa(ns(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?Yt(t,2,Sue(r,n,s)):Yt(t,3,Eue(r,n,s));return;case"b":case"e":Yt(t,5,jxe(r,n,e.v,e.t));return;case"s":case"str":Yt(t,4,kxe(r,n,(e.v||"").slice(0,255)));return}Yt(t,1,Jx(null,r,n))}function Txe(t,e,r,n){var s=Array.isArray(e),i=hn(e["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Or(i)}for(var d=i.s.r;d<=i.e.r;++d){l=zs(d);for(var A=i.s.c;A<=i.e.c;++A){d===i.s.r&&(c[A]=ws(A)),o=c[A]+l;var u=s?(e[d]||[])[A]:e[o];u&&Fxe(t,u,d,A)}}}function Pxe(t,e){for(var r=e||{},n=ro(),s=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Yt(n,r.biff==4?1033:r.biff==3?521:9,SI(t,16,r)),Txe(n,t.Sheets[t.SheetNames[s]],s,r),Yt(n,10),n.end()}function Rxe(t,e,r){Yt(t,49,SAe({sz:12,name:"Arial"},r))}function Dxe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Yt(t,1054,PAe(s,e[s],r))})}function Lxe(t,e){var r=_t(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Yt(t,2151,r),r=_t(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),hQ(hn(e["!ref"]||"A1"),r),r.write_shift(4,4),Yt(t,2152,r)}function Uxe(t,e){for(var r=0;r<16;++r)Yt(t,224,$P({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Yt(t,224,$P(n,0,e))})}function Oxe(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Yt(t,440,lue(n)),n[1].Tooltip&&Yt(t,2048,due(n))}delete e["!links"]}function Mxe(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&Yt(t,125,pue(tw(s,n),s))})}}function Qxe(t,e,r,n,s){var i=16+_u(s.cellXfs,e,s);if(e.v==null&&!e.bf){Yt(t,513,Qh(r,n,i));return}if(e.bf)Yt(t,6,hme(e,r,n,s,i));else switch(e.t){case"d":case"n":var o=e.t=="d"?xa(ns(e.v)):e.v;Yt(t,515,GAe(r,n,o,i));break;case"b":case"e":Yt(t,517,KAe(r,n,e.v,i,s,e.t));break;case"s":case"str":if(s.bookSST){var l=DI(s.Strings,e.v,s.revStrings);Yt(t,253,jAe(r,n,l,i))}else Yt(t,516,FAe(r,n,(e.v||"").slice(0,255),i,s));break;default:Yt(t,513,Qh(r,n,i))}}function Vxe(t,e,r){var n=ro(),s=r.SheetNames[t],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[t]||{},c=Array.isArray(i),d=e.biff==8,A,u="",f=[],h=hn(i["!ref"]||"A1"),m=d?65536:16384;if(h.e.c>255||h.e.r>=m){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}Yt(n,2057,SI(r,16,e)),Yt(n,13,sl(1)),Yt(n,12,sl(100)),Yt(n,15,Ti(!0)),Yt(n,17,Ti(!1)),Yt(n,16,Oh(.001)),Yt(n,95,Ti(!0)),Yt(n,42,Ti(!1)),Yt(n,43,Ti(!1)),Yt(n,130,sl(1)),Yt(n,128,HAe()),Yt(n,131,Ti(!1)),Yt(n,132,Ti(!1)),d&&Mxe(n,i["!cols"]),Yt(n,512,DAe(h,e)),d&&(i["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){u=zs(p);for(var g=h.s.c;g<=h.e.c;++g){p===h.s.r&&(f[g]=ws(g)),A=f[g]+u;var x=c?(i[p]||[])[g]:i[A];x&&(Qxe(n,x,p,g,e),d&&x.l&&i["!links"].push([A,x.l]))}}var b=l.CodeName||l.name||s;return d&&Yt(n,574,_Ae((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&Yt(n,229,rue(i["!merges"])),d&&Oxe(n,i),Yt(n,442,cQ(b)),d&&Lxe(n,i),Yt(n,10),n.end()}function Hxe(t,e,r){var n=ro(),s=(t||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(Yt(n,2057,SI(t,5,r)),r.bookType=="xla"&&Yt(n,135),Yt(n,225,l?sl(1200):null),Yt(n,193,Kde(2)),c&&Yt(n,191),c&&Yt(n,192),Yt(n,226),Yt(n,92,uAe("SheetJS",r)),Yt(n,66,sl(l?1200:1252)),l&&Yt(n,353,sl(0)),l&&Yt(n,448),Yt(n,317,vue(t.SheetNames.length)),l&&t.vbaraw&&Yt(n,211),l&&t.vbaraw){var d=o.CodeName||"ThisWorkbook";Yt(n,442,cQ(d))}Yt(n,156,sl(17)),Yt(n,25,Ti(!1)),Yt(n,18,Ti(!1)),Yt(n,19,sl(0)),l&&Yt(n,431,Ti(!1)),l&&Yt(n,444,sl(0)),Yt(n,61,NAe()),Yt(n,64,Ti(!1)),Yt(n,141,sl(0)),Yt(n,34,Ti(bge(t)=="true")),Yt(n,14,Ti(!0)),l&&Yt(n,439,Ti(!1)),Yt(n,218,sl(0)),Rxe(n,t,r),Dxe(n,t.SSF,r),Uxe(n,r),l&&Yt(n,352,Ti(!1));var A=n.end(),u=ro();l&&Yt(u,140,uue()),l&&r.Strings&&Ixe(u,252,gAe(r.Strings)),Yt(u,10);var f=u.end(),h=ro(),m=0,p=0;for(p=0;p<t.SheetNames.length;++p)m+=(l?12:11)+(l?2:1)*t.SheetNames[p].length;var g=A.length+m+f.length;for(p=0;p<t.SheetNames.length;++p){var x=i[p]||{};Yt(h,133,mAe({pos:g,hs:x.Hidden||0,dt:0,name:t.SheetNames[p]},r)),g+=e[p].length}var b=h.end();if(m!=b.length)throw new Error("BS8 "+m+" != "+b.length);var w=[];return A.length&&w.push(A),b.length&&w.push(b),f.length&&w.push(f),Ba(w)}function Kxe(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=ss(_r)),t&&t.SSF&&(um(),z2(t.SSF),r.revssf=J2(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,QI(r),r.cellXfs=[],_u(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=Vxe(s,r,t);return n.unshift(Hxe(t,n,r)),Ba(n)}function r7(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=no(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return Kxe(t,e);case 4:case 3:case 2:return Pxe(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function l3(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),o=s.index,l=i&&i.index||t.length,c=Sce(t.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,A=0,u=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var p=c[o].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}A=0;continue}if(!(g!="<td"&&g!="<th")){var x=p.split(/<\/t[dh]>/i);for(l=0;l<x.length;++l){var b=x[l].trim();if(b.match(/<t[dh]/i)){for(var w=b,k=0;w.charAt(0)=="<"&&(k=w.indexOf(">"))>-1;)w=w.slice(k+1);for(var O=0;O<m.length;++O){var L=m[O];L.s.c==A&&L.s.r<d&&d<=L.e.r&&(A=L.e.c+1,O=-1)}var E=Ir(b.slice(0,b.indexOf(">")));f=E.colspan?+E.colspan:1,((u=+E.rowspan)>1||f>1)&&m.push({s:{r:d,c:A},e:{r:d+(u||1)-1,c:A+f-1}});var B=E.t||E["data-t"]||"";if(!w.length){A+=f;continue}if(w=E8(w),h.s.r>d&&(h.s.r=d),h.e.r<d&&(h.e.r=d),h.s.c>A&&(h.s.c=A),h.e.c<A&&(h.e.c=A),!w.length){A+=f;continue}var S={t:"s",v:w};r.raw||!w.trim().length||B=="s"||(w==="TRUE"?S={t:"b",v:!0}:w==="FALSE"?S={t:"b",v:!1}:isNaN(Ql(w))?isNaN(q0(w).getDate())||(S={t:"d",v:ns(w)},r.cellDates||(S={t:"n",v:xa(S.v)}),S.z=r.dateNF||_r[14]):S={t:"n",v:Ql(w)}),r.dense?(n[d]||(n[d]=[]),n[d][A]=S):n[Er({r:d,c:A})]=S,A+=f}}}}return n["!ref"]=Or(h),m.length&&(n["!merges"]=m),n}function qxe(t,e,r,n){for(var s=t["!merges"]||[],i=[],o=e.s.c;o<=e.e.c;++o){for(var l=0,c=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>o)&&!(s[d].e.r<r||s[d].e.c<o)){if(s[d].s.r<r||s[d].s.c<o){l=-1;break}l=s[d].e.r-s[d].s.r+1,c=s[d].e.c-s[d].s.c+1;break}if(!(l<0)){var A=Er({r,c:o}),u=n.dense?(t[r]||[])[o]:t[A],f=u&&u.v!=null&&(u.h||mI(u.w||(kd(u),u.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?f='<span contenteditable="true">'+f+"</span>":u&&(h["data-t"]=u&&u.t||"z",u.v!=null&&(h["data-v"]=u.v),u.z!=null&&(h["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+u.l.Target+'">'+f+"</a>")),h.id=(n.id||"sjs")+"-"+A,i.push(Jt("td",f,h))}}var m="<tr>";return m+i.join("")+"</tr>"}var Gxe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$xe="</body></html>";function zxe(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Cu(l3(r[0],e),e);var n=KI();return r.forEach(function(s,i){qI(n,l3(s,e),"Sheet"+(i+1))}),n}function Wxe(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function n7(t,e){var r=e||{},n=r.header!=null?r.header:Gxe,s=r.footer!=null?r.footer:$xe,i=[n],o=no(t["!ref"]);r.dense=Array.isArray(t),i.push(Wxe(t,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(qxe(t,o,l,r));return i.push("</table>"+s),i.join("")}function s7(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?Ns(n.origin):n.origin;s=o.r,i=o.c}var l=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var A=no(t["!ref"]);d.s.r=Math.min(d.s.r,A.s.r),d.s.c=Math.min(d.s.c,A.s.c),d.e.r=Math.max(d.e.r,A.e.r),d.e.c=Math.max(d.e.c,A.e.c),s==-1&&(d.e.r=s=A.e.r+1)}var u=[],f=0,h=t["!rows"]||(t["!rows"]=[]),m=0,p=0,g=0,x=0,b=0,w=0;for(t["!cols"]||(t["!cols"]=[]);m<l.length&&p<c;++m){var k=l[m];if(c3(k)){if(n.display)continue;h[p]={hidden:!0}}var O=k.children;for(g=x=0;g<O.length;++g){var L=O[g];if(!(n.display&&c3(L))){var E=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):E8(L.innerHTML),B=L.getAttribute("data-z")||L.getAttribute("z");for(f=0;f<u.length;++f){var S=u[f];S.s.c==x+i&&S.s.r<p+s&&p+s<=S.e.r&&(x=S.e.c+1-i,f=-1)}w=+L.getAttribute("colspan")||1,((b=+L.getAttribute("rowspan")||1)>1||w>1)&&u.push({s:{r:p+s,c:x+i},e:{r:p+s+(b||1)-1,c:x+i+(w||1)-1}});var U={t:"s",v:E},_=L.getAttribute("data-t")||L.getAttribute("t")||"";E!=null&&(E.length==0?U.t=_||"z":n.raw||E.trim().length==0||_=="s"||(E==="TRUE"?U={t:"b",v:!0}:E==="FALSE"?U={t:"b",v:!1}:isNaN(Ql(E))?isNaN(q0(E).getDate())||(U={t:"d",v:ns(E)},n.cellDates||(U={t:"n",v:xa(U.v)}),U.z=n.dateNF||_r[14]):U={t:"n",v:Ql(E)})),U.z===void 0&&B!=null&&(U.z=B);var F="",D=L.getElementsByTagName("A");if(D&&D.length)for(var X=0;X<D.length&&!(D[X].hasAttribute("href")&&(F=D[X].getAttribute("href"),F.charAt(0)!="#"));++X);F&&F.charAt(0)!="#"&&(U.l={Target:F}),n.dense?(t[p+s]||(t[p+s]=[]),t[p+s][x+i]=U):t[Er({c:x+i,r:p+s})]=U,d.e.c<x+i&&(d.e.c=x+i),x+=w}}++p}return u.length&&(t["!merges"]=(t["!merges"]||[]).concat(u)),d.e.r=Math.max(d.e.r,p-1+s),t["!ref"]=Or(d),p>=c&&(t["!fullref"]=Or((d.e.r=l.length-m+p-1+s,d))),t}function a7(t,e){var r=e||{},n=r.dense?[]:{};return s7(n,t,e)}function Jxe(t,e){return Cu(a7(t,e),e)}function c3(t){var e="",r=Xxe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Xxe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Yxe(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=An(e.replace(/<[^>]*>/g,""));return[r]}var d3={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function i7(t,e){var r=e||{},n=pI(t),s=[],i,o,l={name:""},c="",d=0,A,u,f={},h=[],m=r.dense?[]:{},p,g,x={value:""},b="",w=0,k=[],O=-1,L=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},B=0,S={},U=[],_={},F=0,D=0,X=[],ge=1,ae=1,fe=[],me={Names:[]},Z={},ye=["",""],Ie=[],I={},j="",Q=0,T=!1,R=!1,K=0;for(ax.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=ax.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?m["!ref"]=Or(E):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(m["!fullref"]=m["!ref"],E.e.r=r.sheetRows-1,m["!ref"]=Or(E)),U.length&&(m["!merges"]=U),X.length&&(m["!rows"]=X),A.name=A.||A.name,typeof JSON<"u"&&JSON.stringify(A),h.push(A.name),f[A.name]=m,R=!1):p[0].charAt(p[0].length-2)!=="/"&&(A=Ir(p[0],!1),O=L=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,m=r.dense?[]:{},U=[],X=[],R=!0);break;case"table-row-group":p[1]==="/"?--B:++B;break;case"table-row":case"":if(p[1]==="/"){O+=ge,ge=1;break}if(u=Ir(p[0],!1),u.?O=u.-1:O==-1&&(O=0),ge=+u["number-rows-repeated"]||1,ge<10)for(K=0;K<ge;++K)B>0&&(X[O+K]={level:B});L=-1;break;case"covered-table-cell":p[1]!=="/"&&++L,r.sheetStubs&&(r.dense?(m[O]||(m[O]=[]),m[O][L]={t:"z"}):m[Er({r:O,c:L})]={t:"z"}),b="",k=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++L,x=Ir(p[0],!1),ae=parseInt(x["number-columns-repeated"]||"1",10),g={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(g.f=a3(An(x.formula))),(x.||x["value-type"])=="string"&&(g.t="s",g.v=An(x["string-value"]||""),r.dense?(m[O]||(m[O]=[]),m[O][L]=g):m[Er({r:O,c:L})]=g),L+=ae-1;else if(p[1]!=="/"){++L,b="",w=0,k=[],ae=1;var M=ge?O+ge-1:O;if(L>E.e.c&&(E.e.c=L),L<E.s.c&&(E.s.c=L),O<E.s.r&&(E.s.r=O),M>E.e.r&&(E.e.r=M),x=Ir(p[0],!1),Ie=[],I={},g={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=An(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(F=parseInt(x["number-matrix-rows-spanned"],10)||0,D=parseInt(x["number-matrix-columns-spanned"],10)||0,_={s:{r:O,c:L},e:{r:O+F-1,c:L+D-1}},g.F=Or(_),fe.push([_,g.F])),x.formula)g.f=a3(x.formula);else for(K=0;K<fe.length;++K)O>=fe[K][0].s.r&&O<=fe[K][0].e.r&&L>=fe[K][0].s.c&&L<=fe[K][0].e.c&&(g.F=fe[K][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(F=parseInt(x["number-rows-spanned"],10)||0,D=parseInt(x["number-columns-spanned"],10)||0,_={s:{r:O,c:L},e:{r:O+F-1,c:L+D-1}},U.push(_)),x["number-columns-repeated"]&&(ae=parseInt(x["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=es(x["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(x.value);break;case"percentage":g.t="n",g.v=parseFloat(x.value);break;case"currency":g.t="n",g.v=parseFloat(x.value);break;case"date":g.t="d",g.v=ns(x["date-value"]),r.cellDates||(g.t="n",g.v=xa(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=_ce(x["time-value"])/86400,r.cellDates&&(g.t="d",g.v=X2(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(x.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",x["string-value"]!=null&&(b=An(x["string-value"]),k=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(T=!1,g.t==="s"&&(g.v=b||"",k.length&&(g.R=k),T=w==0),Z.Target&&(g.l=Z),Ie.length>0&&(g.c=Ie,Ie=[]),b&&r.cellText!==!1&&(g.w=b),T&&(g.t="z",delete g.v),(!T||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=O))for(var re=0;re<ge;++re){if(ae=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(m[O+re]||(m[O+re]=[]),m[O+re][L]=re==0?g:ss(g);--ae>0;)m[O+re][L+ae]=ss(g);else for(m[Er({r:O+re,c:L})]=g;--ae>0;)m[Er({r:O+re,c:L+ae})]=ss(g);E.e.c<=L&&(E.e.c=L)}ae=parseInt(x["number-columns-repeated"]||"1",10),L+=ae-1,ae=0,g={},b="",k=[]}Z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i;I.t=b,k.length&&(I.R=k),I.a=j,Ie.push(I)}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);j="",Q=0,b="",w=0,k=[];break;case"creator":p[1]==="/"?j=n.slice(Q,p.index):Q=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);b="",w=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(S[l.name]=c,(i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=Ir(p[0],!1),s.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Ir(p[0],!1),c+=d3[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Ir(p[0],!1),c+=d3[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(d,p.index);break}else d=p.index+p[0].length;break;case"named-range":o=Ir(p[0],!1),ye=lC(o["cell-range-address"]);var de={Name:o.name,Ref:ye[0]+"!"+ye[1]};R&&(de.Sheet=h.length),me.Names.push(de);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(p[1]==="/"&&(!x||!x["string-value"])){var le=Yxe(n.slice(w,p.index));b=(b.length>0?b+`
`:"")+le[0]}else Ir(p[0],!1),w=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ye=lC(Ir(p[0])["target-range-address"]),f[ye[0]]["!autofilter"]={ref:ye[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(Z=Ir(p[0],!1),!Z.href)break;Z.Target=An(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(ye=lC(Z.Target.slice(1)),Z.Target="#"+ye[0]+"!"+ye[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var q={Sheets:f,SheetNames:h,Workbook:me};return r.bookSheets&&delete q.Sheets,q}function A3(t,e){e=e||{},nl(t,"META-INF/manifest.xml")&&_de(Zs(t,"META-INF/manifest.xml"),e);var r=Eo(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=i7(Rn(r),e);return nl(t,"meta.xml")&&(n.Props=J8(Zs(t,"meta.xml"))),n}function u3(t,e){return i7(t,e)}var Zxe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+sx({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Js+e}}(),h3=function(){var t=function(i){return jn(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,l){var c=[];c.push('      <table:table table:name="'+jn(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,A=0,u=no(i["!ref"]||"A1"),f=i["!merges"]||[],h=0,m=Array.isArray(i);if(i["!cols"])for(A=0;A<=u.e.c;++A)c.push("        <table:table-column"+(i["!cols"][A]?' table:style-name="co'+i["!cols"][A].ods+'"':"")+`></table:table-column>
`);var p="",g=i["!rows"]||[];for(d=0;d<u.s.r;++d)p=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;d<=u.e.r;++d){for(p=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+p+`>
`),A=0;A<u.s.c;++A)c.push(e);for(;A<=u.e.c;++A){var x=!1,b={},w="";for(h=0;h!=f.length;++h)if(!(f[h].s.c>A)&&!(f[h].s.r>d)&&!(f[h].e.c<A)&&!(f[h].e.r<d)){(f[h].s.c!=A||f[h].s.r!=d)&&(x=!0),b["table:number-columns-spanned"]=f[h].e.c-f[h].s.c+1,b["table:number-rows-spanned"]=f[h].e.r-f[h].s.r+1;break}if(x){c.push(r);continue}var k=Er({r:d,c:A}),O=m?(i[d]||[])[A]:i[k];if(O&&O.f&&(b["table:formula"]=jn(vme(O.f)),O.F&&O.F.slice(0,k.length)==k)){var L=no(O.F);b["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,b["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!O){c.push(e);continue}switch(O.t){case"b":w=O.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=O.v?"true":"false";break;case"n":w=O.w||String(O.v||0),b["office:value-type"]="float",b["office:value"]=O.v||0;break;case"s":case"str":w=O.v==null?"":O.v,b["office:value-type"]="string";break;case"d":w=O.w||ns(O.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=ns(O.v).toISOString(),b["table:style-name"]="ce1";break;default:c.push(e);continue}var E=t(w);if(O.l&&O.l.Target){var B=O.l.Target;B=B.charAt(0)=="#"?"#"+yme(B.slice(1)):B,B.charAt(0)!="#"&&!B.match(/^\w+:/)&&(B="../"+B),E=Jt("text:a",E,{"xlink:href":B.replace(/&/g,"&amp;")})}c.push("          "+Jt("table:table-cell",Jt("text:p",E,{}),b)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var A=0;A<d["!cols"].length;++A)if(d["!cols"][A]){var u=d["!cols"][A];if(u.width==null&&u.wpx==null&&u.wch==null)continue;uu(u),u.ods=l;var f=d["!cols"][A].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var A=0;A<d["!rows"].length;++A)if(d["!rows"][A]){d["!rows"][A].ods=c;var u=d["!rows"][A].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+u+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Js],d=sx({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),A=sx({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+A+`>
`),c.push(W8().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var u=0;u!=o.SheetNames.length;++u)c.push(n(o.Sheets[o.SheetNames[u]],o,u));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function o7(t,e){if(e.bookType=="fods")return h3(t,e);var r=uI(),n="",s=[],i=[];return n="mimetype",Hr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Hr(r,n,h3(t,e)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Hr(r,n,Zxe(t,e)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Hr(r,n,Js+W8()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Hr(r,n,Sde(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Hr(r,n,Ede(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Vh(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ME(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Rn(Nu(t))}function eve(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):_o(wc(t))}function tve(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function fu(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function f3(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function rve(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function nve(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)t[e+i]=s&255;t[e+15]|=r>=0?0:128}function ux(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function _n(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Ts(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function mn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=ux(t,r),i=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(i){case 0:{for(var c=r[0];t[r[0]++]>=128;);l=t.slice(c,r[0])}break;case 5:o=4,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=ux(t,r),l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var d={data:l,type:i};e[s]==null?e[s]=[d]:e[s].push(d)}return e}function Ma(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(_n(n*8+s.type)),s.type==2&&e.push(_n(s.data.length)),e.push(s.data))})}),fu(e)}function OI(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function el(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=ux(t,n),i=mn(t.slice(n[0],n[0]+s));n[0]+=s;var o={id:Ts(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=mn(l.data),d=Ts(c[3][0].data);o.messages.push({meta:c,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=i[3])!=null&&e[0]&&(o.merge=Ts(i[3][0].data)>>>0>0),r.push(o)}return r}function Lf(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:_n(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:_n(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:_n(o.data.length)}],n[2].push({data:Ma(o.meta),type:2})});var i=Ma(n);e.push(_n(i.length)),e.push(i),s.forEach(function(o){return e.push(o)})}),fu(e)}function sve(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=ux(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=e[r[0]],l>1&&(o|=e[r[0]+1]<<8),l>2&&(o|=e[r[0]+2]<<16),l>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,d=0;if(i==1?(d=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,i==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[fu(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(s.push(s[0].slice(-c)),d-=c;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-c,-c+d))}}var A=fu(s);if(A.length!=n)throw new Error("Unexpected length: ".concat(A.length," != ").concat(n));return A}function tl(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(sve(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return fu(e)}function Uf(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var i=_n(n),o=i.length;e.push(i),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return fu(e)}function ave(t,e,r,n){var s=Vh(t),i=s.getUint32(4,!0),o=(n>1?12:8)+f3(i&(n>1?3470:398))*4,l=-1,c=-1,d=NaN,A=new Date(2001,0,1);i&512&&(l=s.getUint32(o,!0),o+=4),o+=f3(i&(n>1?12288:4096))*4,i&16&&(c=s.getUint32(o,!0),o+=4),i&32&&(d=s.getFloat64(o,!0),o+=8),i&64&&(A.setTime(A.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var u;switch(t[2]){case 0:break;case 2:u={t:"n",v:d};break;case 3:u={t:"s",v:e[c]};break;case 5:u={t:"d",v:A};break;case 6:u={t:"b",v:d>0};break;case 7:u={t:"n",v:d/86400};break;case 8:u={t:"e",v:0};break;case 9:if(l>-1)u={t:"s",v:r[l]};else if(c>-1)u={t:"s",v:e[c]};else if(!isNaN(d))u={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return u}function ive(t,e,r){var n=Vh(t),s=n.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,d=NaN,A=new Date(2001,0,1);s&1&&(c=rve(t,i),i+=16),s&2&&(d=n.getFloat64(i,!0),i+=8),s&4&&(A.setTime(A.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(l=n.getUint32(i,!0),i+=4),s&16&&(o=n.getUint32(i,!0),i+=4);var u;switch(t[1]){case 0:break;case 2:u={t:"n",v:c};break;case 3:u={t:"s",v:e[l]};break;case 5:u={t:"d",v:A};break;case 6:u={t:"b",v:d>0};break;case 7:u={t:"n",v:d/86400};break;case 8:u={t:"e",v:0};break;case 9:if(o>-1)u={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:u={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return u}function dC(t,e){var r=new Uint8Array(32),n=Vh(r),s=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,nve(r,s,t.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),i|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,i,!0),r.slice(0,s)}function AC(t,e){var r=new Uint8Array(32),n=Vh(r),s=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),i|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,i,!0),r.slice(0,s)}function ove(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return ave(t,e,r,t[0]);case 5:return ive(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Ai(t){var e=mn(t);return ux(e[1][0].data)}function m3(t,e){var r=mn(e.data),n=Ts(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(o){var l=mn(o.data),c=Ts(l[1][0].data)>>>0;switch(n){case 1:i[c]=ME(l[3][0].data);break;case 8:{var d=t[Ai(l[9][0].data)][0],A=mn(d.data),u=t[Ai(A[1][0].data)][0],f=Ts(u.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var h=mn(u.data);i[c]=h[3].map(function(m){return ME(m.data)}).join("")}break}}),i}function lve(t,e){var r,n,s,i,o,l,c,d,A,u,f,h,m,p,g=mn(t),x=Ts(g[1][0].data)>>>0,b=Ts(g[2][0].data)>>>0,w=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&Ts(g[8][0].data)>0||!1,k,O;if((i=(s=g[7])==null?void 0:s[0])!=null&&i.data&&e!=0)k=(l=(o=g[7])==null?void 0:o[0])==null?void 0:l.data,O=(d=(c=g[6])==null?void 0:c[0])==null?void 0:d.data;else if((u=(A=g[4])==null?void 0:A[0])!=null&&u.data&&e!=1)k=(h=(f=g[4])==null?void 0:f[0])==null?void 0:h.data,O=(p=(m=g[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var L=w?4:1,E=Vh(k),B=[],S=0;S<k.length/2;++S){var U=E.getUint16(S*2,!0);U<65535&&B.push([S,U])}if(B.length!=b)throw"Expected ".concat(b," cells, found ").concat(B.length);var _=[];for(S=0;S<B.length-1;++S)_[B[S][0]]=O.subarray(B[S][1]*L,B[S+1][1]*L);return B.length>=1&&(_[B[B.length-1][0]]=O.subarray(B[B.length-1][1]*L)),{R:x,cells:_}}function cve(t,e){var r,n=mn(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Ts(n[7][0].data)>>>0>0?1:0:-1,i=OI(n[5],function(o){return lve(o,s)});return{nrows:Ts(n[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,d){if(o[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));o[l.R][d]=c}),o},[])}}function dve(t,e,r){var n,s=mn(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Ts(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Ts(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Or(i);var o=mn(s[4][0].data),l=m3(t,t[Ai(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?m3(t,t[Ai(o[17][0].data)][0]):[],d=mn(o[3][0].data),A=0;d[1].forEach(function(u){var f=mn(u.data),h=t[Ai(f[2][0].data)][0],m=Ts(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=cve(t,h);p.data.forEach(function(g,x){g.forEach(function(b,w){var k=Er({r:A+x,c:w}),O=ove(b,l,c);O&&(r[k]=O)})}),A+=p.nrows})}function Ave(t,e){var r=mn(e.data),n={"!ref":"A1"},s=t[Ai(r[2][0].data)],i=Ts(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return dve(t,s[0],n),n}function uve(t,e){var r,n=mn(e.data),s={name:(r=n[1])!=null&&r[0]?ME(n[1][0].data):"",sheets:[]},i=OI(n[2],Ai);return i.forEach(function(o){t[o].forEach(function(l){var c=Ts(l.meta[1][0].data);c==6e3&&s.sheets.push(Ave(t,l))})}),s}function hve(t,e){var r=KI(),n=mn(e.data),s=OI(n[1],Ai);if(s.forEach(function(i){t[i].forEach(function(o){var l=Ts(o.meta[1][0].data);if(l==2){var c=uve(t,o);c.sheets.forEach(function(d,A){qI(r,d,A==0?c.name:c.name+"_"+A,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function uC(t){var e,r,n,s,i={},o=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=tl(c.content)}catch(u){return console.log("?? "+c.content.length+" "+(u.message||u))}var A;try{A=el(d)}catch(u){return console.log("## "+(u.message||u))}A.forEach(function(u){i[u.id]=u.messages,o.push(u.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Ts(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(d){var A=Ts(d.meta[1][0].data)>>>0;if(A==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return hve(i,l)}function fve(t,e,r){var n,s,i,o;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=t[8])==null?void 0:i[0])==null?void 0:o.data)&&Ts(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=Vh(t[7][0].data),A=0,u=[],f=Vh(t[4][0].data),h=0,m=[],p=0;p<e.length;++p){if(e[p]==null){d.setUint16(p*2,65535,!0),f.setUint16(p*2,65535);continue}d.setUint16(p*2,A,!0),f.setUint16(p*2,h,!0);var g,x;switch(typeof e[p]){case"string":g=dC({t:"s",v:e[p]},r),x=AC({t:"s",v:e[p]},r);break;case"number":g=dC({t:"n",v:e[p]},r),x=AC({t:"n",v:e[p]},r);break;case"boolean":g=dC({t:"b",v:e[p]},r),x=AC({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}u.push(g),A+=g.length,m.push(x),h+=x.length,++c}for(t[2][0].data=_n(c);p<t[7][0].data.length/2;++p)d.setUint16(p*2,65535,!0),f.setUint16(p*2,65535,!0);return t[6][0].data=fu(u),t[3][0].data=fu(m),c}function mve(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=no(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Or(n)));var i=Ob(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(j){return j.forEach(function(Q){typeof Q=="string"&&o.push(Q)})});var l={},c=[],d=wr.read(e.numbers,{type:"base64"});d.FileIndex.map(function(j,Q){return[j,d.FullPaths[Q]]}).forEach(function(j){var Q=j[0],T=j[1];if(Q.type==2&&Q.name.match(/\.iwa/)){var R=Q.content,K=tl(R),M=el(K);M.forEach(function(re){c.push(re.id),l[re.id]={deps:[],location:T,type:Ts(re.messages[0].meta[1][0].data)}})}}),c.sort(function(j,Q){return j-Q});var A=c.filter(function(j){return j>1}).map(function(j){return[j,_n(j)]});d.FileIndex.map(function(j,Q){return[j,d.FullPaths[Q]]}).forEach(function(j){var Q=j[0];if(j[1],!!Q.name.match(/\.iwa/)){var T=el(tl(Q.content));T.forEach(function(R){R.messages.forEach(function(K){A.forEach(function(M){R.messages.some(function(re){return Ts(re.meta[1][0].data)!=11006&&tve(re.data,M[1])})&&l[M[0]].deps.push(R.id)})})})}});for(var u=wr.find(d,l[1].location),f=el(tl(u.content)),h,m=0;m<f.length;++m){var p=f[m];p.id==1&&(h=p)}var g=Ai(mn(h.messages[0].data)[1][0].data);for(u=wr.find(d,l[g].location),f=el(tl(u.content)),m=0;m<f.length;++m)p=f[m],p.id==g&&(h=p);for(g=Ai(mn(h.messages[0].data)[2][0].data),u=wr.find(d,l[g].location),f=el(tl(u.content)),m=0;m<f.length;++m)p=f[m],p.id==g&&(h=p);for(g=Ai(mn(h.messages[0].data)[2][0].data),u=wr.find(d,l[g].location),f=el(tl(u.content)),m=0;m<f.length;++m)p=f[m],p.id==g&&(h=p);var x=mn(h.messages[0].data);{x[6][0].data=_n(n.e.r+1),x[7][0].data=_n(n.e.c+1);var b=Ai(x[46][0].data),w=wr.find(d,l[b].location),k=el(tl(w.content));{for(var O=0;O<k.length&&k[O].id!=b;++O);if(k[O].id!=b)throw"Bad ColumnRowUIDMapArchive";var L=mn(k[O].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var E=0;E<=n.e.c;++E){var B=[];B[1]=B[2]=[{type:0,data:_n(E+420690)}],L[1].push({type:2,data:Ma(B)}),L[2].push({type:0,data:_n(E)}),L[3].push({type:0,data:_n(E)})}L[4]=[],L[5]=[],L[6]=[];for(var S=0;S<=n.e.r;++S)B=[],B[1]=B[2]=[{type:0,data:_n(S+726270)}],L[4].push({type:2,data:Ma(B)}),L[5].push({type:0,data:_n(S)}),L[6].push({type:0,data:_n(S)});k[O].messages[0].data=Ma(L)}w.content=Uf(Lf(k)),w.size=w.content.length,delete x[46];var U=mn(x[4][0].data);{U[7][0].data=_n(n.e.r+1);var _=mn(U[1][0].data),F=Ai(_[2][0].data);w=wr.find(d,l[F].location),k=el(tl(w.content));{if(k[0].id!=F)throw"Bad HeaderStorageBucket";var D=mn(k[0].messages[0].data);for(S=0;S<i.length;++S){var X=mn(D[2][0].data);X[1][0].data=_n(S),X[4][0].data=_n(i[S].length),D[2][S]={type:D[2][0].type,data:Ma(X)}}k[0].messages[0].data=Ma(D)}w.content=Uf(Lf(k)),w.size=w.content.length;var ge=Ai(U[2][0].data);w=wr.find(d,l[ge].location),k=el(tl(w.content));{if(k[0].id!=ge)throw"Bad HeaderStorageBucket";for(D=mn(k[0].messages[0].data),E=0;E<=n.e.c;++E)X=mn(D[2][0].data),X[1][0].data=_n(E),X[4][0].data=_n(n.e.r+1),D[2][E]={type:D[2][0].type,data:Ma(X)};k[0].messages[0].data=Ma(D)}w.content=Uf(Lf(k)),w.size=w.content.length;var ae=Ai(U[4][0].data);(function(){for(var j=wr.find(d,l[ae].location),Q=el(tl(j.content)),T,R=0;R<Q.length;++R){var K=Q[R];K.id==ae&&(T=K)}var M=mn(T.messages[0].data);{M[3]=[];var re=[];o.forEach(function(q,Se){re[1]=[{type:0,data:_n(Se)}],re[2]=[{type:0,data:_n(1)}],re[3]=[{type:2,data:eve(q)}],M[3].push({type:2,data:Ma(re)})})}T.messages[0].data=Ma(M);var de=Lf(Q),le=Uf(de);j.content=le,j.size=j.content.length})();var fe=mn(U[3][0].data);{var me=fe[1][0];delete fe[2];var Z=mn(me.data);{var ye=Ai(Z[2][0].data);(function(){for(var j=wr.find(d,l[ye].location),Q=el(tl(j.content)),T,R=0;R<Q.length;++R){var K=Q[R];K.id==ye&&(T=K)}var M=mn(T.messages[0].data);{delete M[6],delete fe[7];var re=new Uint8Array(M[5][0].data);M[5]=[];for(var de=0,le=0;le<=n.e.r;++le){var q=mn(re);de+=fve(q,i[le],o),q[1][0].data=_n(le),M[5].push({data:Ma(q),type:2})}M[1]=[{type:0,data:_n(n.e.c+1)}],M[2]=[{type:0,data:_n(n.e.r+1)}],M[3]=[{type:0,data:_n(de)}],M[4]=[{type:0,data:_n(n.e.r+1)}]}T.messages[0].data=Ma(M);var Se=Lf(Q),ee=Uf(Se);j.content=ee,j.size=j.content.length})()}me.data=Ma(Z)}U[3][0].data=Ma(fe)}x[4][0].data=Ma(U)}h.messages[0].data=Ma(x);var Ie=Lf(f),I=Uf(Ie);return u.content=I,u.size=u.content.length,d}function l7(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function MI(t){l7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function QI(t){l7([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function pve(t){return $r.WS.indexOf(t)>-1?"sheet":t==$r.CS?"chart":t==$r.DS?"dialog":t==$r.MS?"macro":t&&t.length?t:"sheet"}function gve(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,pve(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function xve(t,e,r,n,s,i,o,l,c,d,A,u){try{i[n]=og(Eo(t,r,!0),e);var f=Zs(t,e),h;switch(l){case"sheet":h=Mge(f,e,s,c,i[n],d,A,u);break;case"chart":if(h=Qge(f,e,s,c,i[n],d,A,u),!h||!h["!drawel"])break;var m=Ip(h["!drawel"].Target,e),p=ix(m),g=Bfe(Eo(t,m,!0),og(Eo(t,p,!0),m)),x=Ip(g,m),b=ix(x);h=fge(Eo(t,x,!0),x,c,og(Eo(t,b,!0),x),d,h);break;case"macro":h=Vge(f,e,s,c,i[n],d,A,u);break;case"dialog":h=Hge(f,e,s,c,i[n],d,A,u);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=h;var w=[];i&&i[n]&&Rs(i[n]).forEach(function(k){var O="";if(i[n][k].Type==$r.CMNT){O=Ip(i[n][k].Target,e);var L=$ge(Zs(t,O,!0),O,c);if(!L||!L.length)return;e3(h,L,!1)}i[n][k].Type==$r.TCMNT&&(O=Ip(i[n][k].Target,e),w=w.concat(Ife(Zs(t,O,!0),c)))}),w&&w.length&&e3(h,w,!0,c.people||[])}catch(k){if(c.WTF)throw k}}function Jo(t){return t.charAt(0)=="/"?t.slice(1):t}function vve(t,e){if(um(),e=e||{},MI(e),nl(t,"META-INF/manifest.xml")||nl(t,"objectdata.xml"))return A3(t,e);if(nl(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof uC<"u"){if(t.FileIndex)return uC(t);var r=wr.utils.cfb_new();return bP(t).forEach(function(X){Hr(r,X,jce(t,X))}),uC(r)}throw new Error("Unsupported NUMBERS file")}if(!nl(t,"[Content_Types].xml"))throw nl(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):nl(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=bP(t),s=Nde(Eo(t,"[Content_Types].xml")),i=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",Zs(t,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!Zs(t,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},d={};if(!e.bookSheets&&!e.bookProps){if(lg=[],s.sst)try{lg=Gge(Zs(t,Jo(s.sst)),s.sst,e)}catch(X){if(e.WTF)throw X}e.cellStyles&&s.themes.length&&(c=qge(Eo(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(d=Kge(Zs(t,Jo(s.style)),s.style,c,e))}s.links.map(function(X){try{var ge=og(Eo(t,ix(Jo(X))),X);return Wge(Zs(t,Jo(X)),ge,X,e)}catch{}});var A=Oge(Zs(t,Jo(s.workbooks[0])),s.workbooks[0],e),u={},f="";s.coreprops.length&&(f=Zs(t,Jo(s.coreprops[0]),!0),f&&(u=J8(f)),s.extprops.length!==0&&(f=Zs(t,Jo(s.extprops[0]),!0),f&&jde(f,u,e)));var h={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(f=Eo(t,Jo(s.custprops[0]),!0),f&&(h=Fde(f,e)));var m={};if((e.bookSheets||e.bookProps)&&(A.Sheets?o=A.Sheets.map(function(ge){return ge.name}):u.Worksheets&&u.SheetNames.length>0&&(o=u.SheetNames),e.bookProps&&(m.Props=u,m.Custprops=h),e.bookSheets&&typeof o<"u"&&(m.SheetNames=o),e.bookSheets?m.SheetNames:e.bookProps))return m;o={};var p={};e.bookDeps&&s.calcchain&&(p=zge(Zs(t,Jo(s.calcchain)),s.calcchain));var g=0,x={},b,w;{var k=A.Sheets;u.Worksheets=k.length,u.SheetNames=[];for(var O=0;O!=k.length;++O)u.SheetNames[O]=k[O].name}var L=i?"bin":"xml",E=s.workbooks[0].lastIndexOf("/"),B=(s.workbooks[0].slice(0,E+1)+"_rels/"+s.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");nl(t,B)||(B="xl/_rels/workbook."+L+".rels");var S=og(Eo(t,B,!0),B.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=Jge(Zs(t,Jo(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=kfe(Zs(t,Jo(s.people[0])),e)),S&&(S=gve(S,A.Sheets));var U=Zs(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=u.Worksheets;++g){var _="sheet";if(S&&S[g]?(b="xl/"+S[g][1].replace(/[\/]?xl\//,""),nl(t,b)||(b=S[g][1]),nl(t,b)||(b=B.replace(/_rels\/.*$/,"")+S[g][1]),_=S[g][2]):(b="xl/worksheets/sheet"+(g+1-U)+"."+L,b=b.replace(/sheet0\./,"sheet.")),w=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(g!=e.sheets)continue e;break;case"string":if(u.SheetNames[g].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var F=!1,D=0;D!=e.sheets.length;++D)typeof e.sheets[D]=="number"&&e.sheets[D]==g&&(F=1),typeof e.sheets[D]=="string"&&e.sheets[D].toLowerCase()==u.SheetNames[g].toLowerCase()&&(F=1);if(!F)continue e}}xve(t,b,w,u.SheetNames[g],g,x,o,_,e,A,c,d)}return m={Directory:s,Workbook:A,Props:u,Custprops:h,Deps:p,Sheets:o,SheetNames:u.SheetNames,Strings:lg,Styles:d,Themes:c,SSF:ss(_r)},e&&e.bookFiles&&(t.files?(m.keys=n,m.files=t.files):(m.keys=[],m.files={},t.FullPaths.forEach(function(X,ge){X=X.replace(/^Root Entry[\/]/,""),m.keys.push(X),m.files[X]=t.FileIndex[ge]}))),e&&e.bookVBA&&(s.vba.length>0?m.vbaraw=Zs(t,Jo(s.vba[0]),!0):s.defaults&&s.defaults.bin===Ofe&&(m.vbaraw=Zs(t,"xl/vbaProject.bin",!0))),m}function yve(t,e){var r=e||{},n="Workbook",s=wr.find(t,n);try{if(n="/!DataSpaces/Version",s=wr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Jue(s.content),n="/!DataSpaces/DataSpaceMap",s=wr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Yue(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=wr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Zue(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=wr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);the(s.content)}catch{}if(n="/EncryptionInfo",s=wr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=rhe(s.content);if(n="/EncryptedPackage",s=wr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function bve(t,e){return e.bookType=="ods"?o7(t,e):e.bookType=="numbers"?mve(t,e):e.bookType=="xlsb"?wve(t,e):Nve(t,e)}function wve(t,e){d0=1024,t&&!t.SSF&&(t.SSF=ss(_r)),t&&t.SSF&&(um(),z2(t.SSF),e.revssf=J2(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,cg?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=RQ.indexOf(e.bookType)>-1,s=EI();QI(e=e||{});var i=uI(),o="",l=0;if(e.cellXfs=[],_u(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Hr(i,o,X8(t.Props,e)),s.coreprops.push(o),Bn(e.rels,2,o,$r.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(t.SheetNames[d]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Hr(i,o,eQ(t.Props)),s.extprops.push(o),Bn(e.rels,3,o,$r.EXT_PROPS),t.Custprops!==t.Props&&Rs(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Hr(i,o,tQ(t.Custprops)),s.custprops.push(o),Bn(e.rels,4,o,$r.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var A={"!id":{}},u=t.Sheets[t.SheetNames[l-1]],f=(u||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Hr(i,o,Yge(l-1,o,e,t,A)),s.sheets.push(o),Bn(e.wbrels,-1,"worksheets/sheet"+l+"."+r,$r.WS[0])}if(u){var h=u["!comments"],m=!1,p="";h&&h.length>0&&(p="xl/comments"+l+"."+r,Hr(i,p,txe(h,p)),s.comments.push(p),Bn(A,-1,"../comments"+l+"."+r,$r.CMNT),m=!0),u["!legacy"]&&m&&Hr(i,"xl/drawings/vmlDrawing"+l+".vml",TQ(l,u["!comments"])),delete u["!comments"],delete u["!legacy"]}A["!id"].rId1&&Hr(i,ix(o),N0(A))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Hr(i,o,exe(e.Strings,o,e)),s.strs.push(o),Bn(e.wbrels,-1,"sharedStrings."+r,$r.SST)),o="xl/workbook."+r,Hr(i,o,Xge(t,o)),s.workbooks.push(o),Bn(e.rels,1,o,$r.WB),o="xl/theme/theme1.xml",Hr(i,o,FI(t.Themes,e)),s.themes.push(o),Bn(e.wbrels,-1,"theme/theme1.xml",$r.THEME),o="xl/styles."+r,Hr(i,o,Zge(t,o,e)),s.styles.push(o),Bn(e.wbrels,-1,"styles."+r,$r.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Hr(i,o,t.vbaraw),s.vba.push(o),Bn(e.wbrels,-1,"vbaProject.bin",$r.VBA)),o="xl/metadata."+r,Hr(i,o,rxe(o)),s.metadata.push(o),Bn(e.wbrels,-1,"metadata."+r,$r.XLMETA),Hr(i,"[Content_Types].xml",z8(s,e)),Hr(i,"_rels/.rels",N0(e.rels)),Hr(i,"xl/_rels/workbook."+r+".rels",N0(e.wbrels)),delete e.revssf,delete e.ssf,i}function Nve(t,e){d0=1024,t&&!t.SSF&&(t.SSF=ss(_r)),t&&t.SSF&&(um(),z2(t.SSF),e.revssf=J2(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,cg?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=RQ.indexOf(e.bookType)>-1,s=EI();QI(e=e||{});var i=uI(),o="",l=0;if(e.cellXfs=[],_u(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Hr(i,o,X8(t.Props,e)),s.coreprops.push(o),Bn(e.rels,2,o,$r.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(t.SheetNames[d]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Hr(i,o,eQ(t.Props)),s.extprops.push(o),Bn(e.rels,3,o,$r.EXT_PROPS),t.Custprops!==t.Props&&Rs(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Hr(i,o,tQ(t.Custprops)),s.custprops.push(o),Bn(e.rels,4,o,$r.CUST_PROPS));var A=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var u={"!id":{}},f=t.Sheets[t.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Hr(i,o,GQ(l-1,e,t,u)),s.sheets.push(o),Bn(e.wbrels,-1,"worksheets/sheet"+l+"."+r,$r.WS[0])}if(f){var m=f["!comments"],p=!1,g="";if(m&&m.length>0){var x=!1;m.forEach(function(b){b[1].forEach(function(w){w.T==!0&&(x=!0)})}),x&&(g="xl/threadedComments/threadedComment"+l+"."+r,Hr(i,g,jfe(m,A,e)),s.threadedcomments.push(g),Bn(u,-1,"../threadedComments/threadedComment"+l+"."+r,$r.TCMNT)),g="xl/comments"+l+"."+r,Hr(i,g,PQ(m)),s.comments.push(g),Bn(u,-1,"../comments"+l+"."+r,$r.CMNT),p=!0}f["!legacy"]&&p&&Hr(i,"xl/drawings/vmlDrawing"+l+".vml",TQ(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&Hr(i,ix(o),N0(u))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Hr(i,o,bQ(e.Strings,e)),s.strs.push(o),Bn(e.wbrels,-1,"sharedStrings."+r,$r.SST)),o="xl/workbook."+r,Hr(i,o,XQ(t)),s.workbooks.push(o),Bn(e.rels,1,o,$r.WB),o="xl/theme/theme1.xml",Hr(i,o,FI(t.Themes,e)),s.themes.push(o),Bn(e.wbrels,-1,"theme/theme1.xml",$r.THEME),o="xl/styles."+r,Hr(i,o,IQ(t,e)),s.styles.push(o),Bn(e.wbrels,-1,"styles."+r,$r.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Hr(i,o,t.vbaraw),s.vba.push(o),Bn(e.wbrels,-1,"vbaProject.bin",$r.VBA)),o="xl/metadata."+r,Hr(i,o,FQ()),s.metadata.push(o),Bn(e.wbrels,-1,"metadata."+r,$r.XLMETA),A.length>1&&(o="xl/persons/person.xml",Hr(i,o,Ffe(A)),s.people.push(o),Bn(e.wbrels,-1,"persons/person.xml",$r.PEOPLE)),Hr(i,"[Content_Types].xml",z8(s,e)),Hr(i,"_rels/.rels",N0(e.rels)),Hr(i,"xl/_rels/workbook."+r+".rels",N0(e.wbrels)),delete e.revssf,delete e.ssf,i}function VI(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Po(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Cve(t,e){return wr.find(t,"EncryptedPackage")?yve(t,e):t7(t,e)}function _ve(t,e){var r,n=t,s=e||{};return s.type||(s.type=Kr&&Buffer.isBuffer(t)?"buffer":"base64"),r=N8(n,s),vve(r,s)}function c7(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return UE(t.slice(r),e);default:break e}return G0.to_workbook(t,e)}function Eve(t,e){var r="",n=VI(t,e);switch(e.type){case"base64":r=Po(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Uh(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Rn(r)),e.type="binary",c7(r,e)}function Bve(t,e){var r=t;return e.type=="base64"&&(r=Po(r)),r=ex.utils.decode(1200,r.slice(2),"str"),e.type="binary",c7(r,e)}function Sve(t){return t.match(/[^\x00-\x7F]/)?wc(t):t}function hC(t,e,r,n){return n?(r.type="string",G0.to_workbook(t,r)):G0.to_workbook(e,r)}function QE(t,e){oI();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return QE(new Uint8Array(t),(r=ss(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),_0={},r.dateNF&&(_0.dateNF=r.dateNF),r.type||(r.type=Kr&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Kr?"buffer":"binary",n=wce(t),typeof Uint8Array<"u"&&!Kr&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=Sve(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=ss(r),r.type="array",QE(lI(n),r)}switch((s=VI(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Cve(wr.read(n,r),r);break;case 9:if(s[1]<=8)return t7(n,r);break;case 60:return UE(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return Tue(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return vQ.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?_ve(n,r):hC(t,n,r,i);case 239:return s[3]===60?UE(n,r):hC(t,n,r,i);case 255:if(s[1]===254)return Bve(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return vh.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return vh.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return LE.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return EQ.to_workbook(n,r);break;case 10:case 13:case 32:return Eve(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Fue.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?LE.to_workbook(n,r):hC(t,n,r,i)}function d7(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Hx(e.file,wr.write(t,{type:Kr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return wr.write(t,e)}function Ive(t,e){var r=ss(e||{}),n=bve(t,r);return jve(n,r)}function jve(t,e){var r={},n=Kr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?wr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array($2(s))}return e.password&&typeof encrypt_agile<"u"?d7(encrypt_agile(s,e.password),e):e.type==="file"?Hx(e.file,s):e.type=="string"?Rn(s):s}function kve(t,e){var r=e||{},n=Sxe(t,r);return d7(n,r)}function mc(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return tx(wc(n));case"binary":return wc(n);case"string":return t;case"file":return Hx(e.file,n,"utf8");case"buffer":return Kr?Rd(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):mc(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Fve(t,e){switch(e.type){case"base64":return tx(t);case"binary":return t;case"string":return t;case"file":return Hx(e.file,t,"binary");case"buffer":return Kr?Rd(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function R1(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?tx(r):e.type=="string"?Rn(r):r;case"file":return Hx(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function A7(t,e){oI(),Cge(t);var r=ss(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=A7(t,r);return r.type="array",$2(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return mc(bxe(t,r),r);case"slk":case"sylk":return mc(xQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return mc(n7(t.Sheets[t.SheetNames[s]],r),r);case"txt":return Fve(u7(t.Sheets[t.SheetNames[s]],r),r);case"csv":return mc(HI(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return mc(vQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return R1(LE.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return mc(G0.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return mc(EQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return mc(yQ.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return mc(o7(t,r),r);case"wk1":return R1(vh.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return R1(vh.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),R1(r7(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),kve(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Ive(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Tve(t,e,r,n,s,i,o,l){var c=zs(r),d=l.defval,A=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),u=!0,f=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||t[r])for(var h=e.s.c;h<=e.e.c;++h){var m=o?t[r][h]:t[n[h]+c];if(m===void 0||m.t===void 0){if(d===void 0)continue;i[h]!=null&&(f[i[h]]=d);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(i[h]!=null){if(p==null)if(m.t=="e"&&p===null)f[i[h]]=null;else if(d!==void 0)f[i[h]]=d;else if(A&&p===null)f[i[h]]=null;else continue;else f[i[h]]=A&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?p:kd(m,p,l);p!=null&&(u=!1)}}return{row:f,isempty:u}}function Ob(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},A=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof A){case"string":c=hn(A);break;case"number":c=hn(t["!ref"]),c.s.r=A;break;default:c=A}n>0&&(s=0);var u=zs(c.s.r),f=[],h=[],m=0,p=0,g=Array.isArray(t),x=c.s.r,b=0,w={};g&&!t[x]&&(t[x]=[]);var k=d.skipHidden&&t["!cols"]||[],O=d.skipHidden&&t["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(k[b]||{}).hidden)switch(f[b]=ws(b),r=g?t[x][b]:t[f[b]+u],n){case 1:i[b]=b-c.s.c;break;case 2:i[b]=f[b];break;case 3:i[b]=d.header[b-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=kd(r,null,d),p=w[o]||0,!p)w[o]=1;else{do l=o+"_"+p++;while(w[l]);w[o]=p,w[l]=1}i[b]=l}for(x=c.s.r+s;x<=c.e.r;++x)if(!(O[x]||{}).hidden){var L=Tve(t,c,x,f,n,i,g,d);(L.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(h[m++]=L.row)}return h.length=m,h}var p3=/"/g;function Pve(t,e,r,n,s,i,o,l){for(var c=!0,d=[],A="",u=zs(r),f=e.s.c;f<=e.e.c;++f)if(n[f]){var h=l.dense?(t[r]||[])[f]:t[n[f]+u];if(h==null)A="";else if(h.v!=null){c=!1,A=""+(l.rawNumbers&&h.t=="n"?h.v:kd(h,null,l));for(var m=0,p=0;m!==A.length;++m)if((p=A.charCodeAt(m))===s||p===i||p===34||l.forceQuotes){A='"'+A.replace(p3,'""')+'"';break}A=="ID"&&(A='"ID"')}else h.f!=null&&!h.F?(c=!1,A="="+h.f,A.indexOf(",")>=0&&(A='"'+A.replace(p3,'""')+'"')):A="";d.push(A)}return l.blankrows===!1&&c?null:d.join(o)}function HI(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=hn(t["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),A="",u=[];n.dense=Array.isArray(t);for(var f=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],m=s.s.c;m<=s.e.c;++m)(f[m]||{}).hidden||(u[m]=ws(m));for(var p=0,g=s.s.r;g<=s.e.r;++g)(h[g]||{}).hidden||(A=Pve(t,s,g,u,o,c,i,n),A!=null&&(n.strip&&(A=A.replace(d,"")),(A||n.blankrows!==!1)&&r.push((p++?l:"")+A)));return delete n.dense,r.join("")}function u7(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=HI(t,e);return r}function Rve(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=hn(t["!ref"]),i="",o=[],l,c=[],d=Array.isArray(t);for(l=s.s.c;l<=s.e.c;++l)o[l]=ws(l);for(var A=s.s.r;A<=s.e.r;++A)for(i=zs(A),l=s.s.c;l<=s.e.c;++l)if(e=o[l]+i,r=d?(t[A]||[])[l]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function h7(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},o=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Ns(n.origin):n.origin;o=c.r,l=c.c}var d,A={s:{c:0,r:0},e:{c:l,r:o+e.length-1+s}};if(i["!ref"]){var u=hn(i["!ref"]);A.e.c=Math.max(A.e.c,u.e.c),A.e.r=Math.max(A.e.r,u.e.r),o==-1&&(o=u.e.r+1,A.e.r=o+e.length-1+s)}else o==-1&&(o=0,A.e.r=e.length-1+s);var f=n.header||[],h=0;e.forEach(function(p,g){Rs(p).forEach(function(x){(h=f.indexOf(x))==-1&&(f[h=f.length]=x);var b=p[x],w="z",k="",O=Er({c:l+h,r:o+g+s});d=hx(i,O),b&&typeof b=="object"&&!(b instanceof Date)?i[O]=b:(typeof b=="number"?w="n":typeof b=="boolean"?w="b":typeof b=="string"?w="s":b instanceof Date?(w="d",n.cellDates||(w="n",b=xa(b)),k=n.dateNF||_r[14]):b===null&&n.nullError&&(w="e",b=0),d?(d.t=w,d.v=b,delete d.w,delete d.R,k&&(d.z=k)):i[O]=d={t:w,v:b},k&&(d.z=k))})}),A.e.c=Math.max(A.e.c,l+f.length-1);var m=zs(o);if(s)for(h=0;h<f.length;++h)i[ws(h+l)+m]={t:"s",v:f[h]};return i["!ref"]=Or(A),i}function Dve(t,e){return h7(null,t,e)}function hx(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Ns(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?hx(t,Er(e)):hx(t,Er({r:e,c:r||0}))}function Lve(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function KI(){return{SheetNames:[],Sheets:{}}}function qI(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=o+s)!=-1;++s);}if(JQ(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function Uve(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Lve(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Ove(t,e){return t.z=e,t}function f7(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function Mve(t,e,r){return f7(t,"#"+e,r)}function Qve(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Vve(t,e,r,n){for(var s=typeof e!="string"?e:hn(e),i=typeof e=="string"?e:Or(e),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=hx(t,o,l);c.t="n",c.F=i,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return t}var D1={encode_col:ws,encode_row:zs,encode_cell:Er,encode_range:Or,decode_col:yI,decode_row:vI,split_cell:ede,decode_cell:Ns,decode_range:no,format_cell:kd,sheet_add_aoa:Q8,sheet_add_json:h7,sheet_add_dom:s7,aoa_to_sheet:hm,json_to_sheet:Dve,table_to_sheet:a7,table_to_book:Jxe,sheet_to_csv:HI,sheet_to_txt:u7,sheet_to_json:Ob,sheet_to_html:n7,sheet_to_formulae:Rve,sheet_to_row_object_array:Ob,sheet_get_cell:hx,book_new:KI,book_append_sheet:qI,book_set_sheet_visibility:Uve,cell_set_number_format:Ove,cell_set_hyperlink:f7,cell_set_internal_link:Mve,cell_add_comment:Qve,sheet_set_array_formula:Vve,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Hve=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function $n(t){return String(t??"").trim().replace(/\s+/g," ").toLowerCase()}function gA(t,e=0){const r=Number(String(t??"").replace(",","."));return Number.isFinite(r)?r:e}function Ou(t,e=1){const r=Math.floor(gA(t,e));return r>0?r:e}function Kve(t){return Object.values(t||{}).every(r=>$n(r)==="")}function lp(t,e){const r=Object.keys(t||{}),n=new Map;r.forEach(s=>n.set($n(s),s));for(const s of e){const i=n.get($n(s));if(i!=null)return t[i]}}function qve(){const{refreshKey:t,refresh:e}=vl(),[r,n]=N.useState(!0),[s,i]=N.useState(""),[o,l]=N.useState([]),[c,d]=N.useState(""),[A,u]=N.useState(""),[f,h]=N.useState(0),[m,p]=N.useState(1),[g,x]=N.useState(null),[b,w]=N.useState(""),[k,O]=N.useState(""),[L,E]=N.useState(0),[B,S]=N.useState(1),[U,_]=N.useState(""),[F,D]=N.useState(!1),[X,ge]=N.useState(""),[ae,fe]=N.useState([]),[me,Z]=N.useState([]),[ye,Ie]=N.useState(!1);N.useEffect(()=>{(async()=>{n(!0),i("");try{const te=await Nt(Dt(ht(Te,"products_candies"),Ur("name","asc"))),Ne=[];te.forEach(Y=>{const we=Y.data();Ne.push({id:Y.id,name:we.name||"",category:we.category||"",providerPrice:Number(we.providerPrice||0),unitsPerPackage:Number(we.unitsPerPackage||1),createdAt:we.createdAt})}),l(Ne)}catch(te){console.error(te),i(" Error cargando catlogo de dulces.")}finally{n(!1)}})()},[t]);const I=N.useMemo(()=>{const te=$n(U);return te?o.filter(Ne=>`${Ne.category} ${Ne.name}`.toLowerCase().includes(te)):o},[o,U]),j=N.useMemo(()=>{const te=new Set;return o.forEach(Ne=>{const Y=String(Ne.category||"").trim();Y&&te.add(Y)}),Array.from(te).sort((Ne,Y)=>Ne.localeCompare(Y,"es"))},[o]),Q=()=>{d(""),u(""),h(0),p(1)},T=async te=>{te.preventDefault(),i("");const Ne=String(c||"").trim(),Y=String(A||"").trim(),we=Math.max(0,gA(f,0)),Pe=Ou(m,1);if(!Ne)return i(" La categora es requerida.");if(!Y)return i(" El nombre del producto es requerido.");if(we<=0)return i(" El precio proveedor debe ser > 0.");if(Pe<=0)return i(" Und x paquete debe ser > 0.");if(o.some(tt=>$n(tt.category)===$n(Ne)&&$n(tt.name)===$n(Y)))return i(" Ya existe un producto con esa categora y nombre.");try{n(!0);const tt={category:Ne,name:Y,providerPrice:we,unitsPerPackage:Pe,createdAt:$t.now()},ot=await Jr(ht(Te,"products_candies"),tt);l(dt=>[...dt,{id:ot.id,...tt}].sort((vt,lt)=>vt.name.localeCompare(lt.name,"es"))),i(" Producto creado."),Q()}catch(tt){console.error(tt),i(" Error creando producto.")}finally{n(!1)}},R=te=>{x(te.id),w(te.category),O(te.name),E(te.providerPrice),S(te.unitsPerPackage||1),i("")},K=()=>{x(null),w(""),O(""),E(0),S(1)},M=async()=>{if(!g)return;i("");const te=String(b||"").trim(),Ne=String(k||"").trim(),Y=Math.max(0,gA(L,0)),we=Ou(B,1);if(!te)return i(" La categora es requerida.");if(!Ne)return i(" El nombre del producto es requerido.");if(Y<=0)return i(" El precio proveedor debe ser > 0.");if(we<=0)return i(" Und x paquete debe ser > 0.");if(o.some(Qe=>Qe.id!==g&&$n(Qe.category)===$n(te)&&$n(Qe.name)===$n(Ne)))return i(" Ya existe otro producto con esa categora y nombre.");try{n(!0),await Pr(kt(Te,"products_candies",g),{category:te,name:Ne,providerPrice:Y,unitsPerPackage:we,updatedAt:$t.now()}),l(Qe=>Qe.map(tt=>tt.id===g?{...tt,category:te,name:Ne,providerPrice:Y,unitsPerPackage:we}:tt).sort((tt,ot)=>tt.name.localeCompare(ot.name,"es"))),i(" Producto actualizado."),K()}catch(Qe){console.error(Qe),i(" Error actualizando producto.")}finally{n(!1)}},re=async te=>{if(confirm(`Eliminar "${te.name}" (${te.category}) del catlogo?`))try{n(!0),await un(kt(Te,"products_candies",te.id)),l(Y=>Y.filter(we=>we.id!==te.id)),i(" Producto eliminado.")}catch(Y){console.error(Y),i(" Error eliminando producto.")}finally{n(!1)}},de=()=>{const te=[{Id:"",Categoria:"Gomitas",Producto:"Gomita Fresa",PrecioProveedor:120,UnidadesPorPaquete:24}],Ne=D1.json_to_sheet(te),Y=D1.book_new();D1.book_append_sheet(Y,Ne,"Productos");const we=A7(Y,{type:"array",bookType:"xlsx"}),Pe=new Blob([we],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Qe=URL.createObjectURL(Pe),tt=document.createElement("a");tt.href=Qe,tt.download="template_productos_dulces.xlsx",document.body.appendChild(tt),tt.click(),tt.remove(),URL.revokeObjectURL(Qe)},le=te=>{const Ne=[],Y=[];te.forEach((Pe,Qe)=>{if(!Pe||typeof Pe!="object"||Kve(Pe))return;const tt=String(lp(Pe,["Id","ID","productId","docId"])??"").trim(),ot=String(lp(Pe,["Categoria","Categora","Category","cat","category"])??"").trim(),dt=String(lp(Pe,["Producto","Product","Nombre","Name","producto","name"])??"").trim(),vt=lp(Pe,["PrecioProveedor","Precio Prov","Precio Prov.","ProviderPrice","Precio","Costo","providerPrice"]),lt=lp(Pe,["UnidadesPorPaquete","Und x Paquete","UnitsPerPackage","UPP","unitsPerPackage"]),Ue=Math.max(0,gA(vt,0)),Xe=Ou(lt,1),xe=Qe+2;ot||Y.push(`Fila ${xe}: falta Categoria.`),dt||Y.push(`Fila ${xe}: falta Producto/Nombre.`),Ue<=0&&Y.push(`Fila ${xe}: PrecioProveedor debe ser > 0.`),Xe<=0&&Y.push(`Fila ${xe}: UnidadesPorPaquete debe ser > 0.`),ot&&dt&&Ue>0&&Xe>0&&Ne.push({id:tt||void 0,category:ot,name:dt,providerPrice:Ue,unitsPerPackage:Xe,_raw:Pe})});const we=new Map;for(const Pe of Ne){const Qe=Pe.id?`id::${Pe.id}`:`${$n(Pe.category)}::${$n(Pe.name)}`;we.set(Qe,Pe)}return{rows:Array.from(we.values()),errors:Y}},q=async te=>{if(i(""),Z([]),fe([]),ge((te==null?void 0:te.name)||""),!te)return;const Ne=te.name.toLowerCase(),Y=Ne.endsWith(".xlsx")||Ne.endsWith(".xls"),we=Ne.endsWith(".csv");if(!Y&&!we){Z(["Solo se permiten archivos .xlsx, .xls o .csv"]);return}try{Ie(!0);const Pe=new FileReader,Qe=await new Promise((Xe,xe)=>{Pe.onerror=()=>xe(new Error("No se pudo leer el archivo.")),Pe.onload=()=>Xe(Pe.result),Pe.readAsArrayBuffer(te)}),tt=QE(new Uint8Array(Qe),{type:"array"}),ot=tt.SheetNames[0],dt=tt.Sheets[ot],vt=D1.sheet_to_json(dt,{defval:""}),{rows:lt,errors:Ue}=le(vt);fe(lt),Z(Ue),lt.length===0&&Ue.length===0&&Z(["No se encontraron filas vlidas para importar."])}catch(Pe){console.error(Pe),Z(["Error leyendo el archivo. Revis que no est corrupto."])}finally{Ie(!1)}},Se=(te,Ne)=>{fe(Y=>{const we=[...Y],Pe=we[te];return Pe?(we[te]={...Pe,...Ne},we):Y})},ee=async()=>{if(i(""),me.length>0){i(" Correg los errores antes de importar.");return}if(ae.length===0){i(" No hay filas para importar.");return}try{Ie(!0);const te={},Ne={};o.forEach(Qe=>{te[Qe.id]=Qe,Ne[`${$n(Qe.category)}::${$n(Qe.name)}`]=Qe});const Y=Xh(Te);let we=0,Pe=0;for(const Qe of ae){const tt=String(Qe.category||"").trim(),ot=String(Qe.name||"").trim(),dt=Math.max(0,gA(Qe.providerPrice,0)),vt=Ou(Qe.unitsPerPackage,1);if(!tt||!ot||dt<=0||vt<=0)continue;let lt;if(Qe.id&&te[Qe.id])lt=te[Qe.id];else{const Ue=`${$n(tt)}::${$n(ot)}`;lt=Ne[Ue]}if(lt)Y.update(kt(Te,"products_candies",lt.id),{category:tt,name:ot,providerPrice:dt,unitsPerPackage:vt,updatedAt:$t.now()}),Pe+=1;else{const Ue=kt(ht(Te,"products_candies"));Y.set(Ue,{category:tt,name:ot,providerPrice:dt,unitsPerPackage:vt,createdAt:$t.now()}),we+=1}}await Y.commit(),i(` Importacin lista. Creados: ${we}, Actualizados: ${Pe}`),D(!1),fe([]),Z([]),ge(""),e()}catch(te){console.error(te),i(" Error importando productos a Firestore.")}finally{Ie(!1)}},z=N.useMemo(()=>{const te=new Set(o.map(Pe=>Pe.id)),Ne=new Set(o.map(Pe=>`${$n(Pe.category)}::${$n(Pe.name)}`));let Y=0,we=0;for(const Pe of ae){if(Pe.id&&te.has(Pe.id)){Y+=1;continue}const Qe=`${$n(Pe.category)}::${$n(Pe.name)}`;Ne.has(Qe)?Y+=1:we+=1}return{willCreate:we,willUpdate:Y,total:ae.length}},[ae,o]);return a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Catlogo de Productos (Dulces)"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Zl,{onClick:e,loading:r||ye}),a.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",onClick:()=>{D(!0),fe([]),Z([]),ge("")},children:"Importar (.xlsx)"})]})]}),a.jsxs("form",{onSubmit:T,className:"bg-white p-3 rounded shadow border mb-4 grid grid-cols-1 md:grid-cols-5 gap-3 items-end text-sm",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block font-semibold",children:"Categora"}),a.jsx("input",{className:"w-full border rounded px-2 py-1",value:c,onChange:te=>d(te.target.value),placeholder:"Ej: Gomitas"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block font-semibold",children:"Producto"}),a.jsx("input",{className:"w-full border rounded px-2 py-1",value:A,onChange:te=>u(te.target.value),placeholder:"Ej: Gomita Fresa"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block font-semibold",children:"Precio proveedor (paq)"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border rounded px-2 py-1 text-right",value:Number.isNaN(f)?"":f,onChange:te=>h(Math.max(0,gA(te.target.value,0)))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block font-semibold",children:"Und x paquete"}),a.jsx("input",{type:"number",min:1,className:"w-full border rounded px-2 py-1 text-right",value:m,onChange:te=>p(Ou(te.target.value,1))})]}),a.jsxs("div",{className:"md:col-span-5 flex justify-end gap-2",children:[a.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:Q,children:"Limpiar"}),a.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",disabled:r,children:"Crear producto"})]})]}),a.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-3 flex flex-col md:flex-row gap-3 items-center text-sm",children:[a.jsxs("div",{className:"w-full md:w-1/2",children:[a.jsx("label",{className:"block font-semibold",children:"Buscar"}),a.jsx("input",{className:"w-full border rounded px-2 py-1",value:U,onChange:te=>_(te.target.value),placeholder:"Buscar por categora o producto"})]}),a.jsxs("div",{className:"w-full md:w-1/2 text-right",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Productos en catlogo"}),a.jsx("div",{className:"text-lg font-semibold",children:I.length})]})]}),a.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:a.jsxs("table",{className:"min-w-[900px] w-full text-xs md:text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{className:"whitespace-nowrap",children:[a.jsx("th",{className:"p-2 border text-left",children:"Categora"}),a.jsx("th",{className:"p-2 border text-left",children:"Producto"}),a.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),a.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),a.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):I.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin productos."})}):I.map(te=>{const Ne=g===te.id;return a.jsxs("tr",{className:"align-top",children:[a.jsx("td",{className:"p-2 border",children:Ne?a.jsx("input",{className:"w-full border rounded px-2 py-1",value:b,onChange:Y=>w(Y.target.value)}):te.category}),a.jsx("td",{className:"p-2 border",children:Ne?a.jsx("input",{className:"w-full border rounded px-2 py-1",value:k,onChange:Y=>O(Y.target.value)}):te.name}),a.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ne?a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(L)?"":L,onChange:Y=>E(Math.max(0,gA(Y.target.value,0)))}):Hve(te.providerPrice)}),a.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ne?a.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:B,onChange:Y=>S(Ou(Y.target.value,1))}):te.unitsPerPackage}),a.jsx("td",{className:"p-2 border",children:Ne?a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:M,type:"button",children:"Guardar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:K,type:"button",children:"Cancelar"})]}):a.jsxs("div",{className:"flex gap-2 justify-center flex-wrap",children:[a.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 hover:bg-yellow-500",onClick:()=>R(te),type:"button",children:"Editar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>re(te),type:"button",children:"Borrar"})]})})]},te.id)})})]})}),s&&a.jsx("p",{className:"mt-2 text-sm",children:s}),F&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white w-full max-w-6xl max-h-[90vh] overflow-y-auto rounded shadow-lg p-5 text-sm",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Importar productos (.xlsx / .csv)"}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>D(!1),children:"Cerrar"})]}),a.jsxs("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:[a.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end md:justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold",children:"1) Sub tu archivo"}),a.jsx("div",{className:"text-xs text-gray-600",children:"Columnas esperadas (flexible): Id (opcional), Categoria, Producto/Nombre, PrecioProveedor, UnidadesPorPaquete."})]}),a.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:de,type:"button",children:"Descargar template .xlsx"})]}),a.jsxs("div",{className:"mt-3 flex flex-col md:flex-row gap-3 md:items-center",children:[a.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:te=>{var Ne;return q(((Ne=te.target.files)==null?void 0:Ne[0])||null)}}),X&&a.jsxs("span",{className:"text-xs text-gray-600",children:["Archivo: ",a.jsx("b",{children:X})]}),ye&&a.jsx("span",{className:"text-xs",children:"Procesando"})]})]}),me.length>0&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[a.jsx("div",{className:"font-semibold text-red-700 mb-2",children:"Errores encontrados"}),a.jsx("ul",{className:"list-disc pl-5 text-red-700 text-xs space-y-1",children:me.slice(0,50).map((te,Ne)=>a.jsx("li",{children:te},Ne))})]}),a.jsxs("div",{className:"bg-white border rounded p-3",children:[a.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between mb-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold",children:"2) Previsualizacin (editable)"}),a.jsxs("div",{className:"text-xs text-gray-600",children:["Se importarn ",z.total," filas (Crear:"," ",z.willCreate," / Actualizar:"," ",z.willUpdate,")"]})]}),a.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",onClick:ee,disabled:ye||ae.length===0||me.length>0,type:"button",children:"Importar a Firestore"})]}),a.jsxs("div",{className:"overflow-x-auto border rounded",children:[a.jsxs("table",{className:"min-w-[1100px] w-full text-xs",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{className:"whitespace-nowrap",children:[a.jsx("th",{className:"p-2 border text-left",children:"Id (opcional)"}),a.jsx("th",{className:"p-2 border text-left",children:"Categora"}),a.jsx("th",{className:"p-2 border text-left",children:"Producto"}),a.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),a.jsx("th",{className:"p-2 border text-right",children:"Und x paquete"}),a.jsx("th",{className:"p-2 border text-center",children:"Accin"})]})}),a.jsx("tbody",{children:ae.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"p-4 text-center text-gray-500",children:"Sub un archivo para ver la previsualizacin."})}):ae.slice(0,300).map((te,Ne)=>{const Y=te.id?o.some(Qe=>Qe.id===te.id):!1,we=o.some(Qe=>`${$n(Qe.category)}::${$n(Qe.name)}`==`${$n(te.category)}::${$n(te.name)}`),Pe=Y||we;return a.jsxs("tr",{className:"whitespace-nowrap",children:[a.jsx("td",{className:"p-2 border",children:a.jsx("input",{className:"w-56 border rounded px-2 py-1",value:te.id||"",onChange:Qe=>Se(Ne,{id:Qe.target.value.trim()||void 0}),placeholder:"docId (si quers update exacto)"})}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{className:"w-56 border rounded px-2 py-1",value:te.category,onChange:Qe=>Se(Ne,{category:Qe.target.value}),list:"categories-list"})}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{className:"w-72 border rounded px-2 py-1",value:te.name,onChange:Qe=>Se(Ne,{name:Qe.target.value})})}),a.jsx("td",{className:"p-2 border text-right tabular-nums",children:a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-28 border rounded px-2 py-1 text-right",value:Number.isNaN(te.providerPrice)?"":te.providerPrice,onChange:Qe=>Se(Ne,{providerPrice:Math.max(0,gA(Qe.target.value,0))})})}),a.jsx("td",{className:"p-2 border text-right tabular-nums",children:a.jsx("input",{type:"number",min:1,className:"w-24 border rounded px-2 py-1 text-right",value:te.unitsPerPackage,onChange:Qe=>Se(Ne,{unitsPerPackage:Ou(Qe.target.value,1)})})}),a.jsx("td",{className:"p-2 border text-center",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${Pe?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:Pe?"ACTUALIZA":"CREA"})})]},`${te.id||""}-${Ne}`)})})]}),a.jsx("datalist",{id:"categories-list",children:j.map(te=>a.jsx("option",{value:te},te))})]}),ae.length>300&&a.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Mostrando 300 de ",ae.length," filas (el import importa todas)."]})]})]})})]})}function GI(t){const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=Number(t.totalUnits||0),n=Number(t.quantity||0),s=Number(t.packages||0);return r>0?Math.floor(r):n>0?Math.floor(n):s>0?Math.floor(s*e):0}function ug(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):GI(t)}function Gve(t){const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=GI(t);return r>0&&e>0?Math.floor(r/e):Math.max(0,Math.floor(Number(t.packages||0)))}function $ve(t){if(typeof t.remainingPackages=="number"&&isFinite(t.remainingPackages))return Math.max(0,Math.floor(Number(t.remainingPackages)));const e=Math.max(1,Math.floor(Number(t.unitsPerPackage||1))),r=ug(t);return Math.max(0,Math.floor(r/e))}async function zve(t){const e=kt(Te,"candy_main_orders",t);if((await Ya(e)).exists())return e;const n=Dt(ht(Te,"candy_main_orders"),Gt("orderId","==",t)),s=await Nt(n);return s.empty?null:kt(Te,"candy_main_orders",s.docs[0].id)}async function fC(t){if(!t)return;const e=await zve(t);if(!e)return;const r=Dt(ht(Te,"inventory_candies"),Gt("orderId","==",t)),n=await Nt(r),s=new Map;n.forEach(l=>{const c=l.data(),d=String(c.productId||"");if(!d)return;const A=Gve(c),u=$ve(c),f=Math.max(1,Math.floor(Number(c.unitsPerPackage||1))),h=Number(c.providerPrice||0),m=Number(c.unitPriceRivas||0),p=Number(c.unitPriceSanJorge||0),g=Number(c.unitPriceIsla||0),x=h*A,b=m*A,w=p*A,k=g*A,O=b-x,L=w-x,E=k-x;s.has(d)||s.set(d,{productId:d,name:String(c.productName||""),category:String(c.category||""),unitsPerPackage:f,providerPrice:h,marginRivas:typeof c.marginRivas=="number"?Number(c.marginRivas):void 0,marginSanJorge:typeof c.marginSanJorge=="number"?Number(c.marginSanJorge):void 0,marginIsla:typeof c.marginIsla=="number"?Number(c.marginIsla):void 0,packages:0,remainingPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,unitPriceRivas:m||0,unitPriceSanJorge:p||0,unitPriceIsla:g||0,gainRivas:0,gainSanJorge:0,gainIsla:0});const B=s.get(d);B.packages+=A,B.remainingPackages+=u,B.subtotal+=x,B.totalRivas+=b,B.totalSanJorge+=w,B.totalIsla+=k,B.gainRivas+=O,B.gainSanJorge+=L,B.gainIsla+=E,B.providerPrice=h,B.unitPriceRivas=m||B.unitPriceRivas,B.unitPriceSanJorge=p||B.unitPriceSanJorge,B.unitPriceIsla=g||B.unitPriceIsla,B.unitsPerPackage=f||B.unitsPerPackage,B.name=String(c.productName||B.name),B.category=String(c.category||B.category)});const i=Array.from(s.values()).map(l=>({id:l.productId,name:l.name,category:l.category,providerPrice:l.providerPrice,unitsPerPackage:l.unitsPerPackage,packages:l.packages,remainingPackages:l.remainingPackages,marginRivas:l.marginRivas??void 0,marginSanJorge:l.marginSanJorge??void 0,marginIsla:l.marginIsla??void 0,subtotal:l.subtotal,totalRivas:l.totalRivas,totalSanJorge:l.totalSanJorge,totalIsla:l.totalIsla,unitPriceRivas:l.unitPriceRivas,unitPriceSanJorge:l.unitPriceSanJorge,unitPriceIsla:l.unitPriceIsla,gainRivas:l.gainRivas,gainSanJorge:l.gainSanJorge,gainIsla:l.gainIsla})),o=i.reduce((l,c)=>l+Number(c.packages||0),0);await Pr(e,{totalPackages:o,items:i})}async function Wve(t){const{productId:e,saleDate:r,saleId:n}=t,s=t.quantityPacks,i=t.quantity;if(!e)throw new Error("Parmetros invlidos para allocateSaleFIFOCandy (sin producto)");const o=Dt(ht(Te,"inventory_candies"),Gt("productId","==",e)),l=await Nt(o);if(l.empty)throw new Error("No hay inventario para este producto.");const c=l.docs.map(h=>({id:h.id,data:h.data()})).sort((h,m)=>{var w,k;const p=String(h.data.date||""),g=String(m.data.date||"");if(p!==g)return p<g?-1:1;const x=((w=h.data.createdAt)==null?void 0:w.seconds)??0,b=((k=m.data.createdAt)==null?void 0:k.seconds)??0;return x-b});let d=0;for(const h of c){const m=Number(h.data.unitsPerPackage??0);if(m>0){d=m;break}}if(!d)for(const h of c){const m=h.data,p=Number(m.totalUnits??0),g=Number(m.packages??0);if(p>0&&g>0){d=p/g;break}}d||(d=1);let A;if(s!=null&&!Number.isNaN(Number(s))){const h=Math.max(0,Math.floor(Number(s)));if(h<=0)throw new Error("La cantidad en paquetes debe ser mayor que cero.");A=h*d}else{const h=Math.max(0,Math.floor(Number(i||0)));if(h<=0)throw new Error("La cantidad debe ser mayor que cero.");A=h}const u=c.map(h=>kt(Te,"inventory_candies",h.id)),f=[];return await pa(Te,async h=>{const m=await Promise.all(u.map(g=>h.get(g)));let p=A;for(let g=0;g<u.length&&p>0;g++){const x=u[g],b=m[g];if(!b.exists())continue;const w=b.data(),k=ug(w);if(k<=0)continue;const O=Math.min(k,p),L=Math.max(0,k-O),E=Math.max(1,Math.floor(Number(w.unitsPerPackage||1))),B=Math.floor(L/E);h.update(x,{remaining:L,remainingPackages:B,packages:B}),f.push({batchId:x.id,qty:O,batchDate:String(w.date||""),productName:String(w.productName||"")}),p-=O}if(p>0){const g=Math.ceil(p/d);throw new Error(`Inventario insuficiente. Faltan aproximadamente ${g} paquetes.`)}if(n)for(const g of f)await Jr(ht(Te,"batch_candies_allocations"),{saleId:n,saleDate:r,productId:e,productName:g.productName??"",batchId:g.batchId,batchDate:g.batchDate??"",quantity:g.qty,createdAt:$t.now()})}),{allocations:f}}function Jve(t){const e=t==null?void 0:t.allocationsByItem;if(!e)return null;const r=[];if(Array.isArray(e))for(const n of e){const s=Array.isArray(n==null?void 0:n.allocations)?n.allocations:[];for(const i of s){const o=String(i.inventorySellerId||""),l=Math.max(0,Math.floor(Number(i.units??i.qty??i.quantity??0)));!o||l<=0||r.push({inventorySellerId:o,units:l})}}else if(typeof e=="object")for(const n of Object.keys(e)){const s=e[n],i=Array.isArray(s==null?void 0:s.allocations)?s.allocations:[];for(const o of i){const l=String(o.inventorySellerId||""),c=Math.max(0,Math.floor(Number(o.units??o.qty??o.quantity??0)));!l||c<=0||r.push({inventorySellerId:l,units:c})}}return r.length?{allocations:r}:null}async function fx(t){const e=t.split("#")[0],r=kt(Te,"sales_candies",e),n=await Ya(r);if(!n.exists())throw new Error("La venta no existe.");const s=n.data(),i=Jve(s);if(i&&i.allocations.length>0){let d=0;return await pa(Te,async A=>{const u={};for(const p of i.allocations){const g=p.inventorySellerId,x=Math.max(0,Math.floor(Number(p.units||0)));!g||x<=0||(u[g]=(u[g]||0)+x,d+=x)}const h=Object.keys(u).map(p=>kt(Te,"inventory_candies_sellers",p)),m=await Promise.all(h.map(p=>A.get(p)));for(let p=0;p<h.length;p++){const g=m[p];if(!g.exists())continue;const x=g.data(),b=Number(x.remainingUnits??x.remaining??0),w=Math.max(0,Math.floor(Number(u[h[p].id]||0))),k=b+w,O=Math.max(1,Math.floor(Number(x.unitsPerPackage||1))),L=Math.floor(k/O);A.update(h[p],{remainingUnits:k,remainingPackages:L})}A.delete(r)}),{restored:d}}const o=[];if(Array.isArray(s.items)&&s.items.length>0){const d={};if(s.allocationsByItem&&typeof s.allocationsByItem=="object")for(const A of Object.keys(s.allocationsByItem)){const u=s.allocationsByItem[A],f=String((u==null?void 0:u.productId)||A||"");if(!f)continue;const h=Array.isArray(u==null?void 0:u.allocations)?u.allocations:[];d[f]=h.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))}))}if(Array.isArray(s.allocationsByItem))for(const A of s.allocationsByItem){const u=String((A==null?void 0:A.productId)||"");if(!u)continue;const f=Array.isArray(A==null?void 0:A.allocations)?A.allocations:[];d[u]=f.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))}))}for(const A of s.items){const u=String((A==null?void 0:A.productId)||"");if(!u)continue;const f=Math.max(0,Math.floor(Number((A==null?void 0:A.qty)||(A==null?void 0:A.quantity)||0))),h=Array.isArray(A==null?void 0:A.allocations)?A.allocations.map(m=>({batchId:String(m.batchId),qty:Math.max(0,Math.floor(Number(m.qty||m.quantity||0)))})):d[u]||[];o.push({productId:u,productName:String((A==null?void 0:A.productName)||""),qty:f,allocations:h.length?h:void 0})}}else{const d=s.item||{},A=String(d.productId||s.productId||""),u=Math.max(0,Math.floor(Number(d.qty??s.quantity??0))),f=Array.isArray(s.allocations)?s.allocations.map(h=>({batchId:String(h.batchId),qty:Math.max(0,Math.floor(Number(h.qty||h.quantity||0)))})):[];A&&u>0&&o.push({productId:A,productName:String(d.productName||s.productName||""),qty:u,allocations:f.length?f:void 0})}if(o.length===0)return await pa(Te,async d=>{d.delete(r)}),{restored:0};if(o.every(d=>Array.isArray(d.allocations)&&d.allocations.length>0)){let d=0;return await pa(Te,async A=>{const u=[];for(const h of o)for(const m of h.allocations||[]){const p=Math.max(0,Math.floor(Number(m.qty||0)));d+=p,u.push({ref:kt(Te,"inventory_candies",m.batchId),addBack:p})}const f=await Promise.all(u.map(h=>A.get(h.ref)));for(let h=0;h<u.length;h++){const m=f[h];if(!m.exists())continue;const p=m.data(),g=ug(p),x=Math.max(0,Math.floor(Number(u[h].addBack||0))),b=g+x,w=Math.max(1,Math.floor(Number(p.unitsPerPackage||1))),k=Math.floor(b/w);A.update(u[h].ref,{remaining:b,remainingPackages:k,packages:k})}A.delete(r)}),{restored:d}}let c=0;return await pa(Te,async d=>{const A={};for(const p of o){if(!p.productId||p.qty<=0)continue;const g=Dt(ht(Te,"inventory_candies"),Gt("productId","==",p.productId)),b=(await Nt(g)).docs.map(w=>{const k=w.data(),O=GI(k),L=ug(k);return{id:w.id,date:String(k.date||""),baseUnits:O,remaining:L}}).sort((w,k)=>w.date.localeCompare(k.date));A[p.productId]=b}const u=[];for(const p of o){if(!p.productId||p.qty<=0)continue;if(Array.isArray(p.allocations)&&p.allocations.length>0){for(const b of p.allocations){const w=Math.max(0,Math.floor(Number(b.qty||0)));c+=w,u.push({id:b.batchId,addBack:w})}continue}const g=A[p.productId]||[];let x=p.qty;for(const b of g){if(x<=0)break;const w=Math.max(0,b.baseUnits-b.remaining);if(w<=0)continue;const k=Math.min(w,x);u.push({id:b.id,addBack:k}),c+=k,x-=k}for(const b of g){if(x<=0)break;const w=Math.min(x,p.qty);u.push({id:b.id,addBack:w}),c+=w,x-=w}}const f={};for(const p of u)f[p.id]=(f[p.id]||0)+Math.max(0,Math.floor(Number(p.addBack||0)));const h=Object.keys(f).map(p=>kt(Te,"inventory_candies",p)),m=await Promise.all(h.map(p=>d.get(p)));for(let p=0;p<h.length;p++){const g=m[p];if(!g.exists())continue;const x=g.data(),b=ug(x),w=Math.max(0,Math.floor(Number(f[h[p].id]||0))),k=b+w,O=Math.max(1,Math.floor(Number(x.unitsPerPackage||1))),L=Math.floor(k/O);d.update(h[p],{remaining:k,remainingPackages:L,packages:L})}d.delete(r)}),{restored:c}}async function Xve(t){return fx(t)}const Ii=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function mC(t){return isFinite(t)?Math.round(t):0}function kl(t){return t.unitsPerPackage>0&&t.totalUnits>0?Math.floor(t.totalUnits/t.unitsPerPackage):Math.max(0,Math.floor(Number(t.packages||0)))}function pC(t){return typeof t.remainingPackages=="number"&&isFinite(t.remainingPackages)?Math.max(0,Math.floor(t.remainingPackages)):t.unitsPerPackage>0?Math.max(0,Math.floor(Number(t.remaining||0)/t.unitsPerPackage)):0}function Yve(t,e){var o,l;const r=String(t.date||""),n=String(e.date||"");if(r!==n)return n.localeCompare(r);const s=((o=t.createdAt)==null?void 0:o.seconds)??0;return(((l=e.createdAt)==null?void 0:l.seconds)??0)-s}function Zve(){const[t,e]=N.useState([]),[r,n]=N.useState([]),[s,i]=N.useState(!0),[o,l]=N.useState(""),[c,d]=N.useState(or(jc(new Date),"yyyy-MM-dd")),[A,u]=N.useState(or(Ic(new Date),"yyyy-MM-dd")),[f,h]=N.useState(""),[m,p]=N.useState(""),[g,x]=N.useState(null),[b,w]=N.useState(""),[k,O]=N.useState(0),[L,E]=N.useState(!1),[B,S]=N.useState(""),[U,_]=N.useState(""),[F,D]=N.useState([]);N.useEffect(()=>{(async()=>{try{i(!0);const R=await Nt(ht(Te,"products_candies")),K=[];R.forEach(le=>{const q=le.data();K.push({id:le.id,name:q.name??"(sin nombre)",category:q.category??"(sin categora)"})}),e(K);const M=Dt(ht(Te,"inventory_candies"),Ur("date","desc")),re=await Nt(M),de=[];re.forEach(le=>{const q=le.data(),Se=Number(q.unitsPerPackage||0),ee=Number(q.totalUnits??q.quantity??(q.packages||0)*(q.unitsPerPackage||0)),z=Number(q.remaining??q.totalUnits??ee??0);de.push({id:le.id,productId:q.productId,productName:q.productName,category:q.category,measurement:q.measurement??"unidad",packages:Number(q.packages||0),unitsPerPackage:Se,totalUnits:ee,remaining:z,remainingPackages:typeof q.remainingPackages=="number"?Number(q.remainingPackages):void 0,providerPrice:Number(q.providerPrice||0),subtotal:Number(q.subtotal||0),totalRivas:Number(q.totalRivas||0),totalSanJorge:Number(q.totalSanJorge||0),totalIsla:Number(q.totalIsla||0),gainRivas:Number(q.gainRivas||0),gainSanJorge:Number(q.gainSanJorge||0),gainIsla:Number(q.gainIsla||0),unitPriceRivas:Number(q.unitPriceRivas||0),unitPriceSanJorge:Number(q.unitPriceSanJorge||0),unitPriceIsla:Number(q.unitPriceIsla||0),date:q.date,createdAt:q.createdAt,status:q.status??"PENDIENTE",orderId:q.orderId??null})}),n(de)}catch(R){console.error(R),l(" Error cargando inventario.")}finally{i(!1)}})()},[]);const X=N.useMemo(()=>r.filter(R=>!(c&&R.date<c||A&&R.date>A||f&&R.productId!==f||m&&String(R.category||"")!==m)),[r,c,A,f,m]),ge=N.useMemo(()=>{const R=new Set;for(const K of t)K.category&&R.add(K.category);return Array.from(R).sort((K,M)=>K.localeCompare(M))},[t]),ae=N.useMemo(()=>{const R=X.reduce((q,Se)=>q+kl(Se),0),K=X.reduce((q,Se)=>q+pC(Se),0),M=X.reduce((q,Se)=>{const ee=kl(Se);return q+Number(Se.providerPrice||0)*ee},0),re=X.reduce((q,Se)=>{const ee=kl(Se);return q+Number(Se.unitPriceRivas||0)*ee},0),de=X.reduce((q,Se)=>{const ee=kl(Se);return q+Number(Se.unitPriceSanJorge||0)*ee},0),le=X.reduce((q,Se)=>{const ee=kl(Se);return q+Number(Se.unitPriceIsla||0)*ee},0);return{totalPaquetes:R,totalPaquetesRestantes:K,totalSubtotal:M,totalRivas:re,totalSJ:de,totalIsla:le}},[X]),fe=N.useMemo(()=>{let R=0,K=0;for(const M of X)M.status==="PENDIENTE"&&(R+=1),M.status==="PAGADO"&&(K+=1);return{totalLotes:X.length,pendientes:R,pagados:K}},[X]),me=N.useMemo(()=>{const R=new Map;for(const M of X){const re=String(M.productId||"");re&&(R.has(re)||R.set(re,{batches:[]}),R.get(re).batches.push(M))}const K=[];for(const[M,re]of R.entries()){const de=[...re.batches].sort(Yve),le=de[0],q=de.reduce((dt,vt)=>dt+kl(vt),0),Se=de.reduce((dt,vt)=>dt+pC(vt),0),ee=Number((le==null?void 0:le.providerPrice)||0),z=Number((le==null?void 0:le.unitPriceRivas)||0),te=Number((le==null?void 0:le.unitPriceIsla)||0),Ne=de.reduce((dt,vt)=>{const lt=kl(vt);return dt+Number(vt.providerPrice||0)*lt},0),Y=de.reduce((dt,vt)=>{const lt=kl(vt);return dt+Number(vt.unitPriceRivas||0)*lt},0),we=de.reduce((dt,vt)=>{const lt=kl(vt);return dt+Number(vt.unitPriceIsla||0)*lt},0),Pe=Y-Ne,Qe=we-Ne;let tt="",ot;for(const dt of de)(!tt||String(dt.date||"")>tt)&&(tt=String(dt.date||""),ot=dt.createdAt);K.push({productId:M,productName:(le==null?void 0:le.productName)||"",category:(le==null?void 0:le.category)||"",totalPackages:q,remainingPackages:Se,providerPrice:ee,unitPriceRivas:z,unitPriceIsla:te,subtotal:Ne,totalRivas:Y,totalIsla:we,gainRivas:Pe,gainIsla:Qe,lastDate:tt,lastCreatedAt:ot,batchCount:de.length})}return K.sort((M,re)=>String(re.lastDate).localeCompare(String(M.lastDate))),K},[X]),Z=R=>{x(R.id),w(R.date),O(R.providerPrice),l("")},ye=()=>{x(null),w(""),O(0)},Ie=async()=>{if(!g)return;const R=r.find(we=>we.id===g);if(!R)return;if(k<0){l("El precio proveedor no puede ser negativo.");return}const K=kl(R),M=k*K,re=K>0?M/.8:0,de=K>0?M/.85:0,le=K>0?M/.7:0,q=re-M,Se=de-M,ee=le-M,z=K>0?mC(re/K):0,te=K>0?mC(de/K):0,Ne=K>0?mC(le/K):0,Y=kt(Te,"inventory_candies",g);await Pr(Y,{date:b,providerPrice:k,subtotal:M,totalRivas:re,totalSanJorge:de,totalIsla:le,gainRivas:q,gainSanJorge:Se,gainIsla:ee,unitPriceRivas:z,unitPriceSanJorge:te,unitPriceIsla:Ne}),n(we=>we.map(Pe=>Pe.id===g?{...Pe,date:b,providerPrice:k,subtotal:M,totalRivas:re,totalSanJorge:de,totalIsla:le,gainRivas:q,gainSanJorge:Se,gainIsla:ee,unitPriceRivas:z,unitPriceSanJorge:te,unitPriceIsla:Ne}:Pe)),R.orderId&&await fC(String(R.orderId)),l(" Lote de dulces actualizado"),ye()},I=async R=>{confirm(`Marcar PAGADO el lote del ${R.date} (${R.productName})?`)&&(await Pr(kt(Te,"inventory_candies",R.id),{status:"PAGADO"}),n(M=>M.map(re=>re.id===R.id?{...re,status:"PAGADO"}:re)),l(" Lote marcado como pagado"))},j=async R=>{confirm(`Eliminar el lote del ${R.date} (${R.productName})?`)&&(await un(kt(Te,"inventory_candies",R.id)),n(M=>M.filter(re=>re.id!==R.id)),R.orderId&&await fC(String(R.orderId)),l(" Lote eliminado"))},Q=async(R,K)=>{try{i(!0),l("");const M=Dt(ht(Te,"inventory_candies"),Gt("productId","==",R),Ur("date","desc")),re=await Nt(M),de=[];re.forEach(le=>{const q=le.data(),Se=Number(q.unitsPerPackage||0),ee=Number(q.totalUnits??q.quantity??(q.packages||0)*(q.unitsPerPackage||0)),z=Number(q.remaining??q.totalUnits??ee??0);de.push({id:le.id,productId:q.productId,productName:q.productName,category:q.category,measurement:q.measurement??"unidad",packages:Number(q.packages||0),unitsPerPackage:Se,totalUnits:ee,remaining:z,remainingPackages:typeof q.remainingPackages=="number"?Number(q.remainingPackages):void 0,providerPrice:Number(q.providerPrice||0),subtotal:Number(q.subtotal||0),totalRivas:Number(q.totalRivas||0),totalSanJorge:Number(q.totalSanJorge||0),totalIsla:Number(q.totalIsla||0),gainRivas:Number(q.gainRivas||0),gainSanJorge:Number(q.gainSanJorge||0),gainIsla:Number(q.gainIsla||0),unitPriceRivas:Number(q.unitPriceRivas||0),unitPriceSanJorge:Number(q.unitPriceSanJorge||0),unitPriceIsla:Number(q.unitPriceIsla||0),date:q.date,createdAt:q.createdAt,status:q.status??"PENDIENTE",orderId:q.orderId??null})}),S(R),_(K),D(de),E(!0)}catch(M){console.error(M),l(" Error abriendo detalle del producto.")}finally{i(!1)}},T=async(R,K)=>{const M=r.filter(de=>de.productId===R);if(confirm(`Eliminar COMPLETAMENTE "${K}"?
Esto eliminar ${M.length} lote(s) de este producto.`))try{i(!0),l("");const de=Array.from(new Set(M.map(le=>le.orderId?String(le.orderId):"").filter(Boolean)));for(const le of M)await un(kt(Te,"inventory_candies",le.id));n(le=>le.filter(q=>q.productId!==R)),l(" Producto eliminado (todos sus lotes).");for(const le of de)await fC(le);L&&B===R&&(E(!1),D([]),S(""),_(""))}catch(de){console.error(de),l(" Error eliminando lotes del producto.")}finally{i(!1)}};return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Productos"})}),a.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:R=>d(R.target.value)})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:A,onChange:R=>u(R.target.value)})]}),a.jsxs("div",{className:"flex flex-col min-w-[220px]",children:[a.jsx("label",{className:"font-semibold",children:"Categora"}),a.jsxs("select",{className:"border rounded px-2 py-1",value:m,onChange:R=>p(R.target.value),children:[a.jsx("option",{value:"",children:"Todas"}),ge.map(R=>a.jsx("option",{value:R,children:R},R))]})]}),a.jsxs("div",{className:"flex flex-col min-w-[240px]",children:[a.jsx("label",{className:"font-semibold",children:"Producto"}),a.jsxs("select",{className:"border rounded px-2 py-1",value:f,onChange:R=>h(R.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),t.map(R=>a.jsxs("option",{value:R.id,children:[R.name,"  ",R.category]},R.id))]})]}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{d(""),u(""),h(""),p("")},children:"Quitar filtro"})]}),a.jsx("div",{className:"bg-gray-50 p-2 rounded shadow border mb-2 text-xs md:text-sm",children:a.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Lotes totales:"})," ",fe.totalLotes]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Lotes pendientes:"})," ",fe.pendientes]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Lotes pagados:"})," ",fe.pagados]})]})}),a.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-1 gap-x-8",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Paquetes ingresados:"})," ",ae.totalPaquetes]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",ae.totalPaquetesRestantes]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Sub total:"})," ",Ii(ae.totalSubtotal)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total Rivas:"})," ",Ii(ae.totalRivas)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total San Jorge:"})," ",Ii(ae.totalSJ)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total Isla:"})," ",Ii(ae.totalIsla)]})]})}),a.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:a.jsx("div",{className:"w-full overflow-x-auto",children:a.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[a.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border text-left",children:"Categora"}),a.jsx("th",{className:"p-2 border text-left",children:"Producto"}),a.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes totales"}),a.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Paquetes restantes"}),a.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio proveedor"}),a.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Rivas"}),a.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Precio venta Isla"}),a.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Subtotal"}),a.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Rivas"}),a.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Total Isla"}),a.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Rivas"}),a.jsx("th",{className:"p-2 border whitespace-nowrap text-right",children:"Ganancia bruta Isla"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"ltima fecha"}),a.jsx("th",{className:"p-2 border whitespace-nowrap text-center",children:"Opciones"})]})}),a.jsx("tbody",{className:"whitespace-nowrap",children:s?a.jsx("tr",{children:a.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Cargando"})}):me.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:14,className:"p-4 text-center",children:"Sin productos"})}):me.map(R=>a.jsxs("tr",{className:"text-left",children:[a.jsx("td",{className:"p-2 border",children:R.category||""}),a.jsxs("td",{className:"p-2 border max-w-[260px]",children:[a.jsx("span",{className:"block truncate",title:R.productName,children:R.productName}),a.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lotes: ",R.batchCount]})]}),a.jsx("td",{className:"p-2 border text-right tabular-nums",children:R.totalPackages}),a.jsx("td",{className:"p-2 border text-right tabular-nums",children:R.remainingPackages}),a.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ii(R.providerPrice)}),a.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ii(R.unitPriceRivas)}),a.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ii(R.unitPriceIsla)}),a.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ii(R.subtotal)}),a.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ii(R.totalRivas)}),a.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ii(R.totalIsla)}),a.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ii(R.gainRivas)}),a.jsx("td",{className:"p-2 border text-right tabular-nums",children:Ii(R.gainIsla)}),a.jsx("td",{className:"p-2 border",children:R.lastDate||""}),a.jsx("td",{className:"p-2 border",children:a.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[a.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>Q(R.productId,R.productName),children:"Detalle"}),a.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>T(R.productId,R.productName),children:"Borrar"})]})})]},R.productId))})]})})}),o&&a.jsx("p",{className:"mt-2 text-sm",children:o}),L&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-4 rounded shadow-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto text-sm",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Detalle del producto"}),a.jsxs("div",{className:"text-xs text-gray-600",children:[a.jsx("span",{className:"font-semibold",children:"Producto:"})," ",U||""," ",a.jsxs("span",{className:"ml-2",children:[a.jsx("span",{className:"font-semibold",children:"ID:"})," ",B]})]})]}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{E(!1),D([]),S(""),_(""),ye()},children:"Cerrar"})]}),a.jsx("div",{className:"bg-white rounded shadow border w-full overflow-x-auto",children:a.jsxs("table",{className:"min-w-[1200px] table-auto text-xs md:text-sm",children:[a.jsx("thead",{className:"bg-gray-100 sticky top-0 z-10",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border text-left",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Categora"}),a.jsx("th",{className:"p-2 border text-left",children:"Producto"}),a.jsx("th",{className:"p-2 border text-right",children:"Paquetes ingresados"}),a.jsx("th",{className:"p-2 border text-right",children:"Paquetes restantes"}),a.jsx("th",{className:"p-2 border text-right",children:"Unidades"}),a.jsx("th",{className:"p-2 border text-right",children:"Precio proveedor"}),a.jsx("th",{className:"p-2 border text-right",children:"Precio venta Rivas"}),a.jsx("th",{className:"p-2 border text-right",children:"Precio venta Isla"}),a.jsx("th",{className:"p-2 border",children:"Nmero orden"}),a.jsx("th",{className:"p-2 border",children:"Status"}),a.jsx("th",{className:"p-2 border text-center",children:"Acciones"})]})}),a.jsx("tbody",{className:"whitespace-nowrap",children:F.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:12,className:"p-4 text-center text-gray-500",children:"Sin lotes"})}):F.map(R=>{const K=g===R.id,M=kl(R),re=pC(R);return a.jsxs("tr",{className:"text-left",children:[a.jsx("td",{className:"p-2 border align-top",children:K?a.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:b,onChange:de=>w(de.target.value)}):R.date}),a.jsx("td",{className:"p-2 border align-top",children:R.category||""}),a.jsxs("td",{className:"p-2 border align-top max-w-[260px]",children:[a.jsx("span",{className:"block truncate",title:R.productName,children:R.productName}),a.jsxs("span",{className:"text-[10px] text-gray-500",children:["Lote ID: ",R.id]})]}),a.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:M}),a.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:re}),a.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:R.totalUnits}),a.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:K?a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-24 border p-1 rounded text-right",value:Number.isNaN(k)?"":k,onChange:de=>O(Math.max(0,parseFloat(de.target.value||"0")))}):Ii(R.providerPrice)}),a.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Ii(R.unitPriceRivas)}),a.jsx("td",{className:"p-2 border align-top text-right tabular-nums",children:Ii(R.unitPriceIsla)}),a.jsx("td",{className:"p-2 border align-top",children:R.orderId?String(R.orderId):""}),a.jsx("td",{className:"p-2 border align-top",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] md:text-xs ${R.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:R.status})}),a.jsx("td",{className:"p-2 border align-top",children:K?a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:Ie,children:"Guardar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ye,children:"Cancelar"})]}):a.jsxs("div",{className:"flex gap-1 justify-center flex-wrap",children:[R.status==="PENDIENTE"&&a.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:()=>I(R),children:"Pagar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-yellow-400 text-black hover:bg-yellow-500 text-xs",onClick:()=>Z(R),children:"Editar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>j(R),children:"Borrar"})]})})]},R.id)})})]})}),a.jsx("div",{className:"mt-3 flex justify-end",children:a.jsx("button",{className:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>T(B,U),children:"Borrar producto (todos los lotes)"})})]})})]})}const gC=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"],Xo=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function cp(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}async function g3(t){const e=Dt(ht(Te,"ar_movements"),Gt("ref.saleId","==",t)),r=await Nt(e);await Promise.all(r.docs.map(n=>un(kt(Te,"ar_movements",n.id))))}function e1e({role:t="",sellerCandyId:e="",currentUserEmail:r}){const n=String(t||"").trim().toLowerCase(),s=String(e||"").trim(),i=n==="vendedor_dulces",o=n==="admin",[l,c]=N.useState([]),[d,A]=N.useState(!1),[u,f]=N.useState(!1),[h,m]=N.useState(null),[p,g]=N.useState([]),x=async he=>{A(!0),f(!0),m(he),g([]);try{const Ee=(await Nt(Dt(ht(Te,"sales_candies"),Gt("__name__","==",he)))).docs[0],Ze=Ee==null?void 0:Ee.data(),Ye=(Array.isArray(Ze==null?void 0:Ze.items)?Ze.items:Ze!=null&&Ze.item?[Ze.item]:[]).map($e=>({productName:String($e.productName||""),qty:Number($e.qty||0),unitPrice:Number($e.unitPrice||0),discount:Number($e.discount||0),total:Number($e.total||0)}));g(Ye)}catch(Re){console.error(Re)}finally{f(!1)}},[b,w]=N.useState(""),[k,O]=N.useState("+505 "),[L,E]=N.useState(""),[B,S]=N.useState(""),[U,_]=N.useState("ACTIVO"),[F,D]=N.useState(0),[X,ge]=N.useState(""),[ae,fe]=N.useState(0),[me,Z]=N.useState([]),[ye,Ie]=N.useState(!0),[I,j]=N.useState(""),[Q,T]=N.useState(null),[R,K]=N.useState(""),[M,re]=N.useState("+505 "),[de,le]=N.useState(""),[q,Se]=N.useState(""),[ee,z]=N.useState("ACTIVO"),[te,Ne]=N.useState(0),[Y,we]=N.useState(""),[Pe,Qe]=N.useState(!1),[tt,ot]=N.useState(null),[dt,vt]=N.useState(!1),[lt,Ue]=N.useState([]),[Xe,xe]=N.useState({saldoActual:0,totalAbonado:0,totalCargos:0}),[ve,ie]=N.useState(!1),[ze,rt]=N.useState(0),[At,Oe]=N.useState(new Date().toISOString().slice(0,10)),[at,Ve]=N.useState(""),[G,_e]=N.useState(!1),[Me,We]=N.useState(null),[He,st]=N.useState(""),[Ct,Xt]=N.useState(0),[Ot,tr]=N.useState(""),[Zt,et]=N.useState(!1);N.useEffect(()=>{(async()=>{try{if(Ie(!0),i&&!s){Z([]),j(" Este usuario no tiene vendedor asociado (sellerCandyId vaco).");return}const he=await Nt(ht(Te,"sellers_candies")),Re=[];he.forEach(Ye=>{const $e=Ye.data(),it=String($e.status||"ACTIVO");it==="ACTIVO"&&Re.push({id:Ye.id,name:String($e.name||""),status:it})}),c(Re);const Ee=i?Dt(ht(Te,"customers_candies"),Gt("vendorId","==",s),Ur("createdAt","desc")):Dt(ht(Te,"customers_candies"),Ur("createdAt","desc")),Ze=await Nt(Ee),Je=[];Ze.forEach(Ye=>{const $e=Ye.data();Je.push({id:Ye.id,name:$e.name??"",phone:$e.phone??"+505 ",place:$e.place??"",notes:$e.notes??"",status:$e.status??"ACTIVO",creditLimit:Number($e.creditLimit??0),createdAt:$e.createdAt??$t.now(),balance:0,sellerId:$e.sellerId||"",vendorId:$e.vendorId||"",vendorName:$e.vendorName||"",initialDebt:Number($e.initialDebt||0)})});for(const Ye of Je)try{const $e=Dt(ht(Te,"ar_movements"),Gt("customerId","==",Ye.id)),it=await Nt($e);let ft=0;it.forEach(Ut=>ft+=Number(Ut.data().amount||0)),Ye.balance=ft}catch{Ye.balance=0}Z(Je)}catch(he){console.error(he),j(" Error cargando clientes.")}finally{Ie(!1)}})()},[i,s]);const Rt=()=>{w(""),O("+505 "),E(""),S(""),_("ACTIVO"),D(0),ge(""),fe(0)},er=async he=>{var Je;if(he.preventDefault(),j(""),!b.trim()){j("Ingresa el nombre.");return}const Re=cp(k);if(Re.length<6){j("Telfono incompleto.");return}const Ee=i?s:String(X||"").trim(),Ze=Ee&&((Je=l.find(Ye=>Ye.id===Ee))==null?void 0:Je.name)||"";try{const Ye=await Jr(ht(Te,"customers_candies"),{name:b.trim(),phone:Re,place:L||"",notes:B||"",status:U,creditLimit:Number(F||0),vendorId:Ee,vendorName:Ze,initialDebt:Number(ae||0),createdAt:$t.now()});Z($e=>[{id:Ye.id,name:b.trim(),phone:Re,place:L||"",notes:B||"",status:U,creditLimit:Number(F||0),vendorId:Ee,vendorName:Ze,initialDebt:Number(ae||0),createdAt:$t.now(),balance:0},...$e]),Rt(),et(!1),j(" Cliente creado")}catch(Ye){console.error(Ye),j(" Error al crear cliente")}},Lt=he=>{if(i){j(" No permitido: vendedores no editan clientes desde el listado.");return}T(he.id),K(he.name),re(he.phone||"+505 "),le(he.place||""),Se(he.notes||""),z(he.status||"ACTIVO"),Ne(Number(he.creditLimit||0)),we(String(he.vendorId||""))},Vt=()=>{T(null),K(""),re("+505 "),le(""),Se(""),z("ACTIVO"),Ne(0),we("")},nr=async()=>{var $e;if(i){j(" No permitido.");return}if(!Q)return;const he=cp(M);if(!R.trim()){j("Ingresa el nombre.");return}const Re=me.find(it=>it.id===Q),Ee=String((Re==null?void 0:Re.vendorId)||""),Ze=i?s:String(Y||"");if(i&&Ee&&Ee!==s){j(" Este cliente pertenece a otro vendedor.");return}if(o&&Ee&&Ze&&Ee!==Ze){j(" Este cliente ya est asociado a otro vendedor. Primero desasocia (deja vendedor en ) y guarda; luego lo puedes asignar.");return}const Je=i?s:String(Y||""),Ye=Je&&(($e=l.find(it=>it.id===Je))==null?void 0:$e.name)||"";try{await Pr(kt(Te,"customers_candies",Q),{name:R.trim(),phone:he,place:de||"",notes:q||"",status:ee,creditLimit:Number(te||0),vendorId:Je,vendorName:Ye}),Z(it=>it.map(ft=>ft.id===Q?{...ft,name:R.trim(),phone:he,place:de||"",notes:q||"",status:ee,creditLimit:Number(te||0),vendorId:Je,vendorName:Ye}:ft)),Vt(),j(" Cliente actualizado")}catch(it){console.error(it),j(" Error al actualizar")}},Mt=async he=>{if(confirm(`Eliminar al cliente "${he.name}"?
Se devolvern al inventario todos los dulces de sus compras y se borrarn sus movimientos.`))try{Ie(!0);const Ee=Dt(ht(Te,"sales_candies"),Gt("customerId","==",he.id)),Ze=await Nt(Ee);for(const $e of Ze.docs){const it=$e.id;try{await fx(it)}catch(ft){console.warn("restoreSaleAndDeleteCandy error",ft);try{await un(kt(Te,"sales_candies",it))}catch{}}await g3(it)}const Je=Dt(ht(Te,"ar_movements"),Gt("customerId","==",he.id)),Ye=await Nt(Je);await Promise.all(Ye.docs.map($e=>un(kt(Te,"ar_movements",$e.id)))),await un(kt(Te,"customers_candies",he.id)),Z($e=>$e.filter(it=>it.id!==he.id)),j(" Cliente eliminado y dulces devueltos al inventario")}catch(Ee){console.error(Ee),j(" No se pudo eliminar el cliente.")}finally{Ie(!1)}},oe=async he=>{ot(he),Ue([]),xe({saldoActual:0,totalAbonado:0,totalCargos:0}),Qe(!0),ie(!1),rt(0),Oe(new Date().toISOString().slice(0,10)),Ve(""),We(null),vt(!0);try{const Re=Dt(ht(Te,"ar_movements"),Gt("customerId","==",he.id)),Ee=await Nt(Re),Ze=[];Ee.forEach(Je=>{var $e,it;const Ye=Je.data();Ze.push({id:Je.id,date:Ye.date??((it=($e=Ye.createdAt)==null?void 0:$e.toDate)!=null&&it.call($e)?Ye.createdAt.toDate().toISOString().slice(0,10):""),type:Ye.type??"CARGO",amount:Number(Ye.amount||0),ref:Ye.ref||{},comment:Ye.comment||"",createdAt:Ye.createdAt})}),Ze.sort((Je,Ye)=>{var ft,Ut;if(Je.date!==Ye.date)return Je.date.localeCompare(Ye.date);const $e=((ft=Je.createdAt)==null?void 0:ft.seconds)||0,it=((Ut=Ye.createdAt)==null?void 0:Ut.seconds)||0;return $e-it}),Ue(Ze),J(Ze)}catch(Re){console.error(Re),j(" No se pudo cargar el estado de cuenta")}finally{vt(!1)}},J=he=>{const Re=he.reduce((Je,Ye)=>Je+(Number(Ye.amount)||0),0),Ee=he.filter(Je=>Number(Je.amount)<0).reduce((Je,Ye)=>Je+Math.abs(Number(Ye.amount)||0),0),Ze=he.filter(Je=>Number(Je.amount)>0).reduce((Je,Ye)=>Je+(Number(Ye.amount)||0),0);xe({saldoActual:Re,totalAbonado:Ee,totalCargos:Ze})},ce=async()=>{if(!tt)return;j("");const he=Number(ze||0);if(!(he>0)){j("Ingresa un monto de abono mayor a 0.");return}const Re=parseFloat(he.toFixed(2));if(!At){j("Selecciona la fecha del abono.");return}try{_e(!0);const Ee={customerId:tt.id,type:"ABONO",amount:-Re,date:At,comment:at||"",createdAt:$t.now()},Je={id:(await Jr(ht(Te,"ar_movements"),Ee)).id,date:At,type:"ABONO",amount:-Re,comment:at||"",createdAt:$t.now()},Ye=[...lt,Je].sort(($e,it)=>{var Kt,yr;if($e.date!==it.date)return $e.date.localeCompare(it.date);const ft=((Kt=$e.createdAt)==null?void 0:Kt.seconds)||0,Ut=((yr=it.createdAt)==null?void 0:yr.seconds)||0;return ft-Ut});Ue(Ye),J(Ye),Z($e=>$e.map(it=>it.id===tt.id?{...it,balance:(it.balance||0)-Re}:it)),ot($e=>$e&&{...$e,balance:($e.balance||0)-Re}),rt(0),Ve(""),Oe(new Date().toISOString().slice(0,10)),ie(!1),j(" Abono registrado")}catch(Ee){console.error(Ee),j(" Error al registrar el abono")}finally{_e(!1)}},pe=he=>{We(he.id),st(he.date||new Date().toISOString().slice(0,10)),Xt(Math.abs(Number(he.amount||0))),tr(he.comment||"")},Be=()=>{We(null),st(""),Xt(0),tr("")},De=async()=>{if(!Me)return;const he=lt.findIndex(Je=>Je.id===Me);if(he===-1)return;const Re=lt[he],Ee=Number(Ct||0);if(!(Ee>0)){j("El monto debe ser mayor a 0.");return}const Ze=Re.type==="ABONO"?-parseFloat(Ee.toFixed(2)):+parseFloat(Ee.toFixed(2));try{await Pr(kt(Te,"ar_movements",Me),{date:He,amount:Ze,comment:Ot||""});const Je=[...lt];Je[he]={...Re,date:He,amount:Ze,comment:Ot||""},Je.sort(($e,it)=>{var Kt,yr;if($e.date!==it.date)return $e.date.localeCompare(it.date);const ft=((Kt=$e.createdAt)==null?void 0:Kt.seconds)||0,Ut=((yr=it.createdAt)==null?void 0:yr.seconds)||0;return ft-Ut}),Ue(Je),J(Je);const Ye=Je.reduce(($e,it)=>$e+(Number(it.amount)||0),0);Z($e=>$e.map(it=>it.id===(tt==null?void 0:tt.id)?{...it,balance:Ye}:it)),ot($e=>$e&&{...$e,balance:Ye}),Be(),j(" Movimiento actualizado")}catch(Je){console.error(Je),j(" Error al actualizar movimiento")}},se=async he=>{var Ee,Ze;if(confirm(`Eliminar este movimiento (${he.type==="ABONO"?"Abono":"Compra"}) del ${he.date}?${he.type==="CARGO"&&((Ee=he.ref)!=null&&Ee.saleId)?`
Se devolvern al inventario los dulces de esa venta.`:""}`))try{if(Ie(!0),he.type==="CARGO"&&((Ze=he.ref)!=null&&Ze.saleId)){try{await fx(he.ref.saleId)}catch($e){console.warn("restoreSaleAndDeleteCandy error",$e),Ie(!1),j(" No se pudo devolver inventario de la venta.");return}await g3(he.ref.saleId)}else await un(kt(Te,"ar_movements",he.id));const Je=lt.filter($e=>{var it,ft;return he.type==="CARGO"&&((it=he.ref)!=null&&it.saleId)?((ft=$e.ref)==null?void 0:ft.saleId)!==he.ref.saleId:$e.id!==he.id});Ue(Je),J(Je);const Ye=Je.reduce(($e,it)=>$e+(Number(it.amount)||0),0);Z($e=>$e.map(it=>it.id===(tt==null?void 0:tt.id)?{...it,balance:Ye}:it)),ot($e=>$e&&{...$e,balance:Ye}),j(" Movimiento eliminado")}catch(Je){console.error(Je),j(" Error al eliminar movimiento")}finally{Ie(!1)}},Fe=N.useMemo(()=>[...me].sort((he,Re)=>{var Ee,Ze;return he.status!==Re.status?he.status==="BLOQUEADO"?1:-1:(((Ee=Re.createdAt)==null?void 0:Ee.seconds)||0)-(((Ze=he.createdAt)==null?void 0:Ze.seconds)||0)}),[me]);return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Clientes (Dulces)"}),a.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{et(!0),i&&ge(s)},type:"button",children:"Crear Cliente"})]}),a.jsxs("div",{className:"bg-white p-2 rounded shadow border w-full",children:[a.jsx("div",{className:"hidden md:block",children:a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Nombre"}),a.jsx("th",{className:"p-2 border",children:"Telfono"}),a.jsx("th",{className:"p-2 border",children:"Vendedor"}),a.jsx("th",{className:"p-2 border",children:"Lugar"}),a.jsx("th",{className:"p-2 border",children:"Estado"}),a.jsx("th",{className:"p-2 border",children:"Lmite"}),a.jsx("th",{className:"p-2 border",children:"Saldo"}),a.jsx("th",{className:"p-2 border",children:"Comentario"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:ye?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Cargando"})}):Fe.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:10,children:"Sin clientes"})}):Fe.map(he=>{var Ee;const Re=Q===he.id;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:(Ee=he.createdAt)!=null&&Ee.toDate?he.createdAt.toDate().toISOString().slice(0,10):""}),a.jsx("td",{className:"p-2 border text-left",children:Re?a.jsx("input",{className:"w-full border p-1 rounded",value:R,onChange:Ze=>K(Ze.target.value)}):a.jsx("div",{className:"font-medium",children:he.name})}),a.jsx("td",{className:"p-2 border",children:Re?a.jsx("input",{className:"w-full border p-1 rounded",value:M,onChange:Ze=>re(cp(Ze.target.value))}):he.phone}),a.jsx("td",{className:"p-2 border",children:Re?a.jsxs("select",{className:"w-full border p-1 rounded text-xs",value:i?s:Y,onChange:Ze=>we(Ze.target.value),disabled:i,title:"Vendedor asociado",children:[a.jsx("option",{value:"",children:" Sin vendedor "}),l.map(Ze=>a.jsx("option",{value:Ze.id,children:Ze.name},Ze.id))]}):he.vendorName||""}),a.jsx("td",{className:"p-2 border",children:Re?a.jsxs("select",{className:"w-full border p-1 rounded",value:de,onChange:Ze=>le(Ze.target.value),children:[a.jsx("option",{value:"",children:""}),gC.map(Ze=>a.jsx("option",{value:Ze,children:Ze},Ze))]}):he.place||""}),a.jsx("td",{className:"p-2 border",children:Re?a.jsxs("select",{className:"w-full border p-1 rounded",value:ee,onChange:Ze=>z(Ze.target.value),children:[a.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),a.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${he.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:he.status})}),a.jsx("td",{className:"p-2 border",children:Re?a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(te)?"":te,onChange:Ze=>Ne(Math.max(0,Number(Ze.target.value||0)))}):Xo(he.creditLimit||0)}),a.jsx("td",{className:"p-2 border font-semibold",children:Xo(he.balance||0)}),a.jsx("td",{className:"p-2 border",children:Re?a.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-12",value:q,onChange:Ze=>Se(Ze.target.value),maxLength:500}):a.jsx("span",{title:he.notes||"",children:(he.notes||"").length>40?(he.notes||"").slice(0,40)+"":he.notes||""})}),a.jsx("td",{className:"p-2 border",children:a.jsx("div",{className:"flex gap-2 justify-center",children:Re?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:nr,children:"Guardar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Vt,children:"Cancelar"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Lt(he),children:"Editar"}),a.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>Mt(he),disabled:!o,title:o?"Borrar":"Solo admin",children:"Borrar"}),a.jsx("button",{className:"px-2 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>oe(he),title:"Ver compras y abonos",children:"Estado de cuenta"})]})})})]},he.id)})})]})}),a.jsx("div",{className:"md:hidden",children:ye?a.jsx("div",{className:"p-4 text-center text-sm",children:"Cargando"}):Fe.length===0?a.jsx("div",{className:"p-4 text-center text-sm",children:"Sin clientes"}):a.jsx("div",{className:"space-y-3",children:Fe.map(he=>{var Ze;const Re=Q===he.id,Ee=(Ze=he.createdAt)!=null&&Ze.toDate?he.createdAt.toDate().toISOString().slice(0,10):"";return a.jsxs("div",{className:"border rounded-2xl shadow-sm bg-white p-3",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Nombre"}),a.jsx("div",{className:"font-semibold truncate",children:Re?a.jsx("input",{className:"w-full border p-2 rounded",value:R,onChange:Je=>K(Je.target.value)}):he.name})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Estado"}),a.jsx("div",{children:Re?a.jsxs("select",{className:"border p-2 rounded text-sm",value:ee,onChange:Je=>z(Je.target.value),children:[a.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),a.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]}):a.jsx("span",{className:`inline-flex px-2 py-0.5 rounded text-xs ${he.status==="ACTIVO"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:he.status})})]})]}),a.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Fecha"}),a.jsx("div",{className:"font-medium",children:Ee})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Telfono"}),a.jsx("div",{className:"font-medium",children:Re?a.jsx("input",{className:"w-full border p-2 rounded",value:M,onChange:Je=>re(cp(Je.target.value))}):he.phone})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Vendedor"}),a.jsx("div",{className:"font-medium",children:Re?a.jsxs("select",{className:"w-full border p-2 rounded text-sm",value:i?s:Y,onChange:Je=>we(Je.target.value),disabled:i,title:"Vendedor asociado",children:[a.jsx("option",{value:"",children:" Sin vendedor "}),l.map(Je=>a.jsx("option",{value:Je.id,children:Je.name},Je.id))]}):he.vendorName||""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Lugar"}),a.jsx("div",{className:"font-medium",children:Re?a.jsxs("select",{className:"w-full border p-2 rounded text-sm",value:de,onChange:Je=>le(Je.target.value),children:[a.jsx("option",{value:"",children:""}),gC.map(Je=>a.jsx("option",{value:Je,children:Je},Je))]}):he.place||""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Lmite"}),a.jsx("div",{className:"font-medium",children:Re?a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:Number.isNaN(te)?"":te,onChange:Je=>Ne(Math.max(0,Number(Je.target.value||0)))}):Xo(he.creditLimit||0)})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Saldo"}),a.jsx("div",{className:"font-semibold",children:Xo(he.balance||0)})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Comentario"}),a.jsx("div",{className:"font-medium",children:Re?a.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:q,onChange:Je=>Se(Je.target.value),maxLength:500}):a.jsx("div",{title:he.notes||"",children:(he.notes||"").trim()?he.notes:""})})]})]}),a.jsx("div",{className:"mt-3",children:Re?a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-blue-600 hover:bg-blue-700",onClick:nr,children:"Guardar"}),a.jsx("button",{className:"px-3 py-2 rounded-xl bg-gray-200 hover:bg-gray-300",onClick:Vt,children:"Cancelar"})]}):a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Lt(he),children:"Editar"}),a.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700 disabled:opacity-50",onClick:()=>Mt(he),disabled:!o,title:o?"Borrar":"Solo admin",children:"Borrar"}),a.jsx("button",{className:"px-3 py-2 rounded-xl text-white bg-indigo-600 hover:bg-indigo-700",onClick:()=>oe(he),children:"Estado"})]})})]},he.id)})})})]}),I&&a.jsx("p",{className:"mt-2 text-sm",children:I}),Zt&&$A.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>et(!1)}),a.jsxs("div",{className:"relative bg-white rounded-lg shadow-2xl border w-[96%] max-w-3xl max-h-[92vh] overflow-auto p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-lg font-bold",children:"Crear Cliente"}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>et(!1),type:"button",children:"Cerrar"})]}),a.jsxs("form",{onSubmit:er,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),a.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Mara Lpez",value:b,onChange:he=>w(he.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),a.jsx("input",{className:"w-full border p-2 rounded",value:k,onChange:he=>O(cp(he.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:L,onChange:he=>E(he.target.value),children:[a.jsx("option",{value:"",children:""}),gC.map(he=>a.jsx("option",{value:he,children:he},he))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:U,onChange:he=>_(he.target.value),children:[a.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),a.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor asociado"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:i?s:X,onChange:he=>ge(he.target.value),disabled:i,children:[a.jsx("option",{value:"",children:" Sin vendedor "}),l.map(he=>a.jsx("option",{value:he.id,children:he.name},he.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Deuda inicial"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ae===0?"":ae,onChange:he=>fe(Math.max(0,Number(he.target.value||0))),placeholder:"Ej: 1500"}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Este valor queda fijo (no cambia)."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:F===0?"":F,onChange:he=>D(Math.max(0,Number(he.target.value||0))),placeholder:"Ej: 2000"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),a.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:B,onChange:he=>S(he.target.value),maxLength:500,placeholder:"Notas del cliente"}),a.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[B.length,"/500"]})]}),a.jsxs("div",{className:"md:col-span-2 flex justify-end gap-2",children:[a.jsx("button",{type:"button",className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>et(!1),children:"Cancelar"}),a.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar cliente"})]})]})]})]}),document.body),Pe&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h3",{className:"text-lg font-bold",children:["Estado de cuenta  ",(tt==null?void 0:tt.name)||""]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>{rt(0),Oe(new Date().toISOString().slice(0,10)),Ve(""),ie(!0)},children:"Abonar"}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>Qe(!1),children:"Cerrar"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-3",children:[a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Deuda inicial"}),a.jsx("div",{className:"text-xl font-semibold",children:Xo(Number((tt==null?void 0:tt.initialDebt)||0))})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),a.jsx("div",{className:"text-xl font-semibold",children:Xo(Xe.saldoActual)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Total abonado"}),a.jsx("div",{className:"text-xl font-semibold",children:Xo(Xe.totalAbonado)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Saldo restante"}),a.jsx("div",{className:"text-xl font-semibold",children:Xo(Xe.saldoActual)})]})]}),a.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Tipo"}),a.jsx("th",{className:"p-2 border",children:"Referencia"}),a.jsx("th",{className:"p-2 border",children:"Comentario"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:dt?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Cargando"})}):lt.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"p-4 text-center",children:"Sin movimientos"})}):lt.map(he=>{var Ee,Ze;const Re=Me===he.id;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:Re?a.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:He,onChange:Je=>st(Je.target.value)}):he.date||""}),a.jsx("td",{className:"p-2 border",children:he.amount>=0?(Ee=he.ref)!=null&&Ee.saleId?a.jsx("button",{type:"button",className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700 underline",title:"Ver dulces de esta compra",onClick:()=>x(he.ref.saleId),children:"COMPRA (CARGO)"}):a.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"COMPRA (CARGO)"}):a.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"ABONO"})}),a.jsx("td",{className:"p-2 border",children:(Ze=he.ref)!=null&&Ze.saleId?`Venta #${he.ref.saleId}`:""}),a.jsx("td",{className:"p-2 border",children:Re?a.jsx("input",{className:"w-full border p-1 rounded",value:Ot,onChange:Je=>tr(Je.target.value),placeholder:"Comentario"}):a.jsx("span",{title:he.comment||"",children:(he.comment||"").length>40?(he.comment||"").slice(0,40)+"":he.comment||""})}),a.jsx("td",{className:"p-2 border font-semibold",children:Re?a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(Ct)?"":Ct,onChange:Je=>{const Ye=Number(Je.target.value||0),$e=Number.isFinite(Ye)?Math.max(0,parseFloat(Ye.toFixed(2))):0;Xt($e)},placeholder:"0.00",title:he.type==="ABONO"?"Se guardar como negativo":"Se guardar como positivo"}):Xo(he.amount)}),a.jsx("td",{className:"p-2 border",children:Re?a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:De,children:"Guardar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:Be,children:"Cancelar"})]}):a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>pe(he),children:"Editar"}),a.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>se(he),children:"Borrar"})]})})]},he.id)})})]})})]})}),ve&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border w-[95%] max-w-md p-4",children:[a.jsxs("h3",{className:"text-lg font-bold",children:["Registrar abono  ",(tt==null?void 0:tt.name)||""]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),a.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:At,onChange:he=>Oe(he.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Monto del abono"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ze===0?"":ze,onChange:he=>{const Re=Number(he.target.value||0),Ee=Number.isFinite(Re)?Math.max(0,parseFloat(Re.toFixed(2))):0;rt(Ee)},placeholder:"0.00"}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Se guarda con 2 decimales (se registrar como ABONO negativo)."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Comentario (opcional)"}),a.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:at,onChange:he=>Ve(he.target.value),maxLength:250,placeholder:"Ej: Abono en efectivo"}),a.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[at.length,"/250"]})]})]}),a.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[a.jsx("button",{className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>ie(!1),disabled:G,children:"Cancelar"}),a.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",onClick:ce,disabled:G,children:G?"Guardando...":"Guardar abono"})]})]})}),d&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[65]",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h3",{className:"text-lg font-bold",children:["Dulces vendidos"," ",h?` #${h}`:""]}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>A(!1),children:"Cerrar"})]}),a.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border text-right",children:"Cantidad"}),a.jsx("th",{className:"p-2 border text-right",children:"Precio"}),a.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),a.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),a.jsx("tbody",{children:u?a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):p.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):p.map((he,Re)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border text-left",children:he.productName}),a.jsx("td",{className:"p-2 border text-right",children:he.qty}),a.jsx("td",{className:"p-2 border text-right",children:Xo(he.unitPrice)}),a.jsx("td",{className:"p-2 border text-right",children:Xo(he.discount||0)}),a.jsx("td",{className:"p-2 border text-right",children:Xo(he.total)})]},Re))})]})})]})})]})}const Mu=t=>`C$ ${(Number(t)||0).toFixed(2)}`,t1e=["Altagracia","Taguizapa","El paso","Calaysa","Urbaite","Las Pilas"];function r1e(t){switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function n1e(t){switch(t){case"Rivas":return"RIVAS";case"San Jorge":return"SAN_JORGE";case"Isla Ometepe":return"ISLA";default:return"RIVAS"}}function s1e(t){const{saleId:e,date:r,customerName:n,branch:s,items:i,total:o,vendorName:l,vendorCommissionPercent:c,vendorCommissionAmount:d}=t,A=new cr;let u=12;if(A.setFontSize(16),A.text("Multiservicios Ortiz",10,u),u+=6,A.setFontSize(12),A.text("Recibo de venta certificada",10,u),u+=8,A.setFontSize(12),A.text(`Fecha: ${r}`,10,u),u+=5,A.text(`Cliente: ${n||"Cliente Mostrador"}`,10,u),u+=5,A.text(`Sucursal: ${r1e(s)}`,10,u),u+=5,A.text(`Autorizado: ${e}`,10,u),u+=5,l&&(A.text(`Vendedor: ${l}`,10,u),u+=5),typeof c=="number"){const f=Number(d||0).toFixed(2),h=c.toFixed(2);A.text(`Comisin vendedor: ${h}%  C$ ${f}`,10,u),u+=8}else u+=3;A.setFontSize(12),A.text("Producto",10,u),A.text("Paquetes",110,u,{align:"right"}),A.text("Precio.",150,u,{align:"right"}),A.text("Subtotal",190,u,{align:"right"}),u+=4,A.line(10,u,190,u),u+=4,i.forEach(f=>{u>270&&(A.addPage(),u=12);const h=(f.productName||"").length>50?f.productName.slice(0,47)+"...":f.productName;A.text(h,10,u),A.text(String(f.qty),110,u,{align:"right"}),A.text(`C$ ${Number(f.unitPrice||0).toFixed(2)}`,150,u,{align:"right"}),A.text(`C$ ${Number(f.total||0).toFixed(2)}`,190,u,{align:"right"}),u+=5}),u+=4,A.line(10,u,190,u),u+=6,A.setFontSize(13),A.text(`Total: C$ ${Number(o||0).toFixed(2)}`,190,u,{align:"right"}),u+=6,A.setFontSize(9),A.text("Gracias por su compra.",10,u),A.save(`venta_dulces_${e}.pdf`)}async function x3(t,e){if(!t||!e)return 0;const r=Dt(ht(Te,"inventory_candies_sellers"),Gt("sellerId","==",e),Gt("productId","==",t)),n=await Nt(r);let s=0;return n.forEach(i=>{const o=i.data(),l=Number(o.remainingUnits??o.remaining??o.totalUnits??0);l>0&&(s+=l)}),s}const v3=()=>{const t=new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,10)};async function a1e(t){const{productId:e,vendorId:r,quantityUnits:n,saleDate:s,saleId:i}=t;let o=Math.max(0,Math.floor(Number(n||0)));const l=[];if(!e||!r||o<=0)return{allocations:[]};const c=Dt(ht(Te,"inventory_candies_sellers"),Gt("sellerId","==",r),Gt("productId","==",e),Gt("remainingUnits",">",0),Ur("date","asc"),Ur("createdAt","asc")),d=await Nt(c);for(const A of d.docs){if(o<=0)break;const u=A.data(),f=Number(u.remainingUnits||0);if(f<=0)continue;const h=Math.min(f,o),m=f-h,p=Math.max(1,Math.floor(Number(u.unitsPerPackage||1))),g=Math.floor(m/p);await Pr(A.ref,{remainingUnits:m,remainingPackages:g}),l.push({inventorySellerId:A.id,productId:e,units:h,saleDate:s,saleId:i}),o-=h}return o>0&&console.warn("[allocateSaleFIFOCandyFromVendor] No alcanz el inventario del vendedor, faltaron unidades.",{productId:e,vendorId:r,remaining:o}),{allocations:l}}function y3(t){const e="+505 ";if(!t.startsWith(e)){const n=t.replace(/\D/g,"");return e+n.slice(0,8)}const r=t.slice(e.length).replace(/\D/g,"");return e+r.slice(0,8)}function i1e({role:t="",sellerCandyId:e="",currentUserEmail:r}){const[n,s]=N.useState([]),[i,o]=N.useState([]),[l,c]=N.useState([]),[d,A]=N.useState({}),[u,f]=N.useState("CONTADO"),[h,m]=N.useState("RIVAS"),[p,g]=N.useState(""),[x,b]=N.useState(""),[w,k]=N.useState(v3()),[O,L]=N.useState(""),[E,B]=N.useState(!1),[S,U]=N.useState(""),[_,F]=N.useState([]),D=N.useMemo(()=>_.reduce((Oe,at)=>Oe+(at.qtyPackages||0),0),[_]),X=N.useMemo(()=>_.reduce((Oe,at)=>Oe+(at.qtyPackages||0)*(at.unitsPerPackage||1),0),[_]),ge=N.useMemo(()=>{const Oe=_.reduce((at,Ve)=>{const G=(Number(Ve.pricePerPackage)||0)*(Ve.qtyPackages||0),_e=Number(Ve.discount)||0,Me=Math.max(0,G-_e);return at+Me},0);return Math.floor(Oe*100)/100},[_]),[ae,fe]=N.useState(0),[me,Z]=N.useState(""),[ye,Ie]=N.useState(!1),[I,j]=N.useState(!1),[Q,T]=N.useState(""),[R,K]=N.useState("+505 "),[M,re]=N.useState(""),[de,le]=N.useState(""),[q,Se]=N.useState("ACTIVO"),[ee,z]=N.useState(0),[te,Ne]=N.useState(""),Y=()=>{T(""),K("+505 "),re(""),le(""),Se("ACTIVO"),z(0)},we=N.useMemo(()=>n.find(Oe=>Oe.id===p),[n,p]),Pe=N.useMemo(()=>E&&O?n.filter(Oe=>(Oe.vendorId??Oe.sellerId??"")===O):n,[n,E,O]),Qe=(we==null?void 0:we.balance)||0,tt=u==="CREDITO"?Qe+Math.max(0,Number(ge||0))-Math.max(0,Number(ae||0)):0,ot=N.useMemo(()=>l.find(Oe=>Oe.id===O)||null,[l,O]),dt=(ot==null?void 0:ot.commissionPercent)||0,vt=N.useMemo(()=>{const Oe=Number(ge||0),at=Number(dt||0),Ve=Oe*at/100;return Number(Ve.toFixed(2))},[ge,dt]);N.useEffect(()=>{(async()=>{const Oe=Dt(ht(Te,"customers_candies"),Ur("createdAt","desc")),at=await Nt(Oe),Ve=[];at.forEach(We=>{const He=We.data();Ve.push({id:We.id,name:He.name??"",phone:He.phone??"+505 ",place:He.place??"",status:He.status??"ACTIVO",creditLimit:Number(He.creditLimit??0),balance:0,sellerId:He.sellerId??He.vendorId??"",vendorId:He.vendorId??He.sellerId??""})});for(const We of Ve)try{const He=Dt(ht(Te,"ar_movements"),Gt("customerId","==",We.id)),st=await Nt(He);let Ct=0;st.forEach(Xt=>Ct+=Number(Xt.data().amount||0)),We.balance=Ct}catch{We.balance=0}s(Ve);const G=Dt(ht(Te,"products_candies"),Ur("createdAt","desc")),_e=await Nt(G),Me=[];_e.forEach(We=>{const He=We.data();Me.push({id:We.id,name:He.name??"(sin nombre)",sku:He.sku??"",unitsPerPackage:Number(He.unitsPerPackage??1),priceRivas:Number(He.unitPriceRivas??0),priceSanJorge:Number(He.unitPriceSanJorge??0),priceIsla:Number(He.unitPriceIsla??0)})}),o(Me);try{const We=await Nt(ht(Te,"sellers_candies")),He=[];We.forEach(st=>{const Ct=st.data(),Xt=Ct.branch||"Rivas",Ot=n1e(Xt);He.push({id:st.id,name:Ct.name??"(sin nombre)",branch:Ot,branchLabel:Xt,commissionPercent:Number(Ct.commissionPercent??0)})}),c(He)}catch(We){console.error("Error cargando vendedores:",We)}A({})})()},[]),N.useEffect(()=>{if(t==="vendedor_dulces"&&e){L(e),B(!0);try{localStorage.setItem("pos_vendorId",e),localStorage.setItem("pos_role","VENDEDOR")}catch{}return}if(t==="admin"){B(!1);return}try{const Oe=localStorage.getItem("pos_vendorId")||"",at=localStorage.getItem("pos_role")||"";Oe&&L(Oe),at.toUpperCase()==="VENDEDOR"&&B(!0)}catch{}},[t,e]);const lt=async Oe=>{if(!Oe){A({});return}const at=Dt(ht(Te,"inventory_candies_sellers"),Gt("sellerId","==",Oe)),Ve=await Nt(at),G={};Ve.forEach(_e=>{const Me=_e.data(),We=Me.productId||"";if(!We)return;const He=Number(Me.remainingUnits??Me.remaining??Me.totalUnits??0);He<=0||(G[We]=(G[We]||0)+He)}),A(G),F(_e=>{const Me=[];for(const We of _e){const He=G[We.productId]??0;He>0&&Me.push({...We,availableUnits:He})}return Me})};N.useEffect(()=>{if(!O){A({});return}const Oe=l.find(at=>at.id===O);Oe&&m(Oe.branch),lt(O)},[O,l]),N.useEffect(()=>{F(Oe=>Oe.map(at=>{const Ve=i.find(_e=>_e.id===at.productId);if(!Ve)return at;const G=h==="RIVAS"?Ve.priceRivas:h==="SAN_JORGE"?Ve.priceSanJorge:Ve.priceIsla;return{...at,pricePerPackage:Number(G)||0}}))},[h,i]);async function Ue(Oe){const{productId:at,vendorId:Ve,branch:G}=Oe;if(!at||!Ve)return 0;const _e=Dt(ht(Te,"inventory_candies_sellers"),Gt("sellerId","==",Ve),Gt("productId","==",at)),Me=await Nt(_e);if(Me.empty)return 0;const We=Me.docs[0].data(),He=Number(We.unitPriceVendor??0);if(He>0)return He;const st=Number(G==="RIVAS"?We.unitPriceRivas??0:G==="SAN_JORGE"?We.unitPriceSanJorge??0:We.unitPriceIsla??0);return Number(st||0)}const Xe=async Oe=>{var We;if(!Oe)return;if(!O){Z("Selecciona primero el vendedor para usar su inventario."),U("");return}if(_.some(He=>He.productId===Oe)){U("");return}const at=i.find(He=>He.id===Oe);if(!at){U("");return}const Ve=await x3(Oe,O),G=((We=l.find(He=>He.id===O))==null?void 0:We.branch)??h,_e=await Ue({productId:Oe,vendorId:O,branch:G}),Me={productId:Oe,productName:at.name||"",sku:at.sku||"",unitsPerPackage:at.unitsPerPackage||1,pricePerPackage:Number(_e)||0,availableUnits:Number(Ve)||0,qtyPackages:0,discount:0};F(He=>[...He,Me]),U("")},xe=(Oe,at)=>{F(Ve=>Ve.map(G=>{if(G.productId!==Oe)return G;if(at==="")return{...G,qtyPackages:0};const _e=Math.max(0,Math.floor(Number(at)));return{...G,qtyPackages:_e}}))},ve=(Oe,at)=>{F(Ve=>Ve.map(G=>{if(G.productId!==Oe)return G;if(at==="")return{...G,discount:0};const _e=Math.max(0,Math.floor(Number(at)));return{...G,discount:_e}}))},ie=Oe=>F(at=>at.filter(Ve=>Ve.productId!==Oe)),ze=async()=>{if(!w)return"Selecciona la fecha.";if(!O)return"Selecciona el vendedor para esta venta.";if(_.length===0)return"Agrega al menos un producto.";const Oe=_.filter(at=>(at.qtyPackages||0)>0);if(Oe.length===0)return"Debes ingresar cantidades (> 0) en al menos un producto.";if(!(ge>0))return"El total debe ser mayor a cero.";if(u==="CONTADO"){if(!x.trim())return"Ingresa el nombre del cliente (contado)."}else{if(!p)return"Selecciona un cliente (crdito).";if(ae<0)return"El pago inicial no puede ser negativo.";if(ae>ge)return"El pago inicial no puede superar el total.";if((we==null?void 0:we.status)==="BLOQUEADO")return"El cliente est BLOQUEADO. No se puede facturar a crdito."}for(const at of Oe){const Ve=at.unitsPerPackage||1,G=(at.qtyPackages||0)*Ve,_e=await x3(at.productId,O),Me=Math.floor(_e/Ve);if(G>_e)return`Inventario insuficiente en el pedido del vendedor para "${at.productName}". Disponible: ${Me} paquetes.`;const We=(Number(at.pricePerPackage)||0)*(at.qtyPackages||0),He=Number(at.discount)||0;if(!Number.isInteger(He)||He<0)return`El descuento en "${at.productName}" debe ser entero y  0.`;if(He>We)return`El descuento en "${at.productName}" no puede exceder C$ ${We.toFixed(2)}.`}return null},rt=async Oe=>{Oe.preventDefault(),Z("");const at=await ze();if(at){Z(" "+at);return}try{Ie(!0);const Ve=_.filter(He=>(He.qtyPackages||0)>0).map(He=>{const st=He.unitsPerPackage||1,Ct=He.qtyPackages||0,Xt=Ct*st,Ot=(Number(He.pricePerPackage)||0)*(Ct||0),tr=Math.max(0,Math.floor(Number(He.discount)||0)),Zt=Math.max(0,Ot-tr);return{productId:He.productId,productName:He.productName,sku:He.sku||"",qty:Xt,packages:Ct,unitsPerPackage:st,branch:h,unitPricePackage:Number(He.pricePerPackage)||0,discount:tr,total:Math.floor(Zt*100)/100}}),G={type:u,branch:h,date:w,createdAt:$t.now(),itemsTotal:Number(ge)||0,total:Number(ge)||0,quantity:Number(X)||0,packagesTotal:Number(D)||0,items:Ve,vendorId:O},_e=l.find(He=>He.id===O);_e&&(G.vendorName=_e.name,G.vendorBranch=_e.branch,G.vendorBranchLabel=_e.branchLabel,G.vendorCommissionPercent=_e.commissionPercent||0,G.vendorCommissionAmount=vt||0),u==="CONTADO"?G.customerName=x.trim():(G.customerId=p,G.downPayment=Number(ae)||0);const Me=await Jr(ht(Te,"sales_candies"),G);if(u==="CONTADO"){const He=(x||"").trim();if(He)try{await Jr(ht(Te,"cash_customers"),{name:He,date:w,branch:h,vendorId:O,createdAt:$t.now()})}catch(st){console.warn("No se pudo guardar cash_customer:",st)}}if(u==="CREDITO"&&p){const He={customerId:p,date:w,createdAt:$t.now(),ref:{saleId:Me.id}},st=Number((we==null?void 0:we.balance)||0);if(await Jr(ht(Te,"ar_movements"),{...He,type:"CARGO",amount:Number(ge)||0}),Number(ae)>0&&await Jr(ht(Te,"ar_movements"),{...He,type:"ABONO",amount:-Number(ae)}),st===0)try{await Pr(kt(Te,"customers_candies",p),{initialDebt:Number(ge)||0,initialDebtDate:w})}catch(Ct){console.warn("No se pudo setear initialDebt:",Ct)}}const We={};for(const He of Ve)if(He.qty>0){const{allocations:st}=await a1e({productId:He.productId,vendorId:O,quantityUnits:He.qty,saleDate:w,saleId:Me.id});We[He.productId]={productId:He.productId,vendorId:O,allocations:st}}await Pr(kt(Te,"sales_candies",Me.id),{allocationsByItem:We});try{const He=u==="CONTADO"?x.trim()||"Cliente Mostrador":(we==null?void 0:we.name)||"Cliente crdito";s1e({saleId:Me.id,date:w,customerName:He,branch:h,items:Ve.map(st=>({productName:st.productName,qty:st.packages,unitPrice:st.unitPricePackage,total:st.total})),total:Number(ge)||0,vendorName:_e==null?void 0:_e.name,vendorCommissionPercent:(_e==null?void 0:_e.commissionPercent)||0,vendorCommissionAmount:vt})}catch(He){console.error("Error generando voucher PDF:",He)}f("CONTADO"),g(""),b(""),k(v3()),F([]),fe(0),u==="CREDITO"&&p&&s(He=>He.map(st=>st.id===p?{...st,balance:(st.balance||0)+(Number(ge)||0)-(Number(ae)||0)}:st)),Z(" Venta de dulces registrada"),O?await lt(O):A({})}catch(Ve){console.error(Ve),Z(" Error al guardar la venta de dulces")}finally{Ie(!1)}},At=N.useMemo(()=>i.filter(Oe=>{const at=d[Oe.id]||0,Ve=Math.max(1,Number(Oe.unitsPerPackage||1));return Math.floor(at/Ve)>0}).sort((Oe,at)=>(Oe.name||"").localeCompare(at.name||"")),[i,d]);return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-3",children:a.jsx("h2",{className:"text-2xl font-bold",children:"Ventas (Dulces)"})}),a.jsxs("form",{onSubmit:rt,className:"bg-white p-3 sm:p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Tipo de cliente"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:u,onChange:Oe=>f(Oe.target.value),children:[a.jsx("option",{value:"CONTADO",children:"Contado"}),a.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),u==="CONTADO"?a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Nombre del cliente (contado)"}),a.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Ej: Cliente Mostrador",value:x,onChange:Oe=>b(Oe.target.value)})]}):a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Cliente (crdito)"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs("select",{className:"w-full sm:flex-1 border p-2 rounded",value:p,onChange:Oe=>g(Oe.target.value),children:[a.jsx("option",{value:"",children:"Selecciona un cliente"}),Pe.map(Oe=>a.jsxs("option",{value:Oe.status==="ACTIVO"?Oe.id:"",disabled:Oe.status==="BLOQUEADO",children:[Oe.name," | ",Oe.phone," | Saldo: ",Mu(Oe.balance||0)]},Oe.id))]}),a.jsx("button",{type:"button",className:"w-full sm:w-auto px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:()=>j(!0),children:"Crear Cliente"})]}),a.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),a.jsx("div",{className:"text-lg font-semibold",children:Mu(Qe)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Pago inicial (opcional)"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ae===0?"":ae,onChange:Oe=>fe(Math.max(0,Number(Oe.target.value||0))),placeholder:"0.00"})]}),a.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Saldo proyectado"}),a.jsx("div",{className:"text-lg font-semibold",children:Mu(tt)})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Fecha de venta"}),a.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:w,onChange:Oe=>k(Oe.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:O,onChange:Oe=>{L(Oe.target.value),F([])},disabled:E,children:[a.jsx("option",{value:"",children:"Selecciona un vendedor"}),l.map(Oe=>a.jsxs("option",{value:Oe.id,children:[Oe.name,"  ",Oe.branchLabel,"  ",Oe.commissionPercent.toFixed(2),"%"," comisin"]},Oe.id))]}),E&&a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vendedor fijado por el usuario logueado."})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Lista de precios / Sucursal"}),a.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[a.jsxs("label",{className:"inline-flex items-center gap-1",children:[a.jsx("input",{type:"radio",className:"accent-blue-600",value:"RIVAS",checked:h==="RIVAS",readOnly:!0,disabled:!0}),a.jsx("span",{children:"Rivas"})]}),a.jsxs("label",{className:"inline-flex items-center gap-1",children:[a.jsx("input",{type:"radio",className:"accent-blue-600",value:"SAN_JORGE",checked:h==="SAN_JORGE",readOnly:!0,disabled:!0}),a.jsx("span",{children:"San Jorge"})]}),a.jsxs("label",{className:"inline-flex items-center gap-1",children:[a.jsx("input",{type:"radio",className:"accent-blue-600",value:"ISLA",checked:h==="ISLA",readOnly:!0,disabled:!0}),a.jsx("span",{children:"Isla de Ometepe"})]})]}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"La sucursal se toma automticamente del vendedor seleccionado."})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:S,onChange:async Oe=>{const at=Oe.target.value;U(at),await Xe(at)},disabled:!O,children:[a.jsx("option",{value:"",children:O?"Selecciona un producto":"Selecciona un vendedor primero"}),At.map(Oe=>{const at=_.some(Me=>Me.productId===Oe.id),Ve=d[Oe.id]||0,G=Math.max(1,Number(Oe.unitsPerPackage||1)),_e=Math.floor(Ve/G);return _e<=0?null:a.jsxs("option",{value:at?"":Oe.id,disabled:at,children:[Oe.name," ",Oe.sku?` ${Oe.sku}`:""," (disp: ",_e," ","paq.)",at?" ":""]},Oe.id)})]}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"El selector solo muestra productos disponibles del pedido del vendedor seleccionado (sin ceros)."})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("div",{className:"w-full overflow-x-auto",children:a.jsxs("div",{className:"border rounded overflow-hidden min-w-[860px]",children:[a.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 px-3 py-2 text-xs font-semibold border-b",children:[a.jsx("div",{className:"col-span-4",children:"Producto"}),a.jsx("div",{className:"col-span-2 text-right",children:"Precio (paq.)"}),a.jsx("div",{className:"col-span-2 text-right",children:"Existencias (paq.)"}),a.jsx("div",{className:"col-span-1 text-right",children:"Cantidad (paq.)"}),a.jsx("div",{className:"col-span-1 text-right",children:"Descuento"}),a.jsx("div",{className:"col-span-1 text-right",children:"Monto"}),a.jsx("div",{className:"col-span-1 text-center",children:"Quitar"})]}),_.length===0?a.jsx("div",{className:"px-3 py-4 text-sm text-gray-500",children:"No hay productos agregados."}):_.map(Oe=>{const at=d[Oe.productId]??Oe.availableUnits??0,Ve=Oe.unitsPerPackage?Math.floor(at/Oe.unitsPerPackage):0,G=Math.max(0,Ve-(Oe.qtyPackages||0)),_e=(Number(Oe.pricePerPackage)||0)*(Oe.qtyPackages||0),Me=Math.max(0,_e-(Number(Oe.discount)||0));return a.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 border-b text-sm gap-x-2",children:[a.jsx("div",{className:"col-span-4",children:a.jsxs("div",{className:"font-medium",children:[Oe.productName,Oe.sku?`  ${Oe.sku}`:""]})}),a.jsx("div",{className:"col-span-2 text-right",children:Mu(Oe.pricePerPackage)}),a.jsxs("div",{className:"col-span-2 text-right",children:[G," paq."]}),a.jsx("div",{className:"col-span-1",children:a.jsx("input",{type:"number",step:"0",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(Oe.qtyPackages)||Oe.qtyPackages===0?"":Oe.qtyPackages,onChange:We=>xe(Oe.productId,We.target.value),inputMode:"numeric",placeholder:"0",title:"Cantidad de paquetes"})}),a.jsx("div",{className:"col-span-1",children:a.jsx("input",{type:"number",step:"1",min:0,className:"w-full border p-1 rounded text-right",value:Number.isNaN(Oe.discount)||Oe.discount===0?"":Oe.discount,onChange:We=>ve(Oe.productId,We.target.value),inputMode:"numeric",placeholder:"0",title:"Descuento entero (C$)"})}),a.jsx("div",{className:"col-span-1 text-right",children:Mu(Me)}),a.jsx("div",{className:"col-span-1 text-center",children:a.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-100 hover:bg-red-200",onClick:()=>ie(Oe.productId),title:"Quitar producto",children:""})})]},Oe.productId)})]})}),_.length>0&&a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-2 sm:gap-6 mt-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Paquetes totales: "}),a.jsx("span",{className:"font-semibold",children:D})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Total: "}),a.jsx("span",{className:"font-semibold",children:Mu(ge)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Comisin vendedor: "}),a.jsxs("span",{className:"font-semibold",children:[Mu(vt)," ",dt?`(${dt.toFixed(2)}%)`:""]})]})]})]}),a.jsx("div",{className:"md:col-span-2",children:a.jsx("button",{className:"w-full sm:w-auto bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",disabled:ye,children:ye?"Guardando...":"Registrar venta"})})]}),me&&a.jsx("p",{className:"mt-2 text-sm",children:me}),I&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-2 sm:p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[98%] sm:w-[95%] max-w-xl p-3 sm:p-4 max-h-[92vh] overflow-auto",children:[a.jsx("h3",{className:"text-lg font-bold mb-3",children:"Nuevo cliente"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Nombre"}),a.jsx("input",{className:"w-full border p-2 rounded",value:Q,onChange:Oe=>T(Oe.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Telfono"}),a.jsx("input",{className:"w-full border p-2 rounded",value:R,onChange:Oe=>K(y3(Oe.target.value)),placeholder:"+505 88888888",inputMode:"numeric"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Lugar"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:M,onChange:Oe=>re(Oe.target.value),children:[a.jsx("option",{value:"",children:""}),t1e.map(Oe=>a.jsx("option",{value:Oe,children:Oe},Oe))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:q,onChange:Oe=>Se(Oe.target.value),children:[a.jsx("option",{value:"ACTIVO",children:"ACTIVO"}),a.jsx("option",{value:"BLOQUEADO",children:"BLOQUEADO"})]})]}),!E&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:te,onChange:Oe=>Ne(Oe.target.value),children:[a.jsx("option",{value:"",children:"Selecciona un vendedor"}),l.filter(Oe=>(Oe.status??"ACTIVO")==="ACTIVO").map(Oe=>a.jsxs("option",{value:Oe.id,children:[Oe.name,"  ",Oe.branchLabel]},Oe.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Lmite de crdito (opcional)"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded",value:ee===0?"":ee,onChange:Oe=>z(Math.max(0,Number(Oe.target.value||0))),placeholder:"Ej: 2000"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),a.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:de,onChange:Oe=>le(Oe.target.value),maxLength:500})]})]}),a.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-end gap-2",children:[a.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{Y(),j(!1)},children:"Cancelar"}),a.jsx("button",{className:"w-full sm:w-auto px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:async()=>{var Ve;const Oe=E?O||e:te;if(!Oe){Z("Selecciona el vendedor para asociar este cliente.");return}if(Z(""),!Q.trim()){Z("Ingresa el nombre del nuevo cliente.");return}const at=y3(R);try{const G=await Jr(ht(Te,"customers_candies"),{name:Q.trim(),phone:at,place:M||"",notes:de||"",status:q,creditLimit:Number(ee||0),createdAt:$t.now(),sellerId:Oe,vendorId:Oe,vendorName:((Ve=l.find(Me=>Me.id===Oe))==null?void 0:Ve.name)||""}),_e={id:G.id,name:Q.trim(),phone:at,place:M||"",status:q,creditLimit:Number(ee||0),balance:0,sellerId:Oe};s(Me=>[_e,...Me]),g(G.id),Y(),j(!1),Z(" Cliente creado")}catch(G){console.error(G),Z(" Error al crear cliente")}},children:"Guardar cliente"})]})]})}),ye&&a.jsx("div",{className:"fixed inset-0 z-[70] bg-black/40 flex items-center justify-center p-2",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border px-4 py-3 flex items-center gap-3",children:[a.jsxs("svg",{className:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),a.jsx("span",{className:"font-medium",children:"Guardando venta"})]})})]})}const b3=["Energia","Bolsas","Detergentes","Limpieza de Freezer","Delivery","Pago a Personal"],L1=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function o1e(){const[t,e]=N.useState(or(jc(new Date),"yyyy-MM-dd")),[r,n]=N.useState(or(Ic(new Date),"yyyy-MM-dd")),[s,i]=N.useState(or(new Date,"yyyy-MM-dd")),[o,l]=N.useState(""),[c,d]=N.useState(""),[A,u]=N.useState(0),[f,h]=N.useState("PENDIENTE"),[m,p]=N.useState(""),[g,x]=N.useState([]),[b,w]=N.useState(!0),[k,O]=N.useState(""),[L,E]=N.useState(null),[B,S]=N.useState(""),[U,_]=N.useState(""),[F,D]=N.useState(""),[X,ge]=N.useState(0),[ae,fe]=N.useState("PENDIENTE"),[me,Z]=N.useState("");N.useEffect(()=>{(async()=>{w(!0);try{const M=Dt(ht(Te,"expenses_candies"),Ur("date","desc")),re=await Nt(M),de=[];re.forEach(le=>{const q=le.data();de.push({id:le.id,date:q.date||or(new Date,"yyyy-MM-dd"),category:q.category||"",description:q.description||"",amount:Number(q.amount||0),status:q.status||"PENDIENTE",notes:q.notes||"",createdAt:q.createdAt??$t.now()})}),x(de)}catch(M){console.error(M),O(" Error al cargar gastos")}finally{w(!1)}})()},[]);const ye=N.useMemo(()=>g.filter(M=>!(t&&M.date<t||r&&M.date>r)),[g,t,r]),Ie=N.useMemo(()=>{const M=ye.reduce((le,q)=>le+(q.amount||0),0),re=ye.filter(le=>le.status==="PAGADO").reduce((le,q)=>le+(q.amount||0),0),de=M-re;return{total:M,pagado:re,pendiente:de}},[ye]),I=()=>{i(or(new Date,"yyyy-MM-dd")),l(""),d(""),u(0),h("PENDIENTE"),p("")},j=async M=>{if(M.preventDefault(),O(""),!o){O("Selecciona una categora.");return}if(!c.trim()){O("Ingresa una descripcin.");return}if(!A||A<=0){O("Ingresa un monto vlido.");return}try{const re=await Jr(ht(Te,"expenses_candies"),{date:s,category:o,description:c.trim(),amount:Number(A.toFixed(2)),status:f,notes:m||"",createdAt:$t.now()});x(de=>[{id:re.id,date:s,category:o,description:c.trim(),amount:Number(A.toFixed(2)),status:f,notes:m||"",createdAt:$t.now()},...de]),I(),O(" Gasto registrado")}catch(re){console.error(re),O(" Error al guardar gasto")}},Q=M=>{E(M.id),S(M.date),_(M.category||""),D(M.description||""),ge(Number(M.amount||0)),fe(M.status||"PENDIENTE"),Z(M.notes||"")},T=()=>{E(null),S(""),_(""),D(""),ge(0),fe("PENDIENTE"),Z("")},R=async()=>{if(L){if(!U){O("Selecciona una categora.");return}if(!F.trim()){O("Ingresa una descripcin.");return}if(!X||X<=0){O("Ingresa un monto vlido.");return}try{await Pr(kt(Te,"expenses_candies",L),{date:B,category:U,description:F.trim(),amount:Number(X.toFixed(2)),status:ae,notes:me||""}),x(M=>M.map(re=>re.id===L?{...re,date:B,category:U,description:F.trim(),amount:Number(X.toFixed(2)),status:ae,notes:me||""}:re)),T(),O(" Gasto actualizado")}catch(M){console.error(M),O(" Error al actualizar gasto")}}},K=async M=>{confirm(`Eliminar el gasto "${M.description}"?`)&&(await un(kt(Te,"expenses_candies",M.id)),x(de=>de.filter(le=>le.id!==M.id)),O(" Gasto borrado"))};return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Gastos (Dulces)"}),a.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:t,onChange:M=>e(M.target.value)})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:M=>n(M.target.value)})]}),a.jsxs("div",{className:"ml-auto text-sm",children:[a.jsx("div",{className:"font-semibold",children:"Totales del rango"}),a.jsxs("div",{children:["Total: ",L1(Ie.total)]}),a.jsxs("div",{children:["Pagado: ",L1(Ie.pagado)]}),a.jsxs("div",{children:["Pendiente: ",L1(Ie.pendiente)]})]})]}),a.jsxs("form",{onSubmit:j,className:"bg-white p-4 rounded shadow border mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Fecha"}),a.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:s,onChange:M=>i(M.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Categora"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:o,onChange:M=>l(M.target.value),children:[a.jsx("option",{value:"",children:"Selecciona"}),b3.map(M=>a.jsx("option",{value:M,children:M},M))]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Descripcin"}),a.jsx("input",{className:"w-full border p-2 rounded",placeholder:"Detalle del gasto",value:c,onChange:M=>d(M.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Monto"}),a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-2 rounded text-right",value:A===0?"":A,onChange:M=>u(Math.max(0,Number(M.target.value||0))),placeholder:"0.00"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Estado"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:f,onChange:M=>h(M.target.value),children:[a.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),a.jsx("option",{value:"PAGADO",children:"Pagado"})]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Comentario"}),a.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-24",value:m,onChange:M=>p(M.target.value),maxLength:500,placeholder:"Comentario / nota opcional"}),a.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[m.length,"/500"]})]}),a.jsx("div",{className:"md:col-span-2",children:a.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar gasto"})})]}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Categora"}),a.jsx("th",{className:"p-2 border",children:"Descripcin"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Estado"}),a.jsx("th",{className:"p-2 border",children:"Comentario"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:b?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):ye.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin gastos en el rango seleccionado."})}):ye.slice().sort((M,re)=>M.date.localeCompare(re.date)).map(M=>{const re=L===M.id;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:re?a.jsx("input",{type:"date",className:"w-full border p-1 rounded",value:B,onChange:de=>S(de.target.value)}):M.date}),a.jsx("td",{className:"p-2 border",children:re?a.jsxs("select",{className:"w-full border p-1 rounded",value:U,onChange:de=>_(de.target.value),children:[a.jsx("option",{value:"",children:"Selecciona"}),b3.map(de=>a.jsx("option",{value:de,children:de},de))]}):M.category||""}),a.jsx("td",{className:"p-2 border",children:re?a.jsx("input",{className:"w-full border p-1 rounded",value:F,onChange:de=>D(de.target.value)}):a.jsx("span",{title:M.description,children:M.description.length>40?M.description.slice(0,40)+"":M.description})}),a.jsx("td",{className:"p-2 border",children:re?a.jsx("input",{type:"number",step:"0.01",inputMode:"decimal",className:"w-full border p-1 rounded text-right",value:Number.isNaN(X)?"":X,onChange:de=>ge(Math.max(0,Number(de.target.value||0)))}):L1(M.amount)}),a.jsx("td",{className:"p-2 border",children:re?a.jsxs("select",{className:"w-full border p-1 rounded",value:ae,onChange:de=>fe(de.target.value),children:[a.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),a.jsx("option",{value:"PAGADO",children:"Pagado"})]}):a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${M.status==="PAGADO"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:M.status})}),a.jsx("td",{className:"p-2 border",children:re?a.jsx("textarea",{className:"w-full border p-1 rounded resize-y min-h-10",value:me,onChange:de=>Z(de.target.value),maxLength:500}):a.jsx("span",{title:M.notes||"",children:(M.notes||"").length>40?(M.notes||"").slice(0,40)+"":M.notes||""})}),a.jsx("td",{className:"p-2 border",children:a.jsx("div",{className:"flex gap-2 justify-center",children:re?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-blue-600 hover:bg-blue-700",onClick:R,children:"Guardar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:T,children:"Cancelar"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"px-2 py-1 rounded text-white bg-yellow-600 hover:bg-yellow-700",onClick:()=>Q(M),children:"Editar"}),a.jsx("button",{className:"px-2 py-1 rounded text-white bg-red-600 hover:bg-red-700",onClick:()=>K(M),children:"Borrar"})]})})})]},M.id)})})]})}),k&&a.jsx("p",{className:"mt-2 text-sm",children:k})]})}const qi=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function l1e(t){var e;return t!=null&&t.date?t.date:(e=t==null?void 0:t.createdAt)!=null&&e.toDate?or(t.createdAt.toDate(),"yyyy-MM-dd"):""}function c1e(t,e){var i,o,l;const r=l1e(t);if(!r)return null;let n=0,s=0;return Array.isArray(t.items)&&t.items.length>0?(n=t.items.reduce((c,d)=>c+(Number(d.packages??d.qty??d.quantity??0)||0),0),s=Number(t.total??t.itemsTotal??0)||0):(n=Number(t.packagesTotal??t.quantity??((i=t.item)==null?void 0:i.packages)??((o=t.item)==null?void 0:o.qty)??0)||0,s=Number(t.total??((l=t.item)==null?void 0:l.total)??0)||0),{id:e,date:r,type:t.type||"CONTADO",total:s,quantity:n,customerId:t.customerId||void 0,customerName:t.customerName||void 0,downPayment:Number(t.downPayment||0),vendorId:t.vendorId||void 0,vendorName:t.vendorName||t.vendor||void 0,vendorCommissionPercent:Number(t.vendorCommissionPercent||0)||0,vendorCommissionAmount:Number(t.vendorCommissionAmount||0)||0}}async function d1e(t){const e=Dt(ht(Te,"ar_movements"),Gt("ref.saleId","==",t)),r=await Nt(e);await Promise.all(r.docs.map(n=>un(kt(Te,"ar_movements",n.id))))}function A1e({role:t="",sellerCandyId:e=""}){const r=t==="vendedor_dulces",n=t==="admin",s=n?8:7,[i,o]=N.useState(!1),[l,c]=N.useState(!1),[d,A]=N.useState(null),[u,f]=N.useState([]),h=async te=>{o(!0),c(!0),A(te),f([]);try{const Ne=await Ya(kt(Te,"sales_candies",te)),Y=Ne.exists()?Ne.data():null;if(!Y){f([]);return}const Pe=(Array.isArray(Y==null?void 0:Y.items)?Y.items:Y!=null&&Y.item?[Y.item]:[]).map(Qe=>({productName:String(Qe.productName||""),qty:Number(Qe.packages??Qe.qty??Qe.quantity??0),unitPrice:Number(Qe.unitPricePackage??Qe.unitPrice??0),discount:Number(Qe.discount||0),total:Number(Qe.total??Qe.lineFinal??0)}));f(Pe)}catch(Ne){console.error(Ne)}finally{c(!1)}},[m,p]=N.useState(or(new Date,"yyyy-MM-01")),[g,x]=N.useState(or(new Date,"yyyy-MM-dd")),[b,w]=N.useState([]),[k,O]=N.useState([]),[L,E]=N.useState([]),[B,S]=N.useState(!0),[U,_]=N.useState(""),[F,D]=N.useState(""),[X,ge]=N.useState(""),[ae,fe]=N.useState(null),me=15,[Z,ye]=N.useState(1),Ie=N.useMemo(()=>{const te={};return b.forEach(Ne=>te[Ne.id]=Ne.name),te},[b]),I=N.useMemo(()=>{const te={};return L.forEach(Ne=>{te[Ne.id]=Ne}),te},[L]),j=te=>{const Ne=Number(te.vendorCommissionAmount||0);if(Ne>0)return Ne;if(!te.vendorId)return 0;const Y=I[te.vendorId];if(!Y||!Y.commissionPercent)return 0;const we=(Number(te.total)||0)*(Number(Y.commissionPercent)||0)/100;return Number(we.toFixed(2))};N.useEffect(()=>{(async()=>{S(!0),_("");try{const te=await Nt(ht(Te,"customers_candies")),Ne=[];te.forEach(tt=>Ne.push({id:tt.id,name:tt.data().name||""})),w(Ne);const Y=await Nt(ht(Te,"sellers_candies")),we=[];Y.forEach(tt=>{const ot=tt.data();we.push({id:tt.id,name:ot.name||"",commissionPercent:Number(ot.commissionPercent||0)})}),E(we);const Pe=await Nt(Dt(ht(Te,"sales_candies"),Ur("createdAt","desc"))),Qe=[];Pe.forEach(tt=>{const ot=c1e(tt.data(),tt.id);ot&&ot.date>=m&&ot.date<=g&&Qe.push(ot)}),O(Qe.sort((tt,ot)=>ot.date.localeCompare(tt.date))),ye(1)}catch(te){console.error(te),_(" Error cargando transacciones.")}finally{S(!1)}})()},[m,g]);const Q=N.useMemo(()=>k.filter(te=>!(r&&(!e||!te.vendorId||te.vendorId!==e)||F&&te.customerId!==F||X&&te.type!==X)),[k,F,X,r,e]),T=N.useMemo(()=>{let te=0,Ne=0,Y=0,we=0;for(const Pe of Q)Pe.type==="CONTADO"?(te+=Pe.quantity,Y+=Pe.total):(Ne+=Pe.quantity,we+=Pe.total);return{packsCash:te,packsCredito:Ne,montoCash:Y,montoCredito:we}},[Q]),R=Math.max(1,Math.ceil(Q.length/me)),K=N.useMemo(()=>{const te=(Z-1)*me;return Q.slice(te,te+me)},[Q,Z]),M=N.useMemo(()=>d&&k.find(te=>te.id===d)||null,[d,k]),re=async te=>{if(n&&(fe(null),!!window.confirm("Eliminar esta venta de dulces? Se restaurar el inventario asociado.")))try{S(!0),await fx(te.id),await d1e(te.id),O(Ne=>Ne.filter(Y=>Y.id!==te.id)),_(" Venta eliminada")}catch(Ne){console.error(Ne),_(" No se pudo eliminar la venta.")}finally{S(!1)}},de=()=>{const te=`Ventas del dia  ${m} a ${g}`,Ne=Qe=>(Qe||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Y=Q.map(Qe=>{const tt=Qe.customerName||(Qe.customerId?Ie[Qe.customerId]:"")||"Nombre cliente";return`<tr>
          <td>${Qe.date}</td>
          <td>${Ne(tt)}</td>
          <td>${Qe.type==="CREDITO"?"Crdito":"Cash"}</td>
          <td style="text-align:right">${Qe.quantity}</td>
          <td style="text-align:right">${qi(Qe.total)}</td>
        </tr>`}).join(""),we=`<!doctype html><html><head><meta charset="utf-8" />
    <title>${Ne(te)}</title>
    <style>
      *{font-family:Arial, sans-serif} h1{margin:0 0 8px}
      .muted{color:#555;font-size:12px;margin-bottom:12px}
      .kpis{display:grid;grid-template-columns:repeat(2,max-content);gap:8px 28px;margin:10px 0 14px}
      table{width:100%;border-collapse:collapse;font-size:12px}
      th,td{border:1px solid #ddd;padding:6px}
      th{background:#f5f5f5;text-align:left}
      @media print{@page{size:A4;margin:12mm}}
    </style></head><body>
      <h1>${Ne(te)}</h1>
      <div class="kpis">
        <div><b>Paquetes Cash:</b> ${T.packsCash}</div>
        <div><b>Paquetes Crdito:</b> ${T.packsCredito}</div>
        <div><b>Monto Cash:</b> ${qi(T.montoCash)}</div>
        <div><b>Monto Crdito:</b> ${qi(T.montoCredito)}</div>
      </div>
      <table><thead><tr>
        <th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Paquetes</th><th>Monto</th>
      </tr></thead><tbody>
      ${Y||'<tr><td colspan="5" style="text-align:center">Sin transacciones</td></tr>'}
      </tbody></table>
      <script>window.print()<\/script>
    </body></html>`,Pe=window.open("","_blank");Pe&&(Pe.document.open(),Pe.document.write(we),Pe.document.close())},le=()=>ye(1),q=()=>ye(te=>Math.max(1,te-1)),Se=()=>ye(te=>Math.min(R,te+1)),ee=()=>ye(R),z=()=>{const te=[];if(R<=7)for(let Y=1;Y<=R;Y++)te.push(Y);else{const Y=Math.max(1,Z-2),we=Math.min(R,Z+2);te.push(1),Y>2&&te.push(-1);for(let Pe=Y;Pe<=we;Pe++)Pe!==1&&Pe!==R&&te.push(Pe);we<R-1&&te.push(-2),te.push(R)}return a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 justify-between mt-3",children:[a.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[a.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:le,disabled:Z===1,children:" Primero"}),a.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:q,disabled:Z===1,children:" Anterior"}),te.map((Y,we)=>typeof Y=="number"?a.jsx("button",{className:`px-3 py-1 border rounded ${Y===Z?"bg-blue-600 text-white":""}`,onClick:()=>ye(Y),children:Y},we):a.jsx("span",{className:"px-2",children:""},we)),a.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:Se,disabled:Z===R,children:"Siguiente "}),a.jsx("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:ee,disabled:Z===R,children:"ltimo "})]}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Pgina ",Z," de ",R,"  ",Q.length," transaccin(es)"]})]})};return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsx("h2",{className:"text-2xl font-bold mb-3",children:"Ventas del dia"}),a.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 items-end text-sm",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block font-semibold",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:m,onChange:te=>{p(te.target.value),ye(1)}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block font-semibold",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1 w-full",value:g,onChange:te=>{x(te.target.value),ye(1)}})]}),a.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[a.jsx("label",{className:"block font-semibold",children:"Cliente (crdito)"}),a.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:F,onChange:te=>{D(te.target.value),ye(1)},children:[a.jsx("option",{value:"",children:"Todos"}),b.map(te=>a.jsx("option",{value:te.id,children:te.name},te.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block font-semibold",children:"Tipo"}),a.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:X,onChange:te=>{ge(te.target.value),ye(1)},children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"CONTADO",children:"Cash"}),a.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),a.jsx("button",{className:"sm:col-span-2 lg:col-span-1 px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 w-full",onClick:de,children:"Exportar PDF"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),a.jsx("div",{className:"text-xl font-semibold",children:T.packsCash})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito"}),a.jsx("div",{className:"text-xl font-semibold",children:T.packsCredito})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Monto Cash"}),a.jsx("div",{className:"text-xl font-semibold",children:qi(T.montoCash)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Monto Crdito"}),a.jsx("div",{className:"text-xl font-semibold",children:qi(T.montoCredito)})]})]}),a.jsxs("div",{className:"block md:hidden space-y-3",children:[B?a.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Cargando"}):K.length===0?a.jsx("div",{className:"bg-white border rounded-lg p-4 shadow",children:"Sin transacciones en el rango."}):K.map(te=>{const Ne=te.customerName||(te.customerId?Ie[te.customerId]:"")||"Nombre cliente",Y=j(te);return a.jsx("div",{className:"bg-white border rounded-xl shadow",children:a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"list-none cursor-pointer p-3 flex items-start gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"font-semibold truncate",children:Ne}),a.jsx("div",{className:"text-xs text-gray-600 shrink-0",children:te.date})]}),a.jsxs("div",{className:"mt-1 flex items-center gap-2 flex-wrap text-xs",children:[a.jsx("span",{className:`px-2 py-1 rounded-full border ${te.type==="CREDITO"?"bg-yellow-50 border-yellow-200 text-yellow-700":"bg-green-50 border-green-200 text-green-700"}`,children:te.type==="CREDITO"?"Crdito":"Cash"}),a.jsxs("span",{className:"text-gray-700",children:[a.jsx("b",{children:"Paquetes:"})," ",a.jsx("button",{type:"button",className:"underline text-blue-600",onClick:we=>{we.preventDefault(),h(te.id)},title:"Ver detalle",children:te.quantity})]}),a.jsxs("span",{className:"text-gray-700",children:[a.jsx("b",{children:"Monto:"})," ",qi(te.total)]})]})]}),a.jsx("div",{className:"text-gray-500 mt-1",children:a.jsx("span",{className:"inline-block transition-transform group-open:rotate-180",children:""})})]}),a.jsx("div",{className:"px-3 pb-3 pt-0 text-sm",children:a.jsxs("div",{className:"grid grid-cols-1 gap-2 border-t pt-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Cliente"}),a.jsx("span",{className:"font-medium text-right",children:Ne})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Fecha"}),a.jsx("span",{className:"font-medium",children:te.date})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Tipo"}),a.jsx("span",{className:"font-medium",children:te.type==="CREDITO"?"Crdito":"Cash"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Paquetes"}),a.jsx("span",{className:"font-medium",children:a.jsx("button",{type:"button",className:"underline text-blue-600",onClick:()=>h(te.id),title:"Ver detalle",children:te.quantity})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Monto"}),a.jsx("span",{className:"font-semibold",children:qi(te.total)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Comisin"}),a.jsx("span",{className:"font-medium",children:Y>0?qi(Y):""})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Vendedor"}),a.jsx("span",{className:"font-medium",children:te.vendorName||""})]}),n&&a.jsxs("div",{className:"pt-2 flex items-center justify-end gap-2",children:[a.jsx("button",{className:"px-3 py-2 rounded border hover:bg-gray-50",onClick:()=>fe(we=>we===te.id?null:te.id),children:" Acciones"}),ae===te.id&&a.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>re(te),children:"Eliminar"})]})]})})]})},te.id)}),a.jsx("div",{className:"bg-white p-3 rounded shadow border",children:z()})]}),a.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full",children:[a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Cliente"}),a.jsx("th",{className:"p-2 border",children:"Tipo"}),a.jsx("th",{className:"p-2 border",children:"Paquetes"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Comisin"}),a.jsx("th",{className:"p-2 border",children:"Vendedor"}),n&&a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:B?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:s,children:"Cargando"})}):K.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:s,children:"Sin transacciones en el rango."})}):K.map(te=>{const Ne=te.customerName||(te.customerId?Ie[te.customerId]:"")||"Nombre cliente",Y=j(te);return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:te.date}),a.jsx("td",{className:"p-2 border",children:Ne}),a.jsx("td",{className:"p-2 border",children:te.type==="CREDITO"?"Crdito":"Cash"}),a.jsx("td",{className:"p-2 border",children:a.jsx("button",{type:"button",className:"underline text-blue-600 hover:text-blue-800",title:"Ver detalle de productos de esta venta",onClick:()=>h(te.id),children:te.quantity})}),a.jsx("td",{className:"p-2 border",children:qi(te.total)}),a.jsx("td",{className:"p-2 border",children:Y>0?qi(Y):""}),a.jsx("td",{className:"p-2 border",children:te.vendorName||""}),n&&a.jsxs("td",{className:"p-2 border relative",children:[a.jsx("button",{className:"px-2 py-1 rounded border hover:bg-gray-50",onClick:()=>fe(we=>we===te.id?null:te.id),title:"Acciones",children:""}),ae===te.id&&a.jsx("div",{className:"absolute right-2 mt-1 w-28 bg-white border rounded shadow z-10 text-left",children:a.jsx("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-100 text-red-600",onClick:()=>re(te),children:"Eliminar"})})]})]},te.id)})})]}),z()]}),U&&a.jsx("p",{className:"mt-2 text-sm",children:U}),i&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-3xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold",children:["Productos/paquetes vendidos"," ",d?` #${d}`:""]}),M&&a.jsxs("div",{className:"text-sm text-gray-700 mt-1",children:["Comisin de vendedor:"," ",a.jsx("span",{className:"font-semibold",children:j(M)>0?qi(j(M)):""})]})]}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>o(!1),children:"Cerrar"})]}),a.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border text-right",children:"Paquetes"}),a.jsx("th",{className:"p-2 border text-right",children:"Precio"}),a.jsx("th",{className:"p-2 border text-right",children:"Descuento"}),a.jsx("th",{className:"p-2 border text-right",children:"Monto"})]})}),a.jsx("tbody",{children:l?a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Cargando"})}):u.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"p-4 text-center",children:"Sin tems en esta venta."})}):u.map((te,Ne)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border text-left",children:te.productName}),a.jsx("td",{className:"p-2 border text-right",children:te.qty}),a.jsx("td",{className:"p-2 border text-right",children:qi(te.unitPrice)}),a.jsx("td",{className:"p-2 border text-right",children:qi(te.discount||0)}),a.jsx("td",{className:"p-2 border text-right",children:qi(te.total)})]},Ne))})]})})]})})]})}const en=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function jp(t){var r;const e=t==null?void 0:t.date;return e||((r=t==null?void 0:t.createdAt)!=null&&r.toDate?or(t.createdAt.toDate(),"yyyy-MM-dd"):"")}function u1e(t){if(Array.isArray(t==null?void 0:t.items))return t.items.map(n=>{const s=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||0,i=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(s>0?Number((n==null?void 0:n.total)??(n==null?void 0:n.lineFinal)??0)/s:0)||0;return{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:s,unitPrice:Number(i||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0)}});if(t!=null&&t.item){const n=t.item,s=Number((n==null?void 0:n.packages)??(n==null?void 0:n.qty)??(n==null?void 0:n.quantity)??0)||Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,i=Number((n==null?void 0:n.unitPricePackage)??(n==null?void 0:n.unitPrice)??0)||(s>0?Number((n==null?void 0:n.total)??(t==null?void 0:t.total)??0)/s:0)||0;return[{productId:String((n==null?void 0:n.productId)||""),productName:String((n==null?void 0:n.productName)||""),sku:(n==null?void 0:n.sku)||"",qty:s,unitPrice:Number(i||0),discount:Number((n==null?void 0:n.discount)||0),vendorCommissionAmount:Number((n==null?void 0:n.vendorCommissionAmount)??(n==null?void 0:n.commissionAmount)??0)}]}const e=Number((t==null?void 0:t.packagesTotal)??(t==null?void 0:t.quantity)??0)||0,r=e>0?Number((t==null?void 0:t.total)||0)/e:0;return e>0?[{productId:String((t==null?void 0:t.productId)||""),productName:String((t==null?void 0:t.productName)||""),sku:(t==null?void 0:t.sku)||"",qty:e,unitPrice:Number(r||0),discount:Number((t==null?void 0:t.discount)||0),vendorCommissionAmount:Number((t==null?void 0:t.vendorCommissionAmount)??(t==null?void 0:t.commissionAmount)??0)}]:[]}function h1e(t,e){const r=jp(t);if(!r)return null;const n=t.vendorId||t.sellerId||void 0,s=t.vendorName||t.sellerName||void 0,i=u1e(t);let o=Number(t.total??t.itemsTotal??0)||i.reduce((l,c)=>{const d=(Number(c.qty||0)||0)*(Number(c.unitPrice||0)||0),A=Math.max(0,Number(c.discount||0)),u=Math.max(0,d-A);return l+u},0);return o=Number(o||0),{id:e,date:r,type:t.type||"CONTADO",total:o,items:i,customerId:t.customerId||void 0,customerName:t.customerName||void 0,vendorId:n,vendorName:s}}function f1e(t,e,r,n){const s={};for(const l of t)s[l.productId]||(s[l.productId]={productName:l.productName,lots:[]}),s[l.productId].lots.push({date:l.date,qtyLeft:Number(l.quantity||0),cost:Number(l.purchasePrice||0)});for(const l of Object.keys(s))s[l].lots.sort((c,d)=>c.date.localeCompare(d.date));const i=[...e].sort((l,c)=>l.date.localeCompare(c.date));let o=0;for(const l of i)for(const c of l.items||[]){const d=s[c.productId];if(!d)continue;let A=Number(c.qty||0);if(!(A<=0))for(const u of d.lots){if(A<=0)break;if(u.qtyLeft<=0)continue;const f=Math.min(u.qtyLeft,A);l.date>=r&&l.date<=n&&(o+=f*u.cost),u.qtyLeft-=f,A-=f}}return o}async function m1e(t){const e=Dt(ht(Te,"ar_movements"),Gt("ref.saleId","==",t)),r=await Nt(e);await Promise.all(r.docs.map(n=>un(kt(Te,"ar_movements",n.id))))}function p1e(){const{refreshKey:t,refresh:e}=vl(),[r,n]=N.useState(or(jc(new Date),"yyyy-MM-dd")),[s,i]=N.useState(or(Ic(new Date),"yyyy-MM-dd")),[o,l]=N.useState([]),[c,d]=N.useState([]),[A,u]=N.useState([]),[f,h]=N.useState([]),[m,p]=N.useState([]),[g,x]=N.useState([]),[b,w]=N.useState(!0),[k,O]=N.useState(""),[L,E]=N.useState([]),[B,S]=N.useState({}),[U,_]=N.useState({}),[F,D]=N.useState(!1),[X,ge]=N.useState(null),[ae,fe]=N.useState([]),[me,Z]=N.useState(!1),[ye,Ie]=N.useState({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0}),[I,j]=N.useState(!1),[Q,T]=N.useState(""),[R,K]=N.useState([]),[M,re]=N.useState(!1),[de,le]=N.useState(!1),[q,Se]=N.useState(null);N.useEffect(()=>{(async()=>{try{const Ue=await Nt(ht(Te,"sellers_candies")),Xe=[];Ue.forEach(xe=>{const ve=xe.data();Xe.push({id:xe.id,name:ve.name||"",commissionPercent:Number(ve.commissionPercent||0)})}),E(Xe)}catch(Ue){console.error("Error cargando sellers_candies",Ue)}})()},[]);const ee=N.useMemo(()=>{const Ue={};return L.forEach(Xe=>{Ue[Xe.id]=Xe}),Ue},[L]);N.useEffect(()=>{(async()=>{w(!0),O("");try{const Ue=await Nt(ht(Te,"sales_candies")),Xe=[],xe=[];Ue.forEach(He=>{const st=He.data(),Ct=h1e(st,He.id);Ct&&(Ct.date<=s&&Xe.push(Ct),Ct.date>=r&&Ct.date<=s&&xe.push(Ct))}),d(Xe),l(xe);const ve=await Nt(ht(Te,"inventory_candies")),ie=[];ve.forEach(He=>{const st=He.data(),Ct=jp(st);if(!Ct||Ct>s)return;const Xt=Math.max(1,Math.floor(Number(st.unitsPerPackage||1))),Ot=Number(st.totalUnits??st.quantity??0),tr=Number(st.packages??0),Zt=Number(st.remaining??0),et=Number(st.remainingPackages??0),Rt=tr>0?tr:Ot>0?Math.floor(Ot/Xt):0,er=et>0?et:Zt>0?Math.floor(Zt/Xt):0;ie.push({id:He.id,productId:st.productId,productName:st.productName||"",date:Ct,quantity:Number(Rt||0),remaining:Number(er||0),purchasePrice:Number(st.providerPrice||st.purchasePrice||0),unitsPerPackage:Xt})}),u(ie);const ze=await Nt(ht(Te,"expenses_candies")),rt=[];ze.forEach(He=>{const st=He.data(),Ct=jp(st);Ct&&Ct>=r&&Ct<=s&&rt.push({id:He.id,date:Ct,category:st.category||"",description:st.description||"",amount:Number(st.amount||0),status:st.status||""})}),h(rt);const At=await Nt(ht(Te,"ar_movements")),Oe=[],at={};At.forEach(He=>{const st=He.data(),Ct=jp(st);if(!Ct)return;const Xt=st.customerId,Ot=Number(st.amount||0);Xt&&(at[Xt]=(at[Xt]||0)+Ot),st.type==="ABONO"&&Ct>=r&&Ct<=s&&Oe.push({id:He.id,customerId:Xt,type:"ABONO",amount:Ot,date:Ct})}),p(Oe);const Ve=await Nt(ht(Te,"customers_candies")),G=[];Ve.forEach(He=>{const st=He.data();G.push({id:He.id,name:st.name||"",balance:at[He.id]||0})}),x(G);const _e=await Nt(ht(Te,"inventory_candies_sellers")),Me={},We={};_e.forEach(He=>{const st=He.data(),Ct=jp(st);if(!Ct||Ct<r||Ct>s)return;const Xt=st.sellerId||st.vendorId||"NO_VENDOR",Ot=st.productName||"",tr=st.sku||"",Zt=Math.max(1,Math.floor(Number(st.unitsPerPackage||1))),et=Number(st.totalUnits??0),Rt=Number(st.packages??0),er=Number(st.remainingUnits??st.remaining??0),Lt=Number(st.remainingPackages??0),Vt=Rt>0?Rt:et>0?Math.floor(et/Zt):0,nr=Lt>0?Lt:er>0?Math.floor(er/Zt):0,Mt=Number(st.totalVendor??0),oe=Number(st.gainVendor??0),J=Vt,ce=J>0?Mt/J:0,pe=J>0?oe/J:0;if(Me[Xt]||(Me[Xt]={associated:[],remaining:[]}),Vt>0){const Be=Vt,De=Be*ce,se=De,Fe=Be*pe;Me[Xt].associated.push({saleId:He.id,date:Ct,productName:Ot,sku:tr,qty:Be,unitPrice:ce,lineTotal:De,discount:0,lineFinal:se,vendorCommissionAmount:Fe,type:"ASSOCIATED"}),We[Xt]=(We[Xt]||0)+Be}if(nr>0){const Be=nr,De=Be*ce,se=De,Fe=Be*pe;Me[Xt].remaining.push({saleId:He.id,date:Ct,productName:Ot,sku:tr,qty:Be,unitPrice:ce,lineTotal:De,discount:0,lineFinal:se,vendorCommissionAmount:Fe,type:"REMAINING"})}}),S(Me),_(We)}catch(Ue){console.error(Ue),O(" Error cargando datos del dashboard.")}finally{w(!1)}})()},[r,s,t]);const z=N.useCallback(Ue=>{if(Ue.vendorId&&ee[Ue.vendorId])return ee[Ue.vendorId];const Xe=(Ue.vendorName||"").trim().toLowerCase();if(Xe)return L.find(xe=>(xe.name||"").trim().toLowerCase()===Xe)},[ee,L]),te=N.useCallback((Ue,Xe)=>{const xe=Number(Xe.vendorCommissionAmount||0);if(xe)return xe;const ve=z(Ue);if(!ve||!ve.commissionPercent)return 0;const ie=Number(Xe.qty||0),ze=Number(Xe.unitPrice||0),rt=ie*ze,At=Math.max(0,Number(Xe.discount||0)),Oe=Math.max(0,rt-At);if(!Oe)return 0;const at=Number(ve.commissionPercent)||0;return Oe*at/100},[z]),Ne=N.useMemo(()=>{try{return f1e(A,c,r,s)}catch(Ue){return console.error(Ue),0}},[A,c,r,s]),Y=N.useMemo(()=>{const Ue=o.reduce((G,_e)=>G+(_e.total||0),0),Xe=f.reduce((G,_e)=>G+(_e.amount||0),0),xe=Ue-Ne,ve=xe-Xe,ie=m.reduce((G,_e)=>G+Math.abs(_e.amount||0),0),ze=g.filter(G=>(G.balance||0)>0),rt=ze.reduce((G,_e)=>G+(_e.balance||0),0);let At=0,Oe=0,at=0,Ve=0;for(const G of o){const _e=(G.items||[]).reduce((We,He)=>We+(Number(He.qty)||0),0),Me=(G.items||[]).reduce((We,He)=>We+te(G,He),0);G.type==="CONTADO"?(At+=_e,at+=Me):(Oe+=_e,Ve+=Me)}return{ventasTotales:Ue,costoMercaderia:Ne,gastosPeriodo:Xe,gananciaAntes:xe,gananciaDespues:ve,abonosRecibidos:ie,saldosPendientes:rt,clientesConSaldo:ze.length,paquetesCash:At,paquetesCredito:Oe,comisionCash:at,comisionCredito:Ve}},[o,f,m,g,Ne,te]),we=N.useMemo(()=>{const Ue={},Xe={};for(const xe of o)if(!(xe.type!=="CREDITO"||!xe.customerId))for(const ve of xe.items||[]){const ie=Number(ve.qty||0),ze=Number(ve.unitPrice||0),rt=ie*ze,At=Math.max(0,Number(ve.discount||0)),Oe=Math.max(0,rt-At);Ue[xe.customerId]=(Ue[xe.customerId]||0)+ie,Xe[xe.customerId]=(Xe[xe.customerId]||0)+Oe}return g.filter(xe=>(xe.balance||0)>0).map(xe=>({customerId:xe.id,name:xe.name,paquetesAsociados:Ue[xe.id]||0,saldoTotal:Xe[xe.id]||0,saldoPendiente:xe.balance||0})).sort((xe,ve)=>ve.saldoPendiente-xe.saldoPendiente)},[g,o]),Pe=N.useMemo(()=>{const Ue={};return g.forEach(Xe=>Ue[Xe.id]=Xe.name),Ue},[g]),Qe=N.useMemo(()=>[...o].sort((Ue,Xe)=>Xe.date.localeCompare(Ue.date)).map(Ue=>{var ie;const Xe=(Ue.items||[]).reduce((ze,rt)=>ze+(Number(rt.qty)||0),0);let xe="Cash";Ue.type==="CREDITO"&&Ue.customerId?xe=Pe[Ue.customerId]||"":Ue.type==="CONTADO"&&(xe=((ie=Ue.customerName)==null?void 0:ie.trim())||"Cash");const ve=Xe>0?Ue.total/Xe:0;return{id:Ue.id,date:Ue.date,type:Ue.type==="CREDITO"?"Crdito":"Cash",customer:xe,paquetes:Xe,total:Number(Ue.total||0),avgPrice:ve}}),[o,Pe]),tt=N.useMemo(()=>{var Xe,xe;const Ue=new Map;for(const ve of o){const ie=ve.vendorId||"NO_VENDOR",ze=ve.vendorName||((Xe=ee[ie])==null?void 0:Xe.name)||"Sin vendedor";Ue.has(ie)||Ue.set(ie,{vendorId:ie,vendorName:ze,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0});const rt=Ue.get(ie);for(const At of ve.items||[]){const Oe=Number(At.qty||0),at=Number(At.unitPrice||0),Ve=Oe*at,G=Math.max(0,Number(At.discount||0)),_e=Math.max(0,Ve-G),Me=te(ve,At);ve.type==="CONTADO"?(rt.paquetesVendidos+=Oe,rt.totalVendido+=_e,rt.comisionCash+=Me):(rt.paquetesFiados+=Oe,rt.totalFiado+=_e,rt.comisionCredito+=Me)}}for(const[ve,ie]of Object.entries(U)){const ze=Ue.get(ve),rt=(ze==null?void 0:ze.vendorName)||((xe=ee[ve])==null?void 0:xe.name)||"Sin vendedor",At=ze||{vendorId:ve,vendorName:rt,paquetesAsociados:0,paquetesVendidos:0,paquetesFiados:0,totalVendido:0,totalFiado:0,comisionCash:0,comisionCredito:0,paquetesRestantes:0};At.paquetesAsociados=ie,At.paquetesRestantes=Math.max(ie-At.paquetesVendidos-At.paquetesFiados,0),Ue.set(ve,At)}return Array.from(Ue.values()).sort((ve,ie)=>ie.totalVendido+ie.totalFiado-(ve.totalVendido+ve.totalFiado))},[o,U,ee,te]),ot=async Ue=>{D(!0),ge({id:Ue.customerId,name:Ue.name}),fe([]),Z(!0),Ie({totalBruto:0,totalDescuento:0,totalFiado:0,saldoActual:0,abonadoPeriodo:0});try{const Xe=[];let xe=0,ve=0,ie=0;for(const Oe of o)if(!(Oe.type!=="CREDITO"||Oe.customerId!==Ue.customerId))for(const at of Oe.items||[]){const Ve=Number(at.qty||0),G=Number(at.unitPrice||0),_e=Ve*G,Me=Math.max(0,Number(at.discount||0)),We=Math.max(0,_e-Me);Xe.push({saleId:Oe.id,date:Oe.date,productName:at.productName,sku:at.sku||"",qty:Ve,unitPrice:G,lineTotal:_e,discount:Me,lineFinal:We}),xe+=_e,ve+=Me,ie+=We}let ze=0;for(const Oe of m)Oe.customerId===Ue.customerId&&(ze+=Math.abs(Oe.amount||0));const rt=g.find(Oe=>Oe.id===Ue.customerId),At=(rt==null?void 0:rt.balance)||0;fe(Xe),Ie({totalBruto:xe,totalDescuento:ve,totalFiado:ie,saldoActual:At,abonadoPeriodo:ze})}catch(Xe){console.error(Xe),O(" No se pudo cargar el detalle del cliente.")}finally{Z(!1)}},dt=(Ue,Xe,xe)=>{j(!0);let ve="";xe==="ASSOCIATED"?ve=`Paquetes asociados  ${Xe}`:xe==="REMAINING"?ve=`Paquetes restantes  ${Xe}`:xe==="CASH"?ve=`Paquetes vendidos (Cash)  ${Xe}`:ve=`Paquetes fiados (Crdito)  ${Xe}`,T(ve),K([]),re(!0);try{if(xe==="ASSOCIATED"||xe==="REMAINING"){const ze=B[Ue],rt=xe==="ASSOCIATED"?(ze==null?void 0:ze.associated)||[]:(ze==null?void 0:ze.remaining)||[];K([...rt].sort((At,Oe)=>At.date.localeCompare(Oe.date))),re(!1);return}const ie=[];for(const ze of o)if(((ze.vendorId||"NO_VENDOR")===Ue||!ze.vendorId&&Ue==="NO_VENDOR")&&!(xe==="CASH"&&ze.type!=="CONTADO")&&!(xe==="CREDIT"&&ze.type!=="CREDITO"))for(const At of ze.items||[]){const Oe=Number(At.qty||0),at=Number(At.unitPrice||0),Ve=Oe*at,G=Math.max(0,Number(At.discount||0)),_e=Math.max(0,Ve-G),Me=te(ze,At);ie.push({saleId:ze.id,date:ze.date,productName:At.productName,sku:At.sku||"",qty:Oe,unitPrice:at,lineTotal:Ve,discount:G,lineFinal:_e,vendorCommissionAmount:Me,type:xe})}K(ie.sort((ze,rt)=>ze.date.localeCompare(rt.date)))}catch(ie){console.error(ie),O(" No se pudo cargar el detalle del vendedor.")}finally{re(!1)}},vt=Ue=>{const Xe=o.find(xe=>xe.id===Ue)||null;Se(Xe),le(!0)},lt=async Ue=>{if(window.confirm("Eliminar esta venta? Esta accin no se puede deshacer."))try{await fx(Ue),await m1e(Ue),l(Xe=>Xe.filter(xe=>xe.id!==Ue)),d(Xe=>Xe.filter(xe=>xe.id!==Ue)),le(!1),Se(null)}catch(Xe){console.error(Xe),alert("No se pudo eliminar la venta. Revisa la consola para ms detalles.")}};return a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Finanzas (Dulces)"}),a.jsx(Zl,{onClick:e,loading:b})]}),a.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:r,onChange:Ue=>n(Ue.target.value)})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:s,onChange:Ue=>i(Ue.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-4",children:[a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ventas Totales"}),a.jsx("div",{className:"text-xl font-semibold",children:en(Y.ventasTotales)}),a.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"Contado + Crdito del periodo."})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Costo de Mercadera (FIFO)"}),a.jsx("div",{className:"text-xl font-semibold",children:en(Y.costoMercaderia)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Bruta"}),a.jsx("div",{className:"text-xl font-semibold text-green-600",children:en(Y.gananciaAntes)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Gastos"}),a.jsx("div",{className:"text-xl font-semibold",children:en(Y.gastosPeriodo)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Utilidad Neta"}),a.jsx("div",{className:"text-xl font-semibold text-green-600",children:en(Y.gananciaDespues)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Abonos Recibidos"}),a.jsx("div",{className:"text-xl font-semibold",children:en(Y.abonosRecibidos)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Saldos Pendientes"}),a.jsx("div",{className:"text-xl font-semibold",children:en(Y.saldosPendientes)}),a.jsx("div",{className:"text-[11px] text-gray-500 mt-1",children:"A la fecha."})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Clientes con Saldo"}),a.jsx("div",{className:"text-xl font-semibold",children:Y.clientesConSaldo})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Cash"}),a.jsx("div",{className:"text-xl font-semibold",children:Y.paquetesCash})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes Crdito (vendidos)"}),a.jsx("div",{className:"text-xl font-semibold",children:Y.paquetesCredito})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Cash"}),a.jsx("div",{className:"text-xl font-semibold",children:en(Y.comisionCash)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Comisin Crdito"}),a.jsx("div",{className:"text-xl font-semibold",children:en(Y.comisionCredito)})]})]}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado por cliente (Crdito)"}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6",children:a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Cliente"}),a.jsx("th",{className:"p-2 border",children:"Paquetes asociados (periodo)"}),a.jsx("th",{className:"p-2 border",children:"Saldo total (periodo)"}),a.jsx("th",{className:"p-2 border",children:"Saldo pendiente"})]})}),a.jsx("tbody",{children:b?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):we.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin clientes con saldo"})}):we.map(Ue=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:Ue.name}),a.jsx("td",{className:"p-2 border",children:a.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>ot({customerId:Ue.customerId,name:Ue.name}),title:"Ver paquetes fiados del periodo",children:Ue.paquetesAsociados})}),a.jsx("td",{className:"p-2 border",children:en(Ue.saldoTotal)}),a.jsx("td",{className:"p-2 border font-semibold",children:en(Ue.saldoPendiente)})]},Ue.customerId))})]})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Consolidado vendedores"}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes asociados"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes restantes"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes vendidos (Cash)"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total vendido (Cash)"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Cash"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes fiados (Crdito)"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total fiado (Crdito)"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin Crdito"})]})}),a.jsx("tbody",{children:b?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Cargando"})}):tt.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:9,children:"Sin datos de vendedores en el rango seleccionado."})}):tt.map(Ue=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ue.vendorName}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>dt(Ue.vendorId,Ue.vendorName,"ASSOCIATED"),children:Ue.paquetesAsociados})}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>dt(Ue.vendorId,Ue.vendorName,"REMAINING"),children:Ue.paquetesRestantes})}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>dt(Ue.vendorId,Ue.vendorName,"CASH"),children:Ue.paquetesVendidos})}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ue.totalVendido)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ue.comisionCash)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>dt(Ue.vendorId,Ue.vendorName,"CREDIT"),children:Ue.paquetesFiados})}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ue.totalFiado)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ue.comisionCredito)})]},Ue.vendorId))})]})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Transacciones del periodo"}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-6 overflow-x-auto",children:a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Cliente"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta (prom.)"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),a.jsx("tbody",{children:b?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Cargando"})}):Qe.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:7,children:"Sin transacciones en el rango seleccionado."})}):Qe.map(Ue=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ue.date}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ue.customer}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Ue.type}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.jsx("button",{className:"underline text-blue-600 hover:text-blue-800",onClick:()=>vt(Ue.id),children:Ue.paquetes})}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ue.avgPrice)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:en(Ue.total)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>lt(Ue.id),children:"Eliminar"})})]},Ue.id))})]})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gastos del periodo"}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full",children:a.jsxs("table",{className:"min-w-full w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Categora"}),a.jsx("th",{className:"p-2 border",children:"Descripcin"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Estado"})]})}),a.jsx("tbody",{children:b?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Cargando"})}):f.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:5,children:"Sin gastos en el rango seleccionado."})}):f.sort((Ue,Xe)=>Ue.date.localeCompare(Xe.date)).map(Ue=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:Ue.date}),a.jsx("td",{className:"p-2 border",children:Ue.category||""}),a.jsx("td",{className:"p-2 border",children:Ue.description?a.jsx("span",{title:Ue.description,children:Ue.description.length>40?Ue.description.slice(0,40)+"":Ue.description}):""}),a.jsx("td",{className:"p-2 border",children:en(Ue.amount)}),a.jsx("td",{className:"p-2 border",children:Ue.status||""})]},Ue.id))})]})}),k&&a.jsx("p",{className:"mt-2 text-sm",children:k}),F&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h3",{className:"text-lg font-bold",children:["Detalle cliente  ",(X==null?void 0:X.name)||""]}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>D(!1),children:"Cerrar"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-3 mb-3",children:[a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Total bruto (periodo)"}),a.jsx("div",{className:"text-xl font-semibold",children:en(ye.totalBruto)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Descuento (periodo)"}),a.jsx("div",{className:"text-xl font-semibold",children:en(ye.totalDescuento)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Monto total fiado (periodo)"}),a.jsx("div",{className:"text-xl font-semibold",children:en(ye.totalFiado)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Saldo actual"}),a.jsx("div",{className:"text-xl font-semibold",children:en(ye.saldoActual)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Abonado (periodo)"}),a.jsx("div",{className:"text-xl font-semibold",children:en(ye.abonadoPeriodo)})]})]}),a.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha compra"}),a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"SKU"}),a.jsx("th",{className:"p-2 border",children:"Paquetes"}),a.jsx("th",{className:"p-2 border",children:"P. Unit"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Descuento"}),a.jsx("th",{className:"p-2 border",children:"Monto final"})]})}),a.jsx("tbody",{children:me?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Cargando"})}):ae.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"p-4 text-center",children:"Sin paquetes fiados en el periodo."})}):ae.sort((Ue,Xe)=>Ue.date.localeCompare(Xe.date)).map((Ue,Xe)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:Ue.date}),a.jsx("td",{className:"p-2 border",children:Ue.productName}),a.jsx("td",{className:"p-2 border",children:Ue.sku||""}),a.jsx("td",{className:"p-2 border",children:Ue.qty}),a.jsx("td",{className:"p-2 border",children:en(Ue.unitPrice)}),a.jsx("td",{className:"p-2 border",children:en(Ue.lineTotal)}),a.jsx("td",{className:"p-2 border",children:en(Ue.discount)}),a.jsx("td",{className:"p-2 border",children:en(Ue.lineFinal)})]},`${Ue.saleId}-${Xe}`))})]})})]})}),I&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-5xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-lg font-bold",children:Q}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>j(!1),children:"Cerrar"})]}),a.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"SKU"}),a.jsx("th",{className:"p-2 border",children:"Paquetes"}),a.jsx("th",{className:"p-2 border",children:"P. Unit"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Descuento"}),a.jsx("th",{className:"p-2 border",children:"Monto final"}),a.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),a.jsx("tbody",{children:M?a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Cargando"})}):R.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"p-4 text-center",children:"Sin paquetes para este vendedor en el periodo."})}):R.map((Ue,Xe)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:Ue.date}),a.jsx("td",{className:"p-2 border",children:Ue.productName}),a.jsx("td",{className:"p-2 border",children:Ue.sku||""}),a.jsx("td",{className:"p-2 border",children:Ue.qty}),a.jsx("td",{className:"p-2 border",children:en(Ue.unitPrice)}),a.jsx("td",{className:"p-2 border",children:en(Ue.lineTotal)}),a.jsx("td",{className:"p-2 border",children:en(Ue.discount)}),a.jsx("td",{className:"p-2 border",children:en(Ue.lineFinal)}),a.jsx("td",{className:"p-2 border",children:en(Ue.vendorCommissionAmount)})]},`${Ue.saleId}-${Xe}`))})]})})]})}),de&&q&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl border w-[95%] max-w-4xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h3",{className:"text-lg font-bold",children:["Detalle de venta  ",q.date]}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>le(!1),children:"Cerrar"})]}),a.jsx("div",{className:"bg-white rounded border overflow-x-auto mb-3",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"SKU"}),a.jsx("th",{className:"p-2 border",children:"Paquetes"}),a.jsx("th",{className:"p-2 border",children:"P. Unit"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Comisin"})]})}),a.jsx("tbody",{children:(q.items||[]).map((Ue,Xe)=>{const xe=Number(Ue.qty||0),ve=Number(Ue.unitPrice||0),ie=xe*ve,ze=te(q,Ue);return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:Ue.productName}),a.jsx("td",{className:"p-2 border",children:Ue.sku||""}),a.jsx("td",{className:"p-2 border",children:xe}),a.jsx("td",{className:"p-2 border",children:en(ve)}),a.jsx("td",{className:"p-2 border",children:en(ie)}),a.jsx("td",{className:"p-2 border",children:en(ze)})]},Xe)})})]})}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"text-sm",children:[a.jsx("span",{className:"font-semibold",children:"Total venta:"}),en(q.total)]}),a.jsx("button",{className:"text-xs bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700",onClick:()=>lt(q.id),children:"Eliminar venta"})]})]})})]})}const w3=["Rivas","Isla Ometepe","San Jorge"];function g1e(){const{refreshKey:t,refresh:e}=vl(),[r,n]=N.useState([]),[s,i]=N.useState(!0),[o,l]=N.useState(""),[c,d]=N.useState(!1),[A,u]=N.useState(""),[f,h]=N.useState("0"),[m,p]=N.useState("Rivas"),[g,x]=N.useState(null),[b,w]=N.useState(""),[k,O]=N.useState("0"),[L,E]=N.useState("Rivas");N.useEffect(()=>{(async()=>{i(!0),l("");try{const X=Dt(ht(Te,"sellers_candies"),Ur("name","asc")),ge=await Nt(X),ae=[];ge.forEach(fe=>{const me=fe.data();ae.push({id:fe.id,name:me.name||"",commissionPercent:Number(me.commissionPercent||0),branch:me.branch||"Rivas",createdAt:me.createdAt||$t.now()})}),n(ae)}catch(X){console.error(X),l(" Error cargando vendedores.")}finally{i(!1)}})()},[t]);const B=()=>{u(""),h("0"),p("Rivas")},S=async X=>{X.preventDefault(),l("");const ge=A.trim();if(!ge){l("Ingresa el nombre y apellido del vendedor.");return}const ae=Number(f||0);if(ae<0){l("La comisin no puede ser negativa.");return}try{const fe={name:ge,commissionPercent:ae,branch:m,createdAt:$t.now()},me=await Jr(ht(Te,"sellers_candies"),fe);n(Z=>[{id:me.id,...fe},...Z]),l(" Vendedor creado correctamente."),B(),d(!1)}catch(fe){console.error(fe),l(" Error al crear el vendedor.")}},U=X=>{x(X.id),w(X.name),O(X.commissionPercent.toString()),E(X.branch)},_=()=>{x(null),w(""),O("0"),E("Rivas")},F=async()=>{if(!g)return;l("");const X=b.trim();if(!X){l("El nombre y apellido no pueden estar vacos.");return}const ge=Number(k||0);if(ge<0){l("La comisin no puede ser negativa.");return}try{await Pr(kt(Te,"sellers_candies",g),{name:X,commissionPercent:ge,branch:L}),n(ae=>ae.map(fe=>fe.id===g?{...fe,name:X,commissionPercent:ge,branch:L}:fe)),l(" Vendedor actualizado."),_()}catch(ae){console.error(ae),l(" Error al actualizar el vendedor.")}},D=async X=>{if(window.confirm(`Eliminar al vendedor "${X.name}"? Esta accin no se puede deshacer.`))try{await un(kt(Te,"sellers_candies",X.id)),n(ae=>ae.filter(fe=>fe.id!==X.id)),l(" Vendedor eliminado.")}catch(ae){console.error(ae),l(" Error al eliminar el vendedor.")}};return a.jsxs("div",{className:"max-w-5xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Vendedores de Dulces"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Zl,{onClick:e,loading:s}),a.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>d(!0),children:[a.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo vendedor"]})]})]}),c&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Nuevo vendedor de dulces"}),a.jsxs("form",{onSubmit:S,className:"space-y-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Nombre y apellido"}),a.jsx("input",{className:"w-full border p-2 rounded",value:A,onChange:X=>u(X.target.value),placeholder:"Ej: Juan Prez"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Comisin (% sobre venta total)"}),a.jsx("input",{type:"number",step:"0.01",min:0,className:"w-full border p-2 rounded",value:f,onChange:X=>h(X.target.value),placeholder:"Ej: 10"}),a.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Este porcentaje se usa para calcular la comisin del vendedor sobre el total de la venta (no es el margen del producto)."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Sucursal"}),a.jsx("select",{className:"w-full border p-2 rounded",value:m,onChange:X=>p(X.target.value),children:w3.map(X=>a.jsx("option",{value:X,children:X},X))})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[a.jsx("button",{type:"button",onClick:()=>{B(),d(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Guardar vendedor"})]})]})]})}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-3",children:a.jsxs("table",{className:"min-w-[700px] text-xs md:text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{className:"whitespace-nowrap",children:[a.jsx("th",{className:"p-2 border",children:"Nombre y apellido"}),a.jsx("th",{className:"p-2 border",children:"Comisin (%)"}),a.jsx("th",{className:"p-2 border",children:"Sucursal"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:s?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Cargando"})}):r.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:4,children:"Sin vendedores registrados."})}):r.map(X=>{const ge=g===X.id;return a.jsxs("tr",{className:"text-center whitespace-nowrap",children:[a.jsx("td",{className:"p-2 border",children:ge?a.jsx("input",{className:"border p-1 rounded text-xs w-full",value:b,onChange:ae=>w(ae.target.value)}):X.name}),a.jsx("td",{className:"p-2 border",children:ge?a.jsx("input",{type:"number",step:"0.01",min:0,className:"border p-1 rounded text-xs w-24 text-right",value:k,onChange:ae=>O(ae.target.value)}):`${X.commissionPercent.toFixed(2)} %`}),a.jsx("td",{className:"p-2 border",children:ge?a.jsx("select",{className:"border p-1 rounded text-xs",value:L,onChange:ae=>E(ae.target.value),children:w3.map(ae=>a.jsx("option",{value:ae,children:ae},ae))}):X.branch}),a.jsx("td",{className:"p-2 border",children:ge?a.jsxs("div",{className:"flex gap-1 justify-center",children:[a.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:F,children:"Guardar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:_,children:"Cancelar"})]}):a.jsxs("div",{className:"flex gap-1 justify-center",children:[a.jsx("button",{className:"px-2 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600 text-xs",onClick:()=>U(X),children:"Editar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>D(X),children:"Borrar"})]})})]},X.id)})})]})}),o&&a.jsx("p",{className:"mt-2 text-sm",children:o})]})}const qa=t=>Math.max(0,Math.floor(Number(t||0)));function x1e(t){return Math.max(1,qa(t.unitsPerPackage||1))}async function v1e(t){const{orderId:e,productId:r}=t;let n=qa(t.packagesToReturn);if(!e||!r||n<=0)return;const s=Dt(ht(Te,"inventory_candies"),Gt("orderId","==",e),Gt("productId","==",r),Ur("createdAt","asc")),i=await Nt(s);if(i.empty)return;const o=i.docs.map(l=>l.ref);await pa(Te,async l=>{const c=await Promise.all(o.map(d=>l.get(d)));for(let d=0;d<o.length&&n>0;d++){const A=c[d];if(!A.exists())continue;const u=A.data(),f=x1e(u),h=n*f,p=qa(u.remaining??0)+h,g=Math.floor(p/f);l.update(o[d],{remaining:p,remainingPackages:g,packages:g,updatedAt:$t.now()}),n=0}})}async function y1e(t){const{orderId:e,productId:r}=t,n=qa(t.packagesToReturn);if(!e||!r||n<=0)return;const s=kt(Te,"candy_main_orders",e);await pa(Te,async i=>{const o=await i.get(s);if(!o.exists())return;const l=o.data(),c=Array.isArray(l.items)?l.items:[];let d=!1;const A=c.map(u=>String((u==null?void 0:u.id)||"")!==String(r)?u:(d=!0,{...u,remainingPackages:qa(u.remainingPackages)+n}));d&&i.update(s,{items:A,updatedAt:$t.now()})})}function b1e(t){if(!Array.isArray(t))return[];const e=[];for(const r of t){const n=String((r==null?void 0:r.batchId)||""),s=String((r==null?void 0:r.masterOrderId)||(r==null?void 0:r.orderId)||""),i=qa((r==null?void 0:r.units)??(r==null?void 0:r.qty)??(r==null?void 0:r.quantity)??0),o=Math.max(1,qa((r==null?void 0:r.unitsPerPackage)||1));!n||!s||i<=0||e.push({batchId:n,masterOrderId:s,units:i,unitsPerPackage:o})}return e}function N3(t,e){const r=qa(t),n=Math.max(1,qa(e));return Math.floor(r/n)}async function C3(t){if(!t)throw new Error("vendorInventoryId requerido");const e=kt(Te,"inventory_candies_sellers",t),r=await Ya(e);if(!r.exists())throw new Error("No existe la orden del vendedor");const n=r.data(),s=String(n.productId||""),i=qa(n.packages||n.remainingPackages||0),o=b1e(n.masterAllocations||n.allocations||n.allocationsByBatch);if(!o.length){const c=String(n.orderId||"");if(!c)throw new Error("La orden del vendedor no tiene orderId");if(!s)throw new Error("La orden del vendedor no tiene productId");return i<=0?(await pa(Te,async d=>{d.delete(e)}),{restoredPackages:0,mode:"legacy"}):(await v1e({orderId:c,productId:s,packagesToReturn:i}),await y1e({orderId:c,productId:s,packagesToReturn:i}),await pa(Te,async d=>{d.delete(e)}),{restoredPackages:i,mode:"legacy"})}let l=0;return await pa(Te,async c=>{const d={};for(const g of o){const x=Math.max(1,qa(g.unitsPerPackage||1)),b=qa(g.units),w=N3(b,x);w>0&&(d[g.masterOrderId]=(d[g.masterOrderId]||0)+w)}const A=o.map(g=>kt(Te,"inventory_candies",g.batchId)),f=Object.keys(d).map(g=>kt(Te,"candy_main_orders",g)),[h,m]=await Promise.all([Promise.all(A.map(g=>c.get(g))),Promise.all(f.map(g=>c.get(g)))]);let p=0;for(let g=0;g<o.length;g++){const x=o[g],b=h[g];if(!b.exists())continue;const w=b.data(),k=Math.max(1,qa(x.unitsPerPackage||w.unitsPerPackage||1)),O=qa(x.units),E=qa(w.remaining??0)+O,B=Math.floor(E/k);c.update(A[g],{remaining:E,remainingPackages:B,packages:B,updatedAt:$t.now()});const S=N3(O,k);S>0&&(p+=S)}for(let g=0;g<f.length;g++){const x=m[g];if(!x.exists())continue;const b=f[g].id,w=qa(d[b]||0);if(w<=0)continue;const k=x.data(),O=Array.isArray(k.items)?k.items:[];let L=!1;const E=O.map(B=>String((B==null?void 0:B.id)||"")!==String(s)?B:(L=!0,{...B,remainingPackages:qa(B.remainingPackages)+w}));L&&c.update(f[g],{items:E,updatedAt:$t.now()})}c.delete(e),l=p}),{restoredPackages:l,mode:"blind"}}const Wr=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function w1e(t){const e=String(t||"").trim().toUpperCase();if(e.includes("ISLA"))return"ISLA";if(e.includes("JORGE"))return"SAN_JORGE";if(e.includes("RIVAS"))return"RIVAS"}const _3=t=>Math.max(0,Math.floor(Number(t||0)));function N1e({role:t="",sellerCandyId:e="",currentUserEmail:r}){const{refreshKey:n,refresh:s}=vl(),i=!t||t==="admin",o=t==="vendedor_dulces",l=(r||"").trim().toLowerCase(),c=!i&&o,[d,A]=N.useState({}),[u,f]=N.useState([]),[h,m]=N.useState([]),[p,g]=N.useState({}),[x,b]=N.useState(null),[w,k]=N.useState([]),[O,L]=N.useState(!0),[E,B]=N.useState(""),[S,U]=N.useState(!1),[_,F]=N.useState(null),[D,X]=N.useState([]),[ge,ae]=N.useState(""),[fe,me]=N.useState(""),[Z,ye]=N.useState(""),[Ie,I]=N.useState("0"),[j,Q]=N.useState([]),[T,R]=N.useState(!1),K=N.useMemo(()=>u.find(se=>se.id===ge)||null,[ge,u]),M=K==null?void 0:K.branch,re=N.useMemo(()=>h.find(se=>se.id===Z)||null,[Z,h]),de=N.useMemo(()=>new Set(j.map(se=>se.productId)),[j]),le=N.useMemo(()=>h.filter(se=>(p[se.id]??0)>0||de.has(se.id)).sort((se,Fe)=>se.name.localeCompare(Fe.name)),[h,p,de]),q=N.useMemo(()=>{const se={};return u.forEach(Fe=>se[Fe.id]=Fe),se},[u]),Se=N.useMemo(()=>!o||!l?null:u.find(se=>(se.email||"").trim().toLowerCase()===l)||null,[o,l,u]),ee=N.useMemo(()=>{const se=u.find(Fe=>(Fe.email||"").trim().toLowerCase()===l)||null;return(se==null?void 0:se.name)||(r||"").trim()||""},[u,l,r]),z=async()=>{try{const se=ht(Te,"inventory_transfers_candies");if(!o){const Ye=await Nt(se),$e={};Ye.forEach(it=>{const ft=it.data(),Ut=Number(ft.packagesMoved||0),Kt=String(ft.fromOrderKey||""),yr=String(ft.toOrderKey||"");Kt&&($e[Kt]=$e[Kt]||{out:0,in:0},$e[Kt].out+=Ut),yr&&($e[yr]=$e[yr]||{out:0,in:0},$e[yr].in+=Ut)}),A($e);return}const Fe=Dt(se,Gt("fromSellerId","==",e)),he=Dt(se,Gt("toSellerId","==",e)),[Re,Ee]=await Promise.all([Nt(Fe),Nt(he)]),Ze={},Je=(Ye,$e)=>{Ye.forEach(it=>{const ft=it.data(),Ut=Number(ft.packagesMoved||0),Kt=String($e==="out"?ft.fromOrderKey||"":ft.toOrderKey||"");Kt&&(Ze[Kt]=Ze[Kt]||{out:0,in:0},Ze[Kt][$e]+=Ut)})};Je(Re.docs,"out"),Je(Ee.docs,"in"),A(Ze)}catch(se){console.error(se),A({})}};N.useEffect(()=>{(async()=>{L(!0),B("");try{const se=await Nt(Dt(ht(Te,"sellers_candies"),Ur("name","asc"))),Fe=[];se.forEach(it=>{const ft=it.data(),Ut=ft.branch||ft.branchLabel||ft.route||ft.sucursal||ft.location||"";Fe.push({id:it.id,name:ft.name||"",email:ft.email||"",commissionPercent:Number(ft.commissionPercent||0),branch:w1e(Ut),branchLabel:Ut})}),f(Fe);const he=await Nt(ht(Te,"inventory_candies")),Re={},Ee={};he.forEach(it=>{var io;const ft=it.data(),Ut=String(ft.productId||"");if(!Ut)return;const Kt=Number(ft.remainingPackages);if(Number.isFinite(Kt))Re[Ut]=(Re[Ut]||0)+Math.max(0,Math.floor(Kt));else{const Ud=Number(ft.remaining??ft.quantity??0),Kn=Number(ft.unitsPerPackage||0);let ec=0;Kn>0?ec=Ud/Kn:ec=Number(ft.packages||0),Re[Ut]=(Re[Ut]||0)+Math.max(0,ec)}const yr=String(ft.date||""),Hn=Number(((io=ft.createdAt)==null?void 0:io.seconds)??0),Fn={unitPriceRivas:Number(ft.unitPriceRivas||0),unitPriceSanJorge:Number(ft.unitPriceSanJorge||0),unitPriceIsla:Number(ft.unitPriceIsla||0),date:yr,createdAtSec:Hn};if(!(Fn.unitPriceRivas>0||Fn.unitPriceSanJorge>0||Fn.unitPriceIsla>0))return;const Ds=Ee[Ut];if(!Ds){Ee[Ut]=Fn;return}const ao=`${Ds.date}#${String(Ds.createdAtSec).padStart(10,"0")}`;`${Fn.date}#${String(Fn.createdAtSec).padStart(10,"0")}`>ao&&(Ee[Ut]=Fn)}),Object.keys(Re).forEach(it=>Re[it]=Math.floor(Re[it])),g(Re);const Ze=await Nt(Dt(ht(Te,"products_candies"),Ur("name","asc"))),Je=[];Ze.forEach(it=>{const ft=it.data(),Ut=it.id,Kt=Ee[Ut];Je.push({id:Ut,name:ft.name||"",category:ft.category||"",providerPrice:Number(ft.providerPrice||0),packages:Number(ft.packages||0),unitsPerPackage:Number(ft.unitsPerPackage||0),unitPriceRivas:Number((Kt==null?void 0:Kt.unitPriceRivas)||0),unitPriceSanJorge:Number((Kt==null?void 0:Kt.unitPriceSanJorge)||0),unitPriceIsla:Number((Kt==null?void 0:Kt.unitPriceIsla)||0)})}),m(Je);const Ye=await Nt(o?Dt(ht(Te,"inventory_candies_sellers"),Gt("sellerId","==",e),Ur("createdAt","desc")):Dt(ht(Te,"inventory_candies_sellers"),Ur("createdAt","desc"))),$e=[];Ye.forEach(it=>{const ft=it.data();$e.push({id:it.id,sellerId:ft.sellerId,sellerName:ft.sellerName||"",productId:ft.productId,productName:ft.productName||"",category:ft.category||"",orderId:ft.orderId||null,packages:Number(ft.packages||0),unitsPerPackage:Number(ft.unitsPerPackage||0),totalUnits:Number(ft.totalUnits||0),remainingPackages:Number(ft.remainingPackages||0),remainingUnits:Number(ft.remainingUnits||0),providerPrice:Number(ft.providerPrice||0),totalRivas:Number(ft.totalRivas||0),totalSanJorge:Number(ft.totalSanJorge||0),totalIsla:Number(ft.totalIsla||0),unitPriceRivas:Number(ft.unitPriceRivas||0),unitPriceSanJorge:Number(ft.unitPriceSanJorge||0),unitPriceIsla:Number(ft.unitPriceIsla||0),markupPercent:Number(ft.markupPercent||0),subtotal:Number(ft.subtotal||0),totalVendor:Number(ft.totalVendor||0),gainVendor:Number(ft.gainVendor||0),unitPriceVendor:Number(ft.unitPriceVendor||0),date:ft.date||"",createdAt:ft.createdAt||$t.now()})}),k($e),await z()}catch(se){console.error(se),B(" Error cargando datos de vendedores / pedidos.")}finally{L(!1)}})()},[n,t,e]);const te=N.useMemo(()=>o&&Se?w.filter(se=>se.sellerId===Se.id):w,[w,o,Se,ge]),Ne=se=>te.filter(Fe=>(Fe.orderId||Fe.id)===se),Y=N.useMemo(()=>{var Fe;const se={};for(const he of te){const Re=he.orderId||he.id,Ee=se[Re],Ze=he.date||((Fe=he.createdAt)!=null&&Fe.toDate?he.createdAt.toDate().toISOString().slice(0,10):"");if(Ee)Ee.totalPackages+=he.packages,Ee.totalRemainingPackages+=he.remainingPackages,Ee.subtotal+=he.subtotal,Ee.totalVendor+=he.totalVendor,Ze>Ee.date&&(Ee.date=Ze);else{const Je=d[Re]||{out:0,in:0};se[Re]={orderKey:Re,sellerId:he.sellerId,sellerName:he.sellerName,date:Ze,totalPackages:he.packages,totalRemainingPackages:he.remainingPackages,subtotal:he.subtotal,totalVendor:he.totalVendor,transferredOut:Je.out,transferredIn:Je.in}}}return Object.values(se).map(he=>{const Re=d[he.orderKey]||{out:0,in:0};return{...he,transferredOut:Re.out||0,transferredIn:Re.in||0}}).sort((he,Re)=>Re.date.localeCompare(he.date))},[te,d]),we=N.useMemo(()=>{const se={};return Y.forEach(Fe=>se[Fe.orderKey]=Fe),se},[Y]),Pe=N.useMemo(()=>{const se=j.reduce((Je,Ye)=>Je+Ye.packages,0),Fe=j.reduce((Je,Ye)=>Je+Ye.subtotal,0),he=j.reduce((Je,Ye)=>Je+Ye.totalVendor,0),Re=j.reduce((Je,Ye)=>Je+Ye.gainVendor,0),Ee=Number((K==null?void 0:K.commissionPercent)||0),Ze=he*Ee/100;return{totalPackages:se,subtotal:Fe,totalVendor:he,gainVendor:Re,commissionPercent:Ee,commissionAmount:Ze}},[j,K]),Qe=()=>{F(null),X([]),ae(""),me(""),ye(""),I("0"),Q([])};function tt(se){const Fe=Number(se.providerPrice||0),he=Number(se.packages||0),Re=Number(se.unitPriceRivas||0),Ee=Number(se.unitPriceSanJorge||0),Ze=Number(se.unitPriceIsla||0),Je=Fe*he,Ye=Re*he,$e=Ee*he,it=Ze*he;let ft=Re,Ut=Ye;switch(se.sellerBranch){case"SAN_JORGE":ft=Ee,Ut=$e;break;case"ISLA":ft=Ze,Ut=it;break;case"RIVAS":default:ft=Re,Ut=Ye;break}const Kt=Ut-Je;return{subtotal:Je,totalVendor:Ut,gainVendor:Kt,pricePerPackage:ft,totalRivas:Ye,totalSanJorge:$e,totalIsla:it,unitPriceRivas:Re,unitPriceSanJorge:Ee,unitPriceIsla:Ze}}function ot(se,Fe){const{subtotal:he,totalVendor:Re,gainVendor:Ee,pricePerPackage:Ze,totalRivas:Je,totalSanJorge:Ye,totalIsla:$e,unitPriceRivas:it,unitPriceSanJorge:ft,unitPriceIsla:Ut}=tt({providerPrice:se.providerPrice,unitPriceRivas:se.unitPriceRivas,unitPriceSanJorge:se.unitPriceSanJorge,unitPriceIsla:se.unitPriceIsla,packages:Fe,sellerBranch:M});return{id:`${se.id}-${Date.now()}-${Math.random()}`,productId:se.id,productName:se.name,category:se.category,providerPrice:se.providerPrice,unitsPerPackage:se.unitsPerPackage,packages:Fe,subtotal:he,totalVendor:Re,gainVendor:Ee,pricePerPackage:Ze,totalRivas:Je,totalSanJorge:Ye,totalIsla:$e,unitPriceRivas:it,unitPriceSanJorge:ft,unitPriceIsla:Ut,remainingPackages:Fe}}const dt=()=>{if(c)return;if(!re){B("Selecciona un producto antes de agregarlo.");return}if(de.has(re.id)){B("Ese producto ya est agregado en este pedido.");return}const se=Number(Ie||0);if(se<=0){B("La cantidad de paquetes debe ser mayor a 0.");return}const Fe=p[re.id]??0;if(!_&&se>Fe){B(`No hay suficientes paquetes en inventario general. Disponibles: ${Fe}`);return}const he=ot(re,se);Q(Re=>[...Re,he]),ye(""),I("0")},vt=se=>{c||Q(Fe=>Fe.filter(he=>he.id!==se))},lt=(se,Fe)=>{if(c)return;const he=Number(Fe||0);Q(Re=>Re.map(Ee=>{if(Ee.id!==se)return Ee;const{subtotal:Ze,totalVendor:Je,gainVendor:Ye,pricePerPackage:$e,totalRivas:it,totalSanJorge:ft,totalIsla:Ut}=tt({providerPrice:Ee.providerPrice,unitPriceRivas:Ee.unitPriceRivas,unitPriceSanJorge:Ee.unitPriceSanJorge,unitPriceIsla:Ee.unitPriceIsla,packages:he,sellerBranch:M});return{...Ee,packages:he,subtotal:Ze,totalVendor:Je,gainVendor:Ye,pricePerPackage:$e,totalRivas:it,totalSanJorge:ft,totalIsla:Ut}}))};async function Ue(se,Fe,he){const Re=await Wve({productId:se,quantityPacks:Fe,saleDate:he}),Ee=Array.isArray(Re==null?void 0:Re.allocations)?Re.allocations:[];if(!Ee.length)return[];const Ze=Ee.map($e=>String($e.batchId||"")).filter(Boolean),Je=await Promise.all(Ze.map($e=>Ya(kt(Te,"inventory_candies",$e)))),Ye=[];for(let $e=0;$e<Ee.length;$e++){const it=Ee[$e],ft=String(it.batchId||""),Ut=_3(it.qty||it.units||it.quantity||0),Kt=Je[$e];if(!ft||Ut<=0||!Kt.exists())continue;const yr=Kt.data(),Hn=String(yr.orderId||""),Fn=Math.max(1,_3(yr.unitsPerPackage||1));Hn&&Ye.push({batchId:ft,masterOrderId:Hn,units:Ut,unitsPerPackage:Fn})}return Ye}const Xe=async se=>{if(se.preventDefault(),T)return;if(!i){B("No tienes permiso para guardar pedidos.");return}if(B(""),!K){B("Selecciona un vendedor.");return}if(!j.length){B("Agrega al menos un producto al pedido.");return}const Fe=new Date().toISOString().slice(0,10),he=fe||Fe;try{if(L(!0),R(!0),_){const Re={};D.forEach(Je=>{Re[Je.productId]=Je});const Ee={};j.forEach(Je=>{Ee[Je.productId]=Je});for(const Je of Object.keys(Ee)){const Ye=Ee[Je],$e=Re[Je],it=Number(Ye.packages||0),ft=$e?Number($e.packages||0):0,Ut=it-ft;if(Ut>0){const Kt=await Ue(Je,Ut,he);if($e&&Kt.length){const yr=kt(Te,"inventory_candies_sellers",$e.id),Hn=await Ya(yr),Fn=Hn.exists()?Hn.data():{},Ds=[...Array.isArray(Fn.masterAllocations)?Fn.masterAllocations:[],...Kt];await Pr(yr,{masterAllocations:Ds,updatedAt:$t.now()})}}else Ut<0}let Ze=[...w];for(const Je of Object.keys(Ee)){const Ye=Ee[Je],$e=Re[Je],it=h.find(Kt=>Kt.id===Je),ft=(it==null?void 0:it.unitsPerPackage)||Ye.unitsPerPackage||0,Ut=Ye.packages>0&&ft>0?Ye.packages*ft:0;if($e)await Pr(kt(Te,"inventory_candies_sellers",$e.id),{sellerId:K.id,sellerName:K.name,productId:Je,productName:Ye.productName,category:Ye.category,packages:Ye.packages,unitsPerPackage:ft,totalUnits:Ut,remainingPackages:Ye.packages,remainingUnits:Ut,providerPrice:Ye.providerPrice,totalRivas:Ye.totalRivas,totalSanJorge:Ye.totalSanJorge,totalIsla:Ye.totalIsla,unitPriceRivas:Ye.unitPriceRivas,unitPriceSanJorge:Ye.unitPriceSanJorge,unitPriceIsla:Ye.unitPriceIsla,markupPercent:0,subtotal:Ye.subtotal,totalVendor:Ye.totalVendor,gainVendor:Ye.gainVendor,unitPriceVendor:Ye.pricePerPackage,date:he,orderId:$e.orderId||_,updatedAt:$t.now()}),Ze=Ze.map(Kt=>Kt.id===$e.id?{...Kt,sellerId:K.id,sellerName:K.name,productId:Je,productName:Ye.productName,category:Ye.category,packages:Ye.packages,unitsPerPackage:ft,totalUnits:Ut,remainingPackages:Ye.packages,remainingUnits:Ut,providerPrice:Ye.providerPrice,totalRivas:Ye.totalRivas,totalSanJorge:Ye.totalSanJorge,totalIsla:Ye.totalIsla,unitPriceRivas:Ye.unitPriceRivas,unitPriceSanJorge:Ye.unitPriceSanJorge,unitPriceIsla:Ye.unitPriceIsla,markupPercent:0,subtotal:Ye.subtotal,totalVendor:Ye.totalVendor,gainVendor:Ye.gainVendor,unitPriceVendor:Ye.pricePerPackage,date:he,orderId:$e.orderId||_}:Kt);else{const Kt=await Ue(Je,Ye.packages,he),yr={sellerId:K.id,sellerName:K.name,productId:Je,productName:Ye.productName,category:Ye.category,orderId:_,packages:Ye.packages,unitsPerPackage:ft,totalUnits:Ut,remainingPackages:Ye.packages,remainingUnits:Ut,providerPrice:Ye.providerPrice,totalRivas:Ye.totalRivas,totalSanJorge:Ye.totalSanJorge,totalIsla:Ye.totalIsla,unitPriceRivas:Ye.unitPriceRivas,unitPriceSanJorge:Ye.unitPriceSanJorge,unitPriceIsla:Ye.unitPriceIsla,markupPercent:0,subtotal:Ye.subtotal,totalVendor:Ye.totalVendor,gainVendor:Ye.gainVendor,unitPriceVendor:Ye.pricePerPackage,date:he,createdAt:$t.now(),status:"ASIGNADO",masterAllocations:Kt};Ze=[{id:(await Jr(ht(Te,"inventory_candies_sellers"),yr)).id,...yr},...Ze]}}for(const Je of Object.keys(Re))if(!Ee[Je]){const Ye=Re[Je];await C3(Ye.id),Ze=Ze.filter($e=>$e.id!==Ye.id)}k(Ze),B(" Pedido actualizado para el vendedor y sincronizado con inventario principal.")}else{const Re=`ORD-${Date.now()}-${Math.random().toString(36).slice(2,8)}`;for(const Ee of j){const Ze=h.find(ft=>ft.id===Ee.productId);if(!Ze)continue;const Je=Ee.packages>0&&Ze.unitsPerPackage>0?Ee.packages*Ze.unitsPerPackage:0,Ye=await Ue(Ee.productId,Ee.packages,he),$e={sellerId:K.id,sellerName:K.name,productId:Ee.productId,productName:Ee.productName,category:Ee.category,orderId:Re,packages:Ee.packages,unitsPerPackage:Ze.unitsPerPackage,totalUnits:Je,remainingPackages:Ee.packages,remainingUnits:Je,providerPrice:Ee.providerPrice,totalRivas:Ee.totalRivas,totalSanJorge:Ee.totalSanJorge,totalIsla:Ee.totalIsla,unitPriceRivas:Ee.unitPriceRivas,unitPriceSanJorge:Ee.unitPriceSanJorge,unitPriceIsla:Ee.unitPriceIsla,markupPercent:0,subtotal:Ee.subtotal,totalVendor:Ee.totalVendor,gainVendor:Ee.gainVendor,unitPriceVendor:Ee.pricePerPackage,date:he,createdAt:$t.now(),status:"ASIGNADO",masterAllocations:Ye},it=await Jr(ht(Te,"inventory_candies_sellers"),$e);k(ft=>[{id:it.id,...$e},...ft])}B(" Pedido asignado al vendedor y descontado del inventario.")}Qe(),U(!1)}catch(Re){console.error(Re),B((Re==null?void 0:Re.message)||" Error al guardar el pedido del vendedor / ajustar inventario.")}finally{R(!1),L(!1)}},xe=()=>{if(!K){B("Selecciona un vendedor para imprimir el pedido.");return}if(!j.length){B("No hay productos en el pedido para imprimir.");return}const se=fe||new Date().toISOString().slice(0,10),Fe=Je=>(Je||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),he="Pedido de dulces para vendedor",Re=j.map(Je=>`
      <tr>
        <td>${Fe(Je.productName)}</td>
        <td class="right">${Fe(Je.category||"")}</td>
        <td class="right">${Je.packages}</td>

        <td class="right">${Wr(Je.providerPrice)}</td>
        <td class="right">${Wr(Je.subtotal)}</td>
        <td class="right">${Wr(Je.pricePerPackage)}</td>
        <td class="right">${Wr(Je.totalVendor)}</td>
      </tr>`).join(""),Ee=`<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>${Fe(he)}</title>
  <style>
    *{font-family: Arial, sans-serif; box-sizing:border-box;}
    body{margin:16px;font-size:13px;}
    h1{font-size:18px;margin:0 0 4px;}
    h2{font-size:14px;margin:12px 0 6px;}
    .muted{color:#555;font-size:11px;margin-bottom:10px;}
    .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:6px 18px;margin:10px 0 14px;}
    .card{border:1px solid #ddd;border-radius:6px;padding:6px 8px;background:#fafafa;}
    .label{font-size:11px;color:#555;margin-bottom:2px;}
    .value{font-size:14px;font-weight:bold;}
    table{width:100%;border-collapse:collapse;margin-top:8px;font-size:12px;}
    th,td{border:1px solid #ddd;padding:4px 6px;}
    th{background:#f5f5f5;text-align:left;}
    .right{text-align:right;}
    @media print{
      @page{size:A5;margin:10mm;}
      body{margin:0;font-size:12px;}
    }
  </style>
</head>
<body>
  <h1>${Fe(he)}</h1>
  <div class="muted">
    Fecha pedido: <b>${Fe(se)}</b><br/>
    Vendedor: <b>${Fe(K.name)}</b>${K.commissionPercent?` &mdash; Comisin: <b>${K.commissionPercent.toFixed(2)}%</b>`:""}${K.branchLabel?`<br/>Ruta / sucursal: <b>${Fe(K.branchLabel)}</b>`:""}
  </div>

  <div class="grid">
    <div class="card">
      <div class="label">Paquetes totales del pedido</div>
      <div class="value">${Pe.totalPackages}</div>
    </div>
    <div class="card">
      <div class="label">Subtotal costo (proveedor)</div>
      <div class="value">${Wr(Pe.subtotal)}</div>
    </div>
    <div class="card">
      <div class="label">Total vendedor (precio venta)</div>
      <div class="value">${Wr(Pe.totalVendor)}</div>
    </div>
    <div class="card">
      <div class="label">Comisin posible del vendedor</div>
      <div class="value">${Wr(Pe.commissionAmount)}</div>
    </div>
  </div>

  <h2>Detalle del pedido</h2>
  <table>
    <thead>
      <tr>
        <th>Producto</th>
        <th class="right">Categora</th>
        <th class="right">Paquetes</th>
        <th class="right">P. Proveedor (paq)</th>
        <th class="right">Subtotal</th>
        <th class="right">P. Paquete vendedor</th>
        <th class="right">Total vendedor</th>
      </tr>
    </thead>
    <tbody>
      ${Re}
    </tbody>
  </table>

  <script>window.print()<\/script>
</body>
</html>`,Ze=window.open("","_blank");if(!Ze){alert("No se pudo abrir la ventana de impresin (revisa bloqueadores de pop-ups).");return}Ze.document.open(),Ze.document.write(Ee),Ze.document.close()},ve=se=>{const Fe=te.filter(Ee=>(Ee.orderId||Ee.id)===se);if(!Fe.length){B("No se encontraron filas para este pedido.");return}const he=Fe[0];if(o&&Se&&he.sellerId!==Se.id){B("No tienes permiso para ver este pedido.");return}F(se),X(Fe),ae(he.sellerId),me(he.date);const Re=Fe.map(Ee=>{const Ze=Ee.unitPriceRivas||0,Je=Ee.unitPriceSanJorge||0,Ye=Ee.unitPriceIsla||0,$e=Ee.totalRivas||Ze*Number(Ee.packages||0),it=Ee.totalSanJorge||Je*Number(Ee.packages||0),ft=Ee.totalIsla||Ye*Number(Ee.packages||0);return{id:Ee.id,productId:Ee.productId,productName:Ee.productName,category:Ee.category,providerPrice:Ee.providerPrice,unitsPerPackage:Ee.unitsPerPackage,packages:Ee.packages,subtotal:Ee.subtotal,totalVendor:Ee.totalVendor,gainVendor:Ee.gainVendor,pricePerPackage:Ee.unitPriceVendor,totalRivas:$e,totalSanJorge:it,totalIsla:ft,unitPriceRivas:Ze,unitPriceSanJorge:Je,unitPriceIsla:Ye,remainingPackages:Ee.remainingPackages}});Q(Re),ye(""),I("0"),U(!0)},ie=async se=>{if(!i){B("No tienes permiso para borrar pedidos.");return}const Fe=w.filter(Ee=>(Ee.orderId||Ee.id)===se);if(!Fe.length)return;const he=Fe[0].sellerName||"";if(confirm(`Eliminar COMPLETAMENTE este pedido del vendedor "${he}"? Se regresarn los paquetes al inventario principal.`))try{L(!0);for(const Ee of Fe)await C3(Ee.id);k(Ee=>Ee.filter(Ze=>(Ze.orderId||Ze.id)!==se)),B(" Pedido eliminado y paquetes regresados correctamente.")}catch(Ee){console.error(Ee),B(" Error al eliminar el pedido / regresar paquetes.")}finally{L(!1)}},[ze,rt]=N.useState(!1),[At,Oe]=N.useState(!1),[at,Ve]=N.useState([]),[G,_e]=N.useState(""),[Me,We]=N.useState(""),[He,st]=N.useState(""),[Ct,Xt]=N.useState(""),[Ot,tr]=N.useState("0"),[Zt,et]=N.useState(""),[Rt,er]=N.useState(!1),Lt=N.useMemo(()=>Y.map(se=>se.orderKey),[Y]),Vt=N.useMemo(()=>G?te.filter(se=>(se.orderId||se.id)===G):[],[te,G]),nr=N.useMemo(()=>Vt.filter(se=>Number(se.remainingPackages||0)>0),[Vt]),Mt=N.useMemo(()=>Me&&te.find(se=>se.id===Me)||null,[te,Me]),oe=N.useMemo(()=>He?te.filter(se=>(se.orderId||se.id)===He):[],[te,He]),J=N.useMemo(()=>Mt?oe.filter(se=>se.productId===Mt.productId):[],[oe,Mt]),ce=async()=>{try{Oe(!0);let se=[];if(o&&e){const Fe=Dt(ht(Te,"inventory_transfers_candies"),Gt("fromSellerId","==",e),Ur("createdAt","desc")),he=Dt(ht(Te,"inventory_transfers_candies"),Gt("toSellerId","==",e),Ur("createdAt","desc")),[Re,Ee]=await Promise.all([Nt(Fe),Nt(he)]),Ze=new Set,Je=Ye=>{Ye.forEach($e=>{if(Ze.has($e.id))return;Ze.add($e.id);const it=$e.data();se.push({id:$e.id,createdAt:it.createdAt,date:it.date,createdByEmail:it.createdByEmail||"",createdByName:it.createdByName||"",productId:it.productId||"",productName:it.productName||"",packagesMoved:Number(it.packagesMoved||0),providerPrice:Number(it.providerPrice||0),unitPriceRivas:Number(it.unitPriceRivas||0),unitPriceIsla:Number(it.unitPriceIsla||0),toSellerId:it.toSellerId||"",toSellerName:it.toSellerName||"",toOrderKey:it.toOrderKey||"",toOrderLabel:it.toOrderLabel||"",comment:it.comment||"",fromSellerId:it.fromSellerId||"",fromSellerName:it.fromSellerName||"",fromOrderKey:it.fromOrderKey||"",fromOrderLabel:it.fromOrderLabel||"",fromVendorRowId:it.fromVendorRowId||"",toVendorRowId:it.toVendorRowId||""})})};Je(Re),Je(Ee),se.sort((Ye,$e)=>{var Ut,Kt;const it=((Ut=Ye.createdAt)==null?void 0:Ut.seconds)||0;return(((Kt=$e.createdAt)==null?void 0:Kt.seconds)||0)-it})}else{const Fe=Dt(ht(Te,"inventory_transfers_candies"),Ur("createdAt","desc"));(await Nt(Fe)).forEach(Re=>{const Ee=Re.data();se.push({id:Re.id,createdAt:Ee.createdAt,date:Ee.date,createdByEmail:Ee.createdByEmail||"",createdByName:Ee.createdByName||"",productId:Ee.productId||"",productName:Ee.productName||"",packagesMoved:Number(Ee.packagesMoved||0),providerPrice:Number(Ee.providerPrice||0),unitPriceRivas:Number(Ee.unitPriceRivas||0),unitPriceIsla:Number(Ee.unitPriceIsla||0),toSellerId:Ee.toSellerId||"",toSellerName:Ee.toSellerName||"",toOrderKey:Ee.toOrderKey||"",toOrderLabel:Ee.toOrderLabel||"",comment:Ee.comment||"",fromSellerId:Ee.fromSellerId||"",fromSellerName:Ee.fromSellerName||"",fromOrderKey:Ee.fromOrderKey||"",fromOrderLabel:Ee.fromOrderLabel||"",fromVendorRowId:Ee.fromVendorRowId||"",toVendorRowId:Ee.toVendorRowId||""})})}Ve(se)}catch(se){console.error(se),B(" Error cargando traslados.")}finally{Oe(!1)}},pe=async()=>{rt(!0),await ce()},Be=()=>{_e(""),We(""),st(""),Xt(""),tr("0"),et("")},De=async()=>{if(!i){B("No tienes permiso para hacer traslados.");return}B("");const se=Number(Ot||0);if(!(se>0)){B("La cantidad de paquetes debe ser mayor a 0.");return}if(!Zt.trim()){B("Debes escribir el motivo de la movida.");return}if(!G||!Me){B("Selecciona el pedido origen y el producto.");return}if(!He||!Ct){B("Selecciona el pedido destino y el producto destino.");return}if(Me===Ct){B("Origen y destino no pueden ser el mismo.");return}const Fe=w.find(Re=>Re.id===Me)||null,he=w.find(Re=>Re.id===Ct)||null;if(!Fe||!he){B("No se encontr la fila origen/destino.");return}if(Fe.productId!==he.productId){B("El producto destino no coincide con el producto origen.");return}if(Number(Fe.remainingPackages||0)<se){B("El origen no tiene suficientes paquetes disponibles.");return}try{er(!0),L(!0);const Re=kt(Te,"inventory_candies_sellers",Fe.id),Ee=kt(Te,"inventory_candies_sellers",he.id),Ze=$t.now(),Je=new Date().toISOString().slice(0,10);await pa(Te,async Ye=>{const $e=await Ye.get(Re),it=await Ye.get(Ee);if(!$e.exists())throw new Error("Orden origen no existe.");if(!it.exists())throw new Error("Orden destino no existe.");const ft=$e.data(),Ut=it.data(),Kt=Number(ft.remainingPackages||0);if(Kt<se)throw new Error("Origen no tiene suficientes paquetes.");const yr=Number(ft.unitsPerPackage||Ut.unitsPerPackage||0),Hn=yr>0?se*yr:0;Ye.update(Re,{remainingPackages:Kt-se,...yr>0?{remainingUnits:Number(ft.remainingUnits||0)-Hn}:{},updatedAt:Ze}),Ye.update(Ee,{remainingPackages:Number(Ut.remainingPackages||0)+se,...yr>0?{remainingUnits:Number(Ut.remainingUnits||0)+Hn}:{},updatedAt:Ze});const Fn=kt(ht(Te,"inventory_transfers_candies"));Ye.set(Fn,{createdAt:Ze,date:Je,createdByEmail:(r||"").trim(),createdByName:String(ee||"").trim(),productId:String(ft.productId||""),productName:String(ft.productName||""),packagesMoved:se,providerPrice:Number(ft.providerPrice||0),unitPriceRivas:Number(ft.unitPriceRivas||0),unitPriceIsla:Number(ft.unitPriceIsla||0),fromSellerId:String(ft.sellerId||""),fromSellerName:String(ft.sellerName||""),fromOrderKey:String(ft.orderId||Fe.id||""),fromOrderLabel:String(ft.orderId||Fe.id||""),toSellerId:String(Ut.sellerId||""),toSellerName:String(Ut.sellerName||""),toOrderKey:String(Ut.orderId||he.id||""),toOrderLabel:String(Ut.orderId||he.id||""),fromVendorRowId:Fe.id,toVendorRowId:he.id,comment:Zt.trim()})}),k(Ye=>Ye.map($e=>{if($e.id===Fe.id){const it=Number($e.unitsPerPackage||0),ft=it>0?se*it:0;return{...$e,remainingPackages:Number($e.remainingPackages||0)-se,remainingUnits:it>0?Number($e.remainingUnits||0)-ft:$e.remainingUnits}}if($e.id===he.id){const it=Number($e.unitsPerPackage||0),ft=it>0?se*it:0;return{...$e,remainingPackages:Number($e.remainingPackages||0)+se,remainingUnits:it>0?Number($e.remainingUnits||0)+ft:$e.remainingUnits}}return $e})),await ce(),A(Ye=>{const $e={...Ye},it=G,ft=He,Ut=Number(Ot||0);return it&&($e[it]=$e[it]||{out:0,in:0},$e[it].out+=Ut),ft&&($e[ft]=$e[ft]||{out:0,in:0},$e[ft].in+=Ut),$e}),Be(),B(" Traslado realizado.")}catch(Re){console.error(Re),B((Re==null?void 0:Re.message)||" Error realizando el traslado.")}finally{er(!1),L(!1)}};return a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Ordenes de Rutas"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Zl,{onClick:s,loading:O}),a.jsx("button",{className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-3 py-2 rounded hover:bg-indigo-700 disabled:opacity-30 disabled:bg-gray-300",onClick:pe,type:"button",disabled:!i,children:"Traslados"}),i&&a.jsxs("button",{className:"inline-flex items-center gap-2 bg-green-600 text-white px-3 py-2 rounded hover:bg-green-700",onClick:()=>{Qe(),U(!0)},children:[a.jsx("span",{className:"inline-block bg-green-700/40 rounded-full p-1",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nuevo pedido a vendedor"]})]})]}),ze&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[55]",children:a.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-7xl max-h-[90vh] overflow-y-auto text-sm relative",children:[Rt&&a.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:a.jsx("div",{className:"bg-white border rounded-lg px-4 py-3 shadow text-sm font-semibold",children:"Guardando traslado..."})}),a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-xl font-bold",children:"Traslado de paquetes"}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{rt(!1),Be()},type:"button",children:"Cerrar"})]}),a.jsxs("div",{className:"border rounded p-3 bg-gray-50 mb-4",children:[a.jsx("div",{className:"text-sm font-semibold mb-2",children:"Crear traslado (requiere motivo)"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Pedido origen"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:G,onChange:se=>{_e(se.target.value),We(""),st(""),Xt(""),tr("0")},disabled:!i,children:[a.jsx("option",{value:"",children:"Selecciona"}),Lt.map(se=>{const Fe=we[se];return a.jsxs("option",{value:se,children:["Vendedor: ",(Fe==null?void 0:Fe.sellerName)||"","  Existencias: ","",(Fe==null?void 0:Fe.totalRemainingPackages)||"0"," Paquetes - Fecha Orden: ",(Fe==null?void 0:Fe.date)||""]},se)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Producto (desde el pedido origen)"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:Me,onChange:se=>{We(se.target.value),st(""),Xt(""),tr("0")},disabled:!i||!G,children:[a.jsx("option",{value:"",children:"Selecciona"}),nr.map(se=>a.jsxs("option",{value:se.id,children:["Tipo: ",se.category," - ",se.productName,"  Existencias:"," ",Number(se.remainingPackages||0)," Paquetes - Precio Costo: $",se.providerPrice]},se.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Pedido destino"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:He,onChange:se=>{st(se.target.value),Xt("")},disabled:!i||!Me,children:[a.jsx("option",{value:"",children:"Selecciona"}),Lt.filter(se=>se!==G).map(se=>{const Fe=we[se];return a.jsxs("option",{value:se,children:["Vendedor: ",(Fe==null?void 0:Fe.sellerName)||"","  Existencias: ","",(Fe==null?void 0:Fe.totalRemainingPackages)||"0"," - Fecha Orden:"," ",(Fe==null?void 0:Fe.date)||""]},se)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Producto destino (mismo producto)"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:Ct,onChange:se=>Xt(se.target.value),disabled:!i||!He||!Mt,children:[a.jsx("option",{value:"",children:"Selecciona"}),J.map(se=>a.jsxs("option",{value:se.id,children:["Tipo: ",se.category," - ",se.productName,"  Existencias:"," ",Number(se.remainingPackages||0)," Paquetes - Precio Costo: $",se.providerPrice]},se.id))]}),He&&Mt&&J.length===0&&a.jsx("div",{className:"text-xs text-red-600 mt-1",children:" El pedido destino no tiene este producto. (Debe existir en el pedido destino)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Cantidad paquetes a mover"}),a.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:Ot,onChange:se=>tr(se.target.value),disabled:!i||!Me||!Ct})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Motivo de movida (obligatorio)"}),a.jsx("textarea",{className:"w-full border p-2 rounded resize-y min-h-20",value:Zt,onChange:se=>et(se.target.value),disabled:!i,placeholder:"Ej: Se cambi de ruta por reorganizacin",maxLength:250})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",onClick:Be,disabled:!i||Rt,children:"Limpiar"}),a.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60",onClick:De,disabled:!i||Rt||!Me||!Ct||Number(Ot||0)<=0||!Zt.trim(),children:"Hacer traslado"})]})]}),a.jsxs("div",{className:"bg-white rounded border overflow-x-auto",children:[a.jsxs("div",{className:"flex items-center justify-between p-2",children:[a.jsx("div",{className:"text-lg font-semibold",children:"Historial de traslados"}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:ce,disabled:At,type:"button",children:At?"Cargando...":"Recargar"})]}),a.jsxs("table",{className:"min-w-[1400px] text-xs md:text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{className:"whitespace-nowrap",children:[a.jsx("th",{className:"p-2 border",children:"Fecha y hora"}),a.jsx("th",{className:"p-2 border",children:"Usuario"}),a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"Cantidad paquetes"}),a.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),a.jsx("th",{className:"p-2 border",children:"Precio Rivas"}),a.jsx("th",{className:"p-2 border",children:"Precio Isla"}),a.jsx("th",{className:"p-2 border",children:"Movido a vendedor"}),a.jsx("th",{className:"p-2 border",children:"Movido a orden"}),a.jsx("th",{className:"p-2 border",children:"Motivo de movida"})]})}),a.jsx("tbody",{children:At?a.jsx("tr",{children:a.jsx("td",{colSpan:10,className:"p-4 text-center",children:"Cargando"})}):at.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:10,className:"p-4 text-center",children:"Sin traslados"})}):at.map(se=>{var Ee,Ze;const Fe=((Ze=(Ee=se.createdAt)==null?void 0:Ee.toDate)==null?void 0:Ze.call(Ee))||(se.createdAt?new Date(se.createdAt.seconds*1e3):null),he=Fe?`${Fe.toISOString().slice(0,10)} ${Fe.toISOString().slice(11,19)}`:se.date||"",Re=(se.createdByName||"").trim()||(se.createdByEmail||"").trim()||"";return a.jsxs("tr",{className:"text-center whitespace-nowrap",children:[a.jsx("td",{className:"p-2 border",children:he}),a.jsx("td",{className:"p-2 border",children:Re}),a.jsx("td",{className:"p-2 border text-left",children:se.productName||""}),a.jsx("td",{className:"p-2 border",children:Number(se.packagesMoved||0)}),a.jsx("td",{className:"p-2 border",children:Wr(se.providerPrice||0)}),a.jsx("td",{className:"p-2 border",children:Wr(se.unitPriceRivas||0)}),a.jsx("td",{className:"p-2 border",children:Wr(se.unitPriceIsla||0)}),a.jsx("td",{className:"p-2 border",children:se.toSellerName||""}),a.jsx("td",{className:"p-2 border",children:se.toOrderLabel||se.toOrderKey||""}),a.jsx("td",{className:"p-2 border text-left",children:se.comment||""})]},se.id)})})]})]}),a.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Nota: el traslado mueve EXISTENCIA (remainingPackages/remainingUnits) del pedido origen al destino."})]})}),S&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm relative",children:[T&&a.jsx("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-50",children:a.jsx("div",{className:"bg-white border rounded-lg px-4 py-3 shadow text-sm font-semibold",children:"Guardando pedido..."})}),a.jsx("h3",{className:"text-xl font-bold mb-4",children:_?"Editar pedido de vendedor":"Nuevo pedido para vendedor"}),u.length===0&&a.jsx("p",{className:"text-sm text-red-600 mb-2",children:" No hay vendedores. Primero crea vendedores en la pantalla correspondiente."}),a.jsxs("form",{onSubmit:Xe,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Vendedor"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:ge,onChange:se=>ae(se.target.value),disabled:c,children:[a.jsx("option",{value:"",children:"Selecciona un vendedor"}),u.map(se=>a.jsxs("option",{value:se.id,children:[se.name,se.branchLabel?` - ${se.branchLabel}`:"",se.commissionPercent?` (${se.commissionPercent.toFixed(1)}% comisin)`:""]},se.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del pedido"}),a.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:fe,onChange:se=>me(se.target.value),disabled:c})]})]}),a.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Producto"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:Z,onChange:se=>ye(se.target.value),disabled:c,children:[a.jsx("option",{value:"",children:"Selecciona un producto"}),le.map(se=>{const Fe=p[se.id]??0,he=[];he.push(se.category?`${se.category} - ${se.name}`:se.name);const Re=[];se.unitPriceRivas>0&&Re.push(`R: ${Wr(se.unitPriceRivas)}`),se.unitPriceSanJorge>0&&Re.push(`SJ: ${Wr(se.unitPriceSanJorge)}`),se.unitPriceIsla>0&&Re.push(`I: ${Wr(se.unitPriceIsla)}`),Re.length&&he.push(Re.join(" | ")),he.push(`Disp: ${Fe} paq`);const Ee=de.has(se.id);return a.jsx("option",{value:se.id,disabled:Ee,children:Ee?` (Agregado) ${he.join("  ")}`:he.join("  ")},se.id)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Paquetes / bolsas"}),a.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:Ie,onChange:se=>I(se.target.value),disabled:c})]})]}),a.jsx("div",{className:"flex justify-end mt-3",children:a.jsx("button",{type:"button",onClick:dt,className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",disabled:c||!Z||de.has(Z),title:de.has(Z)?"Ese producto ya est en el pedido":"",children:"Agregar producto al pedido"})})]}),a.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:a.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{className:"whitespace-nowrap",children:[a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"Categora"}),a.jsx("th",{className:"p-2 border",children:"Paquetes"}),a.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),a.jsx("th",{className:"p-2 border",children:"Paq x Und (ref)"}),a.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),a.jsx("th",{className:"p-2 border",children:"Subtotal"}),a.jsx("th",{className:"p-2 border",children:"Total Rivas"}),a.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),a.jsx("th",{className:"p-2 border",children:"Total Isla"}),a.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),a.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),a.jsx("th",{className:"p-2 border",children:"P. unidad Isla"}),a.jsx("th",{className:"p-2 border",children:"P. paquete vendedor"}),a.jsx("th",{className:"p-2 border",children:"Total vendedor"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:j.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:16,className:"p-4 text-center text-gray-500",children:"No hay productos en este pedido. Agrega al menos uno."})}):j.map(se=>a.jsxs("tr",{className:"text-center whitespace-nowrap",children:[a.jsx("td",{className:"p-2 border",children:se.productName}),a.jsx("td",{className:"p-2 border",children:se.category}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"number",min:0,className:"border p-1 rounded text-right text-xs w-20",value:se.packages,onChange:Fe=>lt(se.id,Fe.target.value),disabled:c})}),a.jsx("td",{className:"p-2 border",children:se.remainingPackages??se.packages}),a.jsx("td",{className:"p-2 border",children:se.unitsPerPackage||""}),a.jsx("td",{className:"p-2 border",children:Wr(se.providerPrice)}),a.jsx("td",{className:"p-2 border",children:Wr(se.subtotal)}),a.jsx("td",{className:"p-2 border",children:Wr(se.totalRivas)}),a.jsx("td",{className:"p-2 border",children:Wr(se.totalSanJorge)}),a.jsx("td",{className:"p-2 border",children:Wr(se.totalIsla)}),a.jsx("td",{className:"p-2 border",children:Wr(se.unitPriceRivas)}),a.jsx("td",{className:"p-2 border",children:Wr(se.unitPriceSanJorge)}),a.jsx("td",{className:"p-2 border",children:Wr(se.unitPriceIsla)}),a.jsx("td",{className:"p-2 border",children:Wr(se.pricePerPackage)}),a.jsx("td",{className:"p-2 border",children:Wr(se.totalVendor)}),a.jsx("td",{className:"p-2 border",children:a.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs disabled:opacity-50",onClick:()=>vt(se.id),disabled:c,children:"Quitar"})})]},se.id))})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mt-3",children:[a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes totales del pedido"}),a.jsx("div",{className:"text-lg font-semibold",children:Pe.totalPackages})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal costo (proveedor)"}),a.jsx("div",{className:"text-lg font-semibold",children:Wr(Pe.subtotal)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Total vendedor (precio venta)"}),a.jsx("div",{className:"text-lg font-semibold text-green-600",children:Wr(Pe.totalVendor)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Comisin posible vendedor"}),a.jsx("div",{className:"text-lg font-semibold",children:Wr(Pe.commissionAmount)})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[i&&a.jsx("button",{type:"button",onClick:Qe,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",disabled:T,children:"Limpiar pedido"}),a.jsx("button",{type:"button",onClick:()=>{Qe(),U(!1)},className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-60",disabled:T,children:"Cerrar"}),a.jsx("button",{type:"button",onClick:xe,className:"px-3 py-1 rounded bg-purple-600 text-white hover:bg-purple-700",disabled:!K||j.length===0,children:"Imprimir pedido"}),i&&a.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",disabled:T||!K||j.length===0,children:T?"Guardando...":"Guardar pedido"})]})]})]})}),a.jsx("div",{className:"block md:hidden space-y-3 mt-4",children:Y.map(se=>{var Je,Ye;const Fe=q[se.sellerId],he=Number((Fe==null?void 0:Fe.commissionPercent)||0),Re=se.totalVendor*he/100,Ee=x===se.orderKey,Ze=Ee?Ne(se.orderKey):[];return a.jsxs("div",{className:"border rounded-lg p-3 bg-white shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-sm",children:se.sellerName}),a.jsx("div",{className:"text-xs text-gray-500",children:(Fe==null?void 0:Fe.branchLabel)||""})]}),a.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[a.jsx("div",{children:se.date||""}),a.jsx("div",{className:"truncate max-w-[140px]",children:se.orderKey})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs mb-2",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Paquetes:"})," ",a.jsx("b",{children:se.totalPackages})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Restantes:"})," ",a.jsx("b",{children:se.totalRemainingPackages})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Trasl. OUT:"})," ",a.jsx("b",{children:((Je=d[se.orderKey])==null?void 0:Je.out)||0})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Trasl. IN:"})," ",a.jsx("b",{children:((Ye=d[se.orderKey])==null?void 0:Ye.in)||0})]})]}),a.jsxs("div",{className:"text-sm border-t pt-2 space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),a.jsx("span",{children:Wr(se.subtotal)})]}),a.jsxs("div",{className:"flex justify-between font-semibold",children:[a.jsx("span",{children:"Total:"}),a.jsx("span",{children:Wr(se.totalVendor)})]}),a.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[a.jsx("span",{children:"Comisin:"}),a.jsx("span",{children:Wr(Re)})]})]}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx("button",{className:"flex-1 bg-blue-600 text-white py-2 rounded text-xs",onClick:()=>ve(se.orderKey),children:"Ver / Editar"}),i&&a.jsx("button",{className:"flex-1 bg-red-600 text-white py-2 rounded text-xs",onClick:()=>ie(se.orderKey),children:"Borrar"})]}),a.jsx("button",{type:"button",className:"w-full mt-2 border rounded py-2 text-xs bg-gray-50 hover:bg-gray-100",onClick:()=>{b($e=>$e===se.orderKey?null:se.orderKey)},children:Ee?"Ocultar detalle":"Ver detalle del pedido"}),Ee&&a.jsxs("div",{className:"mt-2 border rounded bg-white overflow-hidden",children:[a.jsx("div",{className:"px-3 py-2 text-xs font-semibold bg-gray-100",children:"Detalle del pedido"}),Ze.length===0?a.jsx("div",{className:"p-3 text-xs text-gray-500",children:"Sin detalle"}):a.jsx("div",{className:"divide-y",children:Ze.map($e=>a.jsxs("div",{className:"p-3 text-xs",children:[a.jsxs("div",{className:"flex justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-semibold truncate",children:$e.productName}),a.jsx("div",{className:"text-gray-500 truncate",children:$e.category||""})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Paq:"})," ",a.jsx("b",{children:Number($e.packages||0)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Rem:"})," ",a.jsx("b",{children:Number($e.remainingPackages||0)})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"Costo:"}),a.jsx("span",{children:Wr(Number($e.providerPrice||0))})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"Total:"}),a.jsx("span",{className:"font-semibold",children:Wr(Number($e.totalVendor||0))})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2 text-[11px] text-gray-600",children:[a.jsxs("div",{className:"text-center border rounded py-1",children:["R ",Wr(Number($e.unitPriceRivas||0))]}),a.jsxs("div",{className:"text-center border rounded py-1",children:["SJ ",Wr(Number($e.unitPriceSanJorge||0))]}),a.jsxs("div",{className:"text-center border rounded py-1",children:["I ",Wr(Number($e.unitPriceIsla||0))]})]})]},$e.id))})]})]},se.orderKey)})}),a.jsxs("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto mt-4",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Listado de pedidos"}),a.jsxs("table",{className:"min-w-[1000px] text-xs md:text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{className:"whitespace-nowrap",children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Vendedor"}),a.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),a.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),a.jsx("th",{className:"p-2 border",children:"Paquetes Trasladados"}),a.jsx("th",{className:"p-2 border",children:"Paquetes Adicionales"}),a.jsx("th",{className:"p-2 border",children:"Subtotal costo"}),a.jsx("th",{className:"p-2 border",children:"Total vendedor"}),a.jsx("th",{className:"p-2 border",children:"Comisin posible"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:O?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:8,children:"Cargando"})}):Y.length===0?a.jsx("tr",{children:a.jsx("td",{className:"p-4 text-center",colSpan:8,children:"Sin pedidos asignados a vendedores."})}):Y.map(se=>{var Ee,Ze;const Fe=q[se.sellerId],he=Number((Fe==null?void 0:Fe.commissionPercent)||0),Re=se.totalVendor*he/100;return a.jsxs("tr",{className:"text-center whitespace-nowrap",children:[a.jsx("td",{className:"p-2 border",children:se.date||""}),a.jsxs("td",{className:"p-2 border",children:[se.sellerName,Fe!=null&&Fe.branchLabel?` - ${Fe.branchLabel}`:""]}),a.jsx("td",{className:"p-2 border",children:se.totalPackages}),a.jsx("td",{className:"p-2 border",children:se.totalRemainingPackages}),a.jsx("td",{className:"p-2 border",children:((Ee=d[se.orderKey])==null?void 0:Ee.out)||0}),a.jsx("td",{className:"p-2 border",children:((Ze=d[se.orderKey])==null?void 0:Ze.in)||0}),a.jsx("td",{className:"p-2 border",children:Wr(se.subtotal)}),a.jsx("td",{className:"p-2 border",children:Wr(se.totalVendor)}),a.jsx("td",{className:"p-2 border",children:Wr(Re)}),a.jsx("td",{className:"p-2 border",children:a.jsxs("div",{className:"flex gap-1 justify-center",children:[a.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>ve(se.orderKey),children:"Ver / Editar"}),i&&a.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>ie(se.orderKey),children:"Borrar"})]})})]},se.orderKey)})})]})]}),E&&a.jsx("p",{className:"mt-2 text-sm",children:E})]})}function xC(t){return isFinite(t)?Math.round(t):0}function Qn(t){const e=Number(t);return Number.isFinite(e)?Math.floor(e):0}function m7(t){const e=Math.max(1,Qn(t.unitsPerPackage||1)),r=Qn(t.totalUnits||0),n=Qn(t.quantity||0),s=Qn(t.packages||0);return r>0?r:n>0?n:s>0?s*e:0}function C1e(t){const e=Number(t.remaining);return Number.isFinite(e)&&e>0?Math.floor(e):m7(t)}function E3(t){const e=Number(t.remainingPackages);if(Number.isFinite(e))return Math.max(0,Math.floor(e));const r=Math.max(1,Qn(t.unitsPerPackage||1)),n=C1e(t);return Math.max(0,Math.floor(n/r))}function _1e(t){const e=Math.max(1,Qn(t.unitsPerPackage||1)),r=m7(t);return Math.max(0,Math.floor(r/e))}function E1e(){const{refreshKey:t,refresh:e}=vl(),[r,n]=N.useState(""),[s,i]=N.useState(!0),[o,l]=N.useState([]),[c,d]=N.useState(!1),[A,u]=N.useState([]),[f,h]=N.useState({}),[m,p]=N.useState(!1),[g,x]=N.useState(null),[b,w]=N.useState(""),[k,O]=N.useState(""),[L,E]=N.useState("20"),[B,S]=N.useState("15"),[U,_]=N.useState("30"),[F,D]=N.useState([]),[X,ge]=N.useState(""),[ae,fe]=N.useState(""),[me,Z]=N.useState(""),[ye,Ie]=N.useState("1"),[I,j]=N.useState("0"),[Q,T]=N.useState("DATOS"),R=N.useMemo(()=>{const Y=new Set;for(const we of o){const Pe=String(we.category||"").trim();Pe&&Y.add(Pe)}return Array.from(Y).sort((we,Pe)=>we.localeCompare(Pe,"es"))},[o]);N.useEffect(()=>{!X&&R.length>0&&ge(R[0])},[R]);const K=(Y,we,Pe)=>{const Qe=Y*we,tt=Math.min(Math.max(Pe.marginR,0),99.9)/100,ot=Math.min(Math.max(Pe.marginSJ,0),99.9)/100,dt=Math.min(Math.max(Pe.marginIsla,0),99.9)/100,vt=we>0&&tt<1?Qe/(1-tt):Qe,lt=we>0&&ot<1?Qe/(1-ot):Qe,Ue=we>0&&dt<1?Qe/(1-dt):Qe,Xe=vt-Qe,xe=lt-Qe,ve=Ue-Qe,ie=we>0?xC(vt/we):0,ze=we>0?xC(lt/we):0,rt=we>0?xC(Ue/we):0;return{subtotal:Qe,totalRivas:vt,totalSanJorge:lt,totalIsla:Ue,gainRivas:Xe,gainSanJorge:xe,gainIsla:ve,unitPriceRivas:ie,unitPriceSanJorge:ze,unitPriceIsla:rt}},M=()=>{x(null),w(""),O(""),D([]),ge(R[0]||""),fe(""),Z(""),j("0"),Ie("1"),E("20"),S("15"),_("30"),T("DATOS")},re=async()=>{d(!0);try{const Y=await Nt(Dt(ht(Te,"products_candies"),Ur("createdAt","desc"))),we=[];Y.forEach(Pe=>{const Qe=Pe.data();we.push({id:Pe.id,name:String(Qe.name??"").trim(),category:String(Qe.category??"").trim()||"Caramelo",providerPrice:Number(Qe.providerPrice??0),unitsPerPackage:Number(Qe.unitsPerPackage??1)})}),l(we)}catch(Y){console.error(Y),n(" Error cargando catlogo de dulces.")}finally{d(!1)}};N.useEffect(()=>{re()},[t]);const de=N.useMemo(()=>(X.trim().length>0?o.filter(we=>we.category===X):o).sort((we,Pe)=>we.name.localeCompare(Pe.name,"es")),[o,X]);N.useEffect(()=>{if(!ae){Z(""),Ie("1");return}const Y=o.find(we=>we.id===ae);Y&&(Z(String(Y.providerPrice??0)),Ie(String(Y.unitsPerPackage??1)))},[ae,o]);const le=()=>{if(n(""),!ae){n("Selecciona un producto del catlogo.");return}const Y=o.find(lt=>lt.id===ae);if(!Y){n("Producto de catlogo no encontrado (refresca).");return}const we=Number(Y.providerPrice||0),Pe=Qn(I||0),Qe=Qn(Y.unitsPerPackage||0);if(we<0){n("El precio proveedor no puede ser negativo.");return}if(Pe<=0){n("Los paquetes del pedido general deben ser mayor que 0.");return}if(Qe<=0){n("Las unidades por paquete deben ser mayor que 0.");return}const tt=Number(L||0),ot=Number(B||0),dt=Number(U||0);if(F.find(lt=>lt.id===Y.id))D(lt=>lt.map(Ue=>{if(Ue.id!==Y.id)return Ue;const Xe=Qn(Ue.packages||0)+Pe,xe=K(we,Xe,{marginR:Number(Ue.marginRivas||tt),marginSJ:Number(Ue.marginSanJorge||ot),marginIsla:Number(Ue.marginIsla||dt)});return{...Ue,providerPrice:we,unitsPerPackage:Qe,packages:Xe,remainingPackages:Qn(Ue.remainingPackages??Ue.packages)+Pe,...xe}}));else{const lt=K(we,Pe,{marginR:tt,marginSJ:ot,marginIsla:dt}),Ue={id:Y.id,name:Y.name,category:Y.category,providerPrice:we,packages:Pe,unitsPerPackage:Qe,marginRivas:tt,marginSanJorge:ot,marginIsla:dt,subtotal:lt.subtotal,totalRivas:lt.totalRivas,totalSanJorge:lt.totalSanJorge,totalIsla:lt.totalIsla,gainRivas:lt.gainRivas,gainSanJorge:lt.gainSanJorge,gainIsla:lt.gainIsla,unitPriceRivas:lt.unitPriceRivas,unitPriceSanJorge:lt.unitPriceSanJorge,unitPriceIsla:lt.unitPriceIsla,remainingPackages:Pe};D(Xe=>[...Xe,Ue])}fe(""),j("0"),T("ITEMS")},q=Y=>{D(we=>we.filter(Pe=>Pe.id!==Y))},Se=N.useMemo(()=>{const Y=F.reduce((ot,dt)=>ot+Qn(dt.packages),0),we=F.reduce((ot,dt)=>ot+Number(dt.subtotal||0),0),Pe=F.reduce((ot,dt)=>ot+Number(dt.totalRivas||0),0),Qe=F.reduce((ot,dt)=>ot+Number(dt.totalSanJorge||0),0),tt=F.reduce((ot,dt)=>ot+Number(dt.totalIsla||0),0);return{totalPackages:Y,subtotal:we,totalRivas:Pe,totalSanJorge:Qe,totalIsla:tt}},[F]),ee=(Y,we,Pe)=>{D(Qe=>Qe.map(tt=>{if(tt.id!==Y)return tt;let ot={...tt};if(we==="packages"&&(ot.packages=Qn(Pe||0)),we==="unitsPerPackage"&&(ot.unitsPerPackage=Qn(Pe||0)),we==="marginRivas"&&(ot.marginRivas=Number(Pe||0)),we==="marginSanJorge"&&(ot.marginSanJorge=Number(Pe||0)),we==="marginIsla"&&(ot.marginIsla=Number(Pe||0)),we==="packages"||we==="marginRivas"||we==="marginSanJorge"||we==="marginIsla"){const dt=K(ot.providerPrice,ot.packages,{marginR:Number(ot.marginRivas||0),marginSJ:Number(ot.marginSanJorge||0),marginIsla:Number(ot.marginIsla||0)});ot={...ot,...dt}}return ot}))};N.useEffect(()=>{(async()=>{i(!0);try{const Y=Dt(ht(Te,"candy_main_orders"),Ur("createdAt","desc")),we=await Nt(Y),Pe=[];we.forEach(ot=>{const dt=ot.data();Pe.push({id:ot.id,name:dt.name??"",date:dt.date??"",totalPackages:Number(dt.totalPackages??0),subtotal:Number(dt.subtotal??0),totalRivas:Number(dt.totalRivas??0),totalSanJorge:Number(dt.totalSanJorge??0),totalIsla:Number(dt.totalIsla??0),marginRivas:Number(dt.marginRivas??20),marginSanJorge:Number(dt.marginSanJorge??15),marginIsla:Number(dt.marginIsla??30),createdAt:dt.createdAt??$t.now()})}),u(Pe);const Qe=await Nt(ht(Te,"inventory_candies")),tt={};Qe.forEach(ot=>{const dt=ot.data(),vt=dt.orderId;if(!vt)return;const lt=_1e(dt),Ue=E3(dt);tt[vt]||(tt[vt]={orderId:vt,totalPackages:0,remainingPackages:0}),tt[vt].totalPackages+=lt,tt[vt].remainingPackages+=Ue}),h(tt)}catch(Y){console.error(Y),n(" Error cargando pedidos generales.")}finally{i(!1)}})()},[t]);const z=async Y=>{if(Y.preventDefault(),n(""),!F.length){n("Agrega al menos un producto al pedido general.");return}try{const we=new Date().toISOString().slice(0,10),Pe=k||we,Qe=Se,tt=Number(L||0),ot=Number(B||0),dt=Number(U||0);for(const lt of F){if(!lt.name.trim()){n("Hay un producto sin nombre en el pedido.");return}if(lt.providerPrice<0){n(`El precio proveedor no puede ser negativo (producto: ${lt.name}).`);return}if(lt.packages<=0){n(`Los paquetes deben ser mayor que 0 (producto: ${lt.name}).`);return}if(lt.unitsPerPackage<=0){n(`Las unidades por paquete deben ser mayor que 0 (producto: ${lt.name}).`);return}}const vt={name:b||`Pedido ${Pe}`,date:Pe,totalPackages:Qe.totalPackages,subtotal:Qe.subtotal,totalRivas:Qe.totalRivas,totalSanJorge:Qe.totalSanJorge,totalIsla:Qe.totalIsla,marginRivas:tt,marginSanJorge:ot,marginIsla:dt,items:F};if(g){await Pr(kt(Te,"candy_main_orders",g),{...vt});for(const Xe of F){const xe=await Nt(Dt(ht(Te,"inventory_candies"),Gt("orderId","==",g),Gt("productId","==",Xe.id))),ve=Qn(Xe.packages)*Qn(Xe.unitsPerPackage),ie=Math.max(1,Qn(Xe.unitsPerPackage||1));if(xe.empty)await Jr(ht(Te,"inventory_candies"),{productId:Xe.id,productName:Xe.name,category:Xe.category,measurement:"unidad",quantity:ve,remaining:ve,packages:Qn(Xe.packages),remainingPackages:Qn(Xe.packages),unitsPerPackage:ie,totalUnits:ve,providerPrice:Xe.providerPrice,subtotal:Xe.subtotal,totalRivas:Xe.totalRivas,totalSanJorge:Xe.totalSanJorge,totalIsla:Xe.totalIsla,gainRivas:Xe.gainRivas,gainSanJorge:Xe.gainSanJorge,gainIsla:Xe.gainIsla,unitPriceRivas:Xe.unitPriceRivas,unitPriceSanJorge:Xe.unitPriceSanJorge,unitPriceIsla:Xe.unitPriceIsla,date:Pe,createdAt:$t.now(),status:"PENDIENTE",orderId:g});else for(const ze of xe.docs){const rt=ze.data(),At=Qn(rt.totalUnits??0),Oe=Qn(rt.remaining??At),at=ve-At,Ve=Math.max(0,Oe+at),G=Math.max(0,Math.floor(Ve/ie));await Pr(kt(Te,"inventory_candies",ze.id),{productName:Xe.name,category:Xe.category,unitsPerPackage:ie,totalUnits:ve,quantity:ve,remaining:Ve,packages:Qn(Xe.packages),remainingPackages:G,providerPrice:Xe.providerPrice,subtotal:Xe.subtotal,totalRivas:Xe.totalRivas,totalSanJorge:Xe.totalSanJorge,totalIsla:Xe.totalIsla,gainRivas:Xe.gainRivas,gainSanJorge:Xe.gainSanJorge,gainIsla:Xe.gainIsla,unitPriceRivas:Xe.unitPriceRivas,unitPriceSanJorge:Xe.unitPriceSanJorge,unitPriceIsla:Xe.unitPriceIsla,date:Pe})}}const lt=await Nt(Dt(ht(Te,"inventory_candies"),Gt("orderId","==",g))),Ue=new Set(F.map(Xe=>Xe.id));for(const Xe of lt.docs){const xe=Xe.data(),ve=String(xe.productId||"");ve&&!Ue.has(ve)&&await un(kt(Te,"inventory_candies",Xe.id))}u(Xe=>Xe.map(xe=>xe.id===g?{...xe,name:vt.name,date:vt.date,totalPackages:vt.totalPackages,subtotal:vt.subtotal,totalRivas:vt.totalRivas,totalSanJorge:vt.totalSanJorge,totalIsla:vt.totalIsla,marginRivas:vt.marginRivas,marginSanJorge:vt.marginSanJorge,marginIsla:vt.marginIsla}:xe)),n(" Orden maestra actualizada (pedido + inventario).")}else{const Ue=(await Jr(ht(Te,"candy_main_orders"),{...vt,createdAt:$t.now()})).id,Xe=Xh(Te);for(const xe of F){const ve=Math.max(1,Qn(xe.unitsPerPackage||1)),ie=Qn(xe.packages)*ve,ze=kt(ht(Te,"inventory_candies"));Xe.set(ze,{productId:xe.id,productName:xe.name,category:xe.category,measurement:"unidad",quantity:ie,remaining:ie,packages:Qn(xe.packages),remainingPackages:Qn(xe.packages),unitsPerPackage:ve,totalUnits:ie,providerPrice:xe.providerPrice,subtotal:xe.subtotal,totalRivas:xe.totalRivas,totalSanJorge:xe.totalSanJorge,totalIsla:xe.totalIsla,gainRivas:xe.gainRivas,gainSanJorge:xe.gainSanJorge,gainIsla:xe.gainIsla,unitPriceRivas:xe.unitPriceRivas,unitPriceSanJorge:xe.unitPriceSanJorge,unitPriceIsla:xe.unitPriceIsla,date:Pe,createdAt:$t.now(),status:"PENDIENTE",orderId:Ue})}await Xe.commit(),n(" Orden maestra creada y registrada en inventario.")}M(),p(!1),e()}catch(we){console.error(we),n(" Error al guardar orden maestra.")}},te=async Y=>{try{i(!0),n(""),x(Y.id),w(Y.name),O(Y.date),E(String(Y.marginRivas??20)),S(String(Y.marginSanJorge??15)),_(String(Y.marginIsla??30)),T("DATOS");const we=kt(Te,"candy_main_orders",Y.id),Pe=await Ya(we);if(!Pe.exists()){n(" No se encontr la orden.");return}const Qe=Pe.data(),tt=Array.isArray(Qe.items)?Qe.items:[],ot=await Nt(Dt(ht(Te,"inventory_candies"),Gt("orderId","==",Y.id))),dt={};ot.forEach(lt=>{const Ue=lt.data(),Xe=String(Ue.productId||"");if(!Xe)return;const xe=E3(Ue);dt[Xe]=(dt[Xe]||0)+xe});const vt=tt.map(lt=>{const Ue=o.find(ie=>ie.id===lt.id),Xe=Number((Ue==null?void 0:Ue.providerPrice)??lt.providerPrice??0),xe=Math.max(1,Qn((Ue==null?void 0:Ue.unitsPerPackage)??lt.unitsPerPackage??1)),ve=K(Xe,Qn(lt.packages||0),{marginR:Number(lt.marginRivas||0),marginSJ:Number(lt.marginSanJorge||0),marginIsla:Number(lt.marginIsla||0)});return{...lt,name:String((Ue==null?void 0:Ue.name)??lt.name??""),category:String((Ue==null?void 0:Ue.category)??lt.category??"Caramelo"),providerPrice:Xe,unitsPerPackage:xe,remainingPackages:dt[lt.id]??lt.remainingPackages??lt.packages??0,...ve}});D(vt),p(!0)}catch(we){console.error(we),n(" Error al abrir orden maestra.")}finally{i(!1)}},Ne=async Y=>{if(confirm(`Eliminar la orden "${Y.name}" y todo su inventario asociado?`)){n("");try{const Pe=await Nt(Dt(ht(Te,"inventory_candies"),Gt("orderId","==",Y.id)));for(const Qe of Pe.docs)await un(kt(Te,"inventory_candies",Qe.id));await un(kt(Te,"candy_main_orders",Y.id)),u(Qe=>Qe.filter(tt=>tt.id!==Y.id)),n(" Orden maestra eliminada."),e()}catch(Pe){console.error(Pe),n(" Error al eliminar orden maestra.")}}};return a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("h2",{className:"text-2xl font-bold",children:"Ordenes Maestras"})}),a.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-2",children:[a.jsx("div",{className:"w-full",children:a.jsx(Zl,{onClick:e,loading:s||c})}),a.jsxs("button",{className:"items-center gap-2 bg-indigo-600 text-white px-3 py-2 rounded-2xl hover:bg-indigo-700",onClick:()=>{M(),p(!0)},children:[a.jsx("span",{className:"items-center gap-4 inline-block bg-indigo-700/40 rounded-full ",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),"Nueva Orden"]})]})]}),m&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-3",children:a.jsxs("div",{className:"bg-white p-4 md:p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm",children:[a.jsxs("div",{className:"sticky top-0 bg-white z-20 pb-3 border-b",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("h3",{className:"text-lg md:text-xl font-bold",children:g?"Editar Orden Maestra":"Nueva Orden Maestra"}),a.jsx("div",{className:"ml-auto flex gap-2",children:a.jsx("button",{type:"button",className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{M(),p(!1)},children:"Cerrar"})})]}),a.jsx("div",{className:"md:hidden mt-3",children:a.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[a.jsx("button",{type:"button",onClick:()=>T("DATOS"),className:`px-2 py-2 rounded text-xs font-semibold border ${Q==="DATOS"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Datos"}),a.jsx("button",{type:"button",onClick:()=>T("AGREGAR"),disabled:!!g,className:`px-2 py-2 rounded text-xs font-semibold border ${g?"bg-gray-100 text-gray-400 border-gray-200":Q==="AGREGAR"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,title:g?"En edicin no se agregan productos":"",children:"Agregar"}),a.jsxs("button",{type:"button",onClick:()=>T("ITEMS"),className:`px-2 py-2 rounded text-xs font-semibold border ${Q==="ITEMS"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:["Items (",F.length,")"]}),a.jsx("button",{type:"button",onClick:()=>T("TOTALES"),className:`px-2 py-2 rounded text-xs font-semibold border ${Q==="TOTALES"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-200"}`,children:"Totales"})]})})]}),a.jsxs("form",{onSubmit:z,className:"space-y-4 pt-4",children:[a.jsx("div",{className:`${Q==="DATOS"?"block":"hidden"} md:block`,children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Nombre de Orden"}),a.jsx("input",{className:"w-full border p-2 rounded",value:b,onChange:Y=>w(Y.target.value),placeholder:"Ej: Pedido diciembre 01"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Fecha del pedido"}),a.jsx("input",{type:"date",className:"w-full border p-2 rounded",value:k,onChange:Y=>O(Y.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Rivas"}),a.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:L,onChange:Y=>E(Y.target.value),disabled:!!g})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia San Jorge"}),a.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:B,onChange:Y=>S(Y.target.value),disabled:!!g})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"% Ganancia Isla Ometepe"}),a.jsx("input",{type:"number",className:"w-full border p-2 rounded",value:U,onChange:Y=>_(Y.target.value),disabled:!!g})]})]})}),!g&&a.jsx("div",{className:`${Q==="AGREGAR"?"block":"hidden"} md:block`,children:a.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Categora (dinmica)"}),a.jsx("select",{className:"w-full border p-2 rounded",value:X,onChange:Y=>{ge(Y.target.value),fe("")},disabled:c,children:R.length===0?a.jsx("option",{value:"",children:c?"Cargando...":"No hay categoras en catlogo"}):R.map(Y=>a.jsx("option",{value:Y,children:Y},Y))})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Producto (catlogo)"}),a.jsxs("select",{className:"w-full border p-2 rounded",value:ae,onChange:Y=>fe(Y.target.value),children:[a.jsx("option",{value:"",children:c?"Cargando catlogo...":"Selecciona producto"}),de.map(Y=>a.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Precio proveedor (paq)"}),a.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:me,readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Paquetes"}),a.jsx("input",{type:"number",min:0,className:"w-full border p-2 rounded",value:I,onChange:Y=>j(Y.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold",children:"Unidades por paquete"}),a.jsx("input",{type:"number",className:"w-full border p-2 rounded bg-gray-100",value:ye,readOnly:!0})]})]}),a.jsx("div",{className:"flex justify-end mt-3",children:a.jsx("button",{type:"button",onClick:le,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700",children:"Agregar producto al pedido"})})]})}),a.jsxs("div",{className:`${Q==="ITEMS"?"block":"hidden"} md:block`,children:[a.jsx("div",{className:"md:hidden space-y-3",children:F.length===0?a.jsx("div",{className:"p-4 border rounded bg-gray-50 text-gray-600",children:"No hay productos en esta orden."}):F.map(Y=>a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm",children:[a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-semibold text-base leading-tight",children:Y.name}),a.jsx("div",{className:"text-xs text-gray-500",children:Y.category})]}),!g&&a.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>q(Y.id),children:"Quitar"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:"Paquetes"}),a.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:Y.packages,onChange:we=>ee(Y.id,"packages",we.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:"Restantes"}),a.jsx("input",{className:"w-full border p-2 rounded text-right bg-gray-100",value:Y.remainingPackages??Y.packages,readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:"Und x Paq"}),a.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:Y.unitsPerPackage,onChange:we=>ee(Y.id,"unitsPerPackage",we.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:"P. proveedor"}),a.jsx("input",{className:"w-full border p-2 rounded text-right bg-gray-100",value:Number(Y.providerPrice||0).toFixed(2),readOnly:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:"% Rivas"}),a.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:Y.marginRivas??0,onChange:we=>ee(Y.id,"marginRivas",we.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:"% SJ"}),a.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:Y.marginSanJorge??0,onChange:we=>ee(Y.id,"marginSanJorge",we.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:"% Isla"}),a.jsx("input",{type:"number",className:"w-full border p-2 rounded text-right",value:Y.marginIsla??0,onChange:we=>ee(Y.id,"marginIsla",we.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[a.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal"}),a.jsx("div",{className:"font-semibold",children:Number(Y.subtotal||0).toFixed(2)})]}),a.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Total Rivas"}),a.jsx("div",{className:"font-semibold",children:Number(Y.totalRivas||0).toFixed(2)})]}),a.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Total SJ"}),a.jsx("div",{className:"font-semibold",children:Number(Y.totalSanJorge||0).toFixed(2)})]}),a.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Total Isla"}),a.jsx("div",{className:"font-semibold",children:Number(Y.totalIsla||0).toFixed(2)})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-3 text-xs",children:[a.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[a.jsx("div",{className:"text-gray-600",children:"P. unidad Rivas"}),a.jsx("div",{className:"font-semibold",children:Y.unitPriceRivas})]}),a.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[a.jsx("div",{className:"text-gray-600",children:"P. unidad SJ"}),a.jsx("div",{className:"font-semibold",children:Y.unitPriceSanJorge})]}),a.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[a.jsx("div",{className:"text-gray-600",children:"P. unidad Isla"}),a.jsx("div",{className:"font-semibold",children:Y.unitPriceIsla})]})]})]},Y.id))}),a.jsx("div",{className:"hidden md:block bg-white rounded border overflow-x-auto",children:a.jsxs("table",{className:"min-w-[1100px] text-xs md:text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{className:"whitespace-nowrap",children:[a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"Categora"}),a.jsx("th",{className:"p-2 border",children:"Paquetes"}),a.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),a.jsx("th",{className:"p-2 border",children:"Und x Paq"}),a.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),a.jsx("th",{className:"p-2 border",children:"Margen Rivas (%)"}),a.jsx("th",{className:"p-2 border",children:"Margen San Jorge (%)"}),a.jsx("th",{className:"p-2 border",children:"Margen Isla (%)"}),a.jsx("th",{className:"p-2 border",children:"Subtotal"}),a.jsx("th",{className:"p-2 border",children:"Total Rivas"}),a.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),a.jsx("th",{className:"p-2 border",children:"Total Isla"}),a.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),a.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),a.jsx("th",{className:"p-2 border",children:"P. unidad Isla"}),!g&&a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:F.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:g?16:17,className:"p-4 text-center text-gray-500",children:"No hay productos en esta orden."})}):F.map(Y=>a.jsxs("tr",{className:"text-center whitespace-nowrap",children:[a.jsx("td",{className:"p-2 border text-left",children:Y.name}),a.jsx("td",{className:"p-2 border",children:Y.category}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"number",className:"w-24 border p-1 rounded text-right",value:Y.packages,onChange:we=>ee(Y.id,"packages",we.target.value)})}),a.jsx("td",{className:"p-2 border",children:Y.remainingPackages??Y.packages}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:Y.unitsPerPackage,onChange:we=>ee(Y.id,"unitsPerPackage",we.target.value)})}),a.jsx("td",{className:"p-2 border",children:Number(Y.providerPrice||0).toFixed(2)}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:Y.marginRivas??0,onChange:we=>ee(Y.id,"marginRivas",we.target.value)})}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:Y.marginSanJorge??0,onChange:we=>ee(Y.id,"marginSanJorge",we.target.value)})}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"number",className:"w-20 border p-1 rounded text-right",value:Y.marginIsla??0,onChange:we=>ee(Y.id,"marginIsla",we.target.value)})}),a.jsx("td",{className:"p-2 border",children:Number(Y.subtotal||0).toFixed(2)}),a.jsx("td",{className:"p-2 border",children:Number(Y.totalRivas||0).toFixed(2)}),a.jsx("td",{className:"p-2 border",children:Number(Y.totalSanJorge||0).toFixed(2)}),a.jsx("td",{className:"p-2 border",children:Number(Y.totalIsla||0).toFixed(2)}),a.jsx("td",{className:"p-2 border",children:Y.unitPriceRivas}),a.jsx("td",{className:"p-2 border",children:Y.unitPriceSanJorge}),a.jsx("td",{className:"p-2 border",children:Y.unitPriceIsla}),!g&&a.jsx("td",{className:"p-2 border",children:a.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>q(Y.id),children:"Quitar"})})]},Y.id))})]})})]}),a.jsx("div",{className:`${Q==="TOTALES"?"block":"hidden"} md:block`,children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mt-3",children:[a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes totales de la orden"}),a.jsx("div",{className:"text-lg font-semibold",children:Se.totalPackages})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal costo (proveedor)"}),a.jsx("div",{className:"text-lg font-semibold",children:Se.subtotal.toFixed(2)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Total Rivas (orden)"}),a.jsx("div",{className:"text-lg font-semibold",children:Se.totalRivas.toFixed(2)})]}),a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Total San Jorge / Isla"}),a.jsxs("div",{className:"text-sm font-semibold",children:["SJ: ",Se.totalSanJorge.toFixed(2),a.jsx("br",{}),"Isla: ",Se.totalIsla.toFixed(2)]})]})]})}),a.jsxs("div",{className:"sticky bottom-0 bg-white pt-3 mt-4 border-t",children:[a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:M,className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Limpiar orden"}),a.jsx("button",{type:"button",onClick:()=>{M(),p(!1)},className:"px-3 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Cerrar"}),a.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",disabled:F.length===0,children:"Guardar orden"})]}),a.jsx("div",{className:"md:hidden mt-2",children:a.jsx("button",{type:"button",className:"w-full px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 text-sm",onClick:()=>{T(Q==="DATOS"&&!g?"AGREGAR":Q==="DATOS"||Q==="AGREGAR"?"ITEMS":Q==="ITEMS"?"TOTALES":"DATOS")},children:"Siguiente"})})]})]})]})}),a.jsxs("div",{className:"mt-4",children:[a.jsx("div",{className:"md:hidden space-y-3",children:s?a.jsx("div",{className:"p-4 border rounded bg-white text-center",children:"Cargando"}):A.length===0?a.jsx("div",{className:"p-4 border rounded bg-white text-center",children:"Sin ordenes maestras."}):A.map(Y=>{var tt;const we=f[Y.id],Pe=Y.date||((tt=Y.createdAt)!=null&&tt.toDate?Y.createdAt.toDate().toISOString().slice(0,10):""),Qe=Y.totalPackages>0?(Y.subtotal/Y.totalPackages).toFixed(2):"0.00";return a.jsxs("div",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-xs text-gray-500",children:Pe}),a.jsx("div",{className:"font-semibold text-base leading-tight",children:Y.name})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-xs",onClick:()=>te(Y),children:"Ver"}),a.jsx("button",{className:"px-3 py-2 rounded bg-red-600 text-white text-xs",onClick:()=>Ne(Y),children:"Borrar"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[a.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),a.jsx("div",{className:"font-semibold",children:Y.totalPackages})]}),a.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Restantes"}),a.jsx("div",{className:"font-semibold",children:we?we.remainingPackages:0})]}),a.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"P. Proveedor"}),a.jsx("div",{className:"font-semibold",children:Qe})]}),a.jsxs("div",{className:"p-2 rounded bg-gray-50 border",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Subtotal"}),a.jsx("div",{className:"font-semibold",children:Y.subtotal.toFixed(2)})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2 text-xs",children:[a.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[a.jsx("div",{className:"text-gray-600",children:"Total Rivas"}),a.jsx("div",{className:"font-semibold",children:Y.totalRivas.toFixed(2)})]}),a.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[a.jsx("div",{className:"text-gray-600",children:"Total SJ"}),a.jsx("div",{className:"font-semibold",children:Y.totalSanJorge.toFixed(2)})]}),a.jsxs("div",{className:"p-2 rounded bg-blue-50 border",children:[a.jsx("div",{className:"text-gray-600",children:"Total Isla"}),a.jsx("div",{className:"font-semibold",children:Y.totalIsla.toFixed(2)})]})]})]},Y.id)})}),a.jsx("div",{className:"hidden md:block bg-white p-2 rounded shadow border w-full overflow-x-auto",children:a.jsxs("table",{className:"min-w-[900px] text-xs md:text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{className:"whitespace-nowrap",children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Nombre"}),a.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),a.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),a.jsx("th",{className:"p-2 border",children:"Precio Proveedor"}),a.jsx("th",{className:"p-2 border",children:"Subtotal"}),a.jsx("th",{className:"p-2 border",children:"Total Rivas"}),a.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),a.jsx("th",{className:"p-2 border",children:"Total Isla"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:s?a.jsx("tr",{children:a.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):A.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin ordenes maestras."})}):A.map(Y=>{var Pe;const we=f[Y.id];return a.jsxs("tr",{className:"text-center whitespace-nowrap",children:[a.jsx("td",{className:"p-2 border",children:Y.date||((Pe=Y.createdAt)!=null&&Pe.toDate?Y.createdAt.toDate().toISOString().slice(0,10):"")}),a.jsx("td",{className:"p-2 border",children:Y.name}),a.jsx("td",{className:"p-2 border",children:Y.totalPackages}),a.jsx("td",{className:"p-2 border",children:we?we.remainingPackages:0}),a.jsx("td",{className:"p-2 border",children:Y.totalPackages>0?(Y.subtotal/Y.totalPackages).toFixed(2):"0.00"}),a.jsx("td",{className:"p-2 border",children:Y.subtotal.toFixed(2)}),a.jsx("td",{className:"p-2 border",children:Y.totalRivas.toFixed(2)}),a.jsx("td",{className:"p-2 border",children:Y.totalSanJorge.toFixed(2)}),a.jsx("td",{className:"p-2 border",children:Y.totalIsla.toFixed(2)}),a.jsx("td",{className:"p-2 border",children:a.jsxs("div",{className:"flex gap-1 justify-center",children:[a.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>te(Y),children:"Ver / Editar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>Ne(Y),children:"Borrar"})]})})]},Y.id)})})]})})]}),r&&a.jsx("p",{className:"mt-2 text-sm",children:r})]})}const hA=t=>`C$ ${(Number(t)||0).toFixed(2)}`;function vC(t){const e=Number(t.packages||0),r=Number(t.providerPrice||0),n=Number(t.unitsPerPackage||0),s=r*e,i=e>0&&n>0?e*n:1,o=Number(t.marginRivas||0),l=Number(t.marginSanJorge||0),c=Number(t.marginIsla||0),d=s*(1+o/100),A=s*(1+l/100),u=s*(1+c/100),f=d-s,h=A-s,m=u-s,p=d/i,g=A/i,x=u/i;return{...t,subtotal:Number(s.toFixed(2)),totalRivas:Number(d.toFixed(2)),totalSanJorge:Number(A.toFixed(2)),totalIsla:Number(u.toFixed(2)),gainRivas:Number(f.toFixed(2)),gainSanJorge:Number(h.toFixed(2)),gainIsla:Number(m.toFixed(2)),unitPriceRivas:Number(p.toFixed(2)),unitPriceSanJorge:Number(g.toFixed(2)),unitPriceIsla:Number(x.toFixed(2))}}function B3(t){return t.reduce((e,r)=>(e.totalPackages+=Number(r.packages||0),e.subtotal+=Number(r.subtotal||0),e.totalRivas+=Number(r.totalRivas||0),e.totalSanJorge+=Number(r.totalSanJorge||0),e.totalIsla+=Number(r.totalIsla||0),e),{totalPackages:0,subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0})}function Gi(t,e=0){const r=Number(t);return Number.isFinite(r)?r:e}function yC(t){const{margin:e,gain:r,subtotal:n,orderMargin:s}=t;if(e!=null&&Number.isFinite(Number(e)))return Number(e);const i=Number(n||0),o=Number(r);return Number.isFinite(o)&&i>0?o/i*100:Number(s||0)}function B1e(){var T,R,K;const[t,e]=N.useState([]),[r,n]=N.useState({}),[s,i]=N.useState(!0),[o,l]=N.useState(""),[c,d]=N.useState(or(jc(new Date),"yyyy-MM-dd")),[A,u]=N.useState(or(Ic(new Date),"yyyy-MM-dd")),[f,h]=N.useState(!1),[m,p]=N.useState(!1),[g,x]=N.useState(null),[b,w]=N.useState([]),[k,O]=N.useState(0),[L,E]=N.useState(0),[B,S]=N.useState(0),[U,_]=N.useState(""),[F,D]=N.useState(""),[X,ge]=N.useState(0),[ae,fe]=N.useState(0),[me,Z]=N.useState(1);N.useEffect(()=>{(async()=>{try{i(!0),l("");const M=Dt(ht(Te,"candy_main_orders"),Ur("createdAt","desc")),re=await Nt(M),de=[];re.forEach(Se=>{const ee=Se.data();de.push({id:Se.id,name:ee.name??"",date:ee.date??"",totalPackages:Number(ee.totalPackages??0),subtotal:Number(ee.subtotal??0),totalRivas:Number(ee.totalRivas??0),totalSanJorge:Number(ee.totalSanJorge??0),totalIsla:Number(ee.totalIsla??0),marginRivas:Number(ee.marginRivas??0),marginSanJorge:Number(ee.marginSanJorge??0),marginIsla:Number(ee.marginIsla??0),createdAt:ee.createdAt??$t.now()})}),e(de);const le=await Nt(Dt(ht(Te,"inventory_candies"))),q={};le.forEach(Se=>{const ee=Se.data(),z=ee.orderId;if(!z)return;const te=Number(ee.unitsPerPackage||1)||1,Ne=Number(ee.totalUnits??(ee.packages||0)*te),Y=Math.round(Ne/te),we=Number(ee.remaining??ee.totalUnits??Ne),Pe=Number(ee.remainingPackages??NaN),Qe=Number.isFinite(Pe)?Math.round(Pe):Math.round(we/te);q[z]||(q[z]={orderId:z,totalPackages:0,remainingPackages:0}),q[z].totalPackages+=Y,q[z].remainingPackages+=Qe}),n(q)}catch(M){console.error(M),l(" Error cargando inventario de pedidos.")}finally{i(!1)}})()},[]);const ye=N.useMemo(()=>t.filter(M=>{var de;const re=M.date||((de=M.createdAt)!=null&&de.toDate?M.createdAt.toDate().toISOString().slice(0,10):"");return!(!re||c&&re<c||A&&re>A)}),[t,c,A]),Ie=N.useMemo(()=>{let M=0,re=0,de=0,le=0,q=0,Se=0;for(const ee of ye){M+=ee.totalPackages,re+=ee.subtotal,de+=ee.totalRivas,le+=ee.totalSanJorge,q+=ee.totalIsla;const z=r[ee.id];z&&(Se+=z.remainingPackages)}return{totalPaquetes:M,totalSubtotal:re,totalRivas:de,totalSJ:le,totalIsla:q,totalPaquetesRestantes:Se,totalPedidos:ye.length}},[ye,r]),I=async(M,re,de)=>{if(!g)return;const le=Number(de||0),q=b.map(z=>z.id!==M?z:vC({...z,[re]:le}));w(q);const Se=q.find(z=>z.id===M);if(!Se)return;const ee=B3(q);try{await Pr(kt(Te,"products_candies",M),{marginRivas:Se.marginRivas,marginSanJorge:Se.marginSanJorge,marginIsla:Se.marginIsla,subtotal:Se.subtotal,totalRivas:Se.totalRivas,totalSanJorge:Se.totalSanJorge,totalIsla:Se.totalIsla,unitPriceRivas:Se.unitPriceRivas,unitPriceSanJorge:Se.unitPriceSanJorge,unitPriceIsla:Se.unitPriceIsla,gainRivas:Se.gainRivas,gainSanJorge:Se.gainSanJorge,gainIsla:Se.gainIsla}),await Pr(kt(Te,"candy_main_orders",g.id),{totalPackages:ee.totalPackages,subtotal:Number(ee.subtotal.toFixed(2)),totalRivas:Number(ee.totalRivas.toFixed(2)),totalSanJorge:Number(ee.totalSanJorge.toFixed(2)),totalIsla:Number(ee.totalIsla.toFixed(2))}),x(z=>z&&{...z,totalPackages:ee.totalPackages,subtotal:Number(ee.subtotal.toFixed(2)),totalRivas:Number(ee.totalRivas.toFixed(2)),totalSanJorge:Number(ee.totalSanJorge.toFixed(2)),totalIsla:Number(ee.totalIsla.toFixed(2))}),l(" Mrgenes del producto actualizados.")}catch(z){console.error(z),l(" Error actualizando mrgenes del producto.")}},j=async()=>{if(g)try{l("");const M=Number.isFinite(k)&&k!==0?k:g.marginRivas||0,re=Number.isFinite(L)&&L!==0?L:g.marginSanJorge||0,de=Number.isFinite(B)&&B!==0?B:g.marginIsla||0,le=vC({id:"tmp",name:U.trim(),category:F.trim(),providerPrice:Number(X||0),packages:Number(ae||0),unitsPerPackage:Number(me||1),marginRivas:Number(M||0),marginSanJorge:Number(re||0),marginIsla:Number(de||0),subtotal:0,totalRivas:0,totalSanJorge:0,totalIsla:0,gainRivas:0,gainSanJorge:0,gainIsla:0,unitPriceRivas:0,unitPriceSanJorge:0,unitPriceIsla:0,remainingPackages:Number(ae||0)}),q=await Jr(ht(Te,"products_candies"),{orderId:g.id,inventoryDate:g.date||"",name:le.name,category:le.category,providerPrice:le.providerPrice,packages:le.packages,unitsPerPackage:le.unitsPerPackage,marginRivas:le.marginRivas,marginSanJorge:le.marginSanJorge,marginIsla:le.marginIsla,gainRivas:le.gainRivas,gainSanJorge:le.gainSanJorge,gainIsla:le.gainIsla,subtotal:le.subtotal,totalRivas:le.totalRivas,totalSanJorge:le.totalSanJorge,totalIsla:le.totalIsla,unitPriceRivas:le.unitPriceRivas,unitPriceSanJorge:le.unitPriceSanJorge,unitPriceIsla:le.unitPriceIsla,createdAt:$t.now()}),ee=[{...le,id:q.id},...b];w(ee);const z=B3(ee);await Pr(kt(Te,"candy_main_orders",g.id),{totalPackages:z.totalPackages,subtotal:Number(z.subtotal.toFixed(2)),totalRivas:Number(z.totalRivas.toFixed(2)),totalSanJorge:Number(z.totalSanJorge.toFixed(2)),totalIsla:Number(z.totalIsla.toFixed(2))}),x(te=>te&&{...te,totalPackages:z.totalPackages,subtotal:Number(z.subtotal.toFixed(2)),totalRivas:Number(z.totalRivas.toFixed(2)),totalSanJorge:Number(z.totalSanJorge.toFixed(2)),totalIsla:Number(z.totalIsla.toFixed(2))}),O(0),E(0),S(0),_(""),D(""),ge(0),fe(0),Z(1),l(" Producto agregado con mrgenes por sucursal.")}catch(M){console.error(M),l(" Error agregando producto al pedido.")}},Q=async M=>{try{x(M),w([]),h(!0),p(!0),l("");const re=await Nt(Dt(ht(Te,"inventory_candies"),Gt("orderId","==",M.id))),de={};re.forEach(Se=>{const ee=Se.data(),z=ee.productId;if(!z)return;const te=Number(ee.unitsPerPackage||1)||1,Ne=Number(ee.remaining??ee.totalUnits??0),Y=Number(ee.remainingPackages??NaN),we=Number.isFinite(Y)?Math.round(Y):Math.round(Ne/te);de[z]=(de[z]||0)+we});const le=await Nt(Dt(ht(Te,"products_candies"),Gt("orderId","==",M.id))),q=[];le.forEach(Se=>{const ee=Se.data(),z=Gi(ee.providerPrice,0),te=Gi(ee.packages,0),Ne=ee.subtotal??z*te,Y=yC({margin:ee.marginRivas,gain:ee.gainRivas,subtotal:Ne,orderMargin:M.marginRivas||0}),we=yC({margin:ee.marginSanJorge,gain:ee.gainSanJorge,subtotal:Ne,orderMargin:M.marginSanJorge||0}),Pe=yC({margin:ee.marginIsla,gain:ee.gainIsla,subtotal:Ne,orderMargin:M.marginIsla||0}),Qe=vC({id:Se.id,name:ee.name??"",category:ee.category??"",providerPrice:z,packages:te,unitsPerPackage:Gi(ee.unitsPerPackage,1),marginRivas:Number(Y||0),marginSanJorge:Number(we||0),marginIsla:Number(Pe||0),subtotal:Gi(ee.subtotal,0),totalRivas:Gi(ee.totalRivas,0),totalSanJorge:Gi(ee.totalSanJorge,0),totalIsla:Gi(ee.totalIsla,0),gainRivas:Gi(ee.gainRivas,0),gainSanJorge:Gi(ee.gainSanJorge,0),gainIsla:Gi(ee.gainIsla,0),unitPriceRivas:Gi(ee.unitPriceRivas,0),unitPriceSanJorge:Gi(ee.unitPriceSanJorge,0),unitPriceIsla:Gi(ee.unitPriceIsla,0),remainingPackages:de[Se.id]??Gi(ee.packages,0)});q.push(Qe)}),w(q)}catch(re){console.error(re),l(" Error cargando productos del pedido.")}finally{p(!1)}};return a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("h2",{className:"text-2xl font-bold",children:"Inventario Ordenes Maestras"})}),a.jsxs("div",{className:"bg-white p-3 rounded shadow border mb-4 flex flex-wrap items-end gap-3 text-sm",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:c,onChange:M=>d(M.target.value)})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"font-semibold",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:A,onChange:M=>u(M.target.value)})]}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{d(""),u("")},children:"Quitar filtro"}),a.jsxs("div",{className:"ml-auto text-xs md:text-sm text-gray-600",children:["Cantidad de pedidos:"," ",a.jsx("span",{className:"font-semibold",children:Ie.totalPedidos})]})]}),a.jsx("div",{className:"bg-gray-50 p-3 rounded shadow border mb-3 text-sm md:text-base",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-y-2 gap-x-8",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Paquetes totales:"})," ",Ie.totalPaquetes]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Paquetes restantes:"})," ",Ie.totalPaquetesRestantes]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Subtotal total:"})," ",hA(Ie.totalSubtotal)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total Rivas (todo):"})," ",hA(Ie.totalRivas)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total San Jorge (todo):"})," ",hA(Ie.totalSJ)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total Isla (todo):"})," ",hA(Ie.totalIsla)]})]})}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full overflow-x-auto mt-2",children:a.jsxs("table",{className:"min-w-[900px] text-xs md:text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{className:"whitespace-nowrap",children:[a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Nombre"}),a.jsx("th",{className:"p-2 border",children:"Paquetes totales"}),a.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),a.jsx("th",{className:"p-2 border",children:"Subtotal"}),a.jsx("th",{className:"p-2 border",children:"Total Rivas"}),a.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),a.jsx("th",{className:"p-2 border",children:"Total Isla"}),a.jsx("th",{className:"p-2 border",children:"P. prom. Rivas"}),a.jsx("th",{className:"p-2 border",children:"P. prom. San Jorge"}),a.jsx("th",{className:"p-2 border",children:"P. prom. Isla"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:s?a.jsx("tr",{children:a.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):ye.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin pedidos generales en este rango."})}):ye.map(M=>{var ee;const re=M.totalPackages>0?Math.round(M.totalRivas/M.totalPackages):0,de=M.totalPackages>0?Math.round(M.totalSanJorge/M.totalPackages):0,le=M.totalPackages>0?Math.round(M.totalIsla/M.totalPackages):0,q=M.date||((ee=M.createdAt)!=null&&ee.toDate?M.createdAt.toDate().toISOString().slice(0,10):""),Se=r[M.id];return a.jsxs("tr",{className:"text-center whitespace-nowrap",children:[a.jsx("td",{className:"p-2 border",children:q}),a.jsx("td",{className:"p-2 border",children:M.name}),a.jsx("td",{className:"p-2 border",children:M.totalPackages}),a.jsx("td",{className:"p-2 border",children:Se?Se.remainingPackages:0}),a.jsx("td",{className:"p-2 border",children:M.subtotal.toFixed(2)}),a.jsx("td",{className:"p-2 border",children:M.totalRivas.toFixed(2)}),a.jsx("td",{className:"p-2 border",children:M.totalSanJorge.toFixed(2)}),a.jsx("td",{className:"p-2 border",children:M.totalIsla.toFixed(2)}),a.jsx("td",{className:"p-2 border",children:re}),a.jsx("td",{className:"p-2 border",children:de}),a.jsx("td",{className:"p-2 border",children:le}),a.jsx("td",{className:"p-2 border",children:a.jsx("button",{className:"px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 text-xs",onClick:()=>Q(M),children:"Ver pedido"})})]},M.id)})})]})}),f&&g&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto text-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsxs("h3",{className:"text-xl font-bold",children:["Detalle: ",g.name]}),a.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:()=>{h(!1),x(null),w([]),l("")},children:"Cerrar"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4 text-xs md:text-sm",children:[a.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-gray-600",children:"Fecha del pedido"}),a.jsx("div",{className:"font-semibold",children:g.date||((T=g.createdAt)!=null&&T.toDate?g.createdAt.toDate().toISOString().slice(0,10):"")})]}),a.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-gray-600",children:"Paquetes totales"}),a.jsx("div",{className:"font-semibold",children:((R=r[g.id])==null?void 0:R.totalPackages)??g.totalPackages})]}),a.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-gray-600",children:"Paquetes restantes"}),a.jsx("div",{className:"font-semibold",children:((K=r[g.id])==null?void 0:K.remainingPackages)??0})]}),a.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-gray-600",children:"Subtotal (proveedor)"}),a.jsx("div",{className:"font-semibold",children:hA(g.subtotal)})]}),a.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-gray-600",children:"Total Rivas"}),a.jsx("div",{className:"font-semibold",children:hA(g.totalRivas)})]}),a.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-gray-600",children:"Total San Jorge"}),a.jsx("div",{className:"font-semibold",children:hA(g.totalSanJorge)})]}),a.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[a.jsx("div",{className:"text-gray-600",children:"Total Isla"}),a.jsx("div",{className:"font-semibold",children:hA(g.totalIsla)})]})]}),a.jsxs("div",{className:"bg-white border rounded p-3 mb-4",children:[a.jsx("div",{className:"font-semibold mb-2",children:"Agregar producto"}),a.jsxs("div",{className:"flex flex-wrap gap-2 items-end text-xs",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-600",children:"Margen Rivas"}),a.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:k,onChange:M=>O(Number(M.target.value||0))})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-600",children:"Margen SJ"}),a.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:L,onChange:M=>E(Number(M.target.value||0))})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-600",children:"Margen Isla"}),a.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-28 text-right",value:B,onChange:M=>S(Number(M.target.value||0))})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-600",children:"Producto"}),a.jsx("input",{className:"border rounded px-2 py-1 w-56",value:U,onChange:M=>_(M.target.value)})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-600",children:"Categora"}),a.jsx("input",{className:"border rounded px-2 py-1 w-40",value:F,onChange:M=>D(M.target.value)})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-600",children:"P. proveedor (paq)"}),a.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-32 text-right",value:X,onChange:M=>ge(Number(M.target.value||0))})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-600",children:"Paquetes"}),a.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:ae,onChange:M=>fe(Number(M.target.value||0))})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"text-gray-600",children:"Und x Paq"}),a.jsx("input",{type:"number",className:"border rounded px-2 py-1 w-24 text-right",value:me,onChange:M=>Z(Number(M.target.value||1))})]}),a.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700",onClick:j,children:"Agregar producto"})]})]}),a.jsx("h4",{className:"font-semibold mb-2",children:"Productos del pedido"}),a.jsx("div",{className:"bg-white rounded border overflow-x-auto",children:a.jsxs("table",{className:"min-w-[1200px] text-xs md:text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{className:"whitespace-nowrap",children:[a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"Categora"}),a.jsx("th",{className:"p-2 border",children:"Paquetes"}),a.jsx("th",{className:"p-2 border",children:"Paquetes restantes"}),a.jsx("th",{className:"p-2 border",children:"Und x Paq"}),a.jsx("th",{className:"p-2 border",children:"P. proveedor (paq)"}),a.jsx("th",{className:"p-2 border",children:"Margen Rivas (%)"}),a.jsx("th",{className:"p-2 border",children:"Margen San Jorge (%)"}),a.jsx("th",{className:"p-2 border",children:"Margen Isla (%)"}),a.jsx("th",{className:"p-2 border",children:"Subtotal"}),a.jsx("th",{className:"p-2 border",children:"Total Rivas"}),a.jsx("th",{className:"p-2 border",children:"Total San Jorge"}),a.jsx("th",{className:"p-2 border",children:"Total Isla"}),a.jsx("th",{className:"p-2 border",children:"P. unidad Rivas"}),a.jsx("th",{className:"p-2 border",children:"P. unidad San Jorge"}),a.jsx("th",{className:"p-2 border",children:"P. unidad Isla"})]})}),a.jsx("tbody",{children:m?a.jsx("tr",{children:a.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Cargando productos"})}):b.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:16,className:"p-4 text-center",children:"Este pedido no tiene productos registrados."})}):b.map(M=>a.jsxs("tr",{className:"text-center whitespace-nowrap",children:[a.jsx("td",{className:"p-2 border",children:M.name}),a.jsx("td",{className:"p-2 border",children:M.category}),a.jsx("td",{className:"p-2 border",children:M.packages}),a.jsx("td",{className:"p-2 border",children:M.remainingPackages??M.packages}),a.jsx("td",{className:"p-2 border",children:M.unitsPerPackage}),a.jsx("td",{className:"p-2 border",children:M.providerPrice.toFixed(2)}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:M.marginRivas??0,onChange:re=>I(M.id,"marginRivas",re.target.value)})}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:M.marginSanJorge??0,onChange:re=>I(M.id,"marginSanJorge",re.target.value)})}),a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"number",className:"w-20 border rounded px-1 py-0.5 text-right text-xs",value:M.marginIsla??0,onChange:re=>I(M.id,"marginIsla",re.target.value)})}),a.jsx("td",{className:"p-2 border",children:M.subtotal.toFixed(2)}),a.jsx("td",{className:"p-2 border",children:M.totalRivas.toFixed(2)}),a.jsx("td",{className:"p-2 border",children:M.totalSanJorge.toFixed(2)}),a.jsx("td",{className:"p-2 border",children:M.totalIsla.toFixed(2)}),a.jsx("td",{className:"p-2 border",children:M.unitPriceRivas}),a.jsx("td",{className:"p-2 border",children:M.unitPriceSanJorge}),a.jsx("td",{className:"p-2 border",children:M.unitPriceIsla})]},M.id))})]})}),o&&a.jsx("p",{className:"mt-3 text-sm",children:o})]})}),o&&!f&&a.jsx("p",{className:"mt-2 text-sm",children:o})]})}const Mn=t=>Math.round((Number(t)||0)*100)/100,Of=t=>Math.round((Number(t)||0)*1e3)/1e3,Ua=t=>Number(t??0).toFixed(2),Qu=t=>Number(t??0).toFixed(3),S1e=(t,e)=>{var h;const r=t.date??((h=t.timestamp)!=null&&h.toDate?or(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",s=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",i=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0,d=t.processedDate??t.closureDate??"";if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((m,p)=>{const g=Number((m==null?void 0:m.packages)??(m==null?void 0:m.qty)??(m==null?void 0:m.quantity)??0),x=Number((m==null?void 0:m.lineFinal)??0)||Math.max(0,Number((m==null?void 0:m.unitPricePackage)||(m==null?void 0:m.unitPrice)||0)*g-Number((m==null?void 0:m.discount)||0));let b=0;return c>0&&l>0&&Number(x||0)>0&&(b=Mn(c*Number(x||0)/l)),{id:`${e}#${p}`,productName:String((m==null?void 0:m.productName)??"(sin nombre)"),quantity:g,amount:Mn(x),amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:s,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:Array.isArray(m==null?void 0:m.allocations)?m.allocations:t.allocations,avgUnitCost:Number((m==null?void 0:m.avgUnitCost)??t.avgUnitCost??0),cogsAmount:Number((m==null?void 0:m.cogsAmount)??0),type:i,vendorId:o,vendorCommissionAmount:b,processedDate:d||""}});const A=Number(t.packagesTotal??t.quantity??0),u=Number(t.amount??t.amountCharged??t.total??0)||0;let f=0;return f=Mn(Number(t.vendorCommissionAmount??0)||0),[{id:e,productName:t.productName??"(sin nombre)",quantity:A,amount:u,amountSuggested:Number(t.amountSuggested??0),date:r,userEmail:s,sellerEmail:n,clientName:t.clientName??"",amountReceived:Number(t.amountReceived??0),change:String(t.change??"0"),status:t.status??"FLOTANTE",allocations:t.allocations,avgUnitCost:t.avgUnitCost,cogsAmount:t.cogsAmount,type:i,vendorId:o,vendorCommissionAmount:f,processedDate:d||""}]};function I1e({role:t,currentUserEmail:e,sellerCandyId:r}){const[n,s]=N.useState([]),[i,o]=N.useState(null),[l,c]=N.useState(!0),[d,A]=N.useState(""),[u,f]=N.useState("ALL"),h=or(new Date,"yyyy-MM-dd"),[m,p]=N.useState(h),[g,x]=N.useState(h),[b,w]=N.useState("ALL"),[k,O]=N.useState(null),[L,E]=N.useState(0),[B,S]=N.useState(0),[U,_]=N.useState(""),[F,D]=N.useState(0),[X,ge]=N.useState("0"),ae=N.useRef(null),fe=!t||t==="admin",me=t==="vendedor_dulces",Z=(e||"").trim().toLowerCase(),[ye,Ie]=N.useState([]);N.useEffect(()=>{if(!m||!g)return;c(!0);const xe=Dt(ht(Te,"sales_candies"),Gt("date",">=",m),Gt("date","<=",g),Ur("date","asc")),ve=H0(xe,ie=>{const ze=[];ie.forEach(rt=>{const At=S1e(rt.data(),rt.id);ze.push(...At)}),s(ze),c(!1)},ie=>{console.error("Error cargando ventas por periodo:",ie),s([]),c(!1)});return()=>ve()},[m,g]),N.useEffect(()=>{(async()=>{const ve=Dt(ht(Te,"daily_closures_candies"),Gt("date","==",h)),ie=await Nt(ve);if(ie.empty)o(null);else{const ze=ie.docs[0];o({id:ze.id,...ze.data()})}})()},[h]),N.useEffect(()=>{(async()=>{try{const ve=await Nt(ht(Te,"sellers_candies")),ie=[];ve.forEach(ze=>{const rt=ze.data();ie.push({id:ze.id,name:rt.name||"",commissionPercent:Number(rt.commissionPercent||0)})}),Ie(ie)}catch(ve){console.error("Error cargando sellers_candies",ve)}})()},[]);const I=xe=>Mn(Number(xe.vendorCommissionAmount??0)||0),j=ui.useMemo(()=>{let xe=[...n];return u==="FLOTANTE"&&(xe=xe.filter(ve=>ve.status==="FLOTANTE")),u==="PROCESADA"&&(xe=xe.filter(ve=>ve.status==="PROCESADA")),fe&&b!=="ALL"&&(xe=xe.filter(ve=>(ve.vendorId||"")===b)),me&&(r?xe=xe.filter(ve=>(ve.vendorId||"")===r):Z?xe=xe.filter(ve=>(ve.sellerEmail||"").toLowerCase()===Z):xe=[]),xe},[u,n,fe,b,me,r,Z]),Q=ui.useMemo(()=>j.filter(xe=>xe.status==="FLOTANTE").length,[j]),T=ui.useMemo(()=>j.filter(xe=>xe.status==="PROCESADA").length,[j]),R=ui.useMemo(()=>j.filter(xe=>xe.type==="CREDITO").length,[j]),K=ui.useMemo(()=>j.filter(xe=>xe.type!=="CREDITO").length,[j]),M=Of(j.reduce((xe,ve)=>xe+(ve.quantity||0),0)),re=Mn(j.reduce((xe,ve)=>xe+Number(ve.cogsAmount??0),0)),de=Mn(j.reduce((xe,ve)=>xe+(ve.amount||0),0)),le=Mn(de-re);let q=0,Se=0,ee=0,z=0,te=0,Ne=0,Y=0;j.forEach(xe=>{const ve=Number(xe.amount||0),ie=Number(xe.amountReceived||0),ze=I(xe);te+=ze,xe.type==="CREDITO"?(q+=xe.quantity||0,ee+=ve-ie,Y+=ze):(Se+=xe.quantity||0,z+=ve,Ne+=ze)}),ee=Mn(ee),z=Mn(z),te=Mn(te),Ne=Mn(Ne),Y=Mn(Y);const we=ui.useMemo(()=>{const xe={};for(const ve of j){const ie=(ve.vendorId||"").trim();if(!ie||ve.type==="CREDITO")continue;const ze=I(ve);if(!xe[ie]){const rt=ye.find(At=>At.id===ie);xe[ie]={vendorId:ie,name:(rt==null?void 0:rt.name)||ve.userEmail||"(sin vendedor)",total:0}}xe[ie].total=Mn(xe[ie].total+ze)}return Object.values(xe).filter(ve=>ve.total>0).sort((ve,ie)=>ie.total-ve.total)},[j,ye]),Pe=ui.useMemo(()=>{const xe={};for(const ve of j){const ie=(ve.vendorId||"").trim();if(!ie||ve.type!=="CREDITO")continue;const ze=I(ve);if(!xe[ie]){const rt=ye.find(At=>At.id===ie);xe[ie]={vendorId:ie,name:(rt==null?void 0:rt.name)||ve.userEmail||"(sin vendedor)",total:0}}xe[ie].total=Mn(xe[ie].total+ze)}return Object.values(xe).filter(ve=>ve.total>0).sort((ve,ie)=>ie.total-ve.total)},[j,ye]),Qe={};j.forEach(xe=>{const ve=xe.productName||"(sin nombre)";Qe[ve]||(Qe[ve]={totalQuantity:0,totalAmount:0,totalCommission:0}),Qe[ve].totalQuantity=Of(Qe[ve].totalQuantity+(xe.quantity||0)),Qe[ve].totalAmount=Mn(Qe[ve].totalAmount+(xe.amount||0)),Qe[ve].totalCommission=Mn(Qe[ve].totalCommission+I(xe))});const tt=Object.entries(Qe).map(([xe,ve])=>({productName:xe,totalQuantity:ve.totalQuantity,totalAmount:ve.totalAmount,totalCommission:ve.totalCommission})),ot=async()=>{if(fe)try{const xe=j.filter(Ve=>Ve.status==="FLOTANTE");if(xe.length===0){A("No hay ventas flotantes para procesar en este perodo.");return}const ve={totalCharged:Mn(xe.reduce((Ve,G)=>Ve+(G.amount||0),0)),totalSuggested:Mn(xe.reduce((Ve,G)=>Ve+(G.amountSuggested||0),0)),totalUnits:Of(xe.reduce((Ve,G)=>Ve+(G.quantity||0),0)),totalCOGS:Mn(xe.reduce((Ve,G)=>Ve+Number(G.cogsAmount??0),0))},ie=Mn(ve.totalCharged-ve.totalSuggested),ze=Mn(ve.totalCharged-ve.totalCOGS),rt=xe.reduce((Ve,G)=>{const _e=Number(G.quantity||0),Me=Number(G.amount||0),We=Number(G.vendorCommissionAmount||0);return G.type==="CREDITO"?(Ve.packsCredit+=_e,Ve.amountCredit+=Me,Ve.comCredit+=We):(Ve.packsCash+=_e,Ve.amountCash+=Me,Ve.comCash+=We),Ve},{packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0}),At={totalPacksCash:Of(rt.packsCash),totalPacksCredit:Of(rt.packsCredit),totalAmountCash:Mn(rt.amountCash),totalAmountCredit:Mn(rt.amountCredit),totalCommissionCash:Mn(rt.comCash),totalCommissionCredit:Mn(rt.comCredit)},Oe=await Jr(ht(Te,"daily_closures_candies"),{date:h,createdAt:$t.now(),periodStart:m,periodEnd:g,totalCharged:ve.totalCharged,totalSuggested:ve.totalSuggested,totalDifference:ie,totalUnits:ve.totalUnits,totalCOGS:ve.totalCOGS,grossProfit:ze,...At,products:xe.map(Ve=>({productName:Ve.productName,quantity:Ve.quantity,amount:Ve.amount})),sales:xe.map(Ve=>({id:Ve.id,productName:Ve.productName,quantity:Ve.quantity,amount:Ve.amount,amountSuggested:Ve.amountSuggested,userEmail:Ve.userEmail,clientName:Ve.clientName,amountReceived:Ve.amountReceived,change:Ve.change,status:Ve.status,cogsAmount:Ve.cogsAmount??0,avgUnitCost:Ve.avgUnitCost??null,allocations:Ve.allocations??[],date:Ve.date,type:Ve.type??"CONTADO",vendorId:Ve.vendorId??"",vendorCommissionAmount:Number(Ve.vendorCommissionAmount??0)||0,processedDate:h})),productSummary:Object.entries(xe.reduce((Ve,G)=>{const _e=G.productName||"(sin nombre)";return Ve[_e]||(Ve[_e]={totalQuantity:0,totalAmount:0}),Ve[_e].totalQuantity=Of(Ve[_e].totalQuantity+(G.quantity||0)),Ve[_e].totalAmount=Mn(Ve[_e].totalAmount+(G.amount||0)),Ve},{})).map(([Ve,G])=>({productName:Ve,totalQuantity:G.totalQuantity,totalAmount:G.totalAmount}))}),at=Xh(Te);xe.forEach(Ve=>{at.update(kt(Te,"sales_candies",Ve.id.split("#")[0]),{status:"PROCESADA",closureId:Oe.id,closureDate:h,processedDate:h,processedAt:$t.now()})}),await at.commit(),A(` Cierre guardado. Ventas procesadas: ${xe.length}. (Proceso: ${h})`)}catch(xe){console.error(xe),A(" Error al guardar el cierre de dulces.")}},dt=async xe=>{if(fe&&window.confirm("Revertir esta venta? Esta accin no se puede deshacer."))try{await Pr(kt(Te,"sales_candies",xe.split("#")[0]),{status:"FLOTANTE",closureId:null,closureDate:null,processedDate:null,processedAt:null}),A(" Venta revertida a FLOTANTE.")}catch(ve){console.error(ve),A(" No se pudo revertir la venta.")}},vt=xe=>{fe&&(O(xe),E(xe.quantity),S(xe.amount),_(xe.clientName),D(xe.amountReceived),ge(xe.change))},lt=async()=>{if(!(!k||!fe))try{await Pr(kt(Te,"sales_candies",k.id.split("#")[0]),{packagesTotal:L,amount:B,amountCharged:B,clientName:U,amountReceived:F,change:X}),O(null),A(" Venta de dulces actualizada.")}catch(xe){console.error(xe),A(" No se pudo actualizar la venta de dulces.")}},Ue=async xe=>{if(fe&&window.confirm("Eliminar esta venta? Se restaurar el stock (paquetes) en los lotes asignados."))try{const{restored:ve}=await Xve(xe.split("#")[0]);A(` Venta eliminada. Stock restaurado (unidades internas): ${Number(ve).toFixed(2)}.`)}catch(ve){console.error(ve),A(" No se pudo eliminar la venta de dulces.")}},Xe=async()=>{if(ae.current){ae.current.classList.add("force-pdf-colors"),ae.current.classList.add("pdf-print-mode");try{const ve=(await Yh(ae.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),ie=new cr;ie.addImage(ve,"PNG",10,10,190,0),ie.save(`cierre_dulces_${m}_a_${g}_proc_${h}.pdf`)}finally{ae.current.classList.remove("pdf-print-mode"),ae.current.classList.remove("force-pdf-colors")}}};return a.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[a.jsx("style",{children:`
        .pdf-print-mode .pdf-desktop { display: block !important; }
        .pdf-print-mode .pdf-mobile  { display: none !important; }
      `}),a.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Cierre de Ventas de Dulces - Proceso: ",h]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-3 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm",children:"Desde:"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:m,onChange:xe=>p(xe.target.value)})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm",children:"Hasta:"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:g,onChange:xe=>x(xe.target.value)})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm",children:"Filtrar:"}),a.jsxs("select",{className:"border rounded px-2 py-1",value:u,onChange:xe=>f(xe.target.value),children:[a.jsx("option",{value:"ALL",children:"Todas"}),a.jsx("option",{value:"FLOTANTE",children:"Venta Flotante"}),a.jsx("option",{value:"PROCESADA",children:"Venta Procesada"})]})]}),fe&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm",children:"Vendedor:"}),a.jsxs("select",{className:"border rounded px-2 py-1",value:b,onChange:xe=>w(xe.target.value),children:[a.jsx("option",{value:"ALL",children:"Todos"}),ye.map(xe=>a.jsx("option",{value:xe.id,children:xe.name||xe.id},xe.id))]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-3 mb-4",children:[a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ventas flotantes"}),a.jsx("div",{className:"text-2xl font-bold",children:Q}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",g]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ventas procesadas"}),a.jsx("div",{className:"text-2xl font-bold",children:T}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",g]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),a.jsx("div",{className:"text-2xl font-bold",children:R}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",g]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),a.jsx("div",{className:"text-2xl font-bold",children:K}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",g]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash (perodo)"}),a.jsxs("div",{className:"text-2xl font-bold",children:["C$",Ua(Ne)]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",g]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito (perodo)"}),a.jsxs("div",{className:"text-2xl font-bold",children:["C$",Ua(Y)]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Perodo: ",m,"  ",g]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CASH del perodo)"}),we.length===0?a.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):a.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:we.map(xe=>a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"truncate",children:xe.name}),a.jsxs("strong",{className:"ml-2",children:["C$",Ua(xe.total)]})]},xe.vendorId))})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin CRDITO del perodo)"}),Pe.length===0?a.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):a.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:Pe.map(xe=>a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"truncate",children:xe.name}),a.jsxs("strong",{className:"ml-2",children:["C$",Ua(xe.total)]})]},xe.vendorId))})]})]}),l?a.jsx("p",{children:"Cargando ventas..."}):a.jsxs("div",{ref:ae,children:[a.jsx("div",{className:"pdf-desktop hidden md:block",children:a.jsxs("table",{className:"min-w-full border text-sm mb-4 shadow-2xl",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Estado"}),a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Tipo"}),a.jsx("th",{className:"border p-2",children:"Paquetes"}),a.jsx("th",{className:"border p-2",children:"Monto"}),a.jsx("th",{className:"border p-2",children:"Comisin"}),a.jsx("th",{className:"border p-2",children:"Fecha venta"}),a.jsx("th",{className:"border p-2",children:"Fecha proceso"}),a.jsx("th",{className:"border p-2",children:"Vendedor"}),a.jsx("th",{className:"border p-2",children:"Acciones"})]})}),a.jsxs("tbody",{children:[j.map(xe=>{const ve=I(xe),ie=(xe.processedDate||"").trim();return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${xe.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:xe.status})}),a.jsx("td",{className:"border p-1",children:xe.productName}),a.jsx("td",{className:"border p-1",children:xe.type==="CREDITO"?"Crdito":"Cash"}),a.jsx("td",{className:"border p-1",children:Qu(xe.quantity)}),a.jsxs("td",{className:"border p-1",children:["C$",Ua(xe.amount)]}),a.jsx("td",{className:"border p-1",children:ve>0?`C$${Ua(ve)}`:""}),a.jsx("td",{className:"border p-1",children:xe.date}),a.jsx("td",{className:"border p-1",children:ie||""}),a.jsx("td",{className:"border p-1",children:xe.userEmail}),a.jsx("td",{className:"border p-1",children:xe.status==="FLOTANTE"?a.jsx("div",{className:"flex gap-2 justify-center",children:fe?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>vt(xe),className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",children:"Editar"}),a.jsx("button",{onClick:()=>Ue(xe.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Eliminar"})]}):a.jsx("span",{className:"text-gray-400 text-xs",children:""})}):xe.status==="PROCESADA"?a.jsx("div",{className:"flex gap-2 justify-center",children:fe?a.jsx("button",{onClick:()=>dt(xe.id),className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",children:"Revertir"}):a.jsx("span",{className:"text-gray-400 text-xs",children:""})}):a.jsx("span",{className:"text-gray-400 text-xs",children:"No options"})})]},xe.id)}),j.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:10,className:"p-3 text-center text-gray-500",children:"Sin ventas para mostrar."})})]})]})}),a.jsxs("div",{className:"pdf-mobile md:hidden space-y-3 mb-4",children:[j.map(xe=>{const ve=I(xe),ie=(xe.processedDate||"").trim();return a.jsxs("details",{className:"border rounded-xl bg-white shadow-sm",children:[a.jsxs("summary",{className:"px-4 py-3 flex justify-between items-center cursor-pointer",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-semibold truncate",children:xe.productName}),a.jsxs("div",{className:"text-xs text-gray-500",children:[xe.type==="CREDITO"?"Crdito":"Cash","  ",xe.date]})]}),a.jsxs("div",{className:"text-right shrink-0 ml-3",children:[a.jsxs("div",{className:"font-bold",children:["C$",Ua(xe.amount)]}),a.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${xe.status==="PROCESADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:xe.status})]})]}),a.jsxs("div",{className:"px-4 pb-4 pt-2 text-sm space-y-2",children:[a.jsxs("div",{className:"flex justify-between gap-3",children:[a.jsx("span",{className:"text-gray-600",children:"Paquetes"}),a.jsx("strong",{children:Qu(xe.quantity)})]}),a.jsxs("div",{className:"flex justify-between gap-3",children:[a.jsx("span",{className:"text-gray-600",children:"Comisin"}),a.jsx("strong",{children:ve>0?`C$${Ua(ve)}`:""})]}),a.jsxs("div",{className:"flex justify-between gap-3",children:[a.jsx("span",{className:"text-gray-600",children:"Fecha proceso"}),a.jsx("strong",{children:ie||""})]}),a.jsxs("div",{className:"flex justify-between gap-3",children:[a.jsx("span",{className:"text-gray-600",children:"Vendedor"}),a.jsx("strong",{className:"text-right break-all",children:xe.userEmail})]}),a.jsx("div",{className:"pt-2",children:xe.status==="FLOTANTE"?a.jsx("div",{className:"flex gap-2",children:fe?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>vt(xe),className:"flex-1 text-xs bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700",children:"Editar"}),a.jsx("button",{onClick:()=>Ue(xe.id),className:"flex-1 text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Eliminar"})]}):a.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):xe.status==="PROCESADA"?a.jsx("div",{className:"flex gap-2",children:fe?a.jsx("button",{onClick:()=>dt(xe.id),className:"w-full text-xs bg-red-600 text-white py-2 rounded hover:bg-red-700",children:"Revertir"}):a.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:""})}):a.jsx("div",{className:"text-gray-400 text-xs w-full text-center",children:"No options"})})]})]},xe.id)}),j.length===0&&a.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin ventas para mostrar."})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-2 text-sm mb-4",children:[a.jsxs("div",{children:["Total paquetes crdito: ",a.jsx("strong",{children:Qu(q)})]}),a.jsxs("div",{children:["Total paquetes cash: ",a.jsx("strong",{children:Qu(Se)})]}),a.jsxs("div",{children:["Total pendiente crdito:"," ",a.jsxs("strong",{children:["C$",Ua(ee)]})]}),a.jsxs("div",{children:["Total cobrado cash: ",a.jsxs("strong",{children:["C$",Ua(z)]})]}),a.jsxs("div",{children:["Total comisin: ",a.jsxs("strong",{children:["C$",Ua(te)]})]})]}),(re>0||le!==de)&&a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm mb-6",children:[a.jsxs("div",{children:["Costo total (COGS): ",a.jsxs("strong",{children:["C$",Ua(re)]})]}),a.jsxs("div",{children:["Ganancia antes de gasto:"," ",a.jsxs("strong",{children:["C$",Ua(le)]})]}),a.jsxs("div",{children:["Total paquetes (visibles):"," ",a.jsx("strong",{children:Qu(M)})]})]}),a.jsx("h3",{className:"font-semibold mb-2",children:"Consolidado por producto"}),a.jsx("div",{className:"pdf-desktop hidden md:block",children:a.jsxs("table",{className:"min-w-full border text-sm mb-2 shadow-2xl",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Total paquetes"}),a.jsx("th",{className:"border p-2",children:"Total dinero"}),a.jsx("th",{className:"border p-2",children:"Comisin"})]})}),a.jsxs("tbody",{children:[tt.map(xe=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:xe.productName}),a.jsx("td",{className:"border p-1",children:Qu(xe.totalQuantity)}),a.jsxs("td",{className:"border p-1",children:["C$",Ua(xe.totalAmount)]}),a.jsx("td",{className:"border p-1",children:xe.totalCommission>0?`C$${Ua(xe.totalCommission)}`:""})]},xe.productName)),tt.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin datos para consolidar."})})]})]})}),a.jsxs("div",{className:"pdf-mobile md:hidden space-y-2",children:[tt.map(xe=>a.jsxs("div",{className:"border rounded-xl bg-white shadow-sm p-3",children:[a.jsx("div",{className:"font-semibold",children:xe.productName}),a.jsxs("div",{className:"mt-2 text-sm space-y-1",children:[a.jsxs("div",{className:"flex justify-between gap-3",children:[a.jsx("span",{className:"text-gray-600",children:"Total paquetes"}),a.jsx("strong",{children:Qu(xe.totalQuantity)})]}),a.jsxs("div",{className:"flex justify-between gap-3",children:[a.jsx("span",{className:"text-gray-600",children:"Total dinero"}),a.jsxs("strong",{children:["C$",Ua(xe.totalAmount)]})]}),a.jsxs("div",{className:"flex justify-between gap-3",children:[a.jsx("span",{className:"text-gray-600",children:"Comisin"}),a.jsx("strong",{children:xe.totalCommission>0?`C$${Ua(xe.totalCommission)}`:""})]})]})]},xe.productName)),tt.length===0&&a.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Sin datos para consolidar."})]})]}),a.jsxs("div",{className:"flex gap-2 mt-4",children:[fe&&a.jsx("button",{onClick:ot,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Cerrar ventas del perodo"}),a.jsx("button",{onClick:Xe,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Descargar PDF"})]}),d&&a.jsx("p",{className:"mt-2 text-sm",children:d}),k&&fe&&a.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-4 space-y-3",children:[a.jsx("h4",{className:"font-semibold text-lg",children:"Editar venta de dulces"}),a.jsxs("div",{className:"text-sm text-gray-500",children:[k.productName,"  ",k.userEmail]}),a.jsx("label",{className:"text-sm",children:"Paquetes"}),a.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:L,onChange:xe=>E(parseFloat(xe.target.value||"0"))}),a.jsx("label",{className:"text-sm",children:"Monto cobrado"}),a.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:B,onChange:xe=>S(parseFloat(xe.target.value||"0"))}),a.jsx("label",{className:"text-sm",children:"Cliente"}),a.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:U,onChange:xe=>_(xe.target.value)}),a.jsx("label",{className:"text-sm",children:"Paga con"}),a.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:F,onChange:xe=>D(parseFloat(xe.target.value||"0"))}),a.jsx("label",{className:"text-sm",children:"Vuelto"}),a.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:X,onChange:xe=>ge(xe.target.value)}),a.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[a.jsx("button",{onClick:()=>O(null),className:"px-3 py-1 border rounded",children:"Cancelar"}),a.jsx("button",{onClick:lt,className:"px-3 py-1 rounded text-white bg-indigo-600 hover:bg-indigo-700",children:"Guardar cambios"})]})]})})]})}const ed=t=>`C$ ${(Number(t)||0).toFixed(2)}`,yo=t=>Math.round((Number(t)||0)*100)/100;function j1e(t){if(!t)return"";switch(t){case"RIVAS":return"Rivas";case"SAN_JORGE":return"San Jorge";case"ISLA":return"Isla de Ometepe";default:return""}}function k1e(t){return t.toISOString().slice(0,10)}function F1e(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-01`}function T1e(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,1),r=new Date(e.getTime()-24*60*60*1e3);return k1e(r)}function P1e(){const[t,e]=N.useState(F1e()),[r,n]=N.useState(T1e()),[s,i]=N.useState(!1),[o,l]=N.useState(""),[c,d]=N.useState({}),[A,u]=N.useState({}),[f,h]=N.useState([]),[m,p]=N.useState([]),[g,x]=N.useState({}),[b,w]=N.useState(!1),[k,O]=N.useState(null),[L,E]=N.useState(null),B=N.useMemo(()=>k&&f.find(ae=>ae.vendorId===k)||null,[k,f]),S=N.useMemo(()=>{var ae;return!k||!L?[]:((ae=g[k])==null?void 0:ae[L])||[]},[k,L,g]),U=N.useMemo(()=>yo(f.reduce((ae,fe)=>ae+(fe.totalSoldMoney||0),0)),[f]),_=N.useMemo(()=>yo(f.reduce((ae,fe)=>ae+(fe.totalCreditMoney||0),0)),[f]);N.useEffect(()=>{(async()=>{try{const ae=await Nt(ht(Te,"sellers_candies")),fe={};ae.forEach(ye=>{const Ie=ye.data(),I=Ie.branch||"Rivas";let j="RIVAS";I==="San Jorge"?j="SAN_JORGE":I==="Isla Ometepe"&&(j="ISLA"),fe[ye.id]={id:ye.id,name:Ie.name??"(sin nombre)",branch:j,branchLabel:I,commissionPercent:Number(Ie.commissionPercent??0)}});const me=await Nt(ht(Te,"products_candies")),Z={};me.forEach(ye=>{const Ie=ye.data();Z[ye.id]={id:ye.id,name:Ie.name??"(sin nombre)"}}),d(fe),u(Z)}catch(ae){console.error(ae),l(" Error cargando catlogos de vendedores/productos.")}})()},[]);const F=async()=>{if(!t||!r){l("Selecciona rango de fechas vlido.");return}if(!Object.keys(c).length){l("Cargando vendedores, intenta de nuevo en unos segundos.");return}i(!0),l("");try{const ae={},fe={},me=Dt(ht(Te,"inventory_candies_sellers"),Gt("date",">=",t),Gt("date","<=",r)),Z=await Nt(me),ye={},Ie={},I={},j={};Z.forEach(Ne=>{var We,He;const Y=Ne.data(),we=Y.sellerId||"";if(!we)return;const Pe=Y.productId||"",Qe=Y.productName||((We=A[Pe])==null?void 0:We.name)||"(sin nombre)",tt=Math.max(1,Math.floor(Number(Y.unitsPerPackage||1))),ot=Number(Y.totalUnits??0),dt=Number(Y.packages??0),vt=Number(Y.remainingUnits??Y.remaining??0),lt=Number(Y.remainingPackages??0),Ue=dt>0?dt:ot>0?Math.floor(ot/tt):0,Xe=lt>0?lt:vt>0?Math.floor(vt/tt):0;ye[we]=(ye[we]||0)+Ue,Ie[we]=(Ie[we]||0)+Xe;const xe=Y.orderId||Y.vendorOrderId||Y.orderNumber||Y.order||Ne.id;I[we]||(I[we]=new Set),I[we].add(xe);const ve=((He=c[we])==null?void 0:He.name)||Y.sellerName||"(sin vendedor)",ie=String(Y.date||""),ze=Number(Y.totalVendor??0),rt=Number(Y.gainVendor??0),At=dt>0?dt:ot>0?Math.floor(ot/tt):0,Oe=At>0?ze/At:0,at=At>0?rt/At:0,Ve=yo(Ue*Oe),G=yo(Ue*at),_e=yo(Xe*Oe),Me=yo(Xe*at);j[we]||(j[we]={ordered:[],remaining:[]}),Ue>0&&j[we].ordered.push({date:ie,vendorName:ve,productName:Qe,packages:Ue,totalMoney:Ve,vendorCommission:G}),Xe>0&&j[we].remaining.push({date:ie,vendorName:ve,productName:Qe,packages:Xe,totalMoney:_e,vendorCommission:Me})});const Q={};Object.keys(I).forEach(Ne=>{Q[Ne]=I[Ne].size});const T=Dt(ht(Te,"sales_candies"),Gt("date",">=",t),Gt("date","<=",r)),R=await Nt(T),K={},M={},re={},de={},le={},q={};R.forEach(Ne=>{const Y=Ne.data(),we=Y.date||"",Pe=Y.vendorId||Y.sellerId||"";if(!Pe)return;const Qe=c[Pe],tt=Y.vendorName||(Qe==null?void 0:Qe.name)||"(sin vendedor)",ot=Number(Y.vendorCommissionPercent??(Qe==null?void 0:Qe.commissionPercent)??0)||0,dt=Array.isArray(Y.items)?Y.items:[];if(!dt.length)return;const vt=String(Y.type||"").toUpperCase()==="CREDITO";le[Pe]||(le[Pe]={sold:[],credit:[]}),dt.forEach(lt=>{var Ve;const Ue=lt.productName||((Ve=A[lt.productId||""])==null?void 0:Ve.name)||"(sin nombre)",Xe=lt.packages??lt.qty??lt.quantity??0,xe=Number(Xe||0);if(xe<=0)return;const ve=Number(lt.unitPricePackage??lt.unitPrice??0)||0,ie=Math.max(0,Number(lt.discount||0)),ze=xe*ve,rt=yo(Math.max(0,ze-ie));if(rt<=0)return;console.log("DBG",{isCredit:vt,vendorId:Pe,commissionPercent:ot,lineFinal:rt,storedItemCommission:Number(lt.vendorCommissionAmount??0)});let At=0;const Oe=Number(lt.vendorCommissionAmount??0);Oe?At=yo(Oe):ot>0&&(At=yo(rt*ot/100)),vt?(M[Pe]=(M[Pe]||0)+xe,de[Pe]=(de[Pe]||0)+rt):(K[Pe]=(K[Pe]||0)+xe,re[Pe]=(re[Pe]||0)+rt),vt?fe[Pe]=(fe[Pe]||0)+At:ae[Pe]=(ae[Pe]||0)+At,vt?le[Pe].credit.push({date:we,vendorName:tt,productName:Ue,packages:xe,totalMoney:rt,vendorCommission:0}):le[Pe].sold.push({date:we,vendorName:tt,productName:Ue,packages:xe,totalMoney:rt,vendorCommission:At});const at=Ue;q[at]||(q[at]={productName:Ue,packages:0,totalMoney:0}),q[at].packages+=xe,q[at].totalMoney+=rt})});const Se=new Set([...Object.keys(ye),...Object.keys(Ie),...Object.keys(K),...Object.keys(M)]),ee=[],z={};Se.forEach(Ne=>{var Xe,xe,ve,ie;const Y=c[Ne],we=(Y==null?void 0:Y.name)||"(sin vendedor)",Pe=Y?Y.branchLabel||j1e(Y.branch):"",Qe=ye[Ne]||0,tt=Ie[Ne]||0,ot=K[Ne]||0,dt=M[Ne]||0,vt=yo(re[Ne]||0),lt=yo(de[Ne]||0),Ue=Q[Ne]||0;ee.push({vendorId:Ne,vendorName:we,branchLabel:Pe,orderedPackages:Qe,remainingPackages:tt,soldPackages:ot,creditPackages:dt,totalSoldMoney:vt,totalCreditMoney:lt,ordersCreated:Ue,commissionCash:yo(ae[Ne]||0),commissionCredit:0}),z[Ne]={ordered:(((Xe=j[Ne])==null?void 0:Xe.ordered)||[]).sort((ze,rt)=>ze.date.localeCompare(rt.date)),remaining:(((xe=j[Ne])==null?void 0:xe.remaining)||[]).sort((ze,rt)=>ze.date.localeCompare(rt.date)),sold:(((ve=le[Ne])==null?void 0:ve.sold)||[]).sort((ze,rt)=>ze.date.localeCompare(rt.date)),credit:(((ie=le[Ne])==null?void 0:ie.credit)||[]).sort((ze,rt)=>ze.date.localeCompare(rt.date))}}),ee.sort((Ne,Y)=>Ne.vendorName.localeCompare(Y.vendorName,"es")),h(ee),x(z);const te=Object.values(q).map(Ne=>({productName:Ne.productName,packages:Ne.packages,totalMoney:yo(Ne.totalMoney)})).sort((Ne,Y)=>Y.packages-Ne.packages).slice(0,10);p(te),ee.length||l("Sin datos para el rango seleccionado.")}catch(ae){console.error(ae),l(" Error cargando consolidado de vendedores.")}finally{i(!1)}};N.useEffect(()=>{Object.keys(c).length&&F()},[c]);const D=(ae,fe)=>{O(ae),E(fe),w(!0)},X=()=>{w(!1),O(null),E(null)},ge=()=>{if(!f.length){l("No hay datos para exportar.");return}const ae=["Vendedor","Sucursal","Paquetes ordenados","Paquetes restantes","Paquetes vendidos","Paquetes fiados","Total vendidos (C$)","Comisin Cash (C$)","Total fiado (C$)","Comisin Crdito (C$)","rdenes creadas"],fe=f.map(I=>[I.vendorName,I.branchLabel,I.orderedPackages.toString(),I.remainingPackages.toString(),I.soldPackages.toString(),I.creditPackages.toString(),I.totalSoldMoney.toFixed(2),I.commissionCash.toFixed(2),I.totalCreditMoney.toFixed(2),I.commissionCredit.toFixed(2),I.ordersCreated.toString()]),me=[ae,...fe].map(I=>I.map(j=>`"${String(j).replace(/"/g,'""')}"`).join(",")).join(`
`),Z=new Blob([me],{type:"text/csv;charset=utf-8;"}),ye=URL.createObjectURL(Z),Ie=document.createElement("a");Ie.href=ye,Ie.download=`consolidado_vendedores_dulces_${t}_a_${r}.csv`,Ie.click(),URL.revokeObjectURL(ye)};return a.jsxs("div",{className:"max-w-7xl mx-auto bg-white p-6 rounded-2xl shadow-2xl",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Consolidado por Vendedor - Dulces"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block font-semibold mb-1",children:"Desde"}),a.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:t,onChange:ae=>e(ae.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block font-semibold mb-1",children:"Hasta"}),a.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:r,onChange:ae=>n(ae.target.value)})]}),a.jsx("div",{className:"flex items-end",children:a.jsx("button",{type:"button",onClick:F,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full",disabled:s,children:s?"Cargando...":"Aplicar filtros"})}),a.jsx("div",{className:"flex items-end",children:a.jsx("button",{type:"button",onClick:ge,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 w-full",children:"Exportar CSV"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 text-sm",children:[a.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Cash"}),a.jsx("div",{className:"text-xl font-semibold",children:ed(U)})]}),a.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Ventas Credito"}),a.jsx("div",{className:"text-xl font-semibold",children:ed(_)})]}),a.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Vendedores con Inventario"}),a.jsx("div",{className:"text-xl font-semibold",children:f.length})]})]}),a.jsx("div",{className:"overflow-x-auto mb-6",children:a.jsxs("table",{className:"min-w-full border text-sm shadow-2xl",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Vendedor"}),a.jsx("th",{className:"border p-2",children:"Sucursal"}),a.jsx("th",{className:"border p-2",children:"Paquetes ordenados"}),a.jsx("th",{className:"border p-2",children:"Paquetes restantes"}),a.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),a.jsx("th",{className:"border p-2",children:"Paquetes fiados"}),a.jsx("th",{className:"border p-2",children:"Total vendidos (C$)"}),a.jsx("th",{className:"border p-2",children:"Comisin Cash (C$)"}),a.jsx("th",{className:"border p-2",children:"Total fiado (C$)"}),a.jsx("th",{className:"border p-2",children:"Comisin Crdito (C$)"}),a.jsx("th",{className:"border p-2",children:"rdenes creadas"})]})}),a.jsxs("tbody",{children:[f.map(ae=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:ae.vendorName}),a.jsx("td",{className:"border p-1",children:ae.branchLabel}),a.jsx("td",{className:"border p-1",children:a.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>D(ae.vendorId,"ordered"),children:ae.orderedPackages})}),a.jsx("td",{className:"border p-1",children:a.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>D(ae.vendorId,"remaining"),children:ae.remainingPackages})}),a.jsx("td",{className:"border p-1",children:a.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>D(ae.vendorId,"sold"),children:ae.soldPackages})}),a.jsx("td",{className:"border p-1",children:a.jsx("button",{type:"button",className:"text-blue-600 underline",onClick:()=>D(ae.vendorId,"credit"),children:ae.creditPackages})}),a.jsx("td",{className:"border p-1",children:ed(ae.totalSoldMoney)}),a.jsx("td",{className:"border p-1",children:ed(ae.commissionCash)}),a.jsx("td",{className:"border p-1",children:ed(ae.totalCreditMoney)}),a.jsx("td",{className:"border p-1",children:ed(ae.commissionCredit)}),a.jsx("td",{className:"border p-1",children:ae.ordersCreated})]},ae.vendorId)),f.length===0&&!s&&a.jsx("tr",{children:a.jsx("td",{colSpan:11,className:"p-3 text-center text-gray-500",children:"Sin datos para mostrar."})})]})]})}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-semibold mb-2 text-sm",children:"Top 10 productos ms vendidos (paquetes)"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full border text-xs shadow-2xl",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"#"}),a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Paquetes vendidos"}),a.jsx("th",{className:"border p-2",children:"Total dinero (C$)"})]})}),a.jsxs("tbody",{children:[m.map((ae,fe)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:fe+1}),a.jsx("td",{className:"border p-1",children:ae.productName}),a.jsx("td",{className:"border p-1",children:ae.packages}),a.jsx("td",{className:"border p-1",children:ed(ae.totalMoney)})]},ae.productName)),m.length===0&&!s&&a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500",children:"Sin productos para mostrar."})})]})]})})]}),o&&a.jsx("p",{className:"mt-2 text-sm text-gray-700",children:o}),b&&L&&k&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-[95%] max-w-4xl max-h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold text-lg",children:["Detalle"," ",L==="ordered"?"Paquetes ordenados":L==="remaining"?"Paquetes restantes":L==="sold"?"Paquetes vendidos":"Paquetes fiados"]}),a.jsxs("p",{className:"text-xs text-gray-500",children:[B==null?void 0:B.vendorName,"  ",B==null?void 0:B.branchLabel]})]}),a.jsx("button",{onClick:X,className:"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 text-sm",children:"Cerrar"})]}),a.jsx("div",{className:"flex-1 overflow-auto p-4",children:a.jsxs("table",{className:"min-w-full border text-xs",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Fecha"}),a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Paquetes"}),a.jsx("th",{className:"border p-2",children:"Total dinero (C$)"}),a.jsx("th",{className:"border p-2",children:"Vendedor"}),a.jsx("th",{className:"border p-2",children:"Comisin vendedor (C$)"})]})}),a.jsxs("tbody",{children:[S.map((ae,fe)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:ae.date}),a.jsx("td",{className:"border p-1",children:ae.productName}),a.jsx("td",{className:"border p-1",children:ae.packages}),a.jsx("td",{className:"border p-1",children:ed(ae.totalMoney)}),a.jsx("td",{className:"border p-1",children:ae.vendorName}),a.jsx("td",{className:"border p-1",children:ed(ae.vendorCommission)})]},fe)),S.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"p-3 text-center text-gray-500",children:"Sin registros para mostrar."})})]})]})})]})})]})}const ci=t=>`C$${Number(t||0).toFixed(2)}`,U1=t=>Number(t||0).toFixed(3),bC=()=>{const t=new Date;return or(new Date(t.getFullYear(),t.getMonth(),1),"yyyy-MM-dd")},O1=()=>or(new Date,"yyyy-MM-dd");function R1e({transactions:t=[],onClose:e,onCreated:r}){const n=Array.isArray(t)?t:[],[s,i]=N.useState([]),o=N.useMemo(()=>{const G={};return s.forEach(_e=>{_e.email&&(G[_e.email.trim().toLowerCase()]=_e)}),G},[s]);N.useEffect(()=>{(async()=>{try{const G=Dt(ht(Te,"sellers_candies"),Ur("name","asc")),_e=await Nt(G),Me=[];_e.forEach(We=>{const He=We.data();Me.push({id:We.id,name:He.name||"",email:He.email||"",commissionPercent:Number(He.commissionPercent||0)})}),i(Me)}catch(G){console.error(G)}})()},[]);const[l,c]=N.useState(bC()),[d,A]=N.useState(O1()),[u,f]=N.useState(""),[h,m]=N.useState(""),p=N.useMemo(()=>{const G=new Map;return n.forEach(_e=>{const Me=_e.productId||_e.productName;G.set(Me,{key:Me,name:_e.productName})}),Array.from(G.values()).sort((_e,Me)=>_e.name.localeCompare(Me.name))},[n]),g=N.useMemo(()=>{const G=new Map;return n.forEach(_e=>{const Me=(_e.sellerEmail||"").trim().toLowerCase();if(!Me)return;const We=o[Me],He=(We==null?void 0:We.name)||_e.vendorName||Me;G.set(Me,{email:Me,label:He})}),Array.from(G.values()).sort((_e,Me)=>_e.label.localeCompare(Me.label))},[n,o]),x=N.useMemo(()=>n.filter(G=>!(l&&G.date<l||d&&G.date>d||u&&(G.productId||G.productName)!==u||h&&(G.sellerEmail||"").trim().toLowerCase()!==h)),[n,l,d,u,h]),[b,w]=N.useState(O1()),[k,O]=N.useState(()=>`FAC-CANDY-${Date.now().toString().slice(-6)}`),[L,E]=N.useState(""),[B,S]=N.useState("0"),[U,_]=N.useState(()=>x.map(G=>G.id));N.useEffect(()=>{_(G=>G.filter(_e=>x.some(Me=>Me.id===_e)))},[x]);const[F,D]=N.useState([]),[X,ge]=N.useState([]),[ae,fe]=N.useState(!1),[me,Z]=N.useState(bC()),[ye,Ie]=N.useState(O1());N.useEffect(()=>{(async()=>{try{fe(!0);const G=Dt(ht(Te,"expensesCandies"),Ur("date","desc")),_e=await Nt(G),Me=[];_e.forEach(We=>{const He=We.data();Me.push({id:We.id,date:He.date,description:He.description,amount:Number(He.amount||0)})}),D(Me)}catch(G){console.error(G)}finally{fe(!1)}})()},[]);const I=N.useMemo(()=>F.filter(G=>!(!G.date||me&&G.date<me||ye&&G.date>ye)),[F,me,ye]),[j,Q]=N.useState([]),[T,R]=N.useState(!1),[K,M]=N.useState(""),[re,de]=N.useState("DEBITO"),[le,q]=N.useState(""),Se=()=>{const G=Number(le);!K.trim()||!isFinite(G)||G<=0||(Q(_e=>[..._e,{id:`${Date.now()}_${_e.length+1}`,description:K.trim(),type:re,amount:Number(G.toFixed(2))}]),M(""),q(""))},[ee,z]=N.useState(null),[te,Ne]=N.useState(""),[Y,we]=N.useState("DEBITO"),[Pe,Qe]=N.useState(""),tt=G=>{z(G.id),Ne(G.description),we(G.type),Qe(G.amount.toFixed(2))},ot=()=>{z(null),Ne(""),we("DEBITO"),Qe("")},dt=()=>{if(!ee)return;const G=Number(Pe);!isFinite(G)||G<=0||(Q(_e=>_e.map(Me=>Me.id===ee?{...Me,description:te.trim(),type:Y,amount:Number(G.toFixed(2))}:Me)),ot())},vt=G=>{Q(_e=>_e.filter(Me=>Me.id!==G)),ee===G&&ot()},lt=(G,_e)=>{_(Me=>_e?[...new Set([...Me,G])]:Me.filter(We=>We!==G))},Ue=G=>{_(G?x.map(_e=>_e.id):[])},Xe=(G,_e)=>{ge(Me=>_e?[...new Set([...Me,G])]:Me.filter(We=>We!==G))},xe=N.useMemo(()=>x.filter(G=>U.includes(G.id)),[x,U]),ve=N.useMemo(()=>j.filter(G=>G.type==="DEBITO").reduce((G,_e)=>G+_e.amount,0),[j]),ie=N.useMemo(()=>j.filter(G=>G.type==="CREDITO").reduce((G,_e)=>G+_e.amount,0),[j]),ze=N.useMemo(()=>{let G=0,_e=0,Me=0,We=0;for(const tr of xe){const Zt=Number(tr.packages||0),et=Number(tr.cogsAmount||0),Rt=Number(tr.amount||0);G+=Zt,_e+=et,Me+=Rt;const er=(tr.sellerEmail||"").trim().toLowerCase(),Lt=o[er],Vt=Number((Lt==null?void 0:Lt.commissionPercent)||0),nr=Rt*Vt/100;We+=nr}const He=I.filter(tr=>X.includes(tr.id)).reduce((tr,Zt)=>tr+Number(Zt.amount||0),0),st=Me-_e,Ct=Me-He-ve+ie-We,Xt=Number(B||0),Ot=Me*Xt/100;return{totalPackages:Number(U1(G)),totalProvider:Number(_e.toFixed(2)),totalSale:Number(Me.toFixed(2)),totalGastos:Number(He.toFixed(2)),debits:Number(ve.toFixed(2)),credits:Number(ie.toFixed(2)),grossProfit:Number(st.toFixed(2)),finalAmount:Number(Ct.toFixed(2)),totalCommissionVendors:Number(We.toFixed(2)),branchProfit:Number(Ot.toFixed(2)),branchFactor:Xt}},[xe,I,X,ve,ie,o,B]),[rt,At]=N.useState(!1),[Oe,at]=N.useState(""),Ve=async()=>{if(at(""),xe.length===0){at("Selecciona al menos 1 transaccin procesada.");return}try{At(!0);const G={number:k.trim(),date:b,description:L.trim(),status:"PENDIENTE",createdAt:$t.now(),totalPackages:ze.totalPackages,totalProvider:ze.totalProvider,totalSale:ze.totalSale,totalExpenses:ze.totalGastos,totalDebits:ze.debits,totalCredits:ze.credits,grossProfit:ze.grossProfit,totalCommissionVendors:ze.totalCommissionVendors,branchFactorPercent:ze.branchFactor,branchProfit:ze.branchProfit,finalAmount:ze.finalAmount,transactions:xe.map(_e=>{const Me=Number(_e.packages||0)||1,We=Number(_e.cogsAmount||0),He=Number(_e.amount||0),st=We/Me,Ct=He/Me,Xt=(_e.sellerEmail||"").trim().toLowerCase(),Ot=o[Xt],tr=Number((Ot==null?void 0:Ot.commissionPercent)||0),Zt=He*tr/100;return{id:_e.id,date:_e.date,productId:_e.productId||null,productName:_e.productName,vendorName:_e.vendorName,sellerEmail:_e.sellerEmail||null,packages:Number(U1(_e.packages)),providerPricePack:Number(st.toFixed(4)),salePricePack:Number(Ct.toFixed(4)),totalProvider:Number(We.toFixed(2)),totalSale:Number(He.toFixed(2)),commissionPercent:tr,commissionAmount:Number(Zt.toFixed(2))}}),expenses:I.filter(_e=>X.includes(_e.id)).map(_e=>({id:_e.id,date:_e.date||null,description:_e.description||"",amount:Number(Number(_e.amount||0).toFixed(2))})),adjustments:j.map(_e=>({id:_e.id,description:_e.description,type:_e.type,amount:Number(_e.amount.toFixed(2))}))};await Jr(ht(Te,"invoicesCandies"),G),at(" Factura de dulces creada."),r()}catch(G){console.error(G),at(` Error al crear factura: ${(G==null?void 0:G.message)||"desconocido"}`)}finally{At(!1)}};return a.jsxs("div",{className:"fixed inset-0 z-[9999] bg-black/40 flex items-center justify-center p-3",children:[a.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-xl shadow-xl p-4 md:p-6 max-h-[90vh] overflow-auto relative",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Crear factura CandyShop"}),a.jsx("button",{onClick:e,className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",children:"Cerrar"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Fecha"}),a.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:b,onChange:G=>w(G.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Nmero"}),a.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:k,onChange:G=>O(G.target.value),placeholder:"FAC-CANDY-001"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Factor sucursal (%)"}),a.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:B,onChange:G=>S(G.target.value),placeholder:"Ej: 30"}),a.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"Se aplica sobre el total de ventas para calcular la ganancia de sucursal."})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Descripcin"}),a.jsx("input",{type:"text",className:"w-full border rounded px-2 py-1",value:L,onChange:G=>E(G.target.value),placeholder:"Comentarios de la factura"})]})]}),a.jsx("div",{className:"bg-gray-50 border rounded p-3 mb-3",children:a.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Desde (transaccin)"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:l,onChange:G=>c(G.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Hasta (transaccin)"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:d,onChange:G=>A(G.target.value)})]}),a.jsxs("div",{className:"min-w-[180px]",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Producto"}),a.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:u,onChange:G=>f(G.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),p.map(G=>a.jsx("option",{value:G.key,children:G.name},G.key))]})]}),a.jsxs("div",{className:"min-w-[180px]",children:[a.jsx("label",{className:"block text-sm font-medium",children:"Vendedor"}),a.jsxs("select",{className:"border rounded px-2 py-1 w-full",value:h,onChange:G=>m(G.target.value),children:[a.jsx("option",{value:"",children:"Todos"}),g.map(G=>a.jsx("option",{value:G.email,children:G.label},G.email))]})]}),a.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>{c(bC()),A(O1()),f(""),m("")},children:"Quitar filtro"})]})}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("h4",{className:"font-semibold",children:"Transacciones procesadas"}),a.jsxs("label",{className:"text-sm flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:x.length>0&&U.length===x.length,onChange:G=>Ue(G.target.checked)}),"Seleccionar todas (sobre el filtro)"]})]}),x.length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"No hay transacciones procesadas en el filtro actual."}):a.jsx("div",{className:"border rounded max-h-80 overflow-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Sel"}),a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Vendedor"}),a.jsx("th",{className:"p-2 border",children:"Producto"}),a.jsx("th",{className:"p-2 border",children:"Paquetes"}),a.jsx("th",{className:"p-2 border",children:"Precio proveedor"}),a.jsx("th",{className:"p-2 border",children:"Precio venta"}),a.jsx("th",{className:"p-2 border",children:"Total proveedor"}),a.jsx("th",{className:"p-2 border",children:"Total venta"}),a.jsx("th",{className:"p-2 border",children:"Comisin venta"})]})}),a.jsx("tbody",{children:x.map(G=>{const _e=U.includes(G.id),Me=Number(G.packages||0)||1,We=Number(G.cogsAmount||0),He=Number(G.amount||0),st=We/Me,Ct=He/Me,Xt=(G.sellerEmail||"").trim().toLowerCase(),Ot=o[Xt],tr=Number((Ot==null?void 0:Ot.commissionPercent)||0),Zt=He*tr/100;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"checkbox",checked:_e,onChange:et=>lt(G.id,et.target.checked)})}),a.jsx("td",{className:"p-2 border",children:G.date}),a.jsx("td",{className:"p-2 border",children:(Ot==null?void 0:Ot.name)||G.vendorName}),a.jsx("td",{className:"p-2 border",children:G.productName}),a.jsx("td",{className:"p-2 border",children:U1(G.packages)}),a.jsx("td",{className:"p-2 border",children:ci(st)}),a.jsx("td",{className:"p-2 border",children:ci(Ct)}),a.jsx("td",{className:"p-2 border",children:ci(We)}),a.jsx("td",{className:"p-2 border",children:ci(He)}),a.jsx("td",{className:"p-2 border",children:tr>0?`${ci(Zt)} (${tr.toFixed(2)}%)`:""})]},G.id)})})]})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("h4",{className:"font-semibold",children:"Gastos a incluir (opcional)"}),ae&&a.jsx("span",{className:"text-xs text-gray-500",children:"Cargando"}),a.jsxs("div",{className:"ml-auto flex items-end gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Desde (gasto)"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:me,onChange:G=>Z(G.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta (gasto)"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:ye,onChange:G=>Ie(G.target.value)})]})]})]}),I.length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"No hay gastos en el rango seleccionado."}):a.jsx("div",{className:"border rounded max-h-48 overflow-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Sel"}),a.jsx("th",{className:"p-2 border",children:"Fecha"}),a.jsx("th",{className:"p-2 border",children:"Descripcin"}),a.jsx("th",{className:"p-2 border",children:"Monto"})]})}),a.jsx("tbody",{children:I.map(G=>{const _e=X.includes(G.id);return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:a.jsx("input",{type:"checkbox",checked:_e,onChange:Me=>Xe(G.id,Me.target.checked)})}),a.jsx("td",{className:"p-2 border",children:G.date||""}),a.jsx("td",{className:"p-2 border",children:G.description||""}),a.jsx("td",{className:"p-2 border",children:ci(Number(G.amount||0))})]},G.id)})})]})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("h4",{className:"font-semibold",children:"Notas Crdito/Dbito (Cargos extras)"}),a.jsx("button",{className:"ml-auto px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:()=>R(!0),children:"Crear Cargo"})]}),j.length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"Sin cargos agregados."}):a.jsx("div",{className:"border rounded max-h-40 overflow-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border",children:"Descripcin"}),a.jsx("th",{className:"p-2 border",children:"Tipo"}),a.jsx("th",{className:"p-2 border",children:"Monto"}),a.jsx("th",{className:"p-2 border",children:"Acciones"})]})}),a.jsx("tbody",{children:j.map(G=>{const _e=ee===G.id;return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border",children:_e?a.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[70px]",value:te,onChange:Me=>Ne(Me.target.value)}):a.jsx("span",{title:G.description,children:G.description.length>60?`${G.description.slice(0,60)}`:G.description})}),a.jsx("td",{className:"p-2 border",children:_e?a.jsxs("select",{className:"w-full border rounded px-2 py-1",value:Y,onChange:Me=>we(Me.target.value),children:[a.jsx("option",{value:"DEBITO",children:"Dbito"}),a.jsx("option",{value:"CREDITO",children:"Crdito"})]}):a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${G.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:G.type})}),a.jsx("td",{className:"p-2 border",children:_e?a.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1 text-right",value:Pe,onChange:Me=>Qe(Me.target.value)}):ci(G.amount)}),a.jsx("td",{className:"p-2 border",children:_e?a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-xs",onClick:dt,children:"Guardar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 text-xs",onClick:ot,children:"Cancelar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>vt(G.id),children:"Eliminar"})]}):a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 text-xs",onClick:()=>tt(G),children:"Editar"}),a.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-xs",onClick:()=>vt(G.id),children:"Eliminar"})]})})]},G.id)})})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-4 justify-between",children:[a.jsx("div",{className:"space-y-1",children:a.jsxs("div",{children:["Total paquetes: ",a.jsx("strong",{children:U1(ze.totalPackages)})]})}),a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsxs("div",{children:["Total proveedor (costo):"," ",a.jsx("strong",{children:ci(ze.totalProvider)})]}),a.jsxs("div",{children:["Total venta: ",a.jsx("strong",{children:ci(ze.totalSale)})]}),a.jsxs("div",{children:["Ganancia bruta (venta  costo):"," ",a.jsx("strong",{children:ci(ze.grossProfit)})]})]}),a.jsxs("div",{className:"space-y-1 text-right",children:[a.jsxs("div",{children:["Gastos: ",a.jsx("strong",{children:ci(ze.totalGastos)})]}),a.jsxs("div",{children:["Dbitos: ",a.jsx("strong",{children:ci(ze.debits)})]}),a.jsxs("div",{children:["Crditos: ",a.jsx("strong",{children:ci(ze.credits)})]}),a.jsxs("div",{children:["Comisin total vendedores:"," ",a.jsx("strong",{children:ci(ze.totalCommissionVendors)})]}),a.jsxs("div",{children:["Ganancia sucursal (ventas  factor):"," ",a.jsx("strong",{children:ci(ze.branchProfit)})]})]}),a.jsx("div",{className:"md:col-span-3 mt-3",children:a.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-center font-semibold text-lg",children:["Monto final (ventas  gastos  dbitos + crditos  comisin vendedores):"," ",a.jsx("span",{className:"text-blue-700",children:ci(ze.finalAmount)})]})})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{disabled:rt,onClick:Ve,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-60",children:rt?"Creando":"Crear factura"}),a.jsx("button",{onClick:e,className:"px-4 py-2 border rounded",children:"Cancelar"}),Oe&&a.jsx("span",{className:"text-sm ml-2",children:Oe})]}),rt&&a.jsxs("div",{className:"absolute inset-0 z-[11000] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center gap-3",children:[a.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),a.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Creando factura"})]})]}),T&&a.jsx("div",{className:"fixed inset-0 z-[10000] bg-black/50 flex items-center justify-center p-3",children:a.jsxs("div",{className:"bg_WHITE w-full max-w-lg rounded-xl shadow-xl p-4",children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx("h4",{className:"font-semibold",children:"Nuevo cargo"}),a.jsx("button",{className:"ml-auto px-2 py-1 border rounded hover:bg-gray-50",onClick:()=>R(!1),children:"Cerrar"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),a.jsx("textarea",{className:"w-full border rounded px-2 py-1 min-h-[90px]",value:K,onChange:G=>M(G.target.value),placeholder:"Detalle del cargo"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Tipo de cargo"}),a.jsxs("select",{className:"w-full border rounded px-2 py-1",value:re,onChange:G=>de(G.target.value),children:[a.jsx("option",{value:"DEBITO",children:"Dbito"}),a.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Monto"}),a.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-2 py-1",value:le,onChange:G=>q(G.target.value),placeholder:"0.00"})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{className:"px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700",onClick:Se,children:"Agregar"})})]})]})})]})}const Cn=t=>`C$ ${Number(t??0).toFixed(2)}`,M1=t=>Number(t??0).toFixed(3);function wC(t){const e=t.transactions||[];let r=Number(t.totalPackages??0),n=Number(t.totalProvider??0),s=Number(t.totalSale??0),i=Number(t.totalCommissionVendors??0);if(e.length>0&&(s===0||r===0)){r=0,n=0,s=0,i=0;for(const x of e){const b=Number(x.packages??0);r+=b,n+=Number(x.totalProvider??b*(x.providerPricePack??0)),s+=Number(x.totalSale??b*(x.salePricePack??0));const w=x.commissionAmount??Number(x.totalSale??0)*Number(x.commissionPercent??0)/100;i+=Number(w||0)}}const o=t.expenses||[],l=t.adjustments||[],c=t.totalExpenses!==void 0?Number(t.totalExpenses):o.reduce((x,b)=>x+Number(b.amount||0),0),d=l.filter(x=>x.type==="DEBITO").reduce((x,b)=>x+Number(b.amount||0),0),A=l.filter(x=>x.type==="CREDITO").reduce((x,b)=>x+Number(b.amount||0),0),u=t.totalDebits!==void 0?Number(t.totalDebits):d,f=t.totalCredits!==void 0?Number(t.totalCredits):A,h=s-n,m=Number(t.branchFactorPercent??0),p=t.branchProfit!==void 0?Number(t.branchProfit):Number((h*m/100).toFixed(2)),g=t.finalAmount!==void 0?Number(t.finalAmount):s-i-c-u+f;return{totalPackages:r,totalProvider:n,totalSale:s,commissionTotal:i,expenses:c,debits:u,credits:f,grossProfit:h,branchProfit:p,finalAmount:g}}function S3(t){const e=t.transactions||[];if(e.length===0)return"";const r=Array.from(new Set(e.map(n=>n.vendorName||"Sin nombre")));return r.length===1?r[0]:"Varios"}function D1e(){const[t,e]=N.useState([]),[r,n]=N.useState(!0),[s,i]=N.useState(null),o=N.useRef(null),[l,c]=N.useState(!1),d=async()=>{n(!0);const h=Dt(ht(Te,"invoicesCandies"),Ur("date","desc")),m=await Nt(h),p=[];m.forEach(g=>{const x=g.data();p.push({id:g.id,date:x.date,number:x.number,description:x.description,status:x.status||"PENDIENTE",totalPackages:x.totalPackages||0,totalProvider:x.totalProvider||0,totalSale:x.totalSale||0,totalExpenses:x.totalExpenses||0,totalDebits:x.totalDebits||0,totalCredits:x.totalCredits||0,totalCommissionVendors:x.totalCommissionVendors||0,finalAmount:x.finalAmount||0,branchFactorPercent:x.branchFactorPercent||0,branchProfit:x.branchProfit||0,transactions:(x.transactions||[]).map(b=>({id:b.id,date:b.date,vendorId:b.vendorId||null,vendorName:b.vendorName||"Sin nombre",sellerEmail:b.sellerEmail||null,productId:b.productId,productName:b.productName||"Sin nombre",packages:Number(b.packages||0),providerPricePack:Number(b.providerPricePack||0),salePricePack:Number(b.salePricePack||0),totalProvider:Number(b.totalProvider||0),totalSale:Number(b.totalSale||0),commissionPercent:Number(b.commissionPercent||0),commissionAmount:Number(b.commissionAmount||0)})),expenses:(x.expenses||[]).map(b=>({id:b.id,description:b.description||"",date:b.date||null,amount:Number(b.amount||0)})),adjustments:(x.adjustments||[]).map(b=>({id:b.id,description:b.description||"",type:b.type||"DEBITO",amount:Number(b.amount||0)}))})}),e(p),n(!1)};N.useEffect(()=>{d()},[]);const A=async h=>{const m=h.status==="PAGADA"?"PENDIENTE":"PAGADA";await Pr(kt(Te,"invoicesCandies",h.id),{status:m}),e(p=>p.map(g=>g.id===h.id?{...g,status:m}:g)),(s==null?void 0:s.id)===h.id&&i({...h,status:m})},u=async h=>{if(window.confirm(`Eliminar factura del ${h.date}?`))try{await un(kt(Te,"invoicesCandies",h.id)),e(m=>m.filter(p=>p.id!==h.id)),(s==null?void 0:s.id)===h.id&&i(null)}catch(m){console.error(m),alert("No se pudo eliminar la factura.")}},f=async()=>{if(!o.current||!s)return;const h=o.current,m=await Yh(h,{backgroundColor:"#ffffff",onclone:w=>{const k=w.body;k.style.background="#ffffff",k.querySelectorAll("*").forEach(O=>{const L=w.defaultView.getComputedStyle(O);L.boxShadow&&L.boxShadow!=="none"&&(O.style.boxShadow="none")})},scale:2}),p=m.toDataURL("image/png"),g=new cr("p","mm","a4"),x=g.internal.pageSize.getWidth(),b=m.height*x/m.width;g.addImage(p,"PNG",0,0,x,b),g.save(`factura_candy_${s.number||s.date}.pdf`)};return a.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded shadow",children:[a.jsxs("div",{className:"flex items-center mb-4 gap-3",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Facturacin CandyShop"}),a.jsx("button",{className:"ml-auto bg-blue-600 text-white px-4 py-2 rounded-2xl hover:bg-blue-700 text-sm",onClick:()=>c(!0),children:"Crear factura Candy"})]}),l&&a.jsx(R1e,{onClose:()=>c(!1),onCreated:()=>{c(!1),d()}}),a.jsx("div",{className:"bg-white p-2 rounded shadow border w-full mb-4 overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"N factura"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin total"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Sub total (sin gastos/ajustes)"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Gastos"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Dbitos"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Crditos"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Estado"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Acciones"})]})}),a.jsx("tbody",{children:r?a.jsx("tr",{children:a.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Cargando"})}):t.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:12,className:"p-4 text-center",children:"Sin facturas"})}):t.map(h=>{const m=wC(h),p=S3(h);return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.number||""}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:p}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.commissionTotal)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:M1(m.totalPackages)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.totalSale)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.expenses)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.debits)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.credits)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(m.finalAmount)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.status==="PAGADA"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:h.status})}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded hover:bg-indigo-700",onClick:()=>i(h),children:"Ver"}),a.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",onClick:()=>A(h),children:h.status==="PAGADA"?"Marcar PENDIENTE":"Marcar PAGADA"}),a.jsx("button",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",onClick:()=>u(h),children:"Eliminar"})]})})]},h.id)})})]})}),s&&a.jsxs("div",{ref:o,className:"bg-white p-4 rounded shadow-2xl",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsxs("h3",{className:"text-lg font-semibold",children:["Detalle ",s.date," ",s.number?` ${s.number}`:""]}),a.jsx("button",{className:"ml-auto px-3 py-1 border rounded",onClick:()=>i(null),children:"Cerrar"}),a.jsx("button",{onClick:f,className:"bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Imprimir PDF"})]}),(()=>{const h=wC(s),m=S3(s);return a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Estado:"})," ",s.status]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Vendedor:"})," ",m]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Paquetes:"})," ",M1(h.totalPackages)]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Total proveedor:"})," ",Cn(h.totalProvider)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Sub total ventas:"})," ",Cn(h.totalSale)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Ganancia bruta:"})," ",Cn(h.grossProfit)]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Comisin vendedores:"})," ",Cn(h.commissionTotal)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Gastos:"})," ",Cn(h.expenses)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Dbitos:"})," ",Cn(h.debits)]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Crditos:"})," ",Cn(h.credits)]})]})]})})(),a.jsx("h4",{className:"font-semibold mb-1",children:"Transacciones"}),a.jsx("div",{className:"overflow-x-auto mb-4",children:a.jsxs("table",{className:"min-w-full text-sm shadow-2xl",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Vendedor"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Producto"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Paquetes"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio proveedor"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Precio venta"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total proveedor"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Total venta"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Comisin venta"})]})}),a.jsx("tbody",{children:(s.transactions||[]).length>0?(s.transactions||[]).map((h,m)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.vendorName}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.productName}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:M1(h.packages)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.providerPricePack)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.salePricePack)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.totalProvider)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.totalSale)}),a.jsxs("td",{className:"p-2 border whitespace-nowrap",children:[Cn(h.commissionAmount||0),h.commissionPercent?` (${h.commissionPercent.toFixed(2)}%)`:""]})]},m)):a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin transacciones"})})})]})}),a.jsx("h4",{className:"font-semibold mb-1",children:"Gastos"}),a.jsx("div",{className:"overflow-x-auto mb-4",children:a.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"})]})}),a.jsx("tbody",{children:(s.expenses||[]).length>0?(s.expenses||[]).map((h,m)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.date||""}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description||""}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.amount)})]},m)):a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin gastos"})})})]})}),a.jsx("h4",{className:"font-semibold mb-1",children:"Cargos extras (Notas crdito/dbito)"}),a.jsx("div",{className:"overflow-x-auto mb-4",children:a.jsxs("table",{className:"min-w-full text-sm shadow-xl",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Descripcin"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Tipo de cargo"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Monto"}),a.jsx("th",{className:"p-2 border whitespace-nowrap",children:"Fecha"})]})}),a.jsx("tbody",{children:(s.adjustments||[]).length>0?(s.adjustments||[]).map((h,m)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"p-2 border whitespace-nowrap",children:h.description}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${h.type==="DEBITO"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:h.type})}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:Cn(h.amount)}),a.jsx("td",{className:"p-2 border whitespace-nowrap",children:s.date})]},m)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"p-3 text-center text-gray-500 whitespace-nowrap",children:"Sin cargos extras"})})})]})}),(()=>{const h=wC(s);return a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 text-sm mb-2 justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{children:["Total paquetes: ",a.jsx("strong",{children:M1(h.totalPackages)})]}),a.jsxs("div",{children:["Total proveedor: ",a.jsx("strong",{children:Cn(h.totalProvider)})]})]}),a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsxs("div",{children:["Sub total ventas: ",a.jsx("strong",{children:Cn(h.totalSale)})]}),a.jsxs("div",{children:["Ganancia bruta: ",a.jsx("strong",{children:Cn(h.grossProfit)})]}),a.jsxs("div",{children:["Ganancia sucursal: ",a.jsx("strong",{children:Cn(h.branchProfit)})]})]}),a.jsxs("div",{className:"space-y-1 text-right",children:[a.jsxs("div",{children:["Comisin vendedores:"," ",a.jsx("strong",{children:Cn(h.commissionTotal)})]}),a.jsxs("div",{children:["Gastos: ",a.jsx("strong",{children:Cn(h.expenses)})]}),a.jsxs("div",{children:["Dbitos: ",a.jsx("strong",{children:Cn(h.debits)})]}),a.jsxs("div",{children:["Crditos: ",a.jsx("strong",{children:Cn(h.credits)})]})]}),a.jsx("div",{className:"md:col-span-3 mt-3",children:a.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4 text-center",children:[a.jsx("span",{className:"block text-lg font-semibold text-gray-800",children:"Total (sub total  comisin  gastos  dbitos + crditos):"}),a.jsx("span",{className:"block text-2xl font-bold text-blue-700 mt-1",children:Cn(h.finalAmount)})]})})]})})()]})]})}const os=t=>Math.round((Number(t)||0)*100)/100,fA=t=>Math.round((Number(t)||0)*1e3)/1e3,ca=t=>Number(t??0).toFixed(2),td=t=>Number(t??0).toFixed(3),L1e=(t,e)=>{var f,h;const r=t.date??((f=t.timestamp)!=null&&f.toDate?or(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=t.userEmail??"",s=t.vendorName||t.vendor||n||t.vendorId||"(sin vendedor)",i=t.type||"CONTADO",o=t.vendorId,l=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,c=Number(t.vendorCommissionAmount??0)||0;if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((m,p)=>{const g=Number((m==null?void 0:m.packages)??(m==null?void 0:m.qty)??(m==null?void 0:m.quantity)??0),x=Number((m==null?void 0:m.lineFinal)??0)||Math.max(0,Number((m==null?void 0:m.unitPricePackage)||(m==null?void 0:m.unitPrice)||0)*g-Number((m==null?void 0:m.discount)||0));let b=0;return c>0&&l>0&&Number(x||0)>0&&(b=os(c*Number(x||0)/l)),{id:`${e}#${p}`,productName:String((m==null?void 0:m.productName)??"(sin nombre)"),quantity:g,amount:os(x),date:r,type:i,vendorId:o,userEmail:s,vendorCommissionAmount:b}});const d=Number(t.packagesTotal??t.quantity??0),A=Number(t.amount??t.amountCharged??t.total??0)||0,u=os(Number(t.vendorCommissionAmount??0)||0);return[{id:e,productName:((h=String(t))==null?void 0:h.productName)??"(sin nombre)",quantity:d,amount:os(A),date:r,type:i,vendorId:o,userEmail:s,vendorCommissionAmount:u}]};function U1e({role:t}){const e=!t||t==="admin",r="daily_closures_candies",n="sales_candies",s="sellers_candies",[i,o]=N.useState(or(aO(new Date),"yyyy-MM-dd")),[l,c]=N.useState(or(new Date,"yyyy-MM-dd")),[d,A]=N.useState(!0),[u,f]=N.useState([]),[h,m]=N.useState(null),[p,g]=N.useState(""),[x,b]=N.useState([]),[w,k]=N.useState("ALL"),[O,L]=N.useState({}),E=N.useRef(null);if(!e)return a.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[a.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Liquidaciones"}),a.jsx("p",{className:"text-sm text-red-600",children:"Acceso denegado: solo admin."})]});const B=async()=>{try{const j=await Nt(ht(Te,s)),Q=[];j.forEach(T=>{const R=T.data();Q.push({id:T.id,name:R.name||"",commissionPercent:Number(R.commissionPercent||0)})}),b(Q)}catch(j){console.error("Error cargando sellers_candies",j)}},S=async()=>{const j=performance.now();try{A(!0);const Q=Dt(ht(Te,r),Gt("date",">=",i),Gt("date","<=",l)),T=await Nt(Q),R=performance.now();console.log(" getDocs ms:",(R-j).toFixed(1),"docs:",T.size);const K=[];T.forEach(le=>K.push({id:le.id,...le.data()}));const M=performance.now();console.log(" parse+set ms:",(M-R).toFixed(1),"rows:",K.length),K.sort((le,q)=>le.date<q.date?1:le.date>q.date?-1:0),f(K),m(null);const re=new Set;K.forEach(le=>{(le.sales||[]).forEach(q=>{const Se=String((q==null?void 0:q.id)??"").split("#")[0].trim();Se&&re.add(Se)})});const de=Array.from(re).filter(le=>!O[le]);if(de.length>0){const le={};for(const q of de)try{const Se=await Ya(kt(Te,n,q));if(Se.exists()){const ee=Se.data();le[q]=L1e(ee,q)}else le[q]=[]}catch(Se){console.error("Error leyendo sale",q,Se),le[q]=[]}L(q=>({...q,...le}))}}catch(Q){console.error(Q),g(" Error cargando liquidaciones.")}finally{A(!1)}};N.useEffect(()=>{B()},[]),N.useEffect(()=>{S()},[]);const U=async j=>{j.preventDefault(),await S()},_=N.useMemo(()=>{const j={};return x.forEach(Q=>j[Q.id]=Q.name||Q.id),j},[x]),F=j=>{const Q=[];return(j.sales||[]).forEach(T=>{const R=String((T==null?void 0:T.id)??"").trim();if(!R)return;const K=R.split("#")[0],re=(O[K]||[]).find(de=>de.id===R);re?Q.push(re):Q.push({id:R,productName:String((T==null?void 0:T.productName)??"(sin nombre)"),quantity:Number((T==null?void 0:T.quantity)??0),amount:os(Number((T==null?void 0:T.amount)??0)),date:String((T==null?void 0:T.date)??""),type:"CONTADO",vendorId:"",userEmail:String((T==null?void 0:T.userEmail)??"(sin vendedor)"),vendorCommissionAmount:0})}),Q},D=j=>w==="ALL"?j:j.filter(Q=>(Q.vendorId||"")===w),X=N.useMemo(()=>u.map(j=>{const Q=D(F(j));let T=0,R=0,K=0,M=0,re=0,de=0;for(const le of Q){const q=Number(le.quantity||0),Se=Number(le.amount||0),ee=Number(le.vendorCommissionAmount||0);le.type==="CREDITO"?(R+=q,M+=Se,de+=ee):(T+=q,K+=Se,re+=ee)}return{...j,_sales:Q,_packsCash:fA(T),_packsCredit:fA(R),_amountCash:os(K),_amountCredit:os(M),_comCash:os(re),_comCredit:os(de)}}),[u,O,w]),ge=N.useMemo(()=>{let j=0,Q=0,T=0,R=0,K=0,M=0;for(const re of X)j+=Number(re._packsCash||0),Q+=Number(re._packsCredit||0),T+=Number(re._amountCash||0),R+=Number(re._amountCredit||0),K+=Number(re._comCash||0),M+=Number(re._comCredit||0);return{packsCash:fA(j),packsCredit:fA(Q),totalSales:os(T+R),amountCash:os(T),amountCredit:os(R),comCash:os(K),comCredit:os(M)}},[X]),ae=N.useMemo(()=>{const j={},Q={};for(const T of X){const R=T._sales||[];for(const K of R){const M=(K.vendorId||"").trim();if(!M)continue;const re=_[M]||K.userEmail||M,de=os(Number(K.vendorCommissionAmount||0));K.type==="CREDITO"?(Q[M]||(Q[M]={vendorId:M,name:re,total:0}),Q[M].total=os(Q[M].total+de)):(j[M]||(j[M]={vendorId:M,name:re,total:0}),j[M].total=os(j[M].total+de))}}return{cashRows:Object.values(j).filter(T=>T.total>0).sort((T,R)=>R.total-T.total),creditRows:Object.values(Q).filter(T=>T.total>0).sort((T,R)=>R.total-T.total)}},[X,_]),fe=N.useMemo(()=>x.map(j=>({id:j.id,label:j.name||j.id})).sort((j,Q)=>j.label.localeCompare(Q.label)),[x]),me=N.useMemo(()=>h&&X.find(j=>j.id===h.id)||null,[h,X]),Z=N.useMemo(()=>me?me._sales||[]:[],[me]),ye=N.useMemo(()=>{let j=0,Q=0,T=0,R=0;for(const K of Z)K.type==="CREDITO"?(Q+=Number(K.quantity||0),R+=Number(K.amount||0)):(j+=Number(K.quantity||0),T+=Number(K.amount||0));return{packsCash:fA(j),packsCredit:fA(Q),amountCash:os(T),amountCredit:os(R)}},[Z]),Ie=N.useMemo(()=>{const j={};for(const Q of Z){const T=Q.productName||"(sin nombre)";j[T]||(j[T]={productName:T,packsCash:0,packsCredit:0,amountCash:0,amountCredit:0,comCash:0,comCredit:0});const R=Number(Q.quantity||0),K=Number(Q.amount||0),M=Number(Q.vendorCommissionAmount||0);Q.type==="CREDITO"?(j[T].packsCredit=fA(j[T].packsCredit+R),j[T].amountCredit=os(j[T].amountCredit+K),j[T].comCredit=os(j[T].comCredit+M)):(j[T].packsCash=fA(j[T].packsCash+R),j[T].amountCash=os(j[T].amountCash+K),j[T].comCash=os(j[T].comCash+M))}return Object.values(j)},[Z]),I=async()=>{if(!E.current||!me)return;const j=E.current;j.classList.add("force-pdf-colors");try{const T=(await Yh(j,{backgroundColor:"#ffffff"})).toDataURL("image/png"),R=new cr;R.addImage(T,"PNG",10,10,190,0),R.save(`liquidacion_${me.date}.pdf`)}finally{j.classList.remove("force-pdf-colors")}};return a.jsxs("div",{className:"max-w-7xl mx-auto p-6 bg-white rounded-2xl shadow-2xl",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Liquidaciones"}),a.jsxs("form",{onSubmit:U,className:"flex flex-wrap items-end gap-3 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:i,onChange:j=>o(j.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1",value:l,onChange:j=>c(j.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm",children:"Vendedor"}),a.jsxs("select",{className:"border rounded px-2 py-1 min-w-[240px]",value:w,onChange:j=>k(j.target.value),children:[a.jsx("option",{value:"ALL",children:"Todos"}),fe.map(j=>a.jsx("option",{value:j.id,children:j.label},j.id))]})]}),a.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Aplicar"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3 mb-6",children:[a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),a.jsx("div",{className:"text-2xl font-bold",children:td(ge.packsCash)})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),a.jsx("div",{className:"text-2xl font-bold",children:td(ge.packsCredit)})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),a.jsxs("div",{className:"text-2xl font-bold",children:["C$",ca(ge.totalSales)]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),a.jsxs("div",{className:"text-2xl font-bold",children:["C$",ca(ge.amountCash)]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),a.jsxs("div",{className:"text-2xl font-bold",children:["C$",ca(ge.amountCredit)]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),a.jsxs("div",{className:"text-2xl font-bold",children:["C$",ca(ge.comCash)]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),a.jsxs("div",{className:"text-2xl font-bold",children:["C$",ca(ge.comCredit)]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),ae.cashRows.length===0?a.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):a.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:ae.cashRows.map(j=>a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"truncate",children:j.name}),a.jsxs("strong",{className:"ml-2",children:["C$",ca(j.total)]})]},j.vendorId))})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),ae.creditRows.length===0?a.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):a.jsx("div",{className:"mt-2 space-y-1 max-h-28 overflow-auto pr-1",children:ae.creditRows.map(j=>a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"truncate",children:j.name}),a.jsxs("strong",{className:"ml-2",children:["C$",ca(j.total)]})]},j.vendorId))})]})]}),d?a.jsx("p",{children:"Cargando..."}):X.length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"Sin cierres en el rango seleccionado."}):a.jsxs("table",{className:"min-w-full text-sm mb-6 shadow-lg p-4 bg-white border-gray-100",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Fecha"}),a.jsx("th",{className:"border p-2",children:"Total paquetes Cash"}),a.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),a.jsx("th",{className:"border p-2",children:"Total Ventas cash"}),a.jsx("th",{className:"border p-2",children:"Total Ventas crdito"}),a.jsx("th",{className:"border p-2",children:"Comisin cash"}),a.jsx("th",{className:"border p-2",children:"Comisin crdito"}),a.jsx("th",{className:"border p-2",children:"Opciones"})]})}),a.jsx("tbody",{children:X.map(j=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:j.date}),a.jsx("td",{className:"border p-1",children:td(j._packsCash)}),a.jsx("td",{className:"border p-1",children:td(j._packsCredit)}),a.jsxs("td",{className:"border p-1",children:["C$",ca(j._amountCash)]}),a.jsxs("td",{className:"border p-1",children:["C$",ca(j._amountCredit)]}),a.jsxs("td",{className:"border p-1",children:["C$",ca(j._comCash)]}),a.jsxs("td",{className:"border p-1",children:["C$",ca(j._comCredit)]}),a.jsx("td",{className:"border p-1",children:a.jsx("div",{className:"flex items-center gap-2 justify-center",children:a.jsx("button",{className:"text-xs bg-gray-800 text-white px-2 py-1 rounded hover:bg-black",onClick:()=>m(j),children:"Ver detalle"})})})]},j.id))})]}),me&&a.jsxs("div",{className:"mt-6 rounded-2xl shadow-lg p-4 bg-white border-solid border-2 border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2 ",children:[a.jsxs("h2",{className:"text-xl font-semibold",children:["Detalle ",me.date]}),a.jsx("button",{onClick:()=>m(null),className:"text-sm px-2 py-1 border rounded",children:"Cerrar"}),a.jsx("button",{onClick:I,className:"ml-auto bg-green-600 text-white px-3 py-1 rounded-2xl hover:bg-green-700 text-sm",children:"Descargar PDF"})]}),a.jsxs("div",{ref:E,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[a.jsxs("div",{children:["Total Ventas cash:"," ",a.jsxs("strong",{children:["C$",ca(ye.amountCash)]})]}),a.jsxs("div",{children:["Total Ventas crdito:"," ",a.jsxs("strong",{children:["C$",ca(ye.amountCredit)]})]}),a.jsxs("div",{children:["Total paquetes cash:"," ",a.jsx("strong",{children:td(ye.packsCash)})]}),a.jsxs("div",{children:["Total paquetes crdito:"," ",a.jsx("strong",{children:td(ye.packsCredit)})]})]}),a.jsx("h3",{className:"font-semibold",children:"Ventas incluidas en el cierre"}),Z.length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"Sin ventas en este cierre."}):a.jsxs("table",{className:"min-w-full border text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Vendedor"}),a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Tipo"}),a.jsx("th",{className:"border p-2",children:"Paquetes"}),a.jsx("th",{className:"border p-2",children:"Monto"}),a.jsx("th",{className:"border p-2",children:"Comisin"}),a.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),a.jsx("tbody",{children:Z.map((j,Q)=>{const T=j.vendorId&&_[j.vendorId]?_[j.vendorId]:j.userEmail,R=os(Number(j.vendorCommissionAmount||0));return a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:T}),a.jsx("td",{className:"border p-1",children:j.productName}),a.jsx("td",{className:"border p-1",children:j.type==="CREDITO"?"Crdito":"Cash"}),a.jsx("td",{className:"border p-1",children:td(j.quantity)}),a.jsxs("td",{className:"border p-1",children:["C$",ca(j.amount)]}),a.jsx("td",{className:"border p-1",children:R>0?`C$${ca(R)}`:""}),a.jsx("td",{className:"border p-1",children:j.date||""})]},Q)})})]}),a.jsx("h3",{className:"font-semibold",children:"Consolidado por producto"}),Ie.length===0?a.jsx("p",{className:"text-sm text-gray-500",children:"Sin datos para consolidar."}):a.jsxs("table",{className:"min-w-full border text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),a.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),a.jsx("th",{className:"border p-2",children:"Ventas cash"}),a.jsx("th",{className:"border p-2",children:"Ventas crdito"}),a.jsx("th",{className:"border p-2",children:"Comisin cash"}),a.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),a.jsx("tbody",{children:Ie.map((j,Q)=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-1",children:j.productName}),a.jsx("td",{className:"border p-1",children:td(j.packsCash)}),a.jsx("td",{className:"border p-1",children:td(j.packsCredit)}),a.jsxs("td",{className:"border p-1",children:["C$",ca(j.amountCash)]}),a.jsxs("td",{className:"border p-1",children:["C$",ca(j.amountCredit)]}),a.jsxs("td",{className:"border p-1",children:["C$",ca(j.comCash)]}),a.jsxs("td",{className:"border p-1",children:["C$",ca(j.comCredit)]})]},Q))})]})]})]}),p&&a.jsx("p",{className:"mt-3 text-sm",children:p})]})}const Sr=t=>Math.round((Number(t)||0)*100)/100,da=t=>Math.round((Number(t)||0)*1e3)/1e3,mr=t=>Number(t??0).toFixed(2),vs=t=>Number(t??0).toFixed(3),I3=t=>{const e=String(t||"").toUpperCase().trim();return e==="RIVAS"?"RIVAS":e==="SAN_JORGE"||e==="SANJORGE"||e==="SJ"?"SAN_JORGE":e==="ISLA"||e==="OMETEPE"?"ISLA":""},O1e=(t,e)=>{var g;const r=t.date??((g=t.timestamp)!=null&&g.toDate?or(t.timestamp.toDate(),"yyyy-MM-dd"):"");if(!r)return[];const n=String(t.processedDate??t.closureDate??"").trim(),s=t.status??"FLOTANTE",i=t.type||"CONTADO",o=String(t.vendorId??"").trim(),l=String(t.vendorName??"").trim()||String(t.userEmail??"").trim()||o||"(sin vendedor)",c=String(t.customerId??"").trim(),d=String(t.customerName??"").trim()||String(t.clientName??"").trim()||"",A=Number(t.total??t.itemsTotal??t.amount??t.amountCharged??0)||0,u=Number(t.vendorCommissionAmount??0)||0,f=I3(t.branch??t.vendorBranch);if(Array.isArray(t.items)&&t.items.length>0)return t.items.map((x,b)=>{const w=Number((x==null?void 0:x.packages)??0)||0,k=Number((x==null?void 0:x.total)??0)||Math.max(0,Number((x==null?void 0:x.unitPricePackage)||0)*w-Number((x==null?void 0:x.discount)||0)),O=I3(x==null?void 0:x.branch)||f;let L=0;return u>0&&A>0&&k>0&&(L=Sr(u*k/A)),{id:`${e}#${b}`,docId:e,productId:String((x==null?void 0:x.productId)??""),productName:String((x==null?void 0:x.productName)??"(sin nombre)"),date:r,processedDate:n,status:s,type:i,vendorId:o,vendorName:l,customerId:c,customerName:d,branch:O||"",packages:w,amount:Sr(k),commission:Sr(L)}});const h=Number(t.packagesTotal??0)||0,m=Number(t.total??t.amount??t.amountCharged??0)||0,p=Sr(Number(t.vendorCommissionAmount??0)||0);return[{id:`${e}#0`,docId:e,productId:"",productName:"(sin nombre)",date:r,processedDate:n,status:s,type:i,vendorId:o,vendorName:l,customerId:c,customerName:d,branch:f||"",packages:h,amount:Sr(m),commission:Sr(p)}]};function M1e(t){return Number.isFinite(t)?Math.max(0,Math.min(1,t)):0}function j3({title:t,series:e,valuePrefix:r="C$"}){const d=e.map(w=>Number(w.value||0)),A=d.length?Math.min(...d):0,u=d.length?Math.max(...d):0,f=u-A||1,h=840,m=204,p=e.map((w,k)=>{const O=44+(e.length<=1?h/2:k/(e.length-1)*h),L=18+(1-(Number(w.value||0)-A)/f)*m;return{x:O,y:L,...w}}),g=p.map((w,k)=>`${k===0?"M":"L"} ${w.x.toFixed(2)} ${w.y.toFixed(2)}`).join(" "),x=p[p.length-1],b=x?x.value:0;return a.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[a.jsx("div",{className:"font-semibold text-sm sm:text-base",children:t}),a.jsxs("div",{className:"text-xs text-gray-600 whitespace-nowrap",children:["ltimo: ",a.jsx("strong",{children:r+mr(b)})]})]}),a.jsx("div",{className:"w-full overflow-x-auto",children:a.jsxs("svg",{viewBox:"0 0 900 260",className:"min-w-[720px] w-full h-auto",role:"img","aria-label":t,children:[[0,1,2,3].map(w=>{const k=18+w/3*m;return a.jsx("line",{x1:44,y1:k,x2:884,y2:k,stroke:"#e5e7eb",strokeWidth:"1"},w)}),a.jsxs("text",{x:8,y:28,fontSize:"12",fill:"#6b7280",children:[r,mr(u)]}),a.jsxs("text",{x:8,y:18+m,fontSize:"12",fill:"#6b7280",children:[r,mr(A)]}),a.jsx("path",{d:g,fill:"none",stroke:"#111827",strokeWidth:"2.5"}),p.map((w,k)=>a.jsx("circle",{cx:w.x,cy:w.y,r:"3.5",fill:"#111827"},k)),e.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("text",{x:44,y:246,fontSize:"12",fill:"#6b7280",textAnchor:"start",children:e[0].label}),a.jsx("text",{x:884,y:246,fontSize:"12",fill:"#6b7280",textAnchor:"end",children:e[e.length-1].label})]})]})})]})}function Q1e({title:t,items:e}){const r=e.reduce((u,f)=>u+Number(f.value||0),0),n=240,s=86,i=120,o=120,l=r>0?r:1;let c=0;const d=["#111827","#374151","#6b7280","#9ca3af"],A=e.map((u,f)=>{const h=Math.max(0,Number(u.value||0)),m=c/l,p=h/l;c+=h;const g=m+p,x=m*Math.PI*2-Math.PI/2,b=g*Math.PI*2-Math.PI/2,w=i+s*Math.cos(x),k=o+s*Math.sin(x),O=i+s*Math.cos(b),L=o+s*Math.sin(b),E=p>.5?1:0;return{d:[`M ${i} ${o}`,`L ${w.toFixed(2)} ${k.toFixed(2)}`,`A ${s} ${s} 0 ${E} 1 ${O.toFixed(2)} ${L.toFixed(2)}`,"Z"].join(" "),fill:d[f%d.length],...u,frac:p}});return a.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[a.jsx("div",{className:"font-semibold text-sm sm:text-base mb-2",children:t}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-center",children:[a.jsx("div",{className:"w-full md:w-auto overflow-x-auto",children:a.jsxs("svg",{viewBox:`0 0 ${n} ${n}`,className:"min-w-[240px] w-[260px] h-auto",role:"img","aria-label":t,children:[A.map((u,f)=>a.jsx("path",{d:u.d,fill:u.fill},f)),a.jsx("circle",{cx:i,cy:o,r:"48",fill:"#ffffff"}),a.jsx("text",{x:i,y:o-4,textAnchor:"middle",fontSize:"12",fill:"#6b7280",children:"Total"}),a.jsxs("text",{x:i,y:o+16,textAnchor:"middle",fontSize:"14",fill:"#111827",fontWeight:"700",children:["C$",mr(r)]})]})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:e.map((u,f)=>{const h=Number(u.value||0),m=M1e(h/(r||1))*100;return a.jsxs("div",{className:"border rounded-xl p-2 bg-gray-50",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"text-sm font-semibold truncate",children:u.label}),a.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",mr(h)]})]}),a.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[m.toFixed(1),"%"]}),a.jsx("div",{className:"h-2 bg-white border rounded-full mt-2 overflow-hidden",children:a.jsx("div",{className:"h-full",style:{width:`${m}%`,background:d[f%d.length]}})})]},u.label)})}),a.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"*Distribucin basada en ventas del perodo con los filtros actuales."})]})]})]})}function V1e({role:t}){var Ve;const e=!t||t==="admin",r=or(new Date,"yyyy-MM-dd"),[n,s]=N.useState(r),[i,o]=N.useState(r),[l,c]=N.useState("TODAS"),[d,A]=N.useState("AMBAS"),[u,f]=N.useState("ALL"),[h,m]=N.useState("ALL"),[p,g]=N.useState(""),[x,b]=N.useState(""),[w,k]=N.useState(""),[O,L]=N.useState(""),[E,B]=N.useState("DIA"),[S,U]=N.useState(!0),[_,F]=N.useState(""),[D,X]=N.useState([]),[ge,ae]=N.useState([]),[fe,me]=N.useState([]),[Z,ye]=N.useState([]),[Ie,I]=N.useState([]),[j,Q]=N.useState([]),[T,R]=N.useState([]),[K,M]=N.useState([]),[re,de]=N.useState(""),le=N.useRef(null),[q,Se]=N.useState([]),[ee,z]=N.useState("DETALLE"),[te,Ne]=N.useState(""),Y=N.useMemo(()=>{const G={};return Ie.forEach(_e=>{G[_e.id]=String(_e.name||"").trim()}),G},[Ie]),we=G=>{const _e=G.customerId?Y[G.customerId]:"";return(G.customerName||_e||"").trim()||(G.customerId?Y[G.customerId]||G.customerId:"")||""};N.useEffect(()=>{if(!e)return;(async()=>{try{const _e=await Nt(ht(Te,"inventory_candies")),Me=[];_e.forEach(We=>Me.push({id:We.id,...We.data()})),Se(Me)}catch(_e){console.error("inventory_candies all error:",_e),Se([])}})()},[e]),N.useEffect(()=>{(async()=>{try{const _e=await Nt(ht(Te,"sellers_candies")),Me=[];_e.forEach(He=>{const st=He.data();Me.push({id:He.id,name:String(st.name||"").trim(),commissionPercent:Number(st.commissionPercent||0),branch:st.branch||""})});const We=new Map;Me.forEach(He=>We.set(He.id,He)),ae(Array.from(We.values()).sort((He,st)=>He.name.localeCompare(st.name)))}catch(_e){console.error(_e)}})()},[]),N.useEffect(()=>{if(!e||!n||!i)return;U(!0),F("");const G=Dt(ht(Te,"sales_candies"),Gt("date",">=",n),Gt("date","<=",i),Ur("date","asc")),_e=H0(G,Me=>{const We=[];Me.forEach(He=>We.push(...O1e(He.data(),He.id))),X(We),U(!1)},Me=>{console.error("sales_candies periodo error:",Me),X([]),U(!1),F(" Error cargando ventas del perodo (revis ndices si aplica).")});return()=>_e()},[e,n,i]),N.useEffect(()=>{if(!e)return;(async()=>{try{const _e=Dt(ht(Te,"candy_main_orders"),Gt("date",">=",n),Gt("date","<=",i)),Me=await Nt(_e),We=[];Me.forEach(He=>We.push({id:He.id,...He.data()})),me(We)}catch(_e){console.error("candy_main_orders error:",_e),me([])}})()},[e,n,i]),N.useEffect(()=>{if(!e)return;(async()=>{try{const _e=Dt(ht(Te,"inventory_candies_sellers"),Gt("date",">=",n),Gt("date","<=",i)),Me=await Nt(_e),We=[];Me.forEach(He=>We.push({id:He.id,...He.data()})),ye(We)}catch(_e){console.error("inventory_candies_sellers error:",_e),ye([])}})()},[e,n,i]),N.useEffect(()=>{if(!e)return;(async()=>{try{const _e=await Nt(ht(Te,"inventory_candies")),Me=[];_e.forEach(We=>Me.push({id:We.id,...We.data()})),R(Me)}catch(_e){console.error("inventory_candies global error:",_e),R([])}})()},[e]),N.useEffect(()=>{if(!e)return;(async()=>{try{const _e=await Nt(ht(Te,"inventory_candies_sellers")),Me=[];_e.forEach(We=>Me.push({id:We.id,...We.data()})),M(Me)}catch(_e){console.error("inventory_candies_sellers global error:",_e),M([])}})()},[e]),N.useEffect(()=>{if(!e)return;const G=Dt(ht(Te,"customers_candies")),_e=H0(G,Me=>{const We=[];Me.forEach(He=>{var st;return We.push({id:He.id,name:String(((st=He.data())==null?void 0:st.name)||"").trim()})}),I(We)},Me=>{console.error("customers_candies snapshot error:",Me),I([])});return()=>_e()},[e]),N.useEffect(()=>{if(!e)return;(async()=>{try{const _e=Dt(ht(Te,"ar_movements"),Gt("date","<=",i),Ur("date","asc")),Me=await Nt(_e),We=[];Me.forEach(He=>We.push({id:He.id,...He.data()})),Q(We)}catch(_e){console.warn("ar_movements sin ndice, usando fallback:",_e);try{const Me=await Nt(ht(Te,"ar_movements")),We=[];Me.forEach(He=>We.push({id:He.id,...He.data()})),Q(We.filter(He=>String(He.date||"")<=i))}catch(Me){console.error(Me),Q([])}}})()},[e,i]);const Pe=N.useMemo(()=>{let G=[...D];if(l!=="TODAS"&&(G=G.filter(We=>We.status===l)),d==="CASH"&&(G=G.filter(We=>We.type==="CONTADO")),d==="CREDITO"&&(G=G.filter(We=>We.type==="CREDITO")),u!=="ALL"&&(G=G.filter(We=>(We.vendorId||"")===u)),h!=="ALL"&&(G=G.filter(We=>We.branch===h)),p.trim()){const We=p.trim().toLowerCase();G=G.filter(He=>(He.productName||"").toLowerCase().includes(We))}if(x.trim()){const We=x.trim().toLowerCase();G=G.filter(He=>(we(He)||"").toLowerCase().includes(We))}const _e=w.trim()?Number(w):null,Me=O.trim()?Number(O):null;return _e!==null&&!Number.isNaN(_e)&&(G=G.filter(We=>(We.amount||0)>=_e)),Me!==null&&!Number.isNaN(Me)&&(G=G.filter(We=>(We.amount||0)<=Me)),G},[D,l,d,u,h,p,x,w,O,Y]),Qe=N.useMemo(()=>{let G=0,_e=0,Me=0,We=0,He=0,st=0;for(const Xt of Pe){const Ot=Number(Xt.packages||0),tr=Number(Xt.amount||0),Zt=Number(Xt.commission||0);Xt.type==="CREDITO"?(_e+=Ot,We+=tr,st+=Zt):(G+=Ot,Me+=tr,He+=Zt)}const Ct=Sr(Me+We);return{packsCash:da(G),packsCredit:da(_e),salesCash:Sr(Me),salesCredit:Sr(We),salesTotal:Ct,commCash:Sr(He),commCredit:Sr(st)}},[Pe]),tt=N.useMemo(()=>{let G=0,_e=0,Me=0,We=0,He=0,st=0;for(const Ct of fe){const Xt=Array.isArray(Ct.items)?Ct.items:[];for(const Ot of Xt)G+=Number(Ot.totalRivas??0),_e+=Number(Ot.totalSanJorge??0),Me+=Number(Ot.totalIsla??0),We+=Number(Ot.gainRivas??0),He+=Number(Ot.gainSanJorge??0),st+=Number(Ot.gainIsla??0)}return{expectedRivas:Sr(G),expectedSanJorge:Sr(_e),expectedIsla:Sr(Me),grossRivas:Sr(We),grossSanJorge:Sr(He),grossIsla:Sr(st),grossTotal:Sr(We+He+st),expectedTotal:Sr(G+_e+Me)}},[fe]),ot=N.useMemo(()=>{const G={RIVAS:{sales:0,packages:0},SAN_JORGE:{sales:0,packages:0},ISLA:{sales:0,packages:0}};for(const _e of Pe){const Me=_e.branch;Me&&(G[Me].sales+=Number(_e.amount||0),G[Me].packages+=Number(_e.packages||0))}return{RIVAS:{sales:Sr(G.RIVAS.sales),packages:da(G.RIVAS.packages)},SAN_JORGE:{sales:Sr(G.SAN_JORGE.sales),packages:da(G.SAN_JORGE.packages)},ISLA:{sales:Sr(G.ISLA.sales),packages:da(G.ISLA.packages)}}},[Pe]),dt=N.useMemo(()=>({RIVAS:Sr(ot.RIVAS.sales-tt.expectedRivas),SAN_JORGE:Sr(ot.SAN_JORGE.sales-tt.expectedSanJorge),ISLA:Sr(ot.ISLA.sales-tt.expectedIsla)}),[ot,tt]),vt=N.useMemo(()=>{const G={},_e={};for(const He of Pe){const st=(He.vendorId||"").trim();if(!st)continue;const Ct=ge.find(tr=>tr.id===st),Xt=(Ct==null?void 0:Ct.name)||He.vendorName||"(sin vendedor)",Ot=Number(He.commission||0);He.type==="CREDITO"?(_e[st]||(_e[st]={vendorId:st,name:Xt,total:0}),_e[st].total=Sr(_e[st].total+Ot)):(G[st]||(G[st]={vendorId:st,name:Xt,total:0}),G[st].total=Sr(G[st].total+Ot))}const Me=Object.values(G).sort((He,st)=>st.total-He.total),We=Object.values(_e).sort((He,st)=>st.total-He.total);return{cashArr:Me,creditArr:We}},[Pe,ge]),lt=N.useMemo(()=>{const G=(J,ce)=>J.reduce((pe,Be)=>pe+Number((Be==null?void 0:Be[ce])??0),0),_e=J=>{const ce=J.map(Be=>Number((Be==null?void 0:Be.remainingPackages)??0)).filter(Be=>Number.isFinite(Be));return ce.length===0?0:ce.every(Be=>Be===ce[0])?ce[0]:ce.reduce((Be,De)=>Be+De,0)},Me=J=>{const ce=Number((J==null?void 0:J.totalPackages)??0);if(ce>0)return ce;const pe=Array.isArray(J==null?void 0:J.items)?J.items:[];return G(pe,"packages")},We=J=>{const ce=Number((J==null?void 0:J.remainingPackages)??0);if(ce>0)return ce;const pe=Array.isArray(J==null?void 0:J.items)?J.items:[];return _e(pe)},He=J=>{const ce=Number(J);return Number.isFinite(ce)?Math.floor(ce):0},st=J=>{const ce=Number(J==null?void 0:J.remainingPackages);if(Number.isFinite(ce)&&ce>0)return Math.floor(ce);const pe=Math.max(1,He((J==null?void 0:J.unitsPerPackage)??1)),Be=He((J==null?void 0:J.remainingUnits)??(J==null?void 0:J.remaining)??0);return Be>0?Math.max(0,Math.floor(Be/pe)):0};let Ct=0,Xt=0,Ot=0;for(const J of fe){const ce=Array.isArray(J.items)?J.items:[];if(ce.length)for(const pe of ce)Ct+=Number((pe==null?void 0:pe.subtotal)??0);else Ct+=Number(J.subtotal??0);Xt+=Me(J),Ot+=We(J)}let tr=0,Zt=0,et=0;const Rt={};for(const J of Z){tr+=Number(J.subtotal??0),Zt+=Number(J.packages??0);const ce=st(J);et+=ce;const pe=String(J.sellerId||"").trim();if(!pe)continue;const Be=String(J.sellerName||"").trim()||"(sin vendedor)";Rt[pe]||(Rt[pe]={sellerId:pe,sellerName:Be,ordered:0,remaining:0}),Rt[pe].ordered+=Number(J.packages??0),Rt[pe].remaining+=ce}const er=Object.values(Rt).map(J=>({...J,ordered:da(J.ordered),remaining:da(J.remaining)})).sort((J,ce)=>ce.ordered-J.ordered),Lt=[...er].sort((J,ce)=>ce.remaining-J.remaining),Vt=Ot,nr=et,Mt=new Set(fe.filter(J=>String(J.date||"")>=n&&String(J.date||"")<=i).map(J=>J.id));let oe=0;for(const J of q){const ce=String(J.orderId||"").trim();ce&&Mt.has(ce)&&(oe+=Number(J.remainingPackages??0))}return{providerTotalMaster:Sr(Ct),providerTotalVendor:Sr(tr),orderedPacksMaster:da(Xt),remainingPacksMaster:da(oe),orderedPacksVendor:da(Zt),remainingPacksVendor:da(et),globalRemainingMaster:da(Vt),globalRemainingVendor:da(nr),vendorRowsOrdered:er,vendorRowsRemaining:Lt}},[fe,Z,q,n,i]),Ue=N.useMemo(()=>{const G=T.reduce((Me,We)=>Me+Number(We.remainingPackages??0),0),_e=K.reduce((Me,We)=>Me+Number(We.remainingPackages??0),0);return{masterRemainingPackages:da(G),vendorRemainingPackages:da(_e)}},[T,K]),Xe=N.useMemo(()=>{const G=new Map,_e=We=>E==="DIA"?{key:We.date,label:We.date}:E==="VENDEDOR"?{key:We.vendorId||"",label:We.vendorName||""}:E==="PRODUCTO"?{key:We.productName||"",label:We.productName||""}:{key:We.branch||"",label:We.branch||""};for(const We of Pe){const{key:He,label:st}=_e(We);G.has(He)||G.set(He,{key:He,label:st,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0,rows:[]});const Ct=G.get(He);Ct.rows.push(We),We.type==="CREDITO"?(Ct.packsCredit+=Number(We.packages||0),Ct.salesCredit+=Number(We.amount||0),Ct.commCredit+=Number(We.commission||0)):(Ct.packsCash+=Number(We.packages||0),Ct.salesCash+=Number(We.amount||0),Ct.commCash+=Number(We.commission||0))}const Me=Array.from(G.values()).map(We=>({...We,packsCash:da(We.packsCash),packsCredit:da(We.packsCredit),salesCash:Sr(We.salesCash),salesCredit:Sr(We.salesCredit),commCash:Sr(We.commCash),commCredit:Sr(We.commCredit)}));return E==="DIA"?Me.sort((We,He)=>We.key<He.key?1:-1):Me.sort((We,He)=>He.salesCash+He.salesCredit-(We.salesCash+We.salesCredit)),Me},[Pe,E]),xe=N.useMemo(()=>{if(!re)return[];const G=Xe.find(_e=>_e.key===re);return(G==null?void 0:G.rows)||[]},[re,Xe]),ve=N.useMemo(()=>{const G={};for(const _e of xe){const Me=_e.productName||"(sin nombre)";G[Me]||(G[Me]={productName:Me,packsCash:0,packsCredit:0,salesCash:0,salesCredit:0,commCash:0,commCredit:0}),_e.type==="CREDITO"?(G[Me].packsCredit+=Number(_e.packages||0),G[Me].salesCredit+=Number(_e.amount||0),G[Me].commCredit+=Number(_e.commission||0)):(G[Me].packsCash+=Number(_e.packages||0),G[Me].salesCash+=Number(_e.amount||0),G[Me].commCash+=Number(_e.commission||0))}return Object.values(G).map(_e=>({..._e,packsCash:da(_e.packsCash),packsCredit:da(_e.packsCredit),salesCash:Sr(_e.salesCash),salesCredit:Sr(_e.salesCredit),commCash:Sr(_e.commCash),commCredit:Sr(_e.commCredit)})).sort((_e,Me)=>Me.salesCash+Me.salesCredit-(_e.salesCash+_e.salesCredit))},[xe]),ie=N.useMemo(()=>{const G={},_e=He=>(Y[He]||"").trim()||He;for(const He of j){const st=String(He.customerId||"").trim();if(!st)continue;const Ct=String(He.date||"");if(Ct&&Ct>i)continue;G[st]||(G[st]={customerId:st,name:_e(st),balance:0,lastPayment:""});const Xt=Number(He.amount||0);He.type==="CARGO"&&(G[st].balance+=Xt),He.type==="ABONO"&&(G[st].balance-=Xt,(!G[st].lastPayment||Ct>G[st].lastPayment)&&(G[st].lastPayment=Ct))}const Me=Object.values(G).map(He=>({...He,balance:Sr(He.balance)})).filter(He=>He.balance>0).sort((He,st)=>st.balance-He.balance),We=Sr(Me.reduce((He,st)=>He+st.balance,0));return{count:Me.length,totalPending:We,list:Me.slice(0,20)}},[j,Y,i]),ze=async()=>{if(le.current){le.current.classList.add("force-pdf-colors");try{const _e=(await Yh(le.current,{backgroundColor:"#ffffff"})).toDataURL("image/png"),Me=new cr;Me.addImage(_e,"PNG",10,10,190,0),Me.save(`data_center_dulces_${n}_a_${i}.pdf`)}finally{le.current.classList.remove("force-pdf-colors")}}},rt=()=>{const _e=[["date","processedDate","status","type","vendorId","vendorName","branch","productName","packages","amount","commission","customerId","customerName"].join(","),...Pe.map(st=>[st.date,st.processedDate||"",st.status,st.type,st.vendorId,`"${String(st.vendorName||"").replace(/"/g,'""')}"`,st.branch||"",`"${String(st.productName||"").replace(/"/g,'""')}"`,vs(st.packages),mr(st.amount),mr(st.commission),st.customerId||"",`"${String(we(st)||"").replace(/"/g,'""')}"`].join(","))],Me=new Blob([_e.join(`
`)],{type:"text/csv;charset=utf-8;"}),We=URL.createObjectURL(Me),He=document.createElement("a");He.href=We,He.download=`data_center_dulces_${n}_a_${i}.csv`,He.click(),URL.revokeObjectURL(We)};if(!e)return a.jsxs("div",{className:"max-w-5xl mx-auto p-3 sm:p-4 md:p-6 bg-white rounded-2xl shadow-2xl",children:[a.jsx("h2",{className:"text-lg md:text-xl font-bold",children:"Data Center - Dulces"}),a.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"No autorizado."})]});const At=N.useMemo(()=>{const G=Sr(Qe.salesTotal),_e=Sr(Qe.commCash+Qe.commCredit),Me=Number(tt.expectedTotal||0),We=Number(tt.grossTotal||0),He=Me>0?Math.max(0,Math.min(1,We/Me)):0,st=Sr(G*(1-He)),Ct=(()=>{const tr=Number(te||0);return Number.isFinite(tr)?Sr(Math.max(0,tr)):0})(),Xt=Sr(G-st),Ot=Sr(Xt-_e-Ct);return{ingreso:G,costoProducto:st,gananciaBruta:Xt,comision:_e,gastos:Ct,gananciaNeta:Ot,marginPct:He,hasEstimation:Me>0}},[Qe,tt,te]),Oe=N.useMemo(()=>{const G={};for(const Ot of Pe){const tr=Ot.date;tr&&(G[tr]||(G[tr]={date:tr,ingreso:0,comision:0}),G[tr].ingreso+=Number(Ot.amount||0),G[tr].comision+=Number(Ot.commission||0))}const _e=Object.keys(G).sort((Ot,tr)=>Ot<tr?-1:1),Me=_e.reduce((Ot,tr)=>Ot+G[tr].ingreso,0)||1,We=Number(At.gastos||0),He=Number(At.costoProducto||0),st=Number(At.comision||0),Ct=_e.map(Ot=>({label:Ot.slice(5),value:Sr(G[Ot].ingreso)})),Xt=_e.map(Ot=>{const tr=G[Ot].ingreso,Zt=tr/Me,et=He*Zt,Rt=st*Zt,er=We*Zt,Lt=tr-et-Rt-er;return{label:Ot.slice(5),value:Sr(Lt)}});return{seriesIngreso:Ct,seriesNeta:Xt,datesCount:_e.length}},[Pe,At]),at=N.useMemo(()=>[{label:"Rivas",value:Number(ot.RIVAS.sales||0)},{label:"San Jorge",value:Number(ot.SAN_JORGE.sales||0)},{label:"Isla",value:Number(ot.ISLA.sales||0)}].map(G=>({...G,value:Sr(G.value)})),[ot]);return a.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 md:px-0",children:a.jsxs("div",{className:"bg-white p-3 sm:p-4 md:p-6 rounded-2xl shadow-2xl",children:[a.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between mb-4",children:[a.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold",children:"Data Center - Dulces"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center sm:justify-end",children:[a.jsx("button",{onClick:ze,className:`\r
                inline-flex items-center justify-center gap-2\r
                w-full sm:w-auto\r
                px-3 py-2 text-sm font-semibold\r
                rounded-lg md:rounded-md\r
                bg-green-600 text-white hover:bg-green-700 transition-colors\r
              `,children:"Exportar PDF"}),a.jsx("button",{onClick:rt,className:`\r
                inline-flex items-center justify-center gap-2\r
                w-full sm:w-auto\r
                px-3 py-2 text-sm font-semibold\r
                rounded-lg md:rounded-md\r
                bg-gray-800 text-white hover:bg-black transition-colors\r
              `,children:"Exportar CSV"})]})]}),a.jsx("div",{className:"rounded-2xl border border-gray-100 p-3 sm:p-4 mb-3 shadow-sm bg-white",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Desde"}),a.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full text-sm",value:n,onChange:G=>s(G.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Hasta"}),a.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full text-sm",value:i,onChange:G=>o(G.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Estado"}),a.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:l,onChange:G=>c(G.target.value),children:[a.jsx("option",{value:"TODAS",children:"Todas"}),a.jsx("option",{value:"FLOTANTE",children:"Flotante"}),a.jsx("option",{value:"PROCESADA",children:"Procesada"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Tipo"}),a.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:d,onChange:G=>A(G.target.value),children:[a.jsx("option",{value:"AMBAS",children:"Ambas"}),a.jsx("option",{value:"CASH",children:"Cash"}),a.jsx("option",{value:"CREDITO",children:"Crdito"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Vendedor"}),a.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:u,onChange:G=>f(G.target.value),children:[a.jsx("option",{value:"ALL",children:"Todos"}),ge.map(G=>a.jsx("option",{value:G.id,children:G.name||G.id},G.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Sucursal"}),a.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:h,onChange:G=>m(G.target.value),children:[a.jsx("option",{value:"ALL",children:"Todas"}),a.jsx("option",{value:"RIVAS",children:"Rivas"}),a.jsx("option",{value:"SAN_JORGE",children:"San Jorge"}),a.jsx("option",{value:"ISLA",children:"Isla"})]})]}),a.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Producto (opcional)"}),a.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:p,onChange:G=>g(G.target.value),placeholder:"Ej: Conitos"})]}),a.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Cliente (opcional)"}),a.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:x,onChange:G=>b(G.target.value),placeholder:"Ej: Javier"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Monto min"}),a.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:w,onChange:G=>k(G.target.value),placeholder:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Monto max"}),a.jsx("input",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:O,onChange:G=>L(G.target.value),placeholder:"999999"})]}),a.jsxs("div",{className:"sm:col-span-2 lg:col-span-2",children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Agrupar por"}),a.jsxs("select",{className:"border rounded-lg px-3 py-2 w-full text-sm",value:E,onChange:G=>{de(""),B(G.target.value)},children:[a.jsx("option",{value:"DIA",children:"Da"}),a.jsx("option",{value:"VENDEDOR",children:"Vendedor"}),a.jsx("option",{value:"PRODUCTO",children:"Producto"}),a.jsx("option",{value:"SUCURSAL",children:"Sucursal"})]})]})]})}),a.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between mb-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>z("MACRO"),className:["px-3 py-2 rounded-full text-sm font-semibold border transition-colors",ee==="MACRO"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"].join(" "),children:"Data Macro"}),a.jsx("button",{onClick:()=>z("DETALLE"),className:["px-3 py-2 rounded-full text-sm font-semibold border transition-colors",ee==="DETALLE"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-800 border-gray-200 hover:bg-gray-50"].join(" "),children:"Data Detalle"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Gastos del perodo (manual)"}),a.jsx("input",{value:te,onChange:G=>Ne(G.target.value),className:"border rounded-lg px-3 py-2 w-full sm:w-56 text-sm",placeholder:"0",inputMode:"decimal"})]})]}),a.jsxs("div",{ref:le,children:[ee==="MACRO"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 mb-4",children:[a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ingreso (ventas)"}),a.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",mr(At.ingreso)]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",i]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsxs("div",{className:"text-xs text-gray-600",children:["Costo producto"," ",a.jsx("span",{className:"text-gray-400",children:"(estimado)"})]}),a.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["-C$",mr(At.costoProducto)]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Margen ref:"," ",a.jsxs("strong",{children:[At.hasEstimation?(At.marginPct*100).toFixed(1):"0.0","%"]})," ","(rdenes maestras)"]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia bruta"}),a.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",mr(At.gananciaBruta)]}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Ingreso  Costo producto"})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Comisin vendedor"}),a.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["-C$",mr(At.comision)]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",mr(Qe.commCash),"  Crdito: C$",mr(Qe.commCredit)]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ganancia neta"}),a.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",mr(At.gananciaNeta)]}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Bruta  Comisiones  Gastos"})]})]}),a.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-4 bg-white border-gray-100 shadow-sm",children:[a.jsx("div",{className:"text-sm font-semibold",children:"Notas rpidas"}),a.jsxs("ul",{className:"text-xs text-gray-600 mt-2 space-y-1 list-disc pl-4",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Costo producto"})," se muestra como"," ",a.jsx("strong",{children:"estimado"})," porque tus ventas no traen el costo real por lnea (COGS). Se calcula usando el margen de"," ",a.jsx("strong",{children:"rdenes maestras"}),"."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Gastos del perodo"})," es un campo manual para que puedas incluir transporte, bolsas, pagos, etc. (si no aplica, dejalo en 0)."]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-3",children:[a.jsx(j3,{title:"Ventas por da (Ingreso)",series:Oe.seriesIngreso,valuePrefix:"C$"}),a.jsx(j3,{title:"Ganancia neta estimada por da",series:Oe.seriesNeta,valuePrefix:"C$"})]}),a.jsx("div",{className:"mb-6",children:a.jsx(Q1e,{title:"Distribucin de ventas por sucursal",items:at})})]}),ee==="DETALLE"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),a.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:vs(Qe.packsCash)}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",i]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),a.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:vs(Qe.packsCredit)}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",i]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ventas totales"}),a.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",mr(Qe.salesTotal)]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",mr(Qe.salesCash),"  Crdito: C$",mr(Qe.salesCredit)]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),a.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",mr(Qe.commCash+Qe.commCredit)]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Cash: C$",mr(Qe.commCash),"  Crdito: C$",mr(Qe.commCredit)]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Gross Profit total (rdenes maestras)"}),a.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",mr(tt.grossTotal)]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["R: ",mr(tt.grossRivas),"  SJ:"," ",mr(tt.grossSanJorge),"  I:"," ",mr(tt.grossIsla)]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Expected Total (Rivas/SJ/Isla)"}),a.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Rivas"}),a.jsxs("strong",{children:["C$",mr(tt.expectedRivas)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"San Jorge"}),a.jsxs("strong",{children:["C$",mr(tt.expectedSanJorge)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Isla"}),a.jsxs("strong",{children:["C$",mr(tt.expectedIsla)]})]})]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Actual ventas por sucursal"}),a.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Rivas"}),a.jsxs("strong",{children:["C$",mr(ot.RIVAS.sales)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"San Jorge"}),a.jsxs("strong",{children:["C$",mr(ot.SAN_JORGE.sales)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Isla"}),a.jsxs("strong",{children:["C$",mr(ot.ISLA.sales)]})]})]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Diferencia vs expected"}),a.jsxs("div",{className:"text-sm mt-2 space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Rivas"}),a.jsxs("strong",{children:["C$",mr(dt.RIVAS)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"San Jorge"}),a.jsxs("strong",{children:["C$",mr(dt.SAN_JORGE)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Isla"}),a.jsxs("strong",{children:["C$",mr(dt.ISLA)]})]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado a precio proveedor (rdenes maestras)"}),a.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",mr(lt.providerTotalMaster)]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",i]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Total facturado a precio proveedor (rdenes vendedor)"}),a.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:["C$",mr(lt.providerTotalVendor)]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n,"  ",i]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (maestras)"}),a.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:vs(lt.orderedPacksMaster)}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",a.jsx("strong",{children:vs(lt.remainingPacksMaster)})]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",a.jsx("strong",{children:vs(Ue.masterRemainingPackages)})]})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados (rdenes vendedor)"}),a.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:vs(lt.orderedPacksVendor)}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Restantes (perodo):"," ",a.jsx("strong",{children:vs(lt.remainingPacksVendor)})]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Existencia global (todas):"," ",a.jsx("strong",{children:vs(Ue.vendorRemainingPackages)})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-4",children:[a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes ordenados por vendedor (perodo)"}),lt.vendorRowsOrdered.length===0?a.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):a.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:lt.vendorRowsOrdered.map(G=>a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"truncate",children:G.sellerName}),a.jsx("strong",{className:"ml-2",children:vs(G.ordered)})]},G.sellerId))})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes existentes por vendedor (perodo)"}),lt.vendorRowsRemaining.length===0?a.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):a.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:lt.vendorRowsRemaining.map(G=>a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"truncate",children:G.sellerName}),a.jsx("strong",{className:"ml-2",children:vs(G.remaining)})]},G.sellerId))})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-4",children:[a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin cash)"}),vt.cashArr.length===0?a.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):a.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:vt.cashArr.map(G=>a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"truncate",children:G.name}),a.jsxs("strong",{className:"ml-2",children:["C$",mr(G.total)]})]},G.vendorId))})]}),a.jsxs("div",{className:"border rounded-xl p-3 shadow-sm bg-gray-50",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Vendedores (comisin crdito)"}),vt.creditArr.length===0?a.jsx("div",{className:"text-sm text-gray-500 mt-2",children:""}):a.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-auto pr-1",children:vt.creditArr.map(G=>a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"truncate",children:G.name}),a.jsxs("strong",{className:"ml-2",children:["C$",mr(G.total)]})]},G.vendorId))})]})]}),a.jsxs("div",{className:"border rounded-2xl p-3 sm:p-4 mb-6 shadow-sm bg-white border-gray-100",children:[a.jsxs("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:["Cartera (saldo pendiente hasta ",i,")"]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 text-sm mb-3",children:[a.jsxs("div",{children:["Clientes con saldo: ",a.jsx("strong",{children:ie.count})]}),a.jsxs("div",{children:["Saldo total pendiente:"," ",a.jsxs("strong",{children:["C$",mr(ie.totalPending)]})]}),a.jsx("div",{className:"text-gray-500",children:"*Muestra top 20 por monto"})]}),ie.list.length===0?a.jsx("div",{className:"text-sm text-gray-500",children:""}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden space-y-2",children:ie.list.map(G=>a.jsxs("div",{className:"border rounded-xl p-3",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsx("div",{className:"font-semibold truncate",children:G.name}),a.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",mr(G.balance)]})]}),a.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["ltimo abono:"," ",a.jsx("span",{className:"font-medium",children:G.lastPayment||""})]})]},G.customerId))}),a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"min-w-full border text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2 text-left",children:"Cliente"}),a.jsx("th",{className:"border p-2",children:"Saldo"}),a.jsx("th",{className:"border p-2",children:"ltimo abono"})]})}),a.jsx("tbody",{children:ie.list.map(G=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-2 text-left",children:G.name}),a.jsxs("td",{className:"border p-2",children:["C$",mr(G.balance)]}),a.jsx("td",{className:"border p-2",children:G.lastPayment||""})]},G.customerId))})]})})]})]}),a.jsxs("div",{className:"mb-3 flex flex-col sm:flex-row sm:items-center gap-2",children:[a.jsxs("h3",{className:"font-semibold text-sm sm:text-base",children:["Tabla principal (Agrupar por: ",E,")"]}),a.jsx("span",{className:"text-xs text-gray-500 sm:ml-auto",children:"Tap/Click en Ver detalle para drill-down"})]}),S?a.jsx("p",{className:"text-sm",children:"Cargando..."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden space-y-2 mb-6",children:Xe.length===0?a.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."}):Xe.map(G=>a.jsxs("div",{className:"border rounded-2xl p-3 shadow-sm bg-white",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsx("div",{className:"font-semibold truncate",children:G.label}),a.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-800 text-white text-sm font-semibold",onClick:()=>de(G.key),children:"Ver detalle"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes cash"}),a.jsx("div",{className:"font-bold",children:vs(G.packsCash)})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes crdito"}),a.jsx("div",{className:"font-bold",children:vs(G.packsCredit)})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),a.jsxs("div",{className:"font-bold",children:["C$",mr(G.salesCash)]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),a.jsxs("div",{className:"font-bold",children:["C$",mr(G.salesCredit)]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Comisin cash"}),a.jsxs("div",{className:"font-bold",children:["C$",mr(G.commCash)]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Comisin crdito"}),a.jsxs("div",{className:"font-bold",children:["C$",mr(G.commCredit)]})]})]})]},G.key))}),a.jsx("div",{className:"hidden md:block overflow-x-auto mb-6 shadow-2xl rounded-xl border",children:a.jsxs("table",{className:"min-w-full border text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2 text-left",children:E==="DIA"?"Da":E==="VENDEDOR"?"Vendedor":E==="PRODUCTO"?"Producto":"Sucursal"}),a.jsx("th",{className:"border p-2",children:"Paquetes cash"}),a.jsx("th",{className:"border p-2",children:"Paquetes crdito"}),a.jsx("th",{className:"border p-2",children:"Ventas cash"}),a.jsx("th",{className:"border p-2",children:"Ventas crdito"}),a.jsx("th",{className:"border p-2",children:"Comisin cash"}),a.jsx("th",{className:"border p-2",children:"Comisin crdito"}),a.jsx("th",{className:"border p-2",children:"Opciones"})]})}),a.jsxs("tbody",{children:[Xe.map(G=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-2 text-left",children:G.label}),a.jsx("td",{className:"border p-2",children:vs(G.packsCash)}),a.jsx("td",{className:"border p-2",children:vs(G.packsCredit)}),a.jsxs("td",{className:"border p-2",children:["C$",mr(G.salesCash)]}),a.jsxs("td",{className:"border p-2",children:["C$",mr(G.salesCredit)]}),a.jsxs("td",{className:"border p-2",children:["C$",mr(G.commCash)]}),a.jsxs("td",{className:"border p-2",children:["C$",mr(G.commCredit)]}),a.jsx("td",{className:"border p-2",children:a.jsx("button",{className:"text-xs bg-gray-800 text-white px-3 py-2 rounded-lg hover:bg-black",onClick:()=>de(G.key),children:"Ver detalle"})})]},G.key)),Xe.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sin datos con los filtros seleccionados."})})]})]})})]}),re&&a.jsxs("div",{className:"rounded-2xl shadow-lg p-3 sm:p-4 bg-white border-solid border-2 border-gray-100",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-3",children:[a.jsxs("h2",{className:"text-base sm:text-xl font-semibold truncate",children:["Detalle "," ",((Ve=Xe.find(G=>G.key===re))==null?void 0:Ve.label)||re]}),a.jsx("button",{onClick:()=>de(""),className:`\r
                        w-full sm:w-auto\r
                        text-sm px-3 py-2 border rounded-lg\r
                        hover:bg-gray-50\r
                      `,children:"Cerrar"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-2 text-sm mb-4",children:[a.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total Ventas cash:"," ",a.jsxs("strong",{children:["C$",mr(xe.filter(G=>G.type==="CONTADO").reduce((G,_e)=>G+Number(_e.amount||0),0))]})]}),a.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total Ventas crdito:"," ",a.jsxs("strong",{children:["C$",mr(xe.filter(G=>G.type==="CREDITO").reduce((G,_e)=>G+Number(_e.amount||0),0))]})]}),a.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total paquetes cash:"," ",a.jsx("strong",{children:vs(xe.filter(G=>G.type==="CONTADO").reduce((G,_e)=>G+Number(_e.packages||0),0))})]}),a.jsxs("div",{className:"border rounded-xl p-3 bg-gray-50",children:["Total paquetes crdito:"," ",a.jsx("strong",{children:vs(xe.filter(G=>G.type==="CREDITO").reduce((G,_e)=>G+Number(_e.packages||0),0))})]})]}),a.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Ventas incluidas"}),a.jsx("div",{className:"md:hidden space-y-2 mb-4",children:xe.length===0?a.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin detalle."}):xe.map(G=>a.jsxs("div",{className:"border rounded-2xl p-3",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsx("div",{className:"font-semibold truncate",children:G.productName}),a.jsxs("div",{className:"text-sm font-bold whitespace-nowrap",children:["C$",mr(G.amount)]})]}),a.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Vendedor:"," ",a.jsx("span",{className:"font-medium",children:G.vendorName})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Tipo"}),a.jsx("div",{className:"font-bold",children:G.type==="CREDITO"?"Crdito":"Cash"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Sucursal"}),a.jsx("div",{className:"font-bold",children:G.branch||""})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"}),a.jsx("div",{className:"font-bold",children:vs(G.packages)})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Comisin"}),a.jsxs("div",{className:"font-bold",children:["C$",mr(G.commission)]})]})]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Fecha: ",G.date]})]},G.id))}),a.jsx("div",{className:"hidden md:block overflow-x-auto mb-4",children:a.jsxs("table",{className:"min-w-full border text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Vendedor"}),a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Tipo"}),a.jsx("th",{className:"border p-2",children:"Sucursal"}),a.jsx("th",{className:"border p-2",children:"Paquetes"}),a.jsx("th",{className:"border p-2",children:"Monto"}),a.jsx("th",{className:"border p-2",children:"Comisin"}),a.jsx("th",{className:"border p-2",children:"Fecha venta"})]})}),a.jsxs("tbody",{children:[xe.map(G=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-2",children:G.vendorName}),a.jsx("td",{className:"border p-2",children:G.productName}),a.jsx("td",{className:"border p-2",children:G.type==="CREDITO"?"Crdito":"Cash"}),a.jsx("td",{className:"border p-2",children:G.branch||""}),a.jsx("td",{className:"border p-2",children:vs(G.packages)}),a.jsxs("td",{className:"border p-2",children:["C$",mr(G.amount)]}),a.jsxs("td",{className:"border p-2",children:["C$",mr(G.commission)]}),a.jsx("td",{className:"border p-2",children:G.date})]},G.id)),xe.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"p-4 text-center text-gray-500",children:"Sin detalle."})})]})]})}),a.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Consolidado por producto"}),a.jsx("div",{className:"md:hidden space-y-2",children:ve.length===0?a.jsx("div",{className:"border rounded-xl p-3 text-center text-gray-500",children:"Sin consolidado."}):ve.map(G=>a.jsxs("div",{className:"border rounded-2xl p-3",children:[a.jsx("div",{className:"font-semibold",children:G.productName}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3 text-sm",children:[a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paq cash"}),a.jsx("div",{className:"font-bold",children:vs(G.packsCash)})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Paq crdito"}),a.jsx("div",{className:"font-bold",children:vs(G.packsCredit)})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ventas cash"}),a.jsxs("div",{className:"font-bold",children:["C$",mr(G.salesCash)]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Ventas crdito"}),a.jsxs("div",{className:"font-bold",children:["C$",mr(G.salesCredit)]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Com cash"}),a.jsxs("div",{className:"font-bold",children:["C$",mr(G.commCash)]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-xl p-2",children:[a.jsx("div",{className:"text-xs text-gray-600",children:"Com crdito"}),a.jsxs("div",{className:"font-bold",children:["C$",mr(G.commCredit)]})]})]})]},G.productName))}),a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"min-w-full border text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"border p-2",children:"Producto"}),a.jsx("th",{className:"border p-2",children:"Total paquetes cash"}),a.jsx("th",{className:"border p-2",children:"Total paquetes crdito"}),a.jsx("th",{className:"border p-2",children:"Ventas cash"}),a.jsx("th",{className:"border p-2",children:"Ventas crdito"}),a.jsx("th",{className:"border p-2",children:"Comisin cash"}),a.jsx("th",{className:"border p-2",children:"Comisin crdito"})]})}),a.jsxs("tbody",{children:[ve.map(G=>a.jsxs("tr",{className:"text-center",children:[a.jsx("td",{className:"border p-2 text-left",children:G.productName}),a.jsx("td",{className:"border p-2",children:vs(G.packsCash)}),a.jsx("td",{className:"border p-2",children:vs(G.packsCredit)}),a.jsxs("td",{className:"border p-2",children:["C$",mr(G.salesCash)]}),a.jsxs("td",{className:"border p-2",children:["C$",mr(G.salesCredit)]}),a.jsxs("td",{className:"border p-2",children:["C$",mr(G.commCash)]}),a.jsxs("td",{className:"border p-2",children:["C$",mr(G.commCredit)]})]},G.productName)),ve.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"p-4 text-center text-gray-500",children:"Sin consolidado."})})]})]})})]})]})]}),_&&a.jsx("p",{className:"mt-3 text-sm",children:_})]})})}function H1e(){const[t,e]=N.useState(!1);return N.useEffect(()=>{var s;const r=window.matchMedia("(max-width: 900px)"),n=()=>e(r.matches);return n(),(s=r.addEventListener)==null||s.call(r,"change",n),()=>{var i;return(i=r.removeEventListener)==null?void 0:i.call(r,"change",n)}},[]),t}function K1e(){const[t,e]=N.useState(null),[r,n]=N.useState(""),[s,i]=N.useState(""),[o,l]=N.useState(!0),c=H1e(),d=N.useMemo(()=>c?a.jsx(sY,{role:r}):a.jsx(nY,{role:r}),[c,r]),A=(t==null?void 0:t.email)||"";if(N.useEffect(()=>{const f=QL(Ox,async h=>{if(l(!0),h){e(h);try{const m=kt(Te,"users",h.uid),p=await Ya(m);if(p.exists()){const g=p.data(),x=g.role||"",b=g.sellerCandyId||"";n(x||""),i(b||"")}else n(""),i("")}catch{n(""),i("")}}else e(null),n(""),i("");l(!1)});return()=>f()},[]),o)return a.jsx("div",{className:"p-6 text-center",children:"Cargando..."});const u=()=>r==="admin"?a.jsx(Ku,{to:"financialDashboard",replace:!0}):r==="vendedor_pollo"?a.jsx(Ku,{to:"salesV2",replace:!0}):r==="vendedor_ropa"?a.jsx(Ku,{to:"salesClothes",replace:!0}):r==="vendedor_dulces"?a.jsx(Ku,{to:"salesCandies",replace:!0}):a.jsx(Ku,{to:"/",replace:!0});return a.jsx(QK,{children:a.jsxs(xK,{children:[a.jsx(Vr,{path:"/",element:a.jsx(rY,{})}),a.jsxs(Vr,{path:"/admin",element:a.jsx(zr,{allowedRoles:["admin","vendedor_pollo","vendedor_ropa","vendedor_dulces"],children:d}),children:[a.jsx(Vr,{index:!0,element:a.jsx(u,{})}),a.jsx(Vr,{path:"bills",element:a.jsx(zr,{allowedRoles:["admin","vendedor_pollo"],children:a.jsx(koe,{})})}),a.jsx(Vr,{path:"salesV2",element:a.jsx(zr,{allowedRoles:["admin","vendedor_pollo"],children:a.jsx(ZT,{user:t})})}),a.jsx(Vr,{path:"financialDashboard",element:a.jsx(zr,{allowedRoles:["admin"],children:a.jsx(rle,{})})}),a.jsx(Vr,{path:"expenses",element:a.jsx(zr,{allowedRoles:["admin"],children:a.jsx(sle,{})})}),a.jsx(Vr,{path:"billing",element:a.jsx(zr,{allowedRoles:["admin"],children:a.jsx(cle,{})})}),a.jsx(Vr,{path:"batches",element:a.jsx(zr,{allowedRoles:["admin","vendedor_pollo"],children:a.jsx(Zoe,{role:r})})}),a.jsx(Vr,{path:"paidBatches",element:a.jsx(zr,{allowedRoles:["admin"],children:a.jsx(hle,{})})}),a.jsx(Vr,{path:"fix",element:a.jsx(zr,{allowedRoles:["admin"],children:a.jsx(ole,{})})}),a.jsx(Vr,{path:"transactionclose",element:a.jsx(zr,{allowedRoles:["admin"],children:a.jsx(ele,{})})}),a.jsx(Vr,{path:"billhistoric",element:a.jsx(zr,{allowedRoles:["admin"],children:a.jsx(Foe,{})})}),a.jsx(Vr,{path:"users",element:a.jsx(zr,{allowedRoles:["admin"],children:a.jsx(Toe,{})})}),a.jsx(Vr,{path:"products",element:a.jsx(zr,{allowedRoles:["admin"],children:a.jsx(Roe,{})})}),a.jsx(Vr,{path:"datacenter",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(V1e,{})})}),a.jsx(Vr,{path:"productsCandies",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(qve,{})})}),a.jsx(Vr,{path:"mainordersCandies",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(E1e,{})})}),a.jsx(Vr,{path:"inventoryMainOrderCandies",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(B1e,{})})}),a.jsx(Vr,{path:"inventoryCandies",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(Zve,{})})}),a.jsx(Vr,{path:"billingsCandies",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(D1e,{})})}),a.jsx(Vr,{path:"customersCandies",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(e1e,{role:r,currentUserEmail:A,sellerCandyId:s})})}),a.jsx(Vr,{path:"salesCandies",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(i1e,{role:r,currentUserEmail:A,sellerCandyId:s})})}),a.jsx(Vr,{path:"expensesCandies",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(o1e,{})})}),a.jsx(Vr,{path:"dashboardCandies",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(p1e,{})})}),a.jsx(Vr,{path:"transactionCandies",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(A1e,{role:r,currentUserEmail:A,sellerCandyId:s})})}),a.jsx(Vr,{path:"vendorsCandies",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(g1e,{})})}),a.jsx(Vr,{path:"productsVendorsCandies",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(N1e,{role:r,currentUserEmail:A,sellerCandyId:s})})}),a.jsx(Vr,{path:"cierreVentasCandies",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(I1e,{role:r,currentUserEmail:A,sellerCandyId:s})})}),a.jsx(Vr,{path:"reporteCierresCandies",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(U1e,{role:r,currentUserEmail:A,sellerCandyId:s})})}),a.jsx(Vr,{path:"consolidatedVendors",element:a.jsx(zr,{allowedRoles:["admin","vendedor_dulces"],children:a.jsx(P1e,{})})}),a.jsx(Vr,{path:"salesClothes",element:a.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:a.jsx(Tle,{})})}),a.jsx(Vr,{path:"TransactionsReportClothes",element:a.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:a.jsx(Hle,{})})}),a.jsx(Vr,{path:"financialDashboardClothes",element:a.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:a.jsx(Dle,{})})}),a.jsx(Vr,{path:"ExpensesClothes",element:a.jsx(zr,{allowedRoles:["admin"],children:a.jsx(Lle,{})})}),a.jsx(Vr,{path:"inventoryClothesBatches",element:a.jsx(zr,{allowedRoles:["admin"],children:a.jsx(gle,{})})}),a.jsx(Vr,{path:"productsClothes",element:a.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:a.jsx(Sle,{})})}),a.jsx(Vr,{path:"CustomersClothes",element:a.jsx(zr,{allowedRoles:["admin","vendedor_ropa"],children:a.jsx(jle,{})})})]}),a.jsx(Vr,{path:"/salesV2",element:a.jsx(zr,{allowedRoles:["admin","vendedor_pollo"],children:a.jsx(ZT,{user:t})})}),a.jsx(Vr,{path:"*",element:a.jsx(Ku,{to:"/"})})]})})}NC.createRoot(document.getElementById("root")).render(a.jsx(ui.StrictMode,{children:a.jsx(K1e,{})}));export{Sn as _,G1e as c,tV as g};
